!function(){function e(){return(e="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,n,i){var o=t(e,n);if(o){var r=Object.getOwnPropertyDescriptor(o,n);return r.get?r.get.call(arguments.length<3?e:i):r.value}}).apply(this,arguments)}function t(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=s(e)););return e}function n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function o(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=s(e);if(t){var o=s(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return r(this,n)}}function r(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return a(e)}function a(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=h(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,r=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw r}}}}function p(e){return function(e){if(Array.isArray(e))return f(e)}(e)||u(e)||h(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function d(e,t){return b(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var i,o,r=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(i=n.next()).done)&&(r.push(i.value),!t||r.length!==t);a=!0);}catch(c){s=!0,o=c}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return r}(e,t)||h(e,t)||g()}function g(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function h(e,t){if(e){if("string"==typeof e)return f(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?f(e,t):void 0}}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function b(e){if(Array.isArray(e))return e}function m(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function v(e,t,n){return t&&m(e.prototype,t),n&&m(e,n),e}function y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{0:function(e,t,n){e.exports=n("dwNn")},1:function(e,t){},dwNn:function(t,i,r){"use strict";var f,m,x,O,w;r.r(i);var k,C,S,_,j=r("fXoL"),P=function(e){return e.Loft="loft",e.Studio="studio",e.Viewer="viewer",e.All="",e}({}),M=function(e){return e.Bookmark="bookmark",e.Module="module",e.Internal="internal",e}({}),I=function(e){return e.Local="Local",e.QA="QA",e.Staging="Staging",e.Production="Production",e}({}),z=function(e){return e.Web="web",e.SDK="sdk",e}({}),T={production:!0,assetDomain:"assets-human.biodigital.com",supportEmail:"support@biodigital.com",googleAuthKey:"66261904577-061oin26uo7sor0vrqc8dnn105irq82n.apps.googleusercontent.com",googleAnalyticsId:"UA-1141985-29",linkedinId:"2641938",pendoId:"3a783681-e53b-4ebd-69c0-788bbae48f13",rollbarToken:"dd70f513aa0740668070fa3fd62b33a0",recaptchaKey:"6LdvZvcUAAAAAM0Z1St9WQXwvSYd__hMUY2WZ6um",application:P.Viewer,deploy:I.Production,platform:z.SDK,exportType:M.Bookmark,offline:!1,native:!0,minPasswordLength:8},U=r("jhN1"),D=r("R1ws"),L=r("AcyG"),E=function e(){y(this,e)},F=function(){var e=function e(t,n,i){y(this,e),this.hostingURL=t,this.embedded=n,this.widgetConfig=i};return e.type="[Widget] Setup Widget",e}(),A=function(){var e=function e(){y(this,e)};return e.type="[Widget] Reset",e}(),R=((k=function e(t){y(this,e),this.enabled=t}).type="[Widget] Set Input Enabled",k),V=function(){var e=function e(t){y(this,e),this.config=t};return e.type="[Widget] Set API Config",e}(),N=function(){var e=function e(t){y(this,e),this.productAccountId=t};return e.type="[Widget] Get Widget Product Settings",e}(),B=function(){var e=function e(t){y(this,e),this.widgetSettings=t};return e.type="[Widget] Set Widget Product Settings",e}(),H=function(e){return e[e.User=0]="User",e[e.Developer=1]="Developer",e}({}),Q=r("tk/3"),q=((C=function(){function e(t){y(this,e),this.http=t}return v(e,[{key:"getWidgetSettings",value:function(e){return this.http.get("/ws/product/account/settings?product_acctid="+e)}}]),e}()).\u0275fac=function(e){return new(e||C)(j.Zb(Q.b))},C.\u0275prov=j.Lb({token:C,factory:C.\u0275fac,providedIn:"root"}),C),$=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},W=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},K={userType:H.User,authenticating:!1,authenticated:!1,widgetUrlConfig:{id:"",type:""},widgetApiConfig:null,parentUrl:{full:"",domain:""},embedded:!1,engineVersion:"",engineAPIVersion:"",inputEnabled:!0,widgetSettings:void 0},G=((S=function(){function e(t){y(this,e),this.widgetConfigService=t}return v(e,[{key:"setupWidget",value:function(e,t){var n=t.hostingURL,i=t.embedded,o=t.widgetConfig,r=n.match(/:\/\/(.[^/]+)/);e.patchState({userType:o.uaid?H.User:H.Developer,embedded:i,widgetUrlConfig:o,parentUrl:{full:n,domain:r&&r[1]?r[1]:n}})}},{key:"getWidgetProductSettings",value:function(e,t){var n=t.productAccountId;this.widgetConfigService.getWidgetSettings(n).subscribe((function(t){var n=t.settings;e.dispatch(new B(n))}))}},{key:"setWidgetProductSettings",value:function(e,t){var n=t.widgetSettings;e.patchState({widgetSettings:n})}},{key:"resetWidget",value:function(e){e.setState(K)}},{key:"setInputEnabled",value:function(e,t){e.patchState({inputEnabled:t.enabled})}},{key:"setWidgetApiConfig",value:function(e,t){e.patchState({widgetApiConfig:t.config})}},{key:"ngxsOnInit",value:function(e){e.patchState({engineVersion:Human.VERSION,engineAPIVersion:Human.API_VERSION})}}],[{key:"getWidgetState",value:function(e){return e}},{key:"getUserType",value:function(e){return e.userType}},{key:"getWidgetAuthenticating",value:function(e){return e.authenticating}},{key:"getWidgetAuthenticated",value:function(e){return e.authenticated}},{key:"getInputEnabled",value:function(e){return e.inputEnabled}},{key:"getEmbedded",value:function(e){return e.embedded}},{key:"getBypassAnalytics",value:function(e){return e.widgetUrlConfig["bypass-analytics"]}},{key:"getParentURL",value:function(e){return e.parentUrl.full}},{key:"getWidgetUrlConfig",value:function(e){return e.widgetUrlConfig}},{key:"getWidgetApiUIConfig",value:function(e){return e.widgetApiConfig}},{key:"getWidgetSettings",value:function(e){return e.widgetSettings}}]),e}()).\u0275fac=function(e){return new(e||S)(j.Zb(q))},S.\u0275prov=j.Lb({token:S,factory:S.\u0275fac}),$([Object(L.a)(F),W("design:type",Function),W("design:paramtypes",[Object,F]),W("design:returntype",void 0)],S.prototype,"setupWidget",null),$([Object(L.a)(N),W("design:type",Function),W("design:paramtypes",[Object,N]),W("design:returntype",void 0)],S.prototype,"getWidgetProductSettings",null),$([Object(L.a)(B),W("design:type",Function),W("design:paramtypes",[Object,B]),W("design:returntype",void 0)],S.prototype,"setWidgetProductSettings",null),$([Object(L.a)(A),W("design:type",Function),W("design:paramtypes",[Object]),W("design:returntype",void 0)],S.prototype,"resetWidget",null),$([Object(L.a)(R),W("design:type",Function),W("design:paramtypes",[Object,R]),W("design:returntype",void 0)],S.prototype,"setInputEnabled",null),$([Object(L.a)(V),W("design:type",Function),W("design:paramtypes",[Object,V]),W("design:returntype",void 0)],S.prototype,"setWidgetApiConfig",null),$([Object(L.e)(),W("design:type",Function),W("design:paramtypes",[E]),W("design:returntype",void 0)],S,"getWidgetState",null),$([Object(L.e)(),W("design:type",Function),W("design:paramtypes",[E]),W("design:returntype",void 0)],S,"getUserType",null),$([Object(L.e)(),W("design:type",Function),W("design:paramtypes",[E]),W("design:returntype",void 0)],S,"getWidgetAuthenticating",null),$([Object(L.e)(),W("design:type",Function),W("design:paramtypes",[E]),W("design:returntype",void 0)],S,"getWidgetAuthenticated",null),$([Object(L.e)(),W("design:type",Function),W("design:paramtypes",[E]),W("design:returntype",void 0)],S,"getInputEnabled",null),$([Object(L.e)(),W("design:type",Function),W("design:paramtypes",[E]),W("design:returntype",void 0)],S,"getEmbedded",null),$([Object(L.e)(),W("design:type",Function),W("design:paramtypes",[E]),W("design:returntype",void 0)],S,"getBypassAnalytics",null),$([Object(L.e)(),W("design:type",Function),W("design:paramtypes",[E]),W("design:returntype",void 0)],S,"getParentURL",null),$([Object(L.e)(),W("design:type",Function),W("design:paramtypes",[E]),W("design:returntype",void 0)],S,"getWidgetUrlConfig",null),$([Object(L.e)(),W("design:type",Function),W("design:paramtypes",[E]),W("design:returntype",void 0)],S,"getWidgetApiUIConfig",null),$([Object(L.e)(),W("design:type",Function),W("design:paramtypes",[E]),W("design:returntype",Array)],S,"getWidgetSettings",null),S=$([Object(L.f)({name:"widget",defaults:K})],S)),Z=r("XNiG"),J=r("HDdC"),X=r("1G5W"),Y=r("pLZG"),ee=function(e){return e[e.Basics=0]="Basics",e[e.All=1]="All",e[e.Shortcuts=2]="Shortcuts",e}({});!function(e){var t=function e(t){y(this,e),this.canHover=t};t.type="[View] Set Can Hover",e.SetCanHover=t;var n=function e(t){y(this,e),this.canTouch=t};n.type="[View] Set Can Touch",e.SetCanTouch=n;var i=function e(t){y(this,e),this.canFullscreen=t};i.type="[View] Set Can Fullscreen",e.SetCanFullscreen=i;var o=function e(t){y(this,e),this.ui=t};o.type="[View] Set UI",e.SetUI=o;var r=function e(t){y(this,e),this.ui=t};r.type="[View] Set Initial UI",e.SetInitialUI=r;var a=function e(t){y(this,e),this.enabled=t};a.type="[View] Set Input Enabled",e.SetInputEnabled=a;var s=function e(t){y(this,e),this.mode=t};s.type="[View] Set Search Display Mode",e.SetSearchDisplayMode=s;var c=function e(t){y(this,e),this.active=t};c.type="[View] Toggle Presentation",e.TogglePresentation=c;var l=function e(t){y(this,e),this.interactType=t};l.type="[View] Set Interact Type",e.SetInteractType=l;var p=function e(t){y(this,e),this.onDemand=t};p.type="[View] Set On Demand",e.SetOnDemand=p;var u=function e(t){y(this,e),this.layout=t};u.type="[View] Set Layout",e.SetLayout=u;var d=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ee.Basics;y(this,e),this.tab=t};d.type="[View] Toggle Help Tab",e.ToggleHelpTab=d;var g=function e(t){y(this,e),this.inputMode=t};g.type="[View] Set Input Mode",e.SetInputMode=g;var h=function e(t){y(this,e),this.tutorial=t};h.type="[View] Set Tutorial",e.SetTutorial=h;var f=function e(t){y(this,e),this.intro=t};f.type="[View] Start Tutorial",e.StartTutorial=f;var b=function e(t){y(this,e),this.seen=t};b.type="[View] Tutorial Seen",e.TutorialSeen=b;var m=function e(){y(this,e)};m.type="[View] Tutorial Next",e.TutorialNext=m;var v=function e(){y(this,e)};v.type="[View] Tutorial Previous",e.TutorialPrevious=v;var x=function e(t){y(this,e),this.show=t};x.type="[View] Toggle Node Info",e.ToggleNodeInfo=x;var O=function e(t){y(this,e),this.lang=t};O.type="[View] Set View Language",e.SetViewLanguage=O;var w=function e(t){y(this,e),this.fallback=t};w.type="[View] Set Node Info Config",e.SetNodeInfoConfig=w;var k=function e(t){y(this,e),this.enabled=t};k.type="[View] Set multi pick mode enabled",e.SetMultiPickModeEnabled=k;var C=function e(t){y(this,e),this.labelsBreakpoint=t};C.type="[View] Set Label Breakpoint",e.SetLabelBreakpoint=C;var S=function e(t){y(this,e),this.usePrintImage=t};S.type="[View] Set Use Print Image",e.SetUsePrintImage=S;var _=function e(t){y(this,e),this.windows=t};_.type="[View] Set Windows",e.SetWindows=_;var j=function e(t){y(this,e),this.window=t};j.type="[View] Open Window",e.OpenWindow=j;var P=function e(t){y(this,e),this.window=t};P.type="[View] Close Window",e.CloseWindow=P;var M=function e(t,n){y(this,e),this.window=t,this.show=n};M.type="[View] Toggle Window",e.ToggleWindow=M;var I=function e(t){y(this,e),this.open=t};I.type="[View] Toggle Menu",e.ToggleMenu=I;var z=function e(t){y(this,e),this.enabled=t};z.type="[View] Whiteboard Enabled",e.SetWhiteboardEnabled=z;var T=function e(t){y(this,e),this.brushSize=t};T.type="[View] Whiteboard Brush Size",e.SetWhiteboardBrushSize=T;var U=function e(t){y(this,e),this.brushColor=t};U.type="[View] Whiteboard Brush Color",e.SetWhiteboardBrushColor=U;var D=function e(t){y(this,e),this.size=t};D.type="[View] Whiteboard Text Size",e.SetWhiteboardTextSize=D;var L=function e(t){y(this,e),this.eraserSize=t};L.type="[View] Whiteboard Eraser Size",e.SetWhiteboardEraserSize=L;var E=function e(t){y(this,e),this.mode=t};E.type="[View] Whiteboard Annotate Mode",e.SetWhiteboardAnnotateMode=E;var F=function e(t){y(this,e),this.hasPaint=t};F.type="[View] Whiteboard Has Paint",e.SetWhiteboardHasPaint=F;var A=function e(t){y(this,e),this.hasText=t};A.type="[View] Whiteboard Has Text",e.SetWhiteboardHasText=A;var R=function e(t,n){y(this,e),this.showSpinner=t,this.label=n};R.type="[View] Show Scrim",e.ShowScrim=R;var V=function e(){y(this,e)};V.type="[View] Hide Scrim",e.HideScrim=V}(_||(_={}));var te=r("tyNb"),ne=(r("mNvP"),r("m+po"),r("Wdmj")),ie=r("LvDl");function oe(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return(t?function(e){return e.filter((function(e){return Object.values(e).some((function(e){return!Object(ie.isNil)(e.value)&&""!==e.value}))}))}(e):e).reduce((function(e,t){return Object.assign(Object.assign({},e),t)}),{})}var re,ae=function e(){y(this,e)},se=r("lJxs"),ce=r("b36G"),le=function e(){y(this,e)},pe=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},ue=(re=function e(){y(this,e),this.type=M.Bookmark,this.favorite=!1,this.unavailable=!1},function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);r>3&&a&&Object.defineProperty(t,n,a)}([Object(ce.Type)((function(){return le})),pe("design:type",Array)],re.prototype,"group_access",void 0),re),de=function(e){return e.All="",e.Quiz="mode-quiz",e.Content="mode-content",e}({});function ge(e){var t=e.id;if("module"===e.type&&(e.id=function(e){return e.replace("Condition.content.","").replace(".json","").split(".").join("/")}(t)),e.tour=e.tags.includes("tour"),e.animated=e.tags.includes("animated"),e.quiz=e.tags.includes("quiz"),e.lowDefinition=e.tags.includes("low definition"),!e.viewMode){var n=Object.values(de).find((function(t){return e.tags.includes(t)}));e.viewMode=null!=n?n:de.All}return e}var he=function(e){return e.IdAsc="+collection_id",e.IdDesc="-collection_id",e.NameAsc="+collection_name",e.NameDesc="-collection_name",e.UpdateDateAsc="+collection_updatedate",e.UpdateDateDesc="-collection_updatedate",e.CreateDateAsc="+collection_createdate",e.CreateDateDesc="-collection_createdate",e.CustomAsc="+custom_sort_order",e.CustomDesc="-custom_sort_order",e}({});function fe(e){return"?"+Object.entries(e).filter((function(e){var t=d(e,2),n=(t[0],t[1]);return!Object(ie.isNil)(n)})).map((function(e){var t=d(e,2),n=t[0],i=t[1];return"".concat(n,"=").concat(encodeURIComponent(i))})).join("&")}var be,me,ve="/ws/organization/collection",ye=((be=function(){function e(t){y(this,e),this.http=t}return v(e,[{key:"createOrganization",value:function(e){return this.http.post("/ws/organization/create",e)}},{key:"updateOrganization",value:function(e){return this.http.post("/ws/organization/update",e)}},{key:"getCollections",value:function(e){var t=this;e.sort_order||(e.sort_order=[he.CustomAsc,he.NameDesc]);var n=fe(e);return this.http.get("".concat(ve).concat(n)).pipe(Object(se.a)((function(e){return Object(ce.plainToClass)(ae,e).map((function(e){return t.normalizeCollectionModel(e)}))})))}},{key:"getCollectionContent",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",i=n.toLocaleLowerCase().split(" ");return this.getCollections({group_id:e,collection_id:t,include_content:1}).pipe(Object(se.a)((function(e){return e[0].collection_content.map((function(e){return Object(ce.plainToClass)(ue,e)})).filter((function(e){var t=!0;return i.length&&e.title&&i.forEach((function(n){t=t&&e.title.toLocaleLowerCase().indexOf(n)>=0})),t=t&&!0!==e.unavailable}))})))}},{key:"addCollection",value:function(e,t){return this.http.post(ve,{group_id:e,collection_name:t})}},{key:"removeCollection",value:function(e){return this.http.request("DELETE",ve,{body:{group_id:e.group_id,collection_id:e.collection_id}})}},{key:"renameCollection",value:function(e,t){return this.http.post(ve,{group_id:e.group_id,collection_id:e.collection_id,collection_name:t})}},{key:"reorderCollections",value:function(e,t){return this.http.post(ve+"/sort-order",{group_id:e,collection_id_sort_list:t.map((function(e){return e.collection_id}))})}},{key:"updateCollectionContent",value:function(e,t,n){return this.http.post(ve+"/content",{group_id:e,add_content:t,remove_content:n})}},{key:"getOrganizationAttribute",value:function(e,t,n){return e.find((function(e){return e.type===t&&e.name===n}))}},{key:"getPublicProfile",value:function(e){return this.http.get("/ws/organization/public/profile",{params:Object.assign({},e)}).pipe(Object(se.a)((function(e){return e})))}},{key:"normalizeCollectionModel",value:function(e){return e.collection_content&&e.collection_content.forEach((function(e){ge(e)})),e}}]),e}()).\u0275fac=function(e){return new(e||be)(j.Zb(Q.b))},be.\u0275prov=j.Lb({token:be,factory:be.\u0275fac,providedIn:"root"}),be),xe=function(e){return e.DiscoveredChapterNav="Discovered Chapter Nav",e}({}),Oe=((me=function(){function e(t,n,i,o){y(this,e),this.config=t,this.router=n,this.route=i,this.organizationsService=o,this.appended=!1,this.initialized=!1,this.sessionEvents={},this.pageEvents={},this.queuedEvents=[],this.initRouteListener()}return v(e,[{key:"appendScript",value:function(){if(this.config.enabled&&!this.appended){var e="\n      (function(apiKey){\n        (function(p,e,n,d,o){var v,w,x,y,z;o=p[d]=p[d]||{};o._q=o._q||[];\n        v=['initialize','identify','updateOptions','pageLoad','track'];for(w=0,x=v.length;w<x;++w)(function(m){\n            o[m]=o[m]||function(){o._q[m===v[0]?'unshift':'push']([m].concat([].slice.call(arguments,0)));};})(v[w]);\n            y=e.createElement(n);y.async=!0;y.src='https://cdn.pendo.io/agent/static/'+apiKey+'/pendo.js';\n            z=e.getElementsByTagName(n)[0];z.parentNode.insertBefore(y,z);})(window,document,'script','pendo');\n      })('".concat(this.config.pendoId,"');\n    "),t=document.createElement("script");t.textContent=e,document.body.appendChild(t),this.appended=!0}}},{key:"initialize",value:function(e){if(this.pendoEnabled()){var t=Object.assign({},e);t.visitor.id&&this.setIds(t),pendo.initialize(t),this.initialized=!0,this.flushQueuedEvents()}}},{key:"identify",value:function(e){if(this.pendoEnabled()){var t=Object.assign({},e);this.setIds(t),pendo.identify(t)}}},{key:"createVisitorData",value:function(e){var t={},n=oe(e.account_settings),i=Object(ie.get)(e,"organizations[0].user_role.role_display_name",null);return e.hasOwnProperty("id")&&(t.id=e.id.toString()),e.hasOwnProperty("email")&&(t.email=e.email),e.hasOwnProperty("first_name")&&e.hasOwnProperty("last_name")&&(t.full_name="".concat(e.first_name," ").concat(e.last_name)),e.hasOwnProperty("registration_date")&&(t.registration_date=e.registration_date),e.hasOwnProperty("premium_account")&&(t.premium=e.premium_account),e.hasOwnProperty("user_is_developer")&&(t.developer=e.user_is_developer),e.hasOwnProperty("subscription")&&(t.subscriptionType=e.subscription?e.subscription.subscription_type:null),e.hasOwnProperty("is_third_party")&&(t.thirdParty=e.is_third_party),n.hasOwnProperty("account_purpose")&&(t.purpose=n.account_purpose?n.account_purpose.value:null),n.hasOwnProperty("account_role")&&(t.role=n.account_role?n.account_role.value:null),n.hasOwnProperty("account_field")&&(t.field=n.account_field?n.account_field.value:null),i&&(t.teamRole=i),t}},{key:"updateVisitorData",value:function(e){this.pendoEnabled()&&pendo.updateOptions({visitor:this.createVisitorData(e)})}},{key:"createAccountData",value:function(e){var t=Object(ie.get)(e,"group_attributes",null);return{id:Object(ie.get)(e,"id",null),name:Object(ie.get)(e,"name",null),subscriptionType:Object(ie.get)(e,"subscription.type",null),subscriptionEndDate:Object(ie.get)(e,"subscription.paid_through_date",null),usersCount:Object(ie.get)(e,"users_count",null),purpose:this.getGroupAttributeValue(t,"account_purpose"),field:this.getGroupAttributeValue(t,"account_field"),companyWebsite:this.getGroupAttributeValue(t,"account_company_website"),companySize:this.getGroupAttributeValue(t,"account_company_size")}}},{key:"flushQueuedEvents",value:function(){var e=this;this.queuedEvents.forEach((function(t){e.track(t.trackType,t.metadata)}))}},{key:"track",value:function(e,t){this.pendoEnabled()&&(this.initialized?pendo.track(e,t):this.queuedEvents.push({trackType:e,metadata:t}))}},{key:"trackOncePerSession",value:function(e,t){this.sessionEvents[e]||this.pendoEnabled()&&(this.track(e,t),this.sessionEvents[e]=!0)}},{key:"trackOncePerPage",value:function(e,t){this.pageEvents[e]||this.pendoEnabled()&&(this.track(e,t),this.pageEvents[e]=!0)}},{key:"trackSignIn",value:function(e){this.trackSignInSignUp("Sign In - Success",e)}},{key:"trackSignUp",value:function(e){this.trackSignInSignUp("Sign Up - Success",e)}},{key:"trackSignInSignUp",value:function(e,t){var n=this.route.snapshot.queryParams;this.track(e,{type:t,referrer:document.referrer,refParam:n.ref||null,groupInvite:n.hasOwnProperty("group_invite"),groupCode:n.hasOwnProperty("group")&&n.hasOwnProperty("code")})}},{key:"initRouteListener",value:function(){var e=this;this.router.events.pipe(Object(Y.a)((function(e){return e instanceof te.c}))).subscribe((function(){e.pageEvents={}}))}},{key:"pendoEnabled",value:function(){if(!this.config.enabled)return!1;var e=Object(ie.get)(this.config,"whitelist[".concat(T.application,"]"),null);if(!Object(ie.isNil)(e)){var t=new URLSearchParams(window.location.search),n=t.get("id")||t.get("be")||t.get("m");return e.includes(n)}return!0}},{key:"setIds",value:function(e){var t=Object(ie.get)(this.config,"idPrefixes[".concat(T.deploy,"]"),"");e.visitor.id="".concat(t).concat(e.visitor.id),e.account.id&&(e.account.id="".concat(t).concat(e.account.id))}},{key:"getGroupAttributeValue",value:function(e,t){if(!e)return null;var n=this.organizationsService.getOrganizationAttribute(e,"account_settings",t);return n?n.value:null}}]),e}()).\u0275fac=function(e){return new(e||me)(j.Zb("pendoConfig"),j.Zb(te.e),j.Zb(te.a),j.Zb(ye))},me.\u0275prov=j.Lb({token:me,factory:me.\u0275fac,providedIn:"root"}),me),we=r("ofXK"),ke=r("2Yyj"),Ce=r.n(ke),Se=r("Kd/A"),_e=r.n(Se),je=r("Hfs6"),Pe=r.n(je),Me=r("VLs4"),Ie=r.n(Me),ze=r("1IWC"),Te=r.n(ze),Ue=r("Paii"),De=r.n(Ue),Le=r("vT00"),Ee={title:"English",lang:"en",country:"us",id:"en-US"},Fe=[Ee,{title:"Espa\xf1ol",lang:"es",country:"es",id:"es-ES"},{title:"\u4e2d\u6587(\u7b80\u4f53)",lang:"zh",country:"cn",id:"zh-CN"},{title:"Fran\xe7ais",lang:"fr",country:"fr",id:"fr-FR"},{title:"Deutsch",lang:"de",country:"de",id:"de-DE"},{title:"Italiano",lang:"it",country:"it",id:"it-IT"},{title:"\u65e5\u672c\u8a9e",lang:"ja",country:"ja",id:"ja"},{title:"Portugu\xeas",lang:"pt",country:"pt",id:"pt-PT"}];function Ae(){var e="";try{e=localStorage.getItem("locale")}catch(t){}return(Fe.find((function(t){return t.id===e}))||Ee).id}[Ce.a,_e.a,Pe.a,Ie.a,Te.a,De.a,r.n(Le).a].forEach((function(e){Object(we.y)(e)}));var Re,Ve,Ne,Be,He,Qe=((Ne=function(){function e(){y(this,e)}return v(e,null,[{key:"forRoot",value:function(){return{ngModule:e,providers:[{provide:j.w,useFactory:Ae}]}}}]),e}()).\u0275mod=j.Nb({type:Ne}),Ne.\u0275inj=j.Mb({factory:function(e){return new(e||Ne)},imports:[[we.c]]}),Ne),qe=((Ve=function e(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Ee.lang,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];y(this,e),this.id=t,this.type=n,this.lang=i,this.preview=o}).type="[Story] Load Current Story",Ve),$e=function(){var e=function e(t){y(this,e),this.story=t};return e.type="[Story] Replace the Story",e}(),We=function(){var e=function e(t){y(this,e),this.id=t};return e.type="[Story] Set the Story ID",e}(),Ke=function(){var e=function e(t){y(this,e),this.displayName=t};return e.type="[Story] Set Story Text",e}(),Ge=function(){var e=function e(t){y(this,e),this.tags=t};return e.type="[Story] Set Story Tags",e}(),Ze=function(){var e=function e(t){y(this,e),this.lightLibs=t};return e.type="[Story] Set Story Light Libs",e}(),Je=function(){var e=function e(t,n,i){y(this,e),this.id=t,this.type=n,this.reset=i};return e.type="[Story] Set Incoming Story Id",e}(),Xe=function(){var e=function e(){y(this,e)};return e.type="[Story] Load Story Chunk",e}(),Ye=function(){var e=function e(t){y(this,e),this.chapterId=t};return e.type="[Story] Reorder Load Chunks",e}(),et=function(){var e=function e(t){y(this,e),this.chunk=t};return e.type="[Story] Load Story Chunk Success",e}(),tt=function(){var e=function e(t,n,i,o){y(this,e),this.id=t,this.story=n,this.type=i,this.chapterIdx=o};return e.type="[Story] Build Story In Engine From Story Model",e}(),nt=function(){var e=function e(t,n,i){y(this,e),this.story=t,this.id=n,this.type=i};return e.type="[Story] Load Success",e}(),it=function(){var e=function e(t,n){y(this,e),this.id=t,this.type=n};return e.type="[Story] Load Fail",e}(),ot=((Re=function e(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Ee.lang;y(this,e),this.id=t,this.type=n,this.lang=i}).type="[Story] Import",Re),rt=function(){var e=function e(t,n,i){y(this,e),this.story=t,this.id=n,this.type=i};return e.type="[Story] Import Success",e}(),at=function(){var e=function e(){y(this,e)};return e.type="[Story] Clear",e}(),st=function(){var e=function e(){y(this,e)};return e.type="[Story] Synchronize Chapters",e}(),ct=function(){var e=function e(){y(this,e)};return e.type="[Story] Human Ready (Web)",e}(),lt=function(){var e=function e(){y(this,e)};return e.type="[Story] Human Ready (SDK)",e}(),pt=function(){var e=function e(t){y(this,e),this.story=t};return e.type="[Story] Merge Bridge Module Success",e}(),ut=function e(){y(this,e)},dt=function(){var e=function e(){y(this,e)};return e.type="[Engine] Load",e}(),gt=function(){var e=function e(t){y(this,e),this.result=t};return e.type="[Engine] Load Success",e}(),ht=function(){var e=function e(t){y(this,e),this.ready=t};return e.type="[Engine] Set Ready",e}(),ft=function(){var e=function e(t){y(this,e),this.display=t};return e.type="[Engine] Set Display of 3D Scene",e}(),bt=function(){var e=function e(t){y(this,e),this.scrollMode=t};return e.type="[Engine] Set Zoom via scroll Allowed",e}(),mt=function(){var e=function e(t){y(this,e),this.shown=t};return e.type="[Engine] Set Scroll Alert Shwon",e}(),vt=function(){var e=function e(t){y(this,e),this.visible=t};return e.type="[Engine] Set Visibility of 3D Scene",e}(),yt=function(){var e=function e(t,n){y(this,e),this.color=t,this.duration=n};return e.type="[Engine] Fade",e}(),xt=function(){var e=function e(){y(this,e)};return e.type="[Engine] Fade Complete",e}(),Ot=function(){var e=function e(t){y(this,e),this.graph=t};return e.type="[Engine] Set Graph",e}(),wt=function(){var e=function e(){y(this,e)};return e.type="[Engine] Clear Graph",e}(),kt=function(){var e=function e(t){y(this,e),this.enabled=t};return e.type="[Engine] Set Xray Mode",e}(),Ct=function(){var e=function e(t){y(this,e),this.chapterId=t};return e.type="[Engine] Set Engine Chapter",e}(),St=function(){var e=function e(t){y(this,e),this.chapterInit=t};return e.type="[Eninge] Set Chapter Init",e}(),_t=function(){var e=function e(t,n,i){y(this,e),this.node=t,this.event=n,this.hit=i};return e.type="[Engine] Click Node",e}(),jt=function(){var e=function e(t,n){y(this,e),this.node=t,this.hit=n};return e.type="[Engine] Set Contextmenu",e}(),Pt=function(){var e=function e(t){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=arguments.length>2?arguments[2]:void 0;y(this,e),this.objectId=t,this.animate=n,this.animationDuration=i};return e.type="[Engine] Fly To Object",e}(),Mt=function(){var e=function e(){y(this,e)};return e.type="[Engine] Center Camera on Visible Nodes",e}(),It=function(){var e=function e(t,n){y(this,e),this.leafVisibilityState=t,this.nodes=n};return e.type="[Engine] Synchronize Visible Nodes On Tree",e}(),zt=function(){var e=function e(t){y(this,e),this.leafRenderableState=t};return e.type="[Engine] Synchronize Renderable State of Nodes On Tree",e}(),Tt=function(){var e=function e(t,n){y(this,e),this.leafPickableState=t,this.nodes=n};return e.type="[Engine] Synchronize Pickable State of Nodes On Tree",e}(),Ut=function(){var e=function e(t){y(this,e),this.show=t};return e.type="[Engine] Toggle Camera Bar",e}(),Dt=function(){var e=function e(t){y(this,e),this.show=t};return e.type="[Engine] Toggle Progress Bar",e}(),Lt=function(){var e=function e(t){y(this,e),this.show=t};return e.type="[Engine] Toggle Labels",e}(),Et=function(){var e=function e(t){y(this,e),this.tool=t};return e.type="[Engine] Set active tool",e}(),Ft=function(){var e=function e(t,n){y(this,e),this.chapter=t,this.pause=n};return e.type="[Engine] Play chapter animation",e}(),At=function(){var e=function e(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];y(this,e),this.play=t};return e.type="[Engine] Play animation",e}(),Rt=function(){var e=function e(t){y(this,e),this.playing=t};return e.type="[Engine] Set animation playing",e}(),Vt=function(){var e=function e(t){y(this,e),this.speed=t};return e.type="[Engine] Set playback speed",e}(),Nt=function(){var e=function e(t){y(this,e),this.play=t};return e.type="[Engine] Play audio",e}(),Bt=function(){var e=function e(){y(this,e)};return e.type="[Engine] Play chapter from start",e}(),Ht=function(){var e=function e(t){y(this,e),this.enable=t};return e.type="[Engine] Set autoplay",e}(),Qt=function(){var e=function e(t,n){y(this,e),this.nodes=t,this.layer=n};return e.type="[Engine] Set object layer order",e}(),qt=function(){var e=function e(t,n){y(this,e),this.nodeId=t,this.displayName=n};return e.type="[Engine] Set object display name",e}(),$t=function(){var e=function e(){y(this,e)};return e.type="[Engine] Auto Sort object layer orders",e}(),Wt=function(){var e=function e(){y(this,e)};return e.type="[Engine] Reset object layer orders",e}(),Kt=function(){var e=function e(t){y(this,e),this.position=t};return e.type="[Engine] Set Engine Position",e}(),Gt=function(){var e=function e(){y(this,e)};return e.type="[Engine] Reset Engine Position",e}(),Zt=function(){var e=function e(t){y(this,e),this.effects=t};return e.type="[Engine] Set Post Processing Effects",e}(),Jt=function(){var e=function e(t){y(this,e),this.properties=t};return e.type="[Engine] Set Properties",e}(),Xt=function(){var e=function e(t){y(this,e),this.mode=t};return e.type="[Engine] Set Transparency Mode",e}(),Yt=function(){var e=function e(t){y(this,e),this.node=t};return e.type="[Engine] Expand ViewTree Node",e}(),en=function(){var e=function e(t){y(this,e),this.node=t};return e.type="[Engine] Collapse ViewTree Node",e}(),tn=function(){var e=function e(){y(this,e)};return e.type="[Engine] Collapse All ViewTree Nodes",e}(),nn=function(){var e=function e(t,n){y(this,e),this.node=t,this.hit=n};return e.type="[Engine] Hover Node",e}(),on=function(){var e=function e(t){y(this,e),this.node=t};return e.type="[Engine] Set Label Edit Node",e}(),rn=function(){var e=function e(t,n){y(this,e),this.node=t,this.info=n};return e.type="[Engine] Set Node Info",e}(),an=function(){var e=function e(t,n,i){y(this,e),this.node=t,this.fallback=n,this.lang=i};return e.type="[Engine] Query Node Info",e}(),sn=function(){var e=function e(t,n){y(this,e),this.node=t,this.info=n};return e.type="[Engine] Query Node Info Success",e}(),cn=function(){var e=function e(t){y(this,e),this.node=t};return e.type="[Engine Nodes] Query Node Info Failure",e}(),ln=function(){var e=function e(t){y(this,e),this.enabled=t};return e.type="[Engine] Set Watermark Enabled",e}(),pn=function e(){y(this,e)},un=function e(t){var n=this;y(this,e),this.shown=function(e){return!1},this.selected=function(e){return!1},this.pickable=function(e){return!0},t.forEach((function(e){n[e]=function(e){return!1}}))};!function(e){function t(e,t){e.nodes[t.id]||(e.nodes[t.id]=t)}function n(e,t){return e.nodes[t]||null}function i(e,t){return e.predecessors[t]||null}function o(e,t){return p(e.successors[t]||[])}function r(e){return Object.keys(e.roots)}e.addRootNode=function(e,i){t(e,i);var o=n(e,i.id);e.roots[o.id]=o},e.getNodes=function(e,t){var n=[];return t.forEach((function(t){e.nodes[t]&&n.push(e.nodes[t])})),n},e.getAncestors=function(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"ascending",o=n?[t]:[],r=e.predecessors[t];r;)o.push(r),r=e.predecessors[r];return"descending"===i&&o.reverse(),o},e.addNode=t,e.getNode=n,e.getAncestor=i,e.getAllAncestorsFromList=function(e,t){var n,o={};return t.forEach((function(t){(n=i(e,t))&&!o[n]&&(o[n]=!0)})),Object.keys(o)},e.getSuccessors=o,e.getState=function(e,t,i){var o={},r=n(e,t);return Object.entries(r.boolState).forEach((function(e){var t=d(e,2),n=t[0],r=t[1];i&&i.includes(n)&&(o[n]=r)})),Object.entries(r.numState).forEach((function(e){var t=d(e,2),n=t[0],r=t[1];i&&i.includes(n)&&(o[n]=r)})),o},e.isLeaf=function(e,t){return!!e.nodes[t]&&void 0===e.successors[t]},e.isRoot=function(e,t){return e.roots.hasOwnProperty(t)||!1},e.getRoots=r,e.depthFirst=function e(t,n,i){i?(n(i),o(t,i).forEach((function(i){e(t,n,i)}))):r(t).forEach((function(i){n(i),e(t,n,i)}))},e.createGraphFromSrc=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"objectId",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"objects",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o={nodes:{},successors:{},predecessors:{},roots:{}};return e.forEach((function(e){!function e(t,n,i,o,r,a,s){var c={id:i[o],depth:0,boolState:{},numState:{}};c.depth=s,function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"id";Object.entries(n).forEach((function(n){var o,r=d(n,2),a=r[0],s=r[1];"string"==typeof s?o=t[s]:"function"==typeof s&&(o=s(t[i])),"boolean"==typeof o?e.boolState[a]=o:"number"==typeof o?e.numState[a]=o:e[a]=o}))}(c,i,a,o),t.nodes[c.id]=c,n?(t.successors[n]=[].concat(p(t.successors[n]||[]),[c.id]),t.predecessors[c.id]=n):t.roots[c.id]=c,s+=1,(i[r]||[]).forEach((function(n){e(t,c.id,n,o,r,a,s)}))}(o,null,e,t,n,i,0)})),o},e.pruneHiddenObjects=function e(t,n,i){var o,r=[],a=l(t);try{for(a.s();!(o=a.n()).done;){var s=o.value,c=n[s.objectId],p=!0===c||!1!==c&&i,u=e(s.objects||[],n,p);if(p){var d=Object.assign({},s);d.objects=u,r.push(d)}else u.forEach((function(e){return r.push(e)}))}}catch(g){a.e(g)}finally{a.f()}return r}}(Be||(Be={})),function(e){function t(e,t){return e.reduce((function(e,n){return e[n]=t[n]||!1,e}),{})}e.createVoter=t,e.getInitialVoterState=function(e,n){return Object.keys(e).reduce((function(i,o){return i[o]=t(n,e[o]),i}),{})},e.getInitialElectionDepth=function(e,t){return Object.keys(e).reduce((function(e,n){return Math.max(e,Be.getNode(t,n).depth)}),0)-1},e.getEligibleElections=function(e,t,n){return Be.getAllAncestorsFromList(e,t).filter((function(t){return t&&Be.getNode(e,t).depth===n}))};var n={trueWins:function(e){return{result:e.votesFor.length>0,dissenters:p(e.votesAgainst)}},falseWins:function(e){return{result:e.votesAgainst.length>0,dissenters:p(e.votesFor)}},majorityWins:function(e){var t=e.votesFor.length>e.votesAgainst.length;return{result:t,dissenters:p(t?e.votesAgainst:e.votesFor)}}};function i(e,t,i){return Object.keys(t).reduce((function(o,r){var a=t[r],s=i[r]||"majorityWins",c=n[s](a),l=c.result,u=c.dissenters;return o[r]={id:e,result:l,dissenters:u,voters:[].concat(p(a.votesFor),p(a.votesAgainst))},o}),{})}e.buildElectionResult=i,e.getElectionResults=function(e,n,o,r){var a=n,s=Object.keys(r);return{results:o.reduce((function(o,l){var p=Be.getSuccessors(e,l),u=p.map((function(i){return c({},i,n[i]||t(s,Be.getState(e,i,s)))}));p.forEach((function(e){delete a[e]}));var g=i(l,function(e,t){return Object.keys(e).reduce((function(e,n){var i=t.reduce((function(e,t){var i=Object.keys(t)[0];return t[i][n]?e.votesFor.push(i):e.votesAgainst.push(i),e}),{votesFor:[],votesAgainst:[]});return e[n]=i,e}),{})}(r,u),r);return a[l]=Object.entries(g).reduce((function(e,t){var n=d(t,2),i=n[0],o=n[1];return e[i]=o.result,e}),{}),o.results.push(g),o}),{results:[]}).results,remainingVoters:a}}}(He||(He={}));var dn,gn,hn,fn,bn,mn=((dn=function(){function e(){y(this,e)}return v(e,[{key:"serializeNode",value:function(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(e){return!0},r={};return r.id=t.id,Object.entries(t.boolState).forEach((function(e){var t=d(e,2),n=t[0],o=t[1];i.hasOwnProperty(n)&&(r[n]=o)})),Object.entries(t.numState).forEach((function(e){var t=d(e,2),n=t[0],o=t[1];i.hasOwnProperty(n)&&(r[n]=o)})),e.successors[t.id]&&(r.children=[],e.successors[t.id].forEach((function(t){o(t)&&r.children.push(n.serializeNode(e,e.nodes[t],i,o))}),this)),r}},{key:"getAllSiblingsFromList",value:function(e,t,n){var i,o=[];for(i=0;i<t.length;i++)this.getSiblings(e,t[i],n).forEach((function(e){o.includes(e)||o.push(e)}));return o}},{key:"getElectionResults",value:function(e,t,i,r){var s,c,l=this,p=function(e){n(i,e);var t=o(i);function i(e,n){var o;return y(this,i),o=t.call(this),Object.entries(e).forEach((function(e){var t=d(e,2),i=t[0];t[1],o[i]={votesFor:[],votesAgainst:[]},Object.entries(n).forEach((function(e){var t=d(e,2),n=t[0];t[1][i]?o[i].votesFor.push(n):o[i].votesAgainst.push(n)}),a(o))}),a(o)),o}return i}(function(){return function e(){y(this,e)}}()),u=Object.keys(r),g=[];return i.forEach((function(n){c={},Be.getSuccessors(e,n).forEach((function(n){c[n]=t[n]||He.createVoter(u,Be.getState(e,n,u)),delete t[n]}),l),s=new p(r,c);var i=He.buildElectionResult(n,s,r);g.push(i);var o={};Object.entries(i).forEach((function(e){var t=d(e,2),n=t[0],i=t[1];o[n]=i.result})),t[n]=o}),this),g}},{key:"updateGraphStateRecord",value:function(e,t,n,i){var o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];n.forEach((function(n){var r=n[i[0]].id,a=Be.getState(e,r,i),s={},c=!1;i.forEach((function(e){(o||n[e].result!==a[e])&&(s[e]=n[e].result,c=!0)})),c&&(t[r]=s)}),this)}},{key:"nodeExists",value:function(e,t){return!!e.nodes[t]}},{key:"getLeaves",value:function(e){var t=[];return Object.entries(e.nodes).forEach((function(n){var i=d(n,2),o=i[0];i[1],e.successors[o]||t.push(o)})),t}},{key:"getDescendants",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=[];return function t(n){Be.getSuccessors(e,n).forEach((function(e){i.push(e),t(e)}))}(t),n&&i.push(t),i}},{key:"getLeafDescendants",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=this.getDescendants(e,t,n).filter((function(t){return Be.isLeaf(e,t)}));return(Be.isLeaf(e,t)||n)&&i.push(t),i}},{key:"getAllLeafDescendants",value:function(e,t){var n=this,i=[];return t.forEach((function(t){i=Be.isLeaf(e,t)?[].concat(p(i),[t]):[].concat(p(i),p(n.getLeafDescendants(e,t,!1)))})),i.sort().reduce((function(e,t){return e.indexOf(t)<0&&e.push(t),e}),[])}},{key:"getInverseSelection",value:function(e,t){var n=this.getAllLeafDescendants(e,t);return this.getLeaves(e).filter((function(e){return n.indexOf(e)<0}))}},{key:"getSiblings",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=e.predecessors[t],o=[];if(o=i?Be.getSuccessors(e,i):Be.getRoots(e),!n){var r=o.indexOf(t);r>=0&&o.splice(r,1)}return o}},{key:"getNodes",value:function(e,t){var n=[];return t.forEach((function(t){e.nodes[t]&&n.push(e.nodes[t])})),n}},{key:"setState",value:function(e,t,n){var i=Be.getNode(e,t),o={};return Object.entries(n).forEach((function(e){var t=d(e,2),n=t[0],r=t[1];"boolean"==typeof r&&i.boolState[n]!==r?(i.boolState[n]=r,o[n]=r):"number"==typeof r&&i.numState[n]!==r&&(i.numState[n]=r,o[n]=r)})),o}},{key:"synchronize",value:function(e,t,n){var i=this,o=this.calculateGraphStateMap(e,t,n);return Object.entries(o).forEach((function(t){var n=d(t,2),o=n[0],r=n[1];i.setState(e,o,r)}),this),o}},{key:"calculateGraphStateMap",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:!n,o=[],r={},a=[],s={},c=Object.keys(t),l=0;for(n?Object.entries(n).forEach((function(t){var i=d(t,2),o=i[0];i[1],r[o]=He.createVoter(c,n[o]),s[o]=Object.assign({},r[o]),l=Math.max(l,Be.getNode(e,o).depth)}),this):this.getLeaves(e).forEach((function(t){r[t]=He.createVoter(c,Be.getNode(e,t).boolState),s[t]=Object.assign({},r[t]),l=Math.max(l,Be.getNode(e,t).depth)}),this),l-=1,o=He.getEligibleElections(e,Object.keys(r),l);l>=0;)a=this.getElectionResults(e,r,o,t),this.updateGraphStateRecord(e,s,a,c,i),l-=1,o=He.getEligibleElections(e,Object.keys(r),l);return s}},{key:"filterGraphAccessors",value:function(e,t){var n=this,i=this.getNodes(e,t).sort((function(e,t){return e.depth-t.depth})),o=new Map;return i.filter((function(t){return!o.has(t.id)&&(n.getDescendants(e,t.id,!0).forEach((function(e){return o.set(e,!0)})),!0)})).map((function(e){return e.id}))}},{key:"resetDepth",value:function(e){Be.depthFirst(e,(function(t){var n=0;e.predecessors[t]&&(n=Be.getNode(e,e.predecessors[t]).depth+1),Be.getNode(e,t).depth=n}))}},{key:"deleteNode",value:function(e,t){var n=this,i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(this.nodeExists(e,t)){delete e.nodes[t];var o=e.predecessors[t];o&&(delete e.predecessors[t],e.successors[o]&&(e.successors[o]=e.successors[o].filter((function(e){return e!==t}))));var r=e.successors[t];r&&(delete e.successors[t],i&&r.forEach((function(t){n.deleteNode(e,t)}),this)),e.roots[t]&&delete e.roots[t]}}},{key:"sanitizeNodeID",value:function(e){var t=new RegExp(/\|:/,"gi");return e.replace(t,"_")}},{key:"resetAsLeaf",value:function(e,t){var n=[];return e.nodes[t]&&!Be.isLeaf(e,t)&&(n=this.getDescendants(e,t),delete e.successors[t],n.forEach((function(t){delete e.nodes[t],delete e.successors[t],delete e.predecessors[t]}))),n}}]),e}()).\u0275fac=function(e){return new(e||dn)},dn.\u0275prov=j.Lb({token:dn,factory:dn.\u0275fac,providedIn:"root"}),dn),vn=function e(){y(this,e)},yn=function(e){return e.Started="started",e.Loaded="loaded",e.Tick="tick",e.HumanReady="human.ready",e.HumanStarted="started",e.Error="error",e.HumanError="human.error",e.CanvasResized="canvas.resized",e.HumanCanvasResized="human.canvasResized",e.LogDebug="_log.debug",e.LogError="_log.error",e.LogInfo="_log.info",e.LogWarn="_log.warn",e.SceneLoaded="scene.loaded",e.HumanProgress="human.progress",e.AnnotationsCreated="annotations.created",e.AnnotationsDestroyed="annotations.destroyed",e.AnnotationsHidden="annotations.hidden",e.AnnotationsShown="annotations.shown",e.AssetsLoadFinish="assets.load.finish",e.AssetsLoadProgress="assets.load.progress",e.AssetsLoadStart="assets.load.start",e.CameraRested="camera.rested",e.CameraUpdated="camera.updated",e.HotspotsDisplayUpdated="hotspots.displayUpdated",e.HotspotsEntered="hotspots.entered",e.HotspotsLeft="hotspots.left",e.HotspotsPicked="hotspots.picked",e.HotspotsPositionUpdated="hotspots.positionUpdated",e.LabelsCreated="labels.created",e.LabelsUpdated="labels.updated",e.LabelsMoved="labels.moved",e.LabelsDestroyed="labels.destroyed",e.LabelsChapterInfo="labels.chapterInfo",e.LabelsShown="labels.shown",e.LabelsHidden="labels.hidden",e.LabelsEnabled="labels.enabled",e.LabelsDisabled="labels.disabled",e.LabelsEntered="labels.entered",e.LabelsLeft="labels.left",e.LabelsPicked="labels.picked",e.ModuleInteractive="module.interactive",e.ModulesActivateFinish="modules.activate.finish",e.ModulesCreateFinish="modules.create.finish",e.ModulesDestroyFinish="modules.destroy.finish",e.PickPicked="pick.picked",e.QuizEntered="quiz.entered",e.QuizExited="quiz.exited",e.QuizQuestionLoaded="quiz.questionLoaded",e.QuizAnswerSelected="quiz.answerSelected",e.QuizAnswerSubmitted="quiz.answerSubmitted",e.QuizCompleted="quiz.completed",e.SceneMarkersUpdated="scene.markers.updated",e.SceneObjectRenderable="scene.objectRenderable",e.SceneObjectsSelected="scene.objectsSelected",e.SceneObjectsShown="scene.objectsShown",e.ScenePicked="scene.picked",e.SceneRestored="scene.restored",e.SceneXrayEnabled="scene.xrayEnabled",e.SceneXrayDisabled="scene.xrayDisabled",e.SceneReady="scene.ready",e.TimelineChaptersActivated="timeline.chapters.activated",e.TimelineChaptersActivateFinish="timeline.chapters.activate.finish",e.TimelineChaptersActivateStart="timeline.chapters.activate.start",e.TimelineChapterTransition="timeline.chapterTransition",e.TimelinePlaying="timeline.playing",e.TimelineScrubbed="timeline.scrubbed",e.TimelinePlayed="timeline.played",e.TimelineStopped="timeline.stopped",e.TimelinePaused="timeline.paused",e.TimelineUnpaused="timeline.unpaused",e.TimelineCompleted="timeline.completed",e.TimelineTimeFrameUpdated="timeline.timeFrame.updated",e.GraphAssetAttachFinish="graph.assetAttach.finish",e.TweenVisibilityUpdate="TweenVisibilityUpdate",e.NativeDeleteData="native.deleteData",e.NativeUpgrade="native.upgrade",e.NativeRestore="native.restore",e.NativeShare="native.share",e.NativeGoogleSignUp="native.googleSignUp",e.NativeDebugMessage="native.debugMessage",e}({}),xn=function(e){return e.SSAO="sao",e.Blur="blur",e.RadialBlur="radialBlur",e.DOF="dof",e.FXAA="fxaa",e.GroundShadow="groundShadow",e}({}),On={shown:"shown",renderable:function(e){return Human.scene.objects[e].isRenderable()},pickable:"pickable",label:function(e){return Human.scene.objects[e].displayName},expanded:function(e){return!1},layer:"layer"},wn={shown:"trueWins",renderable:"falseWins",pickable:"trueWins"},kn={trim:!0},Cn=function e(t){y(this,e),this.trim=t.trim||!1,this.terminal=t.terminal||[],this.root=t.root||{children:[],replace:!1},this.connect=t.connect||{},this.nodes=t.nodes||[]},Sn=((gn=function(){function e(t){var n=this;y(this,e),this.graphService=t,this.objectToNodeMap={},this.nodeToObjectMap={},this.events={},this.events=Object.values(yn).reduce((function(e,t){return e[t]=n.makeObservable(t),e}),{})}return v(e,[{key:"makeObservable",value:function(e){return new J.a((function(t){Human.events.on(e,(function(e){t.next(e)}))}))}},{key:"getCanvas",value:function(){return Human.renderer.canvas.canvas}},{key:"getEvent",value:function(e){return this.events[e]}},{key:"fireEvent",value:function(e,t){Human.events.fire(e,t)}},{key:"getSceneBoundary",value:function(){return Human.scene.getBoundary()}},{key:"getObjectBoundary",value:function(e){return Human.scene.objects[e].getBoundary()}},{key:"getObjectLoaded",value:function(e){var t=this.getObjectBoundary(e);return!Object(ie.isNil)(t)&&Object.values(t).every((function(e){return isFinite(e)}))}},{key:"pickScene",value:function(e){return Human.renderer.pick.pick(e.x,e.y,{rayPick:e.rayPick})}},{key:"transformObject",value:function(e,t){var n=Human.scene.objects[e];n?n.setTransform(t):console.error("Scene object not found: '".concat(e,"'"))}},{key:"toggleNodes",value:function(e,t){var n=this,i={replace:!1,objects:{},fetchAssets:t};e.forEach((function(e){n.getObjects(e).forEach((function(e){i.objects[e]=t}))})),Human.scene.setEnabledObjects(i)}},{key:"setNodesVisible",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n={replace:t,objects:Object.assign({},e),fetchAssets:!0};Human.scene.setEnabledObjects(n)}},{key:"setNodesPickable",value:function(e){var t=this;Object.keys(e).forEach((function(n){(Human.scene.objects[n].isLeaf()?[n]:t.getLeafObjects(n)).forEach((function(t){Human.scene.objects[t].setPickable(e[n])}))}))}},{key:"filterObjects",value:function(e,t){for(var n=e.length;n--;)switch(!0){case e[n]instanceof Human.scene.Group:e[n].objects=this.filterObjects(e[n].objects,t),0===e[n].objects.length&&e.splice(n,1);break;case e[n]instanceof Human.scene.Object:-1===e[n].displayName.toLowerCase().indexOf(t)&&e.splice(n,1)}return e}},{key:"setObjectLayer",value:function(e,t){var n=Human.scene.objects[e];if(n.layer=t,n.renderables)for(var i=0;i<n.renderables.length;++i)n.renderables[i].setLayer(t);else n.hasOwnProperty("_layerNode")?n._layerNode.setPriority(t):n.hasOwnProperty("_propertiesNode")&&n._propertiesNode.setProperties({layer:t})}},{key:"getObjectLayerValues",value:function(e){var t={},n=Human.scene.getBoundary();return e.forEach((function(e){var i=Human.scene.objects[e],o=i.getBoundary(),r=Math.min(o.xmin-n.xmin,n.xmax-o.xmax),a=2*Math.min(o.ymin-n.ymin,n.ymax-o.ymax),s=Math.min(o.zmin-n.zmin,n.zmax-o.zmax),c=i.layer;t[c]=t[c]||[],t[c].push({nodeId:e,value:Math.min(r,a,s)})})),t}},{key:"getSceneGraph",value:function(e){var t=Be.createGraphFromSrc(e,"objectId","objects",On);return this.graphService.synchronize(t,wn),t}},{key:"createViewGraph",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=t?Be.pruneHiddenObjects(Human.scene.rootObjects,e):Human.scene.rootObjects,o=i.reduce((function(e,t){var i=!n&&t.objectId.includes("-root");return e[t.objectId]=!0!==i,i&&t.objects.forEach((function(t){e[t.objectId]=!0})),e}),{}),r=this.getSceneGraph(Be.pruneHiddenObjects(i,o));return this.graphService.resetDepth(r),r}},{key:"getNode",value:function(e,t){return this.graphService.nodeExists(e,t)?Be.getNode(e,t):this.objectToNodeMap[t]?Be.getNode(e,this.objectToNodeMap[t]):null}},{key:"getChapterGraphConfig",value:function(){var e=Human.timeline.activeRoot._nowBranch;return new Cn(Object.assign(Object.assign({},kn),e.graph||{}))}},{key:"getRootObjects",value:function(){return Human.scene.rootObjects}},{key:"getAllSceneObjects",value:function(){return Human.scene.objects}},{key:"getObjects",value:function(e){return this.nodeToObjectMap[e]?this.nodeToObjectMap[e]:[Human.scene.objects[e].objectId]||!1}},{key:"getLeafObjects",value:function(e){if(e in this.nodeToObjectMap){var t={};return this.nodeToObjectMap[e].forEach((function(e){Human.scene.objects[e].isLeaf()?t[e]=!0:Human.scene.getLeaves(e).forEach((function(e){t[e]=!0}))})),Object.keys(t)}return e in Human.scene.objects?Human.scene.getLeaves(e):[]}},{key:"getChapter",value:function(e){return Human.timeline.branchTimelines[e]||null}},{key:"getActiveChapters",value:function(){return Human.timeline.activeRoot?Human.timeline.activeRoot._chapters:[]}},{key:"getBoundaryFromObjects",value:function(e){return e=e.filter((function(e){return Human.scene.objects[e].isLeaf()})),Human.scene.getBoundary({objectIds:e,clipped:!0})}},{key:"getLeaves",value:function(e){return Human.scene.getLeaves(e)}},{key:"getVisibleLeaves",value:function(){return Human.scene.getEnabledLeaves()}},{key:"getCameraLookAt",value:function(){return Object(ce.plainToClass)(vn,Human.renderer.camera.getLookAt())}},{key:"barycentricToWorld",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=new Float32Array([0,0,0]);return Human.scene.objects[e].barycentricToWorldSpace(i,t,n,o),isNaN(o[0])?[0,0,0]:p(Array.from(o))}},{key:"setGraphState",value:function(e){Human.scene.setObjectProperties(e)}},{key:"getAssetNamespaces",value:function(){var e={};return Object.keys(Human.assets.loadedAssets).map((function(e){return e.split("/")[0]})).forEach((function(t){e[t]=!0})),Object.keys(e)}},{key:"loadGraphObject",value:function(e){var t=this.getObjects(e).map((function(e){return Human.scene.objects[e]}));return new J.a((function(e){Human.scene.graph.attachAssetSetsToSubtree(t,null,(function(){e.next(!0),e.complete()}))}))}},{key:"setProperties",value:function(e){Human.properties.set(e)}},{key:"getDefaultProperties",value:function(){return Human.properties.getDefaults()}},{key:"setTransparencyMode",value:function(e){Human.renderer.setTransparencyMode(e)}},{key:"setPostProcessingEnabled",value:function(e){e?Human.renderer.postprocess.enable():Human.renderer.postprocess.disable()}},{key:"setPostProcessingFeatures",value:function(e){var t=e.filter((function(e){return e.effect!==xn.GroundShadow}));Human.renderer.postprocess.parse(t);var n=e.find((function(e){return e.effect===xn.GroundShadow}));n?(Human.renderer.groundShadow.init(),Human.renderer.groundShadow.update({blurAmount:n.blur,opacity:n.opacity,translation:[n.xPos,n.yPos,n.zPos],scale:n.size})):Human.renderer.groundShadow.destroy()}},{key:"enableAnimation",value:function(){Human.timeline.enableAnimation()}},{key:"enableRender",value:function(){Human.renderer.enableRender()}},{key:"canIRender",value:function(){return Human.renderer.canIRender()}},{key:"enableLightLib",value:function(e){var t=Human.assets.lights.lightIds[e];if(Array.isArray(t)){var n={};t.forEach((function(e){n[e]=!0})),Human.renderer.lights.clearEnabled(),Human.renderer.lights.setEnabled(n)}}},{key:"setBranchLights",value:function(e,t){var n=Human.timeline.branchTimelines[e];n.lights.libraries[0]!==t&&(n.lights.libraries[0]=t,this.enableLightLib(t))}},{key:"loadLightLib",value:function(e){return new Promise((function(t,n){Human.assets.getAssetLibrary("light","lights",e,"outline",{},(function(){var i=Human.assets.lights.lightIds;Array.isArray(i[e])?t(e):n()}))}))}}]),e}()).\u0275fac=function(e){return new(e||gn)(j.Zb(mn))},gn.\u0275prov=j.Lb({token:gn,factory:gn.\u0275fac,providedIn:"root"}),gn),_n=function e(t,n,i,o,r){y(this,e),this.left=t,this.top=n,this.width=i,this.height=o,this.visibility=r},jn=function(e){return e[e.Hidden=-1]="Hidden",e[e.Shown=1]="Shown",e}({}),Pn=function e(){y(this,e)},Mn=function(){var e=function e(t){y(this,e),this.id=t};return e.type="[Engine Camera] Clear Camera",e}(),In=function(){var e=function e(t,n){y(this,e),this.id=t,this.camera=n};return e.type="[Engine Camera] Store Camera",e}(),zn=function(){var e=function e(t){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=arguments.length>2?arguments[2]:void 0,o=arguments.length>3?arguments[3]:void 0;y(this,e),this.camera=t,this.animate=n,this.animationDuration=i,this.rotationCenter=o};return e.type="[Engine Camera] Set Camera",e}(),Tn=function(){var e=function e(){y(this,e)};return e.type="[Engine Camera] Set Camera Success",e}(),Un=function(){var e=function e(t){y(this,e),this.enabled=t};return e.type="[Engine Camera] Set Chapter Camera Enabled",e}(),Dn=function(){var e=function e(t){y(this,e),this.cameraMotion=t};return e.type="[Engine Camera] Move Camera",e}(),Ln=function(){var e=function e(){y(this,e)};return e.type="[Engine Camera] Reset Camera",e}(),En=function(){var e=function e(t){y(this,e),this.value=t};return e.type="[Engine Camera] Zoom Camera",e}(),Fn=function(){var e=function e(t){y(this,e),this.value=t};return e.type="[Engine Camera] Zoom Camera Static",e}(),An=function(){var e=function e(t){y(this,e),this.value=t};return e.type="[Engine Camera] Pan Camera X",e}(),Rn=function(){var e=function e(t){y(this,e),this.value=t};return e.type="[Engine Camera] Pan Camera Y",e}(),Vn=function(){var e=function e(t,n,i){y(this,e),this.x=t,this.y=n,this.z=i};return e.type="[Engine Camera] Pan Camera Static",e}(),Nn=function(){var e=function e(t){y(this,e),this.value=t};return e.type="[Engine Camera] Rotate Camera X",e}(),Bn=function(){var e=function e(t){y(this,e),this.value=t};return e.type="[Engine Camera] Rotate Camera Y",e}(),Hn=function(){var e=function e(t,n){y(this,e),this.x=t,this.y=n};return e.type="[Engine Camera] Rotate Camera Static",e}(),Qn=function(){var e=function e(t){y(this,e),this.mode=t};return e.type="[Engine Camera] Set Camera Mode",e}(),qn=function(){var e=function e(t){y(this,e),this.zoomed=t};return e.type="[Engine Camera] Set Zoomed",e}(),$n=function(){var e=function e(t){y(this,e),this.lock=t};return e.type="[Engine Camera] Lock camera",e}(),Wn=function(){var e=function e(t){y(this,e),this.camera=t};return e.type="[Engine Camera] Set Camera Fly To",e}(),Kn=function(){var e=function e(t){y(this,e),this.patches=t};return e.type="[Engine Camera] Patch Camera State",e}(),Gn=function(){function e(){y(this,e)}return v(e,null,[{key:"toArray",value:function(e){return[e.x,e.y,e.z]}},{key:"fromArray",value:function(e){return{x:e[0],y:e[1],z:e[2]}}}]),e}(),Zn=((hn=function(){function e(){y(this,e)}return v(e,[{key:"roundModel",value:function(e,t){var n=this,i=Object.assign({},e);return Object.keys(e).filter((function(t){return"number"==typeof e[t]})).forEach((function(o){i[o]=n.roundNumber(e[o],t)})),i}},{key:"roundNumber",value:function(e,t){return Math.round(e*Math.pow(10,t))/Math.pow(10,t)}}]),e}()).\u0275fac=function(e){return new(e||hn)},hn.\u0275prov=j.Lb({token:hn,factory:hn.\u0275fac,providedIn:"root"}),hn),Jn=r("IOcx"),Xn=((fn=function(){function e(t){y(this,e),this.numberService=t,this.rotation={vx:0,vy:0},this.pan={x:0,y:0,z:0},this.zoom=0}return v(e,[{key:"getEye",value:function(){return Human.renderer.camera.eye}},{key:"setEye",value:function(e){Human.renderer.camera.setLookAt({eye:e})}},{key:"getCamera",value:function(){return Human.renderer.camera.getLookAt()}},{key:"getLookDirection",value:function(){var e=Jn.a.create();return Human.renderer.camera.getLookDir(e),e}},{key:"setCamera",value:function(e){return Human.renderer.camera.setLookAt(e)}},{key:"getCameraZoom",value:function(){return Human.renderer.camera.getZoom()}},{key:"captureCamera",value:function(){return{lookAt:Human.renderer.camera.getLookAt(),zoom:Human.renderer.camera.getZoom()}}},{key:"resetCamera",value:function(){return new J.a((function(e){Human.init.resetCamera((function(){e.next(),e.complete()}))}))}},{key:"getDirection",value:function(e){var t=this.getEye(),n=Jn.a.create();return n[0]=t.x-e.worldPos[0],n[1]=t.y-e.worldPos[1],n[2]=t.z-e.worldPos[2],Jn.a.normalize(n,n),n}},{key:"rotateCameraStatic",value:function(e,t){Human.renderer.camera.rotateX(e),Human.renderer.camera.rotateY(t)}},{key:"panCameraStatic",value:function(e,t,n){Human.renderer.camera.pan({x:e,y:t,z:n})}},{key:"setHumanZoom",value:function(e){Human.renderer.camera.zoom(e)}},{key:"setHumanZoomFactor",value:function(e){Human.renderer.camera.setZoom(e)}},{key:"getCameraRotationCenter",value:function(){return Gn.fromArray(Human.renderer.camera.rotationCenter)}},{key:"setCameraRotationCenter",value:function(e){var t;(t=Human.renderer.camera).setRotationCenter.apply(t,p(Gn.toArray(e)))}},{key:"setCameraRotation",value:function(e,t){this.rotation.vx=t,this.rotation.vy=-e}},{key:"setCameraPan",value:function(e,t){this.pan.x=e,this.pan.y=t}},{key:"setCameraZoom",value:function(e){this.zoom=.03*e}},{key:"setCameraZoomWithVelocity",value:function(e){var t=this;this.setCameraZoom(e),requestAnimationFrame((function(){e*=.85,Math.abs(e)>1&&t.setCameraZoomWithVelocity(e)}))}},{key:"tickCameraRotation",value:function(){return this.rotation.vx=this.checkEpsilon(this.rotation.vx),this.rotation.vy=this.checkEpsilon(this.rotation.vy),this.rotation}},{key:"tickCameraPan",value:function(){return this.pan.x=this.checkEpsilon(this.pan.x),this.pan.y=this.checkEpsilon(this.pan.y),this.pan.z=this.checkEpsilon(this.pan.z),this.pan}},{key:"tickCameraZoom",value:function(){return this.zoom=this.checkEpsilon(this.zoom),this.zoom}},{key:"areCamerasEqual",value:function(e,t){return this.compareXYZ(e.eye,t.eye)&&this.compareXYZ(e.look,t.look)&&this.compareXYZ(e.up,t.up)}},{key:"compareXYZ",value:function(e,t){return e.x===t.x&&e.y===t.y&&e.z===t.z}},{key:"roundCamera",value:function(e,t){var n=e.eye,i=e.look,o=e.up;return{eye:this.numberService.roundModel(n,t),look:this.numberService.roundModel(i,t),up:this.numberService.roundModel(o,t)}}},{key:"cameraAfterFlyTo",value:function(e){var t=this.getCamera(),n=Gn.toArray(t.look),i=Gn.toArray(t.eye),o=Jn.a.create();Jn.a.subtract(o,i,n);var r=Jn.a.create();Jn.a.normalize(r,o);var a=Math.abs(Jn.a.length(r)),s=Human.math.getBoundaryDiag(e),c=Math.abs(s/1.8/Math.tan(27.5))/a*2.5,l=Human.math.getBoundaryCenter(e);Jn.a.scale(o,r,c);var p=Jn.a.add(Jn.a.create(),l,o);return{eye:Gn.fromArray(p),look:Gn.fromArray(l),up:{x:0,y:1,z:0}}}},{key:"setChapterCameraEnabled",value:function(e){this.initCamera||(this.initCamera=Human.timeline.BranchTimeline.prototype.initCamera),Human.timeline.BranchTimeline.prototype.initCamera=e?this.initCamera:function(){}}},{key:"checkEpsilon",value:function(e){return Math.abs(e)<.001?0:e}}]),e}()).\u0275fac=function(e){return new(e||fn)(j.Zb(Zn))},fn.\u0275prov=j.Lb({token:fn,factory:fn.\u0275fac,providedIn:"root"}),fn),Yn=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5&&void 0!==arguments[5]&&arguments[5];y(this,e),this.zoom=t,this.panX=n,this.panY=i,this.rotateX=o,this.rotateY=r,this.applyFriction=a},ei=r("vkgz"),ti=function e(){y(this,e)},ni=function(){var e=function e(t){y(this,e),this.patches=t};return e.type="[Story Chapter] Apply Patch",e}(),ii=function(){var e=function e(){y(this,e)};return e.type="[Story Chapter] Next Chapter",e}(),oi=function(){var e=function e(){y(this,e)};return e.type="[Story Chapter] Previous Chapter",e}(),ri=function(){var e=function e(){y(this,e)};return e.type="[Story Chapter] First Chapter",e}(),ai=function(){var e=function e(){y(this,e)};return e.type="[Story Chapter] Last Chapter",e}(),si=function(){var e=function e(t){y(this,e),this.chapter=t};return e.type="[Story Chapter] Select Chapter",e}(),ci=function(){var e=function e(t){y(this,e),this.chapterId=t};return e.type="[Story Chapter] Select Chapter by chapter id",e}(),li=function(){var e=function e(t){y(this,e),this.chapters=t};return e.type="[Story Chapter] Set Chapters",e}(),pi=function(){var e=function e(t,n){y(this,e),this.chapterId=t,this.cameraAction=n};return e.type="[Story Chapter] Set Chapter Camera Action",e}(),ui=function(){var e=function e(t,n){y(this,e),this.chapterId=t,this.ui=n};return e.type="[Story Chapter] Set Chapter UI",e}(),di=function(){var e=function e(t,n){y(this,e),this.chapterId=t,this.info=n};return e.type="[Story Chapter] Set Chapter Info",e}(),gi=function(){var e=function e(t,n){y(this,e),this.chapterId=t,this.legend=n};return e.type="[Story Chapter] Set Chapter Legend",e}(),hi=function(){var e=function e(t,n){y(this,e),this.chapterId=t,this.legend=n};return e.type="[Story Chapter] Add To Chapter Legend",e}(),fi=function(){var e=function e(t,n){y(this,e),this.previousIndex=t,this.currentIndex=n};return e.type="[Story Chapter] Reorder Chapters",e}(),bi=function(){var e=function e(t,n){y(this,e),this.chapterId=t,this.readyState=n};return e.type="[Story Chapter] Set Readystate",e}(),mi=function(){var e=function e(t,n,i){y(this,e),this.chapterId=t,this.effects=n,this.properties=i};return e.type="[Story Chapter] Set Chapter PostProcessing",e}(),vi=function(){var e=function e(t,n,i){y(this,e),this.chapterId=t,this.transition=n,this.key=i};return e.type="[Story Chapter] Set Chapter Transitions",e}(),yi=function(){var e=function e(t,n){y(this,e),this.chapterIds=t,this.properties=n};return e.type="[Story Chapter] Set Chapter Properties",e}(),xi=function(){var e=function e(t,n){y(this,e),this.chapterIds=t,this.properties=n};return e.type="[Story Chapter] Remove Chapter Properties",e}(),Oi=function(){var e=function e(t,n){y(this,e),this.chapterId=t,this.transparencyMode=n};return e.type="[Story Chapter] Set Chapter Transparency Mode",e}(),wi=function(){var e=function e(t,n,i,o){y(this,e),this.chapterId=t,this.clips=n,this.enabled=i,this.record=o};return e.type="[Story Chapter] Set Chapter Clipping Planes",e}(),ki=function(){var e=function e(t,n){y(this,e),this.chapterId=t,this.background=n};return e.type="[Story Chapter] Set Chapter Background",e}(),Ci=function(){var e=function e(t){y(this,e),this.background=t};return e.type="[Story Chapter] Set All Chapters Background",e}(),Si=function(){var e=function e(){y(this,e)};return e.type="[Story Chapter] Reset Selected Chapter Background",e}(),_i=function(){var e=function e(t){y(this,e),this.background=t};return e.type="[Story Chapter] Set Selected Chapter Background",e}(),ji=function(){var e=function e(t,n){y(this,e),this.chapter=t,this.chapterId=n};return e.type="[Story Chapter] Duplicate An Existing Chapter",e}(),Pi=function(){var e=function e(t){y(this,e),this.chapter=t};return e.type="[Story Chapter] Remove Chapter",e}(),Mi=function(){var e=function e(){y(this,e)};return e.type="[Story Chapter] Reset",e}(),Ii=function(){var e=function e(t,n,i){y(this,e),this.chapterId=t,this.camera=n,this.rotationCenter=i};return e.type="[Story Chapters] Record Camera",e}(),zi=function(){var e=function e(t,n,i,o){y(this,e),this.chapterId=t,this.index=n,this.position=i,this.record=o};return e.type="[Story Chapters] Set the current visibility layers index and position",e}(),Ti=function(){var e=function e(t,n){y(this,e),this.chapterId=t,this.media=n};return e.type="[Story Chapters] Set the media object",e}(),Ui=function(){var e=function e(t,n){y(this,e),this.chapterId=t,this.contentBlocks=n};return e.type="[Story Chapters] Set the content blocks",e}(),Di=function(){var e=function e(t,n){y(this,e),this.chapterId=t,this.timelineMaps=n};return e.type="[Story Chapters] Add to timelineMap array",e}(),Li=function(){var e=function e(t,n){y(this,e),this.chapterId=t,this.updates=n};return e.type="[Story Chapters] Update timelineMap array",e}(),Ei=function(){var e=function e(t,n){y(this,e),this.chapterId=t,this.timelineMapIds=n};return e.type="[Story Chapters] Remove from timelineMap array",e}(),Fi=function(){var e=function e(t,n){y(this,e),this.chapterId=t,this.lights=n};return e.type="[Story Chapters] Set the lights",e}(),Ai=function(e){return e.Default="default",e.Plus="plus",e.Minus="minus",e.PlusMinus="plusMinus",e.Sequential="sequential",e.None="None",e}({}),Ri=function(e){return e.Annotation="annotation",e.Classic="classic",e.StudioNext="studioNext",e.Context="context",e}({}),Vi=function(e){return e.Alphabetical="alphabetical",e.Numerical="numerical",e}({}),Ni=function e(t){y(this,e),this.pinType=Ai.PlusMinus,this.sequentialType=Vi.Alphabetical,this.theme=Ri.StudioNext,this.expandTag=!0,this.showDescription=!0,this.collapseDescription=!1,this.pinGlow=!1,this.hideWire=!1,this.hideTag=!1,this.title=t},Bi=function e(){y(this,e)},Hi=function e(){y(this,e)};!function(e){var t=/(\s*[\d\.]+\s*,){2,15}\s*[\d\.]+\s*/g;function n(e){for(var t=0;t<3;t++)if(parseFloat(""+e[t])>1)return!0;return!1}function i(e){var t=document.createElement("div");t.style.backgroundColor=e,document.documentElement.appendChild(t);var n=window.getComputedStyle(t).backgroundColor.replace(/\s/g,"");return window.document.documentElement.removeChild(t),n}function o(e){var t=e.slice(0,4);3===t.length&&t.push(1);for(var n=0;n<4;n++)t[n]=parseFloat(""+t[n]),t[n]<0&&(t[n]=0),t[n]>255&&(t[n]=255);return t[3]>1&&(t[3]=1),t}function r(e){var n;if(Array.isArray(e))n=o(e);else if("string"==typeof e){var r=e.match(t);r?n=o(r[0].split(",")):(r=i(e).match(t))&&(n=o(r[0].split(",")))}return n}function a(e){var t=r(e);if(!t)throw new TypeError("Invalid color input.");var i=s(t);return{1:n(t)?i:t,255:n(t)?t:i}}function s(e){for(var t=n(e),i=[],o=0;o<3;o++){var r=t?e[o]/255:255*e[o];r=t?Math.round(100*r)/100:Math.round(r),i.push(r)}return 4===e.length&&i.push(e[3]),i}function c(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e=e.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,(function(e,t,n,i){return[t,t,n,n,i,i].join("")})).replace(/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,(function(e,t,n,i){return[t,n,i,"ff"].join("")}));var n=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e),i=parseInt(n[1],16),o=parseInt(n[2],16),r=parseInt(n[3],16),a=parseInt(n[4],16)/255;if(t){var s=u([i,o,r]);return[s[0],s[1],s[2],a]}return[i,o,r,a]}function l(e){var t=d(e,3),n=t[0],i=t[1],o=t[2];return Math.sqrt(n*n*.299+i*i*.587+o*o*.114)}function u(e){return e.map((function(e){return e/255}))}function g(e){return e.map((function(e){return Math.round(255*e)}))}function h(e){return"#"+e.map((function(e){var t=e.toString(16);return t.length%2?"0"+t:t})).join("")}e.is255=n,e.isLight=function(e,t){return t||(t=p(e)),(l(e)+l(t))/2>140.25},e.getComputedColor=i,e.convertChannels=o,e.convert=r,e.getColor=a,e.getColors=function(e){var n=[];if("string"==typeof e){var i=e.match(t);i&&(e=i.join(",")),e=e.split(",")}if(Array.isArray(e))if(Array.isArray(e[0])&&Array.isArray(e[1]))n=e;else if(e.length<=2)n=1===e.length?e.concat(e):e;else{var o=Math.floor(e.length/2);n=e.length>4?[e.slice(0,o),e.slice(o)]:[e,e]}return n.map((function(e){return a(e)}))},e.scaleColor=s,e.hexToRgba=c,e.hexToRgb=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=c(e,t);return[n[0],n[1],n[2]]},e.rgbToHex=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return h(t?g(e):e)},e.rgbToHSP=l,e.rgbaToHex=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e[0],i=e[1],o=e[2],r=255*e[3];return h(t?[].concat(p(g([n,i,o])),[r]):[n,i,o,r])},e.rgbToDecimal=u,e.rgbFromDecimal=g}(bn||(bn={}));var Qi,qi,$i=function(e,t){var n=p(e);return t.forEach((function(e){n.push(void 0!==e?Number(e):1)})),n},Wi=function(e){var t=/rgba?\((\d{1,3})\,\s*(\d{1,3})\,\s*(\d{1,3})\,?\s*(\d+\.\d{0,5})?\)/g,n=[],i=t.exec(e),o=t.exec(e);return n=$i(n,i.slice(1,5)),n=$i(n,o.slice(1,5))},Ki=function(){function e(t,n,i){y(this,e),this.colors=t,this.gradientType=n,this.colorStops=i}return v(e,null,[{key:"equals",value:function(e,t){return e.gradientType===t.gradientType&&e.colors.length===t.colors.length&&e.colors.every((function(e,n){return e===t.colors[n]}))&&e.colorStops.length===t.colorStops.length&&e.colorStops.every((function(e,n){return e===t.colorStops[n]}))}},{key:"deserialize",value:function(t){if(!Object.keys(t).length)return null;var n=[];"string"==typeof t.colors?n=Wi(t.colors):Array.isArray(t.colors)&&8===t.colors.length&&(n=t.colors.map((function(e,t){return(t+1)%4&&e<=1?Math.round(255*e):e})));var i=/radial|linear/.test(t.gradientType)?t.gradientType:"radial",o=t.colorStops;return new e(n,i,Array.isArray(o)&&2===o.length?[o[0],o[1]]:[0,100])}},{key:"toCSS",value:function(e){var t=e.colors,n="rgba(".concat(t[0],",").concat(t[1],", ").concat(t[2],", ").concat(t[3],") ").concat(e.colorStops[0],"%"),i="rgba(".concat(t[4],",").concat(t[5],", ").concat(t[6],", ").concat(t[7],") ").concat(e.colorStops[1],"%");return"radial"===e.gradientType?"radial-gradient(circle, ".concat(n,", ").concat(i,")"):"linear-gradient(180deg, ".concat(n,", ").concat(i,")")}},{key:"fromCSS",value:function(t){var n=/radial-gradient/.test(t)?"radial":"linear",i=Wi(t),o=/([0-9]+)\%/g,r=[0,100];return r[0]=Number(o.exec(t)[1]),r[1]=Number(o.exec(t)[1]),new e(i,n,r)}},{key:"isTransparent",value:function(e){if(!e||!e.colors)return!1;var t=e.colors,n=t[3];return t.length<=4?0===n:0===n&&0===t[7]}},{key:"isLight",value:function(e){var t=null==e?void 0:e.colors;if(Array.isArray(t)){var n=t.slice(0,3);return bn.isLight(n)}return!1}}]),e}(),Gi=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},Zi=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Ji=function e(){y(this,e),this[Qi]=!0};Qi=immer.immerable,Gi([Object(ce.Type)((function(){return Ni})),Object(ce.Type)((function(){return Bi})),Object(ce.Type)((function(){return vn})),Object(ce.Type)((function(){return Hi})),Object(ce.Expose)(),Zi("design:type",String)],Ji.prototype,"id",void 0),Gi([Object(ce.Expose)(),Zi("design:type",Object)],Ji.prototype,"info",void 0),Gi([Object(ce.Expose)(),Zi("design:type",Array)],Ji.prototype,"labels",void 0),Gi([Object(ce.Expose)(),Zi("design:type",Object)],Ji.prototype,"colorRecipeObjects",void 0),Gi([Object(ce.Expose)(),Zi("design:type",Array)],Ji.prototype,"hotspots",void 0),Gi([Object(ce.Expose)(),Zi("design:type",Bi)],Ji.prototype,"synchronization",void 0),Gi([Object(ce.Expose)(),Zi("design:type",Ki)],Ji.prototype,"background",void 0),Gi([Object(ce.Expose)(),Zi("design:type",Object)],Ji.prototype,"lights",void 0),Gi([Object(ce.Expose)(),Zi("design:type",Array)],Ji.prototype,"timelineMap",void 0),Gi([Object(ce.Expose)(),Zi("design:type",Object)],Ji.prototype,"camera",void 0),Gi([Object(ce.Expose)(),Zi("design:type",Object)],Ji.prototype,"transitions",void 0),Gi([Object(ce.Expose)(),Zi("design:type",Object)],Ji.prototype,"properties",void 0),Gi([Object(ce.Expose)(),Zi("design:type",Boolean)],Ji.prototype,"loop",void 0),Gi([Object(ce.Expose)(),Zi("design:type",Object)],Ji.prototype,"customData",void 0),Gi([Object(ce.Expose)(),Zi("design:type",Object)],Ji.prototype,"clippingPlanes",void 0),Gi([Object(ce.Expose)(),Zi("design:type",function(){return function e(){y(this,e)}}())],Ji.prototype,"ui",void 0),Gi([Object(ce.Expose)(),Zi("design:type",Hi)],Ji.prototype,"graph",void 0),Gi([Object(ce.Expose)(),Zi("design:type",Object)],Ji.prototype,"viewModes",void 0),Gi([Object(ce.Expose)(),Zi("design:type",Object)],Ji.prototype,"recipes",void 0),Gi([Object(ce.Expose)(),Zi("design:type",String)],Ji.prototype,"transparencyMode",void 0),Gi([Object(ce.Expose)(),Zi("design:type",Object)],Ji.prototype,"fallbackTransparency",void 0),Gi([Object(ce.Expose)(),Zi("design:type",Object)],Ji.prototype,"effects",void 0),Gi([Object(ce.Expose)(),Zi("design:type",Object)],Ji.prototype,"environment",void 0),Gi([Object(ce.Expose)(),Zi("design:type",Object)],Ji.prototype,"pickThroughObjects",void 0),Gi([Object(ce.Expose)(),Zi("design:type",Object)],Ji.prototype,"showObjects",void 0),Gi([Object(ce.Expose)(),Zi("design:type",Object)],Ji.prototype,"options",void 0),Gi([Object(ce.Expose)(),Zi("design:type",Object)],Ji.prototype,"media",void 0),Gi([Object(ce.Expose)(),Zi("design:type",Array)],Ji.prototype,"legend",void 0),Gi([Object(ce.Expose)(),Zi("design:type",function(){return function e(){y(this,e)}}())],Ji.prototype,"visibilityLayers",void 0),Gi([Object(ce.Expose)(),Zi("design:type",Array)],Ji.prototype,"contentBlocks",void 0),Gi([Object(ce.Expose)(),Zi("design:type",Array)],Ji.prototype,"quizQuestions",void 0),Gi([Object(ce.Expose)(),Zi("design:type",Object)],Ji.prototype,"thumbnails",void 0),Ji=Gi([Object(ce.Exclude)()],Ji),function(e){function t(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))}e.getUuid=t,e.idWithPrefix=function(e){return e?"".concat(e,"-").concat(t()):t()}}(qi||(qi={}));var Xi,Yi,eo,to=function e(){y(this,e)},no=function(e){return e.classicAnnotation="classic-annotation",e.classicHotspot="classic-hotspot",e.studioNext="studio-light",e}({}),io=function e(){y(this,e),this.title=null,this.description=null,this.errands=[]},oo=function(e){return e.flyToChapter="flyToChapter",e.flyToObject="flyToObject",e.flyToCamera="flyToCamera",e}({}),ro=function e(t){y(this,e),this.type=oo.flyToObject,this.value=t},ao=function e(t){y(this,e),this.type=oo.flyToCamera,this.value=t},so=function(e){return e.Circle="circle",e.CirclePlus="circle-plus",e.CircleMinus="circle-minus",e.Label="label",e.CircleLabel="circle-label",e}({}),co=function e(){y(this,e),this.type=oo.flyToChapter,this.value=null},lo={flyToCamera:"flyTo",flyToChapter:"flyTo"},po=((Xi=function(){function e(t){var n=this;y(this,e),this.engineService=t,this.convertActionToErrand=function(e,t,n){var i=new RegExp("^flyTo(Async)?"),o=new RegExp("^flyToObject(Async)?"),r=new RegExp("^flyTo[w.:]+currentChapter.[flyTo|jumpTo]"),a=n.split(":").slice(0,2),s=e,c=a[1];/currentChapter/.test(c)&&(c=c.replace("currentChapter","chapters[".concat(t,"]")));var l=null;return o.test(a[0])?l=new ro(Object(ie.get)(s,c)):i.test(a[0])?l=new ao(Object(ie.get)(s,c)):r.test(a[0])&&(l=new co),l},this.convertErrandToAction=function(e,t){var i=qi.idWithPrefix("errand").replace(/-/g,"_"),o={},r="",a=function(e){return lo[e]||e}(t.type);return t.type===oo.flyToChapter?r="".concat(a,"Async:currentChapter.").concat(n.engineService.getChapter(e.chapterId).camera.action):(r="".concat(a,"Async:currentChapter.customData.").concat(i),o[i]=t.value),{action:r,data:o}}}return v(e,[{key:"filterHotspot",value:function(e,t,n){var i=new RegExp("^(flyTo|flyToObject|hideHotspot|showHotspot|resetHotspots)"),o=this.getHotspotAction(e,n),r=o.filter((function(e){return i.test(e)}));return o.length===r.length}},{key:"deserializeAnnotation",value:function(e,t,n){var i=new Ni(e.title||"");return i.id=e.annotationId||qi.idWithPrefix("label"),i.chapterId=t.id,i.expandTag=!0,i.showDescription=!0,i.collapseDescription=!1,i.pinGlow=!1,i.hideWire=!1,i.hideTag=!1,n===Ri.Annotation?(i.theme=Ri.Annotation,i.pinType=Ai.Default,i.flyTo=!1,i.states=[]):(i.theme=Ri.StudioNext,i.pinType=Ai.PlusMinus,i.flyTo=!0,i.states=[new io,new io],i.states[0].errands=[new co],i.states[1].errands=[new ro(e.objectId)]),i.occludable=!1!==e.occludable,i.renderableIndex=e.renderableIndex||0,e.objectId&&Object.prototype.hasOwnProperty.call(e,"barycentric")?(i.objectId=e.objectId,i.primitiveIndex=e.primitiveIndex,i.barycentric=e.barycentric):Object.prototype.hasOwnProperty.call(e,"pos")&&(Object.prototype.hasOwnProperty.call(e,"objectId")&&(i.objectId=e.objectId),i.pos=e.pos),e.dir&&Array.isArray(e.dir)?i.dir=e.dir:e.dir&&e.dir instanceof Object&&(i.dir=Object.values(e.dir)),i.description=e.description||"",i.offset=e.labelOffset||[40,40],i.shown=!1!==e.shown,i.labelShown=!1!==e.labelShown,i}},{key:"deserializeHotspots",value:function(e,t,n){for(var i=this,o=arguments.length,r=new Array(o>3?o-3:0),a=3;a<o;a++)r[a-3]=arguments[a];var s=r[0],c=r[1],l=new Ni(s.title||"");switch(l.id=qi.idWithPrefix("hotspot"),l.objectId=s.objectId,l.chapterId=t.id,l.description=s.description||"",l.pinType=/plus|minus/.test(s.className)?Ai.PlusMinus:/sequential/.test(s.className)?Ai.Sequential:/none/.test(s.className)?Ai.None:Ai.Default,/alphabetical/.test(s.className)?l.sequentialType=Vi.Alphabetical:/numerical/.test(s.className)&&(l.sequentialType=Vi.Numerical),l.pinGlow=/pulse/.test(s.className),l.occludable=!0,l.shown=s.shown,l.offset=s.labelOffset?s.labelOffset:[22,-17],(/left/.test(s.className)&&l.offset[0]>0||/right/.test(s.className)&&l.offset[0]<0)&&(l.offset[0]*=-1),Object.prototype.hasOwnProperty.call(s,"barycentric")?(l.renderableIndex=s.renderableIndex||0,l.barycentric=s.barycentric,l.primitiveIndex=s.primitiveIndex):l.pos=s.pos,l.dir=s.dir,s.theme=s.theme?s.theme:no.classicHotspot,s.theme){case no.classicAnnotation:l.theme=Ri.Annotation,l.showDescription=!0,l.collapseDescription=/collapsible/g.test(s.className),l.expandTag=!0,l.hideTag=!1,l.hideWire=!/leader-line/.test(s.className);break;case no.classicHotspot:l.theme=Ri.Classic,l.showDescription=/label/.test(s.className),l.expandTag=/label/.test(s.className),l.hideTag=!l.expandTag,l.collapseDescription=!1,l.hideWire=!/leader-line/.test(s.className);break;case no.studioNext:l.theme=Ri.StudioNext,l.showDescription=this.hasContent(s),l.collapseDescription=/collapsible/g.test(s.className),l.hideTag=!s.title,l.hideWire=!/leader-line/.test(s.className)}l.flyTo=!1,l.flyToTarget=null,l.states=[];var p=this.filterHotspotActions(this.getHotspotAction(e,s)),u=c?this.filterHotspotActions(this.getHotspotAction(e,c)):[],d=new io,g=new io;p.length&&(d.errands=p.map((function(t){return i.convertActionToErrand(e,n,t)}))),u.length&&(g.errands=u.map((function(t){return i.convertActionToErrand(e,n,t)}))),l.states=[g,d],d.errands.length>0&&(l.flyTo=!0,l.flyToTarget=d.errands[0].type,d.errands[0].type===oo.flyToCamera&&(l.cameraPosition=d.errands[0].value));var h=s.contentBlocks;return h&&(l.contentBlocks=JSON.parse(JSON.stringify(h))),l}},{key:"makeDefaultStudioLabel",value:function(e){var t=e?Object.assign({},e):new Ni("");return t.pinType=Ai.PlusMinus,t.theme=Ri.StudioNext,t.expandTag=!0,t.showDescription=!0,t.collapseDescription=!1,t.pinGlow=!1,t.hideWire=!1,t.hideTag=!1,t.occludable=!0,t.flyTo=!0,t.description="",t.shown=!0,t.states=[new io,new io],t}},{key:"makeAnnotationLabel",value:function(e){var t=e?Object.assign({},e):new Ni("");return t.pinType=Ai.Default,t.theme=Ri.Annotation,t.expandTag=!0,t.showDescription=!0,t.collapseDescription=!1,t.pinGlow=!1,t.hideWire=!1,t.hideTag=!1,t.states=[],t}},{key:"serializeLabel",value:function(e,t){var n=this,i=new to,o=Object(ce.classToClass)(e),r=["circle","draggable"];i.shown=!0,e.objectId&&(i.objectId=o.objectId);try{e.primitiveIndex&&e.barycentric&&e.objectId?(i.renderableIndex=e.renderableIndex||0,i.primitiveIndex=e.primitiveIndex,i.barycentric=e.barycentric,i.pos=this.engineService.barycentricToWorld(e.objectId,e.primitiveIndex,e.barycentric)):i.pos=o.pos}catch(p){return{data:{},hotspots:[]}}switch((Array.isArray(e.dir)||ArrayBuffer.isView(e.dir))&&(i.dir=Array.prototype.slice.call(e.dir)),i.labelOffset=e.offset,e.theme){case Ri.Annotation:i.theme=no.classicAnnotation;break;case Ri.Classic:i.theme=no.classicHotspot;break;default:i.theme=no.studioNext}""!==o.title?(i.title=o.title,i.description=o.description,i.type=so.CircleLabel):i.type=so.Circle,e.pinGlow&&r.push("pulse"),e.pinType===Ai.PlusMinus&&r.push("plus"),e.pinType===Ai.Sequential&&(r.push("sequential"),r.push(e.sequentialType===Vi.Alphabetical?"alphabetical":"numerical")),e.pinType===Ai.None&&r.push("none"),e.hideWire||r.push("leader-line"),e.hideTag||r.push("label"),e.collapseDescription&&r.push("collapsible collapsed"),i.className=r.join(" ");var a={};i.actions=[];var s=[i],c=e.states.length;e.states.forEach((function(t,o){if(o===c-1)s[0].actions.push("resetHotspots"),t.errands.forEach((function(t){var i=n.convertErrandToAction(e,t);s[0].actions.push(i.action),a=Object.assign(Object.assign({},a),i.data)}));else{var r=Object(ce.classToClass)(i);r.actions=[],r.className=r.className.replace("plus","minus"),t.errands.forEach((function(t){var i=n.convertErrandToAction(e,t);r.actions.push(i.action),a=Object.assign(Object.assign({},a),i.data)})),s.push(r)}})),2===s.length&&(s[0].actions.push("hideHotspots:currentChapter.hotspots[".concat(t,"]")),s[0].actions.push("showHotspots:currentChapter.hotspots[".concat(t+1,"]")),s[1].actions.push("hideHotspots:currentChapter.hotspots[".concat(t+1,"]")),s[1].actions.push("showHotspots:currentChapter.hotspots[".concat(t,"]")),s[0].shown=!0,s[1].shown=!1),2===s.length&&e.collapseDescription&&(s[1].className+=s[1].className.replace("collapsed","")),s.forEach((function(e){i.labelOffset[0]<0?e.className=e.className.replace("right","")+" left":i.labelOffset[0]>0&&(e.className=e.className.replace("left","")+" right")}));var l=e.contentBlocks;return l&&(i.contentBlocks=JSON.parse(JSON.stringify(l))),{data:a,hotspots:s}}},{key:"setLabelContainer",value:function(e){this._labelContainer=e}},{key:"getLabelContainer",value:function(){return this._labelContainer}},{key:"hasContent",value:function(e){var t=e.description,n=e.contentBlocks;return!!t||!Object(ie.isNil)(n)&&n.length>0}},{key:"getHotspotAction",value:function(e,t){var n=t.actionSrc?Object(ie.get)(e,t.actionSrc):t.actions?t.actions:[];return Array.isArray(n)?n:[]}},{key:"filterHotspotActions",value:function(e){var t=new RegExp("^(flyTo|flyToObject)");return e.filter((function(e){return t.test(e)}))}}]),e}()).\u0275fac=function(e){return new(e||Xi)(j.Zb(Sn))},Xi.\u0275prov=j.Lb({token:Xi,factory:Xi.\u0275fac,providedIn:"root"}),Xi),uo=function e(){y(this,e)};function go(e,t,n,i){(function e(t,n){var i=n.objects;return 0===i.length?[]:Object(ie.flattenDeep)(i.map((function(n){return[n.objectId].concat(p(e(t,t.scene.objects[n.objectId])))})))})(Human,Human.scene.objects[e]).forEach((function(e){return t[e][n]=i}))}function ho(e,t){if(void 0!==e.activeChapterId&&void 0!==e.nodeState){var n=immer.produceWithPatches(e,(function(e){var n=e.nodeState[e.activeChapterId],i=t.objectIds||Object.keys(n);t.patch?Object.entries(t.patch).forEach((function(e){var t=d(e,2),i=t[0],o=t[1];n[i].shown=o})):i.forEach((function(e){n[e].shown=t.show,n[e].shownSetByTween=t.setByTween,t.objectIds&&(go(e,n,"shown",t.show),!0===t.setByTween&&go(e,n,"shownSetByTween",t.setByTween))}))})),i=d(n,3),o=i[0],r=i[1],a=i[2];return{finalState:immer.produce(o,(function(e){var t;e.patches=r,(t=e.patchesForChapter[e.activeChapterId]).push.apply(t,p(r))})),patches:r,inversePatches:a}}}!function(e){var t=function e(){y(this,e)};t.type="[Engine Nodes] Reset",e.Reset=t;var n=function e(t){y(this,e),this.nodeState=t};n.type="[Engine Nodes] init nodes",e.InitNodeState=n;var i=function e(t){y(this,e),this.patches=t};i.type="[Engine Nodes] patch nodes",e.ApplyPatch=i;var o=function e(t){y(this,e),this.activeChapterId=t};o.type="[Engine Nodes] set active chapter",e.SetActiveChapter=o;var r=function e(t,n){y(this,e),this.originalChapterId=t,this.copyChapterId=n};r.type="[Engine Nodes] Duplicate node state",e.DuplicateNodeState=r;var a=function e(t,n,i){var o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];y(this,e),this.show=t,this.objectIds=n,this.patch=i,this.record=o,this.setByTween=r};a.type="[Engine Nodes] update nodes shown",e.UpdateNodesShown=a;var s=function e(t){y(this,e),this.objectId=t};s.type="[Engine Nodes] update nodes selected",e.UpdateNodeSelected=s;var c=function e(t,n,i){y(this,e),this.checked=t,this.objectIds=n,this.patch=i};c.type="[Engine Nodes] update nodes checked",e.UpdateNodesChecked=c;var l=function e(t,n,i){y(this,e),this.pickable=t,this.objectIds=n,this.patch=i};l.type="[Engine Nodes] update nodes pickable",e.UpdateNodesPickable=l;var p=function e(t,n,i){var o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];y(this,e),this.recipe=t,this.objectIds=n,this.patch=i,this.record=o};p.type="[Engine Nodes] update nodes paint",e.UpdateNodesPaint=p}(Yi||(Yi={})),function(e){var t=function e(){y(this,e)};t.type="[Undo] Reset",e.Reset=t;var n=function e(t){y(this,e),this.chapterId=t};n.type="[Undo] Undo",e.Undo=n;var i=function e(t){y(this,e),this.chapterId=t};i.type="[Undo] Undo All",e.UndoAll=i;var o=function e(t){y(this,e),this.chapterId=t};o.type="[Undo] Redo",e.Redo=o;var r=function e(t){y(this,e),this.patches=t};r.type="[Undo] Store Patches",e.SavePatches=r}(eo||(eo={}));var fo=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{center:[0,0,0],edge:[1,1,1],centerBias:1,edgeBias:0,power:1};y(this,e);var n=t.edge,i=t.center,o=t.centerBias,r=t.edgeBias,a=t.power;this.edge=n,this.center=i,this.centerBias=o,this.edgeBias=r,this.power=a}return v(e,null,[{key:"toEngine",value:function(e){var t=e.center,n=e.edge,i=e.centerBias,o=e.edgeBias,r=e.power;return[p(t),p(n),i,o,r]}}]),e}(),bo=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{center:0,edge:1,centerBias:1,edgeBias:0,power:1};y(this,e);var n=t.edge,i=t.center,o=t.centerBias,r=t.edgeBias,a=t.power;this.edge=n,this.center=i,this.centerBias=o,this.edgeBias=r,this.power=a}return v(e,null,[{key:"toEngine",value:function(e){return[e.center,e.edge,e.centerBias,e.edgeBias,e.power]}},{key:"isFresnelObject",value:function(e){var t=!1;return e&&(t="center,centerBias,edge,edgeBias,power"==Object.keys(e).sort().toString()),t}}]),e}();function mo(e,t){switch(!0){case void 0===e[t]:return;case!1===e[t]:return!1;case"number"==typeof e[t]:return 100*e[t];default:return new bo({center:e[t][0],edge:e[t][1],centerBias:e[t][2],edgeBias:e[t][3],power:e[t][4]})}}var vo,yo,xo,Oo,wo,ko=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};y(this,e);var n=t.tintColor,i=t.saturation,o=t.contrast,r=t.brightness,a=t.opacity,s=t.label;this.tintColor=n,this.saturation=i,this.contrast=o,this.brightness=r,this.opacity=a,this.label=s}return v(e,null,[{key:"isRealRecipe",value:function(e){return!1!==e.brightness||!1!==e.contrast||!1!==e.opacity||!1!==e.saturation||!1!==e.tintColor}},{key:"isFresnel",value:function(e){return void 0!==e&&e.hasOwnProperty("edge")&&e.hasOwnProperty("edgeBias")&&e.hasOwnProperty("center")&&e.hasOwnProperty("centerBias")&&e.hasOwnProperty("power")}},{key:"isColor",value:function(e){return Array.isArray(e)&&3===e.length}},{key:"fromEngine",value:function(t){return new e({tintColor:function(){switch(!0){case void 0===t.tintColor:return;case!1===t.tintColor:return!1;case Array.isArray(t.tintColor):return 3===t.tintColor.length?p(t.tintColor):new fo({center:t.tintColor[0],edge:t.tintColor[1],centerBias:t.tintColor[2],edgeBias:t.tintColor[3],power:t.tintColor[4]})}}(),saturation:mo(t,"saturation"),brightness:mo(t,"brightness"),contrast:mo(t,"contrast"),opacity:mo(t,"opacity")})}},{key:"toEngine",value:function(t){var n=!1!==t.tintColor&&void 0,i=!1!==t.saturation&&void 0,o=!1!==t.brightness&&void 0,r=!1!==t.contrast&&void 0,a=!1!==t.opacity&&void 0;return Array.isArray(t.tintColor)?n=p(t.tintColor):e.isFresnel(t.tintColor)&&(n=fo.toEngine(t.tintColor)),"number"==typeof t.saturation?i=t.saturation/100:e.isFresnel(t.saturation)&&(i=bo.toEngine(t.saturation)),"number"==typeof t.brightness?o=t.brightness/100:e.isFresnel(t.brightness)&&(o=bo.toEngine(t.brightness)),"number"==typeof t.contrast?r=t.contrast/100:e.isFresnel(t.contrast)&&(r=bo.toEngine(t.contrast)),"number"==typeof t.opacity?a=t.opacity/100:e.isFresnel(t.opacity)&&(a=bo.toEngine(t.opacity)),{tintColor:n,saturation:i,brightness:o,contrast:r,opacity:a}}},{key:"mergeRecipes",value:function(e,t){for(var n=Object.assign({},e),i=0,o=Object.entries(t);i<o.length;i++){var r=d(o[i],2),a=r[0],s=r[1];void 0!==s&&(n[a]=s)}return n}},{key:"modifiesSaturation",value:function(t){return"number"==typeof t.saturation&&0!==t.saturation||e.isFresnel(t.saturation)}},{key:"modifiesContrast",value:function(t){return"number"==typeof t.contrast&&0!==t.contrast||e.isFresnel(t.contrast)}},{key:"modifiesBrightness",value:function(t){return"number"==typeof t.brightness&&0!==t.brightness||e.isFresnel(t.brightness)}},{key:"modifiesOpacity",value:function(t){return"number"==typeof t.opacity||e.isFresnel(t.opacity)}}]),e}(),Co=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},So=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},_o={activeChapterId:void 0,nodeState:void 0,patches:[],patchesForChapter:{}},jo=((yo=vo=function(){function e(){y(this,e)}return v(e,[{key:"reset",value:function(e,t){e.patchState(immer.produce(e.getState(),(function(e){e.activeChapterId=void 0,e.nodeState=void 0,e.patches=[],e.patchesForChapter={}})))}},{key:"applyPatch",value:function(e,t){var n=immer.applyPatches(e.getState(),t.patches),i=immer.produce(n,(function(e){var n;(n=e.patchesForChapter[e.activeChapterId]).push.apply(n,p(t.patches)),e.patches=t.patches}));e.patchState(i)}},{key:"initNodeState",value:function(e,t){e.patchState({nodeState:t.nodeState})}},{key:"setActiveChapter",value:function(e,t){var n=e.getState(),i=immer.produce(n,(function(e){e.activeChapterId=t.activeChapterId,e.patchesForChapter[t.activeChapterId]=e.patchesForChapter[t.activeChapterId]||[],e.patches=e.patchesForChapter[t.activeChapterId]}));e.patchState(i)}},{key:"duplicateNodeState",value:function(e,t){var n=e.getState(),i=immer.produce(n,(function(e){e.nodeState[t.copyChapterId]=e.nodeState[t.originalChapterId],e.patchesForChapter[t.copyChapterId]=e.patchesForChapter[t.originalChapterId].map((function(e){return e.path[1]=t.copyChapterId,e}))}));e.patchState(i)}},{key:"updateNodesShown",value:function(e,t){var n=ho(e.getState(),t),i=n.finalState,o=n.patches,r=n.inversePatches;e.patchState(i),t.record&&e.dispatch(new eo.SavePatches([{forward:o,inverse:r,patchAction:Yi.ApplyPatch}]))}},{key:"updateNodesSelected",value:function(e,t){var n=e.getState();if(n){var i=immer.produce(n,(function(e){var n,i,o=null!==(i=null===(n=e.nodeState)||void 0===n?void 0:n[e.activeChapterId])&&void 0!==i?i:{},r=Object.keys(o);switch(t.objectId){case void 0:r.forEach((function(e){return o[e].selected=!1}));break;default:r.forEach((function(e){return o[e].selected=!1})),o[t.objectId].selected=!0}}));e.patchState(i)}}},{key:"updateNodesChecked",value:function(e,t){var n=e.getState(),i=immer.produceWithPatches(n,(function(e){var n,i,o=null!==(i=null===(n=e.nodeState)||void 0===n?void 0:n[e.activeChapterId])&&void 0!==i?i:{};switch(t.patch){case void 0:(t.objectIds||Object.keys(o)).forEach((function(e){o[e].checked=t.checked,t.objectIds&&go(e,o,"checked",t.checked)}));break;default:Object.entries(t.patch).forEach((function(e){var t=d(e,2),n=t[0],i=t[1];return o[n].checked=i}))}})),o=d(i,3),r=o[0],a=o[1],s=(o[2],immer.produce(r,(function(e){e.patches=a})));e.patchState(s)}},{key:"updateNodesPickable",value:function(e,t){var n=e.getState(),i=immer.produceWithPatches(n,(function(e){var n,i,o=null!==(i=null===(n=e.nodeState)||void 0===n?void 0:n[e.activeChapterId])&&void 0!==i?i:{};t.patch?Object.entries(t.patch).forEach((function(e){var t=d(e,2),n=t[0],i=t[1];return o[n].pickable=i})):(t.objectIds||Object.keys(o)).forEach((function(e){o[e].pickable=t.pickable,t.objectIds&&go(e,o,"pickable",t.pickable)}))})),o=d(i,3),r=o[0],a=o[1],s=o[2],c=immer.produce(r,(function(e){var t;e.patches=a,(t=e.patchesForChapter[e.activeChapterId]).push.apply(t,p(a))}));e.patchState(c),e.dispatch(new eo.SavePatches([{forward:a,inverse:s,patchAction:Yi.ApplyPatch}]))}},{key:"updateNodesPaint",value:function(e,t){var n=e.getState(),i=immer.produceWithPatches(n,(function(e){var n,i,o=null!==(i=null===(n=e.nodeState)||void 0===n?void 0:n[e.activeChapterId])&&void 0!==i?i:{},r=t.objectIds||Object.keys(o);t.patch?Object.entries(t.patch).forEach((function(e){var t=d(e,2),n=t[0],i=t[1],r=ko.mergeRecipes(o[n].paint,i);o[n].paint=r})):r.forEach((function(e){var n=ko.mergeRecipes(o[e].paint,t.recipe);o[e].paint=n,t.objectIds&&go(e,o,"paint",n)}))})),o=d(i,3),r=o[0],a=o[1],s=o[2],c=immer.produce(r,(function(e){var t;e.patches=a,(t=e.patchesForChapter[e.activeChapterId]).push.apply(t,p(a))}));e.patchState(c),t.record&&e.dispatch(new eo.SavePatches([{forward:a,inverse:s,patchAction:Yi.ApplyPatch}]))}}],[{key:"getAllNodeState",value:function(e){return e.nodeState}},{key:"getActiveChapter",value:function(e){return e.activeChapterId}},{key:"getPatches",value:function(e){return e.patches}},{key:"getNodes",value:function(e){return void 0===e.activeChapterId||void 0===e.nodeState?{}:e.nodeState[e.activeChapterId]||{}}},{key:"getNodePaint",value:function(e){return function(t){return e.nodeState[e.activeChapterId][t].paint}}},{key:"getNodeIds",value:function(e){return Object.keys(vo.getNodes(e))}},{key:"getCheckedNodeIds",value:function(e){return Object.values(vo.getNodes(e)).filter((function(e){return e.checked})).map((function(e){return e.objectId}))}},{key:"getCheckedNodes",value:function(e){return vo.getCheckedNodeIds(e).map((function(t){return e.nodeState[e.activeChapterId][t]}))}},{key:"getUncheckedNodeIds",value:function(e){return vo.getNodeIds(e).filter((function(t){return!e.nodeState[e.activeChapterId][t].checked}))}},{key:"getSelectedNode",value:function(e){var t=vo.getNodeIds(e).find((function(t){return e.nodeState[e.activeChapterId][t].selected}));return t?e.nodeState[e.activeChapterId][t]:void 0}}]),e}()).\u0275fac=function(e){return new(e||yo)},yo.\u0275prov=j.Lb({token:yo,factory:yo.\u0275fac}),Co([Object(L.a)(Yi.Reset),So("design:type",Function),So("design:paramtypes",[Object,Yi.Reset]),So("design:returntype",void 0)],yo.prototype,"reset",null),Co([Object(L.a)(Yi.ApplyPatch),So("design:type",Function),So("design:paramtypes",[Object,Yi.ApplyPatch]),So("design:returntype",void 0)],yo.prototype,"applyPatch",null),Co([Object(L.a)(Yi.InitNodeState),So("design:type",Function),So("design:paramtypes",[Object,Yi.InitNodeState]),So("design:returntype",void 0)],yo.prototype,"initNodeState",null),Co([Object(L.a)(Yi.SetActiveChapter),So("design:type",Function),So("design:paramtypes",[Object,Yi.SetActiveChapter]),So("design:returntype",void 0)],yo.prototype,"setActiveChapter",null),Co([Object(L.a)(Yi.DuplicateNodeState),So("design:type",Function),So("design:paramtypes",[Object,Yi.DuplicateNodeState]),So("design:returntype",void 0)],yo.prototype,"duplicateNodeState",null),Co([Object(L.a)(Yi.UpdateNodesShown),So("design:type",Function),So("design:paramtypes",[Object,Yi.UpdateNodesShown]),So("design:returntype",void 0)],yo.prototype,"updateNodesShown",null),Co([Object(L.a)(Yi.UpdateNodeSelected),So("design:type",Function),So("design:paramtypes",[Object,Yi.UpdateNodeSelected]),So("design:returntype",void 0)],yo.prototype,"updateNodesSelected",null),Co([Object(L.a)(Yi.UpdateNodesChecked),So("design:type",Function),So("design:paramtypes",[Object,Yi.UpdateNodesChecked]),So("design:returntype",void 0)],yo.prototype,"updateNodesChecked",null),Co([Object(L.a)(Yi.UpdateNodesPickable),So("design:type",Function),So("design:paramtypes",[Object,Yi.UpdateNodesPickable]),So("design:returntype",void 0)],yo.prototype,"updateNodesPickable",null),Co([Object(L.a)(Yi.UpdateNodesPaint),So("design:type",Function),So("design:paramtypes",[Object,Yi.UpdateNodesPaint]),So("design:returntype",void 0)],yo.prototype,"updateNodesPaint",null),Co([Object(L.e)(),So("design:type",Function),So("design:paramtypes",[uo]),So("design:returntype",void 0)],yo,"getAllNodeState",null),Co([Object(L.e)(),So("design:type",Function),So("design:paramtypes",[uo]),So("design:returntype",void 0)],yo,"getActiveChapter",null),Co([Object(L.e)(),So("design:type",Function),So("design:paramtypes",[uo]),So("design:returntype",void 0)],yo,"getPatches",null),Co([Object(L.e)(),So("design:type",Function),So("design:paramtypes",[uo]),So("design:returntype",void 0)],yo,"getNodes",null),Co([Object(L.e)(),So("design:type",Function),So("design:paramtypes",[uo]),So("design:returntype",void 0)],yo,"getNodePaint",null),Co([Object(L.e)(),So("design:type",Function),So("design:paramtypes",[uo]),So("design:returntype",void 0)],yo,"getNodeIds",null),Co([Object(L.e)(),So("design:type",Function),So("design:paramtypes",[uo]),So("design:returntype",void 0)],yo,"getCheckedNodeIds",null),Co([Object(L.e)(),So("design:type",Function),So("design:paramtypes",[uo]),So("design:returntype",void 0)],yo,"getCheckedNodes",null),Co([Object(L.e)(),So("design:type",Function),So("design:paramtypes",[uo]),So("design:returntype",void 0)],yo,"getUncheckedNodeIds",null),Co([Object(L.e)(),So("design:type",Function),So("design:paramtypes",[uo]),So("design:returntype",void 0)],yo,"getSelectedNode",null),yo=vo=Co([Object(L.f)({name:"engineNodes",defaults:_o})],yo)),Po=new ko({label:"Original",tintColor:!1,saturation:!1,contrast:!1,brightness:!1,opacity:!1}),Mo=(new ko({tintColor:[0,0,0],saturation:!1,contrast:!1,brightness:!1,opacity:!1}),new ko({tintColor:[1,0,0],saturation:!1,contrast:!1,brightness:!1,opacity:!1})),Io=(new ko({tintColor:[1,1,0],saturation:!1,contrast:!1,brightness:!1,opacity:!1}),new ko({tintColor:[0,1,0],saturation:!1,contrast:!1,brightness:!1,opacity:!1}),new ko({tintColor:[0,1,1],saturation:!1,contrast:!1,brightness:!1,opacity:!1}),new ko({tintColor:[0,0,1],saturation:!1,contrast:!1,brightness:!1,opacity:!1}),new ko({tintColor:[1,0,1],saturation:!1,contrast:!1,brightness:!1,opacity:!1}),new ko({label:"Grayscale",tintColor:!1,saturation:-100,contrast:!1,brightness:!1,opacity:!1}),new ko({label:"Desaturated",tintColor:!1,saturation:-50,contrast:!1,brightness:!1,opacity:!1}),new ko({label:"Fade",tintColor:[0,0,0],contrast:!1,brightness:55,saturation:-100,opacity:new bo({edge:1,center:0,edgeBias:0,centerBias:1,power:1})})),zo=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};y(this,e);var n=t.tintColor,i=t.saturation,o=t.contrast,r=t.brightness,a=t.opacity;this.tintColor=n,this.saturation=i,this.contrast=o,this.brightness=r,this.opacity=a}return v(e,null,[{key:"isFresnel",value:function(e){return Array.isArray(e)&&5===e.length}},{key:"isColor",value:function(e){return Array.isArray(e)&&3===e.length}},{key:"isEqual",value:function(e,t){return!(!e||!t)&&JSON.stringify(e,Object.keys(e).sort())===JSON.stringify(t,Object.keys(t).sort())}},{key:"isRealRecipe",value:function(e){return!Object(ie.isNil)(e)&&(!Object(ie.isNil)(e.brightness)&&!1!==e.brightness||!Object(ie.isNil)(e.contrast)&&!1!==e.contrast||!Object(ie.isNil)(e.opacity)&&!1!==e.opacity||!Object(ie.isNil)(e.saturation)&&!1!==e.saturation||!Object(ie.isNil)(e.tintColor)&&!1!==e.tintColor)}},{key:"compare",value:function(t,n){try{var i=e.hue(t),o=e.hue(n),r=!1===t.opacity?1:t.opacity,a=!1===n.opacity?1:n.opacity;return i===o?r===a?t.saturation===n.saturation?t.brightness===n.brightness?t.contrast>n.contrast?i+4:i-4:t.brightness>n.brightness?i+3:i-3:t.saturation>n.saturation?i+2:i-2:r>a?i+1:i-1:i-o}catch(s){return 0}}},{key:"hue",value:function(e){if(!e.tintColor)return-10;var t=e.tintColor[0],n=e.tintColor[1],i=e.tintColor[2],o=Math.max(t,n,i),r=o-Math.min(t,n,i),a=0;return a=o===t?(n-i)/r:o===n?2+(i-t)/r:4+(t-n)/r,a*=60,a<0&&(a+=360),a}},{key:"generateUniqueRecipes",value:function(t){var n=[];return t.forEach((function(t){-1===e.recipeIndexOf(n,t)&&n.push(t)})),n}},{key:"recipeIndexOf",value:function(t,n){return t.findIndex((function(t){return e.isEqual(t,n)}))}}]),e}();function To(e,t,n){var i=Be.getSuccessors(e,t);if(0===i.length)return!1;var o,r=l(i);try{for(r.s();!(o=r.n()).done;){var a=o.value;if(!0===n[a])return!0}}catch(s){r.e(s)}finally{r.f()}return i.some((function(t){return To(e,t,n)}))}function Uo(e,t,n){switch(n[t]){case!0:return!0;case!1:return!1;case void 0:var i=Be.getAncestor(e,t);return!!i&&Uo(e,i,n)}}!function(e){var t=function e(t,n,i){y(this,e),this.particleSystems=t,this.assignedParticles=n,this.tweenParticleLookup=i};t.type="[Engine Particles] Set Particle State",e.SetParticleState=t;var n=function e(t,n){y(this,e),this.particleSystem=t,this.chapterId=n};n.type="[Engine Particles] New Particle System",e.NewParticleSystem=n;var i=function e(t,n){y(this,e),this.id=t,this.targetChapterId=n};i.type="[Engine Particles] Duplicate Particle System",e.DuplicateParticleSystem=i;var o=function e(t,n){y(this,e),this.id=t,this.targetChapterId=n};o.type="[Engine Particles] Duplicate Particle System Success",e.DuplicateParticleSystemSuccess=o;var r=function e(t,n){y(this,e),this.id=t,this.particleSystem=n};r.type="[Engine Particles] Update Particle System",e.UpdateParticleSystem=r;var a=function e(t,n){y(this,e),this.visible=t,this.chapterId=n};a.type="[Engine Particles] Set Particle Systems Visible",e.SetParticleSystemsVisible=a;var s=function e(t,n,i){y(this,e),this.id=t,this.visible=n,this.chapterId=i};s.type="[Engine Particles] Set Particle System Visible",e.SetParticleSystemVisible=s;var c=function e(t,n){y(this,e),this.id=t,this.chapterId=n};c.type="[Engine Particles] Assign Particle",e.AssignParticle=c;var l=function e(t,n){y(this,e),this.id=t,this.chapterId=n};l.type="[Engine Particles] Unassign Particle",e.UnassignParticle=l;var p=function e(t){y(this,e),this.id=t};p.type="[Engine Partiles] Delete Particle System",e.DeleteParticleSystem=p;var u=function e(t){y(this,e),this.id=t};u.type="[Engine Partiles] Select Particle System",e.SelectParticleSystem=u;var d=function e(t){y(this,e),this.index=t};d.type="[Engine Partiles] Select Particle Constraint",e.SelectParticleConstraint=d;var g=function e(t){y(this,e),this.index=t};g.type="[Engine Partiles] Select Particle Creator",e.SelectParticleCreator=g;var h=function e(t){y(this,e),this.index=t};h.type="[Engine Partiles] Select Particle Updater",e.SelectParticleUpdater=h;var f=function e(t){y(this,e),this.chapterMap=t};f.type="[Engine Particles] Update Lookup Chapters",e.UpdateTweenParticleLookupChapters=f;var b=function e(t,n){y(this,e),this.chapterId=t,this.lookup=n};b.type="[Engine Particles] Set Lookup for chapter",e.SetLookupForChapter=b;var m=function e(t){y(this,e),this.chapterId=t};m.type="[Engine Particles] Delete chapter lookup",e.DeleteChapterLookup=m;var v=function e(t){y(this,e),this.patches=t};v.type="[Engine Particles] Apply Patch",e.ApplyPatch=v}(xo||(xo={})),function(e){e.updateChapterIds=function(e,t){return Object.keys(e).reduce((function(n,i){return n[t[i]]=e[i],n}),{})},e.duplicateChapter=function(e,t,n){return Object.assign(Object.assign({},n),c({},t,n[e]))},e.deleteChapter=function(e,t){var n=Object.assign({},t);return delete n[e],n},e.addEntryForChapter=function(e,t,n){return n[e]=Object.assign(Object.assign({},n[e]),t),n},e.refreshEngineLookup=function(e,t){Human.modules.moduleData[e].tweenParticleLookup=t}}(Oo||(Oo={})),function(e){function t(e){return e.split("-")[0].replace(/_particle$/,"")}e.getParticleIdRoot=t,e.generateParticleId=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:qi.getUuid;return"".concat(t(e),"-").concat(n())}}(wo||(wo={}));var Do,Lo,Eo,Fo=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},Ao=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Ro=((Lo=Do=function(){function e(){y(this,e)}return v(e,[{key:"applyPatch",value:function(e,t){var n=immer.applyPatches(e.getState(),t.patches);e.patchState(n)}},{key:"setParticleState",value:function(e,t){e.patchState(immer.produce(e.getState(),(function(e){e.particleSystems=t.particleSystems.reduce((function(e,t){return e[t.id]=t,e}),{}),e.assignedParticles=t.assignedParticles,e.tweenParticleLookup=t.tweenParticleLookup,e.visibleParticleSystems={}})))}},{key:"setParticlesVisible",value:function(e,t){var n=t.visible,i=t.chapterId;e.patchState(immer.produce(e.getState(),(function(e){var t=(e.assignedParticles[i]||[]).reduce((function(e,t){return e[t]=n,e}),{});e.visibleParticleSystems=Object.assign(Object.assign({},e.visibleParticleSystems),c({},i,t))})))}},{key:"setParticleVisible",value:function(e,t){var n=t.id,i=t.visible,o=t.chapterId;e.patchState(immer.produce(e.getState(),(function(e){e.visibleParticleSystems[o]=Object.assign(Object.assign({},e.visibleParticleSystems[o]||{}),c({},n,i))})))}},{key:"newParticleSystem",value:function(e,t){var n=t.particleSystem,i=t.chapterId,o=n.id,r=d(immer.produceWithPatches(e.getState(),(function(e){e.particleSystems[o]=n,e.assignedParticles[i]=[].concat(p(e.assignedParticles[i]||[]),[o])})),3),a=r[0];r[1],r[2],e.patchState(a)}},{key:"duplicateParticleSystem",value:function(e,t){var n=t.id,i=t.targetChapterId,o=wo.generateParticleId(n);e.patchState(immer.produce(e.getState(),(function(e){e.particleSystems[o]=JSON.parse(JSON.stringify(e.particleSystems[n])),e.particleSystems[o].id=o,e.assignedParticles[i].push(o);var t=wo.getParticleIdRoot(n);e.tweenParticleLookup[i]&&e.tweenParticleLookup[i][t]&&(e.tweenParticleLookup=Oo.addEntryForChapter(i,c({},t,o),e.tweenParticleLookup))}))),e.dispatch(new xo.DuplicateParticleSystemSuccess(o,i))}},{key:"updateParticleSystem",value:function(e,t){var n=immer.produce(e.getState(),(function(e){e.particleSystems[t.id]=t.particleSystem}));e.patchState(Object.assign(Object.assign({},n),{particleSystems:Object.assign({},n.particleSystems)}))}},{key:"deleteChapterLookup",value:function(e,t){e.patchState(immer.produce(e.getState(),(function(e){delete e.tweenParticleLookup[t.chapterId]})))}},{key:"setLookupForChapter",value:function(e,t){e.patchState(immer.produce(e.getState(),(function(e){e.tweenParticleLookup[t.chapterId]=t.lookup})))}},{key:"assignParticle",value:function(e,t){e.patchState(immer.produce(e.getState(),(function(e){var n=e.assignedParticles[t.chapterId]||[],i=wo.getParticleIdRoot(t.id);e.assignedParticles[t.chapterId]=n.concat(t.id),e.tweenParticleLookup=Oo.addEntryForChapter(t.chapterId,c({},i,t.id),e.tweenParticleLookup),e.particleSystems=Object.assign({},e.particleSystems)})))}},{key:"unassignParticle",value:function(e,t){e.patchState(immer.produce(e.getState(),(function(e){var n=e.assignedParticles[t.chapterId]||[],i=wo.getParticleIdRoot(t.id);e.assignedParticles[t.chapterId]=n.filter((function(e){return e!==t.id})),e.tweenParticleLookup[t.chapterId]&&delete e.tweenParticleLookup[t.chapterId][i],e.particleSystems=Object.assign({},e.particleSystems)})))}},{key:"deleteParticleSystem",value:function(e,t){e.patchState(immer.produce(e.getState(),(function(e){delete e.particleSystems[t.id],Object.keys(e.assignedParticles).forEach((function(n){e.assignedParticles[n]=e.assignedParticles[n].filter((function(e){return e!==t.id}))})),Object.keys(e.tweenParticleLookup).forEach((function(n){delete e.tweenParticleLookup[n][wo.getParticleIdRoot(t.id)]}))})))}},{key:"selectParticleSystem",value:function(e,t){e.patchState(immer.produce(e.getState(),(function(e){e.particleSelection={selectedParticle:t.id}})))}},{key:"selectParticleConstraint",value:function(e,t){var n=e.getState().particleSelection;e.patchState(immer.produce(e.getState(),(function(e){e.particleSelection=Object.assign(Object.assign({},n),{selectedConstraint:t.index})})))}},{key:"selectParticleCreator",value:function(e,t){var n=e.getState().particleSelection;e.patchState(immer.produce(e.getState(),(function(e){e.particleSelection=Object.assign(Object.assign({},n),{selectedCreator:t.index})})))}},{key:"selectParticleUpdater",value:function(e,t){var n=e.getState().particleSelection;e.patchState(immer.produce(e.getState(),(function(e){e.particleSelection=Object.assign(Object.assign({},n),{selectedUpdater:t.index})})))}},{key:"updateTweenParticleLookupChapters",value:function(e,t){e.patchState(immer.produce(e.getState(),(function(e){e.tweenParticleLookup=Oo.updateChapterIds(e.tweenParticleLookup,t.chapterMap)})))}}],[{key:"particleSystemIdExists",value:function(e){return Object(L.h)([Do],(function(t){return void 0!==t.particleSystems[e]}))}},{key:"particleSystemsForChapter",value:function(e){return Object(L.h)([Do],(function(t){return(t.assignedParticles[e]||[]).map((function(e){return t.particleSystems[e]}))}))}},{key:"getVisibleParticleSystesmForChapter",value:function(e){return Object(L.h)([Do],(function(t){var n=t.visibleParticleSystems[e]||{};return(t.assignedParticles[e]||[]).filter((function(e){return!1!==n[e]}))}))}},{key:"getTweenParticleLookup",value:function(e){return e.tweenParticleLookup}},{key:"getParticleSystems",value:function(e){return e.particleSystems}},{key:"getVisisbleParticleSystems",value:function(e){return e.visibleParticleSystems}},{key:"getParticleSystemsList",value:function(e){return Object.values(e.particleSystems)}},{key:"getAssignedParticleSystems",value:function(e){return e.assignedParticles}},{key:"getSelectedParticleSystemId",value:function(e){return e.particleSelection.selectedParticle}},{key:"getSelectedParticleSystem",value:function(e){return e.particleSystems[e.particleSelection.selectedParticle]}},{key:"getSelectedParticleConstraintIndex",value:function(e){return e.particleSelection.selectedConstraint}},{key:"getSelectedParticleConstraint",value:function(e){var t=Do.getSelectedParticleSystem(e);return t?t.constraints[e.particleSelection.selectedConstraint]:null}},{key:"getSelectedParticleCreatorIndex",value:function(e){return e.particleSelection.selectedCreator}},{key:"getSelectedParticleCreator",value:function(e){var t=Do.getSelectedParticleSystem(e);return t?t.creators[e.particleSelection.selectedCreator]:null}},{key:"getSelectedParticleUpdaterIndex",value:function(e){return e.particleSelection.selectedUpdater}},{key:"getSelectedParticleUpdater",value:function(e){var t=Do.getSelectedParticleSystem(e);return t?t.updaters[e.particleSelection.selectedUpdater]:null}}]),e}()).\u0275fac=function(e){return new(e||Lo)},Lo.\u0275prov=j.Lb({token:Lo,factory:Lo.\u0275fac}),Fo([Object(L.a)(xo.ApplyPatch),Ao("design:type",Function),Ao("design:paramtypes",[Object,xo.ApplyPatch]),Ao("design:returntype",void 0)],Lo.prototype,"applyPatch",null),Fo([Object(L.a)(xo.SetParticleState),Ao("design:type",Function),Ao("design:paramtypes",[Object,xo.SetParticleState]),Ao("design:returntype",void 0)],Lo.prototype,"setParticleState",null),Fo([Object(L.a)(xo.SetParticleSystemsVisible),Ao("design:type",Function),Ao("design:paramtypes",[Object,xo.SetParticleSystemsVisible]),Ao("design:returntype",void 0)],Lo.prototype,"setParticlesVisible",null),Fo([Object(L.a)(xo.SetParticleSystemVisible),Ao("design:type",Function),Ao("design:paramtypes",[Object,xo.SetParticleSystemVisible]),Ao("design:returntype",void 0)],Lo.prototype,"setParticleVisible",null),Fo([Object(L.a)(xo.NewParticleSystem),Ao("design:type",Function),Ao("design:paramtypes",[Object,xo.NewParticleSystem]),Ao("design:returntype",void 0)],Lo.prototype,"newParticleSystem",null),Fo([Object(L.a)(xo.DuplicateParticleSystem),Ao("design:type",Function),Ao("design:paramtypes",[Object,xo.DuplicateParticleSystem]),Ao("design:returntype",void 0)],Lo.prototype,"duplicateParticleSystem",null),Fo([Object(L.a)(xo.UpdateParticleSystem),Ao("design:type",Function),Ao("design:paramtypes",[Object,xo.UpdateParticleSystem]),Ao("design:returntype",void 0)],Lo.prototype,"updateParticleSystem",null),Fo([Object(L.a)(xo.DeleteChapterLookup),Ao("design:type",Function),Ao("design:paramtypes",[Object,xo.DeleteChapterLookup]),Ao("design:returntype",void 0)],Lo.prototype,"deleteChapterLookup",null),Fo([Object(L.a)(xo.SetLookupForChapter),Ao("design:type",Function),Ao("design:paramtypes",[Object,xo.SetLookupForChapter]),Ao("design:returntype",void 0)],Lo.prototype,"setLookupForChapter",null),Fo([Object(L.a)(xo.AssignParticle),Ao("design:type",Function),Ao("design:paramtypes",[Object,xo.AssignParticle]),Ao("design:returntype",void 0)],Lo.prototype,"assignParticle",null),Fo([Object(L.a)(xo.UnassignParticle),Ao("design:type",Function),Ao("design:paramtypes",[Object,xo.UnassignParticle]),Ao("design:returntype",void 0)],Lo.prototype,"unassignParticle",null),Fo([Object(L.a)(xo.DeleteParticleSystem),Ao("design:type",Function),Ao("design:paramtypes",[Object,xo.DeleteParticleSystem]),Ao("design:returntype",void 0)],Lo.prototype,"deleteParticleSystem",null),Fo([Object(L.a)(xo.SelectParticleSystem),Ao("design:type",Function),Ao("design:paramtypes",[Object,xo.SelectParticleSystem]),Ao("design:returntype",void 0)],Lo.prototype,"selectParticleSystem",null),Fo([Object(L.a)(xo.SelectParticleConstraint),Ao("design:type",Function),Ao("design:paramtypes",[Object,xo.SelectParticleConstraint]),Ao("design:returntype",void 0)],Lo.prototype,"selectParticleConstraint",null),Fo([Object(L.a)(xo.SelectParticleCreator),Ao("design:type",Function),Ao("design:paramtypes",[Object,xo.SelectParticleCreator]),Ao("design:returntype",void 0)],Lo.prototype,"selectParticleCreator",null),Fo([Object(L.a)(xo.SelectParticleUpdater),Ao("design:type",Function),Ao("design:paramtypes",[Object,xo.SelectParticleUpdater]),Ao("design:returntype",void 0)],Lo.prototype,"selectParticleUpdater",null),Fo([Object(L.a)(xo.UpdateTweenParticleLookupChapters),Ao("design:type",Function),Ao("design:paramtypes",[Object,xo.UpdateTweenParticleLookupChapters]),Ao("design:returntype",void 0)],Lo.prototype,"updateTweenParticleLookupChapters",null),Fo([Object(L.e)(),Ao("design:type",Function),Ao("design:paramtypes",[Object]),Ao("design:returntype",void 0)],Lo,"getTweenParticleLookup",null),Fo([Object(L.e)(),Ao("design:type",Function),Ao("design:paramtypes",[Object]),Ao("design:returntype",void 0)],Lo,"getParticleSystems",null),Fo([Object(L.e)(),Ao("design:type",Function),Ao("design:paramtypes",[Object]),Ao("design:returntype",void 0)],Lo,"getVisisbleParticleSystems",null),Fo([Object(L.e)(),Ao("design:type",Function),Ao("design:paramtypes",[Object]),Ao("design:returntype",void 0)],Lo,"getParticleSystemsList",null),Fo([Object(L.e)(),Ao("design:type",Function),Ao("design:paramtypes",[Object]),Ao("design:returntype",void 0)],Lo,"getAssignedParticleSystems",null),Fo([Object(L.e)(),Ao("design:type",Function),Ao("design:paramtypes",[Object]),Ao("design:returntype",void 0)],Lo,"getSelectedParticleSystemId",null),Fo([Object(L.e)(),Ao("design:type",Function),Ao("design:paramtypes",[Object]),Ao("design:returntype",void 0)],Lo,"getSelectedParticleSystem",null),Fo([Object(L.e)(),Ao("design:type",Function),Ao("design:paramtypes",[Object]),Ao("design:returntype",void 0)],Lo,"getSelectedParticleConstraintIndex",null),Fo([Object(L.e)(),Ao("design:type",Function),Ao("design:paramtypes",[Object]),Ao("design:returntype",void 0)],Lo,"getSelectedParticleConstraint",null),Fo([Object(L.e)(),Ao("design:type",Function),Ao("design:paramtypes",[Object]),Ao("design:returntype",void 0)],Lo,"getSelectedParticleCreatorIndex",null),Fo([Object(L.e)(),Ao("design:type",Function),Ao("design:paramtypes",[Object]),Ao("design:returntype",void 0)],Lo,"getSelectedParticleCreator",null),Fo([Object(L.e)(),Ao("design:type",Function),Ao("design:paramtypes",[Object]),Ao("design:returntype",void 0)],Lo,"getSelectedParticleUpdaterIndex",null),Fo([Object(L.e)(),Ao("design:type",Function),Ao("design:paramtypes",[Object]),Ao("design:returntype",void 0)],Lo,"getSelectedParticleUpdater",null),Lo=Do=Fo([Object(L.f)({name:"engineParticles",defaults:{particleSelection:{},particleSystems:{},visibleParticleSystems:{},assignedParticles:{},tweenParticleLookup:{}}})],Lo));!function(e){var t=function e(t){y(this,e),this.quizState=t};t.type="[Quiz] Set Quiz State",e.SetQuizState=t;var n=function e(){y(this,e)};n.type="[Quiz] Reset Quiz State",e.ResetQuizState=n;var i=function e(t){y(this,e),this.quizSettings=t};i.type="[Quiz] Set Quiz Settings",e.SetQuizSettings=i;var o=function e(t){y(this,e),this.active=t};o.type="[Quiz] Set Quiz Active",e.SetQuizActive=o;var r=function e(t){y(this,e),this.enabled=t};r.type="[Quiz] Set Quiz Enabled",e.SetQuizEnabled=r;var a=function e(t){y(this,e),this.locked=t};a.type="[Quiz] Set Quiz Locked",e.SetQuizLocked=a;var s=function e(t){y(this,e),this.enable=t};s.type="[Quiz] Set Enable Quiz Retake",e.SetEnableQuizRetake=s;var c=function e(t){y(this,e),this.mode=t};c.type="[Quiz] Set Quiz Questions Mode",e.SetQuizQuestionsMode=c;var l=function e(t,n){y(this,e),this.sourceChapterId=t,this.targetChapterId=n};l.type="[Quiz] Copy Quiz Questions",e.CopyQuestions=l;var p=function e(t){y(this,e),this.chapterIds=t};p.type="[Quiz] Reoder Quiz Questions",e.ReorderQuestions=p;var u=function e(t){y(this,e),this.question=t};u.type="[Quiz] Add Quiz Question",e.AddQuestion=u;var d=function e(t){y(this,e),this.questions=t};d.type="[Quiz] Set Quiz Questions",e.SetQuestions=d;var g=function e(t){y(this,e),this.questionIds=t};g.type="[Quiz] Remove Quiz Questions",e.RemoveQuestions=g;var h=function e(t){y(this,e),this.question=t};h.type="[Quiz] Set Quiz Question",e.SetQuestion=h;var f=function e(t){y(this,e),this.submission=t};f.type="[Quiz] Submit Question Answer",e.SubmitQuestionAnswer=f;var b=function e(){y(this,e)};b.type="[Quiz] Advance Question",e.NextQuestion=b;var m=function e(){y(this,e)};m.type="[Quiz] Previous Question",e.PreviousQuestion=m;var v=function e(){y(this,e)};v.type="[Quiz] Clear Submissions",e.ClearSubmissions=v;var x=function e(t){y(this,e),this.questionId=t};x.type="[Quiz] Set Active Question",e.SetActiveQuestion=x;var O=function e(t){y(this,e),this.pickMode=t};O.type="[Quiz] Set Pick Mode",e.SetQuizPickMode=O;var w=function e(t){y(this,e),this.submission=t};w.type="[Quiz] Set Active QuestionAnswer",e.SetActiveSubmission=w;var k=function e(t){y(this,e),this.lifecycle=t};k.type="[Quiz] Set Quiz Lifecycle",e.SetQuizLifecycle=k}(Eo||(Eo={}));var Vo=function(e){return e.Markdown="markdown",e.Images="images",e.Ticker="ticker",e}({}),No=function(e){return e.MultipleChoice="multiple-choice",e.SelectAnatomy="select-anatomy",e.LabelAnatomy="label-anatomy",e.Instructions="text-only",e}({}),Bo=(c(f={},No.MultipleChoice,"Multiple Choice"),c(f,No.SelectAnatomy,"Select Anatomy in 3D"),c(f,No.LabelAnatomy,"Label Anatomy"),c(f,No.Instructions,"Instructions"),f);function Ho(e){var t,n=e.map((function(e){return(e.quizQuestions||[]).map((function(t){return Object.assign(Object.assign({},t),{chapterId:t.chapterId||e.id})}))}));return(t=[]).concat.apply(t,p(n))}function Qo(e){return"string"==typeof e.data.correctAnswer?[e.data.correctAnswer]:e.data.correctAnswer}function qo(e,t){var n=Qo(e);switch(e.type){case No.LabelAnatomy:return Object(ie.isEqual)(n,t);case No.MultipleChoice:return Object(ie.isEqual)(n.sort(),t.sort());case No.SelectAnatomy:if(void 0===e.data.selectType||"all"===e.data.selectType)return Object(ie.isEqual)(n.sort(),t.sort());if("any"===e.data.selectType)return 0===Object(ie.difference)(t,n).length&&t.length>0}}function $o(e,t){var n=e.filter((function(e){return e.type!==No.Instructions})),i=e.reduce((function(e,n){return e[n.id]=function(e,t){var n=e.find((function(e){return e.questionId===t}));return n?n.answer:void 0}(t,n.id),e}),{}),o=e.reduce((function(e,t){return e[t.id]=Qo(t),e}),{}),r=n.filter((function(e){var t=i[e.id];return qo(e,void 0===t?[]:"string"==typeof t?[t]:t)})),a=e.length,s=n.length,c=r.length,l=a-c;return{score:a>0?Math.round(c/s*100):0,total:a,scorableTotal:s,correctTotal:c,incorrectTotal:l,questionAnswers:i,correctQuestionAnswers:o}}var Wo,Ko=function(e){return e[e.Question=0]="Question",e[e.Explanation=1]="Explanation",e[e.Review=2]="Review",e}({}),Go=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},Zo=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Jo=function(e){return e[e.Learning=0]="Learning",e[e.Assessment=1]="Assessment",e}({}),Xo={quizModeActive:!1,quizModeLocked:!1,quizQuestionsMode:"all",enableQuizRetake:!0,launchMode:Jo.Learning,questions:[],activeQuestionId:void 0,activeSubmission:void 0,questionSubmissions:[],quizSettings:{enabled:!0,showSummary:!0,showExplanation:!0,showSubmit:!0,showProgress:!0},pickMode:"single",lifecycle:Ko.Question};function Yo(e,t){return e.filter((function(e){return e.chapterId===t}))}function er(e,t){var n,i=t.map((function(t){return Yo(e,t)}));return(n=[]).concat.apply(n,p(i))}function tr(e){var t=function(e){return p(new Set(e.map((function(e){return e.chapterId}))))}(e);return er(e,t)}var nr,ir,or,rr=((nr=Wo=function(){function e(){y(this,e)}return v(e,[{key:"resetQuizState",value:function(e,t){e.setState(Object.assign({},Xo))}},{key:"setQuizState",value:function(e,t){var n=t.quizState;e.setState(Object.assign(Object.assign({},Xo),n))}},{key:"setQuizSettings",value:function(e,t){var n=t.quizSettings;e.patchState({quizSettings:n})}},{key:"setQuizActive",value:function(e,t){e.patchState({quizModeActive:t.active,activeQuestionId:!1===t.active?void 0:e.getState().activeQuestionId})}},{key:"setQuizEnabled",value:function(e,t){var n=e.getState().quizSettings;e.patchState({quizSettings:Object.assign(Object.assign({},n),{enabled:t.enabled})})}},{key:"setQuizLocked",value:function(e,t){e.patchState({quizModeLocked:t.locked})}},{key:"setEnableQuizRetake",value:function(e,t){e.patchState({enableQuizRetake:t.enable})}},{key:"setQuizQuestionsMode",value:function(e,t){e.patchState({quizQuestionsMode:t.mode})}},{key:"copyQuestions",value:function(e,t){var n=t.sourceChapterId,i=t.targetChapterId,o=e.getState().questions,r=[].concat(p(o),p(Yo(e.getState().questions,n).map((function(e){return Object.assign(Object.assign({},JSON.parse(JSON.stringify(e))),{id:qi.idWithPrefix("question"),chapterId:i})}))));e.patchState({questions:tr(r)})}},{key:"reorderQuestions",value:function(e,t){var n=t.chapterIds;e.patchState({questions:er(e.getState().questions,n)})}},{key:"addQuestion",value:function(e,t){var n=[].concat(p(e.getState().questions),[t.question]);e.patchState({questions:tr(n)})}},{key:"setQuestions",value:function(e,t){var n=t.questions;e.patchState({questions:tr(n)})}},{key:"setQuestion",value:function(e,t){var n=e.getState().questions.map((function(e){return e.id===t.question.id?t.question:e}));e.patchState({questions:n})}},{key:"removeQuestions",value:function(e,t){var n=e.getState(),i=null!=t.questionIds?t.questionIds:n.questions.map((function(e){return e.id})),o=n.questions.filter((function(e){return!i.includes(e.id)}));e.patchState({questions:tr(o)})}},{key:"submitQuestionAnswer",value:function(e,t){var n=p(e.getState().questionSubmissions),i=n.findIndex((function(e){return e.questionId===t.submission.questionId}));i>-1?n[i]=t.submission:n.push(t.submission),e.patchState({questionSubmissions:n})}},{key:"nextQuestion",value:function(e){var t,n=e.getState(),i=n.questions,o=n.activeQuestionId,r=(null===(t=i[e.getState().questions.findIndex((function(e){return e.id===o}))+1])||void 0===t?void 0:t.id)||void 0;void 0!==r&&e.patchState({activeQuestionId:r})}},{key:"previousQuestion",value:function(e){var t,n=e.getState(),i=n.questions,o=n.activeQuestionId,r=(null===(t=i[e.getState().questions.findIndex((function(e){return e.id===o}))-1])||void 0===t?void 0:t.id)||void 0;void 0!==r&&e.patchState({activeQuestionId:r})}},{key:"clearSubmissions",value:function(e){e.patchState({questionSubmissions:[]})}},{key:"setActiveQuestion",value:function(e,t){e.patchState({activeQuestionId:t.questionId})}},{key:"setQuizPickMode",value:function(e,t){var n=t.pickMode;e.patchState({pickMode:n})}},{key:"setActiveSubmission",value:function(e,t){var n=t.submission;e.patchState({activeSubmission:n})}},{key:"setQuizLifecycle",value:function(e,t){e.patchState({lifecycle:t.lifecycle})}}],[{key:"getQuizQuestionsByChapter",value:function(e){return Object(L.h)([Wo],(function(t){return Yo(t.questions,e)}))}},{key:"getLifecycle",value:function(e){return e.lifecycle}},{key:"getQuizSettings",value:function(e){return e.quizSettings}},{key:"getQuizModeActive",value:function(e){return e.quizModeActive}},{key:"getQuizModeLocked",value:function(e){return e.quizModeLocked}},{key:"getEnableQuizRetake",value:function(e){return e.enableQuizRetake}},{key:"getQuizReviewEnabled",value:function(e){var t=e.quizModeLocked,n=e.quizQuestionsMode,i=e.questions,o=e.quizSettings;return!(t&&!o.showSummary||t&&"restricted"===n&&1===i.length)}},{key:"globalSceneConfig",value:function(e){return e.sceneConfig}},{key:"hasQuiz",value:function(e){return e.questions.length>0}},{key:"getQuizEnabled",value:function(e){return!1!==e.quizSettings.enabled}},{key:"getAllQuestions",value:function(e){return e.questions}},{key:"getAllSubmissions",value:function(e){return e.questionSubmissions}},{key:"getActiveSubmitted",value:function(e){var t=e.questionSubmissions,n=e.activeQuestionId;return t.find((function(e){return e.questionId===n}))}},{key:"getActiveSubmission",value:function(e){return e.activeSubmission}},{key:"getActiveQuestion",value:function(e){return e.questions.find((function(t){return t.id===e.activeQuestionId}))}},{key:"getActiveQuestionId",value:function(e){return e.activeQuestionId}},{key:"getActiveQuestionLabels",value:function(e){var t=e.questions.find((function(t){return t.id===e.activeQuestionId}));return t&&t.type===No.LabelAnatomy?t.data.options:[]}},{key:"getActiveQuestionIndex",value:function(e){return e.questions.findIndex((function(t){return t.id===e.activeQuestionId}))}},{key:"getQuestionIndex",value:function(e,t){return Object(L.h)([Wo],(function(n){return er(n.questions,e).findIndex((function(e){return e.id===t}))}))}},{key:"getQuestionTotal",value:function(e){return e.questions.length}},{key:"getCorrectAnswerTotal",value:function(e){var t=e.questionSubmissions,n=e.questions;return t.filter((function(e){return qo(n.find((function(t){return t.id===e.questionId})),e.answer)})).length}},{key:"getQuestionsRemaining",value:function(e){var t=e.questions,n=e.questionSubmissions;return t.length-n.length}},{key:"hasQuestionRemaining",value:function(e){var t=e.questions;return e.questionSubmissions.length<t.length}},{key:"getPickMode",value:function(e){return e.pickMode}}]),e}()).\u0275fac=function(e){return new(e||nr)},nr.\u0275prov=j.Lb({token:nr,factory:nr.\u0275fac}),Go([Object(L.a)(Eo.ResetQuizState),Zo("design:type",Function),Zo("design:paramtypes",[Object,Eo.ResetQuizState]),Zo("design:returntype",void 0)],nr.prototype,"resetQuizState",null),Go([Object(L.a)(Eo.SetQuizState),Zo("design:type",Function),Zo("design:paramtypes",[Object,Eo.SetQuizState]),Zo("design:returntype",void 0)],nr.prototype,"setQuizState",null),Go([Object(L.a)(Eo.SetQuizSettings),Zo("design:type",Function),Zo("design:paramtypes",[Object,Eo.SetQuizSettings]),Zo("design:returntype",void 0)],nr.prototype,"setQuizSettings",null),Go([Object(L.a)(Eo.SetQuizActive),Zo("design:type",Function),Zo("design:paramtypes",[Object,Eo.SetQuizActive]),Zo("design:returntype",void 0)],nr.prototype,"setQuizActive",null),Go([Object(L.a)(Eo.SetQuizEnabled),Zo("design:type",Function),Zo("design:paramtypes",[Object,Eo.SetQuizEnabled]),Zo("design:returntype",void 0)],nr.prototype,"setQuizEnabled",null),Go([Object(L.a)(Eo.SetQuizLocked),Zo("design:type",Function),Zo("design:paramtypes",[Object,Eo.SetQuizLocked]),Zo("design:returntype",void 0)],nr.prototype,"setQuizLocked",null),Go([Object(L.a)(Eo.SetEnableQuizRetake),Zo("design:type",Function),Zo("design:paramtypes",[Object,Eo.SetEnableQuizRetake]),Zo("design:returntype",void 0)],nr.prototype,"setEnableQuizRetake",null),Go([Object(L.a)(Eo.SetQuizQuestionsMode),Zo("design:type",Function),Zo("design:paramtypes",[Object,Eo.SetQuizQuestionsMode]),Zo("design:returntype",void 0)],nr.prototype,"setQuizQuestionsMode",null),Go([Object(L.a)(Eo.CopyQuestions),Zo("design:type",Function),Zo("design:paramtypes",[Object,Eo.CopyQuestions]),Zo("design:returntype",void 0)],nr.prototype,"copyQuestions",null),Go([Object(L.a)(Eo.ReorderQuestions),Zo("design:type",Function),Zo("design:paramtypes",[Object,Eo.ReorderQuestions]),Zo("design:returntype",void 0)],nr.prototype,"reorderQuestions",null),Go([Object(L.a)(Eo.AddQuestion),Zo("design:type",Function),Zo("design:paramtypes",[Object,Eo.AddQuestion]),Zo("design:returntype",void 0)],nr.prototype,"addQuestion",null),Go([Object(L.a)(Eo.SetQuestions),Zo("design:type",Function),Zo("design:paramtypes",[Object,Eo.SetQuestions]),Zo("design:returntype",void 0)],nr.prototype,"setQuestions",null),Go([Object(L.a)(Eo.SetQuestion),Zo("design:type",Function),Zo("design:paramtypes",[Object,Eo.SetQuestion]),Zo("design:returntype",void 0)],nr.prototype,"setQuestion",null),Go([Object(L.a)(Eo.RemoveQuestions),Zo("design:type",Function),Zo("design:paramtypes",[Object,Eo.RemoveQuestions]),Zo("design:returntype",void 0)],nr.prototype,"removeQuestions",null),Go([Object(L.a)(Eo.SubmitQuestionAnswer),Zo("design:type",Function),Zo("design:paramtypes",[Object,Eo.SubmitQuestionAnswer]),Zo("design:returntype",void 0)],nr.prototype,"submitQuestionAnswer",null),Go([Object(L.a)(Eo.NextQuestion),Zo("design:type",Function),Zo("design:paramtypes",[Object]),Zo("design:returntype",void 0)],nr.prototype,"nextQuestion",null),Go([Object(L.a)(Eo.PreviousQuestion),Zo("design:type",Function),Zo("design:paramtypes",[Object]),Zo("design:returntype",void 0)],nr.prototype,"previousQuestion",null),Go([Object(L.a)(Eo.ClearSubmissions),Zo("design:type",Function),Zo("design:paramtypes",[Object]),Zo("design:returntype",void 0)],nr.prototype,"clearSubmissions",null),Go([Object(L.a)(Eo.SetActiveQuestion),Zo("design:type",Function),Zo("design:paramtypes",[Object,Eo.SetActiveQuestion]),Zo("design:returntype",void 0)],nr.prototype,"setActiveQuestion",null),Go([Object(L.a)(Eo.SetQuizPickMode),Zo("design:type",Function),Zo("design:paramtypes",[Object,Eo.SetQuizPickMode]),Zo("design:returntype",void 0)],nr.prototype,"setQuizPickMode",null),Go([Object(L.a)(Eo.SetActiveSubmission),Zo("design:type",Function),Zo("design:paramtypes",[Object,Eo.SetActiveSubmission]),Zo("design:returntype",void 0)],nr.prototype,"setActiveSubmission",null),Go([Object(L.a)(Eo.SetQuizLifecycle),Zo("design:type",Function),Zo("design:paramtypes",[Object,Eo.SetQuizLifecycle]),Zo("design:returntype",void 0)],nr.prototype,"setQuizLifecycle",null),Go([Object(L.e)(),Zo("design:type",Function),Zo("design:paramtypes",[Object]),Zo("design:returntype",void 0)],nr,"getLifecycle",null),Go([Object(L.e)(),Zo("design:type",Function),Zo("design:paramtypes",[Object]),Zo("design:returntype",Object)],nr,"getQuizSettings",null),Go([Object(L.e)(),Zo("design:type",Function),Zo("design:paramtypes",[Object]),Zo("design:returntype",void 0)],nr,"getQuizModeActive",null),Go([Object(L.e)(),Zo("design:type",Function),Zo("design:paramtypes",[Object]),Zo("design:returntype",void 0)],nr,"getQuizModeLocked",null),Go([Object(L.e)(),Zo("design:type",Function),Zo("design:paramtypes",[Object]),Zo("design:returntype",void 0)],nr,"getEnableQuizRetake",null),Go([Object(L.e)(),Zo("design:type",Function),Zo("design:paramtypes",[Object]),Zo("design:returntype",Boolean)],nr,"getQuizReviewEnabled",null),Go([Object(L.e)(),Zo("design:type",Function),Zo("design:paramtypes",[Object]),Zo("design:returntype",void 0)],nr,"globalSceneConfig",null),Go([Object(L.e)(),Zo("design:type",Function),Zo("design:paramtypes",[Object]),Zo("design:returntype",void 0)],nr,"hasQuiz",null),Go([Object(L.e)(),Zo("design:type",Function),Zo("design:paramtypes",[Object]),Zo("design:returntype",void 0)],nr,"getQuizEnabled",null),Go([Object(L.e)(),Zo("design:type",Function),Zo("design:paramtypes",[Object]),Zo("design:returntype",void 0)],nr,"getAllQuestions",null),Go([Object(L.e)(),Zo("design:type",Function),Zo("design:paramtypes",[Object]),Zo("design:returntype",void 0)],nr,"getAllSubmissions",null),Go([Object(L.e)(),Zo("design:type",Function),Zo("design:paramtypes",[Object]),Zo("design:returntype",void 0)],nr,"getActiveSubmitted",null),Go([Object(L.e)(),Zo("design:type",Function),Zo("design:paramtypes",[Object]),Zo("design:returntype",void 0)],nr,"getActiveSubmission",null),Go([Object(L.e)(),Zo("design:type",Function),Zo("design:paramtypes",[Object]),Zo("design:returntype",void 0)],nr,"getActiveQuestion",null),Go([Object(L.e)(),Zo("design:type",Function),Zo("design:paramtypes",[Object]),Zo("design:returntype",void 0)],nr,"getActiveQuestionId",null),Go([Object(L.e)(),Zo("design:type",Function),Zo("design:paramtypes",[Object]),Zo("design:returntype",Array)],nr,"getActiveQuestionLabels",null),Go([Object(L.e)(),Zo("design:type",Function),Zo("design:paramtypes",[Object]),Zo("design:returntype",void 0)],nr,"getActiveQuestionIndex",null),Go([Object(L.e)(),Zo("design:type",Function),Zo("design:paramtypes",[Object]),Zo("design:returntype",void 0)],nr,"getQuestionTotal",null),Go([Object(L.e)(),Zo("design:type",Function),Zo("design:paramtypes",[Object]),Zo("design:returntype",void 0)],nr,"getCorrectAnswerTotal",null),Go([Object(L.e)(),Zo("design:type",Function),Zo("design:paramtypes",[Object]),Zo("design:returntype",void 0)],nr,"getQuestionsRemaining",null),Go([Object(L.e)(),Zo("design:type",Function),Zo("design:paramtypes",[Object]),Zo("design:returntype",void 0)],nr,"hasQuestionRemaining",null),Go([Object(L.e)(),Zo("design:type",Function),Zo("design:paramtypes",[Object]),Zo("design:returntype",void 0)],nr,"getPickMode",null),nr=Wo=Go([Object(L.f)({name:"quiz",defaults:Xo})],nr)),ar=function e(){y(this,e)},sr={colors:[245,245,245,1,245,245,245,1],gradientType:"radial",colorStops:[0,100]},cr=function(e){return e.JPEG="image/jpeg",e.PNG="image/png",e}({}),lr=function(){var e=function e(t){y(this,e),this.thumbnails=t};return e.type="[Story Chapters] Register thumbnail URLs from story",e}(),pr=((ir=function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:sr,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:cr.JPEG,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.92,r=arguments.length>4?arguments[4]:void 0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"original",s=arguments.length>6?arguments[6]:void 0,c=arguments.length>7?arguments[7]:void 0,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:[];y(this,e),this.chapterId=t,this.background=n,this.imageType=i,this.imageQuality=o,this.dimensions=r,this.crop=a,this.includeLabels=s,this.includeCopyright=c,this.layers=l}).type="[Story Chapters] Take picture",ir),ur=function(){var e=function e(t,n,i){y(this,e),this.chapterId=t,this.blob=n,this.dimensions=i};return e.type="[Story Chapters] Take picture success",e}(),dr={small:{width:256,height:256},medium:{width:512,height:512},large:{width:1024,height:1024}},gr=function e(){y(this,e),this[or]=!0};or=immer.immerable;var hr,fr,br=r("LRne"),mr=r("GyhO"),vr=r("5+tZ"),yr=r("7wxJ"),xr=r("JIr8"),Or=r("wOnQ"),wr=r.n(Or),kr=(r("INDF"),r("Cfvw")),Cr=r("Iab2"),Sr=r("VUv2");(fr=hr||(hr={})).exportImage=function(e,t,n,i){var o="string"==typeof e?fr.base64ToBlob(e,t):e;return i?Object(Sr.changeDpiBlob)(o,i).then((function(e){Object(Cr.saveAs)(e,n)})):Object(Cr.saveAs)(o,n),Object(br.a)(!0)},fr.canvasToBlob=function(e,t,n){return new J.a((function(i){e.toBlob((function(e){i.next(e),i.complete()}),t,n)}))},fr.fitCanvas=function(e,t){var n=t.width,i=t.height,o=document.createElement("canvas");o.width=n,o.height=i;var r=o.getContext("2d"),a=Math.max(.5*(e.width-o.width/o.height*e.height),0);return new J.a((function(t){r.drawImage(e,a,0,o.width,o.height),t.next(o),t.complete()}))},fr.elementToCanvas=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=t?{backgroundColor:"transparent"}:{};return Object(kr.a)(wr()(e,Object.assign({scale:1},n)))},fr.combineCanvasElements=function(e){var t=Math.max.apply(Math,[0].concat(p(e.map((function(e){return e.width}))))),n=Math.max.apply(Math,[0].concat(p(e.map((function(e){return e.height}))))),i=document.createElement("canvas");i.width=t,i.height=n;var o=i.getContext("2d");return e.forEach((function(e){o.drawImage(e,0,0)})),i},fr.base64ToBlob=function(e,t){for(var n=atob(e.split(",")[1]),i=new ArrayBuffer(n.length),o=new Uint8Array(i),r=0;r<n.length;r++)o[r]=n.charCodeAt(r);return new Blob([i],{type:t})},fr.blobToBase64=function(e){return new J.a((function(t){var n=new FileReader;n.addEventListener("load",(function(){t.next(n.result),t.complete()})),n.readAsDataURL(e)}))},fr.blobToCanvas=function(e,t){var n=t.width,i=t.height;return new J.a((function(t){var o=document.createElement("canvas");o.width=n,o.height=i;var r=o.getContext("2d"),a=new Image;a.addEventListener("load",(function(){r.drawImage(a,0,0),t.next(o),t.complete()})),a.src=URL.createObjectURL(e)}))};var _r,jr,Pr,Mr,Ir=((_r=function(){function e(t,n,i){y(this,e),this.engineService=t,this.labelsService=n,this.store=i}return v(e,[{key:"localResize",value:function(e,t){var n=Human.renderer.canvas.canvas,i=Human.renderer.canvas.annotationCanvas,o=n.parentNode,r=o.clientWidth,a=o.clientHeight;return o.width=e,o.height=t,n.width=e,n.height=t,i.width=e,i.height=t,o.style.width=e+"px",o.style.height=t+"px",Human.renderer.canvas.init(),Human.renderer.viewportDirty=!0,Human.renderer.camera.updateCanvas(),Human.renderer.postprocess.updateCanvas(),Human.renderer.draw.updateCanvas(),Human.renderer.viewportDirty=!0,Human.renderer.prepareFrame(),Human.renderer.forceRenderFrame(),[r,a]}},{key:"canvasToImage",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"original",n=e.width/e.height,i=this.engineService.getCanvas(),o=i.width,r=i.height,a=.5*(i.width-o),s=0;switch(t){case"square":r>o?r=o:o=r,a=.5*(i.width-o),s=.5*(i.height-r);break;case"original":o=n*r}return new J.a((function(t){var n=e.getContext("2d");Human.renderer.forceRenderFrame(),n.drawImage(i,a,s,o,r,0,0,e.width,e.height),t.next(),t.complete()}))}},{key:"canvasToImageWithResize",value:function(e){var t=this,n=this.engineService.getCanvas();n.style.opacity="0",this.store.dispatch(new Lt(!1));var i=d(this.localResize(e.width,e.height),2),o=i[0],r=i[1],a=e.getContext("2d");return new J.a((function(e){setTimeout((function(){Human.renderer.viewportDirty=!0,Human.renderer.prepareFrame(),Human.renderer.forceRenderFrame(),a.drawImage(n,0,0,n.width,n.height),t.localResize(o,r),document.getElementById("theCanvas").style.opacity="",t.store.dispatch(new Lt(!0)),e.next(),e.complete()}),10)}))}},{key:"drawRadialGradient",value:function(e,t){var n=t.colors,i=d(t.colorStops.map((function(t){return n=t,i=e.width,o=e.height,r=[Math.pow(i/2,2),Math.pow(o/2,2)],a=r[0],s=r[1],n/100*Math.pow(a+s,.5);var n,i,o,r,a,s})),2),o=i[0],r=i[1],a=e.getContext("2d"),s=e.width/2,c=e.height/2,l=a.createRadialGradient(s,c,o,s,c,r);l.addColorStop(t.colorStops[0]/100,"rgba(".concat(n.slice(0,4).join(","),")")),l.addColorStop(t.colorStops[1]/100,"rgba(".concat(n.slice(4,8).join(","),")")),a.fillStyle=l,a.fillRect(0,0,e.width,e.height)}},{key:"drawLinearGradient",value:function(e,t){var n=t.colors,i=e.getContext("2d"),o=e.width/2,r=e.height/2,a=i.createLinearGradient(o,r,o,e.height);a.addColorStop(t.colorStops[0]/100,"rgba(".concat(n.slice(0,4).join(","),")")),a.addColorStop(t.colorStops[1]/100,"rgba(".concat(n.slice(4,8).join(","),")")),i.fillStyle=a,i.fillRect(0,0,e.width,e.height)}},{key:"takeSnapshot",value:function(e,t,n,i,o,r){var a=this,s=r.imageType,c=r.imageQuality,l=r.copyrightEnabled,u=r.crop,d=document.createElement("canvas");d.width=e,d.height=t,"radial"===n.gradientType?this.drawRadialGradient(d,n):"linear"===n.gradientType&&this.drawLinearGradient(d,n);var g=this.engineService.getCanvas(),h=[],f=(d.height>g.height||d.width>g.width?this.canvasToImageWithResize(d):this.canvasToImage(d,u)).pipe(Object(se.a)((function(){return d})));h.push(f);var b=[],m=this.labelsService.getLabelContainer();return o&&m&&b.push(m.nativeElement),b.push.apply(b,p(i)),h.push.apply(h,p(b.map((function(n){return(n instanceof HTMLCanvasElement?Object(br.a)(n):hr.elementToCanvas(n,!0)).pipe(Object(vr.a)((function(n){return hr.fitCanvas(n,{width:e,height:t})})))})))),Object(mr.a)(h).pipe(Object(yr.a)(),Object(se.a)((function(e){return hr.combineCanvasElements(e)})),Object(vr.a)((function(e){return l?a.writeLogoToCanvas(e,r):Object(br.a)(e)})),Object(vr.a)((function(e){return hr.canvasToBlob(e,s,c)})))}},{key:"writeLogoToCanvas",value:function(e,t){var n=this;return this.getLogoImage(t.copyrightImagePath).pipe(Object(se.a)((function(i){var o=i.width,r=i.height,a=e.width,s=e.height;.1*a>o&&(r=r/o*(o=.1*a));var c=n.getLogoPosition(a,s,o,r,t),l=c.xOffset,p=c.yOffset;return e.getContext("2d").drawImage(i,l,p,o,r),e})),Object(xr.a)((function(){return Object(br.a)(e)})))}},{key:"getLogoImage",value:function(e){return new J.a((function(t){var n=new Image;n.onload=function(){t.next(n),t.complete()},n.onerror=function(){return t.error()},n.src=e}))}},{key:"getLogoPosition",value:function(e,t,n,i,o){var r,a,s=o.copyrightPosition,c=o.copyrightOffset;switch(s.x){case"right":r=e-n;break;case"center":r=e/2-n/2;break;default:r=0}switch(s.y){case"bottom":a=t-i;break;case"center":a=t/2-i/2;break;default:a=0}return{xOffset:r+c.x,yOffset:a+c.y}}}]),e}()).\u0275fac=function(e){return new(e||_r)(j.Zb(Sn),j.Zb(po),j.Zb(L.g))},_r.\u0275prov=j.Lb({token:_r,factory:_r.\u0275fac,providedIn:"root"}),_r),zr=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},Tr=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Ur={imageType:cr.JPEG,crop:"original",copyrightEnabled:!1,copyrightImagePath:"assets/images/powered-by-biodigital-color.svg",copyrightPosition:{x:"left",y:"bottom"},copyrightOffset:{x:12,y:-12},imageQuality:1},Dr={thumbnails:new Map},Lr=((jr=function(){function e(t,n){y(this,e),this.snapshotService=t,this.store=n}return v(e,[{key:"registerChapterThumbnails",value:function(e,t){e.patchState(immer.produce(e.getState(),(function(e){e.thumbnails=new Map(t.thumbnails)})))}},{key:"takeChapterPicture",value:function(e,t){var n,i=this,o=t.chapterId,r=t.includeLabels,a=t.includeCopyright,s=t.dimensions,c=t.imageType,l=t.imageQuality,p=t.crop,u=t.layers,d=s||dr.large,g=d.width,h=d.height,f=t.background;switch(c){case cr.PNG:n=f||sr;break;case cr.JPEG:default:n=f&&!Ki.isTransparent(f)?f:sr}var b=f.colors.slice(0,3),m=bn.isLight(b),v=Object.assign(Object.assign({},Ur),{crop:p,imageType:c,imageQuality:l,copyrightEnabled:a,copyrightImagePath:m?"assets/images/powered-by-biodigital-color.svg":"assets/images/powered-by-biodigital-white.svg"});setTimeout((function(){i.snapshotService.takeSnapshot(g,h,n,u,r,v).subscribe((function(t){e.dispatch(new ur(o,t,d))}))}))}},{key:"takeChapterPictureSuccess",value:function(e,t){e.patchState(immer.produce(e.getState(),(function(e){var n=e.thumbnails.get(t.chapterId)||new gr;n.snapshot=URL.createObjectURL(t.blob),e.thumbnails.set(t.chapterId,n)})))}}],[{key:"getRegisteredThumbnails",value:function(e){return e.thumbnails}}]),e}()).\u0275fac=function(e){return new(e||jr)(j.Zb(Ir),j.Zb(L.g))},jr.\u0275prov=j.Lb({token:jr,factory:jr.\u0275fac}),zr([Object(L.a)(lr),Tr("design:type",Function),Tr("design:paramtypes",[Object,lr]),Tr("design:returntype",void 0)],jr.prototype,"registerChapterThumbnails",null),zr([Object(L.a)(pr),Tr("design:type",Function),Tr("design:paramtypes",[Object,pr]),Tr("design:returntype",void 0)],jr.prototype,"takeChapterPicture",null),zr([Object(L.a)(ur),Tr("design:type",Function),Tr("design:paramtypes",[Object,ur]),Tr("design:returntype",void 0)],jr.prototype,"takeChapterPictureSuccess",null),zr([Object(L.e)(),Tr("design:type",Function),Tr("design:paramtypes",[ar]),Tr("design:returntype",void 0)],jr,"getRegisteredThumbnails",null),jr=zr([Object(L.f)({name:"storyThumbnails",defaults:Dr})],jr)),Er=function e(t){var n=this;y(this,e),this.shown="majorityWins",this.selected="majorityWins",this.pickable="majorityWins",t.forEach((function(e){n[e]="majorityWins"}))},Fr=((Pr=function(){function e(t,n,i){y(this,e),this.store=t,this.labelService=n,this.graphService=i}return v(e,[{key:"getMinimumGraphSync",value:function(e,t,n){var i=this,o=Human.scene.colorRecipes.getRecipes(),r=Object.keys(new un(o)),a=function(e,t,n){var i={},o={};return Be.depthFirst(e,(function(r){o[r]=Be.isRoot(e,r)?Object.assign(Object.assign({},Be.getState(e,r,n)),t[r]||{}):Object.assign(Object.assign({},o[e.predecessors[r]]),t[r]||{}),Be.isLeaf(e,r)&&(i[r]=o[r])})),i}(e,t,r),s=function(e,t,n){var i=Object.keys(t),o=He.getInitialVoterState(n,i),r=He.getInitialElectionDepth(n,e),a=Object(ie.range)(r,-1).reduce((function(n,i){var o=He.getEligibleElections(e,Object.keys(n.remainingVoters),i),r=He.getElectionResults(e,n.remainingVoters,o,t),a=function(e){return e.reduce((function(e,t){var n=Object.keys(t).map((function(e){return function(e,t,n,i){var o=i.reduce((function(t,i){return t[i]=c({},e,!n),t}),{});return o[t]=c({},e,n),o}(e,t[e].id,t[e].result,t[e].dissenters)})).reduce((function(e,t){return Object(ie.merge)(e,t)}),{});return Object.keys(n).forEach((function(t){e[t]=n[t]})),e}),{})}(r.results);return Object.keys(a).forEach((function(e){n.syncGraph[e]=a[e]})),n.remainingVoters=r.remainingVoters,n}),{syncGraph:{},remainingVoters:o}).syncGraph;return function(e,t,n,i){var o,r=t.reduce((function(t,o){var r,a=e[o],s=e[i.predecessors[o]],c=l(n);try{for(c.s();!(r=c.n()).done;){var p=r.value;a[p]===s[p]&&t.push({successorId:o,prop:p})}}catch(u){c.e(u)}finally{c.f()}return t}),[]),a=l(r);try{for(a.s();!(o=a.n()).done;){var s=o.value;delete e[s.successorId][s.prop],0===Object.keys(e[s.successorId]).length&&delete e[s.successorId]}}catch(c){a.e(c)}finally{a.f()}return e}(a,Object.keys(a).filter((function(t){return!e.roots[t]&&!!e.successors[t]})),i,e)}(e,JSON.parse(JSON.stringify(new Er(o))),a);Object.entries(t).forEach((function(e){var t=d(e,2),n=t[0],i=t[1],o=Object(ie.omit)(i,r);Object(ie.isEmpty)(o)||(s[n]=Object.assign(Object.assign({},s[n]||{}),o))}));var p=new pn;return Object.entries(s).forEach((function(e){var t=d(e,2),o=t[0],r=t[1];p[i.switchNamespace(o,n)]=r}),this),p}},{key:"convertGraphSync",value:function(e){var t=this,n={},i={},o={},r={};return Object.entries(e).forEach((function(e){var a=d(e,2),s=a[0],l=a[1];Object.entries(l).forEach((function(e){var t=d(e,2),a=t[0],l=t[1];"shown"===a?n[s]=l:"selected"===a?i[s]=l:"pickable"===a?o[s]=!l:r[s]=Object.assign(Object.assign({},r[s]||{}),c({},a,l))}),t)}),this),{showObjects:n,selectObjects:i,pickThroughObjects:o,synchronization:r}}},{key:"switchNamespace",value:function(e,t){return t[e]||e}},{key:"serializeProperties",value:function(e){var t=Object.assign({},e.properties),n=Human.properties.properties["annotations.layout.type"];return"draggable"!==n&&(t["annotations.layout.type"]=n),t}},{key:"serializeHotspots",value:function(e,t){var n=this,i=p(e.hotspots),o={};return t.filter((function(t){return t.chapterId===e.id})).forEach((function(e){var t=n.labelService.serializeLabel(e,i.length);i=[].concat(p(i),p(t.hotspots)),o=Object.assign(Object.assign({},o),t.data)})),{customData:o,hotspots:i}}},{key:"serializeMedia",value:function(e){return e.media?Object.entries(e.media).reduce((function(e,t){var n=d(t,2),i=n[0],o=n[1];return e[i]=Object.assign({},o.data),e}),{}):null}},{key:"serializeBackground",value:function(e){return e?Object(ce.classToClass)(e):{}}},{key:"serializeUI",value:function(e,t){return Object(ie.isEmpty)(t)?{play:{count:1}}:t}},{key:"calcMinimumPaintState",value:function(e,t){return Object.keys(e.roots).reduce((function(n,i){return Object.assign(Object.assign({},n),function n(i){var o=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=(e.successors[i]||[]).reduce((function(e,o){var r=!Object(ie.isEqual)(t[i],t[o]);return Object.assign(Object.assign({},e),n(o,r))}),{});return o?Object.assign(c({},i,t[i]),r):r}(i))}),{})}},{key:"serializeVisibilityLayers",value:function(e,t){var n=Object.assign({},e);return Array.isArray(e.layers)&&(n.layers=e.layers.map((function(e){return Object.assign(Object.assign({},e),{objectIds:e.objectIds.filter((function(e){return Object.prototype.hasOwnProperty.call(t.nodes,e)}))})})).filter((function(e){return e.objectIds.length>0}))),n}},{key:"serializeTimelineMap",value:function(e){return e?e.map((function(e){var t=Object(ie.cloneDeep)(e);return delete t.id,t})):[]}},{key:"serializeChapter",value:function(e,t,n,i,o){var r,a,s,l=this.serializeHotspots(t,i),p=this.store.selectSnapshot(Ro.particleSystemsForChapter(t.id)),u=Object(ie.pickBy)(t.customData,(function(e,t){return!t.startsWith("errand")})),g=Object.assign(Object.assign(Object.assign({},u),l.customData),{particleSystems:p.map((function(e){return e.id}))}),h=this.store.selectSnapshot(rr.getQuizQuestionsByChapter(t.id)).map((function(e){var t=Object.assign({},e);return delete t.chapterId,t})),f=o[t.id],b=this.store.selectSnapshot(Lr.getRegisteredThumbnails),m=(null===(a=b.get(f))||void 0===a?void 0:a.urls)||(null===(s=b.get(t.id))||void 0===s?void 0:s.urls)||null,v=(c(r={id:f,displayName:t.info.displayName,description:t.info.description},t.camera.action,t.camera.location),c(r,"cameraRotationCenter",t.camera.rotationCenter),c(r,"background",this.serializeBackground(t.background)),c(r,"hotspots",l.hotspots),c(r,"clippingPlanes",{clips:t.clippingPlanes.clips,boundary:t.clippingPlanes.boundary}),c(r,"ui",this.serializeUI(t,t.ui)),c(r,"media",this.serializeMedia(t)),c(r,"graph",t.graph||{}),c(r,"timelineMap",this.serializeTimelineMap(t.timelineMap)),c(r,"customData",g),c(r,"viewModes",t.viewModes),c(r,"lights",t.lights),c(r,"recipes",t.recipes||{}),c(r,"transparencyMode",t.transparencyMode||""),c(r,"fallbackTransparency",t.fallbackTransparency||""),c(r,"properties",this.serializeProperties(t)),c(r,"effects",t.effects||{}),c(r,"options",t.options),c(r,"transitions",t.transitions),c(r,"environment",t.environment||{}),c(r,"legend",t.legend||[]),c(r,"visibilityLayers",this.serializeVisibilityLayers(t.visibilityLayers.src,e)),c(r,"colorRecipeObjects",t.colorRecipeObjects),c(r,"contentBlocks",t.contentBlocks||[]),c(r,"thumbnails",m),c(r,"quizQuestions",h),r),y=this.store.selectSnapshot(jo.getAllNodeState)[t.id],x=Object.keys(y).reduce((function(n,i){var o=y[i],r=o.shownSetByTween?Uo(e,i,t.showObjects)||To(e,i,t.showObjects):o.shown;return n.boolState[i]={shown:r,pickable:o.pickable},n.paintState[i]=ko.toEngine(o.paint),n}),{boolState:{},paintState:{}}),O=this.getMinimumGraphSync(e,x.boolState,n);return Object.entries(this.convertGraphSync(O)).forEach((function(e){var t=d(e,2),n=t[0],i=t[1];v[n]=i})),v.synchronization=this.calcMinimumPaintState(e,x.paintState),v}}]),e}()).\u0275fac=function(e){return new(e||Pr)(j.Zb(L.g),j.Zb(po),j.Zb(mn))},Pr.\u0275prov=j.Lb({token:Pr,factory:Pr.\u0275fac,providedIn:"root"}),Pr);(Mr||(Mr={})).makeChapterIdMap=function(e,t){return e.reduce((function(e,n){return e[n.id]=!0===t?qi.idWithPrefix("chapter"):n.id,e}),{})};var Ar,Rr,Vr,Nr,Br=function(e){return e[e.LeftClip=0]="LeftClip",e[e.RightClip=1]="RightClip",e[e.BottomClip=2]="BottomClip",e[e.TopClip=3]="TopClip",e[e.FrontClip=4]="FrontClip",e[e.BackClip=5]="BackClip",e}({}),Hr={0:"left",1:"right",2:"bottom",3:"top",4:"front",5:"back"},Qr={enabled:!1,clips:{left:{clipId:Br.LeftClip,enabled:!1,fade:!1,fadeDistance:0,progress:0},right:{clipId:Br.RightClip,enabled:!1,fade:!1,fadeDistance:0,progress:0},back:{clipId:Br.BackClip,enabled:!1,fade:!1,fadeDistance:0,progress:0},front:{clipId:Br.FrontClip,enabled:!1,fade:!1,fadeDistance:0,progress:0},top:{clipId:Br.TopClip,enabled:!1,fade:!1,fadeDistance:0,progress:0},bottom:{clipId:Br.BottomClip,enabled:!1,fade:!1,fadeDistance:0,progress:0}}},qr=function e(){y(this,e),this.firstTime=0,this.lastTime=1},$r=((Rr=function(){function e(){y(this,e),this.fps=30,this.epsilon=.001}return v(e,[{key:"getChapterLocalTimerange",value:function(e){var t=Human.timeline.activeRoot._chapters.find((function(t){return t.id===e}));return Object(ce.plainToClass)(qr,t.timeRange)}},{key:"mapGlobalTimeToLocal",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Human.timeline.activeRoot.mapGlobalTime(e,t);return n.time<0&&(n.time=0),n}},{key:"mapLocalTimeToGlobal",value:function(e,t){var n=Human.timeline.activeRoot._chapters.find((function(t){return t.id===e}));return Human.timeline.activeRoot.mapBranchTime(n,t)}},{key:"getLocalTime",value:function(e){var t=Human.timeline.activeRoot._nowBranch,n=this.mapLocalTimeToGlobal(t.id,t.timeRange.firstTime);return this.mapGlobalTimeToLocal(e,{tie:e===n?"later":"earlier"}).time}},{key:"isChapterAnimated",value:function(e){return e.timelineMap.filter((function(e){return"dummy"!==Object(ie.get)(e,"data.timeline")&&"dummy"!==Object(ie.get)(e,"data.timeline.id")&&"dummy"!==Object(ie.get)(e,"data.timeline.id.id")})).length>0}},{key:"isChapterLooped",value:function(e){return!0===Object(ie.get)(e,"loop")||-1===Object(ie.get)(e,"ui.play.count")}},{key:"scrub",value:function(e){Human.timeline.scrub({time:e.time,borderCondition:{which:e.which?e.which:"first",direction:"forwards"}})}},{key:"scrubFrame",value:function(e){var t,n="next"===e?1:-1,i=this.getTime(),o=this.secondsToFrames(i),r=this.framesToSeconds(o+n),a=Human.timeline.activeRoot._nowBranch,s=a.timeRange,c=this.mapLocalTimeToGlobal(a.id,s.firstTime),l=this.mapLocalTimeToGlobal(a.id,s.lastTime);t=r<=c?{time:c,which:"second"}:r>=l?{time:l,which:"first"}:{time:r},this.scrub(t)}},{key:"fromEngineTimelineMap",value:function(e){return{id:e.id,name:e.name,start:e.start,end:e.end,data:{timeline:e.leafTimeline.id,start:e.dataStart,end:e.dataEnd,fit:e.fit,onEnd:e.onEnd}}}},{key:"secondsToFrames",value:function(e){return Math.round(e*this.fps)}},{key:"framesToSeconds",value:function(e){return e/this.fps}},{key:"toNearestFrame",value:function(e){return this.framesToSeconds(this.secondsToFrames(e))}},{key:"formatTime",value:function(e){var t,n=this,i=function(t){var n=e<0?Math.ceil:Math.floor;return Math.abs(n(t)).toString().padStart(2,"0")},o=i(e/60),r=i(e%60),a=(t=e%1,Math.abs(n.secondsToFrames(t%1)).toString().padStart(2,"0"));return"".concat(e<0?"-":"").concat(o,":").concat(r,":").concat(a)}},{key:"parseFormattedTime",value:function(e){var t=/^-/,n=t.test(e)?-1:1;-1===n&&(e=e.replace(t,""));var i=e.split(":").reverse(),o=parseInt(i[0],10),r=parseInt(i[1],10),a=parseInt(i[2],10);return isNaN(o)&&(o=0),isNaN(r)&&(r=0),isNaN(a)&&(a=0),(60*a+r+this.framesToSeconds(o))*n}},{key:"constrainLocalTime",value:function(e){var t=Human.timeline.activeRoot._nowBranch.timeRange;return e<t.firstTime&&(e=t.firstTime),e>t.lastTime&&(e=t.lastTime),e}},{key:"addTimelineMap",value:function(e,t){var n=e.getTimeFrame(),i=e.createTimelineMap(t);t.id=i;var o=e.getTimeFrame();return n.lastTime!==o.lastTime&&Human.timeline.activeRoot.build(),t}},{key:"updateTimelineMaps",value:function(e,t){var n=e.getTimeFrame();t.forEach((function(t){e.updateTimelineMap(t.id,t)}));var i=e.getTimeFrame();n.lastTime!==i.lastTime&&Human.timeline.activeRoot.build()}},{key:"deleteTimelineMaps",value:function(e,t){var n=e.getTimeFrame();t.forEach((function(t){e.deleteTimelineMap(t)}));var i=e.getTimeFrame();n.lastTime!==i.lastTime&&Human.timeline.activeRoot.build()}},{key:"getLeafTimelines",value:function(){return Human.timeline.leafTimelines}},{key:"getTimeFrame",value:function(){return Human.timeline.getTimeFrame()}},{key:"getTime",value:function(){return Human.timeline.time}},{key:"isPlaying",value:function(){return Human.timeline.playing}},{key:"hasChapterFinished",value:function(e){var t=this.getChapterLocalTimerange(e),n=this.mapGlobalTimeToLocal(Human.timeline.time);return Math.abs(n.time-t.lastTime)<this.epsilon}},{key:"play",value:function(e){this.playParams=Object.keys(e).reduce((function(e,t){return void 0===e[t]&&delete e[t],e}),Object.assign({},e)),Human.timeline.play(this.playParams)}},{key:"rewind",value:function(e){var t=this.mapLocalTimeToGlobal(e,0);this.scrub({time:t,which:"second"})}},{key:"unpause",value:function(e){this.hasChapterFinished(e)&&this.rewind(e),Human.timeline.unpause()}},{key:"pause",value:function(){Human.timeline.pause()}}]),e}()).\u0275fac=function(e){return new(e||Rr)},Rr.\u0275prov=j.Lb({token:Rr,factory:Rr.\u0275fac,providedIn:"root"}),Rr),Wr=((Ar=function(){function e(t,n,i,o){y(this,e),this.engineService=t,this.serializeChapterService=n,this.labelService=i,this.animationService=o}return v(e,[{key:"addChapterToEngine",value:function(e,t){var n=Mr.makeChapterIdMap([e],!1),i=Be.createGraphFromSrc(Object.values(Human.scene.rootObjects),"objectId","objects",new un(Human.scene.colorRecipes.getRecipes())),o=this.serializeChapterService.serializeChapter(i,e,{},[],n);o.synchronization=JSON.parse(JSON.stringify(e.synchronization));var r=new Human.timeline.BranchTimeline(o);return Human.timeline.activeRoot.addChapter(r,{rebuild:!0,position:t}),r}},{key:"removeChapterFromEngine",value:function(e){Human.timeline.activeRoot._chapters=Human.timeline.activeRoot._chapters.filter((function(t){return t.id!==e.id})),Human.timeline.activeRoot.build()}},{key:"copyChapter",value:function(e,t){var n=Object(ce.classToClass)(e);return n.id=t,n.labels.forEach((function(e){e.id=qi.idWithPrefix("label"),e.chapterId=n.id})),n.readyState={model:!0,animation:!0},n}},{key:"getCurrentChapterId",value:function(){return Human.timeline.activeRoot._nowBranch.id}},{key:"fromHumanChapter",value:function(e,t,n,i){var o=this,r=Object.assign({},n),a=e.chapters[i];r.environment=Object.assign({},a.environment),r.transitions=Object.assign({},a.transitions),a.transparencyMode&&(r.transparencyMode=a.transparencyMode),r.showObjects=Object.assign({},e.chapters[i].showObjects),r.pickThroughObjects=Object.assign({},e.chapters[i].pickThroughObjects),r.camera=Object(ie.cloneDeep)(n.camera),a.cameraRotationCenter&&(r.camera.rotationCenter=a.cameraRotationCenter),Array.isArray(r.camera.rotationCenter)&&(r.camera.rotationCenter=Gn.fromArray(r.camera.rotationCenter));var s=r.camera.location;s.rotationCenter&&delete s.rotationCenter,r.id||(r.id=qi.idWithPrefix("chapter"));var c=!1;r.timelineMap=Object.values(n.maps).map((function(e){return"dummy"!==e.leafTimeline.id&&(c=!0),o.animationService.fromEngineTimelineMap(e)})),delete r.maps;var l=0,u=!!n.animation&&n.animation.loop;c&&u?l=-1:c&&!u&&(l=1),r.ui=n.ui&&!Object(ie.isEmpty)(n.ui)?n.ui:{play:{count:l}};var d=Ri.Annotation,g=p(r.annotations||[]).map((function(e){return o.labelService.deserializeAnnotation(e,r,d)})),h=[],f=this.groupHotspots(p(r.hotspots||[]).filter((function(i){var r=o.labelService.filterHotspot(e,n,i);return r?i.theme||(i.theme="module"===t?no.studioNext:no.classicHotspot):h.push(i),r}))).map((function(t){var r;return(r=o.labelService).deserializeHotspots.apply(r,[e,n,i].concat(p(t)))}));r.labels=[].concat(p(g),p(f)),delete r.annotations,r.background=Ki.deserialize(n.background);var b=Object(ce.plainToClass)(Ji,r);b.hotspots=h,b.readyState={model:!1,animation:!1},b.clippingPlanes=Object(ie.isEmpty)(b.clippingPlanes)?Qr:this.sanitizeClippingPlanes(b.clippingPlanes),b.legend=p(a.legend||[]),b.visibilityLayers=this.buildVisibilityLayers(a.visibilityLayers,b.showObjects),b.colorRecipeObjects=a.colorRecipeObjects,b.contentBlocks=p(a.contentBlocks||[]),b.quizQuestions=(a.quizQuestions||[]).map((function(e){return Object.assign(Object.assign({},e),{chapterId:r.id})}));var m=n.media||{};return Object.values(m).forEach((function(e){e.data.hasOwnProperty("lang")||(e.data.lang="en")})),b.media=m,b.thumbnails=a.thumbnails,b}},{key:"getChapterTweenStates",value:function(e){var t=e.timelineMap.filter((function(e){return"dummy"!==e.data.timeline})).map((function(e){return e.data.timeline}));return Array.from(new Set(t))}},{key:"getChapterLightLibraries",value:function(e){return(e.lights&&e.lights.libraries||[]).filter((function(e){return"default"!==e}))}},{key:"getChapterReflectionLibraries",value:function(e){var t=e.environment&&e.environment.reflectionMap||[],n=function(e){return e.split(".")[0]},i=(e.environment&&e.environment.lightMap||[]).map(n).concat(t.map(n));return Array.from(new Set(i))}},{key:"hasVisibilityLayers",value:function(e){return Array.isArray(e)&&e.length>0}},{key:"buildVisibilityLayers",value:function(e,t){var n={src:{},current:{}};if(e&&this.hasVisibilityLayers(e.layers)){var i=e.initIndex||0,o=this.unpackLayers(e.layers),r=this.buildShownObjectsSet(t),a=this.buildCurrentLayers(o,r);n.src={layers:e.layers,initIndex:i},n.current={layers:a,index:i,position:0}}return n}},{key:"buildShownObjectsSet",value:function(e){var t=this.engineService.getSceneGraph(Human.scene.rootObjects),n=Object.keys(t.nodes).filter((function(n){return Uo(t,n,e)||To(t,n,e)}));return new Set(n)}},{key:"unpackLayers",value:function(e){var t=[];return e.forEach((function(e){var n=[];e.objectIds.forEach((function(e){var t=Human.scene.objects[e].getLeafObjects();n=n.concat(t.map((function(e){return e.objectId})))})),t.push({name:e.name,objectIds:n})})),t}},{key:"buildCurrentLayers",value:function(e,t){var n=[];return e.forEach((function(i,o){var r=!1;i.objectIds.forEach((function(i){t.has(i)&&(r?n[n.length-1].objectIds.push(i):(n.push({name:e[o].name,objectIds:[i]}),r=!0))}))})),n}},{key:"sanitizeClippingPlanes",value:function(e){var t=Object.values(e.clips).some((function(e){return e.progress>0})),n=Object(ie.mapKeys)(e.clips,(function(e,t){return Hr[t]||t}));return Object.assign(Object.assign({},e),{clips:n,enabled:t})}},{key:"groupHotspots",value:function(e){var t={},n=function(e){return e.primitiveIndex?e.primitiveIndex.toFixed(0):e.pos?e.pos.map((function(e){return e.toFixed(3)})).join(":"):Math.random().toFixed(3)};return e.forEach((function(e){var i,o=[(i=e.type,RegExp("^circle-(plus|minus)").test(i)?"pair":"single"),e.objectId,n(e)].join("|");o in t?t[o].push(e):t[o]=[e]})),Object.values(t)}}]),e}()).\u0275fac=function(e){return new(e||Ar)(j.Zb(Sn),j.Zb(Fr),j.Zb(po),j.Zb($r))},Ar.\u0275prov=j.Lb({token:Ar,factory:Ar.\u0275fac,providedIn:"root"}),Ar),Kr=function(e){return e.Toggle="toggle",e.None="none",e}({}),Gr=function(){var e=function e(t){y(this,e),this.patches=t};return e.type="[Story Labels] Patch Labels",e}(),Zr=function(){var e=function e(t,n){y(this,e),this.labelId=t,this.offset=n};return e.type="[Story Labels] Set label Offset",e}(),Jr=function(){var e=function e(t){y(this,e),this.labels=t};return e.type="[Story Labels] Set Labels",e}(),Xr=function(){var e=function e(t){y(this,e),this.label=t};return e.type="[Story Labels] Add Label",e}(),Yr=function(){var e=function e(t){y(this,e),this.label=t};return e.type="[Story Labels] Set Contexdt Label",e}(),ea=function(){var e=function e(t,n){y(this,e),this.sourceChapter=t,this.targetChapter=n};return e.type="[Story Labels] Copy Labels",e}(),ta=function(){var e=function e(t){y(this,e),this.label=t};return e.type="[Story Labels] Remove Label",e}(),na=function(){var e=function e(){y(this,e)};return e.type="[Story Labels] Remove Context Label",e}(),ia=function(){var e=function e(t){y(this,e),this.chapter=t};return e.type="[Story Labels] Remove All Chapter Labels",e}(),oa=function(){var e=function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];y(this,e),this.label=t,this.record=n};return e.type="[Story Labels] Set Label",e}(),ra=function(){var e=function e(t,n){y(this,e),this.id=t,this.states=n};return e.type="[Story Labels] Set Label States",e}(),aa=function(){var e=function e(t){y(this,e),this.scale=t};return e.type="[Story Labels] Set Label Scale",e}(),sa=function(){var e=function e(t){y(this,e),this.label=t};return e.type="[Story Labels] Select Label",e}(),ca=function(){var e=function e(){y(this,e)};return e.type="[Story Labels] Reset",e}(),la=function(){var e=function e(t,n){y(this,e),this.labels=t,this.fields=n};return e.type="[Story Labels] Convert",e}(),pa=function(){var e=function e(t){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];y(this,e),this.enable=t,this.enableInfo=n,this.enableActions=i};return e.type="[Story Labels] Enable Context Label",e}(),ua=function(){var e=function e(t,n){y(this,e),this.labels=t,this.shown=n};return e.type="[Story Labels] Set Labels Shown",e}(),da=function(){var e=function e(t){y(this,e),this.show=t};return e.type="[Story Labels] Set All Labels Shown",e}(),ga=((Vr=function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Kr.None;y(this,e),this.collapsed=t,this.collapsedMode=n}).type="[Story Labels] Set Labels Collapsed",Vr),ha=function(){var e=function e(t){y(this,e),this.draggable=t};return e.type="[Story Labels] Set Draggable",e}(),fa=r("5+WD"),ba=function(e){return e.Hide="hide",e.Show="show",e.Collapse="collapse",e}({}),ma=function(e){return e.None="none",e.Small="small",e.Full="full",e}({}),va=function(e){return e.None="none",e.Circle="circle",e.Bar="bar",e}({}),ya=T.application===P.Viewer?va.Bar:va.Circle,xa=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ba.Hide,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];y(this,e),this.status=t,this.enable=n},Oa=r("qpAl"),wa=r.n(Oa),ka=r("xgIS"),Ca=r("VRyK");!function(e){function t(e){o()&&(e||(e=document.body),wa.a.prefixed("requestFullscreen",e)())}function n(){o()&&wa.a.prefixed("exitFullscreen",document)()}function i(){return wa.a.fullscreen&&wa.a.prefixed("fullscreenEnabled",document)}function o(){return!!i()||(console.warn("Fullscreen is not enabled"),!1)}function r(){return wa.a.prefixed("fullscreenElement",document)}e.toggleFullscreen=function(e){null===r()?t(e):n()},e.requestFullscreen=t,e.exitFullscreen=n,e.canFullscreen=i,e.checkFullscreenSupport=o,e.getFullscreenElement=r,e.isFullscreen=function(){return null!=r()},e.onFullscreenChange=function(){var e="mozfullscreenchange webkitfullscreenchange MSFullscreenChange fullscreenchange".split(" ").map((function(e){return Object(ka.a)(document.body,e)}));return Object(Ca.a).apply(void 0,p(e))}}(Nr||(Nr={}));var Sa,_a,ja,Pa,Ma,Ia,za,Ta,Ua,Da,La=function(e){return e.Play="play",e.Button="button",e.Hand="hand",e}({}),Ea=function(e){return e[e.OnDemand=0]="OnDemand",e[e.Interact=1]="Interact",e[e.Loader=2]="Loader",e[e.Tutorial=3]="Tutorial",e[e.Whiteboard=4]="Whiteboard",e[e.Help=5]="Help",e}({}),Fa=function(e){return e[e.Text=0]="Text",e[e.Paint=1]="Paint",e[e.Erase=2]="Erase",e}({}),Aa=[4,8,12,16,24,32],Ra=function(e){return e.slice(0).reverse().map((function(e){return{label:""+e,size:e}}))},Va=Ra(Aa),Na=Ra([8,12,16,20,24,32]),Ba=Ra(Aa),Ha={label:"Black",color:"#000000"},Qa={label:"White",color:"#ffffff"},qa=[Ha,{label:"Red",color:"#ff0000"},{label:"Yellow",color:"#ffff00"},{label:"Green",color:"#00ff00"},{label:"Cyan",color:"#00ffff"},{label:"Blue",color:"#0000ff"},{label:"Pink",color:"#ff00ff"},Qa],$a=Va[4],Wa=qa[0],Ka=Na[3],Ga=Ba[4],Za=Ha,Ja=Qa,Xa=function(e){return e.Mouse="mouse",e.Touch="touch",e}({}),Ya=function(e){return e[e.Default=0]="Default",e.DrawerOnly="drawer",e.ColumnOnly="column",e}({}),es=function(e){n(i,e);var t=o(i);function i(){var e;return y(this,i),(e=t.call(this,"HumanDatabase")).version(2).stores({keyValue:",value",analytics:"message"}),e.open(),e.keyValue=e.table("keyValue"),e.analytics=e.table("analytics"),e}return i}(r("Texg").a),ts=function(e,t,n,i){return new(n||(n=Promise))((function(o,r){function a(e){try{c(i.next(e))}catch(t){r(t)}}function s(e){try{c(i.throw(e))}catch(t){r(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))},ns=function(e){return e.WidgetOptions="widgetOptions",e.SnapshotOptions="snapshotOptions",e.Locale="locale",e.GroupRestriction="GroupRestriction",e.UserAppId="userAppId",e.RememberMeEmail="rememberMeEmail",e.LabelConversionSeen="labelConversionSeen",e.DefaultGroupEdit="defaultGroupEdit",e.DefaultCollectionId="defaultCollectionId",e.InternetExplorerWarning="internetExplorerWarning",e.GettingStartedTutorial="gettingStartedTutorial",e.AutoCapture="autoCapture",e.SystemMessage="systemMessage",e.ExploreRedesignMessage="exploreRedesignMessage",e.Iphone12Warning="iphone12Warning",e.RecentRecipes="recentRecipes",e.TeamTrialExpirationSeen="teamTrialExpiredSeen",e.ProExpirationSeen="proExpirationSeen",e.PaintPalettes="paintPalettes",e.RecentSearchConfig="recentSearchConfig",e.CameraDebug="cameraDebug",e}({}),is=function(e){return e.UserMessagesSeen="userMessagesSeen",e.PreviewSize="previewSize",e}({}),os=function(e){return e.PreviewStory="previewStory",e.PreviewBookmark="previewBookmark",e}({}),rs=function(){function e(){y(this,e),this._data={}}return v(e,[{key:"keys",get:function(){return Object.keys(this._data)}},{key:"length",get:function(){return this.keys.length}},{key:"clear",value:function(){this._data={}}},{key:"getItem",value:function(e){return this._data[e]}},{key:"key",value:function(e){return this.keys[e]}},{key:"removeItem",value:function(e){delete this._data[e]}},{key:"setItem",value:function(e,t){this._data[e]=t}}]),e}(),as=((Sa=function(){function e(){y(this,e),this._localStorage=this.getStorage("localStorage"),this._sessionStorage=this.getStorage("sessionStorage"),this._indexedStorage=new es}return v(e,[{key:"getLocalItem",value:function(e){return this._localStorage.getItem(""+e)}},{key:"getLocalJSON",value:function(e){var t=this.getLocalItem(e);return t?JSON.parse(t):null}},{key:"setLocalItem",value:function(e,t){var n="object"==typeof t?JSON.stringify(t):""+t;try{return this._localStorage.setItem(""+e,n),!0}catch(i){return!1}}},{key:"removeLocalItem",value:function(e){this._localStorage.removeItem(""+e)}},{key:"getSessionItem",value:function(e){var t=this._sessionStorage.getItem(""+e);return t?JSON.parse(t):null}},{key:"setSessionItem",value:function(e,t){var n=JSON.stringify(t);try{return this._sessionStorage.setItem(""+e,n),!0}catch(i){return!1}}},{key:"removeSessionItem",value:function(e){this._sessionStorage.removeItem(""+e)}},{key:"setDatabaseItem",value:function(e,t){return this._indexedStorage.keyValue.put(t,e)}},{key:"setDatabaseAnalyticItem",value:function(e){ts(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._indexedStorage.analytics.add({message:e});case 2:case"end":return t.stop()}}),t,this)})))}},{key:"getDatabaseOfflineAnalytics",value:function(e){ts(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._indexedStorage.analytics.toArray();case 2:n=t.sent.map((function(e){return e.message})),this._indexedStorage.analytics.clear(),e(n);case 4:case"end":return t.stop()}}),t,this)})))}},{key:"getDatabaseOfflineAnalyticsCount",value:function(e){ts(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._indexedStorage.analytics.toArray();case 2:n=t.sent,e(n.length);case 4:case"end":return t.stop()}}),t,this)})))}},{key:"getDatabaseItem",value:function(e){return this._indexedStorage.keyValue.get(e)}},{key:"clearStorage",value:function(){this.clearLocalStorage(),this.clearSessionStorage()}},{key:"clearLocalStorage",value:function(){this._localStorage.clear()}},{key:"clearSessionStorage",value:function(){this._sessionStorage.clear()}},{key:"getStorage",value:function(e){try{return window[e]||new rs}catch(t){return new rs}}}]),e}()).\u0275fac=function(e){return new(e||Sa)},Sa.\u0275prov=j.Lb({token:Sa,factory:Sa.\u0275fac,providedIn:"root"}),Sa),ss=function(e){return e.BioDigital="biodigital",e.Wikipedia="wikipedia",e.NCIT="ncit",e}({}),cs=function(e){return e[e.List=0]="List",e[e.Tree=1]="Tree",e}({}),ls=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},ps=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},us=function e(){y(this,e)},ds={audio:new xa,camera:new xa(ba.Show,!0),chapterList:new xa(ba.Show,!1),column:new xa,description:new xa,drawer:new(function(e){n(i,e);var t=o(i);function i(){var e,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return y(this,i),(e=t.call(this)).isExpandedInitially=n,e}return i}(xa)),fullscreen:new xa,help:new xa,labels:new(function(e){n(i,e);var t=o(i);function i(){var e,n=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return y(this,i),(e=t.call(this)).shown=n,e}return i}(xa)),labelInfo:new xa,labelList:new xa(ba.Show,!1),loader:new(function(e){n(i,e);var t=o(i);function i(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ya;return y(this,i),(e=t.call(this)).template=n,e}return i}(xa)),logo:new(function(e){n(i,e);var t=o(i);function i(){var e,n=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return y(this,i),(e=t.call(this)).isHyperLink=n,e}return i}(xa)),media:new(function(e){n(i,e);var t=o(i);function i(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ma.Small;return y(this,i),(e=t.call(this)).template=n,e}return i}(xa)),menu:new xa,nodeInfo:new xa(ba.Hide,!1),pagination:new xa,presenter:new xa(ba.Hide,!1),reset:new xa,search:new xa,quiz:new xa,titleOnly:new xa,toolbar:new xa,tools:new xa,anatomyLabels:new xa,tutorial:new xa(ba.Hide,!1),internetExplorerWarning:new xa,legend:new xa,undo:new xa,whiteboard:new xa,visibilityLayers:new xa,contextActions:new xa,toggleLabels:new xa},gs={lang:"en",canFullscreen:!1,canHover:!1,canTouch:!1,drawerCoversContent:!1,fullscreenActive:!1,help:{tab:ee.Basics},initialUI:ds,inputEnabled:!0,inputMode:Xa.Mouse,interactType:La.Play,onDemand:!1,layout:Ya.Default,labelsBreakpoint:480,menuOpen:!1,multiPickModeEnabled:!1,openWindows:[Ea.Loader],presentationActive:!1,searchDisplayMode:cs.Tree,nodeInfo:{show:!1,fallback:ss.Wikipedia},tutorial:{pageSize:0,pageIndex:-1},tutorialSeen:!0,ui:ds,usePrintImage:!1,whiteboard:{enabled:!1,hasPaint:!1,hasText:!1,brushSize:$a.size,brushColor:Wa.color,textSize:Ka.size,eraserSize:Ga.size,annotateMode:Fa.Paint},scrim:{show:!1,label:""}},hs=((ja=_a=function(){function e(t){y(this,e),this.storageService=t}return v(e,[{key:"setUI",value:function(e,t){var n=e.getState().ui;e.patchState({ui:Object.assign(Object.assign({},n),t.ui)})}},{key:"setInitialUI",value:function(e,t){e.patchState({initialUI:t.ui})}},{key:"setInputEnabled",value:function(e,t){e.patchState({inputEnabled:t.enabled})}},{key:"setCanHover",value:function(e,t){e.patchState({canHover:t.canHover})}},{key:"setCanTouch",value:function(e,t){e.patchState({canTouch:t.canTouch})}},{key:"setCanFullscreen",value:function(e,t){e.patchState({canFullscreen:t.canFullscreen})}},{key:"setSearchDisplayMode",value:function(e,t){e.patchState({searchDisplayMode:t.mode})}},{key:"setViewLanguage",value:function(e,t){var n=t.lang;e.patchState({lang:n})}},{key:"toggleNodeInfo",value:function(e,t){var n=t.show;e.patchState({nodeInfo:Object.assign(Object.assign({},e.getState().nodeInfo),{show:n})})}},{key:"setNodeInfoConfig",value:function(e,t){var n=t.fallback;e.patchState({nodeInfo:Object.assign(Object.assign({},e.getState().nodeInfo),{fallback:n})})}},{key:"togglePresentation",value:function(e,t){e.patchState({presentationActive:t.active})}},{key:"toggleHelp",value:function(e,t){e.patchState({help:{tab:t.tab}})}},{key:"setLoaderType",value:function(e,t){e.patchState({interactType:t.interactType})}},{key:"setOnDemand",value:function(e,t){e.patchState({onDemand:t.onDemand})}},{key:"setInputMode",value:function(e,t){var n=t.inputMode;e.patchState({inputMode:n})}},{key:"SetLayout",value:function(e,t){e.patchState({layout:t.layout})}},{key:"setTutorial",value:function(e,t){var n=e.getState().tutorial;e.patchState({tutorial:Object.assign(Object.assign({},n),t.tutorial)})}},{key:"startTutorial",value:function(e,t){e.patchState({tutorial:Object.assign(Object.assign({},e.getState().tutorial),{pageIndex:t.intro?-1:0})}),e.dispatch(new _.TutorialSeen(!0))}},{key:"tutorialSeen",value:function(e,t){this.storageService.setLocalItem(ns.GettingStartedTutorial,t.seen),e.patchState({tutorialSeen:t.seen})}},{key:"tutorialPrevious",value:function(e,t){var n=e.getState().tutorial,i=Math.max(n.pageIndex-1,0);e.dispatch(new _.SetTutorial(Object.assign(Object.assign({},n),{pageIndex:i})))}},{key:"tutorialNext",value:function(e,t){var n=e.getState().tutorial,i=Math.min(n.pageIndex+1,n.pageSize-1);e.dispatch(new _.SetTutorial(Object.assign(Object.assign({},n),{pageIndex:i})))}},{key:"setWhiteboardEnabled",value:function(e,t){var n=t.enabled;e.patchState({whiteboard:Object.assign(Object.assign({},e.getState().whiteboard),{enabled:n})})}},{key:"setWhiteboardBrushSize",value:function(e,t){var n=t.brushSize;e.patchState({whiteboard:Object.assign(Object.assign({},e.getState().whiteboard),{brushSize:n})})}},{key:"setWhiteboardTextSize",value:function(e,t){var n=t.size;e.patchState({whiteboard:Object.assign(Object.assign({},e.getState().whiteboard),{textSize:n})})}},{key:"setWhiteboardEraserSize",value:function(e,t){var n=t.eraserSize;e.patchState({whiteboard:Object.assign(Object.assign({},e.getState().whiteboard),{eraserSize:n})})}},{key:"setWhiteboardAnnotateMode",value:function(e,t){var n=t.mode;e.patchState({whiteboard:Object.assign(Object.assign({},e.getState().whiteboard),{annotateMode:n})})}},{key:"setWhiteboardBrushColor",value:function(e,t){var n=t.brushColor;e.patchState({whiteboard:Object.assign(Object.assign({},e.getState().whiteboard),{brushColor:n})})}},{key:"setWhiteboardHasPaint",value:function(e,t){var n=t.hasPaint;e.patchState({whiteboard:Object.assign(Object.assign({},e.getState().whiteboard),{hasPaint:n})})}},{key:"setWhiteboardHasText",value:function(e,t){var n=t.hasText;e.patchState({whiteboard:Object.assign(Object.assign({},e.getState().whiteboard),{hasText:n})})}},{key:"setMultiPickModeEnabled",value:function(e,t){e.patchState({multiPickModeEnabled:t.enabled})}},{key:"setLabelBreakpoint",value:function(e,t){e.patchState({labelsBreakpoint:t.labelsBreakpoint})}},{key:"setUsePrintImage",value:function(e,t){e.patchState({usePrintImage:t.usePrintImage})}},{key:"setWindows",value:function(e,t){e.patchState({openWindows:t.windows})}},{key:"openWindow",value:function(e,t){var n=e.getState().openWindows;n.indexOf(t.window)<0&&e.patchState({openWindows:[t.window].concat(p(n))})}},{key:"closeWindow",value:function(e,t){var n=e.getState().openWindows;null!=t.window?n=n.filter((function(e){return e!==t.window})):n.shift(),e.patchState({openWindows:p(n)})}},{key:"toggleWindow",value:function(e,t){var n=e.getState().openWindows.indexOf(t.window)>=0;e.dispatch((null!=t.show?t.show:!n)?new _.OpenWindow(t.window):new _.CloseWindow(t.window))}},{key:"toggleMenu",value:function(e,t){e.patchState({menuOpen:t.open})}},{key:"showScrim",value:function(e,t){e.patchState({scrim:{show:!0,label:t.label}})}},{key:"hideScrim",value:function(e,t){e.patchState({scrim:{show:!1,label:""}})}},{key:"ngxsOnInit",value:function(e){Nr.onFullscreenChange().subscribe((function(t){e.patchState({fullscreenActive:Nr.isFullscreen()})})),e.patchState({tutorialSeen:this.storageService.getLocalJSON(ns.GettingStartedTutorial)||!1})}}],[{key:"getUI",value:function(e){return e.ui}},{key:"getInitialUI",value:function(e){return e.initialUI}},{key:"getLabelsBreakpoint",value:function(e){return e.labelsBreakpoint}},{key:"getInputEnabled",value:function(e){return e.inputEnabled}},{key:"getFullscreenActive",value:function(e){return e.fullscreenActive}},{key:"getPresentationActive",value:function(e){return e.presentationActive}},{key:"getDrawerCoversContent",value:function(e){return e.drawerCoversContent}},{key:"getShowNodeInfo",value:function(e){return e.nodeInfo.show}},{key:"getNodeInfoFallback",value:function(e){return e.nodeInfo.fallback}},{key:"getViewLanguage",value:function(e){return e.lang}},{key:"getInteractType",value:function(e){return e.interactType}},{key:"getOnDemand",value:function(e){return e.onDemand}},{key:"getLayout",value:function(e){return e.layout}},{key:"getInputMode",value:function(e){return e.inputMode}},{key:"getShowHelpTab",value:function(e){return e.help.tab}},{key:"getTutorial",value:function(e){return e.tutorial}},{key:"getTutorialSeen",value:function(e){return e.tutorialSeen}},{key:"getWhiteboardEnabled",value:function(e){return e.whiteboard.enabled}},{key:"getWhiteboardBrushSize",value:function(e){return e.whiteboard.brushSize}},{key:"getWhiteboardTextSize",value:function(e){return e.whiteboard.textSize}},{key:"getWhiteboardEraserSize",value:function(e){return e.whiteboard.eraserSize}},{key:"getWhiteboardAnnotateMode",value:function(e){return e.whiteboard.annotateMode}},{key:"getWhiteboardBrushColor",value:function(e){return e.whiteboard.brushColor}},{key:"getWhiteboardHasPaint",value:function(e){return e.whiteboard.hasPaint}},{key:"getWhiteboardHasText",value:function(e){return e.whiteboard.hasText}},{key:"getCanTouch",value:function(e){return e.canTouch}},{key:"getCanHover",value:function(e){return e.canHover}},{key:"getMultiPickModeEnabled",value:function(e){return e.multiPickModeEnabled}},{key:"getSearchDisplayMode",value:function(e){return e.searchDisplayMode}},{key:"getUsePrintImage",value:function(e){return e.usePrintImage}},{key:"getOpenWindow",value:function(e){return e.openWindows.length>0?e.openWindows.sort()[0]:null}},{key:"getMenuOpen",value:function(e){return e.menuOpen}},{key:"getScrim",value:function(e){return e.scrim}},{key:"shouldWindowOpen",value:function(e){return Object(L.h)([_a],(function(t){return t.openWindows.indexOf(e)>=0}))}}]),e}()).\u0275fac=function(e){return new(e||ja)(j.Zb(as))},ja.\u0275prov=j.Lb({token:ja,factory:ja.\u0275fac}),ls([Object(L.a)(_.SetUI),ps("design:type",Function),ps("design:paramtypes",[Object,_.SetUI]),ps("design:returntype",void 0)],ja.prototype,"setUI",null),ls([Object(L.a)(_.SetInitialUI),ps("design:type",Function),ps("design:paramtypes",[Object,_.SetInitialUI]),ps("design:returntype",void 0)],ja.prototype,"setInitialUI",null),ls([Object(L.a)(_.SetInputEnabled),ps("design:type",Function),ps("design:paramtypes",[Object,_.SetInputEnabled]),ps("design:returntype",void 0)],ja.prototype,"setInputEnabled",null),ls([Object(L.a)(_.SetCanHover),ps("design:type",Function),ps("design:paramtypes",[Object,_.SetCanHover]),ps("design:returntype",void 0)],ja.prototype,"setCanHover",null),ls([Object(L.a)(_.SetCanTouch),ps("design:type",Function),ps("design:paramtypes",[Object,_.SetCanTouch]),ps("design:returntype",void 0)],ja.prototype,"setCanTouch",null),ls([Object(L.a)(_.SetCanFullscreen),ps("design:type",Function),ps("design:paramtypes",[Object,_.SetCanFullscreen]),ps("design:returntype",void 0)],ja.prototype,"setCanFullscreen",null),ls([Object(L.a)(_.SetSearchDisplayMode),ps("design:type",Function),ps("design:paramtypes",[Object,_.SetSearchDisplayMode]),ps("design:returntype",void 0)],ja.prototype,"setSearchDisplayMode",null),ls([Object(L.a)(_.SetViewLanguage),ps("design:type",Function),ps("design:paramtypes",[Object,_.SetViewLanguage]),ps("design:returntype",void 0)],ja.prototype,"setViewLanguage",null),ls([Object(L.a)(_.ToggleNodeInfo),ps("design:type",Function),ps("design:paramtypes",[Object,_.ToggleNodeInfo]),ps("design:returntype",void 0)],ja.prototype,"toggleNodeInfo",null),ls([Object(L.a)(_.SetNodeInfoConfig),ps("design:type",Function),ps("design:paramtypes",[Object,_.SetNodeInfoConfig]),ps("design:returntype",void 0)],ja.prototype,"setNodeInfoConfig",null),ls([Object(L.a)(_.TogglePresentation),ps("design:type",Function),ps("design:paramtypes",[Object,_.TogglePresentation]),ps("design:returntype",void 0)],ja.prototype,"togglePresentation",null),ls([Object(L.a)(_.ToggleHelpTab),ps("design:type",Function),ps("design:paramtypes",[Object,_.ToggleHelpTab]),ps("design:returntype",void 0)],ja.prototype,"toggleHelp",null),ls([Object(L.a)(_.SetInteractType),ps("design:type",Function),ps("design:paramtypes",[Object,_.SetInteractType]),ps("design:returntype",void 0)],ja.prototype,"setLoaderType",null),ls([Object(L.a)(_.SetOnDemand),ps("design:type",Function),ps("design:paramtypes",[Object,_.SetOnDemand]),ps("design:returntype",void 0)],ja.prototype,"setOnDemand",null),ls([Object(L.a)(_.SetInputMode),ps("design:type",Function),ps("design:paramtypes",[Object,_.SetInputMode]),ps("design:returntype",void 0)],ja.prototype,"setInputMode",null),ls([Object(L.a)(_.SetLayout),ps("design:type",Function),ps("design:paramtypes",[Object,_.SetLayout]),ps("design:returntype",void 0)],ja.prototype,"SetLayout",null),ls([Object(L.a)(_.SetTutorial),ps("design:type",Function),ps("design:paramtypes",[Object,_.SetTutorial]),ps("design:returntype",void 0)],ja.prototype,"setTutorial",null),ls([Object(L.a)(_.StartTutorial),ps("design:type",Function),ps("design:paramtypes",[Object,_.StartTutorial]),ps("design:returntype",void 0)],ja.prototype,"startTutorial",null),ls([Object(L.a)(_.TutorialSeen),ps("design:type",Function),ps("design:paramtypes",[Object,_.TutorialSeen]),ps("design:returntype",void 0)],ja.prototype,"tutorialSeen",null),ls([Object(L.a)(_.TutorialPrevious),ps("design:type",Function),ps("design:paramtypes",[Object,_.TutorialPrevious]),ps("design:returntype",void 0)],ja.prototype,"tutorialPrevious",null),ls([Object(L.a)(_.TutorialNext),ps("design:type",Function),ps("design:paramtypes",[Object,_.TutorialNext]),ps("design:returntype",void 0)],ja.prototype,"tutorialNext",null),ls([Object(L.a)(_.SetWhiteboardEnabled),ps("design:type",Function),ps("design:paramtypes",[Object,_.SetWhiteboardEnabled]),ps("design:returntype",void 0)],ja.prototype,"setWhiteboardEnabled",null),ls([Object(L.a)(_.SetWhiteboardBrushSize),ps("design:type",Function),ps("design:paramtypes",[Object,_.SetWhiteboardBrushSize]),ps("design:returntype",void 0)],ja.prototype,"setWhiteboardBrushSize",null),ls([Object(L.a)(_.SetWhiteboardTextSize),ps("design:type",Function),ps("design:paramtypes",[Object,_.SetWhiteboardTextSize]),ps("design:returntype",void 0)],ja.prototype,"setWhiteboardTextSize",null),ls([Object(L.a)(_.SetWhiteboardEraserSize),ps("design:type",Function),ps("design:paramtypes",[Object,_.SetWhiteboardEraserSize]),ps("design:returntype",void 0)],ja.prototype,"setWhiteboardEraserSize",null),ls([Object(L.a)(_.SetWhiteboardAnnotateMode),ps("design:type",Function),ps("design:paramtypes",[Object,_.SetWhiteboardAnnotateMode]),ps("design:returntype",void 0)],ja.prototype,"setWhiteboardAnnotateMode",null),ls([Object(L.a)(_.SetWhiteboardBrushColor),ps("design:type",Function),ps("design:paramtypes",[Object,_.SetWhiteboardBrushColor]),ps("design:returntype",void 0)],ja.prototype,"setWhiteboardBrushColor",null),ls([Object(L.a)(_.SetWhiteboardHasPaint),ps("design:type",Function),ps("design:paramtypes",[Object,_.SetWhiteboardHasPaint]),ps("design:returntype",void 0)],ja.prototype,"setWhiteboardHasPaint",null),ls([Object(L.a)(_.SetWhiteboardHasText),ps("design:type",Function),ps("design:paramtypes",[Object,_.SetWhiteboardHasText]),ps("design:returntype",void 0)],ja.prototype,"setWhiteboardHasText",null),ls([Object(L.a)(_.SetMultiPickModeEnabled),ps("design:type",Function),ps("design:paramtypes",[Object,_.SetMultiPickModeEnabled]),ps("design:returntype",void 0)],ja.prototype,"setMultiPickModeEnabled",null),ls([Object(L.a)(_.SetLabelBreakpoint),ps("design:type",Function),ps("design:paramtypes",[Object,_.SetLabelBreakpoint]),ps("design:returntype",void 0)],ja.prototype,"setLabelBreakpoint",null),ls([Object(L.a)(_.SetUsePrintImage),ps("design:type",Function),ps("design:paramtypes",[Object,_.SetUsePrintImage]),ps("design:returntype",void 0)],ja.prototype,"setUsePrintImage",null),ls([Object(L.a)(_.SetWindows),ps("design:type",Function),ps("design:paramtypes",[Object,_.SetWindows]),ps("design:returntype",void 0)],ja.prototype,"setWindows",null),ls([Object(L.a)(_.OpenWindow),ps("design:type",Function),ps("design:paramtypes",[Object,_.OpenWindow]),ps("design:returntype",void 0)],ja.prototype,"openWindow",null),ls([Object(L.a)(_.CloseWindow),ps("design:type",Function),ps("design:paramtypes",[Object,_.CloseWindow]),ps("design:returntype",void 0)],ja.prototype,"closeWindow",null),ls([Object(L.a)(_.ToggleWindow),ps("design:type",Function),ps("design:paramtypes",[Object,_.ToggleWindow]),ps("design:returntype",void 0)],ja.prototype,"toggleWindow",null),ls([Object(L.a)(_.ToggleMenu),ps("design:type",Function),ps("design:paramtypes",[Object,_.ToggleMenu]),ps("design:returntype",void 0)],ja.prototype,"toggleMenu",null),ls([Object(L.a)(_.ShowScrim),ps("design:type",Function),ps("design:paramtypes",[Object,_.ShowScrim]),ps("design:returntype",void 0)],ja.prototype,"showScrim",null),ls([Object(L.a)(_.HideScrim),ps("design:type",Function),ps("design:paramtypes",[Object,_.HideScrim]),ps("design:returntype",void 0)],ja.prototype,"hideScrim",null),ls([Object(L.e)(),ps("design:type",Function),ps("design:paramtypes",[us]),ps("design:returntype",void 0)],ja,"getUI",null),ls([Object(L.e)(),ps("design:type",Function),ps("design:paramtypes",[us]),ps("design:returntype",void 0)],ja,"getInitialUI",null),ls([Object(L.e)(),ps("design:type",Function),ps("design:paramtypes",[us]),ps("design:returntype",void 0)],ja,"getLabelsBreakpoint",null),ls([Object(L.e)(),ps("design:type",Function),ps("design:paramtypes",[us]),ps("design:returntype",void 0)],ja,"getInputEnabled",null),ls([Object(L.e)(),ps("design:type",Function),ps("design:paramtypes",[us]),ps("design:returntype",void 0)],ja,"getFullscreenActive",null),ls([Object(L.e)(),ps("design:type",Function),ps("design:paramtypes",[us]),ps("design:returntype",void 0)],ja,"getPresentationActive",null),ls([Object(L.e)(),ps("design:type",Function),ps("design:paramtypes",[us]),ps("design:returntype",void 0)],ja,"getDrawerCoversContent",null),ls([Object(L.e)(),ps("design:type",Function),ps("design:paramtypes",[us]),ps("design:returntype",void 0)],ja,"getShowNodeInfo",null),ls([Object(L.e)(),ps("design:type",Function),ps("design:paramtypes",[us]),ps("design:returntype",void 0)],ja,"getNodeInfoFallback",null),ls([Object(L.e)(),ps("design:type",Function),ps("design:paramtypes",[us]),ps("design:returntype",void 0)],ja,"getViewLanguage",null),ls([Object(L.e)(),ps("design:type",Function),ps("design:paramtypes",[us]),ps("design:returntype",void 0)],ja,"getInteractType",null),ls([Object(L.e)(),ps("design:type",Function),ps("design:paramtypes",[us]),ps("design:returntype",void 0)],ja,"getOnDemand",null),ls([Object(L.e)(),ps("design:type",Function),ps("design:paramtypes",[us]),ps("design:returntype",void 0)],ja,"getLayout",null),ls([Object(L.e)(),ps("design:type",Function),ps("design:paramtypes",[us]),ps("design:returntype",void 0)],ja,"getInputMode",null),ls([Object(L.e)(),ps("design:type",Function),ps("design:paramtypes",[us]),ps("design:returntype",void 0)],ja,"getShowHelpTab",null),ls([Object(L.e)(),ps("design:type",Function),ps("design:paramtypes",[us]),ps("design:returntype",void 0)],ja,"getTutorial",null),ls([Object(L.e)(),ps("design:type",Function),ps("design:paramtypes",[us]),ps("design:returntype",void 0)],ja,"getTutorialSeen",null),ls([Object(L.e)(),ps("design:type",Function),ps("design:paramtypes",[us]),ps("design:returntype",void 0)],ja,"getWhiteboardEnabled",null),ls([Object(L.e)(),ps("design:type",Function),ps("design:paramtypes",[us]),ps("design:returntype",void 0)],ja,"getWhiteboardBrushSize",null),ls([Object(L.e)(),ps("design:type",Function),ps("design:paramtypes",[us]),ps("design:returntype",void 0)],ja,"getWhiteboardTextSize",null),ls([Object(L.e)(),ps("design:type",Function),ps("design:paramtypes",[us]),ps("design:returntype",void 0)],ja,"getWhiteboardEraserSize",null),ls([Object(L.e)(),ps("design:type",Function),ps("design:paramtypes",[us]),ps("design:returntype",void 0)],ja,"getWhiteboardAnnotateMode",null),ls([Object(L.e)(),ps("design:type",Function),ps("design:paramtypes",[us]),ps("design:returntype",void 0)],ja,"getWhiteboardBrushColor",null),ls([Object(L.e)(),ps("design:type",Function),ps("design:paramtypes",[us]),ps("design:returntype",void 0)],ja,"getWhiteboardHasPaint",null),ls([Object(L.e)(),ps("design:type",Function),ps("design:paramtypes",[us]),ps("design:returntype",void 0)],ja,"getWhiteboardHasText",null),ls([Object(L.e)(),ps("design:type",Function),ps("design:paramtypes",[us]),ps("design:returntype",void 0)],ja,"getCanTouch",null),ls([Object(L.e)(),ps("design:type",Function),ps("design:paramtypes",[us]),ps("design:returntype",void 0)],ja,"getCanHover",null),ls([Object(L.e)(),ps("design:type",Function),ps("design:paramtypes",[us]),ps("design:returntype",void 0)],ja,"getMultiPickModeEnabled",null),ls([Object(L.e)(),ps("design:type",Function),ps("design:paramtypes",[us]),ps("design:returntype",void 0)],ja,"getSearchDisplayMode",null),ls([Object(L.e)(),ps("design:type",Function),ps("design:paramtypes",[us]),ps("design:returntype",void 0)],ja,"getUsePrintImage",null),ls([Object(L.e)(),ps("design:type",Function),ps("design:paramtypes",[us]),ps("design:returntype",void 0)],ja,"getOpenWindow",null),ls([Object(L.e)(),ps("design:type",Function),ps("design:paramtypes",[us]),ps("design:returntype",void 0)],ja,"getMenuOpen",null),ls([Object(L.e)(),ps("design:type",Function),ps("design:paramtypes",[us]),ps("design:returntype",void 0)],ja,"getScrim",null),ja=_a=ls([Object(L.f)({name:"view",defaults:gs})],ja)),fs=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},bs=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},ms={loading:!1,chapters:[],chaptersViewed:[],selectedChapter:null,isChapterAnimated:!1,thumbnails:new Map,patches:[],inversePatches:[]},vs=((Ma=Pa=function(){function e(t,n,i,o){y(this,e),this.store=t,this.chapterService=n,this.animationService=i,this.engineService=o}return v(e,[{key:"setChapters",value:function(e,t){e.patchState(immer.produce(e.getState(),(function(e){e.chapters=t.chapters})))}},{key:"SetChapterCameraAction",value:function(e,t){e.patchState(immer.produce(e.getState(),(function(e){e.chapters.find((function(e){return e.id===t.chapterId})).camera.action=t.cameraAction})))}},{key:"setChapterUI",value:function(e,t){e.patchState(immer.produce(e.getState(),(function(e){e.chapters.find((function(e){return e.id===t.chapterId})).ui=t.ui})))}},{key:"setChapterInfo",value:function(e,t){e.patchState(immer.produce(e.getState(),(function(e){e.chapters.find((function(e){return e.id===t.chapterId})).info=t.info})))}},{key:"setChapterLegend",value:function(e,t){e.patchState(immer.produce(e.getState(),(function(e){e.chapters.find((function(e){return e.id===t.chapterId})).legend=t.legend})))}},{key:"addToChapterLegend",value:function(e,t){e.patchState(immer.produce(e.getState(),(function(e){e.chapters.find((function(e){return e.id===t.chapterId})).legend.push(t.legend)})))}},{key:"ReorderChapters",value:function(e,t){e.patchState(immer.produce(e.getState(),(function(e){Object(fa.c)(e.chapters,t.previousIndex,t.currentIndex)})));var n=e.getState().chapters.map((function(e){return e.id}));e.dispatch(new Eo.ReorderQuestions(n))}},{key:"SetChapterReadyState",value:function(e,t){var n=immer.produce(e.getState(),(function(e){if(t.chapterId){var n=e.chapters.find((function(e){return e.id===t.chapterId}));n&&(n.readyState=Object.assign(Object.assign({},n.readyState),t.readyState))}}));e.patchState(n)}},{key:"SetChapterPostProcessing",value:function(e,t){e.patchState(immer.produce(e.getState(),(function(e){var n=e.chapters.find((function(e){return e.id===t.chapterId})),i=n.properties||{};n.customData=Object.assign(Object.assign({},n.customData?n.customData:{}),{postprocess:t.effects}),n.properties=Object.assign(Object.assign({},i),t.properties)})))}},{key:"SetChapterTransitions",value:function(e,t){e.patchState(immer.produce(e.getState(),(function(e){var n=e.chapters.find((function(e){return e.id===t.chapterId}));n.transitions=n.transitions||{},n.transitions[t.key]=t.transition})))}},{key:"setChapterProperties",value:function(e,t){var n=t.chapterIds,i=t.properties;e.patchState(immer.produce(e.getState(),(function(e){e.chapters.filter((function(e){return n.includes(e.id)})).forEach((function(e){var t,n=null!==(t=e.properties)&&void 0!==t?t:{};e.properties=Object.assign(Object.assign({},n),i)}))})))}},{key:"removeChapterProperties",value:function(e,t){var n=t.chapterIds,i=t.properties;e.patchState(immer.produce(e.getState(),(function(e){e.chapters.filter((function(e){return n.includes(e.id)})).forEach((function(e){(null==e?void 0:e.properties)&&i.forEach((function(t){delete e.properties[t]}))}))})))}},{key:"SetChapterTransparencyMode",value:function(e,t){e.patchState(immer.produce(e.getState(),(function(e){e.chapters.find((function(e){return e.id===t.chapterId})).transparencyMode=t.transparencyMode})))}},{key:"applyChapterPatch",value:function(e,t){var n=immer.applyPatches(e.getState(),t.patches);e.patchState(immer.produce(n,(function(e){e.patches=[],e.inversePatches=[]})))}},{key:"setChapterClippingPlane",value:function(e,t){var n=this,i=d(immer.produceWithPatches(e.getState(),(function(e){var i=e.chapters.find((function(e){return e.id===t.chapterId}));i.clippingPlanes.clips=t.clips,i.clippingPlanes.enabled=t.enabled,i.clippingPlanes.boundary=i.clippingPlanes.boundary||JSON.parse(JSON.stringify(n.engineService.getSceneBoundary()))})),3),o=i[0],r=i[1],a=i[2],s=immer.produce(o,(function(e){var t,n;(t=e.patches).push.apply(t,p(r)),(n=e.inversePatches).push.apply(n,p(a))}));t.record&&e.dispatch(new eo.SavePatches([{forward:s.patches,inverse:p(s.inversePatches).reverse(),patchAction:ni}])),e.patchState(t.record?immer.produce(s,(function(e){e.patches=[],e.inversePatches=[]})):s)}},{key:"setChapterBackground",value:function(e,t){e.patchState(immer.produce(e.getState(),(function(e){e.chapters.find((function(e){return e.id===t.chapterId})).background=t.background})))}},{key:"setAllChaptersBackground",value:function(e,t){e.patchState(immer.produce(e.getState(),(function(e){e.chapters.forEach((function(e){e.background=t.background}))})))}},{key:"resetSelectedChapterBackground",value:function(e,t){var n=e.getState().selectedChapter;this.store.dispatch(new ki(n,sr))}},{key:"setSelectedChapterBackground",value:function(e,t){var n=t.background,i=e.getState().selectedChapter;this.store.dispatch(new ki(i,n))}},{key:"selectChapter",value:function(e,t){if(t.chapter){this.store.dispatch([new Yi.UpdateNodesChecked(!1),new Yi.UpdateNodeSelected]);var n=this.animationService.isChapterAnimated(t.chapter);this.store.dispatch(new vt(!!t.chapter));var i=immer.produce(e.getState(),(function(e){e.chaptersViewed.some((function(e){return t.chapter.id===e}))||e.chaptersViewed.push(t.chapter.id),e.selectedChapter=t.chapter?t.chapter.id:null,e.isChapterAnimated=n}));e.patchState(i)}}},{key:"selectChapterById",value:function(e,t){var n=t.chapterId;this.store.dispatch(new vt(!0)),e.patchState({selectedChapter:n})}},{key:"duplicateChapter",value:function(e,t){var n=this,i=t.chapter,o=this.chapterService.copyChapter(i,t.chapterId),r=e.getState().chapters.length,a=this.store.selectSnapshot(Pa.getSelectedChapterBackground),s=this.store.selectSnapshot(Lr.getRegisteredThumbnails),c=s.get(i.id);i.thumbnails?o.thumbnails=Object(ie.cloneDeep)(i.thumbnails):Object(ie.isNil)(c)?e.dispatch(new pr(o.id,a,cr.JPEG,92,dr.medium,"square")):s.set(o.id,c);var l=this.chapterService.addChapterToEngine(Object(ie.cloneDeep)(o),r);o.timelineMap=Object.values(l.maps).map((function(e){return n.animationService.fromEngineTimelineMap(e)})),e.patchState(immer.produce(e.getState(),(function(e){e.chapters.push(o)}))),e.dispatch(new Eo.CopyQuestions(i.id,o.id)),e.dispatch(new ea(i,o))}},{key:"nextChapter",value:function(e,t){var n=e.getState().chapters,i=this.chapterService.getCurrentChapterId(),o=0;(o=n.findIndex((function(e){return e.id===i})))<n.length-1&&o++,e.dispatch(new si(n[o]))}},{key:"previousChapter",value:function(e,t){var n=e.getState().chapters,i=this.chapterService.getCurrentChapterId(),o=0;(o=n.findIndex((function(e){return e.id===i})))>0&&o--,e.dispatch(new si(n[o]))}},{key:"lastChapter",value:function(e,t){var n=e.getState().chapters;e.dispatch(new si(n[n.length-1]))}},{key:"firstChapter",value:function(e,t){var n=e.getState().chapters;e.dispatch(new si(n[0]))}},{key:"removeChapter",value:function(e,t){var n=e.getState(),i=n.chapters,o=n.selectedChapter;if(1!==i.length){this.chapterService.removeChapterFromEngine(t.chapter);var r=i.findIndex((function(e){return e.id===t.chapter.id}));if(e.patchState(immer.produce(e.getState(),(function(e){e.chapters.splice(r,1)}))),t.chapter.id===o){var a=e.getState().chapters,s=Math.min(r,a.length-1);e.dispatch(new si(a[s]))}e.dispatch(new ia(t.chapter))}}},{key:"resetStoryChaptersState",value:function(e,t){e.setState(ms)}},{key:"RecordCamera",value:function(e,t){e.patchState(immer.produce(e.getState(),(function(e){var n=e.chapters.find((function(e){return e.id===t.chapterId}));n.camera.location=t.camera,t.rotationCenter&&(n.camera.rotationCenter=t.rotationCenter)})))}},{key:"setChapterCurrentLayersIndexPosition",value:function(e,t){var n=d(immer.produceWithPatches(e.getState(),(function(e){var n=e.chapters.find((function(e){return e.id===t.chapterId})).visibilityLayers.current;n.index=t.index,n.position=t.position})),3),i=n[0],o=n[1],r=n[2],a=immer.produce(i,(function(e){var t,n;(t=e.patches).push.apply(t,p(o)),(n=e.inversePatches).push.apply(n,p(r))}));e.patchState(a),t.record&&e.dispatch(new eo.SavePatches([{forward:a.patches,inverse:a.inversePatches,patchAction:ni}]))}},{key:"setChapterMedia",value:function(e,t){e.patchState(immer.produce(e.getState(),(function(e){e.chapters.find((function(e){return e.id===t.chapterId})).media=t.media})))}},{key:"setChapterContentBlocks",value:function(e,t){t.contentBlocks=[].concat(p(t.contentBlocks.filter((function(e){return e.type===Vo.Ticker}))),p(t.contentBlocks.filter((function(e){return e.type!==Vo.Ticker})))),e.patchState(immer.produce(e.getState(),(function(e){e.chapters.find((function(e){return e.id===t.chapterId})).contentBlocks=t.contentBlocks})))}},{key:"addChapterTimelineMap",value:function(e,t){e.patchState(immer.produce(e.getState(),(function(e){var n=e.chapters.find((function(e){return e.id===t.chapterId}));n.timelineMap.push.apply(n.timelineMap,t.timelineMaps)})))}},{key:"updateChapterTimelineMap",value:function(e,t){e.patchState(immer.produce(e.getState(),(function(e){var n=e.chapters.find((function(e){return e.id===t.chapterId}));t.updates.forEach((function(e){var t=n.timelineMap.find((function(t){return t.id===e.id}));Object(ie.merge)(t,e)}))})))}},{key:"removeFromChapterTimelineMap",value:function(e,t){e.patchState(immer.produce(e.getState(),(function(e){var n=e.chapters.find((function(e){return e.id===t.chapterId}));t.timelineMapIds.forEach((function(e){var t=n.timelineMap.findIndex((function(t){return t.id===e}));n.timelineMap.splice(t,1)}))})))}},{key:"SetChapterLights",value:function(e,t){e.patchState(immer.produce(e.getState(),(function(e){e.chapters.find((function(e){return e.id===t.chapterId})).lights.libraries=[t.lights]}))),this.engineService.setBranchLights(t.chapterId,t.lights)}}],[{key:"getStoryChapters",value:function(e){return e.chapters}},{key:"getChaptersViewed",value:function(e){return e.chaptersViewed}},{key:"getChapter",value:function(e){return Object(L.h)([Pa],(function(t){return t.chapters.find((function(t){return t.id===e}))}))}},{key:"getSelectedChapterId",value:function(e){return e.selectedChapter}},{key:"getSelectedChapter",value:function(e){return e.chapters.find((function(t){return t.id===e.selectedChapter}))||null}},{key:"getNextChapter",value:function(e){var t=1+Pa.getSelectedChapterIndex(e);return e.chapters[t]}},{key:"getPreviousChapter",value:function(e){var t=-1+Pa.getSelectedChapterIndex(e);return e.chapters[t]}},{key:"getSelectedChapterIndex",value:function(e){return e.chapters.findIndex((function(t){return t.id===e.selectedChapter}))}},{key:"getSelectedChapterTitle",value:function(e){return e.chapters.find((function(t){return t.id===e.selectedChapter})).info.displayName}},{key:"getChapterCount",value:function(e){return e.chapters.length}},{key:"getRegisteredThumbnails",value:function(e){return e.thumbnails}},{key:"getIsChapterAnimated",value:function(e){return e.isChapterAnimated}},{key:"getSelectedChapterReadyState",value:function(e){var t=e.chapters,n=e.selectedChapter,i=Pa.findChapter(t,n);return Object(ie.get)(i,"readyState")}},{key:"getChaptersLoaded",value:function(e){return{count:e.chapters.length,modelChapters:e.chapters.filter((function(e){return e.readyState.model})),animationChapters:e.chapters.filter((function(e){return e.readyState.animation}))}}},{key:"getAllChaptersModelsReady",value:function(e){return e.chapters.length>0&&e.chapters.every((function(e){return e.readyState.model}))}},{key:"getSelectedChapterModelReady",value:function(e){var t=Pa.getSelectedChapterReadyState(e);return!Object(ie.isNil)(t)&&t.model}},{key:"getAllChaptersAnimationsReady",value:function(e){return e.chapters.length>0&&e.chapters.every((function(e){return e.readyState.animation}))}},{key:"getSelectedChapterBackground",value:function(e){var t=e.chapters,n=e.selectedChapter,i=Pa.findChapter(t,n);return Object(ie.get)(i,"background")||sr}},{key:"getAllChaptersBackground",value:function(e){return e.chapters.map((function(e){return Object(ie.get)(e,"background")}))}},{key:"getSelectedChapterAllAudio",value:function(e){var t=e.chapters.find((function(t){return t.id===e.selectedChapter}));return t&&t.media?Object.values(t.media).filter((function(e){return"audio"===e.data.streamType})):[]}},{key:"getSelectedChapterAudio",value:function(e,t){return this.getSelectedChapterAllAudio(e).find((function(e){return e.data.lang===t.lang}))}},{key:"getSelectedChapterLegend",value:function(e){var t=e.chapters,n=e.selectedChapter,i=Pa.findChapter(t,n);return Object(ie.get)(i,"legend")||[]}},{key:"getSelectedChapterClippingPlanes",value:function(e){var t=e.chapters,n=e.selectedChapter,i=Pa.findChapter(t,n);return Object(ie.get)(i,"clippingPlanes")}},{key:"getChapterCamera",value:function(e){var t=e.chapters,n=e.selectedChapter,i=Pa.findChapter(t,n);return Object(ie.get)(i,"camera.location")}},{key:"findChapter",value:function(e,t){return e.find((function(e){return e.id===t}))}},{key:"getAllChaptersCurrentLayers",value:function(e){return e.chapters.map((function(e){return Object(ie.get)(e,"visibilityLayers.current.layers",[])}))}},{key:"getSelectedChapterSrcLayers",value:function(e){var t=e.chapters,n=e.selectedChapter,i=Pa.findChapter(t,n);return Object(ie.get)(i,"visibilityLayers.src.layers",[])}},{key:"getSelectedChapterCurrentLayers",value:function(e){var t=e.chapters,n=e.selectedChapter,i=Pa.findChapter(t,n);return Object(ie.get)(i,"visibilityLayers.current.layers",[])}},{key:"getSelectedChapterCurrentLayersIndex",value:function(e){var t=e.chapters,n=e.selectedChapter,i=Pa.findChapter(t,n);return Object(ie.get)(i,"visibilityLayers.current.index")}},{key:"getSelectedChapterCurrentLayersPosition",value:function(e){var t=e.chapters,n=e.selectedChapter,i=Pa.findChapter(t,n);return Object(ie.get)(i,"visibilityLayers.current.position")}},{key:"getSelectedChapterContentBlocks",value:function(e){var t=e.chapters,n=e.selectedChapter,i=Pa.findChapter(t,n);return Object(ie.get)(i,"contentBlocks",[])}},{key:"getSelectedChapterTimelineMap",value:function(e){var t=e.chapters,n=e.selectedChapter,i=Pa.findChapter(t,n);return Object(ie.get)(i,"timelineMap")||[]}}]),e}()).\u0275fac=function(e){return new(e||Ma)(j.Zb(L.g),j.Zb(Wr),j.Zb($r),j.Zb(Sn))},Ma.\u0275prov=j.Lb({token:Ma,factory:Ma.\u0275fac}),fs([Object(L.a)(li),bs("design:type",Function),bs("design:paramtypes",[Object,li]),bs("design:returntype",void 0)],Ma.prototype,"setChapters",null),fs([Object(L.a)(pi),bs("design:type",Function),bs("design:paramtypes",[Object,pi]),bs("design:returntype",void 0)],Ma.prototype,"SetChapterCameraAction",null),fs([Object(L.a)(ui),bs("design:type",Function),bs("design:paramtypes",[Object,ui]),bs("design:returntype",void 0)],Ma.prototype,"setChapterUI",null),fs([Object(L.a)(di),bs("design:type",Function),bs("design:paramtypes",[Object,di]),bs("design:returntype",void 0)],Ma.prototype,"setChapterInfo",null),fs([Object(L.a)(gi),bs("design:type",Function),bs("design:paramtypes",[Object,gi]),bs("design:returntype",void 0)],Ma.prototype,"setChapterLegend",null),fs([Object(L.a)(hi),bs("design:type",Function),bs("design:paramtypes",[Object,hi]),bs("design:returntype",void 0)],Ma.prototype,"addToChapterLegend",null),fs([Object(L.a)(fi),bs("design:type",Function),bs("design:paramtypes",[Object,fi]),bs("design:returntype",void 0)],Ma.prototype,"ReorderChapters",null),fs([Object(L.a)(bi),bs("design:type",Function),bs("design:paramtypes",[Object,bi]),bs("design:returntype",void 0)],Ma.prototype,"SetChapterReadyState",null),fs([Object(L.a)(mi),bs("design:type",Function),bs("design:paramtypes",[Object,mi]),bs("design:returntype",void 0)],Ma.prototype,"SetChapterPostProcessing",null),fs([Object(L.a)(vi),bs("design:type",Function),bs("design:paramtypes",[Object,vi]),bs("design:returntype",void 0)],Ma.prototype,"SetChapterTransitions",null),fs([Object(L.a)(yi),bs("design:type",Function),bs("design:paramtypes",[Object,yi]),bs("design:returntype",void 0)],Ma.prototype,"setChapterProperties",null),fs([Object(L.a)(xi),bs("design:type",Function),bs("design:paramtypes",[Object,xi]),bs("design:returntype",void 0)],Ma.prototype,"removeChapterProperties",null),fs([Object(L.a)(Oi),bs("design:type",Function),bs("design:paramtypes",[Object,Oi]),bs("design:returntype",void 0)],Ma.prototype,"SetChapterTransparencyMode",null),fs([Object(L.a)(ni),bs("design:type",Function),bs("design:paramtypes",[Object,ni]),bs("design:returntype",void 0)],Ma.prototype,"applyChapterPatch",null),fs([Object(L.a)(wi),bs("design:type",Function),bs("design:paramtypes",[Object,wi]),bs("design:returntype",void 0)],Ma.prototype,"setChapterClippingPlane",null),fs([Object(L.a)(ki),bs("design:type",Function),bs("design:paramtypes",[Object,ki]),bs("design:returntype",void 0)],Ma.prototype,"setChapterBackground",null),fs([Object(L.a)(Ci),bs("design:type",Function),bs("design:paramtypes",[Object,Ci]),bs("design:returntype",void 0)],Ma.prototype,"setAllChaptersBackground",null),fs([Object(L.a)(Si),bs("design:type",Function),bs("design:paramtypes",[Object,Si]),bs("design:returntype",void 0)],Ma.prototype,"resetSelectedChapterBackground",null),fs([Object(L.a)(_i),bs("design:type",Function),bs("design:paramtypes",[Object,Object]),bs("design:returntype",void 0)],Ma.prototype,"setSelectedChapterBackground",null),fs([Object(L.a)(si),bs("design:type",Function),bs("design:paramtypes",[Object,si]),bs("design:returntype",void 0)],Ma.prototype,"selectChapter",null),fs([Object(L.a)(ci),bs("design:type",Function),bs("design:paramtypes",[Object,Object]),bs("design:returntype",void 0)],Ma.prototype,"selectChapterById",null),fs([Object(L.a)(ji),bs("design:type",Function),bs("design:paramtypes",[Object,ji]),bs("design:returntype",void 0)],Ma.prototype,"duplicateChapter",null),fs([Object(L.a)(ii),bs("design:type",Function),bs("design:paramtypes",[Object,ii]),bs("design:returntype",void 0)],Ma.prototype,"nextChapter",null),fs([Object(L.a)(oi),bs("design:type",Function),bs("design:paramtypes",[Object,oi]),bs("design:returntype",void 0)],Ma.prototype,"previousChapter",null),fs([Object(L.a)(ai),bs("design:type",Function),bs("design:paramtypes",[Object,ai]),bs("design:returntype",void 0)],Ma.prototype,"lastChapter",null),fs([Object(L.a)(ri),bs("design:type",Function),bs("design:paramtypes",[Object,ai]),bs("design:returntype",void 0)],Ma.prototype,"firstChapter",null),fs([Object(L.a)(Pi),bs("design:type",Function),bs("design:paramtypes",[Object,Pi]),bs("design:returntype",void 0)],Ma.prototype,"removeChapter",null),fs([Object(L.a)(Mi),bs("design:type",Function),bs("design:paramtypes",[Object,Mi]),bs("design:returntype",void 0)],Ma.prototype,"resetStoryChaptersState",null),fs([Object(L.a)(Ii),bs("design:type",Function),bs("design:paramtypes",[Object,Ii]),bs("design:returntype",void 0)],Ma.prototype,"RecordCamera",null),fs([Object(L.a)(zi),bs("design:type",Function),bs("design:paramtypes",[Object,zi]),bs("design:returntype",void 0)],Ma.prototype,"setChapterCurrentLayersIndexPosition",null),fs([Object(L.a)(Ti),bs("design:type",Function),bs("design:paramtypes",[Object,Ti]),bs("design:returntype",void 0)],Ma.prototype,"setChapterMedia",null),fs([Object(L.a)(Ui),bs("design:type",Function),bs("design:paramtypes",[Object,Ui]),bs("design:returntype",void 0)],Ma.prototype,"setChapterContentBlocks",null),fs([Object(L.a)(Di),bs("design:type",Function),bs("design:paramtypes",[Object,Di]),bs("design:returntype",void 0)],Ma.prototype,"addChapterTimelineMap",null),fs([Object(L.a)(Li),bs("design:type",Function),bs("design:paramtypes",[Object,Li]),bs("design:returntype",void 0)],Ma.prototype,"updateChapterTimelineMap",null),fs([Object(L.a)(Ei),bs("design:type",Function),bs("design:paramtypes",[Object,Ei]),bs("design:returntype",void 0)],Ma.prototype,"removeFromChapterTimelineMap",null),fs([Object(L.a)(Fi),bs("design:type",Function),bs("design:paramtypes",[Object,Fi]),bs("design:returntype",void 0)],Ma.prototype,"SetChapterLights",null),fs([Object(L.e)(),bs("design:type",Function),bs("design:paramtypes",[ti]),bs("design:returntype",void 0)],Ma,"getStoryChapters",null),fs([Object(L.e)(),bs("design:type",Function),bs("design:paramtypes",[ti]),bs("design:returntype",void 0)],Ma,"getChaptersViewed",null),fs([Object(L.e)(),bs("design:type",Function),bs("design:paramtypes",[ti]),bs("design:returntype",void 0)],Ma,"getSelectedChapterId",null),fs([Object(L.e)(),bs("design:type",Function),bs("design:paramtypes",[ti]),bs("design:returntype",void 0)],Ma,"getSelectedChapter",null),fs([Object(L.e)(),bs("design:type",Function),bs("design:paramtypes",[ti]),bs("design:returntype",void 0)],Ma,"getNextChapter",null),fs([Object(L.e)(),bs("design:type",Function),bs("design:paramtypes",[ti]),bs("design:returntype",void 0)],Ma,"getPreviousChapter",null),fs([Object(L.e)(),bs("design:type",Function),bs("design:paramtypes",[ti]),bs("design:returntype",void 0)],Ma,"getSelectedChapterIndex",null),fs([Object(L.e)(),bs("design:type",Function),bs("design:paramtypes",[ti]),bs("design:returntype",void 0)],Ma,"getSelectedChapterTitle",null),fs([Object(L.e)(),bs("design:type",Function),bs("design:paramtypes",[ti]),bs("design:returntype",void 0)],Ma,"getChapterCount",null),fs([Object(L.e)(),bs("design:type",Function),bs("design:paramtypes",[ti]),bs("design:returntype",void 0)],Ma,"getRegisteredThumbnails",null),fs([Object(L.e)(),bs("design:type",Function),bs("design:paramtypes",[ti]),bs("design:returntype",void 0)],Ma,"getIsChapterAnimated",null),fs([Object(L.e)(),bs("design:type",Function),bs("design:paramtypes",[ti]),bs("design:returntype",void 0)],Ma,"getSelectedChapterReadyState",null),fs([Object(L.e)(),bs("design:type",Function),bs("design:paramtypes",[ti]),bs("design:returntype",void 0)],Ma,"getChaptersLoaded",null),fs([Object(L.e)(),bs("design:type",Function),bs("design:paramtypes",[ti]),bs("design:returntype",void 0)],Ma,"getAllChaptersModelsReady",null),fs([Object(L.e)(),bs("design:type",Function),bs("design:paramtypes",[ti]),bs("design:returntype",void 0)],Ma,"getSelectedChapterModelReady",null),fs([Object(L.e)(),bs("design:type",Function),bs("design:paramtypes",[ti]),bs("design:returntype",void 0)],Ma,"getAllChaptersAnimationsReady",null),fs([Object(L.e)(),bs("design:type",Function),bs("design:paramtypes",[ti]),bs("design:returntype",void 0)],Ma,"getSelectedChapterBackground",null),fs([Object(L.e)(),bs("design:type",Function),bs("design:paramtypes",[ti]),bs("design:returntype",void 0)],Ma,"getAllChaptersBackground",null),fs([Object(L.e)(),bs("design:type",Function),bs("design:paramtypes",[ti]),bs("design:returntype",void 0)],Ma,"getSelectedChapterAllAudio",null),fs([Object(L.e)([hs]),bs("design:type",Function),bs("design:paramtypes",[ti,us]),bs("design:returntype",void 0)],Ma,"getSelectedChapterAudio",null),fs([Object(L.e)(),bs("design:type",Function),bs("design:paramtypes",[ti]),bs("design:returntype",void 0)],Ma,"getSelectedChapterLegend",null),fs([Object(L.e)(),bs("design:type",Function),bs("design:paramtypes",[ti]),bs("design:returntype",void 0)],Ma,"getSelectedChapterClippingPlanes",null),fs([Object(L.e)(),bs("design:type",Function),bs("design:paramtypes",[ti]),bs("design:returntype",void 0)],Ma,"getChapterCamera",null),fs([Object(L.e)(),bs("design:type",Function),bs("design:paramtypes",[ti]),bs("design:returntype",Array)],Ma,"getAllChaptersCurrentLayers",null),fs([Object(L.e)(),bs("design:type",Function),bs("design:paramtypes",[ti]),bs("design:returntype",Array)],Ma,"getSelectedChapterSrcLayers",null),fs([Object(L.e)(),bs("design:type",Function),bs("design:paramtypes",[ti]),bs("design:returntype",Array)],Ma,"getSelectedChapterCurrentLayers",null),fs([Object(L.e)(),bs("design:type",Function),bs("design:paramtypes",[ti]),bs("design:returntype",Number)],Ma,"getSelectedChapterCurrentLayersIndex",null),fs([Object(L.e)(),bs("design:type",Function),bs("design:paramtypes",[ti]),bs("design:returntype",Number)],Ma,"getSelectedChapterCurrentLayersPosition",null),fs([Object(L.e)(),bs("design:type",Function),bs("design:paramtypes",[ti]),bs("design:returntype",Array)],Ma,"getSelectedChapterContentBlocks",null),fs([Object(L.e)(),bs("design:type",Function),bs("design:paramtypes",[ti]),bs("design:returntype",Array)],Ma,"getSelectedChapterTimelineMap",null),Ma=Pa=fs([Object(L.f)({name:"storyChapters",defaults:ms})],Ma)),ys=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},xs=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Os={storedCameras:{},cameraMotion:new Yn,panMode:"rotate",zoomed:!1,lockCamera:!1,cameraFlyTo:void 0,chapterCameraEnabled:!0},ws=((za=Ia=function(){function e(t,n){y(this,e),this.cameraService=t,this.store=n}return v(e,[{key:"storeCamera",value:function(e,t){var n=t.camera||this.cameraService.getCamera(),i=e.getState().storedCameras;i[t.id]=Object.assign({},n),e.patchState({storedCameras:Object.assign({},i)})}},{key:"clearCamera",value:function(e,t){var n=e.getState().storedCameras;delete n[t.id],e.patchState({storedCameras:Object.assign({},n)})}},{key:"setCameraFlyTo",value:function(e,t){e.patchState(immer.produce(e.getState(),(function(e){e.cameraFlyTo=t.camera})))}},{key:"applyCameraPatch",value:function(e,t){var n=immer.applyPatches(e.getState(),t.patches);e.patchState(n);var i=void 0===n.cameraFlyTo?this.store.selectSnapshot(vs.getChapterCamera):n.cameraFlyTo;e.dispatch(new zn(i,!0,1))}},{key:"moveCamera",value:function(e,t){e.patchState({cameraMotion:Object.assign({},t.cameraMotion)})}},{key:"resetCamera",value:function(e,t){return this.cameraService.resetCamera().pipe(Object(ei.a)((function(){e.patchState({cameraMotion:new Yn})})))}},{key:"zoomCamera",value:function(e,t){var n=e.getState().cameraMotion;n.zoom=t.value,e.patchState({cameraMotion:Object.assign({},n)})}},{key:"panCameraX",value:function(e,t){var n=e.getState().cameraMotion;n.panX=t.value,e.patchState({cameraMotion:Object.assign({},n)})}},{key:"panCameraY",value:function(e,t){var n=e.getState().cameraMotion;n.panY=t.value,e.patchState({cameraMotion:Object.assign({},n)})}},{key:"rotateCameraX",value:function(e,t){var n=e.getState().cameraMotion;e.patchState({cameraMotion:Object.assign(Object.assign({},n),{rotateX:t.value})})}},{key:"rotateCameraY",value:function(e,t){var n=e.getState().cameraMotion;n.rotateY=t.value,e.patchState({cameraMotion:Object.assign({},n)})}},{key:"SetCameraMode",value:function(e,t){e.patchState({panMode:t.mode})}},{key:"setZoomed",value:function(e,t){e.patchState({zoomed:t.zoomed})}},{key:"lockCamera",value:function(e,t){e.patchState({lockCamera:t.lock})}},{key:"setChapterCameraEnabled",value:function(e,t){this.cameraService.setChapterCameraEnabled(t.enabled),e.patchState({chapterCameraEnabled:t.enabled})}}],[{key:"getStoredCamera",value:function(e){return Object(L.h)([Ia],(function(t){return t.storedCameras[e]||null}))}},{key:"getCameraMotion",value:function(e){return e.cameraMotion}},{key:"getPanMode",value:function(e){return e.panMode}},{key:"getZoomed",value:function(e){return e.zoomed}},{key:"getLockCamera",value:function(e){return e.lockCamera}},{key:"getChapterCameraEnabled",value:function(e){return e.chapterCameraEnabled}}]),e}()).\u0275fac=function(e){return new(e||za)(j.Zb(Xn),j.Zb(L.g))},za.\u0275prov=j.Lb({token:za,factory:za.\u0275fac}),ys([Object(L.a)(In),xs("design:type",Function),xs("design:paramtypes",[Object,In]),xs("design:returntype",void 0)],za.prototype,"storeCamera",null),ys([Object(L.a)(Mn),xs("design:type",Function),xs("design:paramtypes",[Object,Mn]),xs("design:returntype",void 0)],za.prototype,"clearCamera",null),ys([Object(L.a)(Wn),xs("design:type",Function),xs("design:paramtypes",[Object,Wn]),xs("design:returntype",void 0)],za.prototype,"setCameraFlyTo",null),ys([Object(L.a)(Kn),xs("design:type",Function),xs("design:paramtypes",[Object,Kn]),xs("design:returntype",void 0)],za.prototype,"applyCameraPatch",null),ys([Object(L.a)(Dn),xs("design:type",Function),xs("design:paramtypes",[Object,Dn]),xs("design:returntype",void 0)],za.prototype,"moveCamera",null),ys([Object(L.a)(Ln),xs("design:type",Function),xs("design:paramtypes",[Object,Ln]),xs("design:returntype",void 0)],za.prototype,"resetCamera",null),ys([Object(L.a)(En),xs("design:type",Function),xs("design:paramtypes",[Object,En]),xs("design:returntype",void 0)],za.prototype,"zoomCamera",null),ys([Object(L.a)(An),xs("design:type",Function),xs("design:paramtypes",[Object,An]),xs("design:returntype",void 0)],za.prototype,"panCameraX",null),ys([Object(L.a)(Rn),xs("design:type",Function),xs("design:paramtypes",[Object,Rn]),xs("design:returntype",void 0)],za.prototype,"panCameraY",null),ys([Object(L.a)(Nn),xs("design:type",Function),xs("design:paramtypes",[Object,Nn]),xs("design:returntype",void 0)],za.prototype,"rotateCameraX",null),ys([Object(L.a)(Bn),xs("design:type",Function),xs("design:paramtypes",[Object,Bn]),xs("design:returntype",void 0)],za.prototype,"rotateCameraY",null),ys([Object(L.a)(Qn),xs("design:type",Function),xs("design:paramtypes",[Object,Qn]),xs("design:returntype",void 0)],za.prototype,"SetCameraMode",null),ys([Object(L.a)(qn),xs("design:type",Function),xs("design:paramtypes",[Object,qn]),xs("design:returntype",void 0)],za.prototype,"setZoomed",null),ys([Object(L.a)($n),xs("design:type",Function),xs("design:paramtypes",[Object,$n]),xs("design:returntype",void 0)],za.prototype,"lockCamera",null),ys([Object(L.a)(Un),xs("design:type",Function),xs("design:paramtypes",[Object,Un]),xs("design:returntype",void 0)],za.prototype,"setChapterCameraEnabled",null),ys([Object(L.e)(),xs("design:type",Function),xs("design:paramtypes",[Pn]),xs("design:returntype",void 0)],za,"getCameraMotion",null),ys([Object(L.e)(),xs("design:type",Function),xs("design:paramtypes",[Pn]),xs("design:returntype",void 0)],za,"getPanMode",null),ys([Object(L.e)(),xs("design:type",Function),xs("design:paramtypes",[Pn]),xs("design:returntype",void 0)],za,"getZoomed",null),ys([Object(L.e)(),xs("design:type",Function),xs("design:paramtypes",[Pn]),xs("design:returntype",void 0)],za,"getLockCamera",null),ys([Object(L.e)(),xs("design:type",Function),xs("design:paramtypes",[Pn]),xs("design:returntype",void 0)],za,"getChapterCameraEnabled",null),za=Ia=ys([Object(L.f)({name:"engineCamera",defaults:Os})],za)),ks=function(e){return e.Select="Select",e.Hide="Hide",e.Paint="Paint",e.Eyedropper="Eyedropper",e.Label="Label",e.Isolate="Isolate",e.Fade="Fade",e.Position="Position",e.Quiz="Quiz",e}({}),Cs=function(e){return e.Capture="capture",e.DoNotCaptureShowMessage="do_not_capture_show_message",e.DoNotCapture="do_not_capture",e}({}),Ss=r("nYR2"),_s=r("z6cu"),js=((Ta=function(){function e(t){y(this,e),this.http=t,this.nodeInfoCache=new Map}return v(e,[{key:"queryNodeInfo",value:function(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"en",o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if(T.offline)return Object(br.a)(void 0);var r="/search/descriptions?name=".concat(e,"&plan=").concat(t===ss.Wikipedia?"wiki":t,"&ol=").concat(i),a=r;if(o&&this.nodeInfoCache.has(a)){var s=this.nodeInfoCache.get(a);return Object(br.a)(s)}return this.http.get(r).pipe(Object(se.a)((function(t){return{label:e,latinLabel:t.latin_term,description:t.description,source:t.source,sourceLink:t.url}})),Object(xr.a)((function(e){return 404===e.status?Object(br.a)(void 0):Object(_s.a)(e)})),Object(ei.a)((function(e){return n.nodeInfoCache.set(a,e)})))}}]),e}()).\u0275fac=function(e){return new(e||Ta)(j.Zb(Q.b))},Ta.\u0275prov=j.Lb({token:Ta,factory:Ta.\u0275fac,providedIn:"root"}),Ta),Ps=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},Ms=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Is=new _n(0,0,0,0,jn.Hidden),zs=((Da=Ua=function(){function e(t,n,i,o,r){y(this,e),this.store=t,this.graphService=n,this.engineService=i,this.contentInfoService=o,this.animationService=r}return v(e,[{key:"load",value:function(e,t){e.dispatch(new gt("engine"))}},{key:"loadSuccess",value:function(e,t){(0,e.patchState)({engine:t.result})}},{key:"setReady",value:function(e,t){e.patchState({ready:t.ready})}},{key:"setDisplay",value:function(e,t){e.patchState({display:t.display})}},{key:"setZoomViaScrollAllowed",value:function(e,t){e.patchState({scrollMode:t.scrollMode})}},{key:"setVisible",value:function(e,t){e.patchState({visible:t.visible})}},{key:"setEnginePosition",value:function(e,t){e.patchState({enginePosition:Object.assign(Object.assign({},t.position),{right:t.position.left+t.position.width,bottom:t.position.top+t.position.height})})}},{key:"resetEnginePosition",value:function(e,t){e.patchState({enginePosition:Is})}},{key:"setChapter",value:function(e,t){e.patchState({chapter:t.chapterId})}},{key:"setChapterInit",value:function(e,t){e.patchState({chapterInit:t.chapterInit})}},{key:"setActiveTool",value:function(e,t){e.patchState({activeTool:t.tool})}},{key:"setGraph",value:function(e,t){e.patchState({viewGraph:Object.assign({},t.graph)})}},{key:"clearGraph",value:function(e,t){e.patchState({viewGraph:{nodes:{},successors:{},predecessors:{},roots:{}}})}},{key:"setXrayMode",value:function(e,t){e.patchState({xrayModeEnabled:t.enabled})}},{key:"centerCameraOnVisible",value:function(e,t){var n=this.engineService.getVisibleLeaves(),i=this.engineService.getBoundaryFromObjects(n),o=this.engineService.getCameraLookAt();o.look={x:(i.xmin+i.xmax)/2,y:(i.ymin+i.ymax)/2,z:(i.zmin+i.zmax)/2},Human.renderer.camera.fly.flyTo(o)}},{key:"toggleProgressBar",value:function(e,t){e.patchState({showProgressBar:t.show})}},{key:"toggleCameraBar",value:function(e,t){e.patchState({showCameraBar:t.show})}},{key:"toggleLabels",value:function(e,t){var n=null!=t.show?t.show:!e.getState().showLabels;e.patchState({showLabels:n})}},{key:"synchronizeVisibleNodes",value:function(e,t){var n=this,i=e.getState().viewGraph,o=this.stateMapToNodeIds(i,t.leafVisibilityState),r={};o.forEach((function(e){var i=n.engineService.getLeafObjects(e).reduce((function(e,n){return e||t.nodes[n].shown}),!1);r[e]={shown:i}})),this.graphService.synchronize(Object.assign({},i),{shown:"trueWins"},r),e.patchState({viewGraph:Object.assign({},i)})}},{key:"synchronizeRenderableNodes",value:function(e,t){var n=e.getState().viewGraph,i=this.stateMapToNodeIds(n,t.leafRenderableState),o={};i.forEach((function(e){o[e]={renderable:!0}})),this.graphService.synchronize(n,{renderable:"falseWins"},o)}},{key:"synchronizePickableNodes",value:function(e,t){var n=this,i=e.getState().viewGraph,o=this.stateMapToNodeIds(i,t.leafPickableState),r={};o.forEach((function(e){var t=n.engineService.getLeafObjects(e).reduce((function(e,t){return e||Human.scene.objects[t].pickable}),!1);r[e]={pickable:t}})),this.graphService.synchronize(i,{pickable:"trueWins"},r),e.patchState({viewGraph:Object.assign({},i)})}},{key:"playChapterAnimation",value:function(e,t){var n=this.store.selectSnapshot(vs.getSelectedChapter),i=Object(ie.get)(n,"ui.play.count",0);this.animationService.play({startChapterId:n.id,loop:-1===i,numChapters:1,queue:!1}),e.getState().animationPlaying||this.animationService.pause()}},{key:"toggleAnimation",value:function(e,t){var n=this.store.selectSnapshot(vs.getSelectedChapterId);t.play?this.animationService.unpause(n):this.animationService.pause()}},{key:"setAnimationPlaying",value:function(e,t){e.patchState({animationPlaying:t.playing})}},{key:"setPlaybackSpeed",value:function(e,t){e.patchState({playbackSpeed:t.speed})}},{key:"playAudio",value:function(e,t){e.patchState({playAudio:t.play})}},{key:"setAutoplay",value:function(e,t){e.patchState({autoplay:t.enable})}},{key:"setObjectLayerOrder",value:function(e,t){var n=this,i=e.getState().viewGraph,o=isNaN(t.layer)?0:t.layer,r=[];t.nodes.forEach((function(e){var t=n.graphService.getDescendants(i,e.id,!0);r=r.concat(t)})),r.forEach((function(e){n.engineService.setObjectLayer(e,o),n.graphService.setState(i,e,{layer:o})})),e.patchState({viewGraph:Object.assign({},i)})}},{key:"setObjectDisplayName",value:function(e,t){var n=Human.scene.objects[t.nodeId];n&&(n.displayName=t.displayName)}},{key:"autoSortObjectLayers",value:function(e,t){var n=this,i=e.getState().viewGraph,o=0,r=Human.scene.getEnabledLeaves(),a=this.engineService.getObjectLayerValues(r);Object.keys(a).map((function(e){return parseInt(e,10)})).sort((function(e,t){return e-t})).forEach((function(e){a[e].sort((function(e,t){return t.value-e.value})).forEach((function(e){var t=20*o;n.engineService.setObjectLayer(e.nodeId,t),n.graphService.setState(i,e.nodeId,{layer:t}),o++}))})),e.patchState({viewGraph:Object.assign({},i)})}},{key:"resetObjectLayers",value:function(e,t){var n=this,i=e.getState().viewGraph;Human.scene.getEnabledLeaves().forEach((function(e){n.engineService.setObjectLayer(e,0),n.graphService.setState(i,e,{layer:0})})),e.patchState({viewGraph:Object.assign({},i)})}},{key:"setPostProcessingEffects",value:function(e,t){var n=t.effects;this.engineService.setPostProcessingFeatures(n)}},{key:"setProperties",value:function(e,t){var n=t.properties;this.engineService.setProperties(Object.assign({},n))}},{key:"setTransparencyMode",value:function(e,t){var n=t.mode;this.engineService.setTransparencyMode(n)}},{key:"expandNode",value:function(e,t){var n=this.store.selectSnapshot(Ua.getViewGraph);Be.getAncestors(n,t.node.id,!0).forEach((function(e){n.nodes[e].boolState.expanded=!0})),this.store.dispatch(new Ot(n))}},{key:"collapseNode",value:function(e,t){var n=this.store.selectSnapshot(Ua.getViewGraph);n.nodes[t.node.id].boolState.expanded=!1,this.store.dispatch(new Ot(n))}},{key:"collapseAllViewTreeNodes",value:function(e,t){var n=this.store.selectSnapshot(Ua.getViewGraph);Object.values(n.nodes).forEach((function(e){e.boolState.expanded=!1})),this.store.dispatch(new Ot(n))}},{key:"hoverNode",value:function(e,t){e.patchState({hoveredNode:t.node})}},{key:"setLabelEditNode",value:function(e,t){e.patchState({labelEditNode:t.node})}},{key:"queryNodeInfo",value:function(e,t){var n=t.node,i=t.fallback,o=t.lang;e.patchState({queryingAnatomy:!0}),this.contentInfoService.queryNodeInfo(n.label,i,o).pipe(Object(Ss.a)((function(){return e.patchState({queryingAnatomy:!1})}))).subscribe((function(t){return e.dispatch(new sn(n,t))}),(function(){return e.dispatch(new cn(n))}))}},{key:"queryNodeInfoSuccess",value:function(e,t){var n=t.node,i=t.info;e.dispatch(new rn(n,i))}},{key:"setNodeInfo",value:function(e,t){var n=t.node,i=t.info,o=this.store.selectSnapshot(Ua.getViewGraph),r=o.nodes[n.id];r&&i&&(r.description=i.description,r.info=i,this.store.dispatch(new Ot(o)))}},{key:"setContextMenu",value:function(e,t){e.patchState({contextmenu:{node:t.node,hit:t.hit}})}},{key:"setWatermarkEnabled",value:function(e,t){var n=t.enabled;e.patchState({watermarkEnabled:n})}},{key:"stateMapToNodeIds",value:function(e,t){var n=this,i=Object.keys(t).map((function(t){return n.engineService.getNode(e,t)})).filter((function(e){return!!e})).map((function(e){return e.id}));return new Set(i)}}],[{key:"getEngine",value:function(e){return e.engine}},{key:"getReady",value:function(e){return e.ready}},{key:"getDisplay",value:function(e){return e.display}},{key:"getScrollMode",value:function(e){return e.scrollMode}},{key:"getVisible",value:function(e){return e.visible}},{key:"getViewGraph",value:function(e){return e.viewGraph}},{key:"getViewGraphNode",value:function(e){return function(t){return e.viewGraph.nodes[t]}}},{key:"getEnginePosition",value:function(e){return e.enginePosition}},{key:"getChapter",value:function(e){return e.chapter}},{key:"getActiveTool",value:function(e){return e.activeTool}},{key:"getShowCameraBar",value:function(e){return e.showCameraBar}},{key:"getShowProgressBar",value:function(e){return e.showProgressBar}},{key:"getShowLabels",value:function(e){return e.showLabels}},{key:"getChapterInit",value:function(e){return e.chapterInit}},{key:"getAnimationPlaying",value:function(e){return e.animationPlaying}},{key:"getPlayAudio",value:function(e){return e.playAudio}},{key:"getAutoplay",value:function(e){return e.autoplay}},{key:"getXrayModeEnabled",value:function(e){return e.xrayModeEnabled}},{key:"getHoveredNode",value:function(e){return e.hoveredNode}},{key:"getLabelEditNode",value:function(e){return e.labelEditNode}},{key:"getQuerying",value:function(e){return e.queryingAnatomy}},{key:"getContextmenu",value:function(e){return e.contextmenu}},{key:"getPlaybackSpeed",value:function(e){return e.playbackSpeed}},{key:"getWatermarkEnabled",value:function(e){return e.watermarkEnabled}}]),e}()).\u0275fac=function(e){return new(e||Da)(j.Zb(L.g),j.Zb(mn),j.Zb(Sn),j.Zb(js),j.Zb($r))},Da.\u0275prov=j.Lb({token:Da,factory:Da.\u0275fac}),Ps([Object(L.a)(dt),Ms("design:type",Function),Ms("design:paramtypes",[Object,dt]),Ms("design:returntype",void 0)],Da.prototype,"load",null),Ps([Object(L.a)(gt),Ms("design:type",Function),Ms("design:paramtypes",[Object,gt]),Ms("design:returntype",void 0)],Da.prototype,"loadSuccess",null),Ps([Object(L.a)(ht),Ms("design:type",Function),Ms("design:paramtypes",[Object,ht]),Ms("design:returntype",void 0)],Da.prototype,"setReady",null),Ps([Object(L.a)(ft),Ms("design:type",Function),Ms("design:paramtypes",[Object,ft]),Ms("design:returntype",void 0)],Da.prototype,"setDisplay",null),Ps([Object(L.a)(bt),Ms("design:type",Function),Ms("design:paramtypes",[Object,bt]),Ms("design:returntype",void 0)],Da.prototype,"setZoomViaScrollAllowed",null),Ps([Object(L.a)(vt),Ms("design:type",Function),Ms("design:paramtypes",[Object,vt]),Ms("design:returntype",void 0)],Da.prototype,"setVisible",null),Ps([Object(L.a)(Kt),Ms("design:type",Function),Ms("design:paramtypes",[Object,Kt]),Ms("design:returntype",void 0)],Da.prototype,"setEnginePosition",null),Ps([Object(L.a)(Gt),Ms("design:type",Function),Ms("design:paramtypes",[Object,Gt]),Ms("design:returntype",void 0)],Da.prototype,"resetEnginePosition",null),Ps([Object(L.a)(Ct),Ms("design:type",Function),Ms("design:paramtypes",[Object,Ct]),Ms("design:returntype",void 0)],Da.prototype,"setChapter",null),Ps([Object(L.a)(St),Ms("design:type",Function),Ms("design:paramtypes",[Object,St]),Ms("design:returntype",void 0)],Da.prototype,"setChapterInit",null),Ps([Object(L.a)(Et),Ms("design:type",Function),Ms("design:paramtypes",[Object,Et]),Ms("design:returntype",void 0)],Da.prototype,"setActiveTool",null),Ps([Object(L.a)(Ot),Ms("design:type",Function),Ms("design:paramtypes",[Object,Ot]),Ms("design:returntype",void 0)],Da.prototype,"setGraph",null),Ps([Object(L.a)(wt),Ms("design:type",Function),Ms("design:paramtypes",[Object,Ot]),Ms("design:returntype",void 0)],Da.prototype,"clearGraph",null),Ps([Object(L.a)(kt),Ms("design:type",Function),Ms("design:paramtypes",[Object,kt]),Ms("design:returntype",void 0)],Da.prototype,"setXrayMode",null),Ps([Object(L.a)(Mt),Ms("design:type",Function),Ms("design:paramtypes",[Object,Mt]),Ms("design:returntype",void 0)],Da.prototype,"centerCameraOnVisible",null),Ps([Object(L.a)(Dt),Ms("design:type",Function),Ms("design:paramtypes",[Object,Dt]),Ms("design:returntype",void 0)],Da.prototype,"toggleProgressBar",null),Ps([Object(L.a)(Ut),Ms("design:type",Function),Ms("design:paramtypes",[Object,Ut]),Ms("design:returntype",void 0)],Da.prototype,"toggleCameraBar",null),Ps([Object(L.a)(Lt),Ms("design:type",Function),Ms("design:paramtypes",[Object,Lt]),Ms("design:returntype",void 0)],Da.prototype,"toggleLabels",null),Ps([Object(L.a)(It),Ms("design:type",Function),Ms("design:paramtypes",[Object,It]),Ms("design:returntype",void 0)],Da.prototype,"synchronizeVisibleNodes",null),Ps([Object(L.a)(zt),Ms("design:type",Function),Ms("design:paramtypes",[Object,zt]),Ms("design:returntype",void 0)],Da.prototype,"synchronizeRenderableNodes",null),Ps([Object(L.a)(Tt),Ms("design:type",Function),Ms("design:paramtypes",[Object,Tt]),Ms("design:returntype",void 0)],Da.prototype,"synchronizePickableNodes",null),Ps([Object(L.a)(Ft),Ms("design:type",Function),Ms("design:paramtypes",[Object,Ft]),Ms("design:returntype",void 0)],Da.prototype,"playChapterAnimation",null),Ps([Object(L.a)(At),Ms("design:type",Function),Ms("design:paramtypes",[Object,At]),Ms("design:returntype",void 0)],Da.prototype,"toggleAnimation",null),Ps([Object(L.a)(Rt),Ms("design:type",Function),Ms("design:paramtypes",[Object,Rt]),Ms("design:returntype",void 0)],Da.prototype,"setAnimationPlaying",null),Ps([Object(L.a)(Vt),Ms("design:type",Function),Ms("design:paramtypes",[Object,Vt]),Ms("design:returntype",void 0)],Da.prototype,"setPlaybackSpeed",null),Ps([Object(L.a)(Nt),Ms("design:type",Function),Ms("design:paramtypes",[Object,Nt]),Ms("design:returntype",void 0)],Da.prototype,"playAudio",null),Ps([Object(L.a)(Ht),Ms("design:type",Function),Ms("design:paramtypes",[Object,Ht]),Ms("design:returntype",void 0)],Da.prototype,"setAutoplay",null),Ps([Object(L.a)(Qt),Ms("design:type",Function),Ms("design:paramtypes",[Object,Qt]),Ms("design:returntype",void 0)],Da.prototype,"setObjectLayerOrder",null),Ps([Object(L.a)(qt),Ms("design:type",Function),Ms("design:paramtypes",[Object,qt]),Ms("design:returntype",void 0)],Da.prototype,"setObjectDisplayName",null),Ps([Object(L.a)($t),Ms("design:type",Function),Ms("design:paramtypes",[Object,$t]),Ms("design:returntype",void 0)],Da.prototype,"autoSortObjectLayers",null),Ps([Object(L.a)(Wt),Ms("design:type",Function),Ms("design:paramtypes",[Object,Wt]),Ms("design:returntype",void 0)],Da.prototype,"resetObjectLayers",null),Ps([Object(L.a)(Zt),Ms("design:type",Function),Ms("design:paramtypes",[Object,Zt]),Ms("design:returntype",void 0)],Da.prototype,"setPostProcessingEffects",null),Ps([Object(L.a)(Jt),Ms("design:type",Function),Ms("design:paramtypes",[Object,Jt]),Ms("design:returntype",void 0)],Da.prototype,"setProperties",null),Ps([Object(L.a)(Xt),Ms("design:type",Function),Ms("design:paramtypes",[Object,Xt]),Ms("design:returntype",void 0)],Da.prototype,"setTransparencyMode",null),Ps([Object(L.a)(Yt),Ms("design:type",Function),Ms("design:paramtypes",[Object,Yt]),Ms("design:returntype",void 0)],Da.prototype,"expandNode",null),Ps([Object(L.a)(en),Ms("design:type",Function),Ms("design:paramtypes",[Object,en]),Ms("design:returntype",void 0)],Da.prototype,"collapseNode",null),Ps([Object(L.a)(tn),Ms("design:type",Function),Ms("design:paramtypes",[Object,tn]),Ms("design:returntype",void 0)],Da.prototype,"collapseAllViewTreeNodes",null),Ps([Object(L.a)(nn),Ms("design:type",Function),Ms("design:paramtypes",[Object,nn]),Ms("design:returntype",void 0)],Da.prototype,"hoverNode",null),Ps([Object(L.a)(on),Ms("design:type",Function),Ms("design:paramtypes",[Object,on]),Ms("design:returntype",void 0)],Da.prototype,"setLabelEditNode",null),Ps([Object(L.a)(an),Ms("design:type",Function),Ms("design:paramtypes",[Object,an]),Ms("design:returntype",void 0)],Da.prototype,"queryNodeInfo",null),Ps([Object(L.a)(sn),Ms("design:type",Function),Ms("design:paramtypes",[Object,sn]),Ms("design:returntype",void 0)],Da.prototype,"queryNodeInfoSuccess",null),Ps([Object(L.a)(rn),Ms("design:type",Function),Ms("design:paramtypes",[Object,rn]),Ms("design:returntype",void 0)],Da.prototype,"setNodeInfo",null),Ps([Object(L.a)(jt),Ms("design:type",Function),Ms("design:paramtypes",[Object,jt]),Ms("design:returntype",void 0)],Da.prototype,"setContextMenu",null),Ps([Object(L.a)(ln),Ms("design:type",Function),Ms("design:paramtypes",[Object,ln]),Ms("design:returntype",void 0)],Da.prototype,"setWatermarkEnabled",null),Ps([Object(L.e)(),Ms("design:type",Function),Ms("design:paramtypes",[ut]),Ms("design:returntype",void 0)],Da,"getEngine",null),Ps([Object(L.e)(),Ms("design:type",Function),Ms("design:paramtypes",[ut]),Ms("design:returntype",void 0)],Da,"getReady",null),Ps([Object(L.e)(),Ms("design:type",Function),Ms("design:paramtypes",[ut]),Ms("design:returntype",void 0)],Da,"getDisplay",null),Ps([Object(L.e)(),Ms("design:type",Function),Ms("design:paramtypes",[ut]),Ms("design:returntype",void 0)],Da,"getScrollMode",null),Ps([Object(L.e)(),Ms("design:type",Function),Ms("design:paramtypes",[ut]),Ms("design:returntype",void 0)],Da,"getVisible",null),Ps([Object(L.e)(),Ms("design:type",Function),Ms("design:paramtypes",[ut]),Ms("design:returntype",void 0)],Da,"getViewGraph",null),Ps([Object(L.e)(),Ms("design:type",Function),Ms("design:paramtypes",[ut]),Ms("design:returntype",void 0)],Da,"getViewGraphNode",null),Ps([Object(L.e)(),Ms("design:type",Function),Ms("design:paramtypes",[ut]),Ms("design:returntype",void 0)],Da,"getEnginePosition",null),Ps([Object(L.e)(),Ms("design:type",Function),Ms("design:paramtypes",[ut]),Ms("design:returntype",void 0)],Da,"getChapter",null),Ps([Object(L.e)(),Ms("design:type",Function),Ms("design:paramtypes",[ut]),Ms("design:returntype",void 0)],Da,"getActiveTool",null),Ps([Object(L.e)(),Ms("design:type",Function),Ms("design:paramtypes",[ut]),Ms("design:returntype",void 0)],Da,"getShowCameraBar",null),Ps([Object(L.e)(),Ms("design:type",Function),Ms("design:paramtypes",[ut]),Ms("design:returntype",void 0)],Da,"getShowProgressBar",null),Ps([Object(L.e)(),Ms("design:type",Function),Ms("design:paramtypes",[ut]),Ms("design:returntype",void 0)],Da,"getShowLabels",null),Ps([Object(L.e)(),Ms("design:type",Function),Ms("design:paramtypes",[ut]),Ms("design:returntype",void 0)],Da,"getChapterInit",null),Ps([Object(L.e)(),Ms("design:type",Function),Ms("design:paramtypes",[ut]),Ms("design:returntype",void 0)],Da,"getAnimationPlaying",null),Ps([Object(L.e)(),Ms("design:type",Function),Ms("design:paramtypes",[ut]),Ms("design:returntype",void 0)],Da,"getPlayAudio",null),Ps([Object(L.e)(),Ms("design:type",Function),Ms("design:paramtypes",[ut]),Ms("design:returntype",void 0)],Da,"getAutoplay",null),Ps([Object(L.e)(),Ms("design:type",Function),Ms("design:paramtypes",[ut]),Ms("design:returntype",void 0)],Da,"getXrayModeEnabled",null),Ps([Object(L.e)(),Ms("design:type",Function),Ms("design:paramtypes",[ut]),Ms("design:returntype",void 0)],Da,"getHoveredNode",null),Ps([Object(L.e)(),Ms("design:type",Function),Ms("design:paramtypes",[ut]),Ms("design:returntype",void 0)],Da,"getLabelEditNode",null),Ps([Object(L.e)(),Ms("design:type",Function),Ms("design:paramtypes",[ut]),Ms("design:returntype",void 0)],Da,"getQuerying",null),Ps([Object(L.e)(),Ms("design:type",Function),Ms("design:paramtypes",[ut]),Ms("design:returntype",void 0)],Da,"getContextmenu",null),Ps([Object(L.e)(),Ms("design:type",Function),Ms("design:paramtypes",[ut]),Ms("design:returntype",void 0)],Da,"getPlaybackSpeed",null),Ps([Object(L.e)(),Ms("design:type",Function),Ms("design:paramtypes",[ut]),Ms("design:returntype",void 0)],Da,"getWatermarkEnabled",null),Da=Ua=Ps([Object(L.f)({name:"engine",defaults:{loading:!1,ready:!1,viewGraph:{nodes:{},successors:{},predecessors:{},roots:{}},hoveredNode:void 0,labelEditNode:void 0,queryingAnatomy:!1,engine:"",chapter:"",chapterInit:{id:"",init:!1,camera:!1,annotations:!1,graph:!1,properties:!1,particles:!1,clips:!1,postprocessing:!1,transparency:!1},showProgressBar:!0,showCameraBar:!0,showLabels:!0,activeTool:ks.Select,animationPlaying:!0,autoplay:!0,playAudio:!1,display:!0,visible:!0,scrollMode:Cs.Capture,playbackSpeed:1,xrayModeEnabled:!1,contextmenu:{node:null,hit:null},watermarkEnabled:!1},children:[ws]})],Da)),Ts=function e(){y(this,e)},Us=function e(){y(this,e)},Ds=function e(){y(this,e)},Ls=r("cp0P"),Es=function e(){y(this,e)};function Fs(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return function(){return new Promise((function(t){e.apply(void 0,n.concat([function(){t()}]))}))}}var As,Rs,Vs=((As=function(){function e(){y(this,e)}return v(e,[{key:"getOnlyText",value:function(e){return e.map((function(e){switch(e.type){case Vo.Markdown:return e.markdown}})).join("")}}]),e}()).\u0275fac=function(e){return new(e||As)},As.\u0275prov=j.Lb({token:As,factory:As.\u0275fac,providedIn:"root"}),As),Ns=["reflections","lights"],Bs=["material","geometry","transform"],Hs=["tweens","morph"],Qs=((Rs=function(){function e(t,n,i,o){y(this,e),this.http=t,this.engineService=n,this.chapterService=i,this.contentBlocksService=o}return v(e,[{key:"getShownObjectsFromChapter",value:function(e){var t=[];return Object.entries(e.synchronization).forEach((function(e){var n=d(e,2),i=n[0];n[1].shown&&t.push(i)})),t}},{key:"getChapterLoadChunks",value:function(e,t,n){var i=this.getShownObjectsFromChapter(t),o=new Us;return o.activate=!1,o.chapterId=t.id,o.objects=i,o.storyId=e,o.assetTypes=[].concat(Bs,Hs,Ns),o.readyState={model:!0,animation:!0},[o]}},{key:"getOnDemandLoadChunks",value:function(e,t){var n=this,i=[];return Human.timeline.rootTimelines[e]._chapters.forEach((function(o){var r=n.getChapterLoadChunks(e,o,t);i=o.id===t.targetChapterId?[].concat(p(r),p(i)):[].concat(p(i),p(r))})),i}},{key:"getChapterIndex",value:function(e,t){return Human.timeline.rootTimelines[e]?Human.timeline.rootTimelines[e]._chapters.findIndex((function(e){return e.id===t})):-1}},{key:"getStory",value:function(e,t){var n,i=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"en",r=t===M.Bookmark?this.getBookmark(e):this.getContent(e);return"en"===o?r:r.pipe(Object(vr.a)((function(r){return n=r,i.getStoryTranslation(e,t,o)}))).pipe(Object(se.a)((function(e){return i.translateStory(n,e)})),Object(xr.a)((function(){return r})))}},{key:"getContentRoot",value:function(){return!0===T.offline?"undefined"==typeof localBaseDirectory?"":localBaseDirectory:"/"}},{key:"getContent",value:function(e){return this.http.get(this.getContentRoot()+"content/modules/".concat(e,".json")).pipe(Object(se.a)((function(e){return e})))}},{key:"getBookmark",value:function(e){return this.http.get("/search/bookmarks/data",{params:{be:e}}).pipe(Object(se.a)((function(e){return e.bookmark})))}},{key:"getLoadConfig",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=new Ds;return n.chapterAssetBundle=!0,n.targetChapterId=Human.timeline.rootTimelines[e]._chapters[t].id,n.targetChapterConfig={global:{clipping:!0,graph:!0,camera:!0,properties:!0,transparencyMode:!0,postprocess:!0},static:{labels:!0},dynamic:{timeline:!0,particles:!0}},n.sortBy="chapter",n}},{key:"buildStory",value:function(e,t,n){Human.events.fire("modules.fetch.start",e),Human.modules.moduleData[e]=t;var i=Object.assign({},t);return i.moduleId=e,new J.a((function(t){Human.modules.create(e,i,(function(){Human.modules.load(e,Object.values(Human.scene.rootObjects),[].concat(Ns),(function(){Human.modules.activate(e,0,{},(function(){t.next(!0),t.complete()}))}))}))}))}},{key:"getStoryChapters",value:function(e,t){var n=this,i=Human.modules.moduleData[e];return Human.timeline.rootTimelines[e]._chapters.map((function(e,o){return n.chapterService.fromHumanChapter(i,t,e,o)}))}},{key:"getStoryLoadChunks",value:function(e,t){return this.getOnDemandLoadChunks(e,t).map((function(e){return Object.assign(Object.assign({},e),{chunkId:qi.idWithPrefix("chunk")})}))}},{key:"loadStoryChunk",value:function(e,t){var n=e.objects.map((function(e){return Human.scene.objects[e]}));e.storyId?Human.modules.load(e.storyId,n,e.assetTypes,(function(){t()})):this.engineService.loadGraphObject(e.objects[0]).subscribe((function(){t()}))}},{key:"unloadStory",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=(e?[e]:Object.keys(Human.modules.modules)).map((function(e){return t.hardDeleteStory(e,n)}));return new J.a((function(e){i.length?Object(Ls.a)(i).subscribe((function(){e.next(!0),e.complete()})):(e.next(!0),e.complete())}))}},{key:"createLoadObjectChunk",value:function(e){var t=new Us;return t.assetTypes=[].concat(Bs,Hs),t.objects=[e],t}},{key:"hardDeleteStory",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=(e in Human.modules.modules?Human.modules.modules[e].sceneGraph:[]).map((function(e){return Human.scene.objects[e.objectId]})).filter((function(e){return!!e})),i=Object(ie.flatten)(n.map((function(e){return e.getLeafObjects()}))),o=Fs(Human.modules.deactivate,e,{}),r=Fs(Human.modules.unload,e,i,["geometries","morphs","reflections","tweens","lights","materials","transforms"]),a=Fs(Human.modules.destroy,e);return new J.a((function(n){(Human.timeline.activeRoot&&Human.timeline.activeRoot.id===e?o():Promise.resolve({})).then((function(){return t?r():Promise.resolve({})})).then((function(){return a()})).then((function(){return n.next(),void n.complete()}))}))}},{key:"getStoryTranslation",value:function(e,t,n){return this.http.get(t===M.Bookmark?"/search/bookmarks/tr/".concat(n,"/").concat(e):"/tr/".concat(n,"/").concat(e,".json")).pipe(Object(se.a)((function(e){return Object(ce.plainToClass)(Es,e)})))}},{key:"getStoryType",value:function(e){return e.indexOf("/")>=0?M.Module:M.Bookmark}},{key:"translateStory",value:function(e,t){var n=this,i=e.chapters||[],o=e.sceneGraph||[],r=t.objects||{},a=t.chapters||[];return e.displayName=t.displayName||e.displayName,e.description=t.description||e.description,o.forEach((function(e){(e.objects||[]).forEach((function(e){n.translateObject(e,r)}))})),i.forEach((function(e,t){var i=a[t];if(i){n.translateMetaInfo(e,i);var o=i.annotations||[];(e.annotations||[]).forEach((function(e,t){var i=o[t];i&&n.translateMetaInfo(e,i)}));var r=i.hotspots||[];(e.hotspots||[]).forEach((function(e,t){var i=r[t];i&&n.translateMetaInfo(e,i)}));var s=i.quizQuestions||[];(e.quizQuestions||[]).forEach((function(e,t){var i=s[t];i&&n.translateQuizQuestion(e,i)}))}})),e}},{key:"translateQuizQuestion",value:function(e,t){var n=this;if(t.nextLabel&&(e.nextLabel=t.nextLabel),["questionPrompt","explanation"].forEach((function(n){var i=t[n]||[];(e[n]||[]).forEach((function(e,t){var n=i[t];n&&(e.markdown=n.markdown)}))})),e.data&&t.data){var i=t.data.options||[];(e.data.options||[]).forEach((function(t,o){var r=i[o];r&&(e.type===No.LabelAnatomy?n.translateMetaInfo(t.label,r.label):t.label=r.label)}))}}},{key:"translateMetaInfo",value:function(e,t){var n=t.title,i=t.description;e.hasOwnProperty("displayName")&&(e.displayName=n),e.hasOwnProperty("title")&&(e.title=n),e.hasOwnProperty("description")&&(e.description=i)}},{key:"translateObject",value:function(e,t){var n=this,i=t[e.objectId];i&&(e.displayName=i);var o=e.objects;o&&o.forEach((function(e){n.translateObject(e,t)}))}},{key:"exportWrittenContent",value:function(e,t,n){var i=[];return i.push("\n".concat(e.displayName,"\n    ")),t.forEach((function(e,t){i.push("\n---\n\n# Chapter ".concat(t+1,": ").concat(e.info.displayName||"-No Title-","\n\n").concat(e.info.description||"-No Description-","\n      ")),e.legend.length&&(i.push("\n## Legend\n"),e.legend.forEach((function(e){i.push("\n* ".concat(e.label," (").concat(bn.rgbToHex(e.colors,!0),")\n"))})));var o=n.filter((function(t){return t.chapterId===e.id}));o.length&&(i.push("\n## Labels\n"),o.forEach((function(e){i.push("\n* ".concat(e.title,"\n")),e.description&&i.push("\n  > ".concat(e.description,"\n"))})))})),i.join("")}},{key:"exportQuizKey",value:function(e){var t=this,n=[];return e.forEach((function(e,i){switch(n.push("\n# QUESTION ".concat(i+1," (").concat(Bo[e.type],")\n\n## PROMPT\n").concat(t.contentBlocksService.getOnlyText(e.questionPrompt),"\n      ")),e.type){case No.MultipleChoice:e.data.options.forEach((function(t,i){n.push("\n## ANSWER ".concat(i+1," ").concat(e.data.correctAnswer===t.value?"- CORRECT":"","\n").concat(t.label,"\n            "))}));break;case No.SelectAnatomy:n.push("\n## ANSWERS\n          "),e.data.correctAnswer.forEach((function(e,t){n.push("\n".concat(e,"\n            "))}));break;case No.LabelAnatomy:e.data.options.forEach((function(e,t){n.push("\n## ANSWER ".concat(t+1,"\n").concat(e.label.title,"\n            "))}))}t.contentBlocksService.getOnlyText(e.explanation).length&&n.push("\n  \n## EXPLANATION\n".concat(t.contentBlocksService.getOnlyText(e.explanation),"\n        ")),n.push("\n\n\n      ")})),n.join("")}}]),e}()).\u0275fac=function(e){return new(e||Rs)(j.Zb(Q.b),j.Zb(Sn),j.Zb(Wr),j.Zb(Vs))},Rs.\u0275prov=j.Lb({token:Rs,factory:Rs.\u0275fac,providedIn:"root"}),Rs);function qs(e,t,n){var i=function(e,t){var n,i={},o=l(e);try{for(o.s();!(n=o.n()).done;)for(var r=n.value,a=Object.keys(t[r]),s=0,c=a;s<c.length;s++){i[c[s]]=!1}}catch(p){o.e(p)}finally{o.f()}return i}(t,n);return e.map((function(e){return Object.assign(Object.assign({},e),{showObjects:Object.assign(Object.assign({},e.showObjects),i),selectObjects:Object.assign(Object.assign({},e.selectObjects),i),pickThroughObjects:Object.assign(Object.assign({},e.pickThroughObjects),i)})}))}function $s(e){return e.split("/").length>1?M.Module:M.Bookmark}function Ws(e,t){return e.map((function(e){if(!Object(ie.isEmpty)(e.lights))return e;var n={libraries:p(t),lights:[]};return Object.assign(Object.assign({},e),{lights:n})}))}function Ks(e){return e.customData&&e.customData.particleSystems?e.customData.particleSystems.reduce((function(e,t){return e[wo.getParticleIdRoot(t.id)]=t.id,e}),{}):{}}function Gs(e,t){return e.customData&&e.customData.particleSystems?e.customData.particleSystems.map((function(e){var n=wo.getParticleIdRoot(e.id);return Object.assign(Object.assign({},e),{id:t[n]})})):[]}function Zs(e,t){return e.map((function(e){return e.customData&&e.customData.particleSystems&&(e.customData.particleSystems=e.customData.particleSystems.map((function(e){return t[wo.getParticleIdRoot(e)]}))),e}))}function Js(e,t){return e.map((function(e){return e.id})).reduce((function(n,i){return e.some((function(e){return e.id===i&&Object(ie.get)(e,"customData.particleSystems",[]).length>0}))&&(n[i]=t),n}),{})}var Xs,Ys,ec,tc=r("eIep");function nc(e){return function(e){return new J.a((function(t){var n=new Image;n.onload=function(){var e=function(e){var t=document.createElement("canvas"),n=t.getContext("2d");return t.width=e.naturalWidth,t.height=e.naturalHeight,n.drawImage(e,0,0),t}(n);t.next(e),t.complete()},n.onerror=function(){var e=document.createElement("canvas");t.next(e),t.complete()},n.src=e}))}(e).pipe(Object(Y.a)((function(e){return!Object(ie.isNil)(e)})),Object(tc.a)((function(e){return new J.a((function(t){e.toBlob((function(e){t.next(e),t.complete()}),"image/jpeg",100)}))})))}!function(e){function t(e,t){var n=new gr;if(e.thumbnails)n.legacy=!1,n.storyId=t,n.chapterId=e.id,n.urls=Object.assign({},e.thumbnails);else{var i="/thumbs/".concat(M.Bookmark===$s(t)?"bookmarks":"modules","/").concat(t.replace(".json",""));n.legacy=!0,n.storyId=t,n.chapterId=e.id,n.urls={small:"".concat(i,"/small/chapters/").concat(e.id,".jpg"),large:"".concat(i,"/large/chapters/").concat(e.id,".jpg")}}return n}e.generateLegacyThumbnail=function(e,t){var n="/thumbs/".concat(M.Bookmark===$s(e)?"bookmarks":"modules","/").concat(e.replace(".json",""));return{small:"".concat(n,"/small/chapters/").concat(t,".jpg"),large:"".concat(n,"/large/chapters/").concat(t,".jpg")}},e.generateThumbnails=function(e){return e.reduce((function(e,t){var n=t.originalChapterId,i=t.newChapterId,o=t.originalStoryId,r=M.Bookmark===$s(o),a=new gr;a.storyId=o,a.chapterId=n;var s="/thumbs/".concat(r?"bookmarks":"modules","/").concat(o.replace(".json",""));return a.urls={small:"".concat(s,"/small/chapters/").concat(n,".jpg"),large:"".concat(s,"/large/chapters/").concat(n,".jpg")},e.set(i,a),e}),new Map)},e.getChapterThumbnail=t,e.getChapterThumbnails=function(e,n){return n.reduce((function(n,i){var o=t(i,e);return n.set(i.id,o),n}),new Map)},e.makeFreshThumbnail=function(e,t,n){return nc(n).pipe(Object(Y.a)((function(e){return!Object(ie.isNil)(e)})),Object(se.a)((function(n){var i=new gr;return i.snapshot=URL.createObjectURL(n),i.chapterId=t,i.storyId=e,i})))}}(Xs||(Xs={}));var ic=function e(){y(this,e)},oc=function e(){y(this,e)},rc=function e(){y(this,e)};function ac(e,t){return{showObjects:Object(ie.mapKeys)(e.showObjects,(function(e,n){return ec.renamespaceValue(n,t)})),selectObjects:Object(ie.mapKeys)(e.selectObjects,(function(e,n){return ec.renamespaceValue(n,t)})),pickThroughObjects:Object(ie.mapKeys)(e.pickThroughObjects,(function(e,n){return ec.renamespaceValue(n,t)})),synchronization:Object(ie.mapKeys)(e.synchronization,(function(e,n){return ec.renamespaceValue(n,t)}))}}function sc(e,t){return(e||[]).map((function(e){return Object.assign(Object.assign({},e),{objectId:ec.renamespaceValue(e.objectId,t),states:e.states.map((function(e){return Object.assign(Object.assign({},e),{errands:(n=e.errands,n.map((function(e){return e.type===oo.flyToChapter||e.type===oo.flyToObject?Object.assign(Object.assign({},e),{value:ec.renamespaceValue(e.value,t)}):e})))});var n}))})}))}function cc(e,t){return(e||[]).map((function(e){return e.data.timeline=t[e.data.timeline]||e.data.timeline,e}))}function lc(e,t){return(e||[]).map((function(e){return e.objectId&&(e.objectId=ec.renamespaceValue(e.objectId,t)),e}))}function pc(e,t){return e?{xray:Object(ie.mapKeys)(e.xray,(function(e,n){return ec.renamespaceValue(n,t)})),highlight:Object(ie.mapKeys)(e.highlight,(function(e,n){return ec.renamespaceValue(n,t)}))}:{}}function uc(e,t){var n=Object.assign({},e);return Array.isArray(e.layers)&&(n.layers=e.layers.map((function(e){return Object.assign(Object.assign({},e),{objectIds:e.objectIds.map((function(e){return ec.renamespaceValue(e,t)}))})}))),n}function dc(e,t){function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.map((function(e){return Object.assign(Object.assign({},e),{src:ec.renamespaceValue(e.src,t)})}))}var i=[];return e&&Array.isArray(e.particleSystems)&&(i=e.particleSystems.map((function(e){return Object.assign(Object.assign({},e),{textures:n(e.textures)})}))),i}function gc(e,t){var n=function(e,t){return"string"==typeof e?[t[e]||e]:e.map((function(e){return t[e]||e}))}(e.stateId,t),i=e.assetLibraries.tweens.map((function(e){return ec.renamespaceValue(e,t)})),o=e.assetLibraries.reflections.map((function(e){return ec.renamespaceValue(e,t)})),r=Object(ie.mapValues)(e.reflections,(function(e,n){return ec.renamespaceValue(e,t)})),a=function(e,t){return e.map((function(e){return Object.assign(Object.assign(Object.assign({},e),ac(e,t)),{colorRecipeObjects:pc(e.colorRecipeObjects,t),timelineMap:cc(e.timelineMap,t),labels:sc(e.labels,t),hotspots:lc(e.hotspots,t),visibilityLayers:uc(e.visibilityLayers,t)})}))}(e.chapters,t),s=function e(t,n){var i,o=l(t);try{var r=function(){var t=i.value;["objectId","displayName","geometryId","morphId","materialId","transformId"].forEach((function(e){t[e]&&(t[e]=ec.renamespaceValue(t[e],n))})),e(t.objects||[],n)};for(o.s();!(i=o.n()).done;)r()}catch(a){o.e(a)}finally{o.f()}return t}(e.sceneGraph,t),c=Object.assign(Object.assign({},e.customData),{particleSystems:dc(e.customData,t)});return Object.assign(Object.assign(Object.assign(Object.assign({},e),{stateId:n}),ac(e,t)),{assetLibraries:Object.assign(Object.assign({},e.assetLibraries),{tweens:i,reflections:o}),reflections:r,chapters:a,sceneGraph:s,customData:c})}!function(e){function t(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;["x","y","z"].forEach((function(n){void 0!==e[n]&&Math.abs(e[n]-t)<1e-4&&delete e[n]}))}function n(e){["translate","rotate","pivot"].forEach((function(n){void 0!==e[n]&&(t(e[n]),0===Object.keys(e[n]).length&&delete e[n])})),void 0!==e.scale&&(t(e.scale,1),0===Object.keys(e.scale).length&&delete e.scale)}function i(e,t){["backfaces","displayName","layer"].forEach((function(n){e[n]&&(t[n]=e[n])}))}function o(e,t){var i=new oc;i.translate=JSON.parse(JSON.stringify(e.translate)),i.rotate=JSON.parse(JSON.stringify(e.rotate)),i.scale=JSON.parse(JSON.stringify(e.scale)),i.pivot=JSON.parse(JSON.stringify(e.pivot)),n(i),Object.entries(i).forEach((function(e){var n=d(e,2),i=n[0],o=n[1];t[i]=JSON.parse(JSON.stringify(o))})),t.transformId&&delete t.transformId}function r(e,t){var n=["geometryId","morphId","materialId"],i=[];return e.renderables&&e.renderables.forEach((function(e){var t=new ic;n.forEach((function(n){e[n]&&(t[n]=e[n])})),e.layer&&(t.layer=e.layer),i.push(t)})),1===i.length?t=Object.assign(Object.assign({},t),i[0]):i.length>1&&(t.renderables=i),t}e.filterTransformProperties=n,e.serializeObjectProperties=i,e.serializeTransformData=o,e.serializeRenderables=r,e.serializeHumanObject=function e(t,n){if(n[t.objectId])return null;var a=new rc;return a.objectId=t.objectId,i(t,a),t.transformId?a.transformId=t.transformId:o(t,a),a=r(t,a),t.objects&&t.objects.length&&(a.objects=[]),t.objects.forEach((function(t){var i=e(t,n);null!==i&&a.objects.push(i)}),this),a}}(Ys||(Ys={})),function(e){function t(e,t){var n=Object.entries(t);return n.sort((function(e,t){return e[0].length===t[0].length?0:e[0].length<t[0].length?1:-1})),n.reduce((function(e,t){var n=d(t,2),i=n[0],o=n[1];if(e.startsWith(i)){var r=new RegExp("^"+i);e=e.replace(r,o)}return e}),e||"")}e.renamespaceValue=t,e.renamespaceKeys=function(e,n){return Object.entries(e).reduce((function(e,i){var o=d(i,2),r=o[0],a=o[1];return e[t(r,n)]=a,e}),{})},e.renamespaceAssetLibrary=function(e,n,i){if(!i)return e;var o=e.tweens.map((function(e){return t(e,n)})),r=e.reflections.map((function(e){return t(e,n)}));return Object.assign(Object.assign({},e),{tweens:o,reflections:r})},e.renamespaceReflections=function(e,n,i){return i?Object(ie.mapValues)(e,(function(e){return t(e,n)})):e}}(ec||(ec={}));var hc,fc,bc,mc,vc,yc=function e(){y(this,e)},xc=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},Oc=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},wc={enableContextLabel:{enable:!0,enableInfo:!0,enableActions:!0},loading:!1,labelsCollapsed:!1,labelsCollapsedMode:Kr.None,labelScale:null,labels:[],contextLabel:null,selectedLabel:null,draggable:{pin:!0,tag:!0}},kc=((bc=hc=function(){function e(t,n){y(this,e),this.store=t,this.labelsService=n}return v(e,[{key:"PatchLabels",value:function(e,t){var n=immer.applyPatches(e.getState(),t.patches);e.patchState(n)}},{key:"setLabelOffset",value:function(e,t){var n=d(immer.produceWithPatches(e.getState(),(function(e){var n=e.labels.find((function(e){return e.id===t.labelId}));n&&(n.offset=t.offset)})),3),i=n[0],o=n[1],r=n[2];e.patchState(i),this.savePatches(o,r)}},{key:"setLabels",value:function(e,t){e.patchState(immer.produce(e.getState(),(function(e){e.labels=t.labels})))}},{key:"setLabel",value:function(e,t){var n=d(immer.produceWithPatches(e.getState(),(function(e){e.labels=e.labels.map((function(e){return e.id===t.label.id?t.label:e}))})),3),i=n[0],o=n[1],r=n[2];e.patchState(i),t.record&&this.savePatches(o,r)}},{key:"setLabelStates",value:function(e,t){var n=d(immer.produceWithPatches(e.getState(),(function(e){e.labels.find((function(e){return e.id===t.id})).states=t.states})),3),i=n[0],o=n[1],r=n[2];e.patchState(i),this.savePatches(o,r)}},{key:"setLabelScale",value:function(e,t){e.patchState({labelScale:t.scale})}},{key:"addLabel",value:function(e,t){var n=d(immer.produceWithPatches(e.getState(),(function(e){var n=t.label.id||qi.idWithPrefix("label"),i=Object.assign(Object.assign({},t.label),{id:n});e.labels.push(i)})),3),i=n[0],o=n[1],r=n[2];e.patchState(i),this.savePatches(o,r)}},{key:"addContextLabel",value:function(e,t){var n=immer.produce(e.getState(),(function(e){e.contextLabel=Object.assign(Object.assign({},t.label),{id:"context-label"})}));e.patchState(n)}},{key:"copyLabels",value:function(e,t){var n=e.getState().labels,i=n.filter((function(e){return e.chapterId===t.sourceChapter.id})).map((function(e){return Object.assign(Object.assign({},Object(ie.cloneDeep)(e)),{id:qi.idWithPrefix("label"),chapterId:t.targetChapter.id})}));e.patchState({labels:[].concat(p(n),p(i))})}},{key:"removeLabel",value:function(e,t){var n=d(immer.produceWithPatches(e.getState(),(function(e){e.labels=e.labels.filter((function(e){return e.id!==t.label.id}))})),3),i=n[0],o=n[1],r=n[2];e.patchState(i),Human.scene.markers.delete(t.label.id),this.savePatches(o,r)}},{key:"removeContextLabel",value:function(e,t){var n=immer.produce(e.getState(),(function(e){e.contextLabel=void 0}));Human.scene.markers.delete("context-label"),e.patchState(n)}},{key:"removeAllChapterLabels",value:function(e,t){var n=immer.produceWithPatches(e.getState(),(function(e){var n=d(Object(ie.partition)(e.labels,(function(e){return e.chapterId!==t.chapter.id})),2),i=n[0];n[1].forEach((function(e){return Human.scene.markers.delete(e.id)})),e.labels=i})),i=d(n,3),o=i[0],r=i[1],a=i[2];e.patchState(o),this.savePatches(r,a)}},{key:"selectLabel",value:function(e,t){e.patchState({selectedLabel:t.label?t.label.id:null})}},{key:"resetLabels",value:function(e,t){var n=e.getState();Human.scene.markers.delete("context-label"),n.labels.forEach((function(e){Human.scene.markers.delete(e.id)})),e.setState(immer.produce(e.getState(),(function(e){})))}},{key:"convertLabels",value:function(e,t){var n=d(immer.produceWithPatches(e.getState(),(function(e){t.labels.forEach((function(n){var i=e.labels.findIndex((function(e){return e.id===n.id}));e.labels[i]=Object.assign(Object.assign({},e.labels[i]),t.fields)}))})),3),i=n[0],o=n[1],r=n[2];e.setState(Object.assign({},i)),this.savePatches(o,r)}},{key:"enableContextLabel",value:function(e,t){e.patchState({enableContextLabel:Object.assign({},t)})}},{key:"setLabelsShown",value:function(e,t){var n=t.labels,i=t.shown,o=e.getState().labels.map((function(e){var t=n.some((function(t){return t.id===e.id}));return Object.assign(Object.assign({},e),{shown:t?i:e.shown})}));e.patchState({labels:p(o)})}},{key:"setAllLabelsShown",value:function(e,t){var n=t.show,i=e.getState().labels;e.dispatch(new ua(i,n))}},{key:"setLabelsCollapsed",value:function(e,t){var n=t.collapsed,i=t.collapsedMode;e.patchState({labelsCollapsed:n,labelsCollapsedMode:i})}},{key:"setLabelsDraggable",value:function(e,t){e.patchState({draggable:Object.assign({},t.draggable)})}},{key:"savePatches",value:function(e,t){this.store.dispatch(new eo.SavePatches([{forward:e,inverse:t,patchAction:Gr}]))}}],[{key:"getLabels",value:function(e){return e.labels}},{key:"getLabelsCollapsed",value:function(e){return e.labelsCollapsed}},{key:"getLabelsCollapsedMode",value:function(e){return e.labelsCollapsedMode}},{key:"getSelectedLabelId",value:function(e){return e.selectedLabel}},{key:"getSelectedLabel",value:function(e){return e.labels.find((function(t){return t.id===e.selectedLabel}))||null}},{key:"getContextLabel",value:function(e){return e.contextLabel}},{key:"getChapterLabels",value:function(e,t){return e.labels.filter((function(e){return e.chapterId===t.selectedChapter}))}},{key:"getChapterSequentialLabels",value:function(e){return Object(L.h)([hc,vs],(function(t,n){return t.labels.filter((function(t){return t.chapterId===n.selectedChapter&&t.pinType===Ai.Sequential&&t.sequentialType===e}))}))}},{key:"getLabelSequence",value:function(e){return Object(L.h)([hc,hc.getChapterSequentialLabels(Vi.Alphabetical),hc.getChapterSequentialLabels(Vi.Numerical)],(function(t,n,i){if(e.pinType!==Ai.Sequential)return null;switch(e.sequentialType){case Vi.Alphabetical:var o=n.findIndex((function(t){return t.id===e.id}));return"ABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(o);case Vi.Numerical:return i.findIndex((function(t){return t.id===e.id}))+1}}))}},{key:"getEnableContextLabel",value:function(e){return e.enableContextLabel.enable}},{key:"getEnableContextLabelInfo",value:function(e){return e.enableContextLabel.enableInfo}},{key:"getEnableContextLabelActions",value:function(e){return e.enableContextLabel.enableActions}},{key:"getLabelsDraggable",value:function(e){return e.draggable}},{key:"getLabelScale",value:function(e){return e.labelScale}}]),e}()).\u0275fac=function(e){return new(e||bc)(j.Zb(L.g),j.Zb(po))},bc.\u0275prov=j.Lb({token:bc,factory:bc.\u0275fac}),xc([Object(L.a)(Gr),Oc("design:type",Function),Oc("design:paramtypes",[Object,Gr]),Oc("design:returntype",void 0)],bc.prototype,"PatchLabels",null),xc([Object(L.a)(Zr),Oc("design:type",Function),Oc("design:paramtypes",[Object,Zr]),Oc("design:returntype",void 0)],bc.prototype,"setLabelOffset",null),xc([Object(L.a)(Jr),Oc("design:type",Function),Oc("design:paramtypes",[Object,Jr]),Oc("design:returntype",void 0)],bc.prototype,"setLabels",null),xc([Object(L.a)(oa),Oc("design:type",Function),Oc("design:paramtypes",[Object,oa]),Oc("design:returntype",void 0)],bc.prototype,"setLabel",null),xc([Object(L.a)(ra),Oc("design:type",Function),Oc("design:paramtypes",[Object,ra]),Oc("design:returntype",void 0)],bc.prototype,"setLabelStates",null),xc([Object(L.a)(aa),Oc("design:type",Function),Oc("design:paramtypes",[Object,aa]),Oc("design:returntype",void 0)],bc.prototype,"setLabelScale",null),xc([Object(L.a)(Xr),Oc("design:type",Function),Oc("design:paramtypes",[Object,Xr]),Oc("design:returntype",void 0)],bc.prototype,"addLabel",null),xc([Object(L.a)(Yr),Oc("design:type",Function),Oc("design:paramtypes",[Object,Yr]),Oc("design:returntype",void 0)],bc.prototype,"addContextLabel",null),xc([Object(L.a)(ea),Oc("design:type",Function),Oc("design:paramtypes",[Object,ea]),Oc("design:returntype",void 0)],bc.prototype,"copyLabels",null),xc([Object(L.a)(ta),Oc("design:type",Function),Oc("design:paramtypes",[Object,ta]),Oc("design:returntype",void 0)],bc.prototype,"removeLabel",null),xc([Object(L.a)(na),Oc("design:type",Function),Oc("design:paramtypes",[Object,na]),Oc("design:returntype",void 0)],bc.prototype,"removeContextLabel",null),xc([Object(L.a)(ia),Oc("design:type",Function),Oc("design:paramtypes",[Object,ia]),Oc("design:returntype",void 0)],bc.prototype,"removeAllChapterLabels",null),xc([Object(L.a)(sa),Oc("design:type",Function),Oc("design:paramtypes",[Object,sa]),Oc("design:returntype",void 0)],bc.prototype,"selectLabel",null),xc([Object(L.a)(ca),Oc("design:type",Function),Oc("design:paramtypes",[Object,ca]),Oc("design:returntype",void 0)],bc.prototype,"resetLabels",null),xc([Object(L.a)(la),Oc("design:type",Function),Oc("design:paramtypes",[Object,la]),Oc("design:returntype",void 0)],bc.prototype,"convertLabels",null),xc([Object(L.a)(pa),Oc("design:type",Function),Oc("design:paramtypes",[Object,pa]),Oc("design:returntype",void 0)],bc.prototype,"enableContextLabel",null),xc([Object(L.a)(ua),Oc("design:type",Function),Oc("design:paramtypes",[Object,ua]),Oc("design:returntype",void 0)],bc.prototype,"setLabelsShown",null),xc([Object(L.a)(da),Oc("design:type",Function),Oc("design:paramtypes",[Object,da]),Oc("design:returntype",void 0)],bc.prototype,"setAllLabelsShown",null),xc([Object(L.a)(ga),Oc("design:type",Function),Oc("design:paramtypes",[Object,ga]),Oc("design:returntype",void 0)],bc.prototype,"setLabelsCollapsed",null),xc([Object(L.a)(ha),Oc("design:type",Function),Oc("design:paramtypes",[Object,ha]),Oc("design:returntype",void 0)],bc.prototype,"setLabelsDraggable",null),xc([Object(L.e)(),Oc("design:type",Function),Oc("design:paramtypes",[yc]),Oc("design:returntype",void 0)],bc,"getLabels",null),xc([Object(L.e)(),Oc("design:type",Function),Oc("design:paramtypes",[yc]),Oc("design:returntype",void 0)],bc,"getLabelsCollapsed",null),xc([Object(L.e)(),Oc("design:type",Function),Oc("design:paramtypes",[yc]),Oc("design:returntype",void 0)],bc,"getLabelsCollapsedMode",null),xc([Object(L.e)(),Oc("design:type",Function),Oc("design:paramtypes",[yc]),Oc("design:returntype",void 0)],bc,"getSelectedLabelId",null),xc([Object(L.e)(),Oc("design:type",Function),Oc("design:paramtypes",[yc]),Oc("design:returntype",void 0)],bc,"getSelectedLabel",null),xc([Object(L.e)(),Oc("design:type",Function),Oc("design:paramtypes",[yc]),Oc("design:returntype",void 0)],bc,"getContextLabel",null),xc([Object(L.e)([vs]),Oc("design:type",Function),Oc("design:paramtypes",[yc,ti]),Oc("design:returntype",void 0)],bc,"getChapterLabels",null),xc([Object(L.e)(),Oc("design:type",Function),Oc("design:paramtypes",[yc]),Oc("design:returntype",void 0)],bc,"getEnableContextLabel",null),xc([Object(L.e)(),Oc("design:type",Function),Oc("design:paramtypes",[yc]),Oc("design:returntype",void 0)],bc,"getEnableContextLabelInfo",null),xc([Object(L.e)(),Oc("design:type",Function),Oc("design:paramtypes",[yc]),Oc("design:returntype",void 0)],bc,"getEnableContextLabelActions",null),xc([Object(L.e)(),Oc("design:type",Function),Oc("design:paramtypes",[yc]),Oc("design:returntype",void 0)],bc,"getLabelsDraggable",null),xc([Object(L.e)(),Oc("design:type",Function),Oc("design:paramtypes",[yc]),Oc("design:returntype",void 0)],bc,"getLabelScale",null),bc=hc=xc([Object(L.f)({name:"labels",defaults:wc})],bc)),Cc=((fc=function(){function e(t,n,i,o,r){y(this,e),this.store=t,this.engineService=n,this.chapterSerializer=i,this.animationService=o,this.chapterService=r}return v(e,[{key:"serializeUI",value:function(e){var t=Object.assign({},e.ui);return e.chapters.length>1&&(t.scrubber=!1,t.playPause=!1,t.tour={chapters:!0}),t}},{key:"serializeAnimation",value:function(e){return this.animationService.isChapterAnimated(e)?{startTime:e.timelineMap[0].start,loop:!1!==e.loop,numChapters:1}:{}}},{key:"getClippedObjects",value:function(){return 0===Human.renderer.clip.getActiveClips().length?{}:Human.scene.getLeaves().reduce((function(e,t){return Human.scene.objects[t].culledByClip&&(e[t]=!0),e}),{})}},{key:"generateTrimObjectMap",value:function(e){var t={};if(e.graph.hidden){var n=this.store.selectSnapshot(jo.getAllNodeState);Object.values(n).forEach((function(e){Object.entries(e).forEach((function(e){var n=d(e,2),i=n[0],o=n[1];!1!==t[i]&&(t[i]=!(o.shown||o.shownSetByTween))}))}))}var i=e.graph.clipped?this.getClippedObjects():{};return Object.assign(Object.assign({},t),i)}},{key:"serialize",value:function(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3?arguments[3]:void 0,r=arguments.length>4?arguments[4]:void 0,a=arguments.length>5?arguments[5]:void 0,s=Object(ie.cloneDeep)(o),c=this.generateTrimObjectMap(t);s.sceneGraph=function(e,t){var n=[];return Object.entries(e).forEach((function(e){var i=d(e,2),o=(i[0],i[1]),r=Ys.serializeHumanObject(o,t);null!==r&&n.push(r)}),this),n}(Human.scene.rootObjects,c);var l=Be.createGraphFromSrc(s.sceneGraph,"objectId","objects",new un(Human.scene.colorRecipes.getRecipes())),p=this.store.selectSnapshot(kc.getLabels);this.store.selectSnapshot(Lr.getRegisteredThumbnails),s.chapters=r.map((function(t){return n.chapterSerializer.serializeChapter(l,t,e,p,a)})),s.ui=this.serializeUI(s),s.animation=this.serializeAnimation(r[0]),s.customData=Object.assign(Object.assign({},s.customData),{particleSystems:this.store.selectSnapshot(Ro.getParticleSystemsList)});var u=this.store.selectSnapshot(rr.getAllQuestions),g=this.store.selectSnapshot(rr.getQuizSettings);g&&u.length>0?s.quizSettings=g:delete s.quizSettings,s.tweenParticleLookup=this.store.selectSnapshot(Ro.getTweenParticleLookup);var h=r.reduce((function(e,t){return e.concat(n.chapterService.getChapterLightLibraries(t))}),[]);s.assetLibraries.lights=Array.from(new Set(h));var f=this.getReflectionLibraries(s.reflections),b=r.reduce((function(e,t){return e.concat(n.chapterService.getChapterReflectionLibraries(t))}),[]);s.assetLibraries.reflections=Array.from(new Set(f.concat(b)));var m=[].concat.apply([],Object.values(s.assetLibraries)),v=this.getSceneGraphStateIds(s.sceneGraph);return s.stateId=Array.from(new Set(m.map(this.getStateId).concat(v))),{story:i?gc(s,e):s}}},{key:"getReflectionLibraries",value:function(e){return e=e||{},Object.values(e).map((function(e){var t=e.split(".");return[t[0],t[1]].join("/")}))}},{key:"getSceneGraphStateIds",value:function(e){return e.map((function(e){return e.objectId.split("-")[0]}))}},{key:"getStateId",value:function(e){return e.split("/")[0]}}]),e}()).\u0275fac=function(e){return new(e||fc)(j.Zb(L.g),j.Zb(Sn),j.Zb(Fr),j.Zb($r),j.Zb(Wr))},fc.\u0275prov=j.Lb({token:fc,factory:fc.\u0275fac,providedIn:"root"}),fc),Sc=function e(){y(this,e),this.graph={hidden:!1,clipped:!1,disabled:!1,transparent:!1}},_c=r("3E0/"),jc=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},Pc=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Mc={loading:!1,incoming:{id:void 0,type:void 0},storyId:void 0,storyType:void 0,loadingChunk:null,loadChunks:[],loadChunksRemaining:[],thumbnailLookup:[]},Ic=((vc=mc=function(){function e(t,n,i,o,r){y(this,e),this.store=t,this.storyService=n,this.engineService=i,this.serializeModuleService=o,this.storageService=r,this.reload=T.native}return v(e,[{key:"setStoryText",value:function(e,t){var n=e.getState().story;n&&e.patchState({story:Object.assign(Object.assign({},n),{displayName:t.displayName})})}},{key:"setStoryTags",value:function(e,t){var n=t.tags,i=e.getState().story;i&&e.patchState({story:Object.assign(Object.assign({},i),{tags:n})})}},{key:"setStoryLightLibs",value:function(e,t){var n=e.getState().story;n&&e.patchState({story:Object.assign(Object.assign({},n),{assetLibraries:Object.assign(Object.assign({},n.assetLibraries),{lights:t.lightLibs})})})}},{key:"setStory",value:function(e,t){e.patchState({story:t.story})}},{key:"SetStoryId",value:function(e,t){e.patchState({storyId:t.id})}},{key:"setIncomingStory",value:function(e,t){var n=e.getState(),i=t.id,o=t.type,r=t.reset;i!==n.storyId||r?e.patchState({incoming:{id:i,type:o}}):r&&e.dispatch(new tt(t.id,n.story,t.type))}},{key:"loadStory",value:function(e,t){var n=this;(t.preview?Object(kr.a)(this.storageService.getDatabaseItem(os.PreviewStory)):this.storyService.getStory(t.id,t.type,t.lang)).subscribe((function(n){e.dispatch(new nt(n,t.id,t.type))}),(function(){!0===n.reload?(n.reload=!1,n.loadStory(e,t)):e.dispatch(new it(t.id,t.type))}))}},{key:"loadStorySuccess",value:function(e,t){this.storyService.unloadStory(null).pipe(Object(_c.a)(0)).subscribe((function(){e.dispatch(new tt(t.id,t.story,t.type))}))}},{key:"buildStoryWorkflow",value:function(e,t,n,i){var o=this,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:new Map;this.storyService.buildStory(t,n,!0).subscribe((function(s){var c=o.storyService.getStoryChapters(t,i),l=[];c.forEach((function(e){l=[].concat(p(l),p(e.labels))}));var u=o.storyService.getLoadConfig(t,r),d=o.storyService.getStoryLoadChunks(t,u);e.patchState({storyId:t,story:n,loadChunks:d,loadChunksRemaining:d,incoming:{id:void 0,type:void 0}});var g=o.engineService.getSceneGraph(Human.scene.rootObjects),h=c.reduce((function(e,t){return e[t.id]=function(e,t,n,i){return Object.keys(e.nodes).reduce((function(o,r){return o[r]=function(o){var r=Uo(e,o,t)||To(e,o,t),a=function e(t,n,i){switch(i[n]){case!0:return!1;case!1:return!0;case void 0:var o=Be.getAncestor(t,n);return!o||e(t,o,i)}}(e,o,n);return{objectId:o,checked:!1,selected:!1,paint:function e(t,n,i){if(i&&i[n]&&("tintColor"in(o=i[n])||"opacity"in o||"brightness"in o||"saturation"in o||"contrast"in o))return ko.fromEngine(new zo(i[n]));var o,r=Be.getAncestor(t,n);return r?e(t,r,i):Po}(e,o,i),pickable:a,shown:r,shownSetByTween:!1}}(r),o}),{})}(g,t.showObjects,t.pickThroughObjects,t.synchronization),e}),{});e.dispatch(new Yi.InitNodeState(h)),e.dispatch(new Yi.SetActiveChapter(c[r].id)),e.dispatch(new li(c)),e.dispatch(new lr(a)),e.dispatch(new Jr(l)),e.dispatch(new si(c[r]));var f=Object(ie.get)(n,"tweenParticleLookup",{}),b=Object(ie.get)(n,"customData.particleSystems",[]),m=c.reduce((function(e,t){return e[t.id]=Object(ie.get)(t,"customData.particleSystems",[]),e}),{});e.dispatch(new xo.SetParticleState(b,m,f)),e.dispatch(new Eo.ResetQuizState),n.quizSettings&&e.dispatch(new Eo.SetQuizSettings(n.quizSettings));var v=Ho(c);e.dispatch(new Eo.SetQuestions(v)),e.dispatch(new lt),e.dispatch(new Xe)}))}},{key:"importStorySuccess",value:function(e,t){var n=this,i=e.getState(),o=i.storyType,r=i.storyId,a=new Sc,s=this.store.selectSnapshot(mc.getStory),c=this.store.selectSnapshot(vs.getStoryChapters),u=Mr.makeChapterIdMap(c,!1),g=this.serializeModuleService.serialize({},a,!1,s,c,u).story,h=function(e,t,n,i){var o,r,a,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:M.Bookmark,c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:qi.idWithPrefix,u=function(e,t){var n=function(e){return void 0!==e.objectId},i=d(Object(ie.partition)(e,n),2),o=i[0],r=i[1],a=d(Object(ie.partition)(t,n),2),s=a[0],c=function(e,t){return t.reduce((function(t,n){var i,o=l(e);try{for(o.s();!(i=o.n()).done;){var r=i.value;Object(ie.isEqual)(r,n)||t.push(n)}}catch(a){o.e(a)}finally{o.f()}return t}),e)}(r,a[1]),u=function(e,t){var n=e.reduce((function(e,t){return e[t.objectId]=t,e}),{}),i=t.reduce((function(e,t){if(void 0===e.nodes[t.objectId])return e.nodes[t.objectId]=t,e;if(!Object(ie.isEqual)(t,e.nodes[t.objectId])){var n=function(e,t){var n={},i={};return{root:function e(t,o){if(t.objectId!==o.objectId)return n[o.objectId]=!0,[t,o];if(void 0===t.objects&&o.objects){var r,a=l(o.objects);try{for(a.s();!(r=a.n()).done;){var s=r.value;n[s.objectId]=!0}}catch(x){a.e(x)}finally{a.f()}return[Object.assign({},o)]}if(t.objects&&void 0===o.objects){var c,p=l(t.objects);try{for(p.s();!(c=p.n()).done;){var u=c.value;i[u.objectId]=!0}}catch(x){p.e(x)}finally{p.f()}return[Object.assign({},t)]}if(void 0===t.objects&&void 0===o.objects)return[Object.assign({},t)];var d,g=[],h=l(t.objects);try{var f=function(){var t=d.value,n=o.objects.find((function(e){return e.objectId===t.objectId}));n?g.push(e(t,n)):(i[t.objectId]=!0,g.push(t))};for(h.s();!(d=h.n()).done;)f()}catch(x){h.e(x)}finally{h.f()}var b,m=l(o.objects);try{var v=function(){var e=b.value;t.objects.find((function(t){return t.objectId===e.objectId}))||(n[e.objectId]=!0,g.push(e))};for(m.s();!(b=m.n()).done;)v()}catch(x){m.e(x)}finally{m.f()}var y=Object.assign({},t);return y.objects=Object(ie.flatten)(g),[y]}(e,t),objectIdsUniqueToNew:n,objectIdsUniqueToOriginal:i}}(e.nodes[t.objectId],t);e.nodes[t.objectId]=n.root[0],e.graphsMerged.push(t.objectId),e.objectIdsUniqueToNew[t.objectId]=n.objectIdsUniqueToNew,e.objectIdsUniqueToOriginal[t.objectId]=n.objectIdsUniqueToOriginal}return e}),{nodes:n,graphsMerged:[],objectIdsUniqueToNew:{},objectIdsUniqueToOriginal:{}});return{newSceneGraph:Object.keys(i.nodes).reduce((function(e,t){return e.push(i.nodes[t]),e}),[]),graphsMerged:i.graphsMerged,objectIdsUniqueToNew:i.objectIdsUniqueToNew,objectIdsUniqueToOriginal:i.objectIdsUniqueToOriginal}}(o,s),g=u.newSceneGraph,h=u.graphsMerged,f=u.objectIdsUniqueToNew,b=u.objectIdsUniqueToOriginal;return{sceneGraph:[].concat(p(c),p(g)),graphsMerged:h,objectIdsUniqueToNew:f,objectIdsUniqueToOriginal:b}}(e.sceneGraph,n.sceneGraph),g=u.sceneGraph,h=u.graphsMerged,f=u.objectIdsUniqueToNew,b=u.objectIdsUniqueToOriginal,m=(o=e.assetLibraries,r=n.assetLibraries,{lights:(a=function(e,t){return Object(ie.uniq)([].concat(p(e),p(t)))})(o.lights,r.lights),tweens:a(o.tweens,r.tweens),reflections:a(o.reflections,r.reflections)}),v=function(e,t,n,i){e=e||{},t=t||{};var o=function(e,t){return t.includes("/")?t:"".concat(function(e){return $s(e)===M.Bookmark?e:e.split("/").pop()}(e),"/").concat(t)};return Object.assign(Object.assign({},Object(ie.mapKeys)(e,(function(e,t){return o(n,t)}))),Object(ie.mapKeys)(t,(function(e,t){return o(i,t)})))}(e.reflections,n.reflections,t,i),y=function(e,t,n){e=e||{},t=t||{};var i=Object.keys(t).reduce((function(e,i){var o=n("color-recipe-"+i);return e.newColorRecipeIds[i]=o,e.colorRecipes[o]=t[i],e}),{colorRecipes:{},newColorRecipeIds:{}});return{colorRecipes:Object.assign(Object.assign({},e),i.colorRecipes),newColorRecipeIds:i.newColorRecipeIds}}(e.colorRecipes,n.colorRecipes,c),x=y.colorRecipes,O=y.newColorRecipeIds,w=Ws(e.chapters,e.assetLibraries.lights),k=Ws(n.chapters,n.assetLibraries.lights),C=function(e,t,n,i,o){var r=Ks(e),a=Object.values(r),s=Ks(t);for(var c in s)if(s.hasOwnProperty(c)&&a.includes(s[c])){var l=wo.generateParticleId(c,o);s[c]=l}var u=[].concat(p(Gs(e,r)),p(Gs(t,s))),d=Zs(n,r),g=Zs(i,s),h=Object.assign(Object.assign({},Js(d,r)),Js(g,s));return{mergedParticles:u,currentChapters:d,importedChapters:g,tweenParticleLookup:Object(ie.pickBy)(h,(function(e,t){return!Object(ie.isEmpty)(e)}))}}(e,n,qs(w,h,f),qs(k,h,b).map((function(e){return Object.assign(Object.assign({},e),{id:c("chapter")})})),c),S=function(e,t){return e.map((function(e){if(Object(ie.isEmpty)(e.colorRecipeObjects))return e;var n=Object.keys(e.colorRecipeObjects).reduce((function(n,i){return n[t[i]]=e.colorRecipeObjects[i],n}),{});return e.colorRecipeObjects=n,e}))}(C.importedChapters,O),_=[].concat(p(C.currentChapters),p(S)),j=Object.assign(Object.assign({},e.customData),{particleSystems:C.mergedParticles}),P="module"===s?e.tags:[];return Object.assign(Object.assign({},e),{assetLibraries:m,chapters:_,sceneGraph:g,customData:j,tags:P,reflections:v,colorRecipes:x,stateId:Object(ie.uniq)([].concat(p(e.stateId),p(n.stateId))),tweenParticleLookup:C.tweenParticleLookup})}(g,r,t.story,t.id,T.exportType),f=h.chapters.slice(g.chapters.length).reduce((function(e,n,i){return e[t.story.chapters[i].id]=n.id,e}),{}),b=t.story.chapters.reduce((function(e,n){var i=n.thumbnails?n.thumbnails.large:Xs.generateLegacyThumbnail(t.id,n.id).large,o=Xs.makeFreshThumbnail(r,f[n.id],i);return e.push(o),e}),[]);Object(Ls.a)(b).subscribe((function(t){var i=n.store.selectSnapshot(Lr.getRegisteredThumbnails);t.forEach((function(e){i.set(e.chapterId,e)})),n.storyService.unloadStory(null,!0).subscribe((function(){n.buildStoryWorkflow(e,r,h,o,h.chapters.length-1,i)}))}))}},{key:"buildStory",value:function(e,t){t.story.chapters.map((function(e,n){return{newChapterId:e.id,originalChapterId:e.id,originalStoryId:t.id}}));var n=Xs.getChapterThumbnails(t.id,t.story.chapters);this.buildStoryWorkflow(e,t.id,t.story,t.type,t.chapterIdx||0,n)}},{key:"loadStoryChunk",value:function(e){var t=e.getState().loadChunksRemaining[0];t&&(e.patchState({loadingChunk:t}),this.storyService.loadStoryChunk(t,(function(){e.dispatch([new et(t),new Xe])})))}},{key:"reorderLoadChunks",value:function(e,t){var n=e.getState().loadChunksRemaining,i=d(Object(ie.partition)(n,(function(e){return e.chapterId===t.chapterId})),2),o=i[0],r=i[1];e.patchState({loadChunksRemaining:[].concat(p(o),p(r))})}},{key:"loadStoryChunkSuccess",value:function(e,t){var n=e.getState().loadChunksRemaining.filter((function(e){return e.chunkId!==t.chunk.chunkId}));e.patchState({loadingChunk:null,loadChunksRemaining:n}),e.dispatch(new bi(t.chunk.chapterId,t.chunk.readyState))}},{key:"synchronizeChapters",value:function(e){var t=this.store.selectSnapshot(vs.getStoryChapters),n=e.getState().story;e.patchState({story:Object.assign(Object.assign({},n),{chapters:p(t)})})}},{key:"importStory",value:function(e,t){this.storyService.getStory(t.id,t.type,t.lang).subscribe((function(n){e.dispatch(new rt(n,t.id,t.type))}))}},{key:"resetStory",value:function(e){e.setState(Mc)}},{key:"mergeBridgeModuleSuccess",value:function(e,t){var n=this,i=t.story,o=e.getState(),r=this.store.selectSnapshot(vs.getSelectedChapterIndex),a=Xs.getChapterThumbnails(o.storyId,i.chapters);this.storyService.unloadStory(null,!0).subscribe((function(){n.buildStoryWorkflow(e,o.storyId,i,M.Module,r,a)}))}}],[{key:"getStory",value:function(e){return e.story}},{key:"getStoryId",value:function(e){return e.storyId}},{key:"getLoadingChunk",value:function(e){return e.loadingChunk}},{key:"getLoadChunks",value:function(e){return e.loadChunks}},{key:"getLoadChunksRemaining",value:function(e){return e.loadChunksRemaining}},{key:"getStoryInfo",value:function(e){return{id:e.storyId,type:e.storyType}}},{key:"getIncomingStoryInfo",value:function(e){return e.incoming}},{key:"getStoryTags",value:function(e){return Object(ie.get)(e,"story.tags",[])}}]),e}()).\u0275fac=function(e){return new(e||vc)(j.Zb(L.g),j.Zb(Qs),j.Zb(Sn),j.Zb(Cc),j.Zb(as))},vc.\u0275prov=j.Lb({token:vc,factory:vc.\u0275fac}),jc([Object(L.a)(Ke),Pc("design:type",Function),Pc("design:paramtypes",[Object,Ke]),Pc("design:returntype",void 0)],vc.prototype,"setStoryText",null),jc([Object(L.a)(Ge),Pc("design:type",Function),Pc("design:paramtypes",[Object,Ge]),Pc("design:returntype",void 0)],vc.prototype,"setStoryTags",null),jc([Object(L.a)(Ze),Pc("design:type",Function),Pc("design:paramtypes",[Object,Ze]),Pc("design:returntype",void 0)],vc.prototype,"setStoryLightLibs",null),jc([Object(L.a)($e),Pc("design:type",Function),Pc("design:paramtypes",[Object,$e]),Pc("design:returntype",void 0)],vc.prototype,"setStory",null),jc([Object(L.a)(We),Pc("design:type",Function),Pc("design:paramtypes",[Object,We]),Pc("design:returntype",void 0)],vc.prototype,"SetStoryId",null),jc([Object(L.a)(Je),Pc("design:type",Function),Pc("design:paramtypes",[Object,Je]),Pc("design:returntype",void 0)],vc.prototype,"setIncomingStory",null),jc([Object(L.a)(qe),Pc("design:type",Function),Pc("design:paramtypes",[Object,qe]),Pc("design:returntype",void 0)],vc.prototype,"loadStory",null),jc([Object(L.a)(nt),Pc("design:type",Function),Pc("design:paramtypes",[Object,nt]),Pc("design:returntype",void 0)],vc.prototype,"loadStorySuccess",null),jc([Object(L.a)(rt),Pc("design:type",Function),Pc("design:paramtypes",[Object,rt]),Pc("design:returntype",void 0)],vc.prototype,"importStorySuccess",null),jc([Object(L.a)(tt),Pc("design:type",Function),Pc("design:paramtypes",[Object,tt]),Pc("design:returntype",void 0)],vc.prototype,"buildStory",null),jc([Object(L.a)(Xe),Pc("design:type",Function),Pc("design:paramtypes",[Object]),Pc("design:returntype",void 0)],vc.prototype,"loadStoryChunk",null),jc([Object(L.a)(Ye),Pc("design:type",Function),Pc("design:paramtypes",[Object,Ye]),Pc("design:returntype",void 0)],vc.prototype,"reorderLoadChunks",null),jc([Object(L.a)(et),Pc("design:type",Function),Pc("design:paramtypes",[Object,et]),Pc("design:returntype",void 0)],vc.prototype,"loadStoryChunkSuccess",null),jc([Object(L.a)(st),Pc("design:type",Function),Pc("design:paramtypes",[Object]),Pc("design:returntype",void 0)],vc.prototype,"synchronizeChapters",null),jc([Object(L.a)(ot),Pc("design:type",Function),Pc("design:paramtypes",[Object,ot]),Pc("design:returntype",void 0)],vc.prototype,"importStory",null),jc([Object(L.a)(at),Pc("design:type",Function),Pc("design:paramtypes",[Object]),Pc("design:returntype",void 0)],vc.prototype,"resetStory",null),jc([Object(L.a)(pt),Pc("design:type",Function),Pc("design:paramtypes",[Object,Object]),Pc("design:returntype",void 0)],vc.prototype,"mergeBridgeModuleSuccess",null),jc([Object(L.e)(),Pc("design:type",Function),Pc("design:paramtypes",[Ts]),Pc("design:returntype",void 0)],vc,"getStory",null),jc([Object(L.e)(),Pc("design:type",Function),Pc("design:paramtypes",[Ts]),Pc("design:returntype",void 0)],vc,"getStoryId",null),jc([Object(L.e)(),Pc("design:type",Function),Pc("design:paramtypes",[Ts]),Pc("design:returntype",void 0)],vc,"getLoadingChunk",null),jc([Object(L.e)(),Pc("design:type",Function),Pc("design:paramtypes",[Ts]),Pc("design:returntype",void 0)],vc,"getLoadChunks",null),jc([Object(L.e)(),Pc("design:type",Function),Pc("design:paramtypes",[Ts]),Pc("design:returntype",void 0)],vc,"getLoadChunksRemaining",null),jc([Object(L.e)(),Pc("design:type",Function),Pc("design:paramtypes",[Ts]),Pc("design:returntype",void 0)],vc,"getStoryInfo",null),jc([Object(L.e)(),Pc("design:type",Function),Pc("design:paramtypes",[Ts]),Pc("design:returntype",void 0)],vc,"getIncomingStoryInfo",null),jc([Object(L.e)(),Pc("design:type",Function),Pc("design:paramtypes",[Ts]),Pc("design:returntype",void 0)],vc,"getStoryTags",null),vc=mc=jc([Object(L.f)({name:"story",defaults:Mc})],vc)),zc=r("itXk"),Tc=r("IzEk"),Uc=function(e){return e[e.Content=0]="Content",e[e.Label=1]="Label",e[e.Tools=2]="Tools",e[e.Search=3]="Search",e[e.Help=4]="Help",e[e.NodeInfo=5]="NodeInfo",e[e.LabelInfo=6]="LabelInfo",e}({}),Dc=["ui-bd.class","ui-play-pause","ui-camera-mode","ui-center","ui-cross-section","ui-dissect","ui-fs","ui-tools-display","ui-tree","ui-zoom","ui-zoom-in","ui-zoom-out","ui-pan","ui-share","ui-keys","ui-slider","o","background.color-stops","background.gradient-type","dd","dn","image-display","imageDisplay","imageSrc","pre","referrer"];function Lc(e){var t=e.id,n=e.s,i=e.m,o=e.be,r=e.b,a="";if(t)a=t;else if(o)a=o;else if(r){var s=parseInt(r,10);a=Number.isNaN(s)?"":function(e){for(var t,n,i=[],o=e;o>0;){var r;n=o,o=(r=d([Math.floor(n/62),n%62],2))[0],t=r[1],i.unshift("0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz"[t])}return i.join("")}(s)}else i&&(a=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"male";return e.includes("/")?e:"production/".concat(t,"Adult/").concat(e)}(i,"female"===n?"female":"male"));return a.replace(/\.json$/,"")}function Ec(e){return Lc(e).includes("/")?"module":"bookmark"}var Fc={type:function(e){return Ec(e)},id:function(e){return Lc(e)},background:function(e){return e.bgstd||e["background.colors"]||e.background}};function Ac(e){return 3===e.length?{x:e[0],y:e[1],z:e[2]}:null}var Rc={camera:function(e){var t=e.split(",").map((function(e){return parseFloat(e)}));if(t.length%3==0&&!t.some((function(e){return Number.isNaN(e)}))){var n=t.slice(0,3),i=t.slice(3,6),o=t.slice(6,9);return{eye:Ac(n),look:Ac(i),up:Ac(o)}}return null},background:function(e){var t=bn.getColors(e);if(t){var n=[].concat(p(t[0][255]),p(t[1][255]));return new Ki(n,"radial",[0,100])}return null}};function Vc(e){var t,n=function(e){var t=Object.keys(e),n=t.filter((function(e){return Dc.includes(e)}));if(n.length>0){var i=['The following URL parameters have been deprecated: "'.concat(n.join('", "'),'"'),"Please contact support@biodigital.com for more information."];console.warn(i.join("\n"))}return t.reduce((function(e,t){return Dc.includes(t)&&delete e[t],e}),e)}(e);return function(e){var t=function(e){if(e){var t=e.toLowerCase();if("true"===t)return!0;if("false"===t)return!1;if(!isNaN(Number(t)))return Number(t)}return e};return Object.keys(e).reduce((function(n,i){var o=(Rc[i]||t)(e[i]);return"load-rotate"===i&&isNaN(Number(o))||(n[i]=o),n}),{})}((t=n,Object.keys(Fc).filter((function(e){return void 0===t[e]})).reduce((function(e,n){var i=(0,Fc[n])(t);return void 0!==i&&(e[n]=i),e}),t)))}var Nc,Bc,Hc=((Nc=function(){function e(t){y(this,e),this.store=t}return v(e,[{key:"chapterHasTransition",value:function(e,t){var n=t?"transitions.pre":"transitions.post",i=Object(ie.get)(e,n);return!!i&&(t?i.onPrevious:i.onNext)}},{key:"searchChapterTransitions",value:function(e,t,n){var i=this,o=p(n),r=o.findIndex((function(t){return t.id===e})),a=o.findIndex((function(e){return e.id===t})),s=a<r;if(s&&(r=(o=o.reverse()).findIndex((function(t){return t.id===e})),a=o.findIndex((function(e){return e.id===t}))),r<0||a<0||r===a)return null;var c=o.slice(r,a).find((function(e){return i.chapterHasTransition(e,s)}));return c?s?c.transitions.pre:c.transitions.post:null}}]),e}()).\u0275fac=function(e){return new(e||Nc)(j.Zb(L.g))},Nc.\u0275prov=j.Lb({token:Nc,factory:Nc.\u0275fac,providedIn:"root"}),Nc),Qc=function(e){return e.JumpTo="jumpTo",e.FlyTo="flyTo",e}({});!function(e){var t=function e(t){y(this,e),this.breakpoint=t};t.type="[View] Set Breakpoint",e.SetBreakpoint=t}(Bc||(Bc={}));var qc,$c,Wc,Kc,Gc=function(e){return e[e.XSmall=0]="XSmall",e[e.Small=1]="Small",e[e.Medium=2]="Medium",e[e.Large=3]="Large",e[e.XLarge=4]="XLarge",e}({}),Zc=r("/uUt"),Jc=r("0MNC"),Xc=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},Yc=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},el=function e(){y(this,e)},tl=((qc=function(){function e(t,n){y(this,e),this.breakpointObserver=t,this.store=n}return v(e,[{key:"setBreakpoint",value:function(e,t){e.patchState({breakpoint:t.breakpoint})}},{key:"ngxsOnInit",value:function(e){var t=this.breakpointObserver.observe(["(max-width: 374px)"]),n=this.breakpointObserver.observe(["(max-width: 599px)"]),i=this.breakpointObserver.observe(["(max-width: 959px)"]),o=this.breakpointObserver.observe(["(max-width: 1439px)"]),r=this.breakpointObserver.observe(["(min-width: 1440px)"]);Object(zc.b)(t,n,i,o,r).pipe(Object(se.a)((function(e){var t=d(e,5),n=t[0],i=t[1],o=t[2],r=t[3],a=t[4];return n.matches?Gc.XSmall:i.matches?Gc.Small:o.matches?Gc.Medium:r.matches?Gc.Large:a.matches?Gc.XLarge:null})),Object(Zc.a)(),Object(Y.a)((function(e){return null!=e}))).subscribe((function(t){e.dispatch(new Bc.SetBreakpoint(t))}))}}],[{key:"getBreakpoint",value:function(e){return e.breakpoint}},{key:"getBreakpointLabel",value:function(e){return["(max-width: 374px)","(max-width: 599px)","(max-width: 959px)","(max-width: 1439px)","(min-width: 1440px)"][e.breakpoint]}}]),e}()).\u0275fac=function(e){return new(e||qc)(j.Zb(Jc.a),j.Zb(L.g))},qc.\u0275prov=j.Lb({token:qc,factory:qc.\u0275fac}),Xc([Object(L.a)(Bc.SetBreakpoint),Yc("design:type",Function),Yc("design:paramtypes",[Object,Bc.SetBreakpoint]),Yc("design:returntype",void 0)],qc.prototype,"setBreakpoint",null),Xc([Object(L.e)(),Yc("design:type",Function),Yc("design:paramtypes",[el]),Yc("design:returntype",void 0)],qc,"getBreakpoint",null),Xc([Object(L.e)(),Yc("design:type",Function),Yc("design:paramtypes",[el]),Yc("design:returntype",void 0)],qc,"getBreakpointLabel",null),qc=Xc([Object(L.f)({name:"breakpoint",defaults:{breakpoint:null}})],qc)),nl=function(e){return e.AnatomyLabels="anatomyLabels",e.Audio="audio",e.Camera="camera",e.Column="column",e.ColumnToggle="column-toggle",e.ContextActions="contextActions",e.Description="description",e.Drawer="drawer",e.Fullscreen="fullscreen",e.Help="help",e.InternetExplorerWarning="internetExplorerWarning",e.LabelList="labelList",e.Labels="labels",e.Layout="layout",e.Legend="legend",e.Loader="loader",e.Logo="logo",e.Media="media",e.Mediabar="mediabar",e.Menu="menu",e.NodeInfo="nodeInfo",e.Pagination="pagination",e.Presenter="presenter",e.Reset="reset",e.Search="search",e.ScrubberButton="scrubberButton",e.ScrubberItem="scrubberItem",e.TitleOnly="title-only",e.ToggleLabels="toggleLabels",e.Toolbar="toolbar",e.Tools="tools",e.Tutorial="tutorial",e.Undo="undo",e.VisibilityLayers="visibilityLayers",e.Whiteboard="whiteboard",e}({}),il=function(e){return e.Drawer="drawer",e.Column="column",e}({}),ol=function(){var e=function e(t,n){y(this,e),this.storyLoadProgress=t,this.chunkLoadProgress=n};return e.type="[Engine Progress] Set Progress",e}(),rl=function(){var e=function e(){y(this,e)};return e.type="[Engine Progress] Reset Progress",e}(),al=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},sl=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},cl={storyLoadProgress:0,chunkLoadProgress:0},ll=((Kc=function(){function e(){y(this,e)}return v(e,[{key:"setProgress",value:function(e,t){e.patchState({storyLoadProgress:t.storyLoadProgress,chunkLoadProgress:t.chunkLoadProgress})}},{key:"resetProgress",value:function(e,t){e.setState(Object.assign({},cl))}}],[{key:"getStoryLoadProgress",value:function(e){return e.storyLoadProgress}},{key:"getChunkLoadProgress",value:function(e){return e.chunkLoadProgress}}]),e}()).\u0275fac=function(e){return new(e||Kc)},Kc.\u0275prov=j.Lb({token:Kc,factory:Kc.\u0275fac}),al([Object(L.a)(ol),sl("design:type",Function),sl("design:paramtypes",[Object,ol]),sl("design:returntype",void 0)],Kc.prototype,"setProgress",null),al([Object(L.a)(rl),sl("design:type",Function),sl("design:paramtypes",[Object,rl]),sl("design:returntype",void 0)],Kc.prototype,"resetProgress",null),al([Object(L.e)(),sl("design:type",Function),sl("design:paramtypes",[Object]),sl("design:returntype",void 0)],Kc,"getStoryLoadProgress",null),al([Object(L.e)(),sl("design:type",Function),sl("design:paramtypes",[Object]),sl("design:returntype",void 0)],Kc,"getChunkLoadProgress",null),Kc=al([Object(L.f)({name:"engineProgress",defaults:cl})],Kc)),pl=((Wc=function(){function e(t,n){y(this,e),this.store=t,this.chapterService=n,this.ui=null,this.breakpoint=null}return v(e,[{key:"getBase",value:function(){return{ui:this.store.selectSnapshot(hs.getUI),layout:this.store.selectSnapshot(hs.getLayout),breakpoint:this.store.selectSnapshot(tl.getBreakpoint),hideUI:this.isUIHidden()}}},{key:"isUIHidden",value:function(){var e=this.store.selectSnapshot(hs.getOpenWindow),t=this.store.selectSnapshot(vs.getSelectedChapterIndex),n=this.store.selectSnapshot(hs.getUI),i=e===Ea.Loader&&t<=0&&n.loader.template===va.Circle,o=this.store.selectSnapshot(ll.getStoryLoadProgress);return i||0===o||e===Ea.OnDemand||e===Ea.Interact||e===Ea.Tutorial||e===Ea.Whiteboard}},{key:"isDrawerVisible",value:function(){var e=this.getBase(),t=e.hideUI,n=e.ui,i=e.layout;return!t&&this.getViewLayout(i)===il.Drawer&&(n.drawer.enable&&"none"!==this.getVisibleContent()||n.nodeInfo.status===ba.Show||n.labelInfo.status===ba.Show)}},{key:"isColumnVisible",value:function(){var e=this.getBase(),t=e.hideUI,n=e.layout,i=e.ui;return!t&&i.column.status!==ba.Collapse&&this.getViewLayout(n)===il.Column&&i.column.enable&&"full"===this.getVisibleContent()}},{key:"isColumnToggleVisible",value:function(){var e=this.getBase(),t=e.hideUI,n=e.layout,i=e.ui;return!t&&!this.store.selectSnapshot(rr.getQuizModeActive)&&this.getViewLayout(n)===il.Column&&i.column.enable&&"full"===this.getVisibleContent()}},{key:"isTitleOnlyVisible",value:function(){var e=this.getBase(),t=e.hideUI,n=e.ui,i=e.breakpoint;return!t&&!(i<Gc.Large)&&n.titleOnly.enable&&"titleOnly"===this.getVisibleContent()}},{key:"isToolsVisible",value:function(){return!this.getBase().hideUI&&this.isUIVisible(nl.Tools)}},{key:"isToolbarVisible",value:function(){var e=this.getBase(),t=e.hideUI,n=e.ui;return!t&&n.toolbar.enable}},{key:"isLogoVisible",value:function(){var e=this.getBase().ui;return this.store.selectSnapshot(hs.getOpenWindow)!==Ea.OnDemand&&e.logo.enable}},{key:"isCameraVisible",value:function(){var e=this.getBase(),t=e.hideUI,n=e.ui;return!t&&n.camera.enable}},{key:"isPaginationVisible",value:function(){var e=this.getBase(),t=e.hideUI,n=e.ui;return!t&&!(this.store.selectSnapshot(vs.getChapterCount)<=1)&&n.pagination.enable}},{key:"isMediaVisible",value:function(){var e=this.getBase(),t=e.hideUI,n=e.ui;return!t&&this.store.selectSnapshot(vs.getIsChapterAnimated)&&n.media.enable}},{key:"isMediabarVisible",value:function(){if(this.getBase().hideUI)return!1;var e=this.isMediaVisible(),t=this.isAudioVisible();return e||t}},{key:"isScrubberVisible",value:function(e){var t=this.getBase(),n=t.hideUI,i=t.ui,o=t.breakpoint;if(n)return!1;var r=this.isMediaVisible&&i.media.template===ma.Full;switch(e){case nl.ScrubberButton:return r&&o>Gc.Small;case nl.ScrubberItem:return r&&o<=Gc.Small}}},{key:"isMenuVisible",value:function(){var e=this.getBase(),t=e.hideUI,n=e.ui;return!t&&(n.fullscreen.enable||n.help.enable||n.search.enable||n.tools.enable||n.whiteboard.enable||n.tutorial.enable)&&n.menu.enable}},{key:"isNodeInfoColumnVisible",value:function(){var e=this.getBase(),t=e.hideUI,n=e.ui,i=e.breakpoint;return!t&&(!!(i>=Gc.Large&&this.isUIVisible(nl.NodeInfo))||(i<Gc.Large?!n.drawer.enable&&this.isUIVisible(nl.NodeInfo):void 0))}},{key:"isNodeInfoVisible",value:function(e){var t=this.getBase(),n=t.hideUI,i=t.breakpoint;return!n&&(i>=Gc.Large&&e===il.Column||i<Gc.Large&&e===il.Drawer)&&this.isUIVisible(nl.NodeInfo)}},{key:"isAudioVisible",value:function(){var e=this.getBase(),t=e.hideUI,n=e.ui;if(t)return!1;var i=null!=this.store.selectSnapshot(vs.getSelectedChapterAudio);return n.audio.enable&&i}},{key:"isSearchColumnVisible",value:function(){return!this.getBase().hideUI&&this.isUIVisible(nl.Search)}},{key:"isUndoVisible",value:function(){var e=this.getBase(),t=e.hideUI,n=e.ui;return!t&&n.undo.enable}},{key:"isVisibilityLayersVisible",value:function(){var e=this.getBase(),t=e.hideUI,n=e.ui;if(t)return!1;var i=n.visibilityLayers.enable,o=this.store.selectSnapshot(vs.getSelectedChapterCurrentLayers);return i&&this.chapterService.hasVisibilityLayers(o)}},{key:"isVisible",value:function(e){switch(e){case nl.Audio:return this.isAudioVisible();case nl.Camera:return this.isCameraVisible();case nl.Column:return this.isColumnVisible();case nl.ColumnToggle:return this.isColumnToggleVisible();case nl.Drawer:return this.isDrawerVisible();case nl.Logo:return this.isLogoVisible();case nl.Media:return this.isMediaVisible();case nl.Mediabar:return this.isMediabarVisible();case nl.Menu:return this.isMenuVisible();case nl.Pagination:return this.isPaginationVisible();case nl.Search:return this.isSearchColumnVisible();case nl.ScrubberButton:return this.isScrubberVisible(nl.ScrubberButton);case nl.ScrubberItem:return this.isScrubberVisible(nl.ScrubberItem);case nl.TitleOnly:return this.isTitleOnlyVisible();case nl.Tools:return this.isToolsVisible();case nl.Toolbar:return this.isToolbarVisible();case nl.Undo:return this.isUndoVisible();case nl.VisibilityLayers:return this.isVisibilityLayersVisible();default:return this.isUIVisible(e)}}},{key:"isUIVisible",value:function(e){var t=this.getBase(),n=t.hideUI,i=t.ui;return i[e]?!n&&i[e].enable&&i[e].status!==ba.Hide:(console.warn("Attempting to check visibility of a non-existent element: ${element}"),!1)}},{key:"isUIEnabled",value:function(e){return this.getBase().ui[e].enable}},{key:"getVisibleContent",value:function(){var e=this.getBase().ui,t=this.store.selectSnapshot(kc.getChapterLabels),n=this.store.selectSnapshot(vs.getSelectedChapter),i=Object(ie.get)(n,"info.description"),o=Object(ie.get)(n,"info.displayName"),r=Object(ie.get)(n,"legend",[]),a=Object(ie.get)(n,"contentBlocks",[]).length,s=e.labelList.enable&&t.length>0,c=null!=i&&Object(ie.trim)(i).length>0,l=null!=o&&Object(ie.trim)(o).length>0,p=e.legend.enable&&r.length>0,u=this.store.selectSnapshot(rr.getQuizModeActive);return s||c||p||u||a?"full":l?"titleOnly":"none"}},{key:"getViewLayout",value:function(e){var t=document.body.getBoundingClientRect(),n=t.width,i=t.height,o=n/i>=1?"landscape":"portrait",r=this.getBase().breakpoint,a=384+(T.application===P.Viewer?0:56);switch(e){case Ya.ColumnOnly:return il.Column;case Ya.DrawerOnly:return il.Drawer;default:return"portrait"===o?il.Drawer:r>=Gc.Large||i<=a&&n>=708?il.Column:il.Drawer}}}]),e}()).\u0275fac=function(e){return new(e||Wc)(j.Zb(L.g),j.Zb(Wr))},Wc.\u0275prov=j.Lb({token:Wc,factory:Wc.\u0275fac,providedIn:"root"}),Wc),ul=function(){var e=function e(t){y(this,e),this.query=t};return e.type="[Bookmarks] Load",e}(),dl=function(){var e=function e(t){y(this,e),this.organizationId=t};return e.type="[Bookmarks] Load Organization Bookmarks",e}(),gl=function(){var e=function e(t,n){y(this,e),this.organizationId=t,this.collectionId=n};return e.type="[Bookmarks] Load Collection Bookmarks",e}(),hl=function(){var e=function e(t,n){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];y(this,e),this.id=t,this.type=n,this.preview=i};return e.type="[Bookmarks] Select Bookmark",e}(),fl=function(){var e=function e(t){y(this,e),this.bookmark=t};return e.type="[Bookmarks] Select Bookmark Success",e}(),bl=function(){var e=function e(t){y(this,e),this.result=t};return e.type="[Bookmarks] Load Success",e}(),ml=function(){var e=function e(t){y(this,e),this.bookmarkId=t};return e.type="[Bookmarks] Delete Bookmark",e}(),vl=function(){var e=function e(t){y(this,e),this.bookmarkId=t};return e.type="[Bookmarks] Bookmark Delete Success",e}(),yl=function(){var e=function e(t,n){y(this,e),this.bookmarkId=t,this.message=n};return e.type="[Bookmarks] Bookmark Delete Fail",e}(),xl=function(){var e=function e(t){y(this,e),this.bookmarkIds=t};return e.type="[Bookmarks] BulkDelete Bookmark",e}(),Ol=function(){var e=function e(t){y(this,e),this.bookmarkIds=t};return e.type="[Bookmarks] Bookmark BulkDelete Success",e}(),wl=function(){var e=function e(t,n){y(this,e),this.bookmarkIds=t,this.message=n};return e.type="[Bookmarks] Bookmark BulkDelete Fail",e}(),kl=function(){var e=function e(t,n){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];y(this,e),this.bookmarkEntry=t,this.inplace=n,this.includeIndex=i};return e.type="[Bookmarks] Save Bookmark",e}(),Cl=function(){var e=function e(t,n,i){y(this,e),this.bookmark=t,this.story=n,this.method=i};return e.type="[Bookmarks] Bookmark Saved",e}(),Sl=function(){var e=function e(t){y(this,e),this.bookmarkEntry=t};return e.type="[Bookmarks] Bookmark Save Failed",e}(),_l=function(){var e=function e(){y(this,e)};return e.type="[Bookmarks] Cancel Save Bookmark",e}(),jl=function(){var e=function e(){y(this,e)};return e.type="[Bookmarks] Reset",e}(),Pl=function(){var e=function e(){y(this,e)};return e.type="[Bookmarks] Clear Bookmarks",e}(),Ml=function(){var e=function e(t){y(this,e),this.sort=t};return e.type="[Bookmarks] Sort",e}(),Il=function(){var e=function e(t,n){y(this,e),this.id=t,this.checked=n};return e.type="[Bookmarks] Check Bookmark",e}(),zl=function(){var e=function e(t){y(this,e),this.ids=t};return e.type="[Bookmarks] Set Checked Bookmarks",e}(),Tl=function(){var e=function e(t,n,i,o,r,a,s,c,l){y(this,e),this.bookmarks=t,this.organizationId=n,this.collections=i,this.widgetURL=o,this.userLanguage=r,this.userApp=a,this.widgetOptions=s,this.offlineEnabled=c,this.productAccountId=l};return e.type="[Bookmarks] Export Bookmarks",e}(),Ul=function(){var e=function e(t){y(this,e),this.bookmarks=t};return e.type="[Bookmarks] Export Bookmarks Success",e}(),Dl=function(){var e=function e(t){y(this,e),this.bookmarks=t};return e.type="[Bookmarks] Export Bookmarks Error",e}(),Ll=function(){var e=function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Map;y(this,e),this.bookmark=t,this.addCollections=n,this.removeCollections=i};return e.type="[Bookmarks] Update Bookmark Collections",e}(),El=function(){var e=function e(t,n,i){y(this,e),this.bookmark=t,this.addCollections=n,this.removeCollections=i};return e.type="[Bookmarks] Update Bookmark Collections Success",e}(),Fl=function(){var e=function e(t,n,i){y(this,e),this.bookmark=t,this.addCollections=n,this.removeCollections=i};return e.type="[Bookmarks] Update Bookmark Collections Error",e}(),Al=function(){var e=function e(t,n){y(this,e),this.bookmark=t,this.collections=n};return e.type="[Bookmarks] Add Bookmark Collections Success",e}(),Rl=function(){var e=function e(t,n){y(this,e),this.bookmark=t,this.collections=n};return e.type="[Bookmarks] Add Bookmark Collections Error",e}(),Vl=function(){var e=function e(t,n){y(this,e),this.bookmark=t,this.collections=n};return e.type="[Bookmarks] Remove Bookmark Collections Success",e}(),Nl=function(){var e=function e(t,n){y(this,e),this.bookmark=t,this.collections=n};return e.type="[Bookmarks] Remove Bookmark Collections Error",e}(),Bl=(($c=function e(t,n,i){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Ee.lang,r=arguments.length>4?arguments[4]:void 0,a=arguments.length>5?arguments[5]:void 0;y(this,e),this.id=t,this.title=n,this.type=i,this.lang=o,this.groupAccess=r,this.collections=a}).type="[Bookmarks] Copy Bookmark",$c),Hl=function(){var e=function e(t){y(this,e),this.newBookmark=t};return e.type="[Bookmarks] Copy Bookmark Success",e}(),Ql=function(){var e=function e(t,n){y(this,e),this.id=t,this.error=n};return e.type="[Bookmarks] Copy Bookmark Failure",e}(),ql=function(){var e=function e(){y(this,e)};return e.type="[Bookmarks] Cancel Copy Bookmark",e}(),$l=function(){var e=function e(t){y(this,e),this.title=t};return e.type="[Bookmarks] Set Bookmark Text",e}(),Wl=function(){var e=function e(t){y(this,e),this.viewMode=t};return e.type="[Bookmarks] Set Bookmark View Mode",e}(),Kl=function(){var e=function e(t){y(this,e),this.category=t};return e.type="[Bookmarks] Set Selected Category",e}(),Gl=gs.ui,Zl=function e(){y(this,e)},Jl=function(e,t){return void 0===e?t:e};function Xl(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return!!t.some((function(e){return!0===e}))||!t.some((function(e){return!1===e}))&&void 0}function Yl(e,t,n){return Object.values(ma).indexOf(n)>=0?n:!1===e?ma.None:null!=t?t?ma.Full:ma.Small:null}function ep(e){return Object.values(va).includes(e)?e:null}function tp(e){var t,n=null!=e["ui-all"]?np(e["ui-all"]):new Zl;return ip((c(t={},nl.Layout,e["ui-layout"]),c(t,nl.Loader,ep(e["ui-loader"])),c(t,nl.NodeInfo,e["ui-anatomy-descriptions"]),c(t,nl.Tools,e["ui-tools"]),c(t,nl.Toolbar,e["ui-toolbar"]),c(t,nl.Media,Yl(null,Xl(e["ui-scrubber"],e["ui-scrubber.chapters"],e["ui-scrubber.tour"]),e["ui-media-controls"])),c(t,nl.Audio,e["ui-audio"]),c(t,nl.Fullscreen,e["ui-fullscreen"]),c(t,nl.Help,e["ui-help"]),c(t,nl.Camera,e["ui-nav"]),c(t,nl.Presenter,e["ui-presenter"]),c(t,nl.Menu,e["ui-menu"]),c(t,nl.Pagination,e["ui-tour"]),c(t,nl.Search,Xl(e["ui-search"],e["ui-object-tree"])),c(t,nl.Column,Xl(e["ui-info"],e["ui-panel"])),c(t,nl.Drawer,Xl(e["ui-info"],e["ui-panel"])),c(t,nl.Description,Xl(e["ui-info"])),c(t,nl.TitleOnly,Xl(e["ui-info"])),c(t,nl.Logo,Xl(e["ui-bd"],e["ui-logo"])),c(t,"logoIsHyperLink",Xl(e["ui-bd.link"],e["ui-logo.islink"])),c(t,nl.Labels,e["ui-labels"]),c(t,nl.LabelList,e["ui-label-list"]),c(t,nl.InternetExplorerWarning,e["ie-warning"]),c(t,"all",e["ui-all"]),c(t,"drawerExpandedInitially",e["ui-info-expand"]),c(t,nl.AnatomyLabels,Xl(e["ui-anatomy-labels"])),c(t,nl.Tutorial,Xl(e["ui-tutorial"])),c(t,nl.Legend,Xl(e["ui-legend"])),c(t,nl.Undo,Xl(e["ui-undo"],e["ui-reset"])),c(t,nl.Whiteboard,Xl(e["ui-whiteboard"])),c(t,nl.VisibilityLayers,Xl(e["ui-visibility-layers"],e["ui-layers"])),c(t,nl.ContextActions,Xl(e["ui-context-actions"])),c(t,nl.ToggleLabels,void 0),t),n)}function np(e){var t;return c(t={},nl.Loader,e?ya:va.None),c(t,nl.Column,e),c(t,nl.Drawer,e),c(t,nl.Tools,e),c(t,nl.Toolbar,e),c(t,nl.Fullscreen,e),c(t,nl.Help,e),c(t,nl.Camera,e),c(t,nl.Search,e),c(t,nl.Presenter,e),c(t,nl.Menu,e),c(t,nl.Audio,e),c(t,nl.Pagination,e),c(t,nl.NodeInfo,e),c(t,nl.Labels,null),c(t,nl.LabelList,e),c(t,nl.Media,null),c(t,nl.TitleOnly,e),c(t,nl.Undo,e),c(t,"all",e),c(t,"drawerExpandedInitially",null),c(t,"logoIsHyperLink",null),c(t,nl.AnatomyLabels,null),c(t,nl.Logo,!0),c(t,nl.Tutorial,null),c(t,nl.InternetExplorerWarning,!0),c(t,nl.Legend,!0),c(t,nl.Whiteboard,e),c(t,nl.VisibilityLayers,e),c(t,nl.ContextActions,e),c(t,nl.ToggleLabels,!0),t}function ip(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return null==t?e:Object(ie.uniq)([].concat(p(Object.keys(e)),p(Object.keys(t)))).reduce((function(i,o){return i[o]=null==e[o]||n&&null!=t[o]?t[o]:e[o],i}),new Zl)}function op(e,t){var n=JSON.parse(JSON.stringify(e));return n.loader.enable=Jl(t[nl.Loader]!==va.None,Gl.loader.enable),null!=t[nl.Loader]&&(n.loader.template=t[nl.Loader]),n.nodeInfo.enable=Jl(t[nl.NodeInfo],Gl.nodeInfo.enable),n.pagination.enable=Jl(t[nl.Pagination],Gl.pagination.enable),n.drawer.isExpandedInitially=Jl(t.drawerExpandedInitially,Gl.drawer.isExpandedInitially),n.tools.enable=Jl(t[nl.Tools],Gl.tools.enable),n.toolbar.enable=Jl(t[nl.Toolbar],Gl.toolbar.enable),n.media.enable=Jl(t[nl.Media]!==ma.None,Gl.media.enable),n.media.template=t[nl.Media],n.fullscreen.enable=Jl(t[nl.Fullscreen],Gl.fullscreen.enable),n.help.enable=Jl(t[nl.Help],Gl.help.enable),n.description.enable=Jl(t[nl.Description],Gl.description.enable),n.titleOnly.enable=Jl(t[nl.TitleOnly],Gl.titleOnly.enable),n.camera.enable=Jl(t[nl.Camera],Gl.camera.enable),n.search.enable=Jl(t[nl.Search],Gl.search.enable),n.presenter.enable=Jl(t[nl.Presenter],Gl.presenter.enable),n.menu.enable=Jl(t[nl.Menu],Gl.menu.enable),n.logo.enable=Jl(t[nl.Logo],Gl.logo.enable),n.logo.isHyperLink=Jl(t.logoIsHyperLink,Gl.logo.isHyperLink),n.internetExplorerWarning.enable=Jl(t.internetExplorerWarning,Gl.internetExplorerWarning.enable),n.undo.enable=Jl(t[nl.Undo],Gl.undo.enable),n.labels.enable=Jl(t[nl.Labels],Gl.labels.enable),n.labelList.enable=Jl(t[nl.LabelList],Gl.labelList.enable),n.audio.enable=Jl(t[nl.Audio],Gl.audio.enable),n.reset.enable=Jl(t[nl.Reset],Gl.reset.enable),n.column.enable=Jl(t[nl.Column],Gl.column.enable),n.drawer.enable=Jl(t[nl.Drawer],Gl.drawer.enable),n.anatomyLabels.enable=Jl(t[nl.AnatomyLabels],Gl.anatomyLabels.enable),n.tutorial.enable=Jl(t[nl.Tutorial],Gl.tutorial.enable),n.whiteboard.enable=Jl(t[nl.Whiteboard],Gl.whiteboard.enable),n.visibilityLayers.enable=Jl(t[nl.VisibilityLayers],Gl.visibilityLayers.enable),n.contextActions.enable=Jl(t[nl.ContextActions],Gl.contextActions.enable),n.toggleLabels.enable=Jl(t[nl.ToggleLabels],Gl.toggleLabels.enable),n}var rp,ap=r("0IaG");!function(e){var t=function e(t){y(this,e),this.theme=t};t.type="[Layout] Set Theme",e.SetTheme=t;var n=function e(t){y(this,e),this.sidenav=t};n.type="[Layout] Set Sidenav",e.SetSidenav=n;var i=function e(t){y(this,e),this.open=t};i.type="[Layout] Toggle Sidenav",e.ToggleSidenav=i;var o=function e(t){y(this,e),this.siteHeaderType=t};o.type="[Layout] Set Header",e.SetHeader=o;var r=function e(t){y(this,e),this.siteFooterType=t};r.type="[Layout] Set Footer",e.SetFooter=r;var a=function e(){y(this,e)};a.type="[Layout] Reset",e.ResetLayout=a}(rp||(rp={}));var sp,cp,lp=function e(){y(this,e)},pp=function(e){return e.Light="theme-light",e.Dark="theme-dark",e}({}),up=function(e){return e[e.Application=0]="Application",e[e.Search=1]="Search",e[e.View=2]="View",e[e.Hide=3]="Hide",e[e.Share=4]="Share",e}({}),dp=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},gp=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},hp={theme:pp.Light,sidenav:{enabled:!0,open:!1},siteHeader:up.Application,siteFooter:(sp={},sp[sp.Mobile=0]="Mobile",sp[sp.None=1]="None",sp).None},fp=((cp=function(){function e(){y(this,e)}return v(e,[{key:"setTheme",value:function(e,t){(0,e.patchState)({theme:t.theme})}},{key:"setHeader",value:function(e,t){e.patchState({siteHeader:t.siteHeaderType})}},{key:"setFooter",value:function(e,t){e.patchState({siteFooter:t.siteFooterType})}},{key:"setSidenav",value:function(e,t){e.patchState({sidenav:Object.assign({},t.sidenav)})}},{key:"toggleSidenav",value:function(e,t){var n=e.getState().sidenav;e.patchState({sidenav:Object.assign(Object.assign({},n),{open:t.open})})}},{key:"resetLayout",value:function(e,t){e.setState(hp)}}],[{key:"getTheme",value:function(e){return e.theme}},{key:"getSidenav",value:function(e){return e.sidenav}},{key:"getSiteHeader",value:function(e){return e.siteHeader}},{key:"getSiteFooter",value:function(e){return e.siteFooter}}]),e}()).\u0275fac=function(e){return new(e||cp)},cp.\u0275prov=j.Lb({token:cp,factory:cp.\u0275fac}),dp([Object(L.a)(rp.SetTheme),gp("design:type",Function),gp("design:paramtypes",[Object,rp.SetTheme]),gp("design:returntype",void 0)],cp.prototype,"setTheme",null),dp([Object(L.a)(rp.SetHeader),gp("design:type",Function),gp("design:paramtypes",[Object,rp.SetHeader]),gp("design:returntype",void 0)],cp.prototype,"setHeader",null),dp([Object(L.a)(rp.SetFooter),gp("design:type",Function),gp("design:paramtypes",[Object,rp.SetFooter]),gp("design:returntype",void 0)],cp.prototype,"setFooter",null),dp([Object(L.a)(rp.SetSidenav),gp("design:type",Function),gp("design:paramtypes",[Object,rp.SetSidenav]),gp("design:returntype",void 0)],cp.prototype,"setSidenav",null),dp([Object(L.a)(rp.ToggleSidenav),gp("design:type",Function),gp("design:paramtypes",[Object,rp.ToggleSidenav]),gp("design:returntype",void 0)],cp.prototype,"toggleSidenav",null),dp([Object(L.a)(rp.ResetLayout),gp("design:type",Function),gp("design:paramtypes",[Object,rp.ResetLayout]),gp("design:returntype",void 0)],cp.prototype,"resetLayout",null),dp([Object(L.e)(),gp("design:type",Function),gp("design:paramtypes",[lp]),gp("design:returntype",void 0)],cp,"getTheme",null),dp([Object(L.e)(),gp("design:type",Function),gp("design:paramtypes",[lp]),gp("design:returntype",void 0)],cp,"getSidenav",null),dp([Object(L.e)(),gp("design:type",Function),gp("design:paramtypes",[lp]),gp("design:returntype",void 0)],cp,"getSiteHeader",null),dp([Object(L.e)(),gp("design:type",Function),gp("design:paramtypes",[lp]),gp("design:returntype",void 0)],cp,"getSiteFooter",null),cp=dp([Object(L.f)({name:"layout",defaults:hp})],cp));function bp(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return.01*(window.innerHeight-(t&&e!==up.Hide?56:0))}var mp,vp=((mp=function(){function e(){y(this,e)}return v(e,[{key:"iconClass",get:function(){var e="fas fa-"+this.icon;return this.size&&(e+=" fa-"+this.size),e}},{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||mp)},mp.\u0275cmp=j.Jb({type:mp,selectors:[["app-icon"]],inputs:{icon:"icon",size:"size"},decls:1,vars:1,consts:[[3,"ngClass"]],template:function(e,t){1&e&&j.Qb(0,"i",0),2&e&&j.lc("ngClass",t.iconClass)},directives:[we.i],styles:[""],encapsulation:2,changeDetection:0}),mp);function yp(e,t){1&e&&(j.Vb(0,"div"),j.jc(1),j.Ub())}var xp,Op=["*"],wp=((xp=function(){function e(t){y(this,e),this.changeDetector=t,this.hide=!1,this._isActive=!1}return v(e,[{key:"isActive",get:function(){return this._isActive},set:function(e){this._isActive=e,this.changeDetector.markForCheck()}},{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||xp)(j.Pb(j.i))},xp.\u0275cmp=j.Jb({type:xp,selectors:[["app-tab"]],inputs:{label:"label",hide:"hide"},ngContentSelectors:Op,decls:1,vars:1,consts:[[4,"ngIf"]],template:function(e,t){1&e&&(j.kc(),j.Ic(0,yp,2,0,"div",0)),2&e&&j.lc("ngIf",t.isActive)},directives:[we.l],styles:[""],changeDetection:0}),xp),kp=r("2Vo4"),Cp=r("Zy1z"),Sp=["tabButton"],_p=function(e,t,n,i){return{"tabs__label--dark":e,"tabs__label--light":t,"tabs__label--dark-active":n,"tabs__label--light-active":i}};function jp(e,t){if(1&e){var n=j.Wb();j.Vb(0,"button",5,6),j.cc("click",(function(){j.xc(n);var e=t.$implicit;return j.gc().handleTabSelect(e)})),j.Kc(2),j.Ub()}if(2&e){var i=t.$implicit,o=j.gc();j.lc("ngClass",j.qc(4,_p,"dark"==o.tabTheme,"light"==o.tabTheme,"dark"==o.tabTheme&&o.isTabActive(i),"light"==o.tabTheme&&o.isTabActive(i))),j.Eb("aria-selected",o.isTabActive(i))("tabIndex",o.isTabActive(i)?0:-1),j.Db(2),j.Mc(" ",i.label," ")}}var Pp,Mp=function(e,t){return{"tabs--small":e,"tabs--medium":t}},Ip=["*"],zp=((Pp=function(){function e(t){y(this,e),this.changeDetector=t,this.display="normal",this.tabTheme="dark",this.activeTabChange=new j.p,this._activeTab=new kp.a(0),this.tabSize="small",this.tabAlign="default",this.ngUnsubscribe=new Z.a}return v(e,[{key:"activeTab",get:function(){return this._activeTab.value},set:function(e){null!=e&&("string"==typeof e&&(e=e.toUpperCase()),this._activeTab.next(e))}},{key:"tabItems",get:function(){return this._tabItems},set:function(e){this._tabItems=e}},{key:"ngOnInit",value:function(){}},{key:"ngAfterContentInit",value:function(){var e=this;this._tabs.changes.pipe(Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){e.mapTabs(),e.changeDetector.markForCheck()})),this.mapTabs(),this._activeTab.pipe(Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){e.showTab(t)})),this._activeTab.pipe(Object(Cp.a)(),Object(Y.a)((function(e){var t=d(e,2);return t[0]!==t[1]})),Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){var n=d(t,2),i=(n[0],n[1]);e.activeTabChange.next(i)}))}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"handleTabSelect",value:function(e){this._activeTab.next(e.index)}},{key:"mapTabs",value:function(){this.tabItems=this._tabs.map((function(e,t){return{index:t,label:e.label||"Item "+t,tab:e}}))}},{key:"showTab",value:function(e){this._tabs.forEach((function(t,n){switch(typeof e){case"number":t.isActive=e===n;break;case"string":t.isActive=e.toString().toUpperCase()===t.label.toUpperCase()}})),this.changeDetector.markForCheck()}},{key:"isTabActive",value:function(e){return("string"==typeof this._activeTab.value?e.label.toUpperCase():e.index)===this._activeTab.value}},{key:"shiftTab",value:function(e){var t=this,n=(this.tabItems.find((function(e){return t.isTabActive(e)})).index+e+this.tabItems.length)%this.tabItems.length;this._activeTab.next(n),this._buttonRefs.toArray()[n].nativeElement.focus()}}]),e}()).\u0275fac=function(e){return new(e||Pp)(j.Pb(j.i))},Pp.\u0275cmp=j.Jb({type:Pp,selectors:[["app-tabs"]],contentQueries:function(e,t,n){var i;1&e&&j.Ib(n,wp,!1),2&e&&j.sc(i=j.dc())&&(t._tabs=i)},viewQuery:function(e,t){var n;1&e&&j.Pc(Sp,!0),2&e&&j.sc(n=j.dc())&&(t._buttonRefs=n)},inputs:{display:"display",tabTheme:"tabTheme",activeTab:"activeTab",tabSize:"tabSize",tabAlign:"tabAlign"},outputs:{activeTabChange:"activeTabChange"},ngContentSelectors:Ip,decls:6,vars:7,consts:[[1,"tabs",3,"ngClass"],["role","tablist",1,"tabs__labels",3,"keyup.arrowright","keyup.arrowleft"],["tabElements",""],["class","tabs__label","role","tab","type","button","data-test","tabButton",3,"ngClass","click",4,"ngFor","ngForOf"],[1,"tabs__content"],["role","tab","type","button","data-test","tabButton",1,"tabs__label",3,"ngClass","click"],["tabButton",""]],template:function(e,t){1&e&&(j.kc(),j.Vb(0,"div",0),j.Vb(1,"div",1,2),j.cc("keyup.arrowright",(function(){return t.shiftTab(1)}))("keyup.arrowleft",(function(){return t.shiftTab(-1)})),j.Ic(3,jp,3,9,"button",3),j.Ub(),j.Vb(4,"div",4),j.jc(5),j.Ub(),j.Ub()),2&e&&(j.lc("ngClass",j.oc(4,Mp,"small"==t.tabSize,"medium"==t.tabSize)),j.Db(1),j.Hb("tabs__labels--center","center"===t.tabAlign),j.Db(2),j.lc("ngForOf",t.tabItems))},directives:[we.i,we.k],styles:['.text-8[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase[_ngcontent-%COMP%]{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase[_ngcontent-%COMP%]{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase[_ngcontent-%COMP%]{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase[_ngcontent-%COMP%]{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-28[_ngcontent-%COMP%]{font-size:28px;letter-spacing:.7px;line-height:1.4em}.text-28.text-uppercase[_ngcontent-%COMP%]{font-size:28px;letter-spacing:1.68px;line-height:1.25em;text-transform:uppercase}.text-header[_ngcontent-%COMP%]{font-weight:700}.text--code[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.text-xlight[_ngcontent-%COMP%]{font-weight:200}.text-light[_ngcontent-%COMP%]{font-weight:300}.text-medium[_ngcontent-%COMP%]{font-weight:500}.text-semibold[_ngcontent-%COMP%]{font-weight:600}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-underline[_ngcontent-%COMP%]{text-decoration:underline}.text-italic[_ngcontent-%COMP%]{font-style:italic}.text-bright[_ngcontent-%COMP%]{color:#fff}.text-dim[_ngcontent-%COMP%]{color:#96a8c0}.text-error[_ngcontent-%COMP%]{color:#ed4758}.text-left[_ngcontent-%COMP%]{text-align:left}.text-center[_ngcontent-%COMP%]{text-align:center}.text-right[_ngcontent-%COMP%]{text-align:right}.text-ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link[_ngcontent-%COMP%], .text-link[_ngcontent-%COMP%]:visited{color:inherit;cursor:pointer}.text-link[_ngcontent-%COMP%]:not(.text-underline), .text-link[_ngcontent-%COMP%]:visited:not(.text-underline){text-decoration:none}.text-success[_ngcontent-%COMP%]{color:#38de38}.text-danger[_ngcontent-%COMP%]{color:#de3535}.text-info[_ngcontent-%COMP%]{color:#2d72dc}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.text-pre-line[_ngcontent-%COMP%]{white-space:pre-line}.tabs__labels[_ngcontent-%COMP%]{margin-bottom:8px}.tabs__labels--center[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.tabs__label[_ngcontent-%COMP%]{padding:2px 4px 4px;margin-right:8px;font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase;font-weight:500;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;position:relative;background:none;border:none}.tabs__label[_ngcontent-%COMP%]:after{content:"";display:block;border-bottom:3px solid;margin-top:4px;width:0;transition:.25s ease;position:absolute;bottom:0;left:0}.tabs__label[_ngcontent-%COMP%]:hover{cursor:pointer}.tabs__label--dark[_ngcontent-%COMP%]{color:#96a8c0}.tabs__label--dark[_ngcontent-%COMP%]:after{border-color:#2d72dc}.tabs__label--dark-active[_ngcontent-%COMP%], .tabs__label--dark[_ngcontent-%COMP%]:hover{color:#fff}.tabs__label--dark-active[_ngcontent-%COMP%]:after{width:100%}.tabs__label--light[_ngcontent-%COMP%]{color:#374a68}.tabs__label--light[_ngcontent-%COMP%]:after{border-color:#2d72dc}.tabs__label--light-active[_ngcontent-%COMP%], .tabs__label--light[_ngcontent-%COMP%]:hover{color:#283853}.tabs__label--light-active[_ngcontent-%COMP%]:after{width:100%}.tabs--medium[_ngcontent-%COMP%]   .tabs__label[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}'],changeDetection:0}),Pp);function Tp(e,t){if(1&e&&(j.Vb(0,"label",11),j.Kc(1),j.Ub()),2&e){var n=j.gc().$implicit;j.Db(1),j.Lc(n.pronunciation)}}function Up(e,t){if(1&e&&(j.Vb(0,"span"),j.Vb(1,"kbd",9),j.Kc(2),j.Ub(),j.Ic(3,Tp,2,1,"label",10),j.Ub()),2&e){var n=t.$implicit;j.Db(1),j.Eb("aria-hidden",n.hasOwnProperty("pronunciation")),j.Db(1),j.Mc(" ",n.shortcut," "),j.Db(1),j.lc("ngIf",n.hasOwnProperty("pronunciation"))}}function Dp(e,t){if(1&e&&(j.Vb(0,"tr"),j.Vb(1,"th",7),j.Kc(2),j.Ub(),j.Vb(3,"td",8),j.Ic(4,Up,4,3,"span",6),j.Ub(),j.Ub()),2&e){var n=t.$implicit;j.Db(2),j.Lc(n.label),j.Db(2),j.lc("ngForOf",n.keys)}}function Lp(e,t){if(1&e&&(j.Vb(0,"div",2),j.Vb(1,"h2",3),j.Kc(2),j.Ub(),j.Vb(3,"table",4),j.Vb(4,"tr"),j.Qb(5,"th"),j.Vb(6,"th",5),j.Kc(7,"Keyboard Shortcut"),j.Ub(),j.Ub(),j.Ic(8,Dp,5,2,"tr",6),j.Ub(),j.Ub()),2&e){var n=t.$implicit;j.Db(2),j.Lc(n.label),j.Db(6),j.lc("ngForOf",n.shortcuts)}}var Ep,Fp,Ap,Rp,Vp=function(e){return e.Left="\u2190",e.Right="\u2192",e.Up="\u2191",e.Down="\u2193",e.Command="\u2318",e}({}),Np=((Ep=function e(){y(this,e),this.shortcutGroups=[{label:"Navigation",shortcuts:[{keys:[{shortcut:",",pronunciation:"Comma."},{shortcut:"Pg-Up",pronunciation:"page-up"}],label:"Previous chapter"},{keys:[{shortcut:".",pronunciation:"Period."},{shortcut:"Pg-Down",pronunciation:"Page-down."}],label:"Next chapter"},{keys:[{shortcut:"/",pronunciation:"Forward slash."}],label:"Open Search"},{keys:[{shortcut:"Ctrl + Enter"}],label:"Enter Fullscreen"},{keys:[{shortcut:"Ctrl/Cmd + ,",pronunciation:"Control or command plus comma."}],label:"Toggle Description"},{keys:[{shortcut:"Shift + /"}],label:"Open Help"}]},{label:"Tools",shortcuts:[{keys:[{shortcut:"1"}],label:'Use "Select" tool'},{keys:[{shortcut:"2"}],label:'Use "Hide" tool'},{keys:[{shortcut:"3"}],label:'Use "Fade" tool'},{keys:[{shortcut:"del",pronunciation:"Delete."},{shortcut:"backspace"}],label:"Hide selected structure"},{keys:[{shortcut:"Shift + R"}],label:"Reset chapter"},{keys:[{shortcut:"Ctrl/Cmd + Z",pronunciation:"Control or command plus z."}],label:"Undo"},{keys:[{shortcut:"Ctrl/Cmd + Shift + Z",pronunciation:"Control or command plus shift pluz z."},{shortcut:"Ctrl/Cmd + Y",pronunciation:"Control or command plus y."}],label:"Redo"}]},{label:"Pan",shortcuts:[{keys:[{shortcut:"W"}],label:"Pan up"},{keys:[{shortcut:"S"}],label:"Pan down"},{keys:[{shortcut:"A"}],label:"Pan left"},{keys:[{shortcut:"D"}],label:"Pan right"},{keys:[{shortcut:"Shift + W"}],label:"Slow pan up"},{keys:[{shortcut:"Shift + S"}],label:"Slow pan down"},{keys:[{shortcut:"Shift + A"}],label:"Slow pan left"},{keys:[{shortcut:"Shift + D"}],label:"Slow pan right"}]},{label:"Rotate",shortcuts:[{keys:[{shortcut:Vp.Up}],label:"Rotate up"},{keys:[{shortcut:Vp.Down}],label:"Rotate down"},{keys:[{shortcut:Vp.Left}],label:"Rotate left"},{keys:[{shortcut:Vp.Right}],label:"Rotate right"},{keys:[{shortcut:"Shift + "+Vp.Up}],label:"Slow rotate up"},{keys:[{shortcut:"Shift + "+Vp.Down}],label:"Slow rotate down"},{keys:[{shortcut:"Shift + "+Vp.Left}],label:"Slow rotate left"},{keys:[{shortcut:"Shift + "+Vp.Right}],label:"Slow rotate right"}]},{label:"Zoom",shortcuts:[{keys:[{shortcut:"E"},{shortcut:"=",pronunciation:"Equals."}],label:"Zoom in"},{keys:[{shortcut:"C"},{shortcut:"-",pronunciation:"Hyphen."}],label:"Zoom out"},{keys:[{shortcut:"Shift + E"},{shortcut:"Shift + =",pronunciation:"Shift plus equals."}],label:"Slow zoom in"},{keys:[{shortcut:"Shift + C"},{shortcut:"Shift + -",pronunciation:"Shift plus hyphen."}],label:"Slow zoom out"}]}]}).\u0275fac=function(e){return new(e||Ep)},Ep.\u0275cmp=j.Jb({type:Ep,selectors:[["app-view-shortcuts"]],decls:2,vars:1,consts:[[1,"view-shortcuts"],["class","view-shortcuts__group",4,"ngFor","ngForOf"],[1,"view-shortcuts__group"],[1,"view-shortcuts__label","text-bold"],[1,"view-shortcuts__table"],["scope","col",1,"view-shortcuts__cell-header"],[4,"ngFor","ngForOf"],["scope","row",1,"view-shortcuts__cell-header"],[1,"view-shortcuts__cell","view-shortcuts__cell--key"],[1,"view-shortcuts__key"],["class","visually-hidden",4,"ngIf"],[1,"visually-hidden"]],template:function(e,t){1&e&&(j.Vb(0,"div",0),j.Ic(1,Lp,9,2,"div",1),j.Ub()),2&e&&(j.Db(1),j.lc("ngForOf",t.shortcutGroups))},directives:[we.k,we.l],styles:[".view-shortcuts[_ngcontent-%COMP%]{display:flex;flex-direction:column}.view-shortcuts__group[_ngcontent-%COMP%]{width:100%;padding-bottom:32px;margin-top:32px}.view-shortcuts__label[_ngcontent-%COMP%]{padding:8px 0 12px}.view-shortcuts__table[_ngcontent-%COMP%]{width:100%}.view-shortcuts__cell[_ngcontent-%COMP%], .view-shortcuts__cell-header[_ngcontent-%COMP%]{padding:8px;border-bottom:1px solid hsla(0,0%,100%,.3);width:50%}.view-shortcuts__cell-header[_ngcontent-%COMP%]{text-align:left}.view-shortcuts__key[_ngcontent-%COMP%]{border-radius:4px;display:inline-flex;padding:4px;margin-right:4px;background:#000;color:#fff;justify-content:center;align-items:center;font-family:monospace;font-size:16px}"],changeDetection:0}),Ep),Bp=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Hp=["viewHelp"],Qp=((Fp=function(){function e(t,n,i,o){y(this,e),this.dialogRef=t,this.renderer=n,this.store=i,this.data=o,this.helpTypeEnum=ee,this.activeTab=ee.Basics,this.ngUnsubscribe=new Z.a,this.activeTab=o.tab}return v(e,[{key:"ngOnInit",value:function(){this.initWindowSizeObserver()}},{key:"ngAfterViewInit",value:function(){this.updateViewHeight()}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"initWindowSizeObserver",value:function(){var e=this;this.renderer.listen("window","resize",(function(){e.updateViewHeight()}))}},{key:"updateViewHeight",value:function(){var e=bp(this.store.selectSnapshot(fp.getSiteHeader),!1);this.viewHelp.nativeElement.style.setProperty("--vh",e+"px")}},{key:"handleCloseClick",value:function(){this.dialogRef.close()}}]),e}()).\u0275fac=function(e){return new(e||Fp)(j.Pb(ap.g),j.Pb(j.H),j.Pb(L.g),j.Pb(ap.a))},Fp.\u0275cmp=j.Jb({type:Fp,selectors:[["app-help-dialog"]],viewQuery:function(e,t){var n;1&e&&j.Ec(Hp,!0),2&e&&j.sc(n=j.dc())&&(t.viewHelp=n.first)},decls:126,vars:1,consts:[["role","dialog","aria-labelledby","helpTitle",1,"view-help"],["viewHelp",""],["id","helpTitle",1,"view-help__header"],["type","button",1,"view-help__close",3,"click"],["icon","times","aria-hidden","true"],[1,"visually-hidden"],[1,"view-help__inner"],["tabSize","medium","tabAlign","center","cdkFocusInitial","",3,"activeTab"],["label","Navigation Basics","id","helpBasics","aria-controls","basicsPanel"],["role","tabpanel","aria-labelledby","helpBasics","tabindex","0","id","basicsPanel"],[1,"view-help__group"],[1,"view-help__item"],[1,"view-help__image"],["src","assets/images/widget/help-rotate.svg","alt","A heart with an arrow wrapped around it, which symbolises objects being rotated withing the 3D viewport."],[1,"view-help__label"],["src","assets/images/widget/help-pan.svg","alt","A heart with left and right arrows pointing away from it, which symbolises objects being panned within the 3D viewport"],["src","assets/images/widget/help-zoom.svg","alt","A heart with a magnifying glass over it, which symbolises zooming into and out from an object within the 3D viewport."],["src","assets/images/widget/help-learn.svg","alt","A heart with a smaller region colored in blue and a popup window specifying that the Right Ventricle is selected."],["label","All Controls","id","helpAll","aria-controls","allPanel"],["role","tabpanel","aria-labelledby","helpAll","tabindex","0","id","allPanel"],[1,"view-help__section-header"],["src","assets/images/widget/help-mouse-hold-left.svg","alt","A mouse with the left button being held in."],["src","assets/images/widget/help-mouse-hold-right.svg","alt","A mouse with the right button being held in."],["src","assets/images/widget/help-mouse-single-click-left.svg","alt","A mouse with the left button being clicked."],["src","assets/images/widget/help-mouse-double-click-left.svg","alt","A mouse with the left button being double clicked."],["src","assets/images/widget/help-mouse-long-press-left.svg","alt","A mouse with the left button being held in for a long duration."],["src","assets/images/widget/help-keyboard-rotate.svg","alt","The arrow keys."],["src","assets/images/widget/help-keyboard-pan.svg","alt","The W, A, S and D keys."],["src","assets/images/widget/help-keyboard-zoom.svg","alt","The plus and minus keys grouped together or the E and C keys grouped together."],["src","assets/images/widget/help-keyboard-slow-motion.svg","alt","The shift key."],["src","assets/images/widget/help-trackpad-single-tap.svg","alt","A finger clicking the trackpad once."],["src","assets/images/widget/help-trackpad-double-tap.svg","alt","A finger clicking the trackpad twice."],["src","assets/images/widget/help-trackpad-long-press.svg","alt","A finger pressing for a long duration on the trackpad."],["src","assets/images/widget/help-trackpad-scroll.svg","alt","Two fingers pressing the trackpad while moving vertically."],["icon","plus","aria-hidden","true",1,"view-help__icon"],["icon","minus","aria-hidden","true",1,"view-help__icon"],["icon","location","aria-hidden","true",1,"view-help__icon"],["icon","arrows","aria-hidden","true",1,"view-help__icon"],["label","Keyboard Shortcuts","id","helpShortcuts","aria-controls","shortcutsPanel"],["role","tabpanel","aria-labelledby","helpShortcuts","tabindex","0","id","shortcutsPanel"]],template:function(e,t){1&e&&(j.Vb(0,"div",0,1),j.Vb(2,"h2",2),j.Kc(3,"Help"),j.Ub(),j.Vb(4,"button",3),j.cc("click",(function(){return t.handleCloseClick()})),j.Qb(5,"app-icon",4),j.Vb(6,"span",5),j.Kc(7,"Close help modal"),j.Ub(),j.Ub(),j.Vb(8,"div",6),j.Vb(9,"app-tabs",7),j.Vb(10,"app-tab",8),j.Vb(11,"div",9),j.Vb(12,"ul",10),j.Vb(13,"li",11),j.Vb(14,"div",12),j.Qb(15,"img",13),j.Ub(),j.Vb(16,"div",14),j.Kc(17,"Rotate"),j.Ub(),j.Kc(18," Click and drag or use one finger to change the viewing angle. "),j.Ub(),j.Vb(19,"li",11),j.Vb(20,"div",12),j.Qb(21,"img",15),j.Ub(),j.Vb(22,"div",14),j.Kc(23,"Pan"),j.Ub(),j.Kc(24," Hold the shift key and drag or use two fingers to move the model's position. "),j.Ub(),j.Vb(25,"li",11),j.Vb(26,"div",12),j.Qb(27,"img",16),j.Ub(),j.Vb(28,"div",14),j.Kc(29,"Zoom"),j.Ub(),j.Kc(30," Scroll up and down or pinch with two fingers to zoom in or out. "),j.Ub(),j.Vb(31,"li",11),j.Vb(32,"div",12),j.Qb(33,"img",17),j.Ub(),j.Vb(34,"div",14),j.Kc(35,"Explore the Anatomy"),j.Ub(),j.Kc(36," Click or tap an anatomic structure or label to learn more. "),j.Ub(),j.Ub(),j.Ub(),j.Ub(),j.Vb(37,"app-tab",18),j.Vb(38,"div",19),j.Vb(39,"h3",20),j.Kc(40,"Mouse"),j.Ub(),j.Vb(41,"ul",10),j.Vb(42,"li",11),j.Vb(43,"div",12),j.Qb(44,"img",21),j.Ub(),j.Kc(45," Hold left button to rotate "),j.Ub(),j.Vb(46,"li",11),j.Vb(47,"div",12),j.Qb(48,"img",22),j.Ub(),j.Kc(49," Hold right button to pan "),j.Ub(),j.Vb(50,"li",11),j.Vb(51,"div",12),j.Qb(52,"img",23),j.Ub(),j.Kc(53," Single-click left button to select a structure "),j.Ub(),j.Vb(54,"li",11),j.Vb(55,"div",12),j.Qb(56,"img",24),j.Ub(),j.Kc(57," Double-click left button to auto-focus on a structure "),j.Ub(),j.Vb(58,"li",11),j.Vb(59,"div",12),j.Qb(60,"img",25),j.Ub(),j.Kc(61," Long-click to fly to a structure "),j.Ub(),j.Ub(),j.Vb(62,"h3",20),j.Kc(63,"Keyboard"),j.Ub(),j.Vb(64,"ul",10),j.Vb(65,"li",11),j.Vb(66,"div",12),j.Qb(67,"img",26),j.Ub(),j.Kc(68," Rotate with arrows "),j.Ub(),j.Vb(69,"li",11),j.Vb(70,"div",12),j.Qb(71,"img",27),j.Ub(),j.Kc(72," Pan up (W), left (A), down (S), right(D) "),j.Ub(),j.Vb(73,"li",11),j.Vb(74,"div",12),j.Qb(75,"img",28),j.Ub(),j.Kc(76," Zoom out (-, C) and zoom in (+, E) "),j.Ub(),j.Vb(77,"li",11),j.Vb(78,"div",12),j.Qb(79,"img",29),j.Ub(),j.Kc(80," Hold with any previous key to slow down motion "),j.Ub(),j.Ub(),j.Vb(81,"h3",20),j.Kc(82,"Trackpad"),j.Ub(),j.Vb(83,"ul",10),j.Vb(84,"li",11),j.Vb(85,"div",12),j.Qb(86,"img",30),j.Ub(),j.Kc(87," Single-tap to auto-focus a structure "),j.Ub(),j.Vb(88,"li",11),j.Vb(89,"div",12),j.Qb(90,"img",31),j.Ub(),j.Kc(91," Double-tap to select a structure "),j.Ub(),j.Vb(92,"li",11),j.Vb(93,"div",12),j.Qb(94,"img",32),j.Ub(),j.Kc(95," Long-press to fly to a structure "),j.Ub(),j.Vb(96,"li",11),j.Vb(97,"div",12),j.Qb(98,"img",33),j.Ub(),j.Kc(99," Scroll up and down to zoom "),j.Ub(),j.Ub(),j.Vb(100,"h3",20),j.Kc(101,"In-App"),j.Ub(),j.Vb(102,"ul",10),j.Vb(103,"li",11),j.Qb(104,"app-icon",34),j.Vb(105,"span",5),j.Kc(106," The plus symbol, which represents zooming in in the camera control menu. "),j.Ub(),j.Kc(107," Zoom in "),j.Ub(),j.Vb(108,"li",11),j.Qb(109,"app-icon",35),j.Vb(110,"span",5),j.Kc(111," The minus symbol, which represents zooming out in the camera control menu. "),j.Ub(),j.Kc(112," Zoom out "),j.Ub(),j.Vb(113,"li",11),j.Qb(114,"app-icon",36),j.Vb(115,"span",5),j.Kc(116," The map pin symbol, which resets the camera in the camera control menu. "),j.Ub(),j.Kc(117," Recenter 3D Model "),j.Ub(),j.Vb(118,"li",11),j.Qb(119,"app-icon",37),j.Vb(120,"span",5),j.Kc(121," Arrows pointing in four directions, which represents panning in the camera control menu. "),j.Ub(),j.Kc(122," Pan "),j.Ub(),j.Ub(),j.Ub(),j.Ub(),j.Vb(123,"app-tab",38),j.Vb(124,"div",39),j.Qb(125,"app-view-shortcuts"),j.Ub(),j.Ub(),j.Ub(),j.Ub(),j.Ub()),2&e&&(j.Db(9),j.lc("activeTab",t.activeTab))},directives:[vp,zp,wp,Np],styles:[".text-8{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-28{font-size:28px;letter-spacing:.7px;line-height:1.4em}.text-28.text-uppercase{font-size:28px;letter-spacing:1.68px;line-height:1.25em;text-transform:uppercase}.text-header{font-weight:700}.text--code{font-family:Courier New,Courier,monospace}.text-uppercase{text-transform:uppercase}.text-xlight{font-weight:200}.text-light{font-weight:300}.text-medium{font-weight:500}.text-semibold{font-weight:600}.text-bold{font-weight:700}.text-underline{text-decoration:underline}.text-italic{font-style:italic}.text-bright{color:#fff}.text-dim{color:#96a8c0}.text-error{color:#ed4758}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.text-ellipsis{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link,.text-link:visited{color:inherit;cursor:pointer}.text-link:not(.text-underline),.text-link:visited:not(.text-underline){text-decoration:none}.text-success{color:#38de38}.text-danger{color:#de3535}.text-info{color:#2d72dc}.text-nowrap{white-space:nowrap}.text-pre-line{white-space:pre-line}.view-help{background-color:rgba(16,24,35,.9);color:#fff;display:flex;align-items:center;flex-direction:column;position:fixed;top:0;left:0;right:0;z-index:10000;height:100vh;height:calc(var(--vh, 1vh) * 100);max-height:100vh;overflow:auto}.view-help__inner{width:100%;max-width:1140px;height:99vh;height:calc(var(--vh, 1vh) * 99);padding:32px;position:relative}.view-help__close{color:#fff;width:40px;height:40px;display:flex;align-items:center;justify-content:center;position:fixed;right:8px;top:8px;z-index:10;border:none;background:none}.view-help__header{font-size:14px;letter-spacing:.84px}.view-help__header,.view-help__section-header{line-height:1.25em;text-transform:uppercase;font-weight:600;padding-bottom:12px;margin-top:32px}.view-help__section-header{font-size:12px;letter-spacing:.72px;border-bottom:1px solid hsla(0,0%,100%,.3)}.view-help__label{font-size:14px;letter-spacing:.35px;line-height:1.4em;font-weight:600;margin-bottom:12px}.view-help__group{display:flex;justify-content:space-around;flex-wrap:wrap}.view-help__item{font-size:12px;letter-spacing:.3px;line-height:1.4em;display:flex;flex-flow:column;text-align:center;padding:20px;flex:0 1 180px}.view-help__image{justify-content:center;margin-bottom:16px;width:160px;height:100px}.view-help__icon{font-size:24px;margin-bottom:16px}"],encapsulation:2,changeDetection:0}),function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);r>3&&a&&Object.defineProperty(t,n,a)}([Object(L.d)(hs.getCanTouch),Bp("design:type",J.a)],Fp.prototype,"canTouch$",void 0),Fp),qp=r("u47x"),$p=function(e,t,n,i){return new(n||(n=Promise))((function(o,r){function a(e){try{c(i.next(e))}catch(t){r(t)}}function s(e){try{c(i.throw(e))}catch(t){r(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))},Wp=((Rp=function(){function e(t,n,i,o,r,a,s,c){y(this,e),this.dialog=t,this.store=n,this.location=i,this.transitionService=o,this.engineService=r,this.layoutService=a,this.pendoService=s,this.liveAnnouncer=c}return v(e,[{key:"initStory",value:function(e,t,n){var i=this,o="preview"===e;this.store.dispatch(new hl(e,t,o)),this.store.dispatch(new Je(e,t,!0));var r=this.store.select(zs.getReady),a=this.store.select(Ic.getIncomingStoryInfo);Object(zc.b)([r,a]).pipe(Object(Y.a)((function(e){var t=d(e,2),n=t[0],i=t[1];return n&&!!i.id})),Object(Tc.a)(1)).subscribe((function(){i.store.dispatch(new si),i.store.dispatch(new qe(e,t,n,o))}))}},{key:"nextChapter",value:function(e){var t=this.store.selectSnapshot(vs.getSelectedChapterIndex),n=this.store.selectSnapshot(vs.getStoryChapters);this.pendoService.trackOncePerSession(xe.DiscoveredChapterNav,{source:e,breakpoint:this.store.selectSnapshot(tl.getBreakpointLabel)});var i=n[t+1];i&&this.selectChapter(i)}},{key:"previousChapter",value:function(e){var t=this.store.selectSnapshot(vs.getSelectedChapterIndex),n=this.store.selectSnapshot(vs.getStoryChapters);this.pendoService.trackOncePerSession(xe.DiscoveredChapterNav,{source:e,breakpoint:this.store.selectSnapshot(tl.getBreakpointLabel)});var i=n[t-1];i&&this.selectChapter(i)}},{key:"selectChapter",value:function(e){return $p(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,i,o,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.store.selectSnapshot(rr.getQuizModeActive)){t.next=8;break}if(n=this.store.selectSnapshot(vs.getSelectedChapterId),i=e.id,o=this.store.selectSnapshot(vs.getStoryChapters),r=this.transitionService.searchChapterTransitions(n,i,o),this.pendoService.trackOncePerSession(xe.DiscoveredChapterNav,{source:"Chapter List",breakpoint:this.store.selectSnapshot(tl.getBreakpointLabel)}),t.t0=r,!t.t0){t.next=7;break}return t.next=7,this.chapterTransition(r);case 7:this.store.dispatch([new Ye(e.id),new si(e)]);case 8:case"end":return t.stop()}}),t,this)})))}},{key:"chapterTransition",value:function(e){var t=this;return new Promise((function(n){e.camera&&t.store.dispatch(new zn(e.camera,!0,e.duration)),e.fadeColor&&t.store.dispatch(new yt(e.fadeColor,e.duration)),setTimeout((function(){n(!0)}),1e3*e.duration)}))}},{key:"hideSelectedStructures",value:function(){var e=this.store.selectSnapshot(jo.getCheckedNodeIds);this.store.dispatch(new Yi.UpdateNodesShown(!1,e))}},{key:"selectTool",value:function(e){this.store.selectSnapshot(rr.getQuizModeActive)&&e===ks.Select&&(e=ks.Quiz),this.store.dispatch(new Et(e))}},{key:"toggleColumn",value:function(e){var t=this.store.selectSnapshot(hs.getUI);t.column.status=(e=null==e?!(t.column.status===ba.Show):e)?ba.Show:ba.Collapse,this.store.dispatch(new _.SetUI(t))}},{key:"togglePresentation",value:function(){this.store.selectSnapshot(hs.getPresentationActive)?this.stopPresentation():this.startPresentation()}},{key:"startPresentation",value:function(){this.store.dispatch(new _.TogglePresentation(!0))}},{key:"stopPresentation",value:function(){this.store.dispatch(new _.TogglePresentation(!1))}},{key:"toggleHelp",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ee.Basics;0===this.dialog.openDialogs.length&&this.dialog.open(Qp,{maxWidth:"100vw",maxHeight:"100vh",height:"100%",width:"100%",data:{tab:e}})}},{key:"toggleInteract",value:function(e){this.store.dispatch(new _.ToggleWindow(Ea.Interact,e))}},{key:"toggleOnDemand",value:function(e){this.store.dispatch(new _.SetOnDemand(e)),this.store.dispatch(new _.ToggleWindow(Ea.OnDemand,e))}},{key:"toggleTutorial",value:function(e){this.store.dispatch(new _.ToggleWindow(Ea.Tutorial,e)),e&&this.store.dispatch(new _.StartTutorial(!0))}},{key:"toggleWhiteboard",value:function(e){this.store.dispatch(new _.ToggleWindow(Ea.Whiteboard,e)),e&&(this.store.dispatch(new At(!1)),this.store.dispatch(new _.SetWhiteboardEnabled(!0)))}},{key:"showLabels",value:function(e){var t=this.store.selectSnapshot(hs.getUI);e=Object(ie.isNil)(e)?!t.labels.shown:e,t.labels.shown=e,this.store.dispatch(new _.SetUI(t))}},{key:"toggleLabels",value:function(e){this.store.dispatch(new Lt(e))}},{key:"toggleSearch",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:cs.List,t=arguments.length>1?arguments[1]:void 0;this.store.selectSnapshot(tl.getBreakpoint);var n=this.store.selectSnapshot(hs.getUI);n.search.status=(t=null==t?!(n.search.status===ba.Show):t)?ba.Show:ba.Hide,t&&(n.nodeInfo.status=ba.Hide),this.store.dispatch(new _.SetSearchDisplayMode(e)),this.store.dispatch(new _.SetUI(n))}},{key:"toggleNodeInfo",value:function(e){this.toggleInfoLayout("nodeInfo",e)}},{key:"toggleLabelInfo",value:function(e){this.toggleInfoLayout("labelInfo",e)}},{key:"toggleInfoLayout",value:function(e,t){var n=this.store.selectSnapshot(hs.getUI);(t=null==t?n[e].status===ba.Hide:t)?(n[e].status=ba.Show,["nodeInfo","labelInfo"].filter((function(t){return t!==e})).forEach((function(e){return n[e].status=ba.Hide}))):n[e].status=ba.Hide,this.store.dispatch(new _.SetUI(n))}},{key:"delegateNodeClick",value:function(e,t){if(this.clearSelectedLabel(),e||t.srcEvent.shiftKey)if(t.srcEvent.shiftKey||this.store.selectSnapshot(hs.getMultiPickModeEnabled))this.checkNode(e);else switch(this.store.selectSnapshot(zs.getActiveTool)){case ks.Hide:this.hideNode(e);break;case ks.Select:this.selectNode(e);break;case ks.Isolate:this.isolateNode(e);break;case ks.Fade:this.fadeNode(e)}else this.clearSelectedNodes()}},{key:"clearSelectedLabel",value:function(){this.store.dispatch(new sa)}},{key:"clearSelectedNodes",value:function(){this.store.dispatch(new Yi.UpdateNodeSelected),this.store.dispatch(new Yi.UpdateNodesChecked(!1))}},{key:"clearFadedNodes",value:function(){var e=this.store.selectSnapshot(vs.getSelectedChapterId);this.store.dispatch(new eo.UndoAll(e))}},{key:"checkNode",value:function(e,t){void 0!==e&&(null==t&&(t=this.store.selectSnapshot(jo.getNodes)[e.id].checked),this.store.dispatch(new Yi.UpdateNodesChecked(!t,[e.id])),this.store.dispatch(new Yi.UpdateNodeSelected(e.id)))}},{key:"fadeNode",value:function(e){this.store.dispatch(new Yi.UpdateNodesPaint(Io,[e.id]))}},{key:"isolateNode",value:function(e){this.store.dispatch(new Yi.UpdateNodesShown(!1)),this.store.dispatch(new Yi.UpdateNodesShown(!0,[e.id]))}},{key:"selectNode",value:function(e){var t=!this.store.selectSnapshot(jo.getNodes)[e.id].checked;this.store.dispatch(new Yi.UpdateNodesChecked(!1)),t&&(this.store.dispatch(new Yi.UpdateNodesChecked(!0,[e.id])),this.store.dispatch(new Yi.UpdateNodeSelected(e.id))),this.store.dispatch(new Yt(e));var n=this.store.selectSnapshot(hs.getNodeInfoFallback),i=this.store.selectSnapshot(hs.getViewLanguage);this.store.dispatch(new an(e,n,i))}},{key:"hideNode",value:function(e){this.store.dispatch(new Yi.UpdateNodesShown(!1,[e.id])),this.store.dispatch(new Yi.UpdateNodesChecked(!1))}},{key:"selectLabel",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e.objectId,i=e.states;this.store.dispatch(new sa(e)),t&&n&&0===i.length&&this.store.dispatch(new Pt(n,!0))}},{key:"initChapter",value:function(e){return $p(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=this.engineService.createViewGraph({},!1),this.store.dispatch(new Ot(n)),this.store.selectSnapshot(ws.getChapterCameraEnabled)&&this.store.dispatch(new zn(e.camera.location,e.camera.action===Qc.FlyTo,void 0,e.camera.rotationCenter));case 2:case"end":return t.stop()}}),t,this)})))}},{key:"playChapterFromStart",value:function(){this.store.dispatch(new Bt)}},{key:"resetCamera",value:function(){var e=this.store.selectSnapshot(vs.getSelectedChapter);e&&this.store.dispatch(new zn(e.camera.location))}},{key:"resetChapter",value:function(){var e=this;this.resetCamera();var t=this.store.selectSnapshot(vs.getSelectedChapterId);this.store.dispatch(new eo.UndoAll(t)).subscribe((function(){e.liveAnnouncer.announce("reset complete")})),this.store.dispatch(new Yi.UpdateNodesChecked(!1)),this.store.dispatch(new na)}},{key:"resetLayout",value:function(){var e=this.store.selectSnapshot(hs).ui;this.layoutService.isUIHidden()?Object.keys(e).forEach((function(t){e[t].status=ba.Hide})):(Object.keys(e).forEach((function(t){e[t].status=ba.Show})),e.search.status=ba.Hide,e.tools.status=ba.Hide,e.nodeInfo.status=ba.Hide,e.labelInfo.status=ba.Hide,e.media.status=ba.Hide,e.visibilityLayers.status=ba.Hide),this.store.dispatch(new _.SetUI(e))}},{key:"undo",value:function(){var e=this;this.store.dispatch(new eo.Undo(this.store.selectSnapshot(vs.getSelectedChapterId))).subscribe((function(){e.liveAnnouncer.announce("undo complete")}))}},{key:"redo",value:function(){var e=this;this.store.dispatch(new eo.Redo(this.store.selectSnapshot(vs.getSelectedChapterId))).subscribe((function(){e.liveAnnouncer.announce("redo complete")}))}},{key:"toggleAnimation",value:function(){var e=!this.store.selectSnapshot(zs.getAnimationPlaying);this.store.dispatch(new At(e))}},{key:"toggleAudio",value:function(){var e=this.store.selectSnapshot(zs.getPlayAudio);this.store.dispatch(new Nt(!e))}},{key:"toggleToolbar",value:function(e){var t=this.store.selectSnapshot(hs.getUI);t.media.status=ba.Hide,t.tools.status=ba.Hide,t.toolbar.status=ba.Hide,t.visibilityLayers.status=ba.Hide,"none"!==e?t[e].status=ba.Show:this.selectTool(ks.Select),this.store.dispatch(new _.SetUI(t))}},{key:"closeToolbar",value:function(){var e=this.store.selectSnapshot(hs.getUI);e.media.status=ba.Hide,e.tools.status=ba.Hide,e.visibilityLayers.status=ba.Hide,this.selectTool(ks.Select),this.store.dispatch(new _.SetUI(e))}},{key:"normalizeQueryParams",value:function(e){var t=Object.assign({},e);return{id:Lc(t),type:Ec(t),lang:e.lang}}},{key:"sanitizeRouteId",value:function(e){return e=e.replace(/\.json$/,""),this.location.replaceState("view","?id="+e),e}},{key:"openInNewTab",value:function(){var e=window.document.location.href;window.open(e)}},{key:"getComputedTransform",value:function(e){var t=getComputedStyle(e).transform.replace("matrix3d","").replace("matrix","").replace("(","").replace(")","").split(",").map((function(e){return e.trim()})).map((function(e){return parseInt(e,10)})),n=16===t.length?t[12]:t[4],i=16===t.length?t[13]:t[5];return Number.isNaN(n)||Number.isNaN(i)?null:{x:n,y:i}}},{key:"inferDrawerMode",value:function(e){var t=Uc.Content;return e.nodeInfo.status===ba.Show?t=Uc.NodeInfo:e.labelInfo.status===ba.Show&&(t=Uc.LabelInfo),t}},{key:"setUI",value:function(e){var t,n=null!==(t=e.baseUIConfig)&&void 0!==t?t:new Zl;n=ip(n,e.apiUIConfig),n=ip(n,e.urlUIConfig),n=ip(n,e.chapterUIConfig),e.quizUIConfig&&(n=ip(n,e.quizUIConfig,!0));var i=op(this.store.selectSnapshot(hs.getUI),n);this.store.dispatch(new _.SetUI(i))}},{key:"setViewLanguage",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"en";this.store.dispatch(new _.SetViewLanguage(e))}},{key:"setAnatomyDescriptionFallback",value:function(e){this.store.dispatch(new _.SetNodeInfoConfig(e))}}]),e}()).\u0275fac=function(e){return new(e||Rp)(j.Zb(ap.b),j.Zb(L.g),j.Zb(we.g),j.Zb(Hc),j.Zb(Sn),j.Zb(pl),j.Zb(Oe),j.Zb(qp.i))},Rp.\u0275prov=j.Lb({token:Rp,factory:Rp.\u0275fac,providedIn:"root"}),Rp),Kp=((Ap=function(){function e(t){y(this,e),this.viewService=t}return v(e,[{key:"initialize",value:function(){var e=this;window.BDGlobalActions={toggleTutorial:function(t){return e.viewService.toggleTutorial(t)}}}}]),e}()).\u0275fac=function(e){return new(e||Ap)(j.Zb(Wp))},Ap.\u0275prov=j.Lb({token:Ap,factory:Ap.\u0275fac,providedIn:"root"}),Ap),Gp=r("Kj3r"),Zp=r("OsX3"),Jp=r("3UWI");function Xp(e,t){return e.dispatch(new kt(!1)),t.fireEvent(yn.SceneXrayDisabled,void 0),!0}var Yp,eu=r("yLV6"),tu=function(){function e(t){y(this,e),this.ngUnsubsribe=new Z.a,this.store=t,this.listenForParticleChanges(),this.listenForLookupChanges()}return v(e,[{key:"destroy",value:function(){this.ngUnsubsribe.next(),this.ngUnsubsribe.complete()}},{key:"listenForLookupChanges",value:function(){var e=this;this.store.select(Ro.getTweenParticleLookup).pipe(Object(X.a)(this.ngUnsubsribe)).subscribe((function(t){Object(ie.isEmpty)(t)||Oo.refreshEngineLookup(e.store.selectSnapshot(Ic.getStoryId),t)}))}},{key:"listenForParticleChanges",value:function(){var e=this,t=this.store.select(Ro.getParticleSystems),n=this.store.select(Ro.getVisisbleParticleSystems);Object(Ca.a)(t,n).pipe(Object(X.a)(this.ngUnsubsribe)).subscribe((function(){var t=e.store.selectSnapshot(vs.getSelectedChapterId),n=e.store.selectSnapshot(Ro.particleSystemsForChapter(t)),i=e.store.selectSnapshot(Ro.getVisibleParticleSystesmForChapter(t)),o=n.filter((function(e){return i.includes(e.id)}));e.setEngineParticles(o)}))}},{key:"setEngineParticles",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];Human.particles.disableAll(),Human.particles.resetAll();var t=JSON.parse(JSON.stringify(e));Human.particles.parse(t,(function(){e.forEach((function(e){Human.particles.enable(e.id)})),null!=Human.timeline.activeRoot&&(Human.timeline.activeRoot._nowBranch.particleSystems=e.map((function(e){return e.id})))}))}}]),e}();(Yp||(Yp={})).getColorRecipe=function(e,t){var n=e.scene.objects[t];if(n instanceof e.scene.Object){var i=n.getProperties();return{tintColor:Object(ie.get)(i,"tintColor")?i.tintColor:[1,1,1],brightness:i.brightness,saturation:i.saturation,contrast:i.contrast,opacity:i.opacity}}return null};var nu,iu,ou,ru=((nu=function(){function e(t,n,i){y(this,e),this.store=t,this.graphService=n,this.engineService=i,this.highlightDisabled=!1}return v(e,[{key:"colorObject",value:function(e,t){var n=t.tintColor,i=t.saturation,o=t.brightness,r=t.contrast,a=t.opacity,s=Human.scene.objects[e];s instanceof Human.scene.Object&&(Object(ie.isNil)(n)||s.setTintColor(n),Object(ie.isNil)(i)||s.setSaturation(i),Object(ie.isNil)(o)||s.setBrightness(o),Object(ie.isNil)(r)||s.setContrast(r),Object(ie.isNil)(a)||s.setOpacity(a))}},{key:"getColor",value:function(e){return Yp.getColorRecipe(Human,e)}},{key:"uncolorObject",value:function(e){var t=Human.scene.objects[e];t instanceof Human.scene.Object&&(t.clearColorModifiers(),t.clearOpacityModifiers())}},{key:"unpaint",value:function(e){var t=this,n=this.store.selectSnapshot(zs.getViewGraph);this.graphService.getLeafDescendants(n,e.id).forEach((function(e){t.engineService.getObjects(e).forEach((function(e){var t=Human.scene.objects[e];t instanceof Human.scene.Object&&(t.clearColorModProperties(),t.clearOpacityModProperties())}))}))}},{key:"paint",value:function(e,t){var n=this,i=this.store.selectSnapshot(zs.getViewGraph),o=ko.toEngine(t);this.graphService.getLeafDescendants(i,e).forEach((function(e){n.engineService.getObjects(e).forEach((function(e){n.colorObject(e,o)}))}))}},{key:"highlight",value:function(e,t){var n=this;if(!1===this.highlightDisabled||!1===t){var i=this.store.selectSnapshot(zs.getViewGraph);this.graphService.getLeafDescendants(i,e).forEach((function(e){n.engineService.getObjects(e).forEach((function(e){var n=Human.scene.objects[e];n instanceof Human.scene.Object&&n.setHighlight(t)}))}))}}},{key:"xRay",value:function(e,t){Human.scene.objects[e.id].setXRay(t)}},{key:"paintAll",value:function(e,t){var n=this;e.forEach((function(e){return n.paint(e,t)}))}},{key:"unpaintAll",value:function(e){var t=this;e.forEach((function(e){t.unpaint(e)}))}},{key:"highlightAll",value:function(e,t){var n=this;e.forEach((function(e){return n.highlight(e,t)}))}},{key:"disableHighlight",value:function(){this.highlightDisabled=!0}},{key:"enableHighlight",value:function(){this.highlightDisabled=!1}},{key:"setHighlightColor",value:function(e){Human.renderer.highlightColor=p(e)}}]),e}()).\u0275fac=function(e){return new(e||nu)(j.Zb(L.g),j.Zb(mn),j.Zb(Sn))},nu.\u0275prov=j.Lb({token:nu,factory:nu.\u0275fac,providedIn:"root"}),nu),au=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},su=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},cu=((iu=function(){function e(t){y(this,e),this.store=t,this.currentLayers=[],this.nodesLayerIndex=0,this.objectsLayerIndex=0,this.nodeChapterOpacities={}}return v(e,[{key:"initObservables",value:function(){var e=this;this.selectedChapterId$.pipe(Object(Y.a)((function(e){return!Object(ie.isNil)(e)}))).subscribe((function(t){e.selectedChapterId=t,e.updateNodeChapterOpacities()})),this.selectedChapterCurrentLayers$.subscribe((function(t){e.currentLayers=t,e.nodesLayerIndex=e.objectsLayerIndex=e.store.selectSnapshot(vs.getSelectedChapterCurrentLayersIndex)})),Object(zc.b)([this.selectedChapterCurrentLayersIndex$,this.selectedChapterCurrentLayersPosition$]).pipe(Object(Y.a)((function(e){var t=d(e,2),n=t[0],i=t[1];return!Object(ie.isNil)(n)&&!Object(ie.isNil)(i)}))).subscribe((function(t){var n=d(t,2),i=n[0],o=n[1];e.synchronizeScene(i,o,!0)}))}},{key:"recordLayerIndexPosition",value:function(e,t){this.store.dispatch(new zi(this.selectedChapterId,e,t,!0))}},{key:"synchronizeScene",value:function(e,t,n){this.updateLayerIndex(e,this.currentLayers,n),this.updateLayerPosition(t,this.currentLayers,n)}},{key:"fractionToIndex",value:function(e){var t=this.getThreshold(),n=Math.floor(e/t);return Math.min(this.currentLayers.length-2,n)}},{key:"fractionToPosition",value:function(e,t){var n=this.getThreshold();return Math.max(0,Math.min((e-n*t)/n,1))}},{key:"indexPositionToFraction",value:function(e,t){var n=this.getThreshold();return e*n+t*n}},{key:"getThreshold",value:function(){return this.currentLayers.length>1?1/(this.currentLayers.length-1):1}},{key:"getCurrentLayerIndexProp",value:function(e){return e?"nodesLayerIndex":"objectsLayerIndex"}},{key:"updateLayerIndex",value:function(e,t,n){var i=this.getCurrentLayerIndexProp(n);e!==this[i]&&(this.restoreLayers(e,this[i],t,n),n&&(this.nodesLayerIndex=e),this.objectsLayerIndex=e)}},{key:"updateLayerPosition",value:function(e,t,n){var i=this.getCurrentLayerIndexProp(n);this.setObjectsOpacity(t[this[i]].objectIds,1-e)}},{key:"restoreLayers",value:function(e,t,n,i){for(var o=(e-t)/Math.abs(e-t),r=[],a=t;a!==e;)r=r.concat(n[a].objectIds),a+=o;var s=-1===o;this.setObjectsOpacity(r,1===o?0:1),i?this.setNodesShown(r,s):this.setObjectsShown(r,s),-1===o&&(i?this.setNodesShown(n[e].objectIds,!0):this.setObjectsShown(n[e].objectIds,!0))}},{key:"setObjectsOpacity",value:function(e,t){for(var n=0;n<e.length;n++){var i=e[n],o=this.nodeChapterOpacities[i],r=void 0;this.isFresnelOpacity(o)?((r=o.slice())[0]=t*o[0],r[1]=t*o[1]):r=t*o,Human.scene.objects[i].setOpacity(r)}}},{key:"updateNodeChapterOpacities",value:function(){var e=this,t=this.store.selectSnapshot(jo.getAllNodeState)[this.selectedChapterId];this.nodeChapterOpacities={},Object.entries(t).forEach((function(t){var n=d(t,2),i=n[0],o=n[1];if(e.nodeChapterOpacities[i]=1,o.paint&&o.paint.hasOwnProperty("opacity")){var r=ko.toEngine(o.paint);(e.isFresnelOpacity(r.opacity)||e.isScalarOpacity(r.opacity))&&(e.nodeChapterOpacities[i]=r.opacity)}}))}},{key:"isScalarOpacity",value:function(e){return"number"==typeof e}},{key:"isFresnelOpacity",value:function(e){return Array.isArray(e)}},{key:"setObjectsShown",value:function(e,t){for(var n={},i=0;i<e.length;i++)n[e[i]]=t;Human.scene.setEnabledObjects({objects:n})}},{key:"setNodesShown",value:function(e,t){this.store.dispatch(new Yi.UpdateNodesShown(t,e,void 0,!1))}}]),e}()).\u0275fac=function(e){return new(e||iu)(j.Zb(L.g))},iu.\u0275prov=j.Lb({token:iu,factory:iu.\u0275fac,providedIn:"root"}),au([Object(L.d)(vs.getSelectedChapterCurrentLayers),su("design:type",J.a)],iu.prototype,"selectedChapterCurrentLayers$",void 0),au([Object(L.d)(vs.getSelectedChapterCurrentLayersIndex),su("design:type",J.a)],iu.prototype,"selectedChapterCurrentLayersIndex$",void 0),au([Object(L.d)(vs.getSelectedChapterCurrentLayersPosition),su("design:type",J.a)],iu.prototype,"selectedChapterCurrentLayersPosition$",void 0),au([Object(L.d)(vs.getSelectedChapterId),su("design:type",J.a)],iu.prototype,"selectedChapterId$",void 0),iu),lu=r("HlzF"),pu=new RegExp("^/media/audio/(.*)/.*$"),uu=((ou=function(){function e(){y(this,e),this.audioPlayers=new Map}return v(e,[{key:"createAudioUploadEvent",value:function(e){return{type:"uploadFile",url:"/ws/media/audio/upload",method:"POST",file:e}}},{key:"getAudioClips",value:function(e){return Object.values(e).filter((function(e){return"audio"===e.data.streamType}))}},{key:"createAudioClip",value:function(e,t,n){var i=Human.timeline.branchTimelines[e.id],o=this.getAudioUUID(t);return[o,{data:{clipId:o,streamType:"audio",fullUrl:t,time1:i.timeRange.firstTime,time2:i.timeRange.lastTime,lang:n}}]}},{key:"getAudioSrc",value:function(e){return e.match("/media/audio")||(e="/content/states/"+e),e}},{key:"getAudioPlayer",value:function(e){return this.audioPlayers.get(e)}},{key:"addAudioPlayer",value:function(e){this.removeAudioPlayer(e),e=this.getAudioSrc(e);var t=new lu.Howl({src:[e]});return this.audioPlayers.set(e,t),t}},{key:"removeAudioPlayer",value:function(e){var t=this.audioPlayers.get(e);t&&(t.unload(),this.audioPlayers.delete(e))}},{key:"stopAudio",value:function(){this.audioPlayers.forEach((function(e){e.stop()}))}},{key:"getAudioUUID",value:function(e){return e.match(pu)[1]}}]),e}()).\u0275fac=function(e){return new(e||ou)},ou.\u0275prov=j.Lb({token:ou,factory:ou.\u0275fac,providedIn:"root"}),ou),du=r("R0Ic");function gu(e,t){1&e&&j.Qb(0,"img",9)}function hu(e,t){1&e&&j.Qb(0,"img",9)}function fu(e,t){1&e&&j.Qb(0,"img",10)}function bu(e,t){1&e&&j.Qb(0,"img",11)}function mu(e,t){if(1&e&&(j.Tb(0),j.Ic(1,gu,1,0,"img",6),j.Ic(2,hu,1,0,"img",6),j.Ic(3,fu,1,0,"img",7),j.Ic(4,bu,1,0,"img",8),j.Sb()),2&e){var n=j.gc();j.Db(1),j.lc("ngIf",n.label.pinType==n.labelPinType.Default),j.Db(1),j.lc("ngIf",n.label.pinType==n.labelPinType.Sequential),j.Db(1),j.lc("ngIf",n.label.pinType===n.labelPinType.Plus||n.label.pinType===n.labelPinType.PlusMinus&&!n.selected),j.Db(1),j.lc("ngIf",n.label.pinType===n.labelPinType.Minus||n.label.pinType===n.labelPinType.PlusMinus&&n.selected)}}function vu(e,t){1&e&&j.Qb(0,"img",15)}function yu(e,t){1&e&&j.Qb(0,"img",15)}function xu(e,t){1&e&&j.Qb(0,"img",16)}function Ou(e,t){1&e&&j.Qb(0,"img",17)}function wu(e,t){if(1&e&&(j.Ic(0,vu,1,0,"img",12),j.Ic(1,yu,1,0,"img",12),j.Ic(2,xu,1,0,"img",13),j.Ic(3,Ou,1,0,"img",14)),2&e){var n=j.gc();j.lc("ngIf",n.label.pinType==n.labelPinType.Default),j.Db(1),j.lc("ngIf",n.label.pinType==n.labelPinType.Sequential),j.Db(1),j.lc("ngIf",n.label.pinType===n.labelPinType.Plus||n.label.pinType===n.labelPinType.PlusMinus&&!n.selected),j.Db(1),j.lc("ngIf",n.label.pinType===n.labelPinType.Minus||n.label.pinType===n.labelPinType.PlusMinus&&n.selected)}}var ku=function(e,t){return{"label-pin__text--white":e,"label-pin__text--black":t}};function Cu(e,t){if(1&e&&(j.Tb(0),j.Vb(1,"div",18),j.Kc(2),j.Ub(),j.Sb()),2&e){var n=j.gc();j.Db(1),j.lc("ngClass",j.oc(2,ku,n.labelTheme===n.labelThemeEnum.StudioNext,n.labelTheme===n.labelThemeEnum.Annotation)),j.Db(1),j.Mc(" ",n.sequence," ")}}var Su,_u,ju=function(e,t,n,i){return{"label-pin--light":e,"label-pin--dark":t,"label-pin--none":n,"label-pin--selected":i}},Pu=((_u=function e(){y(this,e),this.labelPinType=Ai,this.labelThemeEnum=Ri,this.labelTheme=Ri.StudioNext,this.selected=!1}).\u0275fac=function(e){return new(e||_u)},_u.\u0275cmp=j.Jb({type:_u,selectors:[["app-label-pin"]],inputs:{label:"label",labelTheme:"labelTheme",selected:"selected",sequence:"sequence"},decls:7,vars:9,consts:[[1,"label-pin",3,"ngClass"],["pin",""],[4,"ngIf","ngIfElse"],["lightPins",""],[4,"ngIf"],[1,"label__glow"],["draggable","false","alt","","src","./assets/images/labels/circle-dark.svg","class","label-pin__image",4,"ngIf"],["draggable","false","alt","","src","./assets/images/labels/circle-plus-dark.svg","class","label-pin__image",4,"ngIf"],["draggable","false","alt","","src","./assets/images/labels/circle-minus-dark.svg","class","label-pin__image",4,"ngIf"],["draggable","false","alt","","src","./assets/images/labels/circle-dark.svg",1,"label-pin__image"],["draggable","false","alt","","src","./assets/images/labels/circle-plus-dark.svg",1,"label-pin__image"],["draggable","false","alt","","src","./assets/images/labels/circle-minus-dark.svg",1,"label-pin__image"],["draggable","false","alt","","src","./assets/images/labels/circle.svg","class","label-pin__image",4,"ngIf"],["draggable","false","alt","","src","./assets/images/labels/circle-plus.svg","class","label-pin__image",4,"ngIf"],["draggable","false","alt","","src","./assets/images/labels/circle-minus.svg","class","label-pin__image",4,"ngIf"],["draggable","false","alt","","src","./assets/images/labels/circle.svg",1,"label-pin__image"],["draggable","false","alt","","src","./assets/images/labels/circle-plus.svg",1,"label-pin__image"],["draggable","false","alt","","src","./assets/images/labels/circle-minus.svg",1,"label-pin__image"],[1,"label-pin__text",3,"ngClass"]],template:function(e,t){if(1&e&&(j.Vb(0,"div",0,1),j.Ic(2,mu,5,4,"ng-container",2),j.Ic(3,wu,4,4,"ng-template",null,3,j.Jc),j.Ic(5,Cu,3,5,"ng-container",4),j.Qb(6,"div",5),j.Ub()),2&e){var n=j.tc(4);j.lc("ngClass",j.qc(4,ju,t.labelTheme===t.labelThemeEnum.StudioNext,t.labelTheme===t.labelThemeEnum.Annotation,t.label.pinType===t.labelPinType.None,t.selected)),j.Db(2),j.lc("ngIf",t.labelTheme===t.labelThemeEnum.Annotation)("ngIfElse",n),j.Db(3),j.lc("ngIf",t.label.pinType===t.labelPinType.Sequential)}},directives:[we.i,we.l],styles:['.label-pin[_ngcontent-%COMP%]{display:inline-flex;align-items:center;justify-content:center;position:relative;transition:background-color .12s;z-index:10}.label-pin__text[_ngcontent-%COMP%]{display:flex;z-index:10;justify-content:center;align-items:center;font-size:10px!important;color:#101823}.label-pin[_ngcontent-%COMP%]:before, .label-pin__text[_ngcontent-%COMP%]{position:absolute;left:0;top:0;width:100%;height:100%}.label-pin[_ngcontent-%COMP%]:before{content:" ";background-color:transparent;border:2px solid transparent;border-radius:50%;box-sizing:border-box;display:block;z-index:-2}.label-pin--light.label-pin--selected[_ngcontent-%COMP%]:before{background-color:#fff;border-color:#2d72dc;box-shadow:0 0 0 1px rgba(45,114,220,.7)}.label-pin--light.label-pin[_ngcontent-%COMP%]   .label-pin__text[_ngcontent-%COMP%]{color:#101823}.label-pin--dark.label-pin[_ngcontent-%COMP%]:before{background-color:rgba(0,0,0,.75)}.label-pin--dark.label-pin--selected[_ngcontent-%COMP%]:after, .label-pin--dark.label-pin--selected[_ngcontent-%COMP%]:before{background-color:#2d72dc}.label-pin--dark.label-pin[_ngcontent-%COMP%]   .label-pin__text[_ngcontent-%COMP%]{color:#fff}.label-pin--none.label-pin[_ngcontent-%COMP%]{display:none}'],changeDetection:0}),_u),Mu=((Su=function(){function e(){y(this,e)}return v(e,[{key:"onClick",value:function(e){e.stopPropagation(),e.stopImmediatePropagation()}},{key:"onEnterUp",value:function(e){e.stopPropagation(),e.stopImmediatePropagation()}}]),e}()).\u0275fac=function(e){return new(e||Su)},Su.\u0275dir=j.Kb({type:Su,selectors:[["","appEventFence",""]],hostBindings:function(e,t){1&e&&j.cc("click",(function(e){return t.onClick(e,e.target)}))("keyup.enter",(function(e){return t.onEnterUp(e,e.target)}))}}),Su),Iu=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},zu=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Tu=["labelContainerEl"],Uu=["labelEl"],Du=["wire"],Lu=["tag"],Eu=["pin"],Fu=["title"];function Au(e,t){1&e&&(j.Vb(0,"div",18),j.Qb(1,"app-icon",19),j.Ub())}var Ru=function(e){return{"label__body--collapse":e}};function Vu(e,t){if(1&e&&(j.Vb(0,"div",20),j.jc(1,3),j.Ub()),2&e){var n=j.gc();j.lc("ngClass",j.nc(1,Ru,n.isCollapsed||n.descriptionCollapsed))}}var Nu,Bu,Hu,Qu,qu=[[["","label-header",""]],[["","label-actions",""]],[["","label-more",""]],[["","label-body",""]]],$u=function(e,t,n,i,o,r,a,s,c){return{"label--selected":e,"label--glow":t,"label--annotation":n,"label--invert":i,"label--studio":o,"label--context":r,"label--screenshot-mode":a,"label--auto-fit":s,"label--opaque":c}},Wu=function(e){return{"label__wire--collapse":e}},Ku=function(e,t,n,i){return{"label__tag--collapse":e,"label__tag--collapsible":t,"label__tag--floating":n,"label__tag--draggable":i}},Gu=["[label-header]","[label-actions]","[label-more]","[label-body]"],Zu=((Bu=function(){function e(t,n,i,o,r,a,s){y(this,e),this.renderer=t,this.labelsService=n,this.engineService=i,this.cameraService=o,this.store=r,this.actions=a,this.changeDetection=s,this.labelPinType=Ai,this.labelSequentialType=Vi,this.labelUpdated=new j.p,this.offsetUpdated=new j.p,this.pinClicked=new j.p,this.tagClicked=new j.p,this.displayUpdated=new j.p,this.positionUpdated=new j.p,this.hoverStart=new j.p,this.hoverEnd=new j.p,this.labelOffsetUpdated=new j.p,this.fit="fixed",this.opaque=!1,this.fixedScale=0,this.isCollapsed=!1,this.tagCollapsed=!1,this.theme="classic",this.pinDraggable=!0,this.tagDraggable=!0,this._selected=!1,this.enginePosition=null,this.isBackgroundDark=!1,this.pinDragging=!1,this.screenshotMode=!1,this.hammerManagers=[],this.displayUpdated$=new Z.a,this.positionUpdated$=new Z.a,this.ngUnsubscribe=new Z.a}return v(e,[{key:"label",get:function(){return this._label},set:function(e){var t=Object(ie.isEmpty)(e),n=Object(ie.isEmpty)(this.label);t&&!n?(this._label=Object.assign({},e),this.destroyLabel()):t||(this._label=Object.assign({},e),this.initLabel(this.label))}},{key:"selected",get:function(){return this._selected},set:function(e){e&&this.tagRef.nativeElement.focus(),this._selected=e}},{key:"ngOnInit",value:function(){this.initListeners()}},{key:"ngAfterViewInit",value:function(){this.bindTagEvents(),this.bindPinEvents(),this.bindHoverEvents()}},{key:"ngOnDestroy",value:function(){this.destroyLabel(),this.emitDisplayUpdated({id:this.label.id,inView:!1,shown:!1,objectShown:this.objectShown}),this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"destroyLabel",value:function(){this.hammerManagers.forEach((function(e){return e.destroy})),this.hammerManagers=[],this.deleteMarker(this.marker)}},{key:"initListeners",value:function(){var e=this;this.enginePosition$.pipe(Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){e.enginePosition=t})),this.engineService.getEvent(yn.SceneMarkersUpdated).pipe(Object(Y.a)((function(){return null!=e.label&&null!=e.enginePosition})),Object(X.a)(this.ngUnsubscribe)).subscribe((function(){e.setCanvasPos()})),this.displayUpdated$.pipe(Object(Zc.a)((function(e,t){return Object(ie.isEqual)(e,t)})),Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){e.displayUpdated.next(t)})),this.positionUpdated$.pipe(Object(Zc.a)((function(e,t){return Object(ie.isEqual)(e,t)})),Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){e.positionUpdated.next({positionUpdate:t,onCanvas:e.isOnCanvas()})})),this.background$.pipe(Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){var n=t.colors.slice(0,3),i=t.colors.slice(4,7);e.isBackgroundDark=!bn.isLight(n,i),e.changeDetection.markForCheck()})),this.actions.pipe(Object(L.j)(pr),Object(X.a)(this.ngUnsubscribe)).subscribe((function(){e.screenshotMode=!0,e.changeDetection.detectChanges()})),this.actions.pipe(Object(L.i)(ur),Object(X.a)(this.ngUnsubscribe)).subscribe((function(){e.screenshotMode=!1,e.changeDetection.markForCheck()}))}},{key:"bindTagEvents",value:function(){var e=this,t=new eu(this.tagRef.nativeElement,{domEvents:!0});t.get("pan").set({direction:eu.DIRECTION_ALL,threshold:3}),t.on("pan",(function(t){if(e.tagDraggable){t.srcEvent.stopPropagation(),e.cachedTagOffset||(e.cachedTagOffset=e.label.offset);var n=[e.cachedTagOffset[0]+t.deltaX,e.cachedTagOffset[1]+t.deltaY];e.label.offset=n,t.isFinal&&(e.cachedTagOffset=null,e.offsetUpdated.next({labelId:e.label.id,offset:n}))}})),t.on("tap",(function(t){t.srcEvent.preventDefault(),t.srcEvent.stopPropagation(),e.tagClicked.next(t)})),this.hammerManagers.push(t)}},{key:"bindPinEvents",value:function(){var e=this,t=new eu(this.pinRef.nativeElement);t.get("pan").set({direction:eu.DIRECTION_ALL,threshold:4}),t.on("pan",(function(t){if(e.pinDraggable){t.srcEvent.stopPropagation(),e.pinDragging=!0;var n=t.changedPointers[0],i=n.layerX,o=n.layerY;if(i-=16,o-=16,e.marker&&e.deleteMarker(e.marker),e.renderer.setStyle(e.labelContainerRef.nativeElement,"transform","translate(".concat(i,"px, ").concat(o,"px)")),t.isFinal){e.pinDragging=!1;var r=Object.assign({},e.label),a=Human.renderer.pick.pick(i,o,{rayPick:!0}),s="string"==typeof a.objectId;s&&(r.dir=e.cameraService.getDirection(a),r.objectId=a.objectId,r.barycentric=[a.barycentric[0],a.barycentric[1],a.barycentric[2]],r.pos=[a.worldPos[0],a.worldPos[1],a.worldPos[2]],r.primitiveIndex=a.primitiveIndex),e.labelUpdated.next({label:r,shouldPreserve:s})}}})),t.on("tap",(function(t){t.srcEvent.preventDefault(),t.srcEvent.stopImmediatePropagation(),e.pinClicked.next(t)})),this.hammerManagers.push(t)}},{key:"bindHoverEvents",value:function(){var e=this,t=this.labelRef.nativeElement;this.renderer.listen(t,"mouseenter",(function(){e.hoverStart.next({labelId:e.label.id})})),this.renderer.listen(t,"mouseleave",(function(){e.hoverEnd.next({labelId:e.label.id})}))}},{key:"initLabel",value:function(e){this.initMarker(e),this.ensureObjectId(e),this.initObjectSubscription(e)}},{key:"initMarker",value:function(e){this.marker&&this.deleteMarker(this.marker),this.marker=Human.scene.markers.create({id:e.id,pos:e.pos,dir:e.dir,objectId:e.objectId,primitiveIndex:e.primitiveIndex,barycentric:e.barycentric,renderableIndex:e.renderableIndex||0})}},{key:"checkLabelDisplay",value:function(){return{id:this.label.id,shown:this.label.shown,inView:this.isOnCanvas(),objectShown:!0}}},{key:"ensureObjectId",value:function(e){if(!e.objectId){var t=d(this.marker.canvasPos,2),n=t[0],i=t[1],o=Human.renderer.pick.pick(n,i,{rayPick:!0});o.objectId&&(e.objectId=o.objectId,e.states.forEach((function(e){e.errands.forEach((function(e){e.type===oo.flyToObject&&(e.value=o.objectId)}))})),this.labelUpdated.next({label:e,shouldPreserve:void 0}))}}},{key:"initObjectSubscription",value:function(e){var t=this;this.object$&&this.object$.unsubscribe(),e.objectId&&(this.object$=this.store.select(zs.getViewGraphNode).pipe(Object(se.a)((function(t){return t(e.objectId)})),Object(Y.a)((function(e){return!!e})),Object(X.a)(this.ngUnsubscribe)).subscribe((function(e){t.objectShown=e.boolState.shown})))}},{key:"deleteMarker",value:function(e){Human.scene.markers.delete(e.id),this.marker=null}},{key:"setCanvasPos",value:function(){if(!this.pinDragging&&this.marker){this.depth=-this.marker.viewPos[2];var e=this.isOccluded(),t=this.isOcclusionIgnored(),n=this.isOnCanvas(),i=e&&!t,o=void 0===this.objectShown?n&&!i:n&&this.objectShown&&!i;o!==this.shown&&(this.shown=o,this.setDisplay(o)),this.setElementPosition(),this.setElementScale(),this.setTagPosition(),this.setWirePosition();var r=this.marker.canvasPos,a=r[0],s=r[1];this.positionUpdated$.next({id:this.label.id,canvasPos:{x:a,y:s},occluded:i})}}},{key:"isOcclusionIgnored",value:function(){return this.selected||!this.label.occludable}},{key:"isOccluded",value:function(){return this.depth<0||this.marker.occluded}},{key:"isOnCanvas",value:function(){var e=this.labelsService.getLabelContainer().nativeElement,t=e.offsetWidth,n=e.offsetHeight,i=d(this.marker.canvasPos,2),o=i[0],r=i[1];return o>0&&r>0&&o<t&&r<n}},{key:"setDisplay",value:function(e){this.renderer.setStyle(this.labelRef.nativeElement,"visibility",e?"visible":"hidden"),this.emitDisplayUpdated({id:this.label.id,inView:this.isOnCanvas(),shown:e,objectShown:this.objectShown})}},{key:"setOpacity",value:function(e){var t=1;e?(this.marker.viewAngle>=80&&(t=Math.max(1-(this.marker.viewAngle-80)/20*1,0)),this.renderer.setStyle(this.labelContainerRef.nativeElement,"opacity",t)):this.renderer.setStyle(this.labelContainerRef.nativeElement,"opacity",1)}},{key:"setElementPosition",value:function(){var e=this.marker.canvasPos;this.renderer.setStyle(this.labelContainerRef.nativeElement,"transform","translate(".concat(e[0],"px, ").concat(e[1],"px)"))}},{key:"setElementScale",value:function(){var e;if(this.fixedScale)e=this.fixedScale;else{var t=this.store.selectSnapshot(zs.getEnginePosition).width;e=t>1440?t/1440:1}var n=32*e-32;this.renderer.setStyle(this.labelRef.nativeElement,"transform-origin","top left"),this.renderer.setStyle(this.labelRef.nativeElement,"transform","translate(-".concat(n/2,"px, -").concat(n/2,"px) scale(").concat(e,", ").concat(e,")"))}},{key:"setTagPosition",value:function(){var e=this.label.offset,t=this.tagRef.nativeElement.offsetWidth;switch(this.label.offset[0]>0?"left":"right"){case"left":this.renderer.setStyle(this.tagRef.nativeElement,"transform","translate(".concat(16+e[0],"px, ").concat(e[1],"px)"));break;case"right":this.renderer.setStyle(this.tagRef.nativeElement,"transform","translate(".concat(16+e[0]-t,"px, ").concat(e[1],"px)"))}}},{key:"setWirePosition",value:function(){var e=d(this.label.offset,2),t=e[0],n=e[1];switch(this.label.theme){case Ri.Annotation:case Ri.Classic:n+=this.titleRef.nativeElement.offsetHeight-16-2}var i=Math.sqrt(t*t+n*n);this.renderer.setStyle(this.wireRef.nativeElement,"width",i+"px"),this.renderer.setStyle(this.wireRef.nativeElement,"transform","rotate(".concat(Math.atan2(n,t),"rad)"))}},{key:"emitDisplayUpdated",value:function(e){"context-label"!==this.label.id&&null!=e.inView&&null!=e.shown&&this.displayUpdated$.next(e)}}]),e}()).\u0275fac=function(e){return new(e||Bu)(j.Pb(j.H),j.Pb(po),j.Pb(Sn),j.Pb(Xn),j.Pb(L.g),j.Pb(L.b),j.Pb(j.i))},Bu.\u0275cmp=j.Jb({type:Bu,selectors:[["app-generic-label"]],viewQuery:function(e,t){var n;1&e&&(j.Ec(Tu,!0),j.Ec(Uu,!0),j.Ec(Du,!0),j.Ec(Lu,!0),j.Ec(Eu,!0),j.Ec(Fu,!0)),2&e&&(j.sc(n=j.dc())&&(t.labelContainerRef=n.first),j.sc(n=j.dc())&&(t.labelRef=n.first),j.sc(n=j.dc())&&(t.wireRef=n.first),j.sc(n=j.dc())&&(t.tagRef=n.first),j.sc(n=j.dc())&&(t.pinRef=n.first),j.sc(n=j.dc())&&(t.titleRef=n.first))},hostVars:2,hostBindings:function(e,t){2&e&&j.Hb("selected",t.selected)},inputs:{fit:"fit",opaque:"opaque",fixedScale:"fixedScale",sequence:"sequence",hasContent:"hasContent",label:"label",isCollapsed:"isCollapsed",descriptionCollapsed:"descriptionCollapsed",tagCollapsed:"tagCollapsed",selected:"selected",theme:"theme",pinDraggable:"pinDraggable",tagDraggable:"tagDraggable"},outputs:{labelUpdated:"labelUpdated",offsetUpdated:"offsetUpdated",pinClicked:"pinClicked",tagClicked:"tagClicked",displayUpdated:"displayUpdated",positionUpdated:"positionUpdated",hoverStart:"hoverStart",hoverEnd:"hoverEnd",labelOffsetUpdated:"labelOffsetUpdated"},ngContentSelectors:Gu,decls:21,vars:26,consts:[["data-test","labelContainer",1,"label-container"],["labelContainerEl",""],["data-test","labelElement",1,"label",3,"ngClass"],["labelEl",""],[1,"label__pin"],["pin",""],[3,"label","labelTheme","selected","sequence"],[1,"label__glow"],[1,"label__wire",3,"ngClass"],["wire",""],["tabindex","0",1,"label__tag",3,"ngClass"],["tag",""],[1,"label__header"],["data-test","labelTitle",1,"label__title"],["title",""],["class","label__more",4,"ngIf"],["appEventFence","",1,"label__actions"],["class","label__body",3,"ngClass",4,"ngIf"],[1,"label__more"],["icon","caret-right"],[1,"label__body",3,"ngClass"]],template:function(e,t){1&e&&(j.kc(qu),j.Vb(0,"div",0,1),j.Vb(2,"div",2,3),j.Vb(4,"div",4,5),j.Qb(6,"app-label-pin",6),j.Qb(7,"div",7),j.Ub(),j.Qb(8,"div",8,9),j.Vb(10,"div",10,11),j.Vb(12,"div",12),j.Vb(13,"div",13,14),j.jc(15),j.Ub(),j.Ic(16,Au,2,0,"div",15),j.Vb(17,"div",16),j.jc(18,1),j.Ub(),j.Ub(),j.Ic(19,Vu,2,3,"div",17),j.jc(20,2),j.Ub(),j.Ub(),j.Ub()),2&e&&(j.Db(2),j.lc("ngClass",j.rc(9,$u,[t.selected,t.label.pinGlow,"annotation"===t.label.theme||"classic"===t.label.theme,t.isBackgroundDark,"studioNext"===t.label.theme,"context"===t.label.theme,t.screenshotMode,"auto"===t.fit,t.opaque])),j.Db(4),j.lc("label",t.label)("labelTheme",t.label.theme)("selected",t.selected)("sequence",t.sequence),j.Db(2),j.lc("ngClass",j.nc(19,Wu,t.isCollapsed||t.tagCollapsed||t.label.hideWire)),j.Db(2),j.lc("ngClass",j.qc(21,Ku,t.isCollapsed||t.tagCollapsed,t.label.collapseDescription,t.label.hideWire,t.tagDraggable)),j.Db(6),j.lc("ngIf",t.hasContent&&t.label.collapseDescription),j.Db(3),j.lc("ngIf",t.hasContent))},directives:[we.i,Pu,we.l,Mu,vp],styles:[".text-8[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase[_ngcontent-%COMP%]{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase[_ngcontent-%COMP%]{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase[_ngcontent-%COMP%]{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase[_ngcontent-%COMP%]{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-28[_ngcontent-%COMP%]{font-size:28px;letter-spacing:.7px;line-height:1.4em}.text-28.text-uppercase[_ngcontent-%COMP%]{font-size:28px;letter-spacing:1.68px;line-height:1.25em;text-transform:uppercase}.text-header[_ngcontent-%COMP%]{font-weight:700}.text--code[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.text-xlight[_ngcontent-%COMP%]{font-weight:200}.text-light[_ngcontent-%COMP%]{font-weight:300}.text-medium[_ngcontent-%COMP%]{font-weight:500}.text-semibold[_ngcontent-%COMP%]{font-weight:600}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-underline[_ngcontent-%COMP%]{text-decoration:underline}.text-italic[_ngcontent-%COMP%]{font-style:italic}.text-bright[_ngcontent-%COMP%]{color:#fff}.text-dim[_ngcontent-%COMP%]{color:#96a8c0}.text-error[_ngcontent-%COMP%]{color:#ed4758}.text-left[_ngcontent-%COMP%]{text-align:left}.text-center[_ngcontent-%COMP%]{text-align:center}.text-right[_ngcontent-%COMP%]{text-align:right}.text-ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link[_ngcontent-%COMP%], .text-link[_ngcontent-%COMP%]:visited{color:inherit;cursor:pointer}.text-link[_ngcontent-%COMP%]:not(.text-underline), .text-link[_ngcontent-%COMP%]:visited:not(.text-underline){text-decoration:none}.text-success[_ngcontent-%COMP%]{color:#38de38}.text-danger[_ngcontent-%COMP%]{color:#de3535}.text-info[_ngcontent-%COMP%]{color:#2d72dc}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.text-pre-line[_ngcontent-%COMP%]{white-space:pre-line}@-webkit-keyframes fadeIn{0%{display:none;opacity:0}1%{display:block;opacity:0}to{opacity:1;display:block}}@keyframes fadeIn{0%{display:none;opacity:0}1%{display:block;opacity:0}to{opacity:1;display:block}}@-webkit-keyframes fadeOut{0%{display:block;opacity:1}99%{opacity:0}to{opacity:0;display:none}}@keyframes fadeOut{0%{display:block;opacity:1}99%{opacity:0}to{opacity:0;display:none}}@-webkit-keyframes glow{0%{box-shadow:0 0 0 hsla(0,0%,100%,.5)}50%{box-shadow:0 0 8px 2px hsla(0,0%,100%,.5)}to{box-shadow:0 0 0 hsla(0,0%,100%,.5)}}@keyframes glow{0%{box-shadow:0 0 0 hsla(0,0%,100%,.5)}50%{box-shadow:0 0 8px 2px hsla(0,0%,100%,.5)}to{box-shadow:0 0 0 hsla(0,0%,100%,.5)}}@-webkit-keyframes classic-glow{0%{transform:scale(.5)}10%{transform:scale(.5)}50%{transform:scale(1)}90%{transform:scale(.5)}to{transform:scale(.5)}}@keyframes classic-glow{0%{transform:scale(.5)}10%{transform:scale(.5)}50%{transform:scale(1)}90%{transform:scale(.5)}to{transform:scale(.5)}}.label-container[_ngcontent-%COMP%], [_nghost-%COMP%]{display:block;position:absolute;z-index:10;width:160px;pointer-events:all;pointer-events:none}.label-container[_ngcontent-%COMP%]:hover, [_nghost-%COMP%]:hover{z-index:12}.selected[_nghost-%COMP%]{z-index:11}.label-container[_ngcontent-%COMP%]{left:-16px;top:-16px}.label[_ngcontent-%COMP%]{display:block;overflow:visible;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;justify-content:center;align-items:center;height:32px}.label--screenshot-mode[_ngcontent-%COMP%]{text-shadow:none!important}.label--screenshot-mode[_ngcontent-%COMP%]   .label__pin[_ngcontent-%COMP%]:after, .label--screenshot-mode[_ngcontent-%COMP%]   .label__pin[_ngcontent-%COMP%]:before{box-shadow:none!important}.label--screenshot-mode[_ngcontent-%COMP%]   .label__tag[_ngcontent-%COMP%]{box-shadow:none!important;text-shadow:none!important}.label--screenshot-mode[_ngcontent-%COMP%]   .label__more[_ngcontent-%COMP%]{display:none!important}.label--auto-fit[_ngcontent-%COMP%]   .label__tag[_ngcontent-%COMP%]{min-width:-webkit-max-content;min-width:-moz-max-content;min-width:max-content;padding:0!important}.label--auto-fit[_ngcontent-%COMP%]   .label__body[_ngcontent-%COMP%]{padding:0!important}.label__glow[_ngcontent-%COMP%]{display:none;position:absolute;width:32px;height:32px;border-radius:50%;z-index:0;top:0;left:0}.label--selected[_ngcontent-%COMP%]   .label__more[_ngcontent-%COMP%]{transform:rotate(45deg)}.label__more[_ngcontent-%COMP%]{color:#374a68;display:none;flex:0 0 16px;height:16px;transition:transform .15s ease-in-out}.label__more[_ngcontent-%COMP%], .label__pin[_ngcontent-%COMP%]{align-items:center;justify-content:center}.label__pin[_ngcontent-%COMP%]{display:flex;width:32px;height:32px;border-radius:50%;position:absolute;pointer-events:all;transition:background-color .12s;z-index:10}.label__pin[_ngcontent-%COMP%]:hover{cursor:pointer}.label__pin--draggable[_ngcontent-%COMP%]:hover{cursor:-webkit-grab;cursor:grab}.label__pin--draggable[_ngcontent-%COMP%]:active{cursor:-webkit-grabbing;cursor:grabbing}.label__wire[_ngcontent-%COMP%]{position:absolute;top:16px;left:16px;height:0;transform-origin:0 100%;pointer-events:none;z-index:1}.label__wire--collapse[_ngcontent-%COMP%]{display:none}.label__tag[_ngcontent-%COMP%]{display:inline-block;left:16px;top:0;z-index:10;max-width:160px;pointer-events:all}.label__tag[_ngcontent-%COMP%]:hover{cursor:pointer}.label__tag--draggable[_ngcontent-%COMP%]:hover{cursor:-webkit-grab;cursor:grab}.label__tag--draggable[_ngcontent-%COMP%]:active{cursor:-webkit-grabbing;cursor:grabbing}.label__tag--collapse[_ngcontent-%COMP%]{display:none}.label__tag[_ngcontent-%COMP%]:focus{outline:2px solid #2d72dc!important;border-radius:4px}.label__header[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.label__title[_ngcontent-%COMP%]{line-height:1.4em;line-height:140%;align-self:center}.label__body[_ngcontent-%COMP%], .label__title[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;letter-spacing:0}.label__body[_ngcontent-%COMP%]{line-height:1.4em}.label__body--collapse[_ngcontent-%COMP%]{display:none}.label__icon[_ngcontent-%COMP%]{margin:0 -4px 0 4px}.label__actions[_ngcontent-%COMP%]{padding-left:4px}.label--studio.label--glow[_ngcontent-%COMP%]   .label__glow[_ngcontent-%COMP%]{background-color:hsla(0,0%,100%,.3);display:block;-webkit-animation:classic-glow 4s infinite;animation:classic-glow 4s infinite}.label--studio.label--opaque[_ngcontent-%COMP%]   .label__tag[_ngcontent-%COMP%]{background-color:hsla(0,0%,100%,.85)!important}.label--studio.label.label--selected[_ngcontent-%COMP%]   .label__wire[_ngcontent-%COMP%]{border-color:#2d72dc}.label--studio.label.label--selected[_ngcontent-%COMP%]   .label__tag[_ngcontent-%COMP%]{background-color:#fff;border-color:#2d72dc;box-shadow:0 0 0 1px rgba(45,114,220,.7)}.label--studio.label.label--selected[_ngcontent-%COMP%]   .label__title[_ngcontent-%COMP%]{font-weight:600}.label--studio.label[_ngcontent-%COMP%]   .label__wire[_ngcontent-%COMP%]{border-top:1px solid rgba(16,24,35,.5)}.label--studio.label[_ngcontent-%COMP%]   .label__wire--collapse[_ngcontent-%COMP%]{display:none}.label--studio.label[_ngcontent-%COMP%]   .label__tag[_ngcontent-%COMP%]{background:hsla(0,0%,100%,.55);border:1px solid rgba(16,24,35,.5);box-shadow:0 0 24px rgba(16,24,35,.1);padding:4px 8px;border-radius:4px}.label--studio.label[_ngcontent-%COMP%]   .label__tag[_ngcontent-%COMP%]:hover{background:hsla(0,0%,100%,.8)}.label--studio.label[_ngcontent-%COMP%]   .label__title[_ngcontent-%COMP%]{color:#101823;flex:1 1 auto}.label--studio.label[_ngcontent-%COMP%]   .label__body[_ngcontent-%COMP%]{color:#374a68;overflow-x:hidden;padding-top:4px}.label--studio.label[_ngcontent-%COMP%]   .label__body[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{font-weight:700}.label--studio.label[_ngcontent-%COMP%]   .label__body[_ngcontent-%COMP%]   em[_ngcontent-%COMP%]{font-style:italic}.label--studio.label[_ngcontent-%COMP%]   .label__more[_ngcontent-%COMP%]{display:flex}.label--studio.label.label--invert[_ngcontent-%COMP%]   .label__wire[_ngcontent-%COMP%]{border-color:hsla(0,0%,100%,.5)}.label--annotation.label--glow[_ngcontent-%COMP%]   .label__glow[_ngcontent-%COMP%]{background-color:hsla(0,0%,100%,.25);display:block;-webkit-animation:classic-glow 4s infinite;animation:classic-glow 4s infinite;top:-1px;left:-1px}.label--annotation.label--none[_ngcontent-%COMP%]{display:none}.label--annotation.label[_ngcontent-%COMP%]   .label__wire[_ngcontent-%COMP%]{border-top:1px solid #666}.label--annotation.label[_ngcontent-%COMP%]   .label__tag[_ngcontent-%COMP%]{min-width:10px;color:#eee}.label--annotation.label[_ngcontent-%COMP%]   .label__tag--collapsible[_ngcontent-%COMP%]   .label__more[_ngcontent-%COMP%]{display:flex;color:#000}.label--annotation.label[_ngcontent-%COMP%]   .label__tag--floating[_ngcontent-%COMP%]   .label__header[_ngcontent-%COMP%]{border-bottom:none}.label--annotation.label[_ngcontent-%COMP%]   .label__tag[_ngcontent-%COMP%]:focus{outline-offset:4px}.label--annotation.label[_ngcontent-%COMP%]   .label__header[_ngcontent-%COMP%]{border-bottom:1px solid #666}.label--annotation.label[_ngcontent-%COMP%]   .label__title[_ngcontent-%COMP%]{font-weight:600;min-height:18px;width:100%;padding-bottom:4px;margin-bottom:-2px;color:#000}.label--annotation.label[_ngcontent-%COMP%]   .label__body[_ngcontent-%COMP%]{padding-top:4px;color:#333}.label--annotation.label.label--invert.label[_ngcontent-%COMP%]   .label__wire[_ngcontent-%COMP%]{border-color:#eee}.label--annotation.label.label--invert.label[_ngcontent-%COMP%]   .label__tag--collapsible[_ngcontent-%COMP%]   .label__more[_ngcontent-%COMP%]{display:flex;color:#fff}.label--annotation.label.label--invert.label[_ngcontent-%COMP%]   .label__title[_ngcontent-%COMP%]{color:#fff}.label--annotation.label.label--invert.label[_ngcontent-%COMP%]   .label__header[_ngcontent-%COMP%]{border-color:#eee}.label--annotation.label.label--invert.label[_ngcontent-%COMP%]   .label__body[_ngcontent-%COMP%]{color:#eee}.label--context.label[_ngcontent-%COMP%]{pointer-events:none}.label--context.label--glow[_ngcontent-%COMP%]   .label__glow[_ngcontent-%COMP%]{background-color:hsla(0,0%,100%,.3);display:block;-webkit-animation:classic-glow 4s infinite;animation:classic-glow 4s infinite}.label--context.label[_ngcontent-%COMP%]   .label__pin[_ngcontent-%COMP%], .label--context.label[_ngcontent-%COMP%]   .label__wire[_ngcontent-%COMP%]{display:none}.label--context.label[_ngcontent-%COMP%]   .label__tag[_ngcontent-%COMP%]{background:hsla(0,0%,100%,.7);border:1px solid rgba(16,24,35,.5);box-shadow:0 0 24px rgba(16,24,35,.1);padding:4px 8px;border-radius:4px}.label--context.label[_ngcontent-%COMP%]   .label__tag[_ngcontent-%COMP%]:hover{background:hsla(0,0%,100%,.8);cursor:-webkit-grab;cursor:grab}.label--context.label[_ngcontent-%COMP%]   .label__title[_ngcontent-%COMP%]{font-weight:600;color:#101823}.label--context.label[_ngcontent-%COMP%]   .label__body[_ngcontent-%COMP%]{margin-top:8px;border-top:1px solid #eaeff5;color:#101823;overflow-x:hidden;padding-top:8px}.label--context.label[_ngcontent-%COMP%]   .label__body[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{font-weight:700}.label--context.label[_ngcontent-%COMP%]   .label__body[_ngcontent-%COMP%]   em[_ngcontent-%COMP%]{font-style:italic}"],changeDetection:0}),Iu([Object(L.d)(zs.getEnginePosition),zu("design:type",J.a)],Bu.prototype,"enginePosition$",void 0),Iu([Object(L.d)(vs.getSelectedChapterBackground),zu("design:type",J.a)],Bu.prototype,"background$",void 0),Bu),Ju=((Nu=function(){function e(t){y(this,e),this.engineService=t}return v(e,[{key:"getClipboardAPISupport",value:function(){return"clipboard"in navigator}},{key:"getClipboardAPI",value:function(){return navigator.clipboard}},{key:"copyToClipboard",value:function(e,t){var n=this;if(!0===T.native||T.platform===z.SDK)return new J.a((function(i){n.engineService.fireEvent(yn.NativeShare,{type:t,value:e}),i.next(!0),i.complete()}));if(this.getClipboardAPISupport()){var i=this.getClipboardAPI();return new J.a((function(t){i.writeText(e).then((function(){t.next(!0),t.complete()})).catch((function(e){t.next(!1),t.complete()}))}))}return Object(br.a)(!1)}},{key:"copyInputFieldValue",value:function(e){e.select();var t=!1;try{t=document.execCommand("copy")}catch(n){t=!1}return t}}]),e}()).\u0275fac=function(e){return new(e||Nu)(j.Zb(Sn))},Nu.\u0275prov=j.Lb({token:Nu,factory:Nu.\u0275fac,providedIn:"root"}),Nu),Xu=function(){var e=function e(t){y(this,e),this.colorRecipe=t};return e.type="[Edit Paint] Set Color Recipe",e}(),Yu=function(){var e=function e(t){y(this,e),this.brushMode=t};return e.type="[Edit Paint] Set Paint Brush Mode",e}(),ed=function(){var e=function e(){y(this,e)};return e.type="[Edit Paint] Clear Current Recipe",e}(),td=function(){var e=function e(){y(this,e)};return e.type="[Edit Paint] Reset Paint",e}(),nd=function(){var e=function e(t){y(this,e),this.recipe=t};return e.type="[Edit Paint] Add Recent Recipe",e}(),id=function(){var e=function e(t){y(this,e),this.recipes=t};return e.type="[Edit Paint] Set Recent Recipes",e}(),od=function(){var e=function e(){y(this,e)};return e.type="[Edit Paint] Reset Story Recipes",e}(),rd=function(){var e=function e(t,n){y(this,e),this.chapterId=t,this.recipes=n};return e.type="[Edit Paint] Set Story Recipes For Chapter",e}(),ad=function(){var e=function e(t){y(this,e),this.palette=t};return e.type="[Edit Paint] Add Palette",e}(),sd=function(){var e=function e(t){y(this,e),this.paletteId=t};return e.type="[Edit Paint] Remove Palette",e}(),cd=function(){var e=function e(t){y(this,e),this.palette=t};return e.type="[Edit Paint] Update Palette",e}(),ld=function(){var e=function e(t){y(this,e),this.palettes=t};return e.type="[Edit Paint] Set Palettes",e}(),pd=function(){var e=function e(t,n){y(this,e),this.recipe=t,this.paletteId=n};return e.type="[Edit Paint] Add Recipe to Palette",e}(),ud=function(){var e=function e(t,n){y(this,e),this.paletteId=t,this.open=n};return e.type="[Edit Paint] Toggle Palette",e}(),dd=function(){var e=function e(t){y(this,e),this.view=t};return e.type="[Edit] Set view",e}(),gd=function(){var e=function e(){y(this,e)};return e.type="[Edit] Next view",e}(),hd=function(){var e=function e(){y(this,e)};return e.type="[Edit] Previous view",e}(),fd=function(){var e=function e(t){y(this,e),this.show=t};return e.type="[Edit] Show columns",e}(),bd=function(){var e=function e(t,n){y(this,e),this.column=t,this.show=n};return e.type="[Edit] Show column",e}(),md=function(){var e=function e(t){y(this,e),this.show=t};return e.type="[Edit] Show Timeline Editor",e}(),vd=function(){var e=function e(){y(this,e)};return e.type="[Edit] Reset",e}(),yd=function(){var e=function e(t){y(this,e),this.layerOrderMode=t};return e.type="[Edit] Set Layer Order Mode",e}(),xd=function(){var e=function e(t){y(this,e),this.show=t};return e.type="[Edit] Show Tree Node Ids",e}(),Od=function(){var e=function e(t){y(this,e),this.show=t};return e.type="[Edit] Show Root Nodess",e}(),wd=function(){var e=function e(t){y(this,e),this.size=t};return e.type="[Edit] Set Canvas Size",e}(),kd=function(){var e=function e(t){y(this,e),this.enable=t};return e.type="[Edit] Auto Capture",e}(),Cd=function(e){return e.Chapter="chapter",e.Label="label",e.Paint="paint",e.Position="position",e.Quiz="quiz",e}({}),Sd=r("dNgK"),_d=function(e){return e.Dark="dark",e.Light="light",e.Themed="themed",e}({}),jd=["app-button",""],Pd=function(e,t,n,i,o,r,a,s,c,l,p,u,d,g,h,f,b,m,v,y,x,O,w,k){return{"app-button--xsmall":e,"app-button--small":t,"app-button--medium":n,"app-button--large":i,"app-button--flat":o,"app-button--default":r,"app-button--primary":a,"app-button--white":s,"app-button--info":c,"app-button--outline":l,"app-button--text":p,"app-button--light":u,"app-button--dark":d,"app-button--themed":g,"app-button--circle":h,"app-button--rounded":f,"app-button--square":b,"app-button--selected":m,"app-button--uppercase":v,"app-button--disabled":y,"app-button--no-border":x,"app-button--expanded":O,"app-button--left":w,"app-button--loading":k}},Md=["*"],Id=function(e){return e.XSmall="xsmall",e.Small="small",e.Medium="medium",e.Large="large",e}({}),zd=function(e){return e.Default="default",e.Flat="flat",e.Primary="primary",e.Info="info",e.Outline="outline",e.Text="text",e.White="white",e}({}),Td=function(e){return e.Default="default",e.Circle="circle",e.Rounded="rounded",e.Square="square",e}({}),Ud=function(e){return e.Left="left",e.Center="center",e}({}),Dd=((Hu=function(){function e(){y(this,e),this.buttonSize=Id.Medium,this.buttonType=zd.Default,this.buttonTheme=_d.Dark,this.buttonShape=Td.Default,this.buttonAlign=Ud.Center,this.uppercase=!0,this.selected=!1,this.expanded=!1,this.loading=!1,this.bordered=!0}return v(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||Hu)},Hu.\u0275cmp=j.Jb({type:Hu,selectors:[["button","app-button",""],["a","app-button",""]],hostVars:1,hostBindings:function(e,t){2&e&&j.Yb("disabled",t.disabled)},inputs:{buttonSize:"buttonSize",buttonType:"buttonType",buttonTheme:"buttonTheme",buttonShape:"buttonShape",buttonAlign:"buttonAlign",uppercase:"uppercase",selected:"selected",expanded:"expanded",loading:"loading",disabled:"disabled",bordered:"bordered"},attrs:jd,ngContentSelectors:Md,decls:3,vars:26,consts:[[1,"app-button",3,"ngClass"],[1,"app-button__container"]],template:function(e,t){1&e&&(j.kc(),j.Vb(0,"span",0),j.Vb(1,"span",1),j.jc(2),j.Ub(),j.Ub()),2&e&&j.lc("ngClass",j.rc(1,Pd,["xsmall"==t.buttonSize,"small"==t.buttonSize,"medium"==t.buttonSize,"large"==t.buttonSize,"flat"==t.buttonType,"default"==t.buttonType,"primary"==t.buttonType,"white"==t.buttonType,"info"==t.buttonType,"outline"==t.buttonType,"text"==t.buttonType,"light"==t.buttonTheme,"dark"==t.buttonTheme,"themed"==t.buttonTheme,"circle"==t.buttonShape,"rounded"==t.buttonShape,"square"==t.buttonShape,t.selected,t.uppercase,t.disabled,!t.bordered,t.expanded,"left"===t.buttonAlign,t.loading]))},directives:[we.i],styles:['.text-8{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-28{font-size:28px;letter-spacing:.7px;line-height:1.4em}.text-28.text-uppercase{font-size:28px;letter-spacing:1.68px;line-height:1.25em;text-transform:uppercase}.text-header{font-weight:700}.text--code{font-family:Courier New,Courier,monospace}.text-uppercase{text-transform:uppercase}.text-xlight{font-weight:200}.text-light{font-weight:300}.text-medium{font-weight:500}.text-semibold{font-weight:600}.text-bold{font-weight:700}.text-underline{text-decoration:underline}.text-italic{font-style:italic}.text-bright{color:#fff}.text-dim{color:#96a8c0}.text-error{color:#ed4758}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.text-ellipsis{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link,.text-link:visited{color:inherit;cursor:pointer}.text-link:not(.text-underline),.text-link:visited:not(.text-underline){text-decoration:none}.text-success{color:#38de38}.text-danger{color:#de3535}.text-info{color:#2d72dc}.text-nowrap{white-space:nowrap}.text-pre-line{white-space:pre-line}a[app-button],button[app-button]{border-color:transparent;background:none;border-width:0;padding:0;margin:0;border-radius:4px;outline:0 none}a[app-button]:not([disabled]):hover,button[app-button]:not([disabled]):hover{cursor:pointer}a[app-button]:focus .app-button,button[app-button]:focus .app-button{outline:2px solid #2d72dc!important}.app-button{font-size:13px;letter-spacing:.325px;line-height:1.4em;align-items:center;border-radius:4px;display:flex;font-family:Inter UI,sans-serif;justify-content:center;padding:0 16px;position:relative;text-align:center;transition:background-color .12s;width:100%}.app-button:after{content:" ";background-color:#283853;border-radius:4px;display:block;position:absolute;left:0;top:0;bottom:0;right:0;opacity:0;z-index:1;transition:opacity .06s}.app-button:not(.app-button--disabled):hover:after{opacity:.7}.app-button__container{position:relative;z-index:2;width:100%}.app-button--uppercase{text-transform:uppercase}.app-button--expanded{display:flex;flex:1}.app-button--xsmall{height:24px;min-width:24px;padding:0 8px;font-size:10px;letter-spacing:.25px;line-height:1.4em}.app-button--small{height:32px;min-width:32px;padding:0 12px}.app-button--medium,.app-button--small{font-size:13px;letter-spacing:.325px;line-height:1.4em}.app-button--medium{height:36px;min-width:36px;padding:0 16px}.app-button--large{height:48px;min-width:48px;padding:0 16px;font-size:14px;letter-spacing:.35px;line-height:1.4em}.app-button--no-border,.app-button--no-border:after{border-radius:0!important}.app-button--left{text-align:left}.app-button--themed{color:#374a68}.app-button--themed:hover{color:#1c2a3f}.app-button--themed:after{background-color:#d7e0ea}.app-button--dark{color:#d7e0ea}.app-button--dark:hover{color:#fff}.app-button--dark:after{background-color:#283853}.app-button--dark.app-button--flat{background:#374a68}.app-button--dark.app-button--default{background:transparent}.app-button--dark.app-button--outline{background:transparent;border:1px solid #374a68;transition:border-color .12s}.app-button--dark.app-button--outline:hover{border-color:#96a8c0}.app-button--dark.app-button--outline:hover:after{background-color:transparent;display:none}.app-button--dark.app-button--text{background:transparent;color:#d7e0ea}.app-button--dark.app-button--text:hover{color:#fff}.app-button--dark.app-button--text:hover:after{display:none}.app-button--dark.app-button--selected{background-color:#2d72dc;color:#fff}.app-button--dark.app-button--selected:hover:after{display:none}.app-button--light{color:#283853}.app-button--light:hover{color:#1c2a3f}.app-button--light:after{background-color:#96a8c0}.app-button--light:not(.app-button--disabled):hover:after{opacity:.6}.app-button--light::-moz-focus-inner{border:0}.app-button--light:not([disabled]):hover{cursor:pointer}.app-button--light[disabled]{pointer-events:none}.app-button--light.app-button--flat{background:#d7e0ea;font-weight:500}.app-button--light.app-button--flat.app-button--selected{background-color:#96a8c0}.app-button--light.app-button--default{background:transparent;color:#131c2a}.app-button--light.app-button--default:not(.app-button--disabled):hover:after{opacity:.2}.app-button--light.app-button--outline{background:transparent;border:1px solid #96a8c0;color:#283853;transition:border-color .12s}.app-button--light.app-button--outline:after{display:none}.app-button--light.app-button--outline:hover{background:rgba(55,74,104,.05);border-color:#374a68;color:#1c2a3f}.app-button--light.app-button--outline:hover:after{background-color:transparent}.app-button--light.app-button--selected{background-color:#eaeff5}.app-button--light.app-button--selected:hover:after{display:none}.app-button--light.app-button--text{color:#283853}.app-button--light.app-button--text:hover{color:#1c2a3f}.app-button--light.app-button--text:hover:after{display:none}.app-button.app-button--primary{background:#de3535;color:#fff}.app-button.app-button--primary:after{background:#f9fafd}.app-button.app-button--primary:hover:after{opacity:.1}.app-button.app-button--white{background:#fff;color:#283853;transition:border-color .12s}.app-button.app-button--white:hover{border-color:#96a8c0}.app-button.app-button--white:hover:after{background-color:#131c2a;display:none}.app-button.app-button--info{background:#2d72dc;color:#fff}.app-button.app-button--info:after{background:#f9fafd}.app-button.app-button--info:hover:after{opacity:.1}.app-button--selected{background-color:#2d72dc}.app-button--disabled:not(.app-button--loading){opacity:.5}.app-button--loading{background-color:#eaeff5!important;color:#61779e!important}.app-button--circle{border-radius:50%}.app-button--circle.app-button--xsmall{width:24px}.app-button--circle.app-button--small{width:32px;padding:0 6px}.app-button--circle.app-button--medium{width:36px;padding:0 8px}.app-button--circle.app-button--large{width:48px}.app-button--circle:after{border-radius:50%}.app-button--square{padding:0}.app-button--square.app-button--xsmall{width:24px;height:24px}.app-button--square.app-button--small{width:32px;height:32px}.app-button--square.app-button--medium{width:36px;height:36px}.app-button--square.app-button--large{width:48px;height:48px}.app-button--rounded,.app-button--rounded:after{border-radius:18px}'],encapsulation:2,changeDetection:0}),Hu),Ld=r("STbY"),Ed=function(e){return e.All="all",e.iOS="ios",e.Android="android",e}({}),Fd=((Qu=function(){function e(t,n,i){y(this,e),this.templateRef=t,this.viewContainer=n,this.router=i,this._appFlagApplicationMode="include"}return v(e,[{key:"appFlagApplication",get:function(){return this._appFlagApplication},set:function(e){this._appFlagApplication=e}},{key:"appFlagApplicationMode",get:function(){return this._appFlagApplicationMode},set:function(e){this._appFlagApplicationMode=e}},{key:"appFlagApplicationPage",get:function(){return this._appFlagApplicationPage},set:function(e){this._appFlagApplicationPage=e}},{key:"appFlagApplicationPlatform",get:function(){return this._appFlagApplicationPlatform},set:function(e){this._appFlagApplicationPlatform=e}},{key:"appFlagApplicationNative",get:function(){return this._appFlagApplicationNative},set:function(e){this._appFlagApplicationNative=e}},{key:"ngOnInit",value:function(){this.update()}},{key:"update",value:function(){var e,t=!1,n=!1,i=!1,o=!1;if(""===this.appFlagApplication?t=!0:Array.isArray(this.appFlagApplication)?t=this.appFlagApplication.some((function(e){return e===T.application})):"string"==typeof this.appFlagApplication&&(t=this.appFlagApplication===T.application),null==this.appFlagApplicationPage)n=!0;else{var r=this.router.url;Array.isArray(this.appFlagApplicationPage)?n=this.appFlagApplicationPage.some((function(e){return r.indexOf(e)>=0})):"string"==typeof this.appFlagApplicationPage&&(n=r.indexOf(this.appFlagApplicationPage)>=0)}if(null==this.appFlagApplicationPlatform)i=!0;else{var a=T.platform;Array.isArray(this.appFlagApplicationPlatform)?i=this.appFlagApplicationPlatform.some((function(e){return a.indexOf(e)>=0})):"string"==typeof this.appFlagApplicationPlatform&&(i=a.indexOf(this.appFlagApplicationPlatform)>=0)}null==this.appFlagApplicationNative?o=!0:(o=T.native,(Array.isArray(this.appFlagApplicationNative)?this.appFlagApplicationNative:[this.appFlagApplicationNative]).includes(Ed.iOS)&&(o=T.native&&void 0!==window.webkit)),(e=t&&n&&i&&o)&&"include"===this.appFlagApplicationMode||!e&&"exclude"===this.appFlagApplicationMode?this.viewContainer.createEmbeddedView(this.templateRef):this.viewContainer.clear()}}]),e}()).\u0275fac=function(e){return new(e||Qu)(j.Pb(j.O),j.Pb(j.S),j.Pb(te.e))},Qu.\u0275dir=j.Kb({type:Qu,selectors:[["","appFlagApplication",""]],inputs:{appFlagApplication:"appFlagApplication",appFlagApplicationMode:"appFlagApplicationMode",appFlagApplicationPage:"appFlagApplicationPage",appFlagApplicationPlatform:"appFlagApplicationPlatform",appFlagApplicationNative:"appFlagApplicationNative"}}),Qu),Ad=r("f0Cb"),Rd=["nodeActionsTrigger"];function Vd(e,t){if(1&e&&(j.Tb(0),j.Vb(1,"button",30),j.Kc(2,"Select"),j.Ub(),j.Qb(3,"mat-divider"),j.Sb()),2&e){j.gc();var n=j.tc(24);j.Db(1),j.lc("matMenuTriggerFor",n)}}function Nd(e,t){if(1&e&&(j.Tb(0),j.Qb(1,"mat-divider"),j.Vb(2,"button",31),j.Kc(3," Selectable / Unselectable "),j.Ub(),j.Sb()),2&e){j.gc();var n=j.tc(43);j.Db(2),j.lc("matMenuTriggerFor",n)}}function Bd(e,t){if(1&e){var n=j.Wb();j.Tb(0),j.Qb(1,"mat-divider"),j.Vb(2,"button",32),j.cc("click",(function(){j.xc(n);var e=j.gc();return e.editNodeLabel(e.node)})),j.Kc(3," Edit Object Name "),j.Ub(),j.Sb()}}function Hd(e,t){if(1&e&&(j.Tb(0),j.Qb(1,"mat-divider"),j.Vb(2,"button",33),j.Kc(3," Copy "),j.Ub(),j.Sb()),2&e){j.gc();var n=j.tc(50);j.Db(2),j.lc("matMenuTriggerFor",n)}}function Qd(e,t){if(1&e){var n=j.Wb();j.Tb(0),j.Qb(1,"mat-divider"),j.Vb(2,"button",34),j.cc("click",(function(){j.xc(n);var e=j.gc();return e.samplePaint(e.node)})),j.Kc(3," Sample Paint "),j.Ub(),j.Sb()}}function qd(e,t){if(1&e){var n=j.Wb();j.Vb(0,"button",35),j.cc("click",(function(){j.xc(n);var e=j.gc();return e.toggleVisible(e.node,!0)})),j.Kc(1," Show This "),j.Ub()}}function $d(e,t){if(1&e){var n=j.Wb();j.Vb(0,"button",36),j.cc("click",(function(){j.xc(n);var e=j.gc();return e.toggleVisible(e.node,!1)})),j.Kc(1," Hide This "),j.Ub()}}function Wd(e,t){if(1&e){var n=j.Wb();j.Vb(0,"button",37),j.cc("click",(function(){j.xc(n);var e=j.gc();return e.togglePickable(e.node,!1)})),j.Kc(1," Make Unselectable "),j.Ub()}}function Kd(e,t){if(1&e){var n=j.Wb();j.Vb(0,"button",38),j.cc("click",(function(){j.xc(n);var e=j.gc();return e.togglePickable(e.node,!0)})),j.Kc(1," Make Selectable "),j.Ub()}}var Gd,Zd=((Gd=function(){function e(t,n,i,o,r,a,s,c){y(this,e),this.store=t,this.graphService=n,this.changeDetectorRef=i,this.clipboardService=o,this.snackbar=r,this.cameraService=a,this.engineService=s,this.liveAnnouncer=c,this.application=P,this.shortId="",this.theme="dark",this.eventCategory="",this.nodeActionsClosed=new j.p}return v(e,[{key:"node",get:function(){return this._node},set:function(e){this._node=e;var t=this.node.id.split("-");this.shortId=2===t.length?t[1]:t[0]}},{key:"isNodeChecked",value:function(e){return this.store.selectSnapshot(jo.getNodes)[e].checked}},{key:"isNodeShown",value:function(e){return this.store.selectSnapshot(jo.getNodes)[e].shown}},{key:"checkNode",value:function(e,t){var n=void 0===t?!this.isNodeChecked(e.id):t;this.store.dispatch(new Yi.UpdateNodesChecked(n,[e.id]))}},{key:"checkInverse",value:function(e){this.store.dispatch(new Yi.UpdateNodesChecked(!0)),this.store.dispatch(new Yi.UpdateNodesChecked(!1,[e.id]))}},{key:"setCheckedNodes",value:function(e,t){this.store.dispatch(new Yi.UpdateNodesChecked(!1));var n=void 0===t?!this.isNodeChecked(e.id):t;this.store.dispatch(new Yi.UpdateNodesChecked(n,[e.id]))}},{key:"flyToNode",value:function(e){var t=this;this.store.dispatch(new Pt(e.id)).subscribe((function(){t.liveAnnouncer.announce("Fly to complete")}))}},{key:"hideNode",value:function(e){this.store.dispatch(new Yi.UpdateNodesShown(!1,[e.id]))}},{key:"hideInverse",value:function(e){var t=this,n=this.store.selectSnapshot(zs.getViewGraph),i=this.graphService.getAllLeafDescendants(n,[e.id]),o=this.graphService.getInverseSelection(n,[e.id]),r={};i.forEach((function(e){r[e]=!0})),o.forEach((function(e){r[e]=!1}));var a=new Yi.UpdateNodesShown(void 0,void 0,r),s=ho(this.store.selectSnapshot(jo),a);this.store.dispatch(new Yi.ApplyPatch(s.patches));var c,l,p,u=this.engineService.getObjectBoundary(e.id),g=this.cameraService.cameraAfterFlyTo(u),h=new Wn(g),f=(c=this.store.selectSnapshot(ws),l=h,{nextState:(p=d(immer.produceWithPatches(c,(function(e){e.cameraFlyTo=l.camera})),3))[0],patches:p[1],inversePatches:p[2]});this.store.dispatch(new Kn(f.patches)).subscribe((function(){t.liveAnnouncer.announce("Isolate complete")})),this.store.dispatch(new Yi.UpdateNodeSelected),this.store.dispatch(new Yi.UpdateNodesChecked(!1)),this.store.dispatch(new eo.SavePatches([{forward:s.patches,inverse:s.inversePatches,patchAction:Yi.ApplyPatch},{forward:f.patches,inverse:f.inversePatches,patchAction:Kn}]))}},{key:"showNode",value:function(e){this.store.dispatch(new Yi.UpdateNodesShown(!0,[e.id])),this.changeDetectorRef.markForCheck()}},{key:"toggleVisible",value:function(e,t){var n=this,i=void 0===t?this.isNodeShown(e.id):t;this.store.dispatch(new Yi.UpdateNodesShown(i,[e.id])).subscribe((function(){n.liveAnnouncer.announce("Object "+(i?"shown":"hidden"))})),this.changeDetectorRef.markForCheck()}},{key:"togglePickable",value:function(e,t){this.store.dispatch(new Yi.UpdateNodesPickable(t,[e.id])),this.changeDetectorRef.markForCheck()}},{key:"makeEverythingElseUnpickale",value:function(e){this.store.dispatch(new Yi.UpdateNodesPickable(!1)),this.store.dispatch(new Yi.UpdateNodesPickable(!0,[e.id]))}},{key:"fadeInverseNodes",value:function(e){var t=this.store.selectSnapshot(zs.getViewGraph),n=this.graphService.getInverseSelection(t,[e.id]),i=this.graphService.getNodes(t,n);this.store.dispatch(new Yi.UpdateNodesPaint(Io,i.map((function(e){return e.id})))).subscribe((function(){}))}},{key:"fadeNode",value:function(e){var t=this;this.store.dispatch(new Yi.UpdateNodesPaint(Io,[e.id])).subscribe((function(){t.liveAnnouncer.announce("Fade complete")}))}},{key:"editNodeLabel",value:function(e){this.store.dispatch(new on(e))}},{key:"copy",value:function(e){var t=this;this.clipboardService.copyToClipboard(e,"text").subscribe((function(){t.snackbar.open("Copied ".concat(e," to clipboard."))}))}},{key:"onMenuClosed",value:function(){this.nodeActionsClosed.emit()}},{key:"samplePaint",value:function(e){var t=this.store.selectSnapshot(jo.getNodePaint)(e.id),n=ko.toEngine(t);zo.isRealRecipe(n)?this.store.dispatch(new Xu(t)):this.store.dispatch(new ed),this.store.dispatch(new Et(ks.Paint)),this.store.dispatch(new dd(Cd.Paint))}}]),e}()).\u0275fac=function(e){return new(e||Gd)(j.Pb(L.g),j.Pb(mn),j.Pb(j.i),j.Pb(Ju),j.Pb(Sd.b),j.Pb(Xn),j.Pb(Sn),j.Pb(qp.i))},Gd.\u0275cmp=j.Jb({type:Gd,selectors:[["app-node-actions"]],viewQuery:function(e,t){var n;1&e&&j.Ec(Rd,!0),2&e&&j.sc(n=j.dc())&&(t.nodeActionsTrigger=n.first)},inputs:{node:"node",theme:"theme",eventCategory:"eventCategory"},outputs:{nodeActionsClosed:"nodeActionsClosed"},decls:58,vars:25,consts:[["app-button","","data-test","nodeActionsTrigger","buttonSize","xsmall",3,"buttonTheme","matMenuTriggerFor","menuClosed"],["nodeActionsTrigger","matMenuTrigger"],["icon","ellipsis-v","aria-hidden","true"],[1,"visually-hidden"],[3,"overlapTrigger"],["nodeActions","matMenu"],[4,"appFlagApplication","appFlagApplicationPage","appFlagApplicationMode"],["mat-menu-item","","data-test","nodeActionsHideShow",3,"click"],["mat-menu-item","","data-test","nodeActionsIsolate",3,"click"],["data-test","nodeActionsFadeTrigger","mat-menu-item","",3,"matMenuTriggerFor"],[4,"appFlagApplication","appFlagApplicationMode","appFlagApplicationPage"],["mat-menu-item","","data-test","nodeActionsFlyTo",3,"click"],["selectActions","matMenu"],["mat-menu-item","","data-test","nodeActionsSelectThis",3,"click"],["mat-menu-item","","data-test","nodeActionsSelectEverythingElse",3,"click"],["fadeActions","matMenu"],["mat-menu-item","","data-test","nodeActionsFadeThis",3,"click"],["mat-menu-item","","data-test","nodeActionsFadeEverythingElse",3,"click"],["showHideActions","matMenu"],["mat-menu-item","","data-test","nodeActionsShowThis",3,"click",4,"ngIf"],["mat-menu-item","","data-test","nodeActionsShowEverythingElse",3,"click",4,"ngIf"],["mat-menu-item","",3,"click"],["pickableActions","matMenu"],["mat-menu-item","","data-test","nodeActionsPickable",3,"click",4,"ngIf"],["mat-menu-item","","data-test","nodeActionsUnpickable",3,"click",4,"ngIf"],["mat-menu-item","","data-test","nodeActionsEverythingElseUnpickable",3,"click"],["copyActions","matMenu"],["mat-menu-item","","data-test","nodeActionsCopyShortID",3,"click"],["mat-menu-item","","data-test","nodeActionsCopyFullID",3,"click"],["mat-menu-item","","data-test","nodeActionsCopyDisplayName",3,"click"],["mat-menu-item","",3,"matMenuTriggerFor"],["mat-menu-item","","data-test","nodeActionsPickableTrigger",3,"matMenuTriggerFor"],["mat-menu-item","","data-test","nodeActionsEditName",3,"click"],["mat-menu-item","","data-test","nodeActionsCopyTrigger",3,"matMenuTriggerFor"],["mat-menu-item","","data-test","nodeActionsSamplePaint",3,"click"],["mat-menu-item","","data-test","nodeActionsShowThis",3,"click"],["mat-menu-item","","data-test","nodeActionsShowEverythingElse",3,"click"],["mat-menu-item","","data-test","nodeActionsPickable",3,"click"],["mat-menu-item","","data-test","nodeActionsUnpickable",3,"click"]],template:function(e,t){if(1&e&&(j.Tb(0),j.Vb(1,"button",0,1),j.cc("menuClosed",(function(){return t.onMenuClosed()})),j.Qb(3,"app-icon",2),j.Vb(4,"span",3),j.Kc(5),j.Ub(),j.Ub(),j.Vb(6,"mat-menu",4,5),j.Ic(8,Vd,4,1,"ng-container",6),j.Vb(9,"button",7),j.cc("click",(function(){return t.toggleVisible(t.node,!t.node.boolState.shown)})),j.Kc(10),j.Ub(),j.Vb(11,"button",8),j.cc("click",(function(){return t.hideInverse(t.node)})),j.Kc(12," Isolate "),j.Ub(),j.Qb(13,"mat-divider"),j.Vb(14,"button",9),j.Kc(15," Fade "),j.Ub(),j.Ic(16,Nd,4,1,"ng-container",10),j.Qb(17,"mat-divider"),j.Vb(18,"button",11),j.cc("click",(function(){return t.flyToNode(t.node)})),j.Kc(19,"Fly To"),j.Ub(),j.Ic(20,Bd,4,0,"ng-container",6),j.Ic(21,Hd,4,1,"ng-container",6),j.Ic(22,Qd,4,0,"ng-container",6),j.Ub(),j.Vb(23,"mat-menu",null,12),j.Vb(25,"button",13),j.cc("click",(function(){return t.checkNode(t.node,!0)})),j.Kc(26," Select This "),j.Ub(),j.Vb(27,"button",14),j.cc("click",(function(){return t.checkInverse(t.node)})),j.Kc(28," Select Everything Else "),j.Ub(),j.Ub(),j.Vb(29,"mat-menu",null,15),j.Vb(31,"button",16),j.cc("click",(function(){return t.fadeNode(t.node)})),j.Kc(32," Fade This "),j.Ub(),j.Vb(33,"button",17),j.cc("click",(function(){return t.fadeInverseNodes(t.node)})),j.Kc(34," Fade Everything Else "),j.Ub(),j.Ub(),j.Vb(35,"mat-menu",null,18),j.Ic(37,qd,2,0,"button",19),j.Ic(38,$d,2,0,"button",20),j.Qb(39,"mat-divider"),j.Vb(40,"button",21),j.cc("click",(function(){return t.hideInverse(t.node)})),j.Kc(41,"Hide Everything Else"),j.Ub(),j.Ub(),j.Vb(42,"mat-menu",null,22),j.Ic(44,Wd,2,0,"button",23),j.Ic(45,Kd,2,0,"button",24),j.Qb(46,"mat-divider"),j.Vb(47,"button",25),j.cc("click",(function(){return t.makeEverythingElseUnpickale(t.node)})),j.Kc(48," Make Everything Else Unselectable "),j.Ub(),j.Ub(),j.Vb(49,"mat-menu",null,26),j.Vb(51,"button",27),j.cc("click",(function(){return t.copy(t.shortId)})),j.Kc(52," Copy Short ID "),j.Ub(),j.Vb(53,"button",28),j.cc("click",(function(){return t.copy(t.node.id)})),j.Kc(54," Copy Full ID "),j.Ub(),j.Qb(55,"mat-divider"),j.Vb(56,"button",29),j.cc("click",(function(){return t.copy(t.node.label)})),j.Kc(57," Copy Display Name "),j.Ub(),j.Ub(),j.Sb()),2&e){var n=j.tc(7),i=j.tc(30);j.Db(1),j.lc("buttonTheme",t.theme)("matMenuTriggerFor",n),j.Db(4),j.Mc("",t.node.label," menu"),j.Db(1),j.lc("overlapTrigger",!0),j.Db(2),j.lc("appFlagApplication",t.application.All)("appFlagApplicationPage","/edit")("appFlagApplicationMode","include"),j.Db(2),j.Mc(" ",t.node.boolState.shown?"Hide":"Show"," "),j.Db(4),j.lc("matMenuTriggerFor",i),j.Db(2),j.lc("appFlagApplication",t.application.All)("appFlagApplicationMode","include")("appFlagApplicationPage","/edit"),j.Db(4),j.lc("appFlagApplication",t.application.Loft)("appFlagApplicationPage","/edit")("appFlagApplicationMode","include"),j.Db(1),j.lc("appFlagApplication",t.application.Loft)("appFlagApplicationPage","/edit")("appFlagApplicationMode","include"),j.Db(1),j.lc("appFlagApplication",t.application.All)("appFlagApplicationPage","/edit")("appFlagApplicationMode","include"),j.Db(15),j.lc("ngIf",!t.node.boolState.shown),j.Db(1),j.lc("ngIf",t.node.boolState.shown),j.Db(6),j.lc("ngIf",t.node.boolState.pickable),j.Db(1),j.lc("ngIf",!t.node.boolState.pickable)}},directives:[Dd,Ld.d,vp,Ld.a,Fd,Ld.b,Ad.a,we.l],styles:[""],changeDetection:0}),Gd),Jd=r("lR5k"),Xd=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function Yd(e,t){if(1&e&&j.Qb(0,"app-node-actions",9),2&e){var n=j.gc(2);j.lc("node",n.node)}}function eg(e,t){if(1&e&&(j.Vb(0,"div",7),j.jc(1),j.Ic(2,Yd,1,1,"app-node-actions",8),j.Ub()),2&e){var n=j.gc();j.Db(2),j.lc("ngIf",n.enableActions)}}function tg(e,t){if(1&e&&(j.Vb(0,"i",10),j.Kc(1),j.Ub()),2&e){var n=j.gc();j.Db(1),j.Mc(" ",n.node.info.latinLabel," ")}}function ng(e,t){if(1&e){var n=j.Wb();j.Vb(0,"button",11),j.cc("click",(function(){return j.xc(n),j.gc().handleReadMoreClick()})),j.Kc(1," Read More "),j.Ub()}2&e&&j.lc("@show",void 0)}var ig,og=["*"],rg=((ig=function(){function e(t,n,i,o,r){y(this,e),this.store=t,this.actions=n,this.engineService=i,this.viewService=o,this.changeDetectorRef=r,this.ngUnsubscribe=new Z.a}return v(e,[{key:"label",get:function(){return this._label},set:function(e){this._label=e,this.setLabelNode()}},{key:"ngOnInit",value:function(){this.initInfoListeners()}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"setLabelNode",value:function(){var e=Object(ie.get)(this.label,"objectId");if(e){var t=this.store.selectSnapshot(zs.getViewGraph);this.node=this.engineService.getNode(t,e)}else this.node=null;this.changeDetectorRef.markForCheck()}},{key:"initInfoListeners",value:function(){var e=this;this.actions.pipe(Object(L.i)(rn),Object(X.a)(this.ngUnsubscribe)).subscribe((function(){e.setLabelNode()}))}},{key:"handleReadMoreClick",value:function(){this.node&&this.viewService.toggleNodeInfo(!0)}}]),e}()).\u0275fac=function(e){return new(e||ig)(j.Pb(L.g),j.Pb(L.b),j.Pb(Sn),j.Pb(Wp),j.Pb(j.i))},ig.\u0275cmp=j.Jb({type:ig,selectors:[["app-context-label"]],inputs:{label:"label",enableInfo:"enableInfo",enableActions:"enableActions"},ngContentSelectors:og,decls:8,vars:9,consts:[[1,"context-label",3,"label"],["label-header","",1,"context-label__header","html",3,"innerHTML"],["title",""],["class","context-label__actions","label-actions","",4,"ngIf"],["label-more",""],["class","context-label__latin",4,"ngIf"],["type","button","app-button","","buttonTheme","light","buttonSize","xsmall","class","context-label__more",3,"click",4,"ngIf"],["label-actions","",1,"context-label__actions"],["eventCategory","Context Node","theme","light",3,"node",4,"ngIf"],["eventCategory","Context Node","theme","light",3,"node"],[1,"context-label__latin"],["type","button","app-button","","buttonTheme","light","buttonSize","xsmall",1,"context-label__more",3,"click"]],template:function(e,t){1&e&&(j.kc(),j.Vb(0,"app-generic-label",0),j.Qb(1,"div",1,2),j.hc(3,"markdown"),j.Ic(4,eg,3,1,"div",3),j.Tb(5,4),j.Ic(6,tg,2,1,"i",5),j.Ic(7,ng,2,1,"button",6),j.Sb(),j.Ub()),2&e&&(j.Hb("context-label--more",t.enableInfo&&t.node&&t.node.info),j.lc("label",t.label),j.Db(1),j.lc("innerHTML",j.ic(3,7,t.label.title),j.yc),j.Db(3),j.lc("ngIf",t.node),j.Db(2),j.lc("ngIf",t.node&&(null==t.node.info?null:t.node.info.latinLabel)),j.Db(1),j.lc("ngIf",t.enableInfo&&t.node&&t.node.info))},directives:[Zu,we.l,Zd,Dd],pipes:[Jd.b],styles:[".text-8[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase[_ngcontent-%COMP%]{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase[_ngcontent-%COMP%]{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase[_ngcontent-%COMP%]{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase[_ngcontent-%COMP%]{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-28[_ngcontent-%COMP%]{font-size:28px;letter-spacing:.7px;line-height:1.4em}.text-28.text-uppercase[_ngcontent-%COMP%]{font-size:28px;letter-spacing:1.68px;line-height:1.25em;text-transform:uppercase}.text-header[_ngcontent-%COMP%]{font-weight:700}.text--code[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.text-xlight[_ngcontent-%COMP%]{font-weight:200}.text-light[_ngcontent-%COMP%]{font-weight:300}.text-medium[_ngcontent-%COMP%]{font-weight:500}.text-semibold[_ngcontent-%COMP%]{font-weight:600}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-underline[_ngcontent-%COMP%]{text-decoration:underline}.context-label__latin[_ngcontent-%COMP%], .text-italic[_ngcontent-%COMP%]{font-style:italic}.text-bright[_ngcontent-%COMP%]{color:#fff}.text-dim[_ngcontent-%COMP%]{color:#96a8c0}.text-error[_ngcontent-%COMP%]{color:#ed4758}.text-left[_ngcontent-%COMP%]{text-align:left}.text-center[_ngcontent-%COMP%]{text-align:center}.text-right[_ngcontent-%COMP%]{text-align:right}.text-ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link[_ngcontent-%COMP%], .text-link[_ngcontent-%COMP%]:visited{color:inherit;cursor:pointer}.text-link[_ngcontent-%COMP%]:not(.text-underline), .text-link[_ngcontent-%COMP%]:visited:not(.text-underline){text-decoration:none}.text-success[_ngcontent-%COMP%]{color:#38de38}.text-danger[_ngcontent-%COMP%]{color:#de3535}.text-info[_ngcontent-%COMP%]{color:#2d72dc}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.text-pre-line[_ngcontent-%COMP%]{white-space:pre-line}.context-label[_ngcontent-%COMP%]{z-index:12}.context-label__actions[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center}.context-label__action[_ngcontent-%COMP%]{cursor:pointer}.context-label__action--selected[_ngcontent-%COMP%]{color:#2d72dc}.context-label__header[_ngcontent-%COMP%]{margin-left:4px}.context-label__latin[_ngcontent-%COMP%]{display:block;margin-left:4px}.context-label__latin[_ngcontent-%COMP%], .context-label__more[_ngcontent-%COMP%]{margin-bottom:4px;font-size:10px;letter-spacing:.25px;line-height:1.4em}.context-label__more[_ngcontent-%COMP%]{margin-left:-4px;margin-top:4px}.context-label--more[_ngcontent-%COMP%]   .context-label__actions[_ngcontent-%COMP%], .context-label--more[_ngcontent-%COMP%]   .context-label__header[_ngcontent-%COMP%]{margin-top:4px}"],data:{animation:[Object(du.n)("show",[Object(du.m)(":enter",[Object(du.j)([Object(du.l)({height:"0"}),Object(du.e)("125ms ease-in-out",Object(du.l)({height:"*"}))])])])]},changeDetection:0}),function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);r>3&&a&&Object.defineProperty(t,n,a)}([Object(L.d)(zs.getQuerying),Xd("design:type",J.a)],ig.prototype,"querying$",void 0),ig),ag=function(e){return e.Normal="normal",e.Compact="compact",e}({}),sg=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},cg=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},lg=["image"],pg=["imagePre"],ug=["imagePost"],dg=["imageContainer"];function gg(e,t){if(1&e&&(j.Qb(0,"span",8),j.hc(1,"markdown")),2&e){var n=j.gc();j.lc("innerHTML",j.ic(1,1,n.label),j.yc)}}function hg(e,t){if(1&e&&j.Qb(0,"img",9,10),2&e){var n=j.gc();j.lc("src",n.imageUrl,j.Ac)}}function fg(e,t){if(1&e&&j.Qb(0,"img",11,12),2&e){var n=j.gc();j.lc("src",n.imageUrl,j.Ac)}}var bg,mg=((bg=function(){function e(t,n,i){y(this,e),this.renderer=t,this.engineService=n,this.animationService=i,this.ngUnsubscribe=new Z.a,this.loopImage=!1}return v(e,[{key:"ngOnInit",value:function(){this.initChapterListener(),this.initTimelineListener()}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"initChapterListener",value:function(){var e=this;this.selectedChapterId$.pipe(Object(Y.a)((function(e){return null!=e})),Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){e.timerange=e.animationService.getChapterLocalTimerange(t)}))}},{key:"initTimelineListener",value:function(){var e=this;Object(Ca.a)(this.engineService.getEvent(yn.TimelineScrubbed),this.engineService.getEvent(yn.TimelinePlaying)).pipe(Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){var n=e.getChapterPercent(t.time);e.moveImage(n)}))}},{key:"moveImage",value:function(e){var t=this.image.nativeElement.getBoundingClientRect().width;this.renderer.setStyle(this.imageContainer.nativeElement,"transform","translate(".concat(e/100*-t,"px, 0)")),this.loopImage&&(this.renderer.setStyle(this.imagePre.nativeElement,"transform","translate(".concat(-t,"px, 0)")),this.renderer.setStyle(this.imagePost.nativeElement,"transform","translate(".concat(t,"px, 0)")))}},{key:"getChapterPercent",value:function(e){var t=this.timerange,n=t.firstTime,i=t.lastTime,o=this.animationService.mapGlobalTimeToLocal(e).time;return Math.max(n,Math.min(o,i))/i*100}}]),e}()).\u0275fac=function(e){return new(e||bg)(j.Pb(j.H),j.Pb(Sn),j.Pb($r))},bg.\u0275cmp=j.Jb({type:bg,selectors:[["app-ticker-block-item"]],viewQuery:function(e,t){var n;1&e&&(j.Ec(lg,!0),j.Pc(pg,!0),j.Pc(ug,!0),j.Ec(dg,!0)),2&e&&(j.sc(n=j.dc())&&(t.image=n.first),j.sc(n=j.dc())&&(t.imagePre=n.first),j.sc(n=j.dc())&&(t.imagePost=n.first),j.sc(n=j.dc())&&(t.imageContainer=n.first))},inputs:{label:"label",imageUrl:"imageUrl",loopImage:"loopImage"},decls:8,vars:4,consts:[[1,"ticker-block-item"],["class","ticker-block-item__label html",3,"innerHTML",4,"ngIf"],[1,"ticker-block__image-container"],["imageContainer",""],["class","ticker-block-item__image ticker-block-item__image--pre",3,"src",4,"ngIf"],["class","ticker-block-item__image ticker-block-item__image--post",3,"src",4,"ngIf"],[1,"ticker-block-item__image",3,"src"],["image",""],[1,"ticker-block-item__label","html",3,"innerHTML"],[1,"ticker-block-item__image","ticker-block-item__image--pre",3,"src"],["imagePre",""],[1,"ticker-block-item__image","ticker-block-item__image--post",3,"src"],["imagePost",""]],template:function(e,t){1&e&&(j.Vb(0,"div",0),j.Ic(1,gg,2,3,"span",1),j.Vb(2,"div",2,3),j.Ic(4,hg,2,1,"img",4),j.Ic(5,fg,2,1,"img",5),j.Qb(6,"img",6,7),j.Ub(),j.Ub()),2&e&&(j.Db(1),j.lc("ngIf",t.label),j.Db(3),j.lc("ngIf",t.loopImage),j.Db(1),j.lc("ngIf",t.loopImage),j.Db(1),j.lc("src",t.imageUrl,j.Ac))},directives:[we.l],pipes:[Jd.b],styles:['.ticker-block-item[_ngcontent-%COMP%]{background:#f9fafd;background:linear-gradient(90deg,#f9fafd 20%,hsla(0,0%,100%,0) 40%,#fff 60%,#f9fafd 80%);overflow:hidden;padding-left:50%;position:relative}.ticker-block-item[_ngcontent-%COMP%]:hover   .ticker-block-item__label[_ngcontent-%COMP%]{background:hsla(0,0%,100%,.9)}.ticker-block-item[_ngcontent-%COMP%]:after{content:"";display:block;position:absolute;left:50%;top:0;height:100%;width:1px;background:red;box-shadow:0 0 0 4px rgba(255,0,0,.2);z-index:10}.ticker-block-item__label[_ngcontent-%COMP%]{position:absolute;z-index:10;left:4px;top:4px;border-radius:8px;padding:2px 6px;font-size:12px;border:1px solid rgba(16,24,35,.5);background:hsla(0,0%,100%,.55)}.ticker-block-item__image-container[_ngcontent-%COMP%]{position:relative}.ticker-block-item__image[_ngcontent-%COMP%]{display:block}.ticker-block-item__image--post[_ngcontent-%COMP%], .ticker-block-item__image--pre[_ngcontent-%COMP%]{position:absolute;top:0;left:0}'],changeDetection:0}),sg([Object(L.d)(zs.getAnimationPlaying),cg("design:type",J.a)],bg.prototype,"animationPlaying$",void 0),sg([Object(L.d)(vs.getSelectedChapterId),cg("design:type",J.a)],bg.prototype,"selectedChapterId$",void 0),bg);function vg(e,t){if(1&e&&j.Qb(0,"app-ticker-block-item",3),2&e){var n=t.$implicit,i=j.gc(2);j.lc("imageUrl",n.urls.default)("label",n.caption)("loopImage",i.tickerBlock.loopImage)}}function yg(e,t){if(1&e&&(j.Vb(0,"div",1),j.Ic(1,vg,1,3,"app-ticker-block-item",2),j.Ub()),2&e){var n=j.gc();j.Db(1),j.lc("ngForOf",n.tickerBlock.images)}}var xg,Og,wg,kg=((wg=function(){function e(){y(this,e),this.ngUnsubscribe=new Z.a}return v(e,[{key:"ngOnInit",value:function(){}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}}]),e}()).\u0275fac=function(e){return new(e||wg)},wg.\u0275cmp=j.Jb({type:wg,selectors:[["app-ticker-block"]],inputs:{tickerBlock:"tickerBlock"},decls:1,vars:1,consts:[["class","ticker-block",4,"ngIf"],[1,"ticker-block"],[3,"imageUrl","label","loopImage",4,"ngFor","ngForOf"],[3,"imageUrl","label","loopImage"]],template:function(e,t){1&e&&j.Ic(0,yg,2,1,"div",0),2&e&&j.lc("ngIf",t.tickerBlock)},directives:[we.l,we.k,mg],styles:[""],changeDetection:0}),wg),Cg=((Og=function(){function e(t,n){y(this,e),this.domSanitizer=t,this.markdownService=n}return v(e,[{key:"html",set:function(e){this.safeHTML=this.domSanitizer.bypassSecurityTrustHtml(e||"")}},{key:"markdownText",set:function(e){this.html=this.markdownService.compile(e,!0)}},{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||Og)(j.Pb(U.b),j.Pb(Jd.c))},Og.\u0275cmp=j.Jb({type:Og,selectors:[["app-html"]],inputs:{html:"html",markdownText:"markdownText"},decls:1,vars:1,consts:[[1,"html",3,"innerHTML"]],template:function(e,t){1&e&&j.Qb(0,"div",0),2&e&&j.lc("innerHTML",t.safeHTML,j.yc)},styles:[""],encapsulation:2,changeDetection:0}),Og),Sg=((xg=function(){function e(){y(this,e),this.layout=ag.Normal}return v(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||xg)},xg.\u0275cmp=j.Jb({type:xg,selectors:[["app-markdown-block"]],inputs:{markdownBlock:"markdownBlock",layout:"layout"},decls:2,vars:1,consts:[[1,"markdown-block"],[3,"markdownText"]],template:function(e,t){1&e&&(j.Vb(0,"div",0),j.Qb(1,"app-html",1),j.Ub()),2&e&&(j.Db(1),j.lc("markdownText",t.markdownBlock.markdown))},directives:[Cg],styles:[""],encapsulation:2,changeDetection:0}),xg);function _g(e,t){if(1&e&&j.Qb(0,"app-icon",5),2&e){var n=j.gc();j.lc("icon",n.icon)}}function jg(e,t){if(1&e&&j.Qb(0,"span",6),2&e){var n=j.gc();j.Fc("background-image","url("+n.src+")")}}function Pg(e,t){if(1&e&&(j.Vb(0,"span",7),j.Kc(1),j.Ub()),2&e){var n=j.gc();j.Db(1),j.Mc(" ",n.label," ")}}var Mg,Ig=function(e,t,n,i,o,r,a,s,c,l,p,u,d,g,h,f,b){return{"pin-button--selected":e,"pin-button--disabled":t,"pin-button--small":n,"pin-button--medium":i,"pin-button--large":o,"pin-button--ghost":r,"pin-button--primary":a,"pin-button--secondary":s,"pin-button--outline":c,"pin-button--floating":l,"pin-button--dark":p,"pin-button--row":u,"pin-button--circle":d,"pin-button--square":g,"pin-button--rounded":h,"pin-button--fill":f,"pin-button--left":b}},zg=["*"],Tg=function(e){return e.Circle="circle",e.Rounded="rounded",e.Square="square",e}({}),Ug=function(e){return e.Left="left",e.Center="center",e}({}),Dg=((Mg=function(){function e(t){y(this,e),this.elRef=t,this.selectable=!1,this.size="medium",this.buttonType="default",this.buttonShape=Tg.Circle,this.buttonAlign=Ug.Center,this.direction="column",this.fill=!1,this._selected=!1,this.disabled=!1,this.selectedChange=new j.p}return v(e,[{key:"selected",get:function(){return this._selected},set:function(e){this._selected=e,this.selectedChange=new j.p}},{key:"ngOnInit",value:function(){}},{key:"handleClick",value:function(){this.disabled||this.selectable&&(this.selected=!this.selected)}},{key:"focus",value:function(e){this.elRef&&this.elRef.nativeElement.focus()}}]),e}()).\u0275fac=function(e){return new(e||Mg)(j.Pb(j.m))},Mg.\u0275cmp=j.Jb({type:Mg,selectors:[["app-pin-button"],["button","app-pin-button",""]],inputs:{icon:"icon",src:"src",description:"description",label:"label",selectable:"selectable",size:"size",buttonType:"buttonType",buttonShape:"buttonShape",buttonAlign:"buttonAlign",direction:"direction",fill:"fill",selected:"selected",disabled:"disabled"},outputs:{selectedChange:"selectedChange"},ngContentSelectors:zg,decls:6,vars:22,consts:[[1,"pin-button",3,"ngClass","click"],[1,"pin-button__pin"],["style","font-size: 14px !important",3,"icon",4,"ngIf"],["class","pin-button__image",3,"backgroundImage",4,"ngIf"],["class","pin-button__label",4,"ngIf"],[2,"font-size","14px !important",3,"icon"],[1,"pin-button__image"],[1,"pin-button__label"]],template:function(e,t){1&e&&(j.kc(),j.Vb(0,"span",0),j.cc("click",(function(){return t.handleClick()})),j.Vb(1,"span",1),j.Ic(2,_g,1,1,"app-icon",2),j.Ic(3,jg,1,2,"span",3),j.jc(4),j.Ub(),j.Ic(5,Pg,2,1,"span",4),j.Ub()),2&e&&(j.lc("ngClass",j.rc(4,Ig,[t.selected,t.disabled,"small"===t.size,"medium"===t.size,"large"===t.size,"ghost"===t.buttonType,"primary"===t.buttonType,"secondary"===t.buttonType,"outline"===t.buttonType,"floating"===t.buttonType,"dark"===t.buttonType,"row"===t.direction,"circle"==t.buttonShape,"square"==t.buttonShape,"rounded"==t.buttonShape,t.fill,"left"===t.buttonAlign])),j.Db(2),j.lc("ngIf",t.icon),j.Db(1),j.lc("ngIf",t.src),j.Db(2),j.lc("ngIf",t.label))},directives:[we.i,we.l,vp],styles:[".text-8{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-28{font-size:28px;letter-spacing:.7px;line-height:1.4em}.text-28.text-uppercase{font-size:28px;letter-spacing:1.68px;line-height:1.25em;text-transform:uppercase}.text-header{font-weight:700}.text--code{font-family:Courier New,Courier,monospace}.text-uppercase{text-transform:uppercase}.text-xlight{font-weight:200}.text-light{font-weight:300}.text-medium{font-weight:500}.text-semibold{font-weight:600}.text-bold{font-weight:700}.text-underline{text-decoration:underline}.text-italic{font-style:italic}.text-bright{color:#fff}.text-dim{color:#96a8c0}.text-error{color:#ed4758}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.text-ellipsis{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link,.text-link:visited{color:inherit;cursor:pointer}.text-link:not(.text-underline),.text-link:visited:not(.text-underline){text-decoration:none}.text-success{color:#38de38}.text-danger{color:#de3535}.text-info{color:#2d72dc}.text-nowrap{white-space:nowrap}.text-pre-line{white-space:pre-line}button[app-pin-button]{border-color:transparent;background:none;border-width:0;padding:0;outline:none;margin:0;pointer-events:all}button[app-pin-button]::-moz-focus-inner{border:0}button[app-pin-button]:not([disabled]):hover{cursor:pointer}button[app-pin-button]:focus .pin-button__pin{outline:2px solid #fff;outline-offset:-4px}button[app-pin-button]:focus :not(.pin-button--selected) .pin-button__pin{outline:2px solid #2d72dc!important;outline-offset:-2px}button[app-pin-button]:focus :not(.pin-button--selected).pin-button--dark .pin-button__pin{background-color:#61779e!important}button[app-pin-button]:focus .pin-button--secondary .pin-button__pin{outline:2px solid #fff;outline-offset:-4px}button[app-pin-button][disabled]{pointer-events:none}.pin-button{display:inline-flex;flex-flow:column;align-items:center;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-tap-highlight-color:rgba(0,0,0,0);-webkit-tap-highlight-color:transparent}.pin-button:hover{cursor:pointer}.pin-button:hover:not(.pin-button--selected):not(.pin-button--disabled) .pin-button__pin{background:rgba(215,224,234,.6)}.pin-button:not(.pin-button--selected):active:hover .pin-button__pin{background:#d7e0ea}.pin-button--selected .pin-button__pin{background-color:#2d72dc;color:#fff}.pin-button--selected .pin-button__label{color:#2d72dc;font-weight:600}.pin-button--small .pin-button__pin{border-radius:14px;min-width:28px;height:28px}.pin-button--small .pin-button__label{margin-top:0}.pin-button--large .pin-button__pin{font-size:20px;letter-spacing:.5px;line-height:1.4em}.pin-button--left .pin-button__pin{justify-content:flex-start}.pin-button--row{flex-direction:row}.pin-button--row .pin-button__label{margin:0 0 0 4px}.pin-button--ghost:not(.pin-button--selected) .pin-button__pin{background:transparent}.pin-button--outline:not(.pin-button--selected) .pin-button__pin{background:transparent;border:1px solid #96a8c0}.pin-button--primary .pin-button__pin{background:#de3535;color:#fff}.pin-button--primary:not(.pin-button--selected):not(.pin-button--disabled) .pin-button__pin{background:#de3535!important;color:#fff}.pin-button--primary:not(.pin-button--selected):not(.pin-button--disabled):hover .pin-button__pin{background:#e24b4b}.pin-button--secondary .pin-button__pin,.pin-button--secondary:not(.pin-button--selected):not(.pin-button--disabled) .pin-button__pin{background:#2d72dc;color:#fff}.pin-button--secondary:not(.pin-button--selected):not(.pin-button--disabled):hover .pin-button__pin{background:#4381e0}.pin-button--disabled{opacity:.2}.pin-button--disabled:hover{cursor:auto}.pin-button--fill,.pin-button--fill .pin-button__pin{width:100%;height:100%}.pin-button--floating .pin-button__pin{background-color:#fff;box-shadow:1px -1px 2px 0 rgba(28,42,63,.1),0 1px 2px 0 rgba(28,42,63,.3)}.pin-button--dark .pin-button__pin{color:#f9fafd;background-color:#1c2a3f!important;box-shadow:1px -1px 2px 0 rgba(28,42,63,.1),0 1px 2px 0 rgba(28,42,63,.3)}.pin-button--square .pin-button__pin{border-radius:4px}.pin-button--circle .pin-button__pin{border-radius:50%}.pin-button--rounded .pin-button__pin,.pin-button__pin{border-radius:20px}.pin-button__pin{--pin-button-pin-color:#1c2a3f;display:flex;font-size:12px;float:left;min-width:40px;height:40px;align-items:center;justify-content:center;position:relative;background-color:#eaeff5;color:#1c2a3f;color:var(--pin-button-pin-color);transition:background-color 125ms}.pin-button__label{font-size:10px;letter-spacing:.25px;line-height:1.4em;color:#1c2a3f;padding:2px 0 4px}.pin-button__image{width:100%;height:100%;background-size:50%;background-repeat:no-repeat;background-position:50%}"],encapsulation:2,changeDetection:0}),Mg),Lg=r("Qu3c");function Eg(e,t){if(1&e&&(j.Vb(0,"div",3),j.Kc(1),j.Ub()),2&e){var n=j.gc();j.Db(1),j.Mc(" ",n.label," ")}}var Fg,Ag=function(e,t,n){return[e,t,n]},Rg=function(e){return e.Small="small",e.Medium="medium",e.Large="large",e.Huge="huge",e}({}),Vg=function(e){return e.Horizontal="horizontal",e.Vertical="vertical",e}({}),Ng=function(e){return e.Inline="inline",e.Block="block",e.Fill="fill",e}({}),Bg=((Fg=function(){function e(){y(this,e),this.size=Rg.Medium,this.label="",this.direction=Vg.Horizontal,this.render=Ng.Fill}return v(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||Fg)},Fg.\u0275cmp=j.Jb({type:Fg,selectors:[["app-spinner"]],inputs:{size:"size",label:"label",direction:"direction",render:"render"},decls:3,vars:6,consts:[[1,"spinner","spinner--horizontal",3,"ngClass"],[1,"spinner__circle"],["class","spinner__label",4,"ngIf"],[1,"spinner__label"]],template:function(e,t){1&e&&(j.Vb(0,"div",0),j.Qb(1,"div",1),j.Ic(2,Eg,2,1,"div",2),j.Ub()),2&e&&(j.lc("ngClass",j.pc(2,Ag,"spinner--"+t.size,"spinner--"+t.render,"spinner--"+t.direction)),j.Db(2),j.lc("ngIf",t.label.length))},directives:[we.i,we.l],styles:['@-webkit-keyframes spinner{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}@keyframes spinner{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}.spinner[_ngcontent-%COMP%]{display:inline-flex;justify-content:center;align-items:center}.spinner--small[_ngcontent-%COMP%]   .spinner__circle[_ngcontent-%COMP%], .spinner--small[_ngcontent-%COMP%]   .spinner__circle[_ngcontent-%COMP%]:after{width:11px;height:11px}.spinner--small[_ngcontent-%COMP%]   .spinner__label[_ngcontent-%COMP%]{font-size:10px}.spinner--medium[_ngcontent-%COMP%]   .spinner__circle[_ngcontent-%COMP%], .spinner--medium[_ngcontent-%COMP%]   .spinner__circle[_ngcontent-%COMP%]:after{width:14px;height:14px}.spinner--medium[_ngcontent-%COMP%]   .spinner__label[_ngcontent-%COMP%]{font-size:10px}.spinner--large[_ngcontent-%COMP%]   .spinner__circle[_ngcontent-%COMP%], .spinner--large[_ngcontent-%COMP%]   .spinner__circle[_ngcontent-%COMP%]:after{width:28px;height:28px}.spinner--large[_ngcontent-%COMP%]   .spinner__label[_ngcontent-%COMP%]{font-size:14px}.spinner--huge[_ngcontent-%COMP%]   .spinner__circle[_ngcontent-%COMP%], .spinner--huge[_ngcontent-%COMP%]   .spinner__circle[_ngcontent-%COMP%]:after{width:44px;height:44px}.spinner--huge[_ngcontent-%COMP%]   .spinner__label[_ngcontent-%COMP%]{font-size:16px}.spinner--horizontal[_ngcontent-%COMP%]{flex-direction:row}.spinner--vertical[_ngcontent-%COMP%]{align-items:center;flex-direction:column}.spinner--vertical[_ngcontent-%COMP%]   .spinner__label[_ngcontent-%COMP%]{padding:8px 0 0}.spinner--inline[_ngcontent-%COMP%]{display:inline-flex}.spinner--block[_ngcontent-%COMP%]{display:flex}.spinner--fill[_ngcontent-%COMP%]{display:flex;height:100%}.spinner__circle[_ngcontent-%COMP%]{width:14px;height:14px;border-radius:50%;border:2px solid rgba(16,24,35,.1);position:relative}.spinner__circle[_ngcontent-%COMP%]:after{-webkit-animation:spinner .4s linear infinite;animation:spinner .4s linear infinite;content:" ";border-radius:50%;border-color:hsla(0,0%,100%,.2) rgba(16,24,35,.2) transparent transparent;border-style:solid;border-width:2px;box-sizing:border-box;position:absolute;display:block;width:14px;height:14px;top:-2px;left:-2px}.spinner__label[_ngcontent-%COMP%]{padding-left:8px;font-size:14px;text-transform:uppercase}.theme-dark[_nghost-%COMP%]   .spinner__label[_ngcontent-%COMP%], .theme-dark   [_nghost-%COMP%]   .spinner__label[_ngcontent-%COMP%]{color:hsla(0,0%,100%,.2)}.theme-light[_nghost-%COMP%]   .spinner__label[_ngcontent-%COMP%], .theme-light   [_nghost-%COMP%]   .spinner__label[_ngcontent-%COMP%]{color:rgba(16,24,35,.6)}'],changeDetection:0}),Fg);function Hg(e,t){1&e&&(j.Vb(0,"div",4),j.Qb(1,"app-spinner",5),j.Ub())}var Qg,qg,$g=((Qg=function(){function e(t,n,i){y(this,e),this.dialogRef=t,this.data=n,this.changeRef=i,this.config=n}return v(e,[{key:"ngOnInit",value:function(){}},{key:"handleCloseClick",value:function(){this.dialogRef.close()}},{key:"handleImageLoaded",value:function(){this.imageLoaded=!0,this.changeRef.markForCheck()}}]),e}()).\u0275fac=function(e){return new(e||Qg)(j.Pb(ap.g),j.Pb(ap.a),j.Pb(j.i))},Qg.\u0275cmp=j.Jb({type:Qg,selectors:[["app-image-dialog"]],decls:4,vars:7,consts:[["role","dialog","aria-modal","true",1,"image-dialog",3,"click","keyup.enter"],["class","image-dialog__loading flex flex-column p-8",4,"ngIf"],[1,"image-dialog__image",3,"src","title","alt","load"],["type","button","app-pin-button","","buttonType","dark","size","large","icon","times","aria-label","Close","matTooltip","Close","matTooltipPosition","left",1,"image-dialog__close"],[1,"image-dialog__loading","flex","flex-column","p-8"],["size","huge"]],template:function(e,t){1&e&&(j.Vb(0,"div",0),j.cc("click",(function(){return t.handleCloseClick()}))("keyup.enter",(function(){return t.handleCloseClick()})),j.Ic(1,Hg,2,0,"div",1),j.Vb(2,"img",2),j.cc("load",(function(){return t.handleImageLoaded()})),j.Ub(),j.Qb(3,"button",3),j.Ub()),2&e&&(j.Eb("aria-label",(t.config.title||t.config.alt||"")+" Image Dialog"),j.Db(1),j.lc("ngIf",!t.imageLoaded),j.Db(1),j.lc("src",t.config.src,j.Ac)("title",t.config.title||"")("alt",t.config.alt||""),j.Eb("aria-label",t.config.title||""),j.Db(1),j.Eb("aria-label","Close Dialog"))},directives:[we.l,Dg,Lg.c,Bg],styles:[".image-dialog[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%;width:100%}.image-dialog__loading[_ngcontent-%COMP%]{position:absolute}.image-dialog__image[_ngcontent-%COMP%]{max-width:100%;max-height:100vh}.image-dialog__close[_ngcontent-%COMP%]{position:fixed;top:24px;right:24px}"],changeDetection:0}),Qg),Wg=function(e){return e.AboutDialog="AboutDialog",e.AddTeamModelDialog="AddTeamModelDialog",e.AssignUserRoleDialog="AssignUserRoleDialog",e.BookmarkAccessDialog="BookmarkAccessDialog",e.ClipboardDialog="ClipboardDialog",e.ShareUrlDialog="ShareUrlDialog",e.ConfirmDialog="ConfirmDialog",e.ContactDialog="ContactDialog",e.GroupRestrictionDialog="GroupRestrictionDialog",e.ImageDialog="ImageDialog",e.ImportDialog="ImportDialog",e.JoinDomainDialog="JoinDomainDialog",e.LimitDialog="LimitDialog",e.ManageDialog="ManageDialog",e.PremiumContentDialog="PremiumContentDialog",e.PricingDialog="PricingDialog",e.ProfileDialog="ProfileDialog",e.QuizSettingsDialog="QuizSettingsDialog",e.SaveAsBookmarkDialog="SaveAsBookmarkDialog",e.SaveBookmarkDialog="SaveBookmarkDialog",e.SaveModuleDialog="SaveModuleDialog",e.TransferUserContentDialog="TransferUserContentDialog",e.RemoveUserDialog="RemoveUserDialog",e.MergeModuleDialog="MergeModuleDialog",e.MergeConflictDialog="MergeConflictDialog",e.WelcomeTourDialog="WelcomeTourDialog",e.TrialExpiredDialog="TrialExpiredDialog",e.PremiumAccessDialog="PremiumAccessDialog",e.ConfirmRoleDialog="ConfirmRoleDialog",e.CollectionNameDialog="CollectionNameDialog",e.PublicViewGateDialog="PublicViewGateDialog",e}({}),Kg=["imageView"],Gg=((qg=function(){function e(t){y(this,e),this.dialog=t,this.fit="normal",this.fullscreenEnabled=!1}return v(e,[{key:"handleFullscreen",value:function(e){this.dialog.open($g,{id:Wg.ImageDialog,backdropClass:"bd-dialog-backdrop",panelClass:"bd-dialog-panel",disableClose:!1,data:{src:this.fullscreenSrc||this.src,alt:this.alt||""}}),e.stopPropagation()}}]),e}()).\u0275fac=function(e){return new(e||qg)(j.Pb(ap.b))},qg.\u0275cmp=j.Jb({type:qg,selectors:[["app-image-view"]],viewQuery:function(e,t){var n;1&e&&j.Ec(Kg,!0),2&e&&j.sc(n=j.dc())&&(t.imageView=n.first)},inputs:{fit:"fit",fitSize:"fitSize",src:"src",fullscreenSrc:"fullscreenSrc",alt:"alt"},decls:7,vars:8,consts:[["role","button","tabindex","0","matTooltip","Expand",1,"image-view",3,"click","keyup.enter"],["imageView",""],[1,"visually-hidden"],[1,"image-view__image",3,"src"],["aria-hidden","true",1,"image-view__overlay"],["icon","expand-alt",1,"image-view__icon"]],template:function(e,t){1&e&&(j.Vb(0,"div",0,1),j.cc("click",(function(e){return t.handleFullscreen(e)}))("keyup.enter",(function(e){return t.handleFullscreen(e)})),j.Vb(2,"span",2),j.Kc(3,"Click to expand the image"),j.Ub(),j.Qb(4,"img",3),j.Vb(5,"div",4),j.Qb(6,"app-icon",5),j.Ub(),j.Ub()),2&e&&(j.Hb("image-view--auto-fit","auto"===t.fit),j.Db(4),j.Fc("max-width","auto"===t.fit&&t.fitSize?t.fitSize+"px":"100%")("max-height","auto"===t.fit&&t.fitSize?t.fitSize+"px":"100%"),j.lc("src",t.src,j.Ac),j.Eb("alt",t.alt))},directives:[Lg.c,vp],styles:[".image-view[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:inherit;min-height:32px;position:relative;background-color:#f9fafd}.image-view__image[_ngcontent-%COMP%]{width:auto;height:auto}.image-view--auto-fit[_ngcontent-%COMP%]   .image-view__image[_ngcontent-%COMP%]{max-width:100%;height:auto}.image-view__overlay[_ngcontent-%COMP%]{background:rgba(28,42,63,.3);color:#fff;display:flex;flex-direction:row;align-items:center;justify-content:center;padding:8px;position:absolute;top:0;bottom:0;left:0;right:0;opacity:0;transition:opacity .25s}.image-view__icon[_ngcontent-%COMP%]{text-shadow:0 0 2px rgba(0,0,0,.6)}.image-view[_ngcontent-%COMP%]:hover{cursor:pointer}.image-view[_ngcontent-%COMP%]:hover   .image-view__overlay[_ngcontent-%COMP%]{opacity:1}.image-view[_ngcontent-%COMP%]:focus{outline:2px solid #2d72dc!important}.image-view[_ngcontent-%COMP%]:focus   .image-view__overlay[_ngcontent-%COMP%]{opacity:1}"],changeDetection:0}),qg);function Zg(e,t){if(1&e&&(j.Vb(0,"div",6),j.Qb(1,"app-image-view",7),j.Ub()),2&e){var n=j.gc(2);j.Hb("mb-3",n.currentImage.caption),j.Db(1),j.lc("src",n.currentImage.urls.small)("fullscreenSrc",n.currentImage.urls.default)("alt",n.currentImage.alt)("fit",n.fit)("fitSize",n.fitSize)}}function Jg(e,t){if(1&e&&j.Qb(0,"app-html",8),2&e){var n=j.gc(2);j.lc("markdownText",n.currentImage.caption)}}function Xg(e,t){if(1&e){var n=j.Wb();j.Vb(0,"div",9),j.Vb(1,"button",10),j.cc("click",(function(){return j.xc(n),j.gc(2).handlePrevClick()})),j.Ub(),j.Vb(2,"button",11),j.cc("click",(function(){return j.xc(n),j.gc(2).handleNextClick()})),j.Ub(),j.Ub()}}function Yg(e,t){if(1&e&&(j.Vb(0,"div",1),j.Vb(1,"div",2),j.Ic(2,Zg,2,7,"div",3),j.Ic(3,Jg,1,1,"app-html",4),j.Ic(4,Xg,3,0,"div",5),j.Ub(),j.Ub()),2&e){var n=j.gc();j.Hb("images-block--slideshow",n.images&&n.images.length>1),j.Db(2),j.lc("ngIf",n.currentImage.urls),j.Db(1),j.lc("ngIf",n.currentImage.caption),j.Db(1),j.lc("ngIf",n.images.length>1)}}var eh,th=((eh=function(){function e(){y(this,e),this.layout=ag.Normal}return v(e,[{key:"imagesBlock",get:function(){return this._imagesBlock},set:function(e){this._imagesBlock=e;var t=Object(ie.get)(e,"images",[]);t.length&&(this.images=t,this.currentImage=this.images[0])}},{key:"fit",get:function(){return"compact"===this.layout?"auto":"normal"}},{key:"fitSize",get:function(){return"compact"===this.layout?100:void 0}},{key:"ngOnInit",value:function(){}},{key:"handlePrevClick",value:function(){var e=this.getCurrentImageIndex();--e<0&&(e=this.images.length-1),this.currentImage=this.images[e]}},{key:"handleNextClick",value:function(){var e=this.getCurrentImageIndex();++e>=this.images.length&&(e=0),this.currentImage=this.images[e]}},{key:"getCurrentImageIndex",value:function(){return this.images.indexOf(this.currentImage)}}]),e}()).\u0275fac=function(e){return new(e||eh)},eh.\u0275cmp=j.Jb({type:eh,selectors:[["app-images-block"]],inputs:{imagesBlock:"imagesBlock",layout:"layout"},decls:1,vars:1,consts:[["class","images-block",3,"images-block--slideshow",4,"ngIf"],[1,"images-block"],[1,"images-block__content"],["class","images-block__image-container",3,"mb-3",4,"ngIf"],["class","images-block__caption",3,"markdownText",4,"ngIf"],["class","images-block__actions",4,"ngIf"],[1,"images-block__image-container"],[1,"images-block__image-view",3,"src","fullscreenSrc","alt","fit","fitSize"],[1,"images-block__caption",3,"markdownText"],[1,"images-block__actions"],["type","button","app-pin-button","","icon","chevron-left","size","small","buttonType","ghost","matTooltip","Previous Image","aria-label","Previous Image",3,"click"],["type","button","app-pin-button","","icon","chevron-right","size","small","buttonType","ghost","matTooltip","Next Image","aria-label","Next Image",3,"click"]],template:function(e,t){1&e&&j.Ic(0,Yg,5,5,"div",0),2&e&&j.lc("ngIf",t.currentImage)},directives:[we.l,Gg,Cg,Dg,Lg.c],styles:[".images-block__header{display:flex;align-items:center;justify-content:space-between;margin-bottom:16px}.images-block__label{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase;color:#374a68;font-weight:600;display:flex;align-items:center;min-height:28px}.images-block__image-container{display:flex;justify-content:center;background-color:#f9fafd}.images-block__image-view{display:flex;height:100%;min-height:32px}.images-block__caption{font-size:12px;margin-top:12px}.images-block__actions{display:flex;justify-content:flex-end;margin-top:14px}.images-block--slideshow .images-block__image-container{height:200px}"],encapsulation:2,changeDetection:0}),eh);function nh(e,t){if(1&e&&j.Qb(0,"app-ticker-block",6),2&e){var n=j.gc().$implicit;j.lc("tickerBlock",n)}}function ih(e,t){if(1&e&&j.Qb(0,"app-markdown-block",7),2&e){var n=j.gc().$implicit,i=j.gc(2);j.lc("markdownBlock",n)("layout",i.layout)}}function oh(e,t){if(1&e&&j.Qb(0,"app-images-block",8),2&e){var n=j.gc().$implicit,i=j.gc(2);j.lc("imagesBlock",n)("layout",i.layout)}}function rh(e,t){if(1&e&&(j.Vb(0,"div"),j.Tb(1,2),j.Ic(2,nh,1,1,"app-ticker-block",3),j.Ic(3,ih,1,2,"app-markdown-block",4),j.Ic(4,oh,1,2,"app-images-block",5),j.Sb(),j.Ub()),2&e){var n=t.$implicit;j.Hb("mv-2",t.index>0),j.Db(1),j.lc("ngSwitch",n.type),j.Db(1),j.lc("ngSwitchCase","ticker"),j.Db(1),j.lc("ngSwitchCase","markdown"),j.Db(1),j.lc("ngSwitchCase","images")}}function ah(e,t){if(1&e&&(j.Tb(0),j.Ic(1,rh,5,6,"div",1),j.Sb()),2&e){var n=j.gc();j.Db(1),j.lc("ngForOf",n.contentBlocks)}}var sh,ch=((sh=function(){function e(){y(this,e),this._contentBlocks=[],this.layout=ag.Normal,this.include=[],this.exclude=[]}return v(e,[{key:"contentBlocks",get:function(){var e=this;return this._contentBlocks.filter((function(t){return!e.include.length||e.include.includes(t.type)})).filter((function(t){return!e.exclude.length||!e.exclude.includes(t.type)}))},set:function(e){this._contentBlocks=e}},{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||sh)},sh.\u0275cmp=j.Jb({type:sh,selectors:[["app-content-blocks"]],inputs:{contentBlocks:"contentBlocks",layout:"layout",include:"include",exclude:"exclude"},decls:1,vars:1,consts:[[4,"ngIf"],[3,"mv-2",4,"ngFor","ngForOf"],[3,"ngSwitch"],[3,"tickerBlock",4,"ngSwitchCase"],[3,"markdownBlock","layout",4,"ngSwitchCase"],[3,"imagesBlock","layout",4,"ngSwitchCase"],[3,"tickerBlock"],[3,"markdownBlock","layout"],[3,"imagesBlock","layout"]],template:function(e,t){1&e&&j.Ic(0,ah,2,1,"ng-container",0),2&e&&j.lc("ngIf",t.contentBlocks.length>0)},directives:[we.l,we.k,we.n,we.o,kg,Sg,th],styles:[""],encapsulation:2,changeDetection:0}),sh),lh=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},ph=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function uh(e,t){if(1&e&&(j.Vb(0,"div",6),j.Qb(1,"app-content-blocks",7),j.Ub()),2&e){var n=j.gc();j.Db(1),j.lc("contentBlocks",n.label.contentBlocks)("layout","compact")}}function dh(e,t){if(1&e&&(j.Qb(0,"div",8),j.hc(1,"markdown")),2&e){var n=j.gc();j.lc("innerHTML",j.ic(1,1,n.label.description),j.yc)}}var gh,hh,fh,bh=((gh=function(){function e(t,n,i,o){y(this,e),this.store=t,this.labelsService=n,this.engineService=i,this.changeDetectorRef=o,this.emitEvents=!0,this.collapsedMode=Kr.None,this.collapsed=!1,this.pinDraggable=!1,this.tagDraggable=!1,this.descriptionCollapsed=!1,this.tagCollapsed=!1,this.ngUnsubscribe=new Z.a}return v(e,[{key:"isCollapsed",get:function(){if(this.collapsedMode===Kr.Toggle){var e=this.store.selectSnapshot(kc.getSelectedLabelId)===this.label.id;return this.collapsed&&!e}return this.collapsed}},{key:"hasContent",get:function(){return this.labelsService.hasContent(this.label)}},{key:"ngOnInit",value:function(){var e=this;this.selectedLabel$.pipe(Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){return e.handleLabelSelected(t)})),this.store.select(kc.getChapterLabels).pipe(Object(X.a)(this.ngUnsubscribe),Object(Gp.a)(100)).subscribe((function(){e.sequence=e.store.selectSnapshot(kc.getLabelSequence(e.label)),e.changeDetectorRef.markForCheck()})),this.descriptionCollapsed=this.label.collapseDescription,this.tagCollapsed=this.label.hideTag}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"handleLabelUpdated",value:function(e){var t=e.label,n=e.shouldPreserve;this.store.dispatch(new oa(t,n))}},{key:"handleOffsetUpdated",value:function(e){var t=e.labelId,n=e.offset;this.store.dispatch(new Zr(t,n))}},{key:"handlePinClicked",value:function(e){this.selectLabel()}},{key:"handleTagClicked",value:function(e){this.selectLabel()}},{key:"selectLabel",value:function(){var e=this.store.selectSnapshot(kc.getSelectedLabel);this.store.dispatch(new sa(e&&e.id===this.label.id?null:this.label)),this.emitEngineEvent(yn.HotspotsPicked,{id:this.label.id}),this.emitEngineEvent(yn.LabelsPicked,{labelId:this.label.id})}},{key:"emitEngineEvent",value:function(e,t){this.emitEvents&&this.engineService.fireEvent(e,t)}},{key:"handleDisplayUpdated",value:function(e){this.emitEngineEvent(yn.HotspotsDisplayUpdated,e)}},{key:"handlePositionUpdated",value:function(e){this.emitEngineEvent(yn.HotspotsPositionUpdated,e.positionUpdate),this.emitEngineEvent(yn.LabelsMoved,{labelId:e.positionUpdate.id,canvasPosition:[e.positionUpdate.canvasPos.x,e.positionUpdate.canvasPos.y],occluded:e.positionUpdate.occluded||!e.onCanvas})}},{key:"handleHoverStart",value:function(e){this.emitEngineEvent(yn.HotspotsEntered,{id:e.labelId}),this.emitEngineEvent(yn.LabelsEntered,{labelId:e.labelId})}},{key:"handleHoverEnd",value:function(e){this.emitEngineEvent(yn.HotspotsLeft,{id:e.labelId}),this.emitEngineEvent(yn.LabelsLeft,{labelId:e.labelId})}},{key:"handleLabelSelected",value:function(e){var t=this,n=e&&e.id===this.label.id,i=Object(ie.get)(e,"states[1].errands"),o=this.store.selectSnapshot(ws.getLockCamera);n&&i&&!o&&i.forEach((function(e){switch(e.type){case oo.flyToObject:t.store.dispatch(new Pt(e.value));break;case oo.flyToCamera:t.store.dispatch(new zn(e.value))}t.store.dispatch(new qn(!0))})),this.tagCollapsed=!(this.label.title||this.hasContent)||(this.label.expandTag&&this.label.hideTag?!n:this.label.hideTag),this.descriptionCollapsed=this.label.showDescription&&this.label.collapseDescription?!n:this.label.collapseDescription}}]),e}()).\u0275fac=function(e){return new(e||gh)(j.Pb(L.g),j.Pb(po),j.Pb(Sn),j.Pb(j.i))},gh.\u0275cmp=j.Jb({type:gh,selectors:[["app-story-label"]],inputs:{label:"label",emitEvents:"emitEvents",collapsedMode:"collapsedMode",collapsed:"collapsed",pinDraggable:"pinDraggable",tagDraggable:"tagDraggable"},decls:9,vars:18,consts:[[3,"label","selected","fixedScale","sequence","isCollapsed","tagCollapsed","pinDraggable","tagDraggable","descriptionCollapsed","hasContent","labelUpdated","offsetUpdated","tagClicked","pinClicked","keydown.enter","displayUpdated","positionUpdated","hoverStart","hoverEnd"],["label-header","",1,"html",3,"innerHTML"],["title",""],["label-body","",1,"html"],["class","mv-1","appEventFence","",4,"ngIf"],["data-test","labelDescription",3,"innerHTML",4,"ngIf"],["appEventFence","",1,"mv-1"],[3,"contentBlocks","layout"],["data-test","labelDescription",3,"innerHTML"]],template:function(e,t){var n;(1&e&&(j.Vb(0,"app-generic-label",0),j.cc("labelUpdated",(function(e){return t.handleLabelUpdated(e)}))("offsetUpdated",(function(e){return t.handleOffsetUpdated(e)}))("tagClicked",(function(e){return t.handleTagClicked(e)}))("pinClicked",(function(e){return t.handlePinClicked(e)}))("keydown.enter",(function(e){return t.handleTagClicked(e)}))("displayUpdated",(function(e){return t.handleDisplayUpdated(e)}))("positionUpdated",(function(e){return t.handlePositionUpdated(e)}))("hoverStart",(function(e){return t.handleHoverStart(e)}))("hoverEnd",(function(e){return t.handleHoverEnd(e)})),j.hc(1,"async"),j.hc(2,"async"),j.Qb(3,"div",1,2),j.hc(5,"markdown"),j.Vb(6,"div",3),j.Ic(7,uh,2,2,"div",4),j.Ic(8,dh,2,3,"div",5),j.Ub(),j.Ub()),2&e)&&(j.lc("label",t.label)("selected",(null==(n=j.ic(1,12,t.selectedLabel$))?null:n.id)===t.label.id)("fixedScale",j.ic(2,14,t.labelScale$))("sequence",t.sequence)("isCollapsed",t.isCollapsed)("tagCollapsed",t.tagCollapsed)("pinDraggable",t.pinDraggable)("descriptionCollapsed",t.descriptionCollapsed)("hasContent",t.hasContent),j.Db(3),j.lc("innerHTML",j.ic(5,16,t.label.title),j.yc),j.Db(4),j.lc("ngIf",t.label.contentBlocks),j.Db(1),j.lc("ngIf",t.label.description))},directives:[Zu,we.l,Mu,ch],pipes:[we.b,Jd.b],styles:[""],changeDetection:0}),lh([Object(L.d)(kc.getLabelScale),ph("design:type",J.a)],gh.prototype,"labelScale$",void 0),lh([Object(L.d)(kc.getSelectedLabel),ph("design:type",J.a)],gh.prototype,"selectedLabel$",void 0),gh),mh=r("3Pt+"),vh=((fh=function(){function e(t){y(this,e),this.controlContainer=t}return v(e,[{key:"control",get:function(){return this.formControl||this.controlContainer.control.get(this.formControlName)}},{key:"registerOnTouched",value:function(e){this.formControlDirective.valueAccessor.registerOnTouched(e)}},{key:"registerOnChange",value:function(e){this.formControlDirective.valueAccessor.registerOnChange(e)}},{key:"writeValue",value:function(e){this.formControlDirective.valueAccessor.writeValue(e)}},{key:"setDisabledState",value:function(e){this.formControlDirective.valueAccessor.setDisabledState(e)}}]),e}()).\u0275fac=function(e){return new(e||fh)(j.Pb(mh.b))},fh.\u0275cmp=j.Jb({type:fh,selectors:[["app-base-accessor-control"]],viewQuery:function(e,t){var n;1&e&&j.Ec(mh.g,!0),2&e&&j.sc(n=j.dc())&&(t.formControlDirective=n.first)},inputs:{formControl:"formControl",formControlName:"formControlName"},decls:0,vars:0,template:function(e,t){},encapsulation:2}),fh),yh=((hh=function(){function e(){y(this,e)}return v(e,[{key:"value",get:function(){return this._value},set:function(e){Object(ie.isEqual)(this._value,e)||(this._value=e,this.setFormValues(e),this.onChange(e))}},{key:"onChange",value:function(e){}},{key:"onTouched",value:function(){}},{key:"registerOnTouched",value:function(e){this.onTouched=e}},{key:"registerOnChange",value:function(e){this.onChange=e}},{key:"writeValue",value:function(e){this.value=e}},{key:"setDisabledState",value:function(e){this.disabled=e}}]),e}()).\u0275fac=function(e){return new(e||hh)},hh.\u0275cmp=j.Jb({type:hh,selectors:[["app-abstract-input-control"]],inputs:{value:"value",disabled:"disabled"},decls:0,vars:0,template:function(e,t){},encapsulation:2}),hh);function xh(e,t){if(1&e&&(j.Vb(0,"option",9),j.Kc(1),j.Ub()),2&e){var n=t.$implicit;j.lc("value",n.value),j.Db(1),j.Mc(" ",n.label.title," ")}}function Oh(e,t){if(1&e&&(j.Vb(0,"select",6),j.Vb(1,"option",7),j.Kc(2,"Select"),j.Ub(),j.Ic(3,xh,2,2,"option",8),j.Ub()),2&e){var n=j.gc();j.Db(3),j.lc("ngForOf",n.options)}}var wh,kh=((wh=function(t){n(r,t);var i=o(r);function r(e,t){var n;return y(this,r),(n=i.call(this)).formBuilder=e,n.changeRef=t,n.outline=!0,n.valueChange=new j.p,n.ngUnsubscribe=new Z.a,n.form=n.formBuilder.group({value:[""]}),n.valueControl=n.form.get("value"),n}return v(r,[{key:"options",get:function(){return this._options},set:function(e){var t=Object(ie.clone)(e);this._options=t.sort((function(e,t){return e.label.title.localeCompare(t.label.title)})),this.changeRef.markForCheck()}},{key:"ngOnInit",value:function(){this.initFormListeners()}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"initFormListeners",value:function(){var e=this;this.form.valueChanges.pipe(Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){var n=t.value;e.writeValue(n),e.valueChange.next(n)}))}},{key:"setDisabledState",value:function(t){e(s(r.prototype),"setDisabledState",this).call(this,t),t?this.form.disable():this.form.enable(),this.changeRef.markForCheck()}},{key:"setFormValues",value:function(e){this.valueControl.setValue(e),this.changeRef.markForCheck()}},{key:"getSelectedOption",value:function(){var e=this.valueControl.value;return this.options.find((function(t){return t.value===e}))}}]),r}(yh)).\u0275fac=function(e){return new(e||wh)(j.Pb(mh.e),j.Pb(j.i))},wh.\u0275cmp=j.Jb({type:wh,selectors:[["app-quiz-label-anatomy-select"]],inputs:{options:"options",outline:"outline"},outputs:{valueChange:"valueChange"},features:[j.Cb([{provide:mh.l,useExisting:Object(j.W)((function(){return wh})),multi:!0}]),j.Ab],decls:7,vars:5,consts:[[1,"label",3,"formGroup"],[1,"label__select-label","flex","text-12"],[1,"flex","justify-between","p-2","flex-auto"],[1,"mr-2"],["icon","caret-down","size","lg"],["class","input label__select","placeholder","Select Option","formControlName","value","data-test","quizLabelSelect",4,"ngIf"],["placeholder","Select Option","formControlName","value","data-test","quizLabelSelect",1,"input","label__select"],["value","","data-test","questionAnswerOption"],["class","label__option","data-test","questionAnswerOption",3,"value",4,"ngFor","ngForOf"],["data-test","questionAnswerOption",1,"label__option",3,"value"]],template:function(e,t){var n;(1&e&&(j.Vb(0,"div",0),j.Vb(1,"label",1),j.Vb(2,"div",2),j.Vb(3,"div",3),j.Kc(4),j.Ub(),j.Qb(5,"app-icon",4),j.Ub(),j.Ic(6,Oh,4,1,"select",5),j.Ub(),j.Ub()),2&e)&&(j.Hb("label--empty",""===t.valueControl.value),j.lc("formGroup",t.form),j.Db(4),j.Lc((null==(n=t.getSelectedOption())||null==n.label?null:n.label.title)||"Select"),j.Db(2),j.lc("ngIf",!t.disabled))},directives:[mh.o,mh.i,vp,we.l,mh.s,mh.n,mh.h,mh.q,mh.u,we.k],styles:[".label[_ngcontent-%COMP%]{overflow:hidden}.label__select-label[_ngcontent-%COMP%]{color:#101823;position:relative}.label__select[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;opacity:.01}.label--empty[_ngcontent-%COMP%]   .label__select-label[_ngcontent-%COMP%]{color:#96a8c0}"],changeDetection:0}),wh);function Ch(e,t){1&e&&j.Qb(0,"app-icon",8)}function Sh(e,t){1&e&&j.Qb(0,"app-icon",9)}function _h(e,t){if(1&e&&(j.Vb(0,"div",10),j.Vb(1,"em",11),j.Kc(2),j.Ub(),j.Kc(3,". "),j.Ub()),2&e){var n=j.gc(2);j.Db(2),j.Lc(n.option.label.title)}}function jh(e,t){if(1&e&&(j.Vb(0,"div",10),j.Vb(1,"p",12),j.Kc(2," You selected "),j.Vb(3,"em",11),j.Kc(4),j.Ub(),j.Kc(5,". "),j.Ub(),j.Vb(6,"p"),j.Kc(7," This is the "),j.Vb(8,"em",11),j.Kc(9),j.Ub(),j.Kc(10,". "),j.Ub(),j.Ub()),2&e){var n=j.gc(2),i=null;j.Db(4),j.Lc(null==(i=n.getSelectedLabel(n.options,n.control.value))?null:i.title.trim()),j.Db(5),j.Lc(n.option.label.title.trim())}}function Ph(e,t){if(1&e&&(j.Vb(0,"div",4),j.Ic(1,Ch,1,0,"app-icon",5),j.Ic(2,Sh,1,0,"app-icon",6),j.Ic(3,_h,4,1,"div",7),j.Ic(4,jh,11,2,"div",7),j.Ub()),2&e){var n=j.gc();j.lc("ngSwitch",n.correct),j.Db(1),j.lc("ngSwitchCase",!0),j.Db(1),j.lc("ngSwitchCase",!1),j.Db(1),j.lc("ngSwitchCase",!0),j.Db(1),j.lc("ngSwitchCase",!1)}}var Mh,Ih=((Mh=function(e){n(i,e);var t=o(i);function i(){var e;return y(this,i),(e=t.apply(this,arguments)).sequence=0,e.labelUpdated=new j.p,e}return v(i,[{key:"ngOnInit",value:function(){}},{key:"handleLabelUpdated",value:function(e){this.labelUpdated.next(e.label)}},{key:"handleOffsetUpdated",value:function(e){this.labelUpdated.next(Object.assign(Object.assign({},this.option.label),{offset:e.offset}))}},{key:"getSelectedLabel",value:function(e,t){var n=this.options.find((function(e){return e.value===t}));return n?n.label:void 0}}]),i}(vh)).\u0275fac=function(e){return zh(e||Mh)},Mh.\u0275cmp=j.Jb({type:Mh,selectors:[["app-quiz-label"]],inputs:{sequence:"sequence",collapsed:"collapsed",options:"options",option:"option",correct:"correct",mode:"mode"},outputs:{labelUpdated:"labelUpdated"},features:[j.Cb([{provide:mh.l,useExisting:Object(j.W)((function(){return Mh})),multi:!0}]),j.Ab],decls:4,vars:14,consts:[[1,"label","theme-light",3,"label","fit","opaque","pinDraggable","tagDraggable","isCollapsed","descriptionCollapsed","hasContent","sequence","labelUpdated","offsetUpdated"],["label-body","",1,"label__body"],[3,"outline","hidden","options","formControl"],["class","label__summary flex items-start",3,"ngSwitch",4,"ngIf"],[1,"label__summary","flex","items-start",3,"ngSwitch"],["class","label__icon label__icon--correct","style","font-size: 16px","icon","check-circle",4,"ngSwitchCase"],["class","label__icon label__icon--incorrect","style","font-size: 16px","icon","times-circle",4,"ngSwitchCase"],["class","label__text pl-2",4,"ngSwitchCase"],["icon","check-circle",1,"label__icon","label__icon--correct",2,"font-size","16px"],["icon","times-circle",1,"label__icon","label__icon--incorrect",2,"font-size","16px"],[1,"label__text","pl-2"],[1,"text-semibold"],[1,"pb-2"]],template:function(e,t){1&e&&(j.Vb(0,"app-generic-label",0),j.cc("labelUpdated",(function(e){return t.handleLabelUpdated(e)}))("offsetUpdated",(function(e){return t.handleOffsetUpdated(e)})),j.Vb(1,"div",1),j.Qb(2,"app-quiz-label-anatomy-select",2),j.Ic(3,Ph,5,5,"div",3),j.Ub(),j.Ub()),2&e&&(j.lc("label",t.option.label)("fit","summary"===t.mode?"fixed":"auto")("opaque",!0)("pinDraggable","edit"===t.mode)("tagDraggable","edit"===t.mode)("isCollapsed",t.collapsed)("descriptionCollapsed",!1)("hasContent",!0)("sequence",t.sequence),j.Db(2),j.lc("outline",!1)("hidden","summary"===t.mode)("options",t.options)("formControl",t.control),j.Db(1),j.lc("ngIf","summary"===t.mode))},directives:[Zu,kh,mh.n,mh.g,we.l,we.n,we.o,vp],styles:[".label__body[_ngcontent-%COMP%]{color:#101823;min-width:142px;max-width:200px}.label__icon[_ngcontent-%COMP%]{position:relative;flex-basis:0 0 20px;justify-content:center}.label__icon--correct[_ngcontent-%COMP%]{color:#83e692}.label__icon--incorrect[_ngcontent-%COMP%]{color:#f44336}.label__text[_ngcontent-%COMP%]{flex-wrap:wrap}"],changeDetection:0}),Mh),zh=j.Xb(Ih),Th=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},Uh=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function Dh(e,t){if(1&e){var n=j.Wb();j.Tb(0),j.Vb(1,"app-quiz-label",3),j.cc("labelUpdated",(function(e){j.xc(n);var i=t.index;return j.gc().handleLabelUpdated(e,i)})),j.hc(2,"async"),j.hc(3,"async"),j.hc(4,"async"),j.hc(5,"async"),j.hc(6,"async"),j.Ub(),j.Sb()}if(2&e){var i=t.$implicit,o=t.index,r=j.gc();j.Db(1),j.lc("mode",r.mode)("formControl",i)("option",j.ic(2,7,r.quizLabels$)[o])("options",j.ic(3,9,r.quizLabels$))("sequence",o+1)("correct",r.isCorrect(j.ic(4,11,r.quizLabels$)[o],j.ic(5,13,r.activeSubmitted$),o))("collapsed",j.ic(6,15,r.labelsCollapsed$))}}var Lh,Eh=((Lh=function(){function e(t,n,i,o){y(this,e),this.store=t,this.formBuilder=n,this.changeRef=i,this.router=o,this.ngUnsubscribe=new Z.a,this.mode="edit",this.form=this.formBuilder.group({options:this.formBuilder.array([])}),this.optionsArray=this.form.get("options")}return v(e,[{key:"ngOnInit",value:function(){this.initFormListeners(),this.initQuizSubmissionListeners()}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"initFormListeners",value:function(){var e=this;this.quizLabels$.pipe(Object(Zc.a)((function(e,t){var n=e.map((function(e){return e.value})),i=t.map((function(e){return e.value}));return Object(ie.isEqual)(n,i)})),Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){var n=e.store.selectSnapshot(rr.getQuizModeActive);e.buildFormOptions(t,n),e.changeRef.markForCheck()})),Object(zc.b)([this.quizModeActive$,this.quizLabels$]).pipe(Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){var n=d(t,1)[0];e.setFormEnabled(n),e.changeRef.markForCheck()}))}},{key:"initQuizSubmissionListeners",value:function(){var e=this;this.activeSubmission$.pipe(Object(Y.a)((function(e){return!Object(ie.isNil)(e)&&!Object(ie.isNil)(e.answer)&&Array.isArray(e.answer)})),Object(Zc.a)((function(e,t){return Object(ie.isEqual)(e,t)})),Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){var n=e.form.value.options,i=t.answer;Object(ie.isEqual)(n,i)||(e.form.patchValue({options:i},{emitEvent:!1,onlySelf:!0}),e.changeRef.markForCheck())})),this.form.valueChanges.pipe(Object(Zc.a)((function(e,t){return Object(ie.isEqual)(e,t)})),Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){var n=e.store.selectSnapshot(rr.getActiveQuestionId),i=e.store.selectSnapshot(rr.getActiveSubmitted),o=e.store.selectSnapshot(rr.getActiveSubmission),r=Object(ie.isNil)(o)?[]:o.answer,a=t.options;Object(ie.isNil)(i)&&(Object(ie.isEqual)(a,r)||e.store.dispatch(new Eo.SetActiveSubmission({questionId:n,answer:a})),e.changeRef.markForCheck())})),Object(zc.b)([this.quizModeActive$,this.activeSubmitted$]).subscribe((function(t){var n=d(t,2),i=n[0],o=n[1],r=e.router.url.includes("/edit");e.mode=r?"edit":i&&!Object(ie.isNil)(o)?"summary":"view",e.changeRef.markForCheck()}))}},{key:"isCorrect",value:function(e,t,n){if(!Object(ie.isNil)(t))return t.answer[n]===e.value}},{key:"handleLabelUpdated",value:function(e,t){var n=this.store.selectSnapshot(rr.getActiveQuestion);n.data.options[t].label=e,this.store.dispatch(new Eo.SetQuestion(n))}},{key:"buildFormOptions",value:function(e,t){var n=this;this.optionsArray.clear(),e.forEach((function(e){n.optionsArray.push(n.formBuilder.control(t?"":e.value))}))}},{key:"setFormEnabled",value:function(e){e?this.optionsArray.enable():this.optionsArray.disable()}}]),e}()).\u0275fac=function(e){return new(e||Lh)(j.Pb(L.g),j.Pb(mh.e),j.Pb(j.i),j.Pb(te.e))},Lh.\u0275cmp=j.Jb({type:Lh,selectors:[["app-quiz-labels"]],decls:3,vars:2,consts:[["data-test","quizLabelsElement",3,"formGroup"],["formArrayName","options"],[4,"ngFor","ngForOf"],["data-test","appQuizLabel",3,"mode","formControl","option","options","sequence","correct","collapsed","labelUpdated"]],template:function(e,t){1&e&&(j.Vb(0,"div",0),j.Vb(1,"div",1),j.Ic(2,Dh,7,17,"ng-container",2),j.Ub(),j.Ub()),2&e&&(j.lc("formGroup",t.form),j.Db(2),j.lc("ngForOf",t.optionsArray.controls))},directives:[mh.o,mh.i,mh.d,we.k,Ih,mh.n,mh.g],pipes:[we.b],styles:[""],changeDetection:0}),Th([Object(L.d)(kc.getLabelsCollapsed),Uh("design:type",J.a)],Lh.prototype,"labelsCollapsed$",void 0),Th([Object(L.d)(rr.getActiveQuestionLabels),Uh("design:type",J.a)],Lh.prototype,"quizLabels$",void 0),Th([Object(L.d)(rr.getQuizModeActive),Uh("design:type",J.a)],Lh.prototype,"quizModeActive$",void 0),Th([Object(L.d)(rr.getAllSubmissions),Uh("design:type",J.a)],Lh.prototype,"allSubmissions$",void 0),Th([Object(L.d)(rr.getActiveSubmission),Uh("design:type",J.a)],Lh.prototype,"activeSubmission$",void 0),Th([Object(L.d)(rr.getActiveSubmitted),Uh("design:type",J.a)],Lh.prototype,"activeSubmitted$",void 0),Lh),Fh=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},Ah=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function Rh(e,t){if(1&e&&(j.Qb(0,"app-context-label",5),j.hc(1,"async"),j.hc(2,"async"),j.hc(3,"async"),j.hc(4,"async"),j.hc(5,"async")),2&e){var n=j.gc(3),i=null,o=null;j.lc("label",j.ic(1,3,n.contextLabel$))("enableInfo",j.ic(2,5,n.enableContextLabelInfo$)&&(null==(i=j.ic(3,7,n.layout$))?null:i.nodeInfo.enable))("enableActions",j.ic(4,9,n.enableContextLabelActions$)&&(null==(o=j.ic(5,11,n.layout$))?null:o.contextActions.enable))}}function Vh(e,t){if(1&e&&(j.Tb(0),j.Qb(1,"app-story-label",6),j.hc(2,"async"),j.hc(3,"async"),j.hc(4,"async"),j.hc(5,"async"),j.Sb()),2&e){var n,i,o=t.$implicit,r=j.gc(3);j.Db(1),j.Hb("labels__label--hidden",!o.shown),j.lc("pinDraggable",null==(n=j.ic(2,7,r.draggable$))?null:n.pin)("tagDraggable",null==(i=j.ic(3,9,r.draggable$))?null:i.tag)("label",o)("collapsed",j.ic(4,11,r.labelsCollapsed$))("collapsedMode",j.ic(5,13,r.labelsCollapsedMode$))}}function Nh(e,t){if(1&e&&(j.Tb(0),j.Ic(1,Rh,6,13,"app-context-label",3),j.hc(2,"async"),j.hc(3,"async"),j.Ic(4,Vh,6,15,"ng-container",4),j.hc(5,"async"),j.Sb()),2&e){var n=j.gc(2);j.Db(1),j.lc("ngIf",j.ic(2,3,n.enableContextLabel$)&&j.ic(3,5,n.contextLabel$)),j.Db(3),j.lc("ngForOf",j.ic(5,7,n.labels$))("ngForTrackBy",n.trackLabel)}}function Bh(e,t){1&e&&(j.Tb(0),j.Qb(1,"app-quiz-labels"),j.Sb())}function Hh(e,t){if(1&e&&(j.Vb(0,"div",1),j.Ic(1,Nh,6,9,"ng-container",2),j.Ic(2,Bh,2,0,"ng-container",2),j.Ub()),2&e){var n=j.gc();j.Db(1),j.lc("ngIf",n.showAnatomyLabels),j.Db(1),j.lc("ngIf",n.showQuizLabels)}}var Qh,qh=((Qh=function(){function e(t,n,i,o,r,a,s,c){y(this,e),this.store=t,this.action$=n,this.router=i,this.engineService=o,this.cameraService=r,this.changeDetector=a,this.labelsService=s,this.elRef=c,this.interactive=!1,this.showAnatomyLabels=!1,this.showQuizLabels=!1,this.ngUnsubscribe=new Z.a}return v(e,[{key:"ngOnInit",value:function(){this.bindEngineEvents(),this.bindApplicationEvents(),this.labelsService.setLabelContainer(this.elRef)}},{key:"ngOnDestroy",value:function(){this.labelsService.setLabelContainer(null),this.changeDetector.detach(),this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"bindApplicationEvents",value:function(){var e=this;this.action$.pipe(Object(L.j)(_t),Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){e.handleClickNode(t)})),this.labels$.pipe(Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){e.changeDetector.markForCheck()})),this.selectedLabel$.pipe(Object(Y.a)((function(e){return null==e})),Object(X.a)(this.ngUnsubscribe)).subscribe((function(){var t=e.store.selectSnapshot(ws.getZoomed),n=e.store.selectSnapshot(ws.getLockCamera);t&&!n&&e.resetCamera()}));var t=Object(zc.b)([this.activeTool$,this.activeQuestion$]).pipe(Object(X.a)(this.ngUnsubscribe),Object(se.a)((function(t){var n=d(t,2),i=n[0],o=n[1],r=e.router.url.indexOf("/edit")>=0,a=Object(ie.get)(o,"type")===No.LabelAnatomy;return r?i===ks.Quiz:a})));Object(zc.b)([this.showLabels$,t,this.activeQuestion$]).pipe(Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){var n=d(t,3),i=n[0],o=n[1],r=n[2],a=Object(ie.get)(r,"showChapterLabels");e.showQuizLabels=o,e.showAnatomyLabels=!e.showQuizLabels&&i||a,e.changeDetector.markForCheck()})),this.store.select(vs.getSelectedChapterReadyState).pipe(Object(Y.a)((function(e){return null!=e})),Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){e.interactive=t.model,e.changeDetector.markForCheck()}))}},{key:"bindEngineEvents",value:function(){var e=this;this.action$.pipe(Object(L.j)(Lt,da),Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){e.engineService.fireEvent(t.show?yn.LabelsEnabled:yn.LabelsDisabled,null)})),this.action$.pipe(Object(L.j)(Xr),Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){e.engineService.fireEvent(yn.LabelsCreated,t.label)})),this.action$.pipe(Object(L.j)(oa),Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){e.engineService.fireEvent(yn.LabelsUpdated,t.label)})),this.action$.pipe(Object(L.j)(ua),Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){t.labels.forEach((function(n){e.engineService.fireEvent(t.shown?yn.LabelsShown:yn.LabelsHidden,{labelId:n.id})}))})),this.action$.pipe(Object(L.j)(ta),Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){e.engineService.fireEvent(yn.LabelsDestroyed,t.label)}))}},{key:"handleClickNode",value:function(e){var t=this,n=this.store.selectSnapshot(zs.getActiveTool);null!=e.node?n===ks.Label?this.addLabel(e.hit,e.node):setTimeout((function(){t.toggleContextLabel(e.hit,e.node)})):(this.store.dispatch(new sa(null)),this.store.dispatch(new na))}},{key:"addLabel",value:function(e,t){var n=this.cameraService.getDirection(e),i=this.getLabelDefaults(e.objectId),o=i.hideWire?20:32;i.title=t.label,i.offset=[o,0],i.objectId=e.objectId,i.barycentric=[e.barycentric[0],e.barycentric[1],e.barycentric[2]],i.pos=[e.worldPos[0],e.worldPos[1],e.worldPos[2]],i.primitiveIndex=e.primitiveIndex,i.renderableIndex=e.renderableIndex||0,i.dir=n,i.chapterId=this.store.selectSnapshot(vs.getSelectedChapter).id,i.occludable=!0,i.shown=!0,this.store.dispatch(new Xr(i)),this.store.dispatch(new sa(i))}},{key:"toggleContextLabel",value:function(e,t){if(this.store.selectSnapshot(jo.getCheckedNodeIds).some((function(e){return e===t.id}))){var n=this.cameraService.getDirection(e),i=this.labelsService.makeDefaultStudioLabel();i.theme=Ri.Context,i.title=t.label,i.offset=[32,0],i.objectId=e.objectId,i.barycentric=[e.barycentric[0],e.barycentric[1],e.barycentric[2]],i.pos=[e.worldPos[0],e.worldPos[1],e.worldPos[2]],i.primitiveIndex=e.primitiveIndex,i.dir=n,i.occludable=!1,this.store.dispatch(new Yr(i))}else this.store.dispatch(new na)}},{key:"getLabelDefaults",value:function(e){var t=this.store.selectSnapshot(kc.getSelectedLabel);if(null==t){var n=this.store.selectSnapshot(kc.getChapterLabels);n&&0!==n.length||(n=this.store.selectSnapshot(kc.getLabels)),n.length&&(t=Object(ie.cloneDeep)(n[n.length-1]))}if(null!=t){var i=this.labelsService.makeDefaultStudioLabel();switch(i.hideWire=t.hideWire,i.pinGlow=t.pinGlow,i.pinType=t.pinType,i.theme=t.theme,i.sequentialType=t.sequentialType,i.states[0].errands[0]=new co,Object(ie.get)(t,"states[1].errands[0].type")){case oo.flyToObject:case oo.flyToCamera:i.states[1].errands[0]=new ro(e)}return i}var o=this.labelsService.makeDefaultStudioLabel();return o.states[0].errands[0]=new co,o.states[1].errands[0]=new ro(e),o}},{key:"trackLabel",value:function(e,t){var n=t.id,i=t.shown,o=t.theme;return"".concat(n).concat(i).concat(o)}},{key:"resetCamera",value:function(){var e=this.store.selectSnapshot(vs.getSelectedChapter);Object(ie.get)(e,"camera.location")&&this.store.dispatch(new zn(e.camera.location))}}]),e}()).\u0275fac=function(e){return new(e||Qh)(j.Pb(L.g),j.Pb(L.b),j.Pb(te.e),j.Pb(Sn),j.Pb(Xn),j.Pb(j.i),j.Pb(po),j.Pb(j.m))},Qh.\u0275cmp=j.Jb({type:Qh,selectors:[["app-labels"]],decls:1,vars:1,consts:[["class","labels","data-test","labelsElement",4,"ngIf"],["data-test","labelsElement",1,"labels"],[4,"ngIf"],[3,"label","enableInfo","enableActions",4,"ngIf"],[4,"ngFor","ngForOf","ngForTrackBy"],[3,"label","enableInfo","enableActions"],["data-test","appStoryLabel",1,"labels__label",3,"pinDraggable","tagDraggable","label","collapsed","collapsedMode"]],template:function(e,t){1&e&&j.Ic(0,Hh,3,2,"div",0),2&e&&j.lc("ngIf",t.interactive)},directives:[we.l,we.k,rg,bh,Eh],pipes:[we.b],styles:["[_nghost-%COMP%]{position:relative}.labels[_ngcontent-%COMP%], [_nghost-%COMP%]{width:100%;height:100%;display:block}.labels[_ngcontent-%COMP%]{position:absolute;left:0;top:0;z-index:2;pointer-events:none}.labels__label--hidden[_ngcontent-%COMP%]{display:none}"],changeDetection:0}),Fh([Object(L.d)(hs.getUI),Ah("design:type",J.a)],Qh.prototype,"layout$",void 0),Fh([Object(L.d)(kc.getChapterLabels),Ah("design:type",J.a)],Qh.prototype,"labels$",void 0),Fh([Object(L.d)(rr.getQuizModeActive),Ah("design:type",J.a)],Qh.prototype,"quizModeActive$",void 0),Fh([Object(L.d)(zs.getActiveTool),Ah("design:type",J.a)],Qh.prototype,"activeTool$",void 0),Fh([Object(L.d)(rr.getActiveQuestion),Ah("design:type",J.a)],Qh.prototype,"activeQuestion$",void 0),Fh([Object(L.d)(vs.getSelectedChapter),Ah("design:type",J.a)],Qh.prototype,"selectedChapter$",void 0),Fh([Object(L.d)(kc.getSelectedLabel),Ah("design:type",J.a)],Qh.prototype,"selectedLabel$",void 0),Fh([Object(L.d)(kc.getLabelsCollapsed),Ah("design:type",J.a)],Qh.prototype,"labelsCollapsed$",void 0),Fh([Object(L.d)(kc.getLabelsCollapsedMode),Ah("design:type",J.a)],Qh.prototype,"labelsCollapsedMode$",void 0),Fh([Object(L.d)(kc.getContextLabel),Ah("design:type",J.a)],Qh.prototype,"contextLabel$",void 0),Fh([Object(L.d)(zs.getShowLabels),Ah("design:type",J.a)],Qh.prototype,"showLabels$",void 0),Fh([Object(L.d)(ws.getZoomed),Ah("design:type",J.a)],Qh.prototype,"zoomed$",void 0),Fh([Object(L.d)(kc.getEnableContextLabel),Ah("design:type",J.a)],Qh.prototype,"enableContextLabel$",void 0),Fh([Object(L.d)(kc.getEnableContextLabelInfo),Ah("design:type",J.a)],Qh.prototype,"enableContextLabelInfo$",void 0),Fh([Object(L.d)(kc.getEnableContextLabelActions),Ah("design:type",J.a)],Qh.prototype,"enableContextLabelActions$",void 0),Fh([Object(L.d)(kc.getLabelsDraggable),Ah("design:type",J.a)],Qh.prototype,"draggable$",void 0),Qh);function $h(e,t){if(1&e){var n=j.Wb();j.Vb(0,"div",1),j.cc("@show.done",(function(){return j.xc(n),j.gc().onShowDone()})),j.Vb(1,"div",2),j.Kc(2,"Use control + scroll to zoom"),j.Ub(),j.Ub()}2&e&&j.lc("@show",void 0)}var Wh,Kh,Gh,Zh,Jh,Xh,Yh=((Wh=function(){function e(t,n){y(this,e),this.actions=t,this.changeDetectorRef=n,this.ngUnsubscribe=new Z.a,this.show=!1}return v(e,[{key:"ngOnInit",value:function(){var e=this;this.actions.pipe(Object(L.j)(mt),Object(X.a)(this.ngUnsubscribe)).subscribe((function(){e.show=!0,e.changeDetectorRef.markForCheck()}))}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"onShowDone",value:function(){this.show=!1}}]),e}()).\u0275fac=function(e){return new(e||Wh)(j.Pb(L.b),j.Pb(j.i))},Wh.\u0275cmp=j.Jb({type:Wh,selectors:[["app-engine-scroll"]],decls:1,vars:1,consts:[["class","engine-scroll","data-test","engineScroll",4,"ngIf"],["data-test","engineScroll",1,"engine-scroll"],[1,"engine-scroll__label"]],template:function(e,t){1&e&&j.Ic(0,$h,3,1,"div",0),2&e&&j.lc("ngIf",t.show)},directives:[we.l],styles:[".text-8[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase[_ngcontent-%COMP%]{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase[_ngcontent-%COMP%]{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase[_ngcontent-%COMP%]{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase[_ngcontent-%COMP%]{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-28[_ngcontent-%COMP%]{font-size:28px;letter-spacing:.7px;line-height:1.4em}.text-28.text-uppercase[_ngcontent-%COMP%]{font-size:28px;letter-spacing:1.68px;line-height:1.25em;text-transform:uppercase}.text-header[_ngcontent-%COMP%]{font-weight:700}.text--code[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.text-xlight[_ngcontent-%COMP%]{font-weight:200}.text-light[_ngcontent-%COMP%]{font-weight:300}.text-medium[_ngcontent-%COMP%]{font-weight:500}.text-semibold[_ngcontent-%COMP%]{font-weight:600}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-underline[_ngcontent-%COMP%]{text-decoration:underline}.text-italic[_ngcontent-%COMP%]{font-style:italic}.text-bright[_ngcontent-%COMP%]{color:#fff}.text-dim[_ngcontent-%COMP%]{color:#96a8c0}.text-error[_ngcontent-%COMP%]{color:#ed4758}.text-left[_ngcontent-%COMP%]{text-align:left}.text-center[_ngcontent-%COMP%]{text-align:center}.text-right[_ngcontent-%COMP%]{text-align:right}.text-ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link[_ngcontent-%COMP%], .text-link[_ngcontent-%COMP%]:visited{color:inherit;cursor:pointer}.text-link[_ngcontent-%COMP%]:not(.text-underline), .text-link[_ngcontent-%COMP%]:visited:not(.text-underline){text-decoration:none}.text-success[_ngcontent-%COMP%]{color:#38de38}.text-danger[_ngcontent-%COMP%]{color:#de3535}.text-info[_ngcontent-%COMP%]{color:#2d72dc}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.text-pre-line[_ngcontent-%COMP%]{white-space:pre-line}.engine-scroll[_ngcontent-%COMP%]{display:flex;position:absolute;justify-content:center;align-items:center;top:0;bottom:0;left:0;right:0;z-index:10000;opacity:0;pointer-events:none}.engine-scroll__label[_ngcontent-%COMP%]{background:rgba(16,24,35,.5);font-size:16px;letter-spacing:.4px;line-height:1.4em;color:#fff;font-weight:600;padding:24px 32px;border-radius:40px}"],data:{animation:[Object(du.n)("show",[Object(du.m)(":enter",[Object(du.j)([Object(du.l)({opacity:"*"}),Object(du.e)("500ms ease-in-out",Object(du.l)({opacity:1})),Object(du.e)("500ms 2000ms ease-in-out",Object(du.l)({opacity:0}))])])])]},changeDetection:0}),Wh),ef=function(e,t){return{backgroundColor:e,duration:t}},tf=function(e,t){return{value:e,params:t}},nf=Object(du.g)([Object(du.l)({opacity:"0",backgroundColor:"*"}),Object(du.j)([Object(du.e)("{{ duration }}ms {{ easing }}",Object(du.l)({opacity:1,backgroundColor:"{{ backgroundColor }}"})),Object(du.e)("250ms 500ms ease-in",Object(du.l)({opacity:0}))])],{params:{duration:2e3,backgroundColor:"#ffffff",easing:"ease-out"}}),of=((Gh=function(){function e(t,n,i){y(this,e),this.actions=t,this.changeDetectorRef=n,this.store=i,this.color="#FFFFFF",this.duration=2e3,this.isVisible=!1,this.ngUnsubscribe=new Z.a}return v(e,[{key:"ngOnInit",value:function(){this.initFadeListener()}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"initFadeListener",value:function(){var e=this;this.actions.pipe(Object(L.j)(yt),Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){e.fadeIn(t.color,t.duration)}))}},{key:"handleFadeComplete",value:function(){this.store.dispatch(new xt),this.isVisible=!1,this.changeDetectorRef.markForCheck()}},{key:"fadeIn",value:function(e,t){this.isVisible=!0,this.color=e,this.duration=1e3*t,this.changeDetectorRef.markForCheck()}}]),e}()).\u0275fac=function(e){return new(e||Gh)(j.Pb(L.b),j.Pb(j.i),j.Pb(L.g))},Gh.\u0275cmp=j.Jb({type:Gh,selectors:[["app-engine-fade"]],decls:1,vars:7,consts:[[1,"engine-fade"]],template:function(e,t){1&e&&(j.Vb(0,"div",0),j.cc("@fade.done",(function(){return t.handleFadeComplete()})),j.Ub()),2&e&&j.lc("@fade",j.oc(4,tf,t.isVisible,j.oc(1,ef,t.color,t.duration)))},styles:[".engine-fade{pointer-events:none;display:block;position:absolute;left:0;right:0;top:0;bottom:0;z-index:10000}"],encapsulation:2,data:{animation:[Object(du.n)("fade",[Object(du.m)("* => true",Object(du.o)(nf))])]},changeDetection:0}),Gh),rf=((Kh=function(){function e(t){y(this,e),this.store=t}return v(e,[{key:"ngOnInit",value:function(){}},{key:"ngAfterViewInit",value:function(){this.nodeActionsComponent.nodeActionsTrigger.openMenu()}},{key:"onNodeActionsClosed",value:function(){this.store.dispatch(new jt(null,null))}},{key:"getNodeActionsStyles",value:function(){return{"left.px":this.hit?this.hit.canvasPos[0]:0,"top.px":this.hit?this.hit.canvasPos[1]:0}}}]),e}()).\u0275fac=function(e){return new(e||Kh)(j.Pb(L.g))},Kh.\u0275cmp=j.Jb({type:Kh,selectors:[["app-engine-contextmenu"]],viewQuery:function(e,t){var n;1&e&&j.Ec(Zd,!0),2&e&&j.sc(n=j.dc())&&(t.nodeActionsComponent=n.first)},inputs:{node:"node",hit:"hit"},decls:2,vars:2,consts:[[1,"contextmenu"],["eventCategory","Context Node","theme","light",1,"contextmenu__node-actions",3,"ngStyle","node","nodeActionsClosed"]],template:function(e,t){1&e&&(j.Vb(0,"div",0),j.Vb(1,"app-node-actions",1),j.cc("nodeActionsClosed",(function(){return t.onNodeActionsClosed()})),j.Ub(),j.Ub()),2&e&&(j.Db(1),j.lc("ngStyle",t.getNodeActionsStyles())("node",t.node))},directives:[Zd,we.m],styles:[".contextmenu[_ngcontent-%COMP%]{left:0;top:0;width:100%;height:100%;display:block;z-index:2}.contextmenu[_ngcontent-%COMP%], .contextmenu__node-actions[_ngcontent-%COMP%]{position:absolute}"]}),Kh),af=function(e){return{"progress__bar--complete":e}},sf=function(e){return{width:e}},cf=((Xh=function(){function e(t,n){y(this,e),this.router=t,this.changeDetector=n,this.total=100,this._value=0,this.percentWidth=0,this.ngUnsubscribe=new Z.a}return v(e,[{key:"value",get:function(){return this._value},set:function(e){this._value=e,this.percentWidth=this.value/this.total*100,this.changeDetector.markForCheck()}},{key:"ngOnInit",value:function(){var e=this;this.router.events.pipe(Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){t instanceof te.d&&(e.value=0)}))}},{key:"ngOnDestroy",value:function(){this.changeDetector.detach(),this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}}]),e}()).\u0275fac=function(e){return new(e||Xh)(j.Pb(te.e),j.Pb(j.i))},Xh.\u0275cmp=j.Jb({type:Xh,selectors:[["app-progress"]],inputs:{total:"total",value:"value"},decls:2,vars:7,consts:[[1,"progress"],["role","progressbar","aria-valuemin","0","aria-valuemax","100",1,"progress__bar",3,"ngClass","ngStyle"]],template:function(e,t){1&e&&(j.Vb(0,"div",0),j.Qb(1,"div",1),j.Ub()),2&e&&(j.Db(1),j.lc("ngClass",j.nc(3,af,100===t.percentWidth))("ngStyle",j.nc(5,sf,t.percentWidth+"%")),j.Eb("aria-valuenow",t.percentWidth))},directives:[we.i,we.m],styles:["@-webkit-keyframes progressSuccess{0%{width:100%!important;background:#38de38}50%{opacity:1;background:#38de38}to{opacity:0}}@keyframes progressSuccess{0%{width:100%!important;background:#38de38}50%{opacity:1;background:#38de38}to{opacity:0}}.progress[_ngcontent-%COMP%]{border-radius:0 1px 1px 0;display:flex;align-items:center;height:4px;width:100%}.progress__bar[_ngcontent-%COMP%]{background:#de3535;height:100%;width:0}.progress__bar--complete[_ngcontent-%COMP%]{-webkit-animation:progressSuccess 2s linear forwards;animation:progressSuccess 2s linear forwards}"],changeDetection:0}),Xh),lf=((Jh=function(){function e(t,n){y(this,e),this.store=t,this.changeDetectorRef=n,this.ngUnsubscribe=new Z.a,this.storyLoadProgress=0}return v(e,[{key:"ngOnInit",value:function(){var e=this,t=this.store.select(ll.getChunkLoadProgress),n=this.store.select(Ic.getLoadingChunk);Object(zc.b)(t,n).pipe(Object(Y.a)((function(){var t=e.store.selectSnapshot(Ic.getLoadChunks);return null!==t&&t.length>0})),Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){var n=d(t,2),i=n[0],o=n[1],r=null!==o&&o.chapterId===e.store.selectSnapshot(vs.getSelectedChapterId);e.storyLoadProgress=r?i:1,e.changeDetectorRef.markForCheck()}))}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}}]),e}()).\u0275fac=function(e){return new(e||Jh)(j.Pb(L.g),j.Pb(j.i))},Jh.\u0275cmp=j.Jb({type:Jh,selectors:[["app-engine-progress"]],decls:1,vars:2,consts:[["data-test","engineProgress",1,"engine-progress",3,"value","total"]],template:function(e,t){1&e&&j.Qb(0,"app-progress",0),2&e&&j.lc("value",t.storyLoadProgress)("total",1)},directives:[cf],styles:[".engine-progress[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;z-index:2;pointer-events:none}"],changeDetection:0}),Jh),pf=((Zh=function(){function e(t,n){y(this,e),this.engineService=t,this.changeDetectionRef=n,this.camera={x:0,y:0,z:0,zoom:0,dist:0}}return v(e,[{key:"ngOnInit",value:function(){this.initCameraListener()}},{key:"initCameraListener",value:function(){var e=this;this.engineService.getEvent(yn.CameraUpdated).pipe(Object(Jp.a)(50)).subscribe((function(t){e.camera={x:t.eye.x.toFixed(0),y:t.eye.y.toFixed(0),z:t.eye.z.toFixed(0),zoom:Math.floor(100*Human.renderer.camera.getZoom()),dist:t.dist.toFixed(0)},e.changeDetectionRef.markForCheck()}))}}]),e}()).\u0275fac=function(e){return new(e||Zh)(j.Pb(Sn),j.Pb(j.i))},Zh.\u0275cmp=j.Jb({type:Zh,selectors:[["app-engine-camera-position"]],decls:2,vars:5,consts:[[1,"engine-camera-position"]],template:function(e,t){1&e&&(j.Vb(0,"div",0),j.Kc(1),j.Ub()),2&e&&(j.Db(1),j.Oc(" X:",null==t.camera?null:t.camera.x," Y:",null==t.camera?null:t.camera.y," Z:",null==t.camera?null:t.camera.z," Dist:",null==t.camera?null:t.camera.dist," Zoom:",null==t.camera?null:t.camera.zoom,"\n"))},styles:[".engine-camera-position[_ngcontent-%COMP%]{position:absolute;top:8px;right:8px;color:#fff;font-size:10px;text-shadow:0 0 2px rgba(0,0,0,.8);z-index:10}"],changeDetection:0}),Zh),uf=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},df=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},gf=["engine"],hf=["engineCanvas"],ff=["engineAnnotations"];function bf(e,t){1&e&&j.Qb(0,"div",11)}function mf(e,t){if(1&e&&j.Qb(0,"app-engine-contextmenu",12),2&e){var n=j.gc();j.lc("node",n.contextmenuNode)("hit",n.contextmenuHit)}}function vf(e,t){1&e&&j.Qb(0,"div",13)}function yf(e,t){1&e&&j.Qb(0,"app-engine-progress",14)}function xf(e,t){1&e&&(j.Tb(0),j.Qb(1,"app-engine-camera-position"),j.Sb())}var Of,wf,kf,Cf,Sf=function(e){return e[e.Pan=.4]="Pan",e[e.PanSlow=.04]="PanSlow",e[e.Zoom=5]="Zoom",e[e.ZoomSlow=1]="ZoomSlow",e[e.Rotate=.3]="Rotate",e[e.RotateSlow=.03]="RotateSlow",e}({}),_f=function(e){return e[e.Rotate=6]="Rotate",e[e.Pan=1.75]="Pan",e[e.Zoom=2.5]="Zoom",e}({}),jf=function(e){return e[e.Zoom=-6]="Zoom",e[e.TrackZoom=.5]="TrackZoom",e[e.Pan=1.25]="Pan",e[e.Rotate=1.5]="Rotate",e[e.Friction=.85]="Friction",e[e.ZoomFriction=.85]="ZoomFriction",e[e.FrictionThreshold=.002]="FrictionThreshold",e}({}),Pf=function(e){return e.Hide="engine--cursor-hide",e.Label="engine--cursor-label",e.Paint="engine--cursor-paint",e.Eyedropper="engine--cursor-eyedropper",e.Crosshair="engine--cursor-crosshair",e.Default="",e}({}),Mf=function(e){return e[e.None=0]="None",e[e.Left=1]="Left",e[e.Right=2]="Right",e[e.LeftAndRight=4]="LeftAndRight",e}({}),If=((Of=function(){function e(t,n,i,o,a,s,c,l,p,u,d,g){y(this,e),this.actions=t,this.cameraService=n,this.chapterService=i,this.changeDetecton=o,this.engineService=a,this.paintService=s,this.visibilityLayersService=c,this.mediaService=l,this.storageService=p,this.renderer=u,this.store=d,this.matDialog=g,this.flyCamera=!0,this.chapterActivating=!1,this.visible=!1,this.application=P,this.cursorClass=Pf.Default,this.showDebug=T.application===P.Loft||this.storageService.getLocalItem(ns.CameraDebug),this.ngUnsubscribe=new Z.a,this.display=!1,this.engineVisible=!0,this.background=new kp.a(null),this.ctrlPressed=!1,this.scrollType=null,this.scrollTimeout=null,this.pinchTicks=0,this.progress="0",this.deltaTime=window.performance.now(),this.pinchMode="",this.cameraAnimating=!1,this.inputEnabled=!0,T.application===P.Loft&&r.e(6).then(r.t.bind(null,"16wW",7)).then((function(e){window.pako=e}))}return v(e,[{key:"wheel",value:function(e){var t=this.store.selectSnapshot(zs.getScrollMode),n=e.ctrlKey;t!==Cs.DoNotCaptureShowMessage||n||this.store.dispatch(new mt(!0)),(t===Cs.Capture||n)&&(e.preventDefault(),this.handleWheel(e))}},{key:"contextmenu",value:function(e){this.handleContextMenu(e)}},{key:"mouseout",value:function(){this.handleMouseOut()}},{key:"convertToLeafStateMap",value:function(e,t){var n={};return Object.entries(t).forEach((function(t){var i=d(t,2),o=i[0],r=i[1];n[o]={},n[o][e]=r})),n}},{key:"ngOnInit",value:function(){this.particleStateListener=new tu(this.store),this.bindEngineEvents(),this.bindApplicationEvents(),this.bindChapterChangeEvents(),this.bindCameraEvents(),this.bindToolEvents(),this.bindMouseEvents(),this.bindKeyEvents(),this.bindHumanInteractions(),this.initChangeListener(),this.initChapterAudio(),this.initBackgroundListener(),this.initPlaybackSpeedListener(),Human.properties.set({assetDomain:T.assetDomain}),Human.init.init()}},{key:"ngOnDestroy",value:function(){this.changeDetecton.detach(),this.particleStateListener.destroy(),this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"bindEngineEvents",value:function(){var e=this;this.engineService.getEvent(yn.Loaded).pipe(Object(X.a)(this.ngUnsubscribe)).subscribe((function(){e.store.dispatch(new ht(!0))})),this.engineService.getEvent(yn.TimelineChaptersActivateStart).pipe(Object(X.a)(this.ngUnsubscribe)).subscribe((function(){e.chapterActivating=!0})),this.engineService.getEvent(yn.TimelineChaptersActivateFinish).pipe(Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){e.chapterActivating=!1;var n=Human.timeline.activeRoot._nowBranch,i={id:n.id,init:!0,camera:n.initializedCamera,annotations:n.initializedAnnotations,graph:n.initializedGraph,properties:n.initializedProperties,particles:n.initializedParticles,clips:n.initializedClippingPlanes,postprocessing:n.initializedPostprocess,transparency:n.initializedTransparencyMode};e.store.dispatch(new Ct(t.chapterId)),e.store.dispatch(new St(i))})),this.engineService.getEvent(yn.TimelineChaptersActivated).pipe(Object(X.a)(this.ngUnsubscribe)).subscribe((function(){e.engineService.fireEvent(yn.LabelsChapterInfo,e.store.selectSnapshot(kc.getChapterLabels))})),Object(Ca.a)(this.engineService.getEvent(yn.TimelinePlayed),this.engineService.getEvent(yn.TimelinePaused)).pipe(Object(X.a)(this.ngUnsubscribe),Object(Y.a)((function(){return null!=e.store.selectSnapshot(vs.getSelectedChapterId)})),Object(Gp.a)(50),Object(se.a)((function(){return Human.timeline.playing}))).subscribe((function(t){e.store.dispatch(new Rt(t))})),this.engineService.getEvent(yn.Tick).pipe(Object(X.a)(this.ngUnsubscribe)).subscribe((function(){e.visible&&(e.inputEnabled&&e.handleMouseInputEngineTick(),e.handleCameraTick(),e.deltaTime=window.performance.now())})),this.engineService.getEvent(yn.TweenVisibilityUpdate).pipe(Object(Zc.a)((function(e,t){return JSON.stringify(e)===JSON.stringify(t)})),Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){var n=Object.keys(t).filter((function(e){return!0===t[e]})),i=Object.keys(t).filter((function(e){return!1===t[e]}));n.length>0&&e.store.dispatch(new Yi.UpdateNodesShown(!0,n,void 0,!1,!0)),i.length>0&&e.store.dispatch(new Yi.UpdateNodesShown(!1,i,void 0,!1,!0))})),this.engineService.getEvent(yn.SceneObjectRenderable).pipe(Object(Zp.a)(1e3),Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){if(t.length){var n={};t.forEach((function(e){n[e.objectId]={renderable:!0}})),e.store.dispatch(new zt(n))}})),this.engineService.getEvent(yn.AssetsLoadProgress).pipe(Object(Jp.a)(33),Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){var n=Math.max(1,e.store.selectSnapshot(Ic.getLoadChunks).length),i=e.store.selectSnapshot(Ic.getLoadChunksRemaining).length,o=n-i,r=t.receivedAssets/t.requestedAssets,a=1/n,s=0===i?1:r*a+o*a;e.progress=s.toFixed(2),e.changeDetecton.markForCheck(),e.store.dispatch(new ol(s,r))})),this.actions.pipe(Object(L.i)(et),Object(X.a)(this.ngUnsubscribe)).subscribe((function(){0===e.store.selectSnapshot(Ic.getLoadChunksRemaining).length&&(e.store.dispatch(new ol(1,1)),e.engineService.enableRender())})),this.engineService.getEvent(yn.CameraUpdated).pipe(Object(Y.a)((function(){return!e.cameraAnimating})),Object(X.a)(this.ngUnsubscribe)).subscribe((function(){e.cameraAnimating=!0,e.changeDetecton.markForCheck()})),this.engineService.getEvent(yn.CameraRested).pipe(Object(X.a)(this.ngUnsubscribe)).subscribe((function(){e.cameraAnimating=!1,e.changeDetecton.markForCheck()}))}},{key:"bindApplicationEvents",value:function(){var e=this;this.enginePosition$.pipe(Object(Y.a)((function(e){return null!=e})),Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){e.repositionEngine(t)})),this.store.select(zs.getXrayModeEnabled).pipe(Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){var n=e.store.selectSnapshot(jo.getCheckedNodes),i=e.store.selectSnapshot(jo.getNodes);!1===t?(Object.keys(i||[]).forEach((function(t){e.paintService.paint(t,i[t].paint)})),n.forEach((function(t){return e.paintService.highlight(t.objectId,!0)}))):(e.paintService.paintAll(Object.keys(i),Io),e.paintService.paintAll(n.map((function(e){return e.objectId})),Po))})),this.actions.pipe(Object(L.j)(Bt),Object(X.a)(this.ngUnsubscribe)).subscribe((function(){e.playChapterFromStart()})),this.engineDisplay$.pipe(Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){e.display=t,e.changeDetecton.markForCheck()})),this.engineVisible$.pipe(Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){e.engineVisible=t,e.changeDetecton.markForCheck()})),this.visibilityLayersService.initObservables(),this.contextmenu$.pipe(Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){e.contextmenuNode=t.node,e.contextmenuHit=t.hit,e.changeDetecton.markForCheck()}))}},{key:"bindChapterChangeEvents",value:function(){var e=this;this.selectedChapter$.pipe(Object(Y.a)((function(e){return!Object(ie.isNil)(e)})),Object(Cp.a)(),Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){var n=d(t,2),i=n[0],o=n[1],r=e.chapterService.getCurrentChapterId(),a=o.id;i.id===a&&r===a||(e.store.dispatch(new Yi.SetActiveChapter(a)),Xp(e.store,e.engineService),Human.timeline.scrub({chapterId:a}),e.store.dispatch(new Wn(void 0)))})),this.clippingPlanes$.pipe(Object(Y.a)((function(e){return void 0!==e})),Object(X.a)(this.ngUnsubscribe)).subscribe((function(e){var t=Object.values(e.clips).filter((function(e){return e.enabled}));Human.renderer.clip.reset(),t.forEach((function(t){return Human.renderer.clip.setClip(Object.assign({boundary:e.boundary},t))}))})),Object(zc.b)(this.selectedChapterId$,this.readyState$,this.autoplay$).pipe(Object(Y.a)((function(e){var t=d(e,3),n=t[0],i=t[1],o=t[2];return!Object(ie.isNil)(n)&&!Object(ie.isNil)(i)&&!Object(ie.isNil)(o)})),Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){var n=d(t,3),i=n[1],o=n[2],r=Object(ie.get)(i,"animation",!1),a=e.store.selectSnapshot(vs.getSelectedChapter),s=Object(ie.get)(a,"ui.play.autoplay",!0),c=r&&o&&s;e.store.dispatch(new Ft(a,!c)),e.store.dispatch(new At(c))}))}},{key:"bindCameraEvents",value:function(){var e=this;this.actions.pipe(Object(L.j)(zn),Object(Y.a)((function(e){return!Object(ie.isNil)(e.camera)})),Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){(t.animate?e.flyToPoint(t.camera,t.animationDuration):e.jumpToPoint(t.camera)).then((function(){e.store.dispatch(new Tn),t.rotationCenter&&e.cameraService.setCameraRotationCenter(t.rotationCenter)}))})),this.actions.pipe(Object(L.j)(Vn),Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){e.cameraService.panCameraStatic(t.x,t.y,t.z)})),this.actions.pipe(Object(L.j)(Hn),Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){e.cameraService.rotateCameraStatic(t.x,t.y)})),this.actions.pipe(Object(L.j)(Fn),Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){e.cameraService.setHumanZoomFactor(t.value)})),this.actions.pipe(Object(L.j)(Pt),Object(Y.a)((function(e){return!!e.objectId})),Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){t.animate?e.flyToObject(t.objectId,t.animationDuration):e.jumpToObject(t.objectId)}))}},{key:"bindToolEvents",value:function(){var e=this;this.activeTool$.pipe(Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){switch(Object.values(Pf).forEach((function(t){t&&e.renderer.removeClass(e.engineElement.nativeElement,t)})),t){case ks.Hide:e.renderer.addClass(e.engineElement.nativeElement,Pf.Hide);break;case ks.Label:e.renderer.addClass(e.engineElement.nativeElement,Pf.Label);break;case ks.Paint:e.renderer.addClass(e.engineElement.nativeElement,Pf.Paint);break;case ks.Eyedropper:e.renderer.addClass(e.engineElement.nativeElement,Pf.Eyedropper);break;case ks.Quiz:e.renderer.addClass(e.engineElement.nativeElement,Pf.Crosshair)}}))}},{key:"bindMouseEvents",value:function(){var e=this;this.mouseMove$=Object(ka.a)(this.engineElement.nativeElement,"mousemove"),this.mouseMove$.pipe(Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){e.handleMousePan(t)})),this.mouseMove$.pipe(Object(Gp.a)(10),Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){e.handleMouseHover(t)})),this.mouseLeave$=Object(ka.a)(this.engineElement.nativeElement,"mouseleave"),this.mouseLeave$.pipe(Object(Gp.a)(10),Object(X.a)(this.ngUnsubscribe)).subscribe((function(){e.handleMouseLeave()}))}},{key:"bindWindowKeyEvent",value:function(e){var t=this;return Object(ka.a)(window,e).pipe(Object(Y.a)((function(e){return Object(ie.isEmpty)(t.matDialog.openDialogs)})))}},{key:"bindKeyEvents",value:function(){var e,t=this,n=["w","a","s","d","e","c","=","-","+","_","arrowleft","arrowright","arrowup","arrowdown","shiftKey"].reduce((function(e,t){return e[t]=!1,e}),{}),i=new kp.a(n);this.bindWindowKeyEvent("keydown").pipe(Object(Y.a)((function(e){return!(e.repeat||e.metaKey||e.ctrlKey)})),Object(Y.a)((function(e){var t=e.target.nodeName.toLowerCase();return!(["input","textarea","select","option"].indexOf(t)>=0)})),Object(X.a)(this.ngUnsubscribe)).subscribe((function(e){var t;i.next(Object.assign(Object.assign({},i.value),(c(t={},e.key.toLowerCase(),!0),c(t,"shiftKey",e.shiftKey),c(t,"hasMomentum",!1),t)))})),this.bindWindowKeyEvent("keyup").pipe(Object(Y.a)((function(e){return!!e.key})),Object(X.a)(this.ngUnsubscribe)).subscribe((function(n){var o,r;1===Object.values(e).filter((function(e){return!0===e})).length?(t.applyMotion(e,!0),i.next(Object.assign(Object.assign({},i.value),(c(o={},n.key.toLowerCase(),!1),c(o,"shiftKey",n.shiftKey),c(o,"hasMomentum",!1===e.shiftKey),o)))):i.next(Object.assign(Object.assign({},i.value),(c(r={},n.key.toLowerCase(),!1),c(r,"shiftKey",n.shiftKey),c(r,"hasMomentum",!1),r)))})),i.pipe(Object(Y.a)((function(){return t.inputEnabled})),Object(X.a)(this.ngUnsubscribe)).subscribe((function(n){e=n,!1===n.hasMomentum&&t.applyMotion(n,!1)})),this.bindWindowKeyEvent("keydown").pipe(Object(Y.a)((function(e){return"Control"===e.key})),Object(X.a)(this.ngUnsubscribe)).subscribe((function(){t.ctrlPressed=!0})),this.bindWindowKeyEvent("keyup").pipe(Object(Y.a)((function(e){return"Control"===e.key})),Object(X.a)(this.ngUnsubscribe)).subscribe((function(){t.ctrlPressed=!1}))}},{key:"applyMotion",value:function(e,t){var n=new Yn,i=e.shiftKey?Sf.ZoomSlow:Sf.Zoom,o=e.shiftKey?Sf.PanSlow:Sf.Pan,r=e.shiftKey?Sf.RotateSlow:Sf.Rotate;n.zoom+=e.c||e["-"]||e._?i:0,n.zoom-=e.e||e["="]||e["+"]?i:0,n.panX-=e.d?o:0,n.panX+=e.a?o:0,n.panY+=e.w?o:0,n.panY-=e.s?o:0,n.rotateX-=e.arrowright?r:0,n.rotateX+=e.arrowleft?r:0,n.rotateY+=e.arrowup?r:0,n.rotateY-=e.arrowdown?r:0,n.applyFriction=t,this.store.dispatch(new Dn(n))}},{key:"initChangeListener",value:function(){var e=this;this.store.select(jo.getPatches).pipe(Object(Y.a)((function(e){return e.length>0})),Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){var n=t.reduce((function(e,t){var n=t.path[t.path.length-1];return void 0!==e[n]&&e[n].push(t),e}),{shown:[],checked:[],paint:[],pickable:[]}),i=function(e){return n[e].reduce((function(e,t){return e[t.path[2]]=t.value,e}),{})},o=i("checked"),r=i("shown"),a=i("paint"),s=i("pickable");if(!Object(ie.isEmpty)(r)){var c=e.store.selectSnapshot(jo.getNodes),l=Object.values(c).reduce((function(e,t){return e[t.objectId]=t.shown,e}),{});e.engineService.setNodesVisible(l);var p=e.convertToLeafStateMap("shown",l);e.store.dispatch(new It(p,c))}if(!Object(ie.isEmpty)(o)){e.engineService.fireEvent(yn.SceneObjectsSelected,{selectedObjectsUpdate:o});var u=e.store.selectSnapshot(zs.getXrayModeEnabled)?function(t,n){return e.paintService.paint(t,!0===n?Po:Io)}:function(t,n){return e.paintService.highlight(t,n)};Object.entries(o).forEach((function(e){var t=d(e,2),n=t[0],i=t[1];u(n,i)}))}if(!Object(ie.isEmpty)(a))for(var g=0,h=Object.entries(a);g<h.length;g++){var f=d(h[g],2),b=f[0],m=f[1];e.paintService.colorObject(b,ko.toEngine(m))}if(!Object(ie.isEmpty)(s)){var v=e.store.selectSnapshot(jo.getNodes),y=Object.values(v).reduce((function(e,t){return e[t.objectId]=t.pickable,e}),{});e.engineService.setNodesPickable(y),e.store.dispatch(new Tt(e.convertToLeafStateMap("pickable",y),v))}}))}},{key:"initChapterAudio",value:function(){var e=this;Object(zc.b)([this.selectedChapterId$,this.playAudio$]).pipe(Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){var n=d(t,2),i=(n[0],n[1]);e.playAudio(i)}))}},{key:"initBackgroundListener",value:function(){var e=this;Object(zc.b)([this.background$,this.engineDisplay$,this.engineVisible$]).pipe(Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){var n=d(t,3),i=n[0],o=n[1],r=n[2];e.renderer.setStyle(e.engineElement.nativeElement,"background-image",Ki.toCSS(i)),e.isBackgroundCheckered(i)?e.renderer.addClass(e.engineElement.nativeElement,"engine--checkered"):e.renderer.removeClass(e.engineElement.nativeElement,"engine--checkered"),e.renderer.setStyle(e.engineElement.nativeElement,"display",o?"block":"none"),e.renderer.setStyle(e.engineElement.nativeElement,"opacity",r?1:0)}))}},{key:"initPlaybackSpeedListener",value:function(){this.store.select(zs.getPlaybackSpeed).pipe(Object(X.a)(this.ngUnsubscribe)).subscribe((function(e){Human.timeline.scale=e}))}},{key:"repositionEngine",value:function(e){this.renderer.setStyle(this.engineElement.nativeElement,"left",e.left+"px"),this.renderer.setStyle(this.engineElement.nativeElement,"top",e.top+"px"),this.renderer.setStyle(this.engineElement.nativeElement,"width",e.width+"px"),this.renderer.setStyle(this.engineElement.nativeElement,"height",e.height+"px"),this.renderer.setStyle(this.engineElement.nativeElement,"zIndex",""+e.visibility),this.renderer.setStyle(this.engineElement.nativeElement,"visibility",e.visibility===jn.Shown?"visible":"hidden"),this.visible=e.visibility===jn.Shown,Human.renderer.resize()}},{key:"bindHumanInteractions",value:function(){var e=this,t=new eu.Manager(this.engineCanvasElement.nativeElement);t.add(new eu.Tap({event:"doubletap",taps:2,posThreshold:50})),t.add(new eu.Tap({event:"singletap"})),t.add(new eu.Pan({event:"pan",pointers:0})),t.add(new eu.Pinch({event:"pinch"})),t.add(new eu.Press({time:500})),t.on("singletap",(function(t){e.handleTap(t)})),t.on("doubletap",(function(t){e.handleDoubleTap(t)})),t.on("press",(function(t){t.preventDefault(),t.srcEvent.stopImmediatePropagation(),e.handlePress(t)})),t.on("pan",(function(t){t.preventDefault(),e.handlePan(t)})),t.on("panend",(function(t){e.handlePanEnd(t)})),t.on("pinchend",(function(t){e.handlePinchEnd(t)}));var n=0,i=0;t.on("pinchstart",(function(t){n=t.scale,e.pinchMode=""})),t.on("pinchmove",(function(t){if(!(e.pinchTicks>0)){var o=Math.abs(t.deltaX)>60||Math.abs(t.deltaY)>60,r=t.scale>1.25||t.scale<.75;e.pinchMode?("pan"===e.pinchMode&&r&&!o&&(e.pinchMode="pinch"),"pinch"===e.pinchMode&&o&&!r&&(e.pinchMode="pan")):e.pinchMode=r?"pinch":"pan";var a=t.scale-n;n=t.scale;var s=i;i=0===a?0:a>0?1:-1,e.cameraService.setCameraPan(t.velocityX*jf.Pan,t.velocityY*jf.Pan),i+s!==0&&e.cameraService.setHumanZoom(a*jf.Zoom)}}))}},{key:"handleMouseHover",value:function(e){if(e.buttons===Mf.None){var t=e.offsetX,n=e.offsetY,i=Human.renderer.pick.pick(t,n);if(i.objectId){var o=this.store.selectSnapshot(zs.getViewGraph),r=this.engineService.getNode(o,i.objectId),a=this.store.selectSnapshot(zs.getHoveredNode);a&&a.id===r.id||this.store.dispatch(new nn(r,i))}else null!=this.store.selectSnapshot(zs.getHoveredNode)&&this.store.dispatch(new nn(null))}}},{key:"handleMouseLeave",value:function(){this.store.dispatch(new nn(null))}},{key:"handleMousePan",value:function(e){if(2===e.buttons||4===e.buttons){var t=e.movementX,n=e.movementY;t/=16,n/=16,this.cameraService.setCameraPan(t,n)}}},{key:"handleMouseOut",value:function(){this.store.dispatch(new nn(null))}},{key:"handleWheel",value:function(e){var t=this,n=0;switch(e.deltaMode){case 0:null===this.scrollType&&(this.scrollType=Math.abs(e.deltaY)<10?"trackpad":"wheel"),n="trackpad"===this.scrollType?e.deltaY*jf.TrackZoom:Math.sign(e.deltaY)*_f.Zoom;break;default:this.scrollType="wheel",n=e.deltaY*_f.Zoom}clearTimeout(this.scrollTimeout),this.scrollTimeout=setTimeout((function(){t.scrollType=null}),500),Math.abs(n)>40&&(n=40*Math.sign(n)),"trackpad"===this.scrollType?this.cameraService.setCameraZoom(n):this.zoomWithVelocity(n)}},{key:"zoomWithVelocity",value:function(e){var t=this;this.cameraService.setCameraZoom(e),requestAnimationFrame((function(){e*=.85,Math.abs(e)>1&&t.zoomWithVelocity(e)}))}},{key:"handleContextMenu",value:function(e){e.preventDefault();var t=e.offsetX,n=e.offsetY,i=this.getHit(t,n),o=this.getNodeFromHit(i);this.store.dispatch(new jt(o,i))}},{key:"handlePanEnd",value:function(e){var t=this.store.selectSnapshot(ws.getCameraMotion);if(!(this.pinchTicks>0||t.panX===e.velocityX&&t.panY===e.velocityY)){var n=this.store.selectSnapshot(ws.getPanMode);e.srcEvent.shiftKey||"pan"===n?(t.panX=e.velocityX*jf.Pan,t.panY=e.velocityY*jf.Pan):(t.rotateX=e.velocityX*jf.Rotate,t.rotateY=e.velocityY*jf.Rotate),t.applyFriction=!0,this.store.dispatch(new Dn(t))}}},{key:"handlePinchEnd",value:function(e){var t=this.store.selectSnapshot(ws.getCameraMotion);if("pan"===this.pinchMode)t.panX=e.velocityX*jf.Pan,t.panY=e.velocityY*jf.Pan;else{var n=e.velocity>0?1:-1;t.zoom=Math.sqrt(e.velocityX*e.velocityX+e.velocityY*e.velocityY)*-n*jf.Zoom}t.applyFriction=!0,this.store.dispatch(new Dn(t)),this.pinchTicks=10}},{key:"handleTap",value:function(e){var t=this.getOffset(e),n=t.offsetX,i=t.offsetY,o=this.getHit(n,i),r=this.getNodeFromHit(o);this.store.dispatch(new _t(r,e,o))}},{key:"handleDoubleTap",value:function(e){var t=this.getOffset(e),n=t.offsetX,i=t.offsetY,o=this.getHit(n,i),r=this.getNodeFromHit(o);r&&this.store.dispatch(new Pt(r.id))}},{key:"handlePress",value:function(e){var t=this.getOffset(e),n=t.offsetX,i=t.offsetY,o=this.getHit(n,i),r=this.getNodeFromHit(o);r&&this.store.dispatch(new Pt(r.id))}},{key:"handlePan",value:function(e){if(!(this.pinchTicks>0)){var t=this.store.selectSnapshot(ws.getPanMode),n=e.velocityX,i=e.velocityY;e.srcEvent.shiftKey||"pan"===t?this.cameraService.setCameraPan(n*jf.Pan,i*jf.Pan):this.cameraService.setCameraRotation(n*jf.Rotate,i*jf.Rotate)}}},{key:"handleMouseInputEngineTick",value:function(){var e=this.cameraService.tickCameraRotation(),t=this.cameraService.tickCameraPan(),n=this.cameraService.tickCameraZoom(),i=Math.min(15,(window.performance.now()-this.deltaTime)/16.666666666666668);if((e.vx||e.vy)&&this.cameraService.rotateCameraStatic(0!==e.vx?i*e.vx*_f.Rotate:0,0!==e.vy?i*e.vy*_f.Rotate:0),t.x||t.y){var o=Math.max(Human.renderer.camera.lookDistance/80,.01);this.cameraService.panCameraStatic(i*t.x*o*_f.Pan,i*t.y*o*_f.Pan,i*t.z*o*_f.Pan)}0!==n&&this.cameraService.setHumanZoom(i*n*_f.Zoom)}},{key:"handleCameraTick",value:function(){this.pinchTicks>0&&this.pinchTicks--,this.applyFriction();var e=this.store.selectSnapshot(ws.getCameraMotion);this.cameraService.setCameraPan(e.panX,e.panY),this.cameraService.setCameraRotation(e.rotateX,e.rotateY),this.cameraService.setCameraZoom(e.zoom)}},{key:"getFriction",value:function(e){if(0===e)return 0;var t=(window.performance.now()-this.deltaTime)/16.666666666666668,n=e*Math.max(0,jf.Friction+.1*(1-t));return Math.abs(n)<jf.FrictionThreshold&&(n=0),n}},{key:"applyFriction",value:function(){var e=this.store.selectSnapshot(ws.getCameraMotion);!0===e.applyFriction&&(e.rotateX=this.getFriction(e.rotateX),e.rotateY=this.getFriction(e.rotateY),e.panX=this.getFriction(e.panX),e.panY=this.getFriction(e.panY),e.zoom=this.getFriction(e.zoom),0===e.rotateX&&0===e.rotateY&&0===e.panX&&0===e.panY&&0===e.zoom&&(e.applyFriction=!1),this.store.dispatch(new Dn(e)))}},{key:"flyToObject",value:function(e,t){Human.renderer.camera.fly.flyTo({objectId:e,animationDuration:t})}},{key:"jumpToObject",value:function(e){Human.renderer.camera.fly.jumpTo({objectId:e})}},{key:"flyToPoint",value:function(e,t){return new Promise((function(n){Human.renderer.camera.fly.flyTo(Object.assign(Object.assign({},e),{animationDuration:t}),n)}))}},{key:"jumpToPoint",value:function(e){return new Promise((function(t){Human.renderer.camera.fly.jumpTo(e,t)}))}},{key:"getNodeFromHit",value:function(e){var t;if(e.objectId){var n=this.store.selectSnapshot(zs.getViewGraph);t=this.engineService.getNode(n,e.objectId)}return t}},{key:"getHit",value:function(e,t){return Human.renderer.pick.pick(e,t,{rayPick:!0})}},{key:"getOffset",value:function(e){var t=0,n=0;e.center?(t=e.center.x,n=e.center.y):(t=e.clientX,n=e.clientY);var i=this.engineElement.nativeElement.getBoundingClientRect();return{offsetX:t-i.left,offsetY:n-i.top}}},{key:"playAudio",value:function(e){e=Object(ie.isNil)(e)?this.store.selectSnapshot(zs.getPlayAudio):e,this.mediaService.stopAudio();var t=this.store.selectSnapshot(vs.getSelectedChapterAudio),n=Object(ie.get)(t,"data.fullUrl");if(n){var i=this.mediaService.getAudioPlayer(n);i||(i=this.mediaService.addAudioPlayer(n)),e?i.play():i.stop()}}},{key:"playChapterFromStart",value:function(){var e=this.store.selectSnapshot(vs.getSelectedChapter);this.playAudio(),this.store.dispatch(new Ft(e)),this.store.dispatch(new At(!0))}},{key:"isTransparentBackground",value:function(e){return!!e&&Ki.isTransparent(this.background.getValue())}},{key:"isBackgroundCheckered",value:function(e){return T.application!==P.Viewer&&this.isTransparentBackground(e)}}]),e}()).\u0275fac=function(e){return new(e||Of)(j.Pb(L.b),j.Pb(Xn),j.Pb(Wr),j.Pb(j.i),j.Pb(Sn),j.Pb(ru),j.Pb(cu),j.Pb(uu),j.Pb(as),j.Pb(j.H),j.Pb(L.g),j.Pb(ap.b))},Of.\u0275cmp=j.Jb({type:Of,selectors:[["app-engine"]],viewQuery:function(e,t){var n;1&e&&(j.Ec(gf,!0),j.Ec(hf,!0),j.Ec(ff,!0)),2&e&&(j.sc(n=j.dc())&&(t.engineElement=n.first),j.sc(n=j.dc())&&(t.engineCanvasElement=n.first),j.sc(n=j.dc())&&(t.engineAnnotationsElement=n.first))},hostBindings:function(e,t){1&e&&j.cc("wheel",(function(e){return t.wheel(e)}))("contextmenu",(function(e){return t.contextmenu(e)}))("mouseout",(function(e){return t.mouseout(e)}))},inputs:{inputEnabled:"inputEnabled"},decls:16,vars:11,consts:[["id","container","data-test","engine","role","complementary",1,"engine"],["engine",""],["class","engine__watermark","role","img","aria-label","watermark","data-test","engineWatermark",4,"ngIf"],["id","theCanvas","data-test","engineCanvas",1,"engine__canvas"],["engineCanvas",""],["id","annotationCanvas",1,"engine__annotations"],["engineAnnotations",""],[3,"node","hit",4,"ngIf"],["data-test","engineInputBlocker","class","engine__input-blocking",4,"ngIf"],["data-test","engineProgressBar",4,"ngIf"],[4,"ngIf"],["role","img","aria-label","watermark","data-test","engineWatermark",1,"engine__watermark"],[3,"node","hit"],["data-test","engineInputBlocker",1,"engine__input-blocking"],["data-test","engineProgressBar"]],template:function(e,t){1&e&&(j.Vb(0,"div",0,1),j.Ic(2,bf,1,0,"div",2),j.hc(3,"async"),j.Qb(4,"canvas",3,4),j.Qb(6,"canvas",5,6),j.Qb(8,"app-labels"),j.Ic(9,mf,1,2,"app-engine-contextmenu",7),j.Ic(10,vf,1,0,"div",8),j.Ic(11,yf,1,0,"app-engine-progress",9),j.hc(12,"async"),j.Qb(13,"app-engine-scroll"),j.Qb(14,"app-engine-fade"),j.Ic(15,xf,2,0,"ng-container",10),j.Ub()),2&e&&(j.Eb("data-progress",t.progress)("data-camera-animating",t.cameraAnimating),j.Db(2),j.lc("ngIf",j.ic(3,7,t.watermarkEnabled$)),j.Db(7),j.lc("ngIf",t.contextmenuNode),j.Db(1),j.lc("ngIf",!t.inputEnabled),j.Db(1),j.lc("ngIf",j.ic(12,9,t.showProgressBar$)),j.Db(4),j.lc("ngIf",t.showDebug))},directives:[we.l,qh,Yh,of,rf,lf,pf],pipes:[we.b],styles:[".engine[_ngcontent-%COMP%]{-webkit-tap-highlight-color:rgba(0,0,0,0);-webkit-tap-highlight-color:transparent;position:fixed;width:100vw;height:100vh;overflow:hidden;visibility:hidden;z-index:-1;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.engine__canvas[_ngcontent-%COMP%]{display:block;position:absolute;width:100%;height:100%;z-index:1}.engine__annotations[_ngcontent-%COMP%]{display:none}.engine--cursor-eyedropper[_ngcontent-%COMP%]:hover{cursor:url(/assets/images/cursors/cursor-eyedropper.png) 7 20,pointer}.engine--cursor-paint[_ngcontent-%COMP%]:hover{cursor:url(/assets/images/cursors/cursor-paint.png) 7 20,pointer}.engine--cursor-hide[_ngcontent-%COMP%]:hover{cursor:url(/assets/images/cursors/cursor-hide.png) 7 20,pointer}.engine--cursor-label[_ngcontent-%COMP%]:hover{cursor:url(/assets/images/cursors/cursor-label.png) 7 20,pointer}.engine--cursor-crosshair[_ngcontent-%COMP%]:hover{cursor:crosshair}.engine--checkered[_ngcontent-%COMP%]{background-color:#fff;background-size:24px 24px;background-position:0 0,12px 12px;background-image:linear-gradient(45deg,#d7e0ea 25%,transparent 0,transparent 75%,#d7e0ea 0,#d7e0ea),linear-gradient(45deg,#d7e0ea 25%,transparent 0,transparent 75%,#d7e0ea 0,#d7e0ea)}.engine__controls[_ngcontent-%COMP%]{position:absolute;right:16px;bottom:16px;z-index:2}.engine__progress[_ngcontent-%COMP%]{position:absolute;top:0;left:0;right:0;z-index:2}.engine__progress--hide[_ngcontent-%COMP%]{display:none}.engine__input-blocking[_ngcontent-%COMP%]{position:absolute;top:0;left:0;right:0;bottom:0;z-index:3}.engine__watermark[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%;z-index:101;pointer-events:none;background-image:url(/assets/images/BioDigital_watermark_1024x768.svg);background-repeat:no-repeat;background-position:50%;background-size:auto}@media (max-width:768px){.engine__controls[_ngcontent-%COMP%]{bottom:96px}}@media (max-width:959px){.engine__watermark[_ngcontent-%COMP%]{background-image:url(/assets/images/BioDigital_watermark_959x100.svg);background-size:contain}}"],changeDetection:0}),uf([Object(L.d)(zs.getReady),df("design:type",J.a)],Of.prototype,"ready$",void 0),uf([Object(L.d)(zs.getViewGraph),df("design:type",J.a)],Of.prototype,"viewGraph$",void 0),uf([Object(L.d)(zs.getEnginePosition),df("design:type",J.a)],Of.prototype,"enginePosition$",void 0),uf([Object(L.d)(zs.getHoveredNode),df("design:type",J.a)],Of.prototype,"hoveredNode$",void 0),uf([Object(L.d)(zs.getChapter),df("design:type",J.a)],Of.prototype,"chapter$",void 0),uf([Object(L.d)(zs.getChapterInit),df("design:type",J.a)],Of.prototype,"chapterInit$",void 0),uf([Object(L.d)(jo.getCheckedNodes),df("design:type",J.a)],Of.prototype,"checkedNodes$",void 0),uf([Object(L.d)(zs.getActiveTool),df("design:type",J.a)],Of.prototype,"activeTool$",void 0),uf([Object(L.d)(zs.getAnimationPlaying),df("design:type",J.a)],Of.prototype,"animationPlaying$",void 0),uf([Object(L.d)(zs.getAutoplay),df("design:type",J.a)],Of.prototype,"autoplay$",void 0),uf([Object(L.d)(zs.getPlayAudio),df("design:type",J.a)],Of.prototype,"playAudio$",void 0),uf([Object(L.d)(zs.getDisplay),df("design:type",J.a)],Of.prototype,"engineDisplay$",void 0),uf([Object(L.d)(zs.getVisible),df("design:type",J.a)],Of.prototype,"engineVisible$",void 0),uf([Object(L.d)(zs.getShowProgressBar),df("design:type",J.a)],Of.prototype,"showProgressBar$",void 0),uf([Object(L.d)(zs.getContextmenu),df("design:type",J.a)],Of.prototype,"contextmenu$",void 0),uf([Object(L.d)(vs.getSelectedChapter),df("design:type",J.a)],Of.prototype,"selectedChapter$",void 0),uf([Object(L.d)(vs.getSelectedChapterId),df("design:type",J.a)],Of.prototype,"selectedChapterId$",void 0),uf([Object(L.d)(vs.getSelectedChapterReadyState),df("design:type",J.a)],Of.prototype,"readyState$",void 0),uf([Object(L.d)(vs.getSelectedChapterClippingPlanes),df("design:type",J.a)],Of.prototype,"clippingPlanes$",void 0),uf([Object(L.d)(ws.getCameraMotion),df("design:type",J.a)],Of.prototype,"cameraMotion$",void 0),uf([Object(L.d)(vs.getSelectedChapterBackground),df("design:type",J.a)],Of.prototype,"background$",void 0),uf([Object(L.d)(zs.getWatermarkEnabled),df("design:type",J.a)],Of.prototype,"watermarkEnabled$",void 0),Of),zf=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Tf=((wf=function(){function e(t,n,i,o,r){y(this,e),this.store=t,this.router=n,this.ga=i,this.pendoService=o,this.globalActionsService=r,this.title="Biodigital Human",this.ngUnsubscribe=new Z.a}return v(e,[{key:"ngOnInit",value:function(){this.initPendo(),this.initPageAnalytics(),this.initInputObserver(),this.globalActionsService.initialize()}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"initPendo",value:function(){this.pendoService.appendScript(),this.pendoService.initialize({visitor:{id:""},account:{}})}},{key:"initInputObserver",value:function(){var e=this;this.inputEnabled$.pipe(Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){e.store.dispatch(new _.SetInputEnabled(t))}))}},{key:"initPageAnalytics",value:function(){var e=this;this.router.events.pipe(Object(Y.a)((function(e){return e instanceof te.c})),Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){e.ga.pageView(t.urlAfterRedirects)}))}}]),e}()).\u0275fac=function(e){return new(e||wf)(j.Pb(L.g),j.Pb(te.e),j.Pb(ne.c),j.Pb(Oe),j.Pb(Kp))},wf.\u0275cmp=j.Jb({type:wf,selectors:[["app-root"]],decls:3,vars:3,consts:[[3,"inputEnabled"]],template:function(e,t){1&e&&(j.Qb(0,"app-engine",0),j.hc(1,"async"),j.Qb(2,"router-outlet")),2&e&&j.lc("inputEnabled",j.ic(1,1,t.inputEnabled$))},directives:[If,te.g],pipes:[we.b],styles:[""],changeDetection:0}),function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);r>3&&a&&Object.defineProperty(t,n,a)}([Object(L.d)(G.getInputEnabled),zf("design:type",J.a)],wf.prototype,"inputEnabled$",void 0),wf),Uf=r("imBb"),Df=r("7sSR"),Lf=function(e){return e[e.Main=0]="Main",e[e.Media=1]="Media",e[e.Tools=2]="Tools",e[e.Whiteboard=3]="Whiteboard",e[e.VisibilityLayers=4]="VisibilityLayers",e[e.Empty=5]="Empty",e}({}),Ef=((kf=function(){function e(t,n,i){y(this,e),this.store=t,this.engineService=n,this.viewService=i}return v(e,[{key:"startQuiz",value:function(){this.viewService.toggleColumn(!0),this.store.dispatch(new Eo.SetQuizActive(!0));var e=this.store.selectSnapshot(rr.getAllQuestions)[0].id;this.store.dispatch(new Eo.SetActiveQuestion(e))}},{key:"resetQuiz",value:function(){this.viewService.clearFadedNodes(),this.viewService.clearSelectedNodes(),this.store.dispatch(new Eo.SetQuizActive(!1)),this.store.dispatch(new Eo.SetActiveSubmission(void 0)),this.store.dispatch(new Eo.ClearSubmissions),this.store.dispatch(new Eo.SetQuizLifecycle(Ko.Question))}},{key:"exitQuiz",value:function(){var e=this;this.resetQuiz(),setTimeout((function(){e.store.dispatch(new zn(e.store.selectSnapshot(vs.getChapterCamera),!1))}))}},{key:"submitQuestion",value:function(e,t){var n=this.store.selectSnapshot(rr.getAllQuestions).find((function(t){return t.id===e})),i=this.store.selectSnapshot(rr),o=i.launchMode,r=i.quizSettings;this.store.dispatch(new Eo.SubmitQuestionAnswer({questionId:n.id,answer:t})),this.store.dispatch(new Eo.SetActiveSubmission({questionId:n.id,answer:t})),this.engineService.fireEvent(yn.QuizAnswerSubmitted,{questionId:n.id,answer:t}),o===Jo.Learning&&n.type!==No.Instructions&&!1!==r.showExplanation?this.store.dispatch(new Eo.SetQuizLifecycle(Ko.Explanation)):this.nextQuestion()}},{key:"nextQuestion",value:function(){this.store.selectSnapshot(rr.hasQuestionRemaining)?(this.store.dispatch(new Eo.SetQuizLifecycle(Ko.Question)),this.viewService.clearFadedNodes(),this.viewService.clearSelectedNodes(),this.store.dispatch(new Eo.NextQuestion)):(this.store.dispatch(new Eo.SetQuizLifecycle(Ko.Review)),this.engineService.fireEvent(yn.QuizCompleted,!0))}}]),e}()).\u0275fac=function(e){return new(e||kf)(j.Zb(L.g),j.Zb(Sn),j.Zb(Wp))},kf.\u0275prov=j.Lb({token:kf,factory:kf.\u0275fac,providedIn:"root"}),kf);!function(e){e.normalize=function(e){return(""+(e||"")).replace(/&#(\d+);/g,(function(e,t){return String.fromCharCode(t)})).replace(/(&.+;)/gi,(function(e,t){return String.fromCharCode(e.charCodeAt(0))}))},e.prettyPrint=function(e){return(""+(e||"")).trim().replace(/([A-Z])/g," $1").replace(/^./,(function(e){return e.toUpperCase()})).trim()},e.parseEmails=function(e){return e.split(",").map((function(e){return e.trim()})).filter((function(e){return!!e}))},e.validateEmail=function(e){return/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/.test(e)},e.toTitleCase=function(e){return e.replace(/\w\S*/g,(function(e){return e.charAt(0).toUpperCase()+e.substring(1).toLowerCase()}))}}(Cf||(Cf={}));var Ff,Af=r("wf0l"),Rf=((Ff=function(){function e(){y(this,e)}return v(e,[{key:"transform",value:function(e,t){return function(e){if(null==e)return"";var t=new RegExp(/[^a-zA-Z0-9_]/,"gi");return e.replace(t,"_")}(e)}}]),e}()).\u0275fac=function(e){return new(e||Ff)},Ff.\u0275pipe=j.Ob({name:"elementID",type:Ff,pure:!0}),Ff),Vf=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},Nf=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Bf=["chapterMenu"];function Hf(e,t){1&e&&j.jc(0)}function Qf(e,t){1&e&&j.Rb(0)}function qf(e,t){if(1&e){var n=j.Wb();j.Tb(0),j.Vb(1,"button",5),j.cc("menuOpened",(function(){return j.xc(n),j.gc().handleMenuOpened()})),j.Ic(2,Qf,1,0,"ng-container",6),j.Ub(),j.Sb()}if(2&e){var i=j.gc(),o=j.tc(5),r=j.tc(1);j.Db(1),j.lc("buttonShape",i.buttonShape)("fill",!0)("matMenuTriggerFor",o),j.Db(1),j.lc("ngTemplateOutlet",r)}}function $f(e,t){1&e&&(j.Vb(0,"span",12),j.Kc(1,"current"),j.Ub())}var Wf=function(e,t){return{"view-chapters__item--viewed":e,"view-chapters__item--selected":t}};function Kf(e,t){if(1&e){var n=j.Wb();j.Vb(0,"button",7),j.cc("click",(function(){j.xc(n);var e=t.$implicit;return j.gc().handleChapterClick(e)})),j.hc(1,"elementID"),j.hc(2,"async"),j.Vb(3,"div",8),j.Kc(4),j.Ub(),j.Vb(5,"div",9),j.Kc(6),j.Ub(),j.Ic(7,$f,2,0,"span",10),j.hc(8,"async"),j.Qb(9,"div",11),j.Ub()}if(2&e){var i=t.$implicit,o=t.index,r=j.gc();j.lc("ngClass",j.oc(13,Wf,r.isViewed(i.id),i.id===j.ic(2,9,r.selectedChapterId$))),j.Eb("data-chapter-id",j.ic(1,7,i.id)),j.Db(4),j.Mc("",o+1,"."),j.Db(2),j.Lc(i.info.displayName),j.Db(1),j.lc("ngIf",i.id===j.ic(8,11,r.selectedChapterId$)),j.Db(2),j.lc("defaultImage",r.defaultImage)("lazyLoad",r.getChapterThumb(i.id))}}var Gf,Zf,Jf=["*"],Xf=((Zf=function(){function e(t,n){y(this,e),this.store=t,this.viewService=n,this.defaultImage="/assets/images/view-chapter-thumbnail-placeholder.png",this.buttonShape="circle"}return v(e,[{key:"handleChapterClick",value:function(e){this.viewService.selectChapter(e)}},{key:"handleMenuOpened",value:function(){var e=this.store.selectSnapshot(vs.getSelectedChapterIndex);this.chapterMenu._allItems.toArray()[e].focus()}},{key:"getChapterThumb",value:function(e){var t=this.store.selectSnapshot(Lr.getRegisteredThumbnails).get(e);return t?t.snapshot||t.urls.small:""}},{key:"isViewed",value:function(e){return this.store.selectSnapshot(vs.getChaptersViewed).some((function(t){return t===e}))}}]),e}()).\u0275fac=function(e){return new(e||Zf)(j.Pb(L.g),j.Pb(Wp))},Zf.\u0275cmp=j.Jb({type:Zf,selectors:[["app-view-chapters"]],viewQuery:function(e,t){var n;1&e&&j.Ec(Bf,!0),2&e&&j.sc(n=j.dc())&&(t.chapterMenu=n.first)},inputs:{defaultImage:"defaultImage",buttonShape:"buttonShape"},ngContentSelectors:Jf,decls:8,vars:7,consts:[["contentTmp",""],[4,"ngIf","ngIfElse"],[1,"view-chapters"],["chapterMenu","matMenu"],["mat-menu-item","","class","view-chapters__item",3,"ngClass","click",4,"ngFor","ngForOf"],["app-pin-button","","buttonAlign","left","buttonType","ghost","data-test","viewChaptersButton",1,"w-100","h-100",3,"buttonShape","fill","matMenuTriggerFor","menuOpened"],[4,"ngTemplateOutlet"],["mat-menu-item","",1,"view-chapters__item",3,"ngClass","click"],[1,"view-chapters__index"],[1,"view-chapters__title"],["class","visually-hidden",4,"ngIf"],[1,"view-chapters__thumb",3,"defaultImage","lazyLoad"],[1,"visually-hidden"]],template:function(e,t){if(1&e&&(j.kc(),j.Ic(0,Hf,1,0,"ng-template",null,0,j.Jc),j.Ic(2,qf,3,4,"ng-container",1),j.hc(3,"async"),j.Vb(4,"mat-menu",2,3),j.Ic(6,Kf,10,16,"button",4),j.hc(7,"async"),j.Ub()),2&e){var n,i=j.tc(1);j.Db(2),j.lc("ngIf",(null==(n=j.ic(3,3,t.chapters$))?null:n.length)>1)("ngIfElse",i),j.Db(4),j.lc("ngForOf",j.ic(7,5,t.chapters$))}},directives:[we.l,Ld.a,we.k,Dg,Ld.d,we.q,Ld.b,we.i,Af.a],pipes:[we.b,Rf],styles:[".text-8{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-28{font-size:28px;letter-spacing:.7px;line-height:1.4em}.text-28.text-uppercase{font-size:28px;letter-spacing:1.68px;line-height:1.25em;text-transform:uppercase}.text-header{font-weight:700}.text--code{font-family:Courier New,Courier,monospace}.text-uppercase{text-transform:uppercase}.text-xlight{font-weight:200}.text-light{font-weight:300}.text-medium{font-weight:500}.text-semibold{font-weight:600}.text-bold{font-weight:700}.text-underline{text-decoration:underline}.text-italic{font-style:italic}.text-bright{color:#fff}.text-dim{color:#96a8c0}.text-error{color:#ed4758}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.text-ellipsis{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link,.text-link:visited{color:inherit;cursor:pointer}.text-link:not(.text-underline),.text-link:visited:not(.text-underline){text-decoration:none}.text-success{color:#38de38}.text-danger{color:#de3535}.text-info{color:#2d72dc}.text-nowrap{white-space:nowrap}.text-pre-line{white-space:pre-line}.view-chapters{min-width:300px;max-height:320px;overflow:auto;padding:8px}.view-chapters button.mat-menu-item{height:auto;font-size:14px;letter-spacing:.35px;line-height:1.4em}.view-chapters button.mat-button-toggle-focus-overlay{display:none}.view-chapters__item{height:auto;white-space:normal;display:flex!important;padding:8px!important;border-radius:4px;border:2px solid transparent;background-color:transparent;color:#131c2a;margin-bottom:4px;transition:background-color 125ms,color 125ms,border 125ms}.view-chapters__item:hover{cursor:pointer;background:#eaeff5}.view-chapters__item--selected{border-color:#2d72dc}.view-chapters__index{display:flex;flex:0 0 32px;justify-content:center}.view-chapters__thumb{background-color:#f9fafd;border-radius:4px;background-repeat:no-repeat;flex:0 0 56px;height:56px;width:56px;transition:border-color .1s}.view-chapters__title{word-wrap:break-word;overflow-wrap:break-word;word-break:break-word;white-space:normal;display:flex;flex:1 1 auto;padding-right:4px}.view-chapters__thumb{background-size:cover}"],encapsulation:2,changeDetection:0}),Vf([Object(L.d)(vs.getStoryChapters),Nf("design:type",J.a)],Zf.prototype,"chapters$",void 0),Vf([Object(L.d)(vs.getSelectedChapterId),Nf("design:type",J.a)],Zf.prototype,"selectedChapterId$",void 0),Vf([Object(L.d)(vs.getSelectedChapterIndex),Nf("design:type",J.a)],Zf.prototype,"selectedChapterIndex$",void 0),Vf([Object(L.d)(Lr.getRegisteredThumbnails),Nf("design:type",J.a)],Zf.prototype,"thumbnails$",void 0),Vf([Object(L.d)(vs.getChaptersViewed),Nf("design:type",J.a)],Zf.prototype,"chaptersViewed$",void 0),Zf),Yf=((Gf=function(){function e(){y(this,e)}return v(e,[{key:"transform",value:function(e,t){return Cf.normalize(""+(e||""))}}]),e}()).\u0275fac=function(e){return new(e||Gf)},Gf.\u0275pipe=j.Ob({name:"textNormalize",type:Gf,pure:!0}),Gf),eb=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},tb=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},nb=function(e){return{"view-description__story-title--large":e}};function ib(e,t){if(1&e&&(j.Vb(0,"h1",7),j.Kc(1),j.Ub()),2&e){var n=j.gc();j.lc("ngClass",j.nc(2,nb,!n.chapterTitle)),j.Db(1),j.Mc(" ",n.storyTitle," ")}}function ob(e,t){if(1&e&&(j.Vb(0,"span"),j.Kc(1),j.hc(2,"async"),j.Ub()),2&e){var n=j.gc();j.Db(1),j.Mc("",j.ic(2,1,n.chapterIndex$)+1,".")}}function rb(e,t){1&e&&j.Qb(0,"app-icon",8)}var ab,sb=function(e,t){return{"view-title--clickable":e,"view-title--large":t}},cb=((ab=function(){function e(t,n){y(this,e),this.layoutService=t,this.changeDetectorRef=n,this._isPopulated=!1,this.isPopulatedChange=new j.p,this._menuEnabled=!0,this.viewLayout=nl,this.ngUnsubscribe=new Z.a,this.storyTitle="",this.chapterTitle=""}return v(e,[{key:"isPopulated",get:function(){return this._isPopulated},set:function(e){this._isPopulated=e,this.isPopulatedChange.emit(this.isPopulated)}},{key:"menuEnabled",get:function(){return this._menuEnabled},set:function(e){this._menuEnabled=e}},{key:"ngOnInit",value:function(){this.initContentListener(),this.initLayoutListener()}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"isEnabled",value:function(e){return this.layoutService.isUIEnabled(e)}},{key:"initContentListener",value:function(){var e=this;Object(zc.b)([this.story$,this.chapter$]).pipe(Object(Y.a)((function(e){var t=d(e,2),n=t[0];return null!=t[1]&&null!=n})),Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){var n=d(t,2),i=n[0],o=n[1];e.storyTitle=T.application!==P.Viewer?Cf.normalize(i.displayName):"",e.chapterTitle=Cf.normalize(o.info.displayName),e.isPopulated=!!e.chapterTitle||!!e.storyTitle}))}},{key:"initLayoutListener",value:function(){var e=this;this.layout$.pipe(Object(X.a)(this.ngUnsubscribe)).subscribe((function(){e.changeDetectorRef.markForCheck()}))}}]),e}()).\u0275fac=function(e){return new(e||ab)(j.Pb(pl),j.Pb(j.i))},ab.\u0275cmp=j.Jb({type:ab,selectors:[["app-view-title"]],viewQuery:function(e,t){var n;1&e&&j.Pc(Xf,!0),2&e&&j.sc(n=j.dc())&&(t.chapterListComponentMenu=n.first)},inputs:{size:"size",isPopulated:"isPopulated",menuEnabled:"menuEnabled"},outputs:{isPopulatedChange:"isPopulatedChange"},decls:12,vars:16,consts:[[1,"view-title",3,"ngClass"],["buttonShape","square"],[1,"p-2"],["id","view-title","class","view-title__story",3,"ngClass",4,"ngIf"],["id","view-title",1,"view-title__chapter"],[4,"ngIf"],["icon","caret-down",4,"ngIf"],["id","view-title",1,"view-title__story",3,"ngClass"],["icon","caret-down"]],template:function(e,t){1&e&&(j.Vb(0,"section",0),j.hc(1,"async"),j.Vb(2,"app-view-chapters",1),j.Vb(3,"div",2),j.Ic(4,ib,2,4,"h1",3),j.Vb(5,"h1",4),j.Ic(6,ob,3,3,"span",5),j.hc(7,"async"),j.Kc(8),j.hc(9,"textNormalize"),j.Ic(10,rb,1,0,"app-icon",6),j.hc(11,"async"),j.Ub(),j.Ub(),j.Ub(),j.Ub()),2&e&&(j.lc("ngClass",j.oc(13,sb,j.ic(1,5,t.chapterCount$)>1&&t.menuEnabled,"large"===t.size)),j.Db(4),j.lc("ngIf",t.storyTitle&&t.storyTitle!=t.chapterTitle),j.Db(2),j.lc("ngIf",j.ic(7,7,t.chapterCount$)>1&&t.menuEnabled),j.Db(2),j.Mc(" ",j.ic(9,9,t.chapterTitle)," "),j.Db(2),j.lc("ngIf",j.ic(11,11,t.chapterCount$)>1&&t.menuEnabled))},directives:[we.i,Xf,we.l,vp],pipes:[we.b,Yf],styles:[".text-8{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-28{font-size:28px;letter-spacing:.7px;line-height:1.4em}.text-28.text-uppercase{font-size:28px;letter-spacing:1.68px;line-height:1.25em;text-transform:uppercase}.text-header{font-weight:700}.text--code{font-family:Courier New,Courier,monospace}.text-uppercase{text-transform:uppercase}.text-xlight{font-weight:200}.text-light{font-weight:300}.text-medium{font-weight:500}.text-semibold{font-weight:600}.text-bold{font-weight:700}.text-underline{text-decoration:underline}.text-italic{font-style:italic}.text-bright{color:#fff}.text-dim{color:#96a8c0}.text-error{color:#ed4758}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.text-ellipsis{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link,.text-link:visited{color:inherit;cursor:pointer}.text-link:not(.text-underline),.text-link:visited:not(.text-underline){text-decoration:none}.text-success{color:#38de38}.text-danger{color:#de3535}.text-info{color:#2d72dc}.text-nowrap{white-space:nowrap}.text-pre-line{white-space:pre-line}.view-title{word-wrap:break-word;overflow-wrap:break-word;border-radius:4px;padding:4px;margin:0 -4px;transition:background-color 125ms}.view-title--large{font-size:18px;letter-spacing:.45px;line-height:1.4em}.view-title__story{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase;word-wrap:break-word;overflow-wrap:break-word;text-align:left;font-weight:600;color:var(--view-description-secondary-color)}.view-title__chapter{font-size:14px;letter-spacing:.35px;line-height:1.4em;text-align:left;font-weight:600;color:#131c2a}"],encapsulation:2,changeDetection:0}),eb([Object(L.d)(Ic.getStory),tb("design:type",J.a)],ab.prototype,"story$",void 0),eb([Object(L.d)(vs.getSelectedChapter),tb("design:type",J.a)],ab.prototype,"chapter$",void 0),eb([Object(L.d)(vs.getChapterCount),tb("design:type",J.a)],ab.prototype,"chapterCount$",void 0),eb([Object(L.d)(vs.getSelectedChapterIndex),tb("design:type",J.a)],ab.prototype,"chapterIndex$",void 0),eb([Object(L.d)(hs.getUI),tb("design:type",J.a)],ab.prototype,"layout$",void 0),ab);function lb(e,t){if(1&e&&(j.Vb(0,"div",2),j.Vb(1,"h2",3),j.Kc(2),j.Ub(),j.jc(3,1,["class","view-panel__actions","actions",""]),j.Ub()),2&e){var n=j.gc();j.Db(2),j.Mc(" ",n.label," ")}}var pb,ub=["*",[["","actions",""]]],db=function(e,t){return{"view-panel--padding-none":e,"view-panel--padding-dense":t}},gb=["*","[actions]"],hb=((pb=function(){function e(){y(this,e),this.label="",this.showHeader=!0,this.padding="normal"}return v(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||pb)},pb.\u0275cmp=j.Jb({type:pb,selectors:[["app-view-panel"]],inputs:{label:"label",showHeader:"showHeader",padding:"padding"},ngContentSelectors:gb,decls:3,vars:5,consts:[[1,"view-panel",3,"ngClass"],["class","view-panel__header",4,"ngIf"],[1,"view-panel__header"],[1,"view-panel__label"]],template:function(e,t){1&e&&(j.kc(ub),j.Vb(0,"div",0),j.Ic(1,lb,4,1,"div",1),j.jc(2),j.Ub()),2&e&&(j.lc("ngClass",j.oc(2,db,"none"===t.padding,"dense"===t.padding)),j.Db(1),j.lc("ngIf",t.showHeader))},directives:[we.i,we.l],styles:[".text-8{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-28{font-size:28px;letter-spacing:.7px;line-height:1.4em}.text-28.text-uppercase{font-size:28px;letter-spacing:1.68px;line-height:1.25em;text-transform:uppercase}.text-header{font-weight:700}.text--code{font-family:Courier New,Courier,monospace}.text-uppercase{text-transform:uppercase}.text-xlight{font-weight:200}.text-light{font-weight:300}.text-medium{font-weight:500}.text-semibold{font-weight:600}.text-bold{font-weight:700}.text-underline{text-decoration:underline}.text-italic{font-style:italic}.text-bright{color:#fff}.text-dim{color:#96a8c0}.text-error{color:#ed4758}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.text-ellipsis{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link,.text-link:visited{color:inherit;cursor:pointer}.text-link:not(.text-underline),.text-link:visited:not(.text-underline){text-decoration:none}.text-success{color:#38de38}.text-danger{color:#de3535}.text-info{color:#2d72dc}.text-nowrap{white-space:nowrap}.text-pre-line{white-space:pre-line}.view-panel{border-bottom:1px solid #eaeff5;padding:0 0 32px;margin-bottom:16px}.view-panel--padding-none{padding:0;margin:0}.view-panel--padding-dense{padding:0 0 8px;margin:0 0 8px}.view-panel__label{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase;color:#374a68;font-weight:600;display:flex;align-items:center;min-height:28px}.view-panel__header{display:flex;flex-direction:row;align-items:flex-start;justify-content:space-between;margin-bottom:16px}"],encapsulation:2,changeDetection:0}),pb),fb=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},bb=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function mb(e,t){if(1&e&&(j.Vb(0,"div",3),j.Qb(1,"app-html",4),j.Ub()),2&e){var n=j.gc();j.Db(1),j.lc("markdownText",n.chapterDescription)}}var vb,yb=function(e,t){return{"view-description--layout-column":e,"view-description--layout-drawer":t}},xb=((vb=function(){function e(t,n,i){y(this,e),this.viewService=t,this.layoutService=n,this.changeDetectorRef=i,this.viewLayout=nl,this.ngUnsubscribe=new Z.a,this.storyTitle="",this.chapterTitle="",this.chapterDescription="",this.layout=il.Drawer,this._isPopulated=!1,this.isPopulatedChange=new j.p}return v(e,[{key:"isPopulated",get:function(){return this._isPopulated},set:function(e){this._isPopulated=e,this.isPopulatedChange.emit(this.isPopulated)}},{key:"ngOnInit",value:function(){this.initContentListener(),this.initLayoutListener()}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"isEnabled",value:function(e){return this.layoutService.isUIEnabled(e)}},{key:"initContentListener",value:function(){var e=this;Object(zc.b)(this.story$,this.chapter$).pipe(Object(Y.a)((function(e){var t=d(e,2),n=t[0],i=t[1];return null!=n&&null!=i})),Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){var n=d(t,2),i=n[0],o=n[1];e.storyTitle=T.application!==P.Viewer?Cf.normalize(i.displayName):"",e.chapterTitle=Cf.normalize(o.info.displayName),e.chapterDescription=Object(ie.trim)(o.info.description),e.isPopulated=""!==e.storyTitle||!!e.chapterTitle||!!e.chapterDescription}))}},{key:"initLayoutListener",value:function(){var e=this;this.layout$.pipe(Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){e.changeDetectorRef.markForCheck()}))}}]),e}()).\u0275fac=function(e){return new(e||vb)(j.Pb(Wp),j.Pb(pl),j.Pb(j.i))},vb.\u0275cmp=j.Jb({type:vb,selectors:[["app-view-description"]],inputs:{layout:"layout",isPopulated:"isPopulated"},outputs:{isPopulatedChange:"isPopulatedChange"},decls:4,vars:5,consts:[[1,"view-description",3,"ngClass"],[1,"view-description__inner"],["class","view-description__body",4,"ngIf"],[1,"view-description__body"],[3,"markdownText"]],template:function(e,t){1&e&&(j.Vb(0,"div",0),j.Vb(1,"div",1),j.Vb(2,"section"),j.Ic(3,mb,2,1,"div",2),j.Ub(),j.Ub(),j.Ub()),2&e&&(j.lc("ngClass",j.oc(2,yb,"column"===t.layout,"drawer"===t.layout)),j.Db(3),j.lc("ngIf",t.chapterDescription))},directives:[we.i,we.l,Cg],styles:[".text-8{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-28{font-size:28px;letter-spacing:.7px;line-height:1.4em}.text-28.text-uppercase{font-size:28px;letter-spacing:1.68px;line-height:1.25em;text-transform:uppercase}.text-header{font-weight:700}.text--code{font-family:Courier New,Courier,monospace}.text-uppercase{text-transform:uppercase}.text-xlight{font-weight:200}.text-light{font-weight:300}.text-medium{font-weight:500}.text-semibold{font-weight:600}.text-bold{font-weight:700}.text-underline{text-decoration:underline}.text-italic{font-style:italic}.text-bright{color:#fff}.text-dim{color:#96a8c0}.text-error{color:#ed4758}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.text-ellipsis{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link,.text-link:visited{color:inherit;cursor:pointer}.text-link:not(.text-underline),.text-link:visited:not(.text-underline){text-decoration:none}.text-success{color:#38de38}.text-danger{color:#de3535}.text-info{color:#2d72dc}.text-nowrap{white-space:nowrap}.text-pre-line{white-space:pre-line}.view-description{color:#131c2a;display:flex;flex-direction:column;justify-content:left}.view-description--layout-column .view-description__chapter-title{font-size:18px;letter-spacing:.45px;line-height:1.4em}.view-description--layout-column .view-description__body{padding:4px 8px 12px}.view-description--layout-drawer .view-description__story-title{text-align:center}.view-description--layout-drawer .view-description__story-title--large{font-size:14px;letter-spacing:.35px;line-height:1.4em}.view-description--layout-drawer .view-description__body{padding-top:4px}.view-description__inner{flex:1 0 auto}.view-description__story-title{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase;word-wrap:break-word;overflow-wrap:break-word;flex-grow:1;font-weight:600;color:#374a68}.view-description__story-title--large{font-size:18px;letter-spacing:.45px;line-height:1.4em;text-transform:none}.view-description__body{font-size:14px;letter-spacing:.35px;line-height:1.4em;word-wrap:break-word;overflow-wrap:break-word;padding-top:8px;color:#374a68}"],encapsulation:2,changeDetection:0}),fb([Object(L.d)(Ic.getStory),bb("design:type",J.a)],vb.prototype,"story$",void 0),fb([Object(L.d)(vs.getSelectedChapter),bb("design:type",J.a)],vb.prototype,"chapter$",void 0),fb([Object(L.d)(vs.getSelectedChapterIndex),bb("design:type",J.a)],vb.prototype,"chapterIndex$",void 0),fb([Object(L.d)(vs.getChapterCount),bb("design:type",J.a)],vb.prototype,"chapterCount$",void 0),fb([Object(L.d)(hs.getUI),bb("design:type",J.a)],vb.prototype,"layout$",void 0),vb);function Ob(e,t){if(1&e&&(j.Vb(0,"div",6),j.Kc(1),j.Ub()),2&e){var n=j.gc().$implicit;j.Db(1),j.Lc(n.description)}}function wb(e,t){if(1&e&&(j.Vb(0,"li",2),j.Qb(1,"div",3),j.Vb(2,"div",4),j.Vb(3,"div"),j.Kc(4),j.Ub(),j.Ic(5,Ob,2,1,"div",5),j.Ub(),j.Ub()),2&e){var n=t.$implicit,i=j.gc();j.Db(1),j.Fc("background-color",i.getComputedColor(n.colors)),j.Db(3),j.Lc(n.label),j.Db(1),j.lc("ngIf",n.description)}}var kb,Cb=((kb=function(){function e(){y(this,e)}return v(e,[{key:"ngOnInit",value:function(){}},{key:"getComputedColor",value:function(e){return bn.rgbToHex(e,!0)}}]),e}()).\u0275fac=function(e){return new(e||kb)},kb.\u0275cmp=j.Jb({type:kb,selectors:[["app-view-legend"]],inputs:{legend:"legend"},decls:2,vars:1,consts:[["aria-label","Legend","role","complementary",1,"view-legend"],["class","view-legend__item",4,"ngFor","ngForOf"],[1,"view-legend__item"],[1,"view-legend__color","mh-2"],[1,"view-legend__content","text-14"],["class","mv-2",4,"ngIf"],[1,"mv-2"]],template:function(e,t){1&e&&(j.Vb(0,"ul",0),j.Ic(1,wb,6,4,"li",1),j.Ub()),2&e&&(j.Db(1),j.lc("ngForOf",t.legend))},directives:[we.k,we.l],styles:['.view-legend{display:flex;flex-direction:column}.view-legend__item{padding:8px 0;display:flex;flex-direction:row;justify-content:flex-start;align-items:flex-start}.view-legend__content{display:flex;flex-direction:column}.view-legend__color{content:" ";display:block;flex:0 0 16px;width:16px;height:16px;border-radius:50%}.view-legend__color:after{content:" "}'],encapsulation:2,changeDetection:0}),kb),Sb=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},_b=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},jb=function(e){return{"view-labels__item--selected":e}};function Pb(e,t){if(1&e){var n=j.Wb();j.Vb(0,"li"),j.Vb(1,"button",2),j.cc("click",(function(){j.xc(n);var e=t.$implicit;return j.gc().handleLabelClick(e)}))("keyup.enter",(function(){j.xc(n);var e=t.$implicit;return j.gc().handleLabelClick(e)})),j.hc(2,"async"),j.hc(3,"async"),j.Vb(4,"span",3),j.Kc(5,"Navigate to description for, "),j.Ub(),j.Vb(6,"div",4),j.Vb(7,"div",5),j.Qb(8,"app-label-pin",6),j.Ub(),j.Ub(),j.Vb(9,"div",7),j.Qb(10,"div",8),j.hc(11,"markdown"),j.Ub(),j.Ub(),j.Ub()}if(2&e){var i,o,r=t.$implicit,a=j.gc();j.Db(1),j.lc("ngClass",j.nc(11,jb,(null==(i=j.ic(2,5,a.selectedLabel$))?null:i.id)===r.id)),j.Eb("aria-current",(null==(o=j.ic(3,7,a.selectedLabel$))?null:o.id)===r.id),j.Db(7),j.lc("label",r)("sequence",a.getLabelSequence(r)),j.Db(2),j.lc("innerHTML",j.ic(11,9,r.title),j.yc)}}var Mb,Ib=((Mb=function(){function e(t,n){y(this,e),this.viewService=t,this.store=n,this.labelPinType=Ai,this.labelSequentialtype=Vi}return v(e,[{key:"ngOnInit",value:function(){}},{key:"getLabelSequence",value:function(e){return this.store.selectSnapshot(kc.getLabelSequence(e))}},{key:"handleLabelClick",value:function(e){this.viewService.selectLabel(e,!0)}}]),e}()).\u0275fac=function(e){return new(e||Mb)(j.Pb(Wp),j.Pb(L.g))},Mb.\u0275cmp=j.Jb({type:Mb,selectors:[["app-view-labels"]],decls:3,vars:3,consts:[[1,"view-labels"],[4,"ngFor","ngForOf"],[1,"view-labels__item",3,"ngClass","click","keyup.enter"],[1,"visually-hidden"],[1,"view-labels__pre"],[1,"view-labels__pin"],[3,"label","sequence"],[1,"view-labels__body"],[1,"view-labels__title","html",3,"innerHTML"]],template:function(e,t){1&e&&(j.Vb(0,"ul",0),j.Ic(1,Pb,12,13,"li",1),j.hc(2,"async"),j.Ub()),2&e&&(j.Db(1),j.lc("ngForOf",j.ic(2,1,t.labels$)))},directives:[we.k,we.i,Pu],pipes:[we.b,Jd.b],styles:[".text-8{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-28{font-size:28px;letter-spacing:.7px;line-height:1.4em}.text-28.text-uppercase{font-size:28px;letter-spacing:1.68px;line-height:1.25em;text-transform:uppercase}.text-header{font-weight:700}.text--code{font-family:Courier New,Courier,monospace}.text-uppercase{text-transform:uppercase}.text-xlight{font-weight:200}.text-light{font-weight:300}.text-medium{font-weight:500}.text-semibold{font-weight:600}.text-bold{font-weight:700}.text-underline{text-decoration:underline}.text-italic{font-style:italic}.text-bright{color:#fff}.text-dim{color:#96a8c0}.text-error{color:#ed4758}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.text-ellipsis{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link,.text-link:visited{color:inherit;cursor:pointer}.text-link:not(.text-underline),.text-link:visited:not(.text-underline){text-decoration:none}.text-success{color:#38de38}.text-danger{color:#de3535}.text-info{color:#2d72dc}.text-nowrap{white-space:nowrap}.text-pre-line{white-space:pre-line}.view-labels__item{background:none;border:0;border-left:4px solid transparent;border-radius:2px;display:flex;padding:12px 8px;margin-bottom:4px;cursor:pointer;transition:background-color 125ms,color 125ms,border 125ms;width:100%;text-align:left}.view-labels__item:focus{outline:2px solid #2d72dc!important}.view-labels__item:hover{background:#eaeff5}.view-labels__item--selected{background:#f0f8ff;border-left:4px solid #2d72dc}.view-labels__item--selected:hover{background:#f0f8ff}.view-labels__pre{flex:0 0 32px;display:flex;justify-content:center;position:relative}.view-labels__pin{display:flex;align-items:center;justify-content:center;position:absolute}.view-labels__title{color:#131c2a}.view-labels__description,.view-labels__title{font-size:14px;letter-spacing:.35px;line-height:1.4em}.view-labels__description{color:#374a68;padding-top:4px}.view-labels__label{position:absolute;font-size:10px;top:3px}"],encapsulation:2,changeDetection:0}),Sb([Object(L.d)(kc.getChapterLabels),_b("design:type",J.a)],Mb.prototype,"labels$",void 0),Sb([Object(L.d)(kc.getSelectedLabel),_b("design:type",J.a)],Mb.prototype,"selectedLabel$",void 0),Mb),zb=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},Tb=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function Ub(e,t){if(1&e&&(j.Vb(0,"div"),j.Qb(1,"app-content-blocks",7),j.hc(2,"async"),j.Ub()),2&e){var n=j.gc(2);j.Db(1),j.lc("contentBlocks",j.ic(2,2,n.contentBlocks$))("include",n.contentBlockTypes.Ticker)}}function Db(e,t){if(1&e&&(j.Vb(0,"div"),j.Qb(1,"app-content-blocks",8),j.hc(2,"async"),j.Ub()),2&e){var n=j.gc(2);j.Db(1),j.lc("contentBlocks",j.ic(2,2,n.contentBlocks$))("exclude",n.contentBlockTypes.Ticker)}}function Lb(e,t){if(1&e){var n=j.Wb();j.Vb(0,"app-view-panel",4),j.Ic(1,Ub,3,4,"div",5),j.hc(2,"async"),j.Vb(3,"app-view-description",6),j.cc("isPopulatedChange",(function(e){return j.xc(n),j.gc().isPopulated=e})),j.Ub(),j.Ic(4,Db,3,4,"div",5),j.hc(5,"async"),j.Ub()}if(2&e){var i,o,r=j.gc();j.lc("showHeader",!1)("hidden",!r.isPopulated),j.Db(1),j.lc("ngIf",(null==(i=j.ic(2,6,r.contentBlocks$))?null:i.length)>0),j.Db(2),j.lc("isPopulated",r.isPopulated)("layout",r.layout),j.Db(1),j.lc("ngIf",(null==(o=j.ic(5,8,r.contentBlocks$))?null:o.length)>0)}}function Eb(e,t){if(1&e&&(j.Vb(0,"app-view-panel",9),j.Qb(1,"app-view-legend",10),j.hc(2,"async"),j.Ub()),2&e){var n=j.gc();j.Db(1),j.lc("legend",j.ic(2,1,n.chapter$).legend)}}function Fb(e,t){if(1&e){var n=j.Wb();j.Vb(0,"div",13),j.Vb(1,"button",14),j.cc("click",(function(){return j.xc(n),j.gc(2).handlePrevClick()})),j.Ub(),j.Vb(2,"button",15),j.cc("click",(function(){return j.xc(n),j.gc(2).handleNextClick()})),j.Ub(),j.Ub()}}function Ab(e,t){if(1&e&&(j.Vb(0,"app-view-panel",11),j.Ic(1,Fb,3,0,"div",12),j.hc(2,"async"),j.Qb(3,"app-view-labels"),j.Ub()),2&e){var n,i=j.gc();j.Db(1),j.lc("ngIf",(null==(n=j.ic(2,1,i.labels$))?null:n.length)>1)}}var Rb,Vb=((Rb=function(){function e(t,n,i,o){y(this,e),this.store=t,this.viewService=n,this.layoutService=i,this.changeDetectorRef=o,this.ngUnsubscribe=new Z.a,this.layout=il.Column,this.viewLayout=nl,this.isPopulated=!0,this.descriptionVisible=!1,this.legendVisible=!1,this.labelListVisible=!1,this.contentBlockTypes=Vo}return v(e,[{key:"ngOnInit",value:function(){var e=this;this.store.select(hs.getUI).pipe(Object(X.a)(this.ngUnsubscribe)).subscribe((function(){e.descriptionVisible=e.isVisible(nl.Description),e.legendVisible=e.isVisible(nl.Legend),e.labelListVisible=e.isVisible(nl.LabelList),e.changeDetectorRef.markForCheck()}))}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"isVisible",value:function(e){return this.layoutService.isUIVisible(e)}},{key:"isEnabled",value:function(e){return this.layoutService.isUIEnabled(e)}},{key:"handlePrevClick",value:function(){this.selectLabel(-1)}},{key:"handleNextClick",value:function(){this.selectLabel(1)}},{key:"selectLabel",value:function(e){var t=this.store.selectSnapshot(kc.getChapterLabels),n=t.length,i=this.store.selectSnapshot(kc.getSelectedLabelId),o=t.findIndex((function(e){return e.id===i})),r=t[((-1!==o?o+e:0)%n+n)%n];r&&this.viewService.selectLabel(r,!0)}}]),e}()).\u0275fac=function(e){return new(e||Rb)(j.Pb(L.g),j.Pb(Wp),j.Pb(pl),j.Pb(j.i))},Rb.\u0275cmp=j.Jb({type:Rb,selectors:[["app-view-content-mode"]],inputs:{layout:"layout"},decls:7,vars:9,consts:[[1,"view-content-mode"],["role","complementary","aria-describedby","view-title",3,"showHeader","hidden",4,"ngIf"],["label","Legend",4,"ngIf"],["label","Labels","role","complementary","aria-label","Labels",4,"ngIf"],["role","complementary","aria-describedby","view-title",3,"showHeader","hidden"],[4,"ngIf"],[3,"isPopulated","layout","isPopulatedChange"],[3,"contentBlocks","include"],[3,"contentBlocks","exclude"],["label","Legend"],[3,"legend"],["label","Labels","role","complementary","aria-label","Labels"],["actions","","class","flex",4,"ngIf"],["actions","",1,"flex"],["app-pin-button","","icon","chevron-left","size","small","buttonType","ghost","aria-label","Previous Label","matTooltip","Previous Label","data-test","previousLabelButton",3,"click"],["app-pin-button","","icon","chevron-right","size","small","buttonType","ghost","aria-label","Next Label","matTooltip","Next Label","data-test","nextLabelButton",3,"click"]],template:function(e,t){if(1&e&&(j.Vb(0,"div",0),j.Ic(1,Lb,6,10,"app-view-panel",1),j.Ic(2,Eb,3,3,"app-view-panel",2),j.hc(3,"async"),j.hc(4,"async"),j.Ic(5,Ab,4,3,"app-view-panel",3),j.hc(6,"async"),j.Ub()),2&e){var n,i=null;j.Db(1),j.lc("ngIf",t.descriptionVisible),j.Db(1),j.lc("ngIf",(null==(i=j.ic(3,3,t.chapter$))?null:i.legend)&&(null==(i=j.ic(4,5,t.chapter$))?null:i.legend.length)>0&&t.legendVisible),j.Db(3),j.lc("ngIf",(null==(n=j.ic(6,7,t.labels$))?null:n.length)&&t.labelListVisible)}},directives:[we.l,hb,xb,ch,Cb,Ib,Dg,Lg.c],pipes:[we.b],styles:[".view-content-mode[_ngcontent-%COMP%]{padding-bottom:24px}"],changeDetection:0}),zb([Object(L.d)(vs.getStoryChapters),Tb("design:type",J.a)],Rb.prototype,"chapters$",void 0),zb([Object(L.d)(vs.getSelectedChapter),Tb("design:type",J.a)],Rb.prototype,"chapter$",void 0),zb([Object(L.d)(vs.getSelectedChapterContentBlocks),Tb("design:type",J.a)],Rb.prototype,"contentBlocks$",void 0),zb([Object(L.d)(kc.getChapterLabels),Tb("design:type",J.a)],Rb.prototype,"labels$",void 0),Rb);function Nb(e,t){if(1&e&&(j.Vb(0,"span"),j.Kc(1),j.Ub()),2&e){var n=j.gc();j.Db(1),j.Mc(" of ",n.total,"")}}var Bb,Hb,Qb,qb=((Bb=function(){function e(){y(this,e),this.index=0,this.total=0}return v(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||Bb)},Bb.\u0275cmp=j.Jb({type:Bb,selectors:[["app-view-quiz-progress"]],inputs:{index:"index",total:"total"},decls:4,vars:2,consts:[["data-test","quizProgress",1,"view-quiz-progress"],[1,"text-semibold"],[4,"ngIf"]],template:function(e,t){1&e&&(j.Vb(0,"div",0),j.Vb(1,"span",1),j.Kc(2),j.Ub(),j.Ic(3,Nb,2,1,"span",2),j.Ub()),2&e&&(j.Db(2),j.Mc("Question ",t.index+1,""),j.Db(1),j.lc("ngIf",t.total>1))},directives:[we.l],styles:[".text-8[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase[_ngcontent-%COMP%]{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase[_ngcontent-%COMP%]{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase[_ngcontent-%COMP%]{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase[_ngcontent-%COMP%]{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-28[_ngcontent-%COMP%]{font-size:28px;letter-spacing:.7px;line-height:1.4em}.text-28.text-uppercase[_ngcontent-%COMP%]{font-size:28px;letter-spacing:1.68px;line-height:1.25em;text-transform:uppercase}.text-header[_ngcontent-%COMP%]{font-weight:700}.text--code[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.text-xlight[_ngcontent-%COMP%]{font-weight:200}.text-light[_ngcontent-%COMP%]{font-weight:300}.text-medium[_ngcontent-%COMP%]{font-weight:500}.text-semibold[_ngcontent-%COMP%]{font-weight:600}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-underline[_ngcontent-%COMP%]{text-decoration:underline}.text-italic[_ngcontent-%COMP%]{font-style:italic}.text-bright[_ngcontent-%COMP%]{color:#fff}.text-dim[_ngcontent-%COMP%]{color:#96a8c0}.text-error[_ngcontent-%COMP%]{color:#ed4758}.text-left[_ngcontent-%COMP%]{text-align:left}.text-center[_ngcontent-%COMP%]{text-align:center}.text-right[_ngcontent-%COMP%]{text-align:right}.text-ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link[_ngcontent-%COMP%], .text-link[_ngcontent-%COMP%]:visited{color:inherit;cursor:pointer}.text-link[_ngcontent-%COMP%]:not(.text-underline), .text-link[_ngcontent-%COMP%]:visited:not(.text-underline){text-decoration:none}.text-success[_ngcontent-%COMP%]{color:#38de38}.text-danger[_ngcontent-%COMP%]{color:#de3535}.text-info[_ngcontent-%COMP%]{color:#2d72dc}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.text-pre-line[_ngcontent-%COMP%]{white-space:pre-line}.view-quiz-progress[_ngcontent-%COMP%]{color:#374a68;font-size:12px;letter-spacing:.3px;line-height:1.4em}"],changeDetection:0}),Bb),$b=r("QibW"),Wb=[[["app-list-item"]]],Kb=["app-list-item"],Gb=function(e){return e.Default="default",e.Commafied="commafied",e.flat="flat",e.inline="inline",e}({}),Zb=((Hb=function(){function e(){y(this,e),this.listType=Gb.Default}return v(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||Hb)},Hb.\u0275cmp=j.Jb({type:Hb,selectors:[["app-list"]],inputs:{listType:"listType"},ngContentSelectors:Kb,decls:2,vars:1,consts:[[1,"list",3,"ngClass"]],template:function(e,t){1&e&&(j.kc(Wb),j.Vb(0,"div",0),j.jc(1),j.Ub()),2&e&&j.lc("ngClass","list--"+t.listType)},directives:[we.i],styles:['.list{display:flex;flex-direction:column}.list--default app-list-item{display:list-item;margin-left:16px;list-style-type:disc}.list--commafied{align-items:center;display:flex;flex-direction:row;flex-wrap:wrap;padding:0 4px 4px 0}.list--commafied app-list-item:not(:last-child):after{content:", ";float:right;padding-right:4px}.list--flat app-list-item:not(:last-child){margin-bottom:4px}.list--inline{display:inline-flex;align-items:center;display:flex;flex-direction:row;flex-wrap:wrap}.list--inline app-list-item{margin:0 8px 4px 0}.list__item{display:block}'],encapsulation:2,changeDetection:0}),Hb),Jb=["*"],Xb=((Qb=function(){function e(){y(this,e)}return v(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||Qb)},Qb.\u0275cmp=j.Jb({type:Qb,selectors:[["app-list-item"]],ngContentSelectors:Jb,decls:1,vars:0,template:function(e,t){1&e&&(j.kc(),j.jc(0))},styles:[""],encapsulation:2,changeDetection:0}),Qb);function Yb(e,t){if(1&e&&(j.Vb(0,"app-list-item"),j.Vb(1,"div",1),j.Kc(2),j.Ub(),j.Ub()),2&e){var n=t.$implicit;j.Db(1),j.Eb("data-id",n.id),j.Db(1),j.Lc(n.label)}}var em,tm,nm=((tm=function(){function e(t,n,i){y(this,e),this.store=t,this.graphService=n,this.changeRef=i}return v(e,[{key:"objectIds",get:function(){return this._objectIds},set:function(e){this._objectIds=e;var t=this.store.selectSnapshot(zs.getViewGraph);this.nodes=this.graphService.getNodes(t,e),this.changeRef.markForCheck()}},{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||tm)(j.Pb(L.g),j.Pb(mn),j.Pb(j.i))},tm.\u0275cmp=j.Jb({type:tm,selectors:[["app-view-quiz-object-tree"]],inputs:{objectIds:"objectIds"},decls:2,vars:1,consts:[[4,"ngFor","ngForOf"],[1,"text-14","text-medium","mv-1"]],template:function(e,t){1&e&&(j.Vb(0,"app-list"),j.Ic(1,Yb,3,2,"app-list-item",0),j.Ub()),2&e&&(j.Db(1),j.lc("ngForOf",t.nodes))},directives:[Zb,we.k,Xb],styles:[""],changeDetection:0}),tm),im=((em=function(){function e(){y(this,e)}return v(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||em)},em.\u0275cmp=j.Jb({type:em,selectors:[["app-view-quiz-answer-number"]],inputs:{number:"number"},decls:3,vars:1,consts:[[1,"number","text-10","text-medium"]],template:function(e,t){1&e&&(j.Vb(0,"div",0),j.Vb(1,"div"),j.Kc(2),j.Ub(),j.Ub()),2&e&&(j.Db(2),j.Lc(t.number))},styles:[".number[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:20px;height:20px;color:#131c2a;border:1px solid rgba(55,74,104,.5);border-radius:50%}"],changeDetection:0}),em),om=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function rm(e,t){if(1&e&&(j.Vb(0,"div",3),j.Vb(1,"div",4),j.Qb(2,"app-view-quiz-answer-number",5),j.Ub(),j.Vb(3,"div",6),j.Qb(4,"app-quiz-label-anatomy-select",7),j.Ub(),j.Ub()),2&e){var n=t.index,i=j.gc();j.Db(2),j.lc("number",n+1),j.Db(2),j.lc("options",i.options)("formControlName",n)}}var am,sm=((am=function(){function e(t){y(this,e),this.formBuilder=t,this.valueChange=new j.p,this.ngUnsubscribe=new Z.a,this._options=[],this.form=this.formBuilder.group({options:this.formBuilder.array([])}),this.optionsArray=this.form.get("options")}return v(e,[{key:"options",get:function(){return this._options},set:function(e){Object(ie.isEqual)(e,this._options)||(this._options=e,this.buildFormOptions(e))}},{key:"ngOnInit",value:function(){this.initFormListeners(),this.init()}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"initFormListeners",value:function(){var e=this;this.form.valueChanges.pipe(Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){var n=t.options;e.valueChange.next(n)}))}},{key:"init",value:function(){var e=this;this.activeSubmission$.pipe(Object(Y.a)((function(e){return!Object(ie.isNil)(e)&&!Object(ie.isNil)(e.answer)})),Object(Cp.a)(),Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){var n=d(t,2),i=n[0],o=n[1],r=function(e,t,n){var i=t.findIndex((function(t,n){var i=e[n];return!Object(ie.isEqual)(i,t)})),o=t[i];return t.map((function(e,t){return Object(ie.isEqual)(o,e)&&t!==i?"":e}))}(i.answer||[],o.answer||[]);Object(ie.isEqual)(o,r)||e.form.patchValue({options:r||[]})})),this.activeSubmission$.pipe(Object(Y.a)((function(e){return!Object(ie.isNil)(e)&&!Object(ie.isNil)(e.answer)&&Array.isArray(e.answer)})),Object(Zc.a)((function(e,t){return Object(ie.isEqual)(e,t)})),Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){var n=e.form.value.options,i=t.answer;Object(ie.isEqual)(n,i)||e.form.patchValue({options:i},{emitEvent:!1,onlySelf:!0})}))}},{key:"buildFormOptions",value:function(e){var t=this;this.optionsArray.clear(),e.forEach((function(){t.optionsArray.push(t.formBuilder.control(""))})),this.optionsArray.setValue(e.map((function(){return""})))}}]),e}()).\u0275fac=function(e){return new(e||am)(j.Pb(mh.e))},am.\u0275cmp=j.Jb({type:am,selectors:[["app-view-quiz-label-anatomy"]],inputs:{options:"options"},outputs:{valueChange:"valueChange"},decls:3,vars:2,consts:[[1,"options",3,"formGroup"],["formArrayName","options"],["class","options__item mb-4","data-test","questionAnswer",4,"ngFor","ngForOf"],["data-test","questionAnswer",1,"options__item","mb-4"],[1,"mr-2"],[3,"number"],[1,"options__item-select"],[3,"options","formControlName"]],template:function(e,t){1&e&&(j.Vb(0,"div",0),j.Vb(1,"div",1),j.Ic(2,rm,5,3,"div",2),j.Ub(),j.Ub()),2&e&&(j.lc("formGroup",t.form),j.Db(2),j.lc("ngForOf",t.options))},directives:[mh.o,mh.i,mh.d,we.k,im,kh,mh.n,mh.h],styles:[".options__item[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center}.options__item-select[_ngcontent-%COMP%]{border:1px solid #96a8c0;border-radius:4px;flex:1 1 auto}"],changeDetection:0}),function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);r>3&&a&&Object.defineProperty(t,n,a)}([Object(L.d)(rr.getActiveSubmission),om("design:type",J.a)],am.prototype,"activeSubmission$",void 0),am),cm=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},lm=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function pm(e,t){if(1&e&&(j.Vb(0,"mat-radio-button",8),j.Kc(1),j.Ub()),2&e){var n=t.$implicit;j.lc("value",n.value),j.Db(1),j.Mc(" ",n.label," ")}}function um(e,t){if(1&e){var n=j.Wb();j.Vb(0,"div"),j.Vb(1,"mat-radio-group",6),j.cc("change",(function(e){return j.xc(n),j.gc(2).handleMultipleChoiceChange(e)})),j.Ic(2,pm,2,2,"mat-radio-button",7),j.Ub(),j.Ub()}if(2&e){var i=j.gc(2);j.Db(2),j.lc("ngForOf",i.question.data.options)}}function dm(e,t){if(1&e&&(j.Vb(0,"div",10),j.Qb(1,"app-view-quiz-object-tree",11),j.Ub()),2&e){var n=j.gc(3);j.Db(1),j.lc("objectIds",n.question.data.correctAnswer)}}function gm(e,t){if(1&e&&(j.Vb(0,"div"),j.Ic(1,dm,2,1,"div",9),j.Ub()),2&e){var n=j.gc(2);j.Db(1),j.lc("ngIf",n.question.data.showAnswerList)}}function hm(e,t){if(1&e){var n=j.Wb();j.Vb(0,"div"),j.Vb(1,"app-view-quiz-label-anatomy",12),j.cc("valueChange",(function(e){return j.xc(n),j.gc(2).handleLabelAnatomyChanges(e)})),j.Ub(),j.Ub()}if(2&e){var i=j.gc(2);j.Db(1),j.lc("options",i.question.data.options)}}function fm(e,t){if(1&e&&(j.Vb(0,"div",1),j.Vb(1,"div",2),j.Qb(2,"app-content-blocks",3),j.Ub(),j.Vb(3,"div",4),j.Ic(4,um,3,1,"div",5),j.Ic(5,gm,2,1,"div",5),j.Ic(6,hm,2,1,"div",5),j.Ub(),j.Ub()),2&e){var n=j.gc();j.Db(2),j.lc("contentBlocks",n.question.questionPrompt),j.Db(1),j.lc("ngSwitch",n.question.type),j.Db(1),j.lc("ngSwitchCase",n.QuestionType.MultipleChoice),j.Db(1),j.lc("ngSwitchCase",n.QuestionType.SelectAnatomy),j.Db(1),j.lc("ngSwitchCase",n.QuestionType.LabelAnatomy)}}var bm,mm=((bm=function(){function e(t,n){y(this,e),this.changeRef=t,this.viewService=n,this.disabled=!1,this.QuestionType=No,this.ngUnsubscribe=new Z.a}return v(e,[{key:"question",get:function(){return this._question},set:function(e){this._question=e,this.initQuestionListeners()}},{key:"value",get:function(){return this._value},set:function(e){this._value=e,this.onChange(e)}},{key:"handleMultipleChoiceChange",value:function(e){this.writeValue(e.value)}},{key:"handleLabelAnatomyChanges",value:function(e){this.writeValue(e)}},{key:"ngOnInit",value:function(){}},{key:"initQuestionListeners",value:function(){switch(this.question.type){case No.SelectAnatomy:this.initSelectAnatomyListeners(),this.viewService.toggleToolbar("tools");break;case No.Instructions:this.initInstructions(),this.viewService.toggleToolbar("none");break;default:this.viewService.toggleToolbar("none")}}},{key:"initSelectAnatomyListeners",value:function(){var e=this;this.checkedNodesIds$.pipe(Object(Zc.a)((function(e,t){return Object(ie.isEqual)(e,t)})),Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){e.writeValue(t),e.changeRef.markForCheck()}))}},{key:"initInstructions",value:function(){var e=this;setTimeout((function(){e.writeValue("-"),e.changeRef.markForCheck()}))}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"onChange",value:function(e){}},{key:"onTouched",value:function(){}},{key:"registerOnTouched",value:function(e){this.onTouched=e}},{key:"registerOnChange",value:function(e){this.onChange=e}},{key:"writeValue",value:function(e){this.value=e}},{key:"setDisabledState",value:function(e){this.disabled=e}}]),e}()).\u0275fac=function(e){return new(e||bm)(j.Pb(j.i),j.Pb(Wp))},bm.\u0275cmp=j.Jb({type:bm,selectors:[["app-view-quiz-question"]],inputs:{question:"question",value:"value"},features:[j.Cb([{provide:mh.l,useExisting:Object(j.W)((function(){return bm})),multi:!0}])],decls:1,vars:1,consts:[["class","view-quiz-question text-14 mb-8","data-test","question",4,"ngIf"],["data-test","question",1,"view-quiz-question","text-14","mb-8"],["data-test","questionPrompt",1,"view-quiz-question__prompt","mb-4"],[3,"contentBlocks"],[3,"ngSwitch"],[4,"ngSwitchCase"],[1,"flex","flex-column",3,"change"],["data-test","questionAnswer","class","view-quiz-question__option",3,"value",4,"ngFor","ngForOf"],["data-test","questionAnswer",1,"view-quiz-question__option",3,"value"],["class","ml-3",4,"ngIf"],[1,"ml-3"],[3,"objectIds"],[3,"options","valueChange"]],template:function(e,t){1&e&&j.Ic(0,fm,7,5,"div",0),2&e&&j.lc("ngIf",t.question)},directives:[we.l,ch,we.n,we.o,$b.b,we.k,$b.a,nm,sm],styles:[".text-8{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-28{font-size:28px;letter-spacing:.7px;line-height:1.4em}.text-28.text-uppercase{font-size:28px;letter-spacing:1.68px;line-height:1.25em;text-transform:uppercase}.text-header{font-weight:700}.text--code{font-family:Courier New,Courier,monospace}.text-uppercase{text-transform:uppercase}.text-xlight{font-weight:200}.text-light{font-weight:300}.text-medium{font-weight:500}.text-semibold{font-weight:600}.text-bold{font-weight:700}.text-underline{text-decoration:underline}.text-italic{font-style:italic}.text-bright{color:#fff}.text-dim{color:#96a8c0}.text-error{color:#ed4758}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.text-ellipsis{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link,.text-link:visited{color:inherit;cursor:pointer}.text-link:not(.text-underline),.text-link:visited:not(.text-underline){text-decoration:none}.text-success{color:#38de38}.text-danger{color:#de3535}.text-info{color:#2d72dc}.text-nowrap{white-space:nowrap}.text-pre-line{white-space:pre-line}.view-quiz-question__option{font-size:14px;letter-spacing:.35px;line-height:1.4em;padding:12px 0 12px 12px}.view-quiz-question__option,.view-quiz-question__option>*{white-space:normal!important}.view-quiz-question__option .mat-radio-label{align-items:flex-start!important}.view-quiz-question__option .mat-radio-label-content{padding-left:12px!important}"],encapsulation:2,changeDetection:0}),cm([Object(L.d)(jo.getCheckedNodeIds),lm("design:type",J.a)],bm.prototype,"checkedNodesIds$",void 0),cm([Object(L.d)(rr.getActiveSubmission),lm("design:type",J.a)],bm.prototype,"activeSubmission$",void 0),bm);function vm(e,t){1&e&&j.Qb(0,"app-icon",6)}function ym(e,t){1&e&&j.Qb(0,"app-icon",7)}function xm(e,t){1&e&&(j.Vb(0,"span",8),j.Qb(1,"span",9),j.Ub())}var Om,wm=["*"],km=((Om=function(){function e(){y(this,e)}return v(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||Om)},Om.\u0275cmp=j.Jb({type:Om,selectors:[["app-view-quiz-answer-option"]],inputs:{correct:"correct"},ngContentSelectors:wm,decls:7,vars:7,consts:[["data-test","answerOptionContainer",1,"option"],[1,"flex","relative",3,"ngSwitch"],["class","option__icon option__icon--correct","style","font-size: 20px","icon","check-circle",4,"ngSwitchCase"],["class","option__icon option__icon--incorrect","style","font-size: 20px","icon","times-circle",4,"ngSwitchCase"],["class","option__icon",4,"ngSwitchDefault"],[1,"pl-2"],["icon","check-circle",1,"option__icon","option__icon--correct",2,"font-size","20px"],["icon","times-circle",1,"option__icon","option__icon--incorrect",2,"font-size","20px"],[1,"option__icon"],[1,"mat-radio-outer-circle"]],template:function(e,t){1&e&&(j.kc(),j.Vb(0,"div",0),j.Vb(1,"div",1),j.Ic(2,vm,1,0,"app-icon",2),j.Ic(3,ym,1,0,"app-icon",3),j.Ic(4,xm,2,0,"span",4),j.Vb(5,"div",5),j.jc(6),j.Ub(),j.Ub(),j.Ub()),2&e&&(j.Hb("option--correct",!0===t.correct)("option--incorrect",!1===t.correct),j.Db(1),j.lc("ngSwitch",t.correct),j.Db(1),j.lc("ngSwitchCase",!0),j.Db(1),j.lc("ngSwitchCase",!1))},directives:[we.n,we.o,we.p,vp],styles:[".text-8[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase[_ngcontent-%COMP%]{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase[_ngcontent-%COMP%]{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase[_ngcontent-%COMP%]{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase[_ngcontent-%COMP%]{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-28[_ngcontent-%COMP%]{font-size:28px;letter-spacing:.7px;line-height:1.4em}.text-28.text-uppercase[_ngcontent-%COMP%]{font-size:28px;letter-spacing:1.68px;line-height:1.25em;text-transform:uppercase}.text-header[_ngcontent-%COMP%]{font-weight:700}.text--code[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.text-xlight[_ngcontent-%COMP%]{font-weight:200}.text-light[_ngcontent-%COMP%]{font-weight:300}.text-medium[_ngcontent-%COMP%]{font-weight:500}.text-semibold[_ngcontent-%COMP%]{font-weight:600}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-underline[_ngcontent-%COMP%]{text-decoration:underline}.text-italic[_ngcontent-%COMP%]{font-style:italic}.text-bright[_ngcontent-%COMP%]{color:#fff}.text-dim[_ngcontent-%COMP%]{color:#96a8c0}.text-error[_ngcontent-%COMP%]{color:#ed4758}.text-left[_ngcontent-%COMP%]{text-align:left}.text-center[_ngcontent-%COMP%]{text-align:center}.text-right[_ngcontent-%COMP%]{text-align:right}.text-ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link[_ngcontent-%COMP%], .text-link[_ngcontent-%COMP%]:visited{color:inherit;cursor:pointer}.text-link[_ngcontent-%COMP%]:not(.text-underline), .text-link[_ngcontent-%COMP%]:visited:not(.text-underline){text-decoration:none}.text-success[_ngcontent-%COMP%]{color:#38de38}.text-danger[_ngcontent-%COMP%]{color:#de3535}.text-info[_ngcontent-%COMP%]{color:#2d72dc}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.text-pre-line[_ngcontent-%COMP%]{white-space:pre-line}.option[_ngcontent-%COMP%]{padding:12px;border-radius:4px;margin-bottom:8px;color:#131c2a}.option--correct[_ngcontent-%COMP%]{border:1px solid #83e692;background-color:#f0fff0}.option--incorrect[_ngcontent-%COMP%]{border:1px solid #f44336;background-color:#ffe2db}.option__icon[_ngcontent-%COMP%]{position:relative;flex:0 0 20px;justify-content:center}.option__icon--correct[_ngcontent-%COMP%]{color:#83e692}.option__icon--incorrect[_ngcontent-%COMP%]{color:#f44336}"],changeDetection:0}),Om);function Cm(e,t){if(1&e&&(j.Vb(0,"div"),j.Vb(1,"app-view-quiz-answer-option",1),j.Vb(2,"div",2),j.Kc(3),j.Ub(),j.Ub(),j.Ub()),2&e){var n=t.$implicit,i=j.gc();j.Db(1),j.lc("correct",i.isOptionAnswerCorrect(i.question,n.value,i.answer)),j.Db(2),j.Mc(" ",n.label," ")}}var Sm,_m=((Sm=function(){function e(){y(this,e)}return v(e,[{key:"ngOnInit",value:function(){}},{key:"isOptionAnswerCorrect",value:function(e,t,n){var i=qo(e,[t]);return t===n[0]||i?i:void 0}}]),e}()).\u0275fac=function(e){return new(e||Sm)},Sm.\u0275cmp=j.Jb({type:Sm,selectors:[["app-view-quiz-multiple-choice-answer"]],inputs:{question:"question",answer:"answer",summary:"summary"},decls:1,vars:1,consts:[[4,"ngFor","ngForOf"],[3,"correct"],[1,"text-semibold"]],template:function(e,t){1&e&&j.Ic(0,Cm,4,2,"div",0),2&e&&j.lc("ngForOf",t.question.data.options)},directives:[we.k,km],styles:[""],changeDetection:0}),Sm);function jm(e,t){if(1&e){var n=j.Wb();j.Vb(0,"div",6),j.Vb(1,"button",7),j.cc("click",(function(){j.xc(n);var e=j.gc();return e.handleSelectedObjectsClick(e.answer)})),j.Kc(2," Highlight My Answer "),j.Ub(),j.Vb(3,"button",8),j.cc("click",(function(){j.xc(n);var e=j.gc();return e.handleCorrectObjectsClick(e.question.data.correctAnswer)})),j.Kc(4," Highlight Correct Answer "),j.Ub(),j.Ub()}}var Pm,Mm=((Pm=function(){function e(t,n,i){y(this,e),this.graphService=t,this.viewService=n,this.store=i}return v(e,[{key:"isCorrect",get:function(){return qo(this.question,this.answer)}},{key:"fadeNonselected",value:function(e){var t=this.store.selectSnapshot(zs.getViewGraph),n=this.graphService.getInverseSelection(t,e),i=this.graphService.getNodes(t,n);this.store.dispatch(new Yi.UpdateNodesPaint(Io,i.map((function(e){return e.id}))))}},{key:"handleCorrectObjectsClick",value:function(e){this.highlightNodes(e)}},{key:"handleSelectedObjectsClick",value:function(e){this.highlightNodes(e)}},{key:"highlightNodes",value:function(e){var t=e.filter((function(e){return e&&""!==e}));this.resetSelectAndFade(),this.repositionCamera(t),this.fadeNonselected(t)}},{key:"repositionCamera",value:function(e){1===e.length?this.store.dispatch(new Pt(e[0])):this.viewService.resetCamera()}},{key:"resetSelectAndFade",value:function(){this.viewService.clearSelectedNodes(),this.viewService.clearFadedNodes()}}]),e}()).\u0275fac=function(e){return new(e||Pm)(j.Pb(mn),j.Pb(Wp),j.Pb(L.g))},Pm.\u0275cmp=j.Jb({type:Pm,selectors:[["app-view-quiz-select-anatomy-answer"]],inputs:{question:"question",answer:"answer",summary:"summary"},decls:9,vars:4,consts:[[3,"correct"],["selectAnatomyAnswer",""],[1,"flex","flex-column","text-semibold"],[1,"mt-2","ml-2"],[3,"objectIds"],["class","mt-4",4,"ngIf"],[1,"mt-4"],["buttonType","outline","buttonTheme","light","app-button","","data-test","highlightUserAnswers",1,"w-100","mv-2",3,"click"],["buttonType","outline","buttonTheme","light","app-button","","data-test","highlightCorrectAnswers",1,"w-100","mv-2",3,"click"]],template:function(e,t){if(1&e&&(j.Vb(0,"div"),j.Vb(1,"app-view-quiz-answer-option",0,1),j.Vb(3,"div",2),j.Vb(4,"div"),j.Kc(5),j.Ub(),j.Vb(6,"div",3),j.Qb(7,"app-view-quiz-object-tree",4),j.Ub(),j.Ub(),j.Ub(),j.Ic(8,jm,5,0,"div",5),j.Ub()),2&e){var n=j.tc(2);j.Db(1),j.lc("correct",t.isCorrect),j.Db(4),j.Mc("",n.correct?"Correct":"Incorrect","! You selected:"),j.Db(2),j.lc("objectIds",t.answer),j.Db(1),j.lc("ngIf",!t.summary&&!t.isCorrect)}},directives:[km,nm,we.l,Dd],styles:[""],changeDetection:0}),Pm);function Im(e,t){if(1&e&&(j.Vb(0,"div",9),j.Kc(1),j.Ub()),2&e){var n=j.gc().$implicit;j.Db(1),j.Mc(" ",n.label.title," ")}}function zm(e,t){if(1&e&&(j.Vb(0,"div"),j.Kc(1," You selected "),j.Vb(2,"em",9),j.Kc(3),j.Ub(),j.Kc(4,". "),j.Ub(),j.Vb(5,"div",10),j.Kc(6," This is the "),j.Vb(7,"em",9),j.Kc(8),j.Ub(),j.Kc(9,". "),j.Ub()),2&e){var n=j.gc(),i=n.index,o=n.$implicit,r=j.gc();j.Db(3),j.Lc(r.getSelectedUserOption(i).label.title.trim()),j.Db(5),j.Lc(o.label.title.trim())}}function Tm(e,t){if(1&e&&(j.Vb(0,"div",1),j.Vb(1,"div",2),j.Qb(2,"app-view-quiz-answer-number",3),j.Ub(),j.Vb(3,"div",4),j.Vb(4,"app-view-quiz-answer-option",5,6),j.Ic(6,Im,2,1,"div",7),j.Ic(7,zm,10,2,"ng-template",null,8,j.Jc),j.Ub(),j.Ub(),j.Ub()),2&e){var n=t.index,i=j.tc(5),o=j.tc(8),r=j.gc();j.Db(2),j.lc("number",n+1),j.Db(2),j.lc("correct",r.isOptionAnswerCorrect(n)),j.Db(2),j.lc("ngIf",i.correct)("ngIfElse",o)}}var Um,Dm=((Um=function(){function e(){y(this,e)}return v(e,[{key:"ngOnInit",value:function(){}},{key:"isOptionAnswerCorrect",value:function(e){return this.answer[e]===this.question.data.correctAnswer[e]}},{key:"getSelectedUserOption",value:function(e){var t=this.answer[e];return this.question.data.options.find((function(e){return e.value===t}))}}]),e}()).\u0275fac=function(e){return new(e||Um)},Um.\u0275cmp=j.Jb({type:Um,selectors:[["app-view-quiz-label-anatomy-answer"]],inputs:{question:"question",answer:"answer",summary:"summary"},decls:1,vars:1,consts:[["class","answers",4,"ngFor","ngForOf"],[1,"answers"],[1,"mt-2","mr-2"],[3,"number"],[1,"answers__option"],[3,"correct"],["answerOption",""],["class","text-semibold",4,"ngIf","ngIfElse"],["falseBlock",""],[1,"text-semibold"],[1,"mt-1"]],template:function(e,t){1&e&&j.Ic(0,Tm,9,4,"div",0),2&e&&j.lc("ngForOf",t.question.data.options)},directives:[we.k,im,km,we.l],styles:[".answers[_ngcontent-%COMP%]{display:flex;flex-direction:row}.answers__option[_ngcontent-%COMP%]{flex:1 1 auto}"],changeDetection:0}),Um);function Lm(e,t){if(1&e&&(j.Vb(0,"div",7),j.Kc(1),j.Ub()),2&e){var n=j.gc();j.Db(1),j.Mc("",n.questionNumber,".")}}function Em(e,t){if(1&e&&(j.Vb(0,"div"),j.Qb(1,"app-view-quiz-multiple-choice-answer",8),j.Ub()),2&e){var n=j.gc();j.Db(1),j.lc("question",n.question)("answer",n.answer)("summary",n.summary)}}function Fm(e,t){if(1&e&&(j.Vb(0,"div"),j.Qb(1,"app-view-quiz-select-anatomy-answer",8),j.Ub()),2&e){var n=j.gc();j.Db(1),j.lc("question",n.question)("answer",n.answer)("summary",n.summary)}}function Am(e,t){if(1&e&&(j.Vb(0,"div"),j.Qb(1,"app-view-quiz-label-anatomy-answer",8),j.Ub()),2&e){var n=j.gc();j.Db(1),j.lc("question",n.question)("answer",n.answer)("summary",n.summary)}}var Rm,Vm,Nm=((Rm=function(){function e(t){y(this,e),this.store=t,this.QuestionType=No}return v(e,[{key:"ngOnInit",value:function(){this.initAnswerConfig()}},{key:"initAnswerConfig",value:function(){var e=this.question.type;this.store.dispatch(new Eo.SetQuizPickMode(e===No.SelectAnatomy?"none":"single"))}}]),e}()).\u0275fac=function(e){return new(e||Rm)(j.Pb(L.g))},Rm.\u0275cmp=j.Jb({type:Rm,selectors:[["app-view-quiz-answer"]],inputs:{question:"question",questionNumber:"questionNumber",answer:"answer",summary:"summary"},decls:11,vars:7,consts:[["data-test","answer",1,"answer"],[1,"answer__prompt"],["class","mr-1",4,"ngIf"],[3,"contentBlocks"],[3,"ngSwitch"],[4,"ngSwitchCase"],[1,"answer__explanation"],[1,"mr-1"],[3,"question","answer","summary"]],template:function(e,t){1&e&&(j.Vb(0,"div",0),j.Vb(1,"div",1),j.Ic(2,Lm,2,1,"div",2),j.Vb(3,"div"),j.Qb(4,"app-content-blocks",3),j.Ub(),j.Ub(),j.Vb(5,"div",4),j.Ic(6,Em,2,3,"div",5),j.Ic(7,Fm,2,3,"div",5),j.Ic(8,Am,2,3,"div",5),j.Ub(),j.Vb(9,"div",6),j.Qb(10,"app-content-blocks",3),j.Ub(),j.Ub()),2&e&&(j.Db(2),j.lc("ngIf",t.questionNumber),j.Db(2),j.lc("contentBlocks",t.question.questionPrompt),j.Db(1),j.lc("ngSwitch",t.question.type),j.Db(1),j.lc("ngSwitchCase",t.QuestionType.MultipleChoice),j.Db(1),j.lc("ngSwitchCase",t.QuestionType.SelectAnatomy),j.Db(1),j.lc("ngSwitchCase",t.QuestionType.LabelAnatomy),j.Db(2),j.lc("contentBlocks",t.question.explanation))},directives:[we.l,ch,we.n,we.o,_m,Mm,Dm],styles:[".text-8[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase[_ngcontent-%COMP%]{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase[_ngcontent-%COMP%]{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase[_ngcontent-%COMP%]{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase[_ngcontent-%COMP%]{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-28[_ngcontent-%COMP%]{font-size:28px;letter-spacing:.7px;line-height:1.4em}.text-28.text-uppercase[_ngcontent-%COMP%]{font-size:28px;letter-spacing:1.68px;line-height:1.25em;text-transform:uppercase}.text-header[_ngcontent-%COMP%]{font-weight:700}.text--code[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.text-xlight[_ngcontent-%COMP%]{font-weight:200}.text-light[_ngcontent-%COMP%]{font-weight:300}.text-medium[_ngcontent-%COMP%]{font-weight:500}.text-semibold[_ngcontent-%COMP%]{font-weight:600}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-underline[_ngcontent-%COMP%]{text-decoration:underline}.text-italic[_ngcontent-%COMP%]{font-style:italic}.text-bright[_ngcontent-%COMP%]{color:#fff}.text-dim[_ngcontent-%COMP%]{color:#96a8c0}.text-error[_ngcontent-%COMP%]{color:#ed4758}.text-left[_ngcontent-%COMP%]{text-align:left}.text-center[_ngcontent-%COMP%]{text-align:center}.text-right[_ngcontent-%COMP%]{text-align:right}.text-ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link[_ngcontent-%COMP%], .text-link[_ngcontent-%COMP%]:visited{color:inherit;cursor:pointer}.text-link[_ngcontent-%COMP%]:not(.text-underline), .text-link[_ngcontent-%COMP%]:visited:not(.text-underline){text-decoration:none}.text-success[_ngcontent-%COMP%]{color:#38de38}.text-danger[_ngcontent-%COMP%]{color:#de3535}.text-info[_ngcontent-%COMP%]{color:#2d72dc}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.text-pre-line[_ngcontent-%COMP%]{white-space:pre-line}.answer[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.answer__prompt[_ngcontent-%COMP%]{display:flex;padding-bottom:16px}.answer__explanation[_ngcontent-%COMP%]{padding-top:24px}"],changeDetection:0}),Rm),Bm=function e(){y(this,e)},Hm=function(){var e=function e(){y(this,e)};return e.type="[Auth] Is Logged In",e}(),Qm=function(){var e=function e(){y(this,e)};return e.type="[Auth] Is Logged In Success",e}(),qm=function(){var e=function e(){y(this,e)};return e.type="[Auth] Is Logged In Failure",e}(),$m=function(){var e=function e(t){y(this,e),this.login=t};return e.type="[Auth] Login With Biodigital",e}(),Wm=function(){var e=function e(){y(this,e)};return e.type="[Auth] Load Google Auth",e}(),Km=function(){var e=function e(t){y(this,e),this.online=t};return e.type="[Auth] Google Auth Service Online",e}(),Gm=function(){var e=function e(t){y(this,e),this.login=t};return e.type="[Auth] Login With Google",e}(),Zm=function(){var e=function e(t,n){y(this,e),this.loginType=t,this.response=n};return e.type="[Auth] Login Success",e}(),Jm=function(){var e=function e(t,n,i){y(this,e),this.loginType=t,this.error=n,this.login=i};return e.type="[Auth] Login Failure",e}(),Xm=function(){var e=function e(){y(this,e)};return e.type="[Auth] Logout",e}(),Ym=function(){var e=function e(){y(this,e)};return e.type="[Auth] Logout Success",e}(),ev=function(){var e=function e(){y(this,e)};return e.type="[Auth] Logout Failure",e}(),tv=function(){var e=function e(){y(this,e)};return e.type="[Auth] Get Environment Settings",e}(),nv=function(){var e=function e(t){y(this,e),this.environmentSettings=t};return e.type="[Auth] Get Environment Settings Success",e}(),iv=function(){var e=function e(t){y(this,e),this.error=t};return e.type="[Auth] Get Environment Settings Failure",e}(),ov=function(){var e=function e(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];y(this,e),this.hardCheck=t};return e.type="[Auth] Get User Profile",e}(),rv=function(){var e=function e(t){y(this,e),this.userProfile=t};return e.type="[Auth] Get User Profile Success",e}(),av=function(){var e=function e(t){y(this,e),this.error=t};return e.type="[Auth] Get User Profile Failure",e}(),sv=function(){var e=function e(t){y(this,e),this.userProfile=t};return e.type="[Auth] Update User Profile",e}(),cv=function(){var e=function e(t){y(this,e),this.userProfile=t};return e.type="[Auth] Update User Profile Success",e}(),lv=function(){var e=function e(t){y(this,e),this.error=t};return e.type="[Auth] Update User Profile Failure",e}(),pv=function(){var e=function e(){y(this,e)};return e.type="[Auth] Delete User Profile",e}(),uv=function(){var e=function e(t){y(this,e),this.userEmail=t};return e.type="[Auth] Delete User Profile Success",e}(),dv=function(){var e=function e(t){y(this,e),this.error=t};return e.type="[Auth] Delete User Profile Failure",e}(),gv=function(){var e=function e(t){y(this,e),this.email=t};return e.type="[Auth] Check Profile",e}(),hv=function(){var e=function e(t){y(this,e),this.profile=t};return e.type="[Auth] Check Profile Success",e}(),fv=function(){var e=function e(t){y(this,e),this.error=t};return e.type="[Auth] Check Profile Failure",e}(),bv=function(){var e=function e(){y(this,e)};return e.type="[Auth] Get User Roles",e}(),mv=function(){var e=function e(t){y(this,e),this.email=t};return e.type="[Auth] Reset Password",e}(),vv=function(){var e=function e(t){y(this,e),this.email=t};return e.type="[Auth] Reset Password Success",e}(),yv=function(){var e=function e(t){y(this,e),this.error=t};return e.type="[Auth] Reset Password Failure",e}(),xv=function(){var e=function e(t){y(this,e),this.email=t};return e.type="[Auth] Transfer Facebook Account",e}(),Ov=function(){var e=function e(t){y(this,e),this.email=t};return e.type="[Auth] Transfer Facebook Account Success",e}(),wv=function(){var e=function e(t){y(this,e),this.error=t};return e.type="[Auth] Transfer Facebook Account Failure",e}(),kv=function(){var e=function e(t,n,i){y(this,e),this.currentPassword=t,this.newPassword=n,this.confirmNewPassword=i};return e.type="[Auth] Update Password",e}(),Cv=function(){var e=function e(){y(this,e)};return e.type="[Auth] Update Password Success",e}(),Sv=function(){var e=function e(t){y(this,e),this.error=t};return e.type="[Auth] Update Password Failure",e}(),_v=function(){var e=function e(){y(this,e)};return e.type="[Auth] Check Session",e}(),jv=function(){var e=function e(t){y(this,e),this.value=t};return e.type="[Auth] Sign Up",e}(),Pv=function(){var e=function e(t){y(this,e),this.response=t};return e.type="[Auth] Sign Up Success",e}(),Mv=function(){var e=function e(t){y(this,e),this.error=t};return e.type="[Auth] Sign Up Failure",e}(),Iv=function(){var e=function e(t){y(this,e),this.locale=t};return e.type="[Auth] Set User Locale",e}(),zv=function(){var e=function e(t){y(this,e),this.locale=t};return e.type="[Auth] Set User Locale Success",e}(),Tv=function(){var e=function e(){y(this,e)};return e.type="[Auth] Check Locale",e}(),Uv=function(){var e=function e(){y(this,e)};return e.type="[Auth] Get User Apps",e}(),Dv=function(){var e=function e(t){y(this,e),this.apps=t};return e.type="[Auth] Set User Apps",e}(),Lv=function(){var e=function e(){y(this,e)};return e.type="[Auth] Check Selected App",e}(),Ev=function(){var e=function e(t){y(this,e),this.appId=t};return e.type="[Auth] Set Selected User App",e}(),Fv=function(){var e=function e(t){y(this,e),this.message=t};return e.type="[Auth] Send User Message",e}(),Av=function(){var e=function e(t){y(this,e),this.message=t};return e.type="[Auth] Send User Message Success",e}(),Rv=function(){var e=function e(t){y(this,e),this.err=t};return e.type="[Auth] Send User Message Fail",e}(),Vv=function(){var e=function e(t,n){y(this,e),this.type=t,this.mode=n};return e.type="[Auth] Get User Message",e}(),Nv=function(){var e=function e(t){y(this,e),this.message=t};return e.type="[Auth] Get User Message Success",e}(),Bv=function(){var e=function e(t){y(this,e),this.type=t};return e.type="[Auth] Get User Message Fail",e}(),Hv=function(){var e=function e(t){y(this,e),this.messageSeenId=t};return e.type="[Auth] Set Message Viewed",e}(),Qv=function(){var e=function e(){y(this,e)};return e.type="[Auth] Set Message Viewed Success",e}(),qv=function(){var e=function e(){y(this,e)};return e.type="[Auth] Set Message Viewed Fail",e}(),$v=function(){var e=function e(t){y(this,e),this.error=t};return e.type="[Auth] Verify Fail",e}(),Wv=function(){var e=function e(){y(this,e)};return e.type="[Auth] Reset",e}(),Kv=function(){var e=function e(t,n){y(this,e),this.email=t,this.token=n};return e.type="[Auth] Request Verification Code",e}(),Gv=function(){var e=function e(t){y(this,e),this.response=t};return e.type="[Auth] Request Verification Code Success",e}(),Zv=function(){var e=function e(t){y(this,e),this.error=t};return e.type="[Auth] Request Verification Code Fail",e}(),Jv=function(){var e=function e(t,n,i){y(this,e),this.email=t,this.token=n,this.code=i};return e.type="[Auth] Verify Profile",e}(),Xv=function(){var e=function e(t){y(this,e),this.response=t};return e.type="[Auth] Verify Profile Success",e}(),Yv=function(){var e=function e(t){y(this,e),this.error=t};return e.type="[Auth] Verify Profile Fail",e}(),ey=function(){var e=function e(t,n){y(this,e),this.contentId=t,this.contentType=n};return e.type="[Auth] Set Content Viewed",e}(),ty=function(){var e=function e(){y(this,e)};return e.type="[Auth] Set Content Viewed Success",e}(),ny=function(){var e=function e(){y(this,e)};return e.type="[Auth] Check Content Viewed",e}(),iy=function(){var e=function e(t){y(this,e),this.contentViews=t};return e.type="[Auth] Check Content Viewed Success",e}(),oy=function(){var e=function e(t){y(this,e),this.isDeveloperReferral=t};return e.type="[Auth] Set Developer Referral",e}(),ry=function e(){y(this,e)},ay=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},sy=(Vm=function e(){y(this,e)},function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);r>3&&a&&Object.defineProperty(t,n,a)}([Object(ce.Type)((function(){return ry})),ay("design:type",Array)],Vm.prototype,"organizations",void 0),Vm),cy=function(){function e(){y(this,e)}return v(e,null,[{key:"fromJSON",value:function(t){var n=new e;return n.email=t.user_email,n.credentials=t.credentials,n.isUser=t.is_user,n.isThirdParty=t.user_is_third_party,n.thirdPartyProvider=t.user_third_party_provider,n.isDeveloper=t.user_is_developer,n.isDeveloperActive=t.user_is_developer_active,n.isDeveloperVerified=t.user_is_developer_verified,n.firstName=t.user_first_name,n.lastName=t.user_last_name,n.name="".concat(t.firstName," ").concat(t.lastName),n}}]),e}(),ly=function(){function e(){y(this,e)}return v(e,null,[{key:"fromJSON",value:function(t){var n=new e;return n.google=t.google_api_key,n}}]),e}(),py=function e(){y(this,e),this.version=4,this.groupInviteMode=0,this.groupCodeMode=0},uy=function(e){n(i,e);var t=o(i);function i(){var e;return y(this,i),(e=t.apply(this,arguments)).version=4,e}return v(i,null,[{key:"toJSON",value:function(e){return{version:e.version,app_producttype:e.app_producttype,app_productkey:e.app_productkey,email:e.email,password:e.password,first_name:e.firstName,last_name:e.lastName,group_invite_mode:e.groupInviteMode,group_invite_key:e.groupInviteKey,group_code_mode:e.groupCodeMode,group_code:e.groupCode,group_ovid_mode:e.groupOvidMode,group_ovid_osptok:e.groupOvidOsptok,platform:e.platform,return_to:e.returnTo,brand_id:e.brandId,locale_id:e.localeId,timestamp:e.timestamp,site_verify_response:e.site_verify_response}}}]),i}(py),dy=function(e){n(i,e);var t=o(i);function i(e){var n;return y(this,i),(n=t.call(this)).token=e,n}return v(i,null,[{key:"toJSON",value:function(e){return{id_token:e.token,version:e.version,app_producttype:e.app_producttype,app_productkey:e.app_productkey,group_invite_mode:e.groupInviteMode,group_invite_key:e.groupInviteKey,group_code_mode:e.groupCodeMode,group_code:e.groupCode,group_ovid_mode:e.groupOvidMode,group_ovid_osptok:e.groupOvidOsptok,platform:e.platform,return_to:e.returnTo,brand_id:e.brandId,locale_id:e.localeId,timestamp:e.timestamp,site_verify_response:e.site_verify_response}}}]),i}(py),gy=function(e){n(i,e);var t=o(i);function i(e,n,o){var r;return y(this,i),(r=t.call(this)).email=e,r.password=n,r.rememberMe=o,r}return v(i,null,[{key:"toJSON",value:function(e){return{id_token:e.token,version:e.version,app_producttype:e.app_producttype,app_productkey:e.app_productkey,group_invite_mode:e.groupInviteMode,group_invite_key:e.groupInviteKey,group_code_mode:e.groupCodeMode,group_code:e.groupCode,group_ovid_mode:e.groupOvidMode,group_ovid_osptok:e.groupOvidOsptok,email:e.email,password:e.password,email_remember_me:e.rememberMe,platform:e.platform,return_to:e.returnTo,brand_id:e.brandId,locale_id:e.localeId,timestamp:e.timestamp,site_verify_response:e.site_verify_response}}}]),i}(py),hy=r("jCJ1"),fy=function(e){return e.Zendesk="zendesk",e}({}),by=function e(){y(this,e)},my=function(e){return e.AssignRole="assignRole",e.RemoveUser="removeUser",e.TransferContent="transferContent",e.CreateCollection="createCollection",e.DeleteCollection="deleteCollection",e.EditTeamAccount="editTeamAccount",e.EditTeamBookmarks="editTeamBookmarks",e.EditAllTeamBookmarks="editAllTeamBookmarks",e.AddTeamBookmarks="addTeamBookmarks",e.RemoveTeamBookmarks="removeTeamBookmarks",e.EditBookmarks="editBookmarks",e.PublishBookmarks="publishBookmarks",e.SavePrivateBookmarks="savePrivateBookmarks",e.CopyUrl="copyURL",e.ViewBookmarks="viewBookmarks",e.InviteUsers="inviteUsers",e.ExportCSV="exportCSV",e.DuplicateTeamBookmarks="duplicateTeamBookmarks",e}({}),vy=function(e){return e.Admin="admin",e.Creator="creator",e.Viewer="viewer",e}({}),yy=[my.ViewBookmarks,my.CopyUrl,my.SavePrivateBookmarks,my.ExportCSV],xy=[].concat(yy,[my.InviteUsers,my.PublishBookmarks,my.EditBookmarks,my.EditTeamBookmarks,my.RemoveTeamBookmarks,my.AddTeamBookmarks,my.DuplicateTeamBookmarks]),Oy=[].concat(p(xy),[my.InviteUsers,my.EditTeamAccount,my.EditAllTeamBookmarks,my.CreateCollection,my.TransferContent,my.RemoveUser,my.AssignRole]),wy=[vy.Viewer,vy.Creator,vy.Admin],ky={role_id:void 0,role_name:vy.Creator,role_display_name:"",role_description:"",permissions:p(xy)},Cy=(c(m={},vy.Viewer,yy),c(m,vy.Creator,xy),c(m,vy.Admin,Oy),m),Sy=(c(x={},vy.Viewer,"Can view team content and edit personal content"),c(x,vy.Creator,"Can edit and view team content"),c(x,vy.Admin,"Can manage team settings and edit all content"),x);function _y(e){var t,n=Object(ie.get)(e,"role_name",ky.role_name),i=Object(ie.get)(e,"role_description",Sy[n]),o=Object(ie.get)(e,"permissions",void 0);return Object.assign(Object.assign({},e),{role_description:i,permissions:Object(ie.isNil)(o)?(t=n,Cy[t]||[]):o})}var jy,Py,My,Iy,zy,Ty=function e(){y(this,e)},Uy=function e(){y(this,e)},Dy=function e(){y(this,e)},Ly=function(e){return e.DomainAlert="join_group_through_domain_alert",e.WelcomeTour="welcome_tour_alert",e.CompleteProfileAlert="complete_profile_alert",e}({}),Ey=((jy=function(){function e(t,n){y(this,e),this.http=t,this.storageService=n}return v(e,[{key:"getUserMessage",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=this.getCachedMessage(e);return i&&o?Object(br.a)(o):this.http.get("/ws/user/message?version=2&type=".concat(e,"&mode=").concat(n)).pipe(Object(se.a)((function(t){var n,i=t.message_seen_id,o=t.show_alert;switch(e){case Ly.DomainAlert:n=Object(ce.plainToClass)(ry,t.join_organization);break;case Ly.WelcomeTour:n=""+t.tour_version;break;case Ly.CompleteProfileAlert:var r=t||{},a=r.is_new_user,s=r.is_team_user;n=Object(ce.plainToClass)(Dy,{is_new_user:a,is_team_user:s})}return{messageSeenId:i,messageType:e,showUserAlert:o,messageData:n}})),Object(ei.a)((function(e){e.showUserAlert||t.addCachedMessage(e)})))}},{key:"setUserMessageViewed",value:function(e){return this.http.post("/ws/user/message",{version:2,message_seen_id:e})}},{key:"sendMessage",value:function(e){return this.http.post("/ws/user/message",e)}},{key:"getCachedMessage",value:function(e){return this.getCachedMessages().find((function(t){return t.messageType===e}))}},{key:"getCachedMessages",value:function(){return this.storageService.getSessionItem(is.UserMessagesSeen)||[]}},{key:"addCachedMessage",value:function(e){if(!this.getCachedMessage(e.messageType)){var t=this.getCachedMessages();this.storageService.setSessionItem(is.UserMessagesSeen,[].concat(p(t),[e]))}}}]),e}()).\u0275fac=function(e){return new(e||jy)(j.Zb(Q.b),j.Zb(as))},jy.\u0275prov=j.Lb({token:jy,factory:jy.\u0275fac,providedIn:"root"}),jy),Fy=r("nLfN"),Ay=function(e){return e.Web="web",e.Android="mobile_android",e.iOS="mobile_ios",e}({}),Ry=((Py=function(){function e(t){y(this,e),this.platform=t}return v(e,[{key:"productKey",get:function(){return T.productKey}},{key:"productType",get:function(){if(T.native){if(this.platform.ANDROID)return Ay.Android;if(this.platform.IOS)return Ay.iOS}return Ay.Web}}]),e}()).\u0275fac=function(e){return new(e||Py)(j.Zb(Fy.a))},Py.\u0275prov=j.Lb({token:Py,factory:Py.\u0275fac,providedIn:"root"}),Py),Vy=["harvard.edu","liberty.edu"],Ny=((My=function(){function e(t,n,i,o,r){y(this,e),this.http=t,this.reCaptchaV3Service=n,this.userMessageService=i,this.productService=o,this.RECAPTCHA_V3_SITE_KEY=r}return v(e,[{key:"loginWithBiodigital",value:function(e){return this.http.post("/ws/user/sign/in",gy.toJSON(e))}},{key:"loginWithGoogle",value:function(e){return this.http.post("/ws/user/sign/in/google",dy.toJSON(e))}},{key:"logout",value:function(){return this.http.get("/ws/user/sign/out")}},{key:"checkProfile",value:function(e){return this.http.post("/ws/user/profile/check",{version:2,email:e}).pipe(Object(se.a)((function(e){var t=cy.fromJSON(e);return t.isThirdParty=""!==t.thirdPartyProvider,t})))}},{key:"getUserProfile",value:function(e){return this.http.get(e?"/ws/user/profile?version=2&subscription_hard_check=1":"/ws/user/profile?version=2").pipe(Object(se.a)((function(e){var t=Object(ce.plainToClass)(sy,e);return t.organizations.forEach((function(e){var t=Object(ie.get)(e,"user_role",ky);e.user_role=_y(t)})),t})))}},{key:"getUserRoles",value:function(){return this.http.get("/ws/organization/user/roles").pipe(Object(se.a)((function(e){return e.user_roles.map((function(e){return _y(Object(ce.plainToClass)(by,e))}))})))}},{key:"updaterUserProfile",value:function(e){return this.http.post("/ws/user/profile?version=2",e)}},{key:"deleteUserProfile",value:function(){return this.http.post("/ws/user/profile/delete",{}).pipe(Object(se.a)((function(e){return e.deleted_user_email})))}},{key:"getEnvironmentSettings",value:function(){return this.http.get("/ws/environment/settings?version=2").pipe(Object(se.a)((function(e){return ly.fromJSON(e)})))}},{key:"getUserApps",value:function(){return this.http.get("/ws/developer/apps/profile").pipe(Object(se.a)((function(e){return e&&e.apps?JSON.parse(e.apps):[]})))}},{key:"getGroupConfigFromRoute",value:function(e){var t=e.queryParams.code||"",n=e.queryParams.group_invite||"",i=e.queryParams.osptok||"";return{group:e.queryParams.group||"",groupCode:t,groupCodeMode:t?1:0,groupInviteMode:n?1:0,groupInviteKey:n,groupOvidMode:i?1:0,groupOvidOsptok:i}}},{key:"getPlatformConfigFromRoute",value:function(e){var t=e.queryParams,n=t.zendesk_signin,i=t.return_to,o=t.brand_id,r=t.locale_id,a=t.timestamp;return"1"===n?{platform:fy.Zendesk,returnTo:i,brandId:o,localeId:r,timestamp:a}:void 0}},{key:"isLoggedIn",value:function(){return this.http.get("/ws/user/is/signed-in?version=4&app_producttype=".concat(this.productService.productType,"&app_productkey=").concat(this.productService.productKey))}},{key:"getProfileRestrictions",value:function(e){var t=!1,n=!1,i="";return e.organizations.forEach((function(e){t||n||(i=e.name,t=e.user_is_subscribed&&e.email_domain_restriction&&!e.user_has_email_domain_access,n=e.user_is_subscribed&&e.ip_address_restriction&&!e.user_has_domain_access)})),{organizationName:i,email:t,ip:n}}},{key:"resetPassword",value:function(e){return this.http.post("/ws/user/password/forgot",{email:e})}},{key:"deactivateFacebook",value:function(e){return this.http.post("/ws/user/sign/in/facebook/deactivate",e)}},{key:"updatePassword",value:function(e,t,n){return this.http.post("/ws/user/password/change",{current_password:e,new_password:t,confirm_new_password:n})}},{key:"signUp",value:function(e){return this.http.post("/ws/user/sign/up",uy.toJSON(e))}},{key:"verifyToken",value:function(e){return this.http.post("/ws/recaptcha/siteverify",{recaptcha_reponse_token:e,recaptcha_version:"v3"}).pipe(Object(se.a)((function(e){return e})))}},{key:"isHuman",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return n&&grecaptcha.reset(this.RECAPTCHA_V3_SITE_KEY),this.reCaptchaV3Service.execute(e).pipe(Object(vr.b)((function(e){return t.verifyToken(e)})),Object(se.a)((function(t){return{isHuman:t.action===e&&t.score>.2,verification:t}})))}},{key:"isReCaptchaWhiteListed",value:function(e){return Vy.some((function(t){return new RegExp(t+"$","i").test(e)}))}},{key:"requestVerificationCode",value:function(e){var t=Object.assign(Object.assign({},e),{version:4,app_producttype:this.productService.productType,app_productkey:this.productService.productKey});return this.http.post("/ws/user/verification/request",t).pipe(Object(se.a)((function(e){return Object(ce.plainToClass)(Ty,e)})))}},{key:"verifyProfile",value:function(e){var t=Object.assign(Object.assign({},e),{version:4,app_producttype:this.productService.productType,app_productkey:this.productService.productKey});return this.http.post("/ws/user/verification/confirm",t).pipe(Object(se.a)((function(e){return Object(ce.plainToClass)(Uy,e)})))}},{key:"checkProfileIncomplete",value:function(){return this.userMessageService.getUserMessage(Ly.CompleteProfileAlert,"v2",!1).pipe(Object(xr.a)((function(){return Object(br.a)({messageType:Ly.CompleteProfileAlert,messageData:{},showUserAlert:!1})})))}}]),e}()).\u0275fac=function(e){return new(e||My)(j.Zb(Q.b),j.Zb(hy.b),j.Zb(Ey),j.Zb(Ry),j.Zb(hy.a))},My.\u0275prov=j.Lb({token:My,factory:My.\u0275fac,providedIn:"root"}),My),By=function(){var e=function e(t){y(this,e),this.organizations=t};return e.type="[Organizations] Set Organizations",e}(),Hy=function(){var e=function e(t){y(this,e),this.organization=t};return e.type="[Organizations] Select Organization",e}(),Qy=function(){var e=function e(t){y(this,e),this.collection=t};return e.type="[Organizations] Select Collection",e}(),qy=function(){var e=function e(t){y(this,e),this.organizationId=t};return e.type="[Organizations] Get Collections",e}(),$y=function(){var e=function e(t){y(this,e),this.collections=t};return e.type="[Organizations] Get Collections Success",e}(),Wy=function(){var e=function e(t,n){y(this,e),this.organizationId=t,this.collectionName=n};return e.type="[Organizations] Add Collection",e}(),Ky=function(){var e=function e(t,n){y(this,e),this.organizationId=t,this.collectionName=n};return e.type="[Organizations] Add Collection Success",e}(),Gy=function(){var e=function e(t){y(this,e),this.error=t};return e.type="[Organizations] Add Collection Error",e}(),Zy=function(){var e=function e(t){y(this,e),this.collection=t};return e.type="[Organizations] Remove Collection",e}(),Jy=function(){var e=function e(t){y(this,e),this.collection=t};return e.type="[Organizations] Remove Collection Success",e}(),Xy=function(){var e=function e(t){y(this,e),this.error=t};return e.type="[Organizations] Remove Collection Error",e}(),Yy=function(){var e=function e(t){y(this,e),this.collection=t};return e.type="[Organizations] Set Collection Rename Mode",e}(),ex=function(){var e=function e(t,n){y(this,e),this.collection=t,this.collectionName=n};return e.type="[Organizations] Rename Collection",e}(),tx=function(){var e=function e(t,n){y(this,e),this.collection=t,this.collectionName=n};return e.type="[Organizations] Rename Collection Success",e}(),nx=function(){var e=function e(t){y(this,e),this.error=t};return e.type="[Organizations] Rename Collection Error",e}(),ix=function(){var e=function e(t,n){y(this,e),this.organizationId=t,this.collections=n};return e.type="[Organizations] Reorder Collections",e}(),ox=function(){var e=function e(t,n){y(this,e),this.organizationId=t,this.collections=n};return e.type="[Organizations] Reorder Collections Success",e}(),rx=function(){var e=function e(t){y(this,e),this.error=t};return e.type="[Organizations] Reorder Collections Error",e}(),ax=function(){var e=function e(){y(this,e)};return e.type="[Organizations] Reset",e}(),sx=function(){var e=function e(t){y(this,e),this.organization=t};return e.type="[Organizations] Create Organization",e}(),cx=function(){var e=function e(){y(this,e)};return e.type="[Organizations] Create Organization Success",e}(),lx=function(){var e=function e(t){y(this,e),this.error=t};return e.type="[Organizations] Create Organization Fail",e}(),px=function(){var e=function e(t){y(this,e),this.organization=t};return e.type="[Organizations] Update Organization",e}(),ux=function(){var e=function e(){y(this,e)};return e.type="[Organizations] Update Organization Success",e}(),dx=function(){var e=function e(t){y(this,e),this.error=t};return e.type="[Organizations] Update Organization Fail",e}(),gx=function(){var e=function e(t){y(this,e),this.request=t};return e.type="[Organizations] Get Organization Profile",e}(),hx=function(){var e=function e(t){y(this,e),this.organizationProfile=t};return e.type="[Organizations] Get Organization Profile Success",e}(),fx=function(){var e=function e(t){y(this,e),this.error=t};return e.type="[Organizations] Get Organization Profile Fail",e}(),bx=function(){var e=function e(){y(this,e)};return e.type="[Organizations] Clear Organization Profile",e}(),mx=function e(t,n,i){y(this,e),this.category=t,this.message=n,this.log=i},vx=((Iy=function(){function e(t){y(this,e),this.http=t,this.log={}}return v(e,[{key:"logError",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n="".concat(e.category).concat(e.message);return t&&this.log[n]?Object(br.a)():(this.log[n]=!0,this.http.post("/ws/human-error",e))}}]),e}()).\u0275fac=function(e){return new(e||Iy)(j.Zb(Q.b))},Iy.\u0275prov=j.Lb({token:Iy,factory:Iy.\u0275fac,providedIn:"root"}),Iy);!function(e){var t=function e(t){y(this,e),this.searchMode=t};t.type="[Gallery] Set Search Mode",e.SetSearchMode=t;var n=function e(t){y(this,e),this.viewMode=t};n.type="[Gallery] Set View Mode",e.SetViewMode=n;var i=function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];y(this,e),this.show=t,this.triggerDrawer=n};i.type="[Gallery] Show Filters",e.ShowFilters=i;var o=function e(t){y(this,e),this.organizationId=t};o.type="[Gallery] Get Studio Options",e.GetStudioOptions=o;var r=function e(t){y(this,e),this.options=t};r.type="[Gallery] Get Studio Options Success",e.GetStudioOptionsSuccess=r;var a=function e(t){y(this,e),this.config=t};a.type="[Gallery] Search Loft",e.SearchLoft=a;var s=function e(t){y(this,e),this.bookmarks=t};s.type="[Gallery] Search Loft Success",e.SearchLoftSuccess=s;var c=function e(t,n){y(this,e),this.config=t,this.options=n};c.type="[Gallery] Set Search Config",e.SetSearchConfig=c;var l=function e(t){y(this,e),this.options=t};l.type="[Gallery] Set Search Options",e.SetSearchOptions=l;var p=function e(t){y(this,e),this.activeTags=t};p.type="[Gallery] Set Active Tags",e.SetActiveTags=p;var u=function e(t){y(this,e),this.categoryId=t};u.type="[Gallery] Search Category",e.SearchCategory=u;var d=function e(){y(this,e)};d.type="[Gallery] Search Studio",e.SearchStudio=d;var g=function e(t){y(this,e),this.bookmarks=t};g.type="[Gallery] Search Studio Success",e.SearchStudioSuccess=g;var h=function e(t){y(this,e),this.bookmarks=t};h.type="[Gallery] Search Success",e.SearchSuccess=h;var f=function e(t){y(this,e),this.result=t};f.type="[Gallery] Select Bookmark",e.SelectBookmark=f;var b=function e(t){y(this,e),this.sidenav=t};b.type="[Gallery] Set Sidenav",e.SetSidenav=b;var m=function e(t){y(this,e),this.bulkActions=t};m.type="[Gallery] Set Bulk Actions",e.SetBulkActions=m;var v=function e(t){y(this,e),this.cardActions=t};v.type="[Gallery] Set Card Actions",e.SetCardActions=v;var x=function e(){y(this,e)};x.type="[Gallery] Clear Results",e.ClearResults=x;var O=function e(t,n){y(this,e),this.id=t,this.checked=n};O.type="[Gallery] Check Item",e.CheckItem=O;var w=function e(){y(this,e)};w.type="[Gallery] Check All",e.CheckAll=w;var k=function e(){y(this,e)};k.type="[Gallery] Uncheck All",e.UncheckAll=k;var C=function e(t){y(this,e),this.ids=t};C.type="[Gallery] Set Checked Items",e.SetCheckedItems=C;var S=function e(){y(this,e)};S.type="[Gallery] Reset",e.Reset=S}(zy||(zy={}));var yx,xx,Ox=function(e){return e.Web="web",e.Mobile="mobilesdk",e}({}),wx=function(){var e=function e(){y(this,e)};return e.type="[Subscription] Reset Subscription State",e}(),kx={"Sign in":"3971305","Sign up":"3971297"},Cx=((yx=function(){function e(t){y(this,e),this.config=t,this.initialized=!1}return v(e,[{key:"initialize",value:function(){if(this.config.enabled&&!this.initialized){var e='\n      _linkedin_partner_id = "'.concat(this.config.linkedinId,'"; \n      window._linkedin_data_partner_ids = window._linkedin_data_partner_ids || []; \n      window._linkedin_data_partner_ids.push(_linkedin_partner_id);\n      (function(){var s = document.getElementsByTagName("script")[0]; var b = document.createElement("script"); b.type = "text/javascript";b.async = true; b.src = "https://snap.licdn.com/li.lms-analytics/insight.min.js"; s.parentNode.insertBefore(b, s);})();\n    '),t=document.createElement("script");t.textContent=e,document.body.appendChild(t),this.initialized=!0}}},{key:"track",value:function(e){var t=kx[e];if(t){var n=document.createElement("img");n.height=1,n.width=1,n.style.display="none",n.alt="",n.src="https://px.ads.linkedin.com/collect/?pid=".concat(this.config.linkedinId,"&conversionId=").concat(t,"&fmt=gif"),document.body.appendChild(n)}}}]),e}()).\u0275fac=function(e){return new(e||yx)(j.Zb("linkedinConfig"))},yx.\u0275prov=j.Lb({token:yx,factory:yx.\u0275fac,providedIn:"root"}),yx),Sx=function(e){return e.Free="free",e.Premium="premium",e.Team="team",e}({}),_x=((xx=function(){function e(t,n){y(this,e),this.http=t,this.productService=n}return v(e,[{key:"trackContentPublish",value:function(e,t){return this.http.post("/ws/user/analytics/content/inapp/publish",{version:4,app_producttype:this.productService.productType,app_productkey:this.productService.productKey,content_type:t,content_id:e})}},{key:"trackContentView",value:function(e,t){return this.http.post("/ws/user/analytics/content/inapp/view",{version:4,app_producttype:this.productService.productType,app_productkey:this.productService.productKey,content_type:t,content_id:e})}},{key:"checkContentView",value:function(){return this.http.get("/ws/user/content/inapp/view/check")}}]),e}()).\u0275fac=function(e){return new(e||xx)(j.Zb(Q.b),j.Zb(Ry))},xx.\u0275prov=j.Lb({token:xx,factory:xx.\u0275fac,providedIn:"root"}),xx);function jx(e,t){return Object(ie.get)(e,"permissions",[]).includes(t)}function Px(e){return Array.isArray(e.group_access)&&e.group_access.length>0}var Mx,Ix,zx,Tx=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},Ux=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Dx=T.application===P.Studio,Lx={loading:!1,requestingCode:!1,profileStatus:"ready",auth2:null,googleAuthStatus:"waiting",loggedIn:null,userLocale:null,userRoles:[],contentViews:{limit_reached:!1,inapp_view_limit:0,inapp_view_count:0},developerReferral:!1},Ex=((Ix=Mx=function(){function e(t,n,i,o,r,a,s,c){y(this,e),this.authService=t,this.userMessageService=n,this.storageService=i,this.errorLoggingService=o,this.linkedinInsights=r,this.pendoService=a,this.contentViewService=s,this.productService=c}return v(e,[{key:"initializeGoogleOAuth",value:function(e){e.dispatch(new Km("loading")),gapi.load("auth2",{callback:function(){var t=gapi.auth2.init({client_id:T.googleAuthKey,scope:"profile"});e.patchState({auth2:t}),t.then((function(){e.dispatch(new Km("ready"))}),(function(){e.dispatch(new Km("error"))}))},onerror:function(){e.dispatch(new Km("error"))},timeout:5e3,ontimeout:function(){e.dispatch(new Km("error"))}})}},{key:"setGoogleAuthOnline",value:function(e,t){e.patchState({googleAuthStatus:t.online})}},{key:"isLoggedIn",value:function(e,t){e.patchState({loading:!0}),this.authService.isLoggedIn().pipe(Object(Ss.a)((function(){return e.patchState({loading:!1})}))).subscribe((function(t){e.dispatch(t.signed_in?new Qm:new qm)}))}},{key:"isLoggedInSuccess",value:function(e,t){e.patchState({loggedIn:!0})}},{key:"isLoggedInFailure",value:function(e,t){e.patchState({loggedIn:!1})}},{key:"login",value:function(e,t){var n=this;e.patchState({loading:!0}),this.verify("studio_login",t.login.email,e).pipe(Object(vr.b)((function(e){return n.authService.loginWithBiodigital(Object.assign(Object.assign({},t.login),e?{site_verify_response:e}:null))})),Object(Ss.a)((function(){return e.patchState({loading:!1})}))).subscribe((function(t){e.dispatch(new Zm("biodigital",t))}),(function(i){n.logFailure("LOGIN_FAILURE",i),e.dispatch(new Jm("biodigital",i,t.login))}))}},{key:"loginWithGoogle",value:function(e,t){var n=this;e.patchState({loading:!0}),this.authService.loginWithGoogle(t.login).pipe(Object(Ss.a)((function(){return e.patchState({loading:!1})}))).subscribe((function(t){e.dispatch(new Zm("google",t))}),(function(i){1!==t.login.groupCodeMode&&1!==t.login.groupInviteMode||n.logFailure("GOOGLE_SIGNUP_FAILURE",i),e.dispatch(new Jm("google",i,t.login))}))}},{key:"loginSuccess",value:function(e,t){Dx&&(this.linkedinInsights.track("Sign in"),"google"===t.loginType&&"signup"===t.response.authentication_type?this.pendoService.trackSignUp(t.loginType):this.pendoService.trackSignIn(t.loginType)),e.dispatch(new Hm),e.dispatch(new Tv)}},{key:"loginFailure",value:function(e,t){var n;Dx&&this.pendoService.track("Sign In - Failure",{type:t.loginType,error:Object(ie.get)(t,"error.error.error.message")||"There was an error logging in.",statusCode:null===(n=t.error)||void 0===n?void 0:n.status})}},{key:"logout",value:function(e,t){e.patchState({loading:!0}),this.authService.logout().pipe(Object(Ss.a)((function(){return e.patchState({loading:!1})}))).subscribe((function(){return e.dispatch(new Ym)}),(function(){return e.dispatch(new ev)}))}},{key:"logoutSuccess",value:function(e,t){e.setState(Lx),e.dispatch(new Wv),e.dispatch(new wx),e.dispatch(new jl),e.dispatch(new vd),e.dispatch(new Gt),e.dispatch(new ca),e.dispatch(new rp.ResetLayout),e.dispatch(new ax),e.dispatch(new at),e.dispatch(new Mi),e.dispatch(new zy.Reset),this.storageService.clearSessionStorage()}},{key:"checkProfile",value:function(e,t){return e.patchState({loading:!0}),this.authService.checkProfile(t.email).pipe(Object(Ss.a)((function(){return e.patchState({loading:!1})}))).subscribe((function(t){e.dispatch(new hv(t))}),(function(t){e.dispatch(new fv(t))}))}},{key:"checkProfileSuccess",value:function(e,t){e.patchState({profileCheck:t.profile})}},{key:"getUserProfile",value:function(e,t){var n=t.hardCheck;return e.patchState({loading:!0}),this.authService.getUserProfile(n).pipe(Object(Ss.a)((function(){return e.patchState({loading:!1})}))).subscribe((function(t){e.dispatch(new rv(t))}),(function(t){e.dispatch(new av(t))}))}},{key:"getUserProfileSuccess",value:function(e,t){e.patchState({userProfile:t.userProfile}),e.dispatch(new By(t.userProfile.organizations)),e.dispatch(new Uv),e.dispatch(new Tv)}},{key:"updateUserProfile",value:function(e,t){var n=t.userProfile;e.patchState({profileStatus:"updating"}),this.authService.updaterUserProfile(n).pipe(Object(Ss.a)((function(){return e.patchState({profileStatus:"ready"})}))).subscribe((function(){e.dispatch(new cv(n))}),(function(t){e.dispatch(new lv(t))}))}},{key:"updateUserProfileSuccess",value:function(e,t){var n=t.userProfile;this.pendoService.updateVisitorData(n)}},{key:"deleteUserProfile",value:function(e,t){e.patchState({profileStatus:"deleting"}),this.authService.deleteUserProfile().pipe(Object(Ss.a)((function(){return e.patchState({profileStatus:"ready"})}))).subscribe((function(t){e.dispatch(new uv(t))}),(function(t){e.dispatch(new dv(t))}))}},{key:"getUserRoles",value:function(e,t){this.authService.getUserRoles().subscribe((function(t){e.patchState({userRoles:t})}))}},{key:"getUserApps",value:function(e,t){this.authService.getUserApps().subscribe((function(t){e.dispatch(new Dv(t)),e.dispatch(new Lv)}),(function(e){}))}},{key:"setUserApps",value:function(e,t){var n=t.apps;e.patchState({userApps:n})}},{key:"setSelectedUserApp",value:function(e,t){var n=t.appId;e.patchState({selectedAppId:n}),null!==n?this.storageService.setLocalItem(ns.UserAppId,n):this.storageService.removeLocalItem(ns.UserAppId)}},{key:"checkSelectedUserApp",value:function(e,t){var n=e.getState().userApps,i=this.storageService.getLocalItem(ns.UserAppId);if(i){var o=parseInt(i,10);e.dispatch(new Ev(o))}else if(n&&n.length){var r=n.find((function(e){return e.app_platform.some((function(e){return e.type===Ox.Web}))}));e.dispatch(new Ev(r?r.id:void 0))}}},{key:"checkSession",value:function(e,t){e.patchState({loading:!0}),this.authService.isLoggedIn().pipe(Object(Ss.a)((function(){return e.patchState({loading:!1})}))).subscribe((function(t){t.signed_in?(e.dispatch(new Qm),e.dispatch(new ov),e.dispatch(new bv)):e.dispatch(new qm)}))}},{key:"getEnvironmentSettings",value:function(e,t){return e.patchState({loading:!0}),this.authService.getEnvironmentSettings().pipe(Object(Ss.a)((function(){return e.patchState({loading:!1})}))).subscribe((function(t){e.dispatch(new nv(t))}),(function(t){e.dispatch(new iv(t))}))}},{key:"GetEnvironmentSettingsSuccess",value:function(e,t){e.patchState({environmentSettings:t.environmentSettings})}},{key:"resetPassword",value:function(e,t){e.patchState({loading:!0}),this.authService.resetPassword(t.email).pipe(Object(Ss.a)((function(){return e.patchState({loading:!1})}))).subscribe((function(){e.dispatch(new vv(t.email))}),(function(t){e.dispatch(new yv(t))}))}},{key:"transferFacebookAccount",value:function(e,t){var n=this;e.patchState({loading:!0}),this.verify("deactivate_facebook",t.email,e).pipe(Object(vr.b)((function(e){return n.authService.deactivateFacebook(Object.assign(Object.assign({version:4,app_productkey:n.productService.productKey,app_producttype:n.productService.productType},e?{site_verify_response:e}:null),{user_email:t.email}))})),Object(Ss.a)((function(){return e.patchState({loading:!1})}))).subscribe((function(n){console.log(n),e.dispatch(n.conversion_complete&&n.reset_password_email_sent?new Ov(t.email):new wv(new Error("Facebook deactivation failed")))}),(function(t){e.dispatch(new wv(t))}))}},{key:"updatePassword",value:function(e,t){var n=t.currentPassword,i=t.newPassword,o=t.confirmNewPassword;this.authService.updatePassword(n,i,o).subscribe((function(){e.dispatch(new Cv)}),(function(t){e.dispatch(new Sv(t))}))}},{key:"signUp",value:function(e,t){var n=this;e.patchState({loading:!0}),this.verify("studio_signup",t.value.email,e).pipe(Object(vr.b)((function(e){return n.authService.signUp(Object.assign(Object.assign({},t.value),e?{site_verify_response:e}:null))})),Object(Ss.a)((function(){return e.patchState({loading:!1})}))).subscribe((function(t){e.dispatch(new Pv(t))}),(function(t){e.dispatch(new Mv(t))}))}},{key:"signUpSuccess",value:function(e,t){Dx&&this.pendoService.trackSignUp("biodigital")}},{key:"signUpFailure",value:function(e,t){var n;Dx&&this.pendoService.track("Sign Up - Failure",{error:Object(ie.get)(t,"error.error.error.message")||"There was an error signing up.",statusCode:null===(n=t.error)||void 0===n?void 0:n.status}),this.logFailure("BIODIGITAL_SIGNUP_FAILURE",t)}},{key:"setUserLocale",value:function(e,t){var n=t.locale;this.storageService.setLocalItem(ns.Locale,n.id),e.patchState({userLocale:n}),e.dispatch(new zv(n))}},{key:"checkLocale",value:function(e,t){var n=Ae(),i=Fe.find((function(e){return e.id===n}))||Ee;e.dispatch(new Iv(i))}},{key:"sendUserMessage",value:function(e,t){var n=t.message;this.userMessageService.sendMessage(n).subscribe((function(){e.dispatch(new Av(n))}),(function(t){e.dispatch(new Rv(t))}))}},{key:"getUserMessage",value:function(e,t){var n=t.type,i=t.mode;this.userMessageService.getUserMessage(n,i).subscribe((function(t){e.dispatch(new Nv(t))}),(function(){e.dispatch(new Bv(n))}))}},{key:"setUserMessageViewed",value:function(e,t){var n=t.messageSeenId;this.userMessageService.setUserMessageViewed(n).subscribe((function(){return e.dispatch(new Qv)}),(function(){return e.dispatch(new qv)}))}},{key:"resetAuth",value:function(e,t){e.setState(Lx),e.dispatch(new Wm)}},{key:"requestVerificationCode",value:function(e,t){var n=t.email,i=t.token;e.patchState({requestingCode:!0}),this.authService.requestVerificationCode({user_email:n,verification_jwt:i}).pipe(Object(Ss.a)((function(){return e.patchState({requestingCode:!1})}))).subscribe((function(t){e.dispatch(new Gv(t))}),(function(t){e.dispatch(new Zv(t))}))}},{key:"verifyProfile",value:function(e,t){var n=t.email,i=t.token,o=t.code.toUpperCase();e.patchState({profileStatus:"verifying"}),this.authService.verifyProfile({user_email:n,verification_code:o,verification_jwt:i}).pipe(Object(Ss.a)((function(){return e.patchState({profileStatus:"ready"})}))).subscribe((function(t){e.dispatch(new Xv(t)),e.dispatch(new _v)}),(function(t){e.dispatch(new Yv(t))}))}},{key:"verifyProfileSuccess",value:function(e){this.pendoService.track("Email Verify - Success",{platform:this.productService.productType})}},{key:"verifyProfileFail",value:function(e,t){var n;this.pendoService.track("Email Verify - Failure",{error:Object(ie.get)(t,"error.error.error.message")||"There was an error with email verification.",statusCode:null===(n=t.error)||void 0===n?void 0:n.status})}},{key:"setContentView",value:function(e,t){var n=t.contentId,i=t.contentType;this.contentViewService.trackContentView(n,i).subscribe((function(){e.dispatch(new ty),e.dispatch(new ny)}))}},{key:"checkContentViews",value:function(e,t){this.contentViewService.checkContentView().subscribe((function(t){e.patchState({contentViews:t}),e.dispatch(new iy(t))}))}},{key:"setDeveloperReferral",value:function(e,t){e.patchState({developerReferral:t.isDeveloperReferral})}},{key:"logFailure",value:function(e,t){var n=Object(ie.get)(t,"message")||"",i=Object(ie.get)(t,"error.error.message")||"";this.errorLoggingService.logError(new mx(e,n,i)).subscribe()}},{key:"verify",value:function(e,t,n){return this.authService.isReCaptchaWhiteListed(t)?Object(br.a)(null):this.authService.isHuman(e).pipe(Object(ei.a)((function(e){e.isHuman||n.dispatch(new $v)})),Object(Y.a)((function(e){return e.isHuman})),Object(se.a)((function(e){return e.verification})))}},{key:"ngxsOnInit",value:function(e){e.dispatch(new _v),e.dispatch(new Tv),e.dispatch(new Lv),e.dispatch(new Wm)}}],[{key:"getLoggedIn",value:function(e){return e.loggedIn}},{key:"getEnvironmentSettings",value:function(e){return e.environmentSettings}},{key:"getUserProfile",value:function(e){return e.userProfile}},{key:"getUserRole",value:function(e){if(!Object(ie.isNil)(e.userProfile))return Object(ie.get)(e,"userProfile.organizations[0].user_role",ky)}},{key:"getUserRoles",value:function(e){return e.userRoles}},{key:"getUserType",value:function(e){if(!Object(ie.isNil)(e.userProfile)){var t=e.userProfile,n=t.premium_account,i=t.premium_account_type;if(n)return"group"===i?Sx.Team:Sx.Premium}return Sx.Free}},{key:"canInviteUsers",value:function(e){if(!Object(ie.isNil)(e.userProfile)){var t=Mx.getUserType(e);return jx(Mx.getUserRole(e),my.InviteUsers)&&t===Sx.Team}return!1}},{key:"getUserAccountSettings",value:function(e){return Object(ie.get)(e,"userProfile.account_settings",[])}},{key:"getAuth2",value:function(e){return e.auth2}},{key:"getGoogleAuthOnline",value:function(e){return e.googleAuthStatus}},{key:"getProfileCheck",value:function(e){return e.profileCheck}},{key:"getLoading",value:function(e){return e.loading}},{key:"getVerifyingProfile",value:function(e){return"verifying"===e.profileStatus}},{key:"getProfileUpdating",value:function(e){return"updating"===e.profileStatus}},{key:"getProfileDeleting",value:function(e){return"deleting"===e.profileStatus}},{key:"getUserLocale",value:function(e){return e.userLocale}},{key:"getUserLanguage",value:function(e){return Object(ie.get)(e,"userLocale.lang",Ee.lang)}},{key:"getUserApps",value:function(e){return Object(ie.get)(e,"userApps",[])}},{key:"getSelectedUserApp",value:function(e){return(e.userApps||[]).find((function(t){return t.id===e.selectedAppId}))}},{key:"getUserFullName",value:function(e){var t,n;if(Object(ie.isNil)(e.userProfile))return null;var i=null!==(t=e.userProfile.first_name)&&void 0!==t?t:"",o=null!==(n=e.userProfile.last_name)&&void 0!==n?n:"";return Object(ie.trim)([i,o].join(" "))}},{key:"getUserEmail",value:function(e){return Object(ie.isNil)(e.userProfile)?null:e.userProfile.email}},{key:"isPrivateUser",value:function(e){return!Object(ie.isNil)(e.userProfile)&&0===Object(ie.get)(e,"userProfile.organizations",[]).length}},{key:"isPremiumUser",value:function(e){return!0===Object(ie.get)(e,"userProfile.premium_account_valid")}},{key:"isAdmin",value:function(e){var t=this.getUserRole(e);return!!t&&t.role_name===vy.Admin}},{key:"isDeveloperReferral",value:function(e){return e.developerReferral}},{key:"getContentViews",value:function(e){return e.contentViews}},{key:"getContentViewsReached",value:function(e){return!Mx.isPremiumUser(e)&&e.contentViews.limit_reached}}]),e}()).\u0275fac=function(e){return new(e||Ix)(j.Zb(Ny),j.Zb(Ey),j.Zb(as),j.Zb(vx),j.Zb(Cx),j.Zb(Oe),j.Zb(_x),j.Zb(Ry))},Ix.\u0275prov=j.Lb({token:Ix,factory:Ix.\u0275fac}),Tx([Object(L.a)(Wm),Ux("design:type",Function),Ux("design:paramtypes",[Object]),Ux("design:returntype",void 0)],Ix.prototype,"initializeGoogleOAuth",null),Tx([Object(L.a)(Km),Ux("design:type",Function),Ux("design:paramtypes",[Object,Km]),Ux("design:returntype",void 0)],Ix.prototype,"setGoogleAuthOnline",null),Tx([Object(L.a)(Hm),Ux("design:type",Function),Ux("design:paramtypes",[Object,Hm]),Ux("design:returntype",void 0)],Ix.prototype,"isLoggedIn",null),Tx([Object(L.a)(Qm),Ux("design:type",Function),Ux("design:paramtypes",[Object,Qm]),Ux("design:returntype",void 0)],Ix.prototype,"isLoggedInSuccess",null),Tx([Object(L.a)(qm),Ux("design:type",Function),Ux("design:paramtypes",[Object,qm]),Ux("design:returntype",void 0)],Ix.prototype,"isLoggedInFailure",null),Tx([Object(L.a)($m),Ux("design:type",Function),Ux("design:paramtypes",[Object,$m]),Ux("design:returntype",void 0)],Ix.prototype,"login",null),Tx([Object(L.a)(Gm),Ux("design:type",Function),Ux("design:paramtypes",[Object,Gm]),Ux("design:returntype",void 0)],Ix.prototype,"loginWithGoogle",null),Tx([Object(L.a)(Zm),Ux("design:type",Function),Ux("design:paramtypes",[Object,Zm]),Ux("design:returntype",void 0)],Ix.prototype,"loginSuccess",null),Tx([Object(L.a)(Jm),Ux("design:type",Function),Ux("design:paramtypes",[Object,Jm]),Ux("design:returntype",void 0)],Ix.prototype,"loginFailure",null),Tx([Object(L.a)(Xm),Ux("design:type",Function),Ux("design:paramtypes",[Object,Xm]),Ux("design:returntype",void 0)],Ix.prototype,"logout",null),Tx([Object(L.a)(Ym),Ux("design:type",Function),Ux("design:paramtypes",[Object,Ym]),Ux("design:returntype",void 0)],Ix.prototype,"logoutSuccess",null),Tx([Object(L.a)(gv),Ux("design:type",Function),Ux("design:paramtypes",[Object,gv]),Ux("design:returntype",void 0)],Ix.prototype,"checkProfile",null),Tx([Object(L.a)(hv),Ux("design:type",Function),Ux("design:paramtypes",[Object,hv]),Ux("design:returntype",void 0)],Ix.prototype,"checkProfileSuccess",null),Tx([Object(L.a)(ov),Ux("design:type",Function),Ux("design:paramtypes",[Object,ov]),Ux("design:returntype",void 0)],Ix.prototype,"getUserProfile",null),Tx([Object(L.a)(rv),Ux("design:type",Function),Ux("design:paramtypes",[Object,rv]),Ux("design:returntype",void 0)],Ix.prototype,"getUserProfileSuccess",null),Tx([Object(L.a)(sv),Ux("design:type",Function),Ux("design:paramtypes",[Object,sv]),Ux("design:returntype",void 0)],Ix.prototype,"updateUserProfile",null),Tx([Object(L.a)(cv),Ux("design:type",Function),Ux("design:paramtypes",[Object,sv]),Ux("design:returntype",void 0)],Ix.prototype,"updateUserProfileSuccess",null),Tx([Object(L.a)(pv),Ux("design:type",Function),Ux("design:paramtypes",[Object,pv]),Ux("design:returntype",void 0)],Ix.prototype,"deleteUserProfile",null),Tx([Object(L.a)(bv),Ux("design:type",Function),Ux("design:paramtypes",[Object,bv]),Ux("design:returntype",void 0)],Ix.prototype,"getUserRoles",null),Tx([Object(L.a)(Uv),Ux("design:type",Function),Ux("design:paramtypes",[Object,Uv]),Ux("design:returntype",void 0)],Ix.prototype,"getUserApps",null),Tx([Object(L.a)(Dv),Ux("design:type",Function),Ux("design:paramtypes",[Object,Dv]),Ux("design:returntype",void 0)],Ix.prototype,"setUserApps",null),Tx([Object(L.a)(Ev),Ux("design:type",Function),Ux("design:paramtypes",[Object,Ev]),Ux("design:returntype",void 0)],Ix.prototype,"setSelectedUserApp",null),Tx([Object(L.a)(Lv),Ux("design:type",Function),Ux("design:paramtypes",[Object,Lv]),Ux("design:returntype",void 0)],Ix.prototype,"checkSelectedUserApp",null),Tx([Object(L.a)(_v),Ux("design:type",Function),Ux("design:paramtypes",[Object,_v]),Ux("design:returntype",void 0)],Ix.prototype,"checkSession",null),Tx([Object(L.a)(tv),Ux("design:type",Function),Ux("design:paramtypes",[Object,tv]),Ux("design:returntype",void 0)],Ix.prototype,"getEnvironmentSettings",null),Tx([Object(L.a)(nv),Ux("design:type",Function),Ux("design:paramtypes",[Object,nv]),Ux("design:returntype",void 0)],Ix.prototype,"GetEnvironmentSettingsSuccess",null),Tx([Object(L.a)(mv),Ux("design:type",Function),Ux("design:paramtypes",[Object,mv]),Ux("design:returntype",void 0)],Ix.prototype,"resetPassword",null),Tx([Object(L.a)(xv),Ux("design:type",Function),Ux("design:paramtypes",[Object,xv]),Ux("design:returntype",void 0)],Ix.prototype,"transferFacebookAccount",null),Tx([Object(L.a)(kv),Ux("design:type",Function),Ux("design:paramtypes",[Object,kv]),Ux("design:returntype",void 0)],Ix.prototype,"updatePassword",null),Tx([Object(L.a)(jv),Ux("design:type",Function),Ux("design:paramtypes",[Object,jv]),Ux("design:returntype",void 0)],Ix.prototype,"signUp",null),Tx([Object(L.a)(Pv),Ux("design:type",Function),Ux("design:paramtypes",[Object,Pv]),Ux("design:returntype",void 0)],Ix.prototype,"signUpSuccess",null),Tx([Object(L.a)(Mv),Ux("design:type",Function),Ux("design:paramtypes",[Object,Mv]),Ux("design:returntype",void 0)],Ix.prototype,"signUpFailure",null),Tx([Object(L.a)(Iv),Ux("design:type",Function),Ux("design:paramtypes",[Object,Iv]),Ux("design:returntype",void 0)],Ix.prototype,"setUserLocale",null),Tx([Object(L.a)(Tv),Ux("design:type",Function),Ux("design:paramtypes",[Object,Tv]),Ux("design:returntype",void 0)],Ix.prototype,"checkLocale",null),Tx([Object(L.a)(Fv),Ux("design:type",Function),Ux("design:paramtypes",[Object,Fv]),Ux("design:returntype",void 0)],Ix.prototype,"sendUserMessage",null),Tx([Object(L.a)(Vv),Ux("design:type",Function),Ux("design:paramtypes",[Object,Vv]),Ux("design:returntype",void 0)],Ix.prototype,"getUserMessage",null),Tx([Object(L.a)(Hv),Ux("design:type",Function),Ux("design:paramtypes",[Object,Hv]),Ux("design:returntype",void 0)],Ix.prototype,"setUserMessageViewed",null),Tx([Object(L.a)(Wv),Ux("design:type",Function),Ux("design:paramtypes",[Object,Wv]),Ux("design:returntype",void 0)],Ix.prototype,"resetAuth",null),Tx([Object(L.a)(Kv),Ux("design:type",Function),Ux("design:paramtypes",[Object,Kv]),Ux("design:returntype",void 0)],Ix.prototype,"requestVerificationCode",null),Tx([Object(L.a)(Jv),Ux("design:type",Function),Ux("design:paramtypes",[Object,Jv]),Ux("design:returntype",void 0)],Ix.prototype,"verifyProfile",null),Tx([Object(L.a)(Xv),Ux("design:type",Function),Ux("design:paramtypes",[Object]),Ux("design:returntype",void 0)],Ix.prototype,"verifyProfileSuccess",null),Tx([Object(L.a)(Yv),Ux("design:type",Function),Ux("design:paramtypes",[Object,Yv]),Ux("design:returntype",void 0)],Ix.prototype,"verifyProfileFail",null),Tx([Object(L.a)(ey),Ux("design:type",Function),Ux("design:paramtypes",[Object,ey]),Ux("design:returntype",void 0)],Ix.prototype,"setContentView",null),Tx([Object(L.a)(ny),Ux("design:type",Function),Ux("design:paramtypes",[Object,ny]),Ux("design:returntype",void 0)],Ix.prototype,"checkContentViews",null),Tx([Object(L.a)(oy),Ux("design:type",Function),Ux("design:paramtypes",[Object,oy]),Ux("design:returntype",void 0)],Ix.prototype,"setDeveloperReferral",null),Tx([Object(L.e)(),Ux("design:type",Function),Ux("design:paramtypes",[Bm]),Ux("design:returntype",void 0)],Ix,"getLoggedIn",null),Tx([Object(L.e)(),Ux("design:type",Function),Ux("design:paramtypes",[Bm]),Ux("design:returntype",void 0)],Ix,"getEnvironmentSettings",null),Tx([Object(L.e)(),Ux("design:type",Function),Ux("design:paramtypes",[Bm]),Ux("design:returntype",void 0)],Ix,"getUserProfile",null),Tx([Object(L.e)(),Ux("design:type",Function),Ux("design:paramtypes",[Bm]),Ux("design:returntype",by)],Ix,"getUserRole",null),Tx([Object(L.e)(),Ux("design:type",Function),Ux("design:paramtypes",[Bm]),Ux("design:returntype",Array)],Ix,"getUserRoles",null),Tx([Object(L.e)(),Ux("design:type",Function),Ux("design:paramtypes",[Bm]),Ux("design:returntype",String)],Ix,"getUserType",null),Tx([Object(L.e)(),Ux("design:type",Function),Ux("design:paramtypes",[Bm]),Ux("design:returntype",Boolean)],Ix,"canInviteUsers",null),Tx([Object(L.e)(),Ux("design:type",Function),Ux("design:paramtypes",[Bm]),Ux("design:returntype",Array)],Ix,"getUserAccountSettings",null),Tx([Object(L.e)(),Ux("design:type",Function),Ux("design:paramtypes",[Bm]),Ux("design:returntype",Object)],Ix,"getAuth2",null),Tx([Object(L.e)(),Ux("design:type",Function),Ux("design:paramtypes",[Bm]),Ux("design:returntype",String)],Ix,"getGoogleAuthOnline",null),Tx([Object(L.e)(),Ux("design:type",Function),Ux("design:paramtypes",[Bm]),Ux("design:returntype",void 0)],Ix,"getProfileCheck",null),Tx([Object(L.e)(),Ux("design:type",Function),Ux("design:paramtypes",[Bm]),Ux("design:returntype",void 0)],Ix,"getLoading",null),Tx([Object(L.e)(),Ux("design:type",Function),Ux("design:paramtypes",[Bm]),Ux("design:returntype",void 0)],Ix,"getVerifyingProfile",null),Tx([Object(L.e)(),Ux("design:type",Function),Ux("design:paramtypes",[Bm]),Ux("design:returntype",void 0)],Ix,"getProfileUpdating",null),Tx([Object(L.e)(),Ux("design:type",Function),Ux("design:paramtypes",[Bm]),Ux("design:returntype",void 0)],Ix,"getProfileDeleting",null),Tx([Object(L.e)(),Ux("design:type",Function),Ux("design:paramtypes",[Bm]),Ux("design:returntype",void 0)],Ix,"getUserLocale",null),Tx([Object(L.e)(),Ux("design:type",Function),Ux("design:paramtypes",[Bm]),Ux("design:returntype",String)],Ix,"getUserLanguage",null),Tx([Object(L.e)(),Ux("design:type",Function),Ux("design:paramtypes",[Bm]),Ux("design:returntype",void 0)],Ix,"getUserApps",null),Tx([Object(L.e)(),Ux("design:type",Function),Ux("design:paramtypes",[Bm]),Ux("design:returntype",void 0)],Ix,"getSelectedUserApp",null),Tx([Object(L.e)(),Ux("design:type",Function),Ux("design:paramtypes",[Bm]),Ux("design:returntype",void 0)],Ix,"getUserFullName",null),Tx([Object(L.e)(),Ux("design:type",Function),Ux("design:paramtypes",[Bm]),Ux("design:returntype",void 0)],Ix,"getUserEmail",null),Tx([Object(L.e)(),Ux("design:type",Function),Ux("design:paramtypes",[Bm]),Ux("design:returntype",void 0)],Ix,"isPrivateUser",null),Tx([Object(L.e)(),Ux("design:type",Function),Ux("design:paramtypes",[Bm]),Ux("design:returntype",void 0)],Ix,"isPremiumUser",null),Tx([Object(L.e)(),Ux("design:type",Function),Ux("design:paramtypes",[Bm]),Ux("design:returntype",void 0)],Ix,"isAdmin",null),Tx([Object(L.e)(),Ux("design:type",Function),Ux("design:paramtypes",[Bm]),Ux("design:returntype",void 0)],Ix,"isDeveloperReferral",null),Tx([Object(L.e)(),Ux("design:type",Function),Ux("design:paramtypes",[Bm]),Ux("design:returntype",void 0)],Ix,"getContentViews",null),Tx([Object(L.e)(),Ux("design:type",Function),Ux("design:paramtypes",[Bm]),Ux("design:returntype",void 0)],Ix,"getContentViewsReached",null),Ix=Mx=Tx([Object(L.f)({name:"auth",defaults:Lx})],Ix)),Fx=["progressCircle"],Ax=((zx=function(){function e(t,n){y(this,e),this.renderer=t,this.changeRef=n,this._size="medium",this._progress=0,this.strokeWidth=8,this.diameter=120}return v(e,[{key:"size",get:function(){return this._size},set:function(e){this._size=e,this.updateCircle()}},{key:"progress",get:function(){return this._progress},set:function(e){this._progress=e,this.updateCircle()}},{key:"ngOnInit",value:function(){}},{key:"ngAfterViewInit",value:function(){this.updateCircle()}},{key:"updateCircle",value:function(){switch(this.size){case"small":this.strokeWidth=4,this.diameter=60;break;case"medium":this.strokeWidth=8,this.diameter=120;break;case"large":this.strokeWidth=16,this.diameter=240}if(this.progressCircleRef){var e=2*this.progressCircleRef.nativeElement.r.baseVal.value*Math.PI,t=e-this.progress/100*e;this.renderer.setStyle(this.progressCircleRef.nativeElement,"strokeDasharray","".concat(e," ").concat(e)),this.renderer.setStyle(this.progressCircleRef.nativeElement,"strokeDashoffset",""+t)}this.changeRef.markForCheck()}}]),e}()).\u0275fac=function(e){return new(e||zx)(j.Pb(j.H),j.Pb(j.i))},zx.\u0275cmp=j.Jb({type:zx,selectors:[["app-progress-circle"]],viewQuery:function(e,t){var n;1&e&&j.Ec(Fx,!0),2&e&&j.sc(n=j.dc())&&(t.progressCircleRef=n.first)},inputs:{size:"size",progress:"progress"},decls:9,vars:18,consts:[["role","progressbar","aria-valuemin","0","aria-valuemax","100","data-test","progress",1,"progress"],["stroke","#F9FAFD","fill","transparent",1,"progress__circle"],["stroke","#5BB96F","fill","transparent",1,"progress__circle"],["progressCircle",""],["data-test","progressPercentage",1,"progress__label","text-semibold"]],template:function(e,t){1&e&&(j.Vb(0,"div",0),j.fc(),j.Vb(1,"svg"),j.Vb(2,"g"),j.Qb(3,"circle",1),j.Ub(),j.Vb(4,"g"),j.Qb(5,"circle",2,3),j.Ub(),j.Ub(),j.ec(),j.Vb(7,"div",4),j.Kc(8),j.Ub(),j.Ub()),2&e&&(j.Hb("progress--small","small"===t.size)("progress--medium","medium"===t.size)("progress--large","large"===t.size),j.Eb("aria-valuenow",t.progress),j.Db(1),j.Eb("width",t.diameter)("height",t.diameter),j.Db(2),j.Eb("stroke-width",t.strokeWidth)("r",t.diameter/2-2*t.strokeWidth)("cx",t.diameter/2)("cy",t.diameter/2),j.Db(2),j.Eb("stroke-width",t.strokeWidth)("r",t.diameter/2-2*t.strokeWidth)("cx",t.diameter/2)("cy",t.diameter/2),j.Db(3),j.Mc("",t.progress,"%"))},styles:[".text-8[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase[_ngcontent-%COMP%]{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase[_ngcontent-%COMP%]{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase[_ngcontent-%COMP%]{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase[_ngcontent-%COMP%]{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-28[_ngcontent-%COMP%]{font-size:28px;letter-spacing:.7px;line-height:1.4em}.text-28.text-uppercase[_ngcontent-%COMP%]{font-size:28px;letter-spacing:1.68px;line-height:1.25em;text-transform:uppercase}.text-header[_ngcontent-%COMP%]{font-weight:700}.text--code[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.text-xlight[_ngcontent-%COMP%]{font-weight:200}.text-light[_ngcontent-%COMP%]{font-weight:300}.text-medium[_ngcontent-%COMP%]{font-weight:500}.text-semibold[_ngcontent-%COMP%]{font-weight:600}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-underline[_ngcontent-%COMP%]{text-decoration:underline}.text-italic[_ngcontent-%COMP%]{font-style:italic}.text-bright[_ngcontent-%COMP%]{color:#fff}.text-dim[_ngcontent-%COMP%]{color:#96a8c0}.text-error[_ngcontent-%COMP%]{color:#ed4758}.text-left[_ngcontent-%COMP%]{text-align:left}.text-center[_ngcontent-%COMP%]{text-align:center}.text-right[_ngcontent-%COMP%]{text-align:right}.text-ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link[_ngcontent-%COMP%], .text-link[_ngcontent-%COMP%]:visited{color:inherit;cursor:pointer}.text-link[_ngcontent-%COMP%]:not(.text-underline), .text-link[_ngcontent-%COMP%]:visited:not(.text-underline){text-decoration:none}.text-success[_ngcontent-%COMP%]{color:#38de38}.text-danger[_ngcontent-%COMP%]{color:#de3535}.text-info[_ngcontent-%COMP%]{color:#2d72dc}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.text-pre-line[_ngcontent-%COMP%]{white-space:pre-line}.progress[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;justify-content:center}.progress__ring[_ngcontent-%COMP%]{position:absolute;z-index:1}.progress__circle[_ngcontent-%COMP%]{transition:stroke-dashoffset .35s;transform:rotate(-90deg);transform-origin:50% 50%}.progress__label[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);z-index:2}.progress--small[_ngcontent-%COMP%]   .progress__label[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.progress--medium[_ngcontent-%COMP%]   .progress__label[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.progress--large[_ngcontent-%COMP%]   .progress__label[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}"],changeDetection:0}),zx),Rx=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},Vx=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Nx=["summary"];function Bx(e,t){if(1&e&&(j.Vb(0,"div",14),j.Vb(1,"div",15),j.Kc(2),j.hc(3,"async"),j.Ub(),j.Vb(4,"div",16),j.Kc(5),j.hc(6,"async"),j.Ub(),j.Ub()),2&e){var n=j.gc(3);j.Db(2),j.Lc(j.ic(3,2,n.userFullName$)),j.Db(3),j.Lc(j.ic(6,4,n.userEmail$))}}function Hx(e,t){if(1&e&&(j.Vb(0,"div",11),j.Ic(1,Bx,7,6,"div",12),j.hc(2,"async"),j.Vb(3,"div",13),j.Kc(4,"Quiz Complete"),j.Ub(),j.Ub()),2&e){var n=j.gc(2);j.Db(1),j.lc("ngIf",j.ic(2,1,n.userProfile$))}}function Qx(e,t){if(1&e&&(j.Vb(0,"div",19),j.Qb(1,"app-view-quiz-answer",20),j.Ub()),2&e){var n=t.$implicit,i=t.index,o=j.gc(3);j.Db(1),j.lc("question",n)("questionNumber",i+1)("answer",null==o.quizScore?null:o.quizScore.questionAnswers[n.id])("summary",!0)}}function qx(e,t){if(1&e&&(j.Vb(0,"div",17),j.Ic(1,Qx,2,4,"div",18),j.Ub()),2&e){var n=j.gc(2);j.Db(1),j.lc("ngForOf",n.questions)}}function $x(e,t){if(1&e&&(j.Tb(0),j.Vb(1,"div",3,4),j.Ic(3,Hx,5,3,"div",5),j.Vb(4,"div",6),j.Qb(5,"app-progress-circle",7),j.Vb(6,"div",8),j.Kc(7,"Quiz Complete"),j.Ub(),j.Vb(8,"div",9),j.Kc(9),j.Ub(),j.Ub(),j.Ic(10,qx,2,1,"div",10),j.Ub(),j.Sb()),2&e){var n=j.gc();j.Db(3),j.lc("ngIf",n.downloading),j.Db(2),j.lc("progress",null==n.quizScore?null:n.quizScore.score),j.Db(4),j.Nc(" You answered ",null==n.quizScore?null:n.quizScore.correctTotal," of ",null==n.quizScore?null:n.quizScore.scorableTotal," questions correctly. "),j.Db(1),j.lc("ngIf",n.showExplanationEnabled&&n.showExplanation)}}function Wx(e,t){if(1&e){var n=j.Wb();j.Vb(0,"button",26),j.cc("click",(function(){return j.xc(n),j.gc(2).handleToggleSummaryClick()})),j.Kc(1),j.Ub()}if(2&e){var i=j.gc(2);j.Db(1),j.Mc(" ",i.showExplanation?"Hide Summary":"Show Summary"," ")}}function Kx(e,t){if(1&e){var n=j.Wb();j.Vb(0,"button",27),j.cc("click",(function(){return j.xc(n),j.gc(2).handleDownloadSummaryClick()})),j.Qb(1,"app-icon",28),j.Kc(2," Download Results "),j.Ub()}}function Gx(e,t){if(1&e){var n=j.Wb();j.Vb(0,"button",29),j.cc("click",(function(){return j.xc(n),j.gc(2).handleRestartClick()})),j.Kc(1," Take Again "),j.Ub()}}function Zx(e,t){if(1&e){var n=j.Wb();j.Vb(0,"button",30),j.cc("click",(function(){return j.xc(n),j.gc(2).handleExitClick()})),j.Kc(1," Back to View "),j.Ub()}}function Jx(e,t){if(1&e&&(j.Vb(0,"div",21),j.Ic(1,Wx,2,1,"button",22),j.Ic(2,Kx,3,0,"button",23),j.Ic(3,Gx,2,0,"button",24),j.hc(4,"async"),j.Ic(5,Zx,2,0,"button",25),j.hc(6,"async"),j.Ub()),2&e){var n=j.gc();j.Db(1),j.lc("ngIf",n.showSummaryEnabled&&n.showExplanationEnabled),j.Db(1),j.lc("ngIf",n.showSummaryEnabled&&n.showExplanationEnabled),j.Db(1),j.lc("ngIf",j.ic(4,4,n.enableQuizRetake$)),j.Db(2),j.lc("ngIf",!j.ic(6,6,n.quizLocked$))}}var Xx,Yx=function(e){return{"review--downloading":e}},eO=((Xx=function(){function e(t,n,i,o){y(this,e),this.changeRef=t,this.quizService=n,this.store=i,this.clipboardService=o,this.userFullName="",this.userEmail="",this.questions=[],this.showSummaryEnabled=!1,this.showExplanationEnabled=!1,this.showExplanation=!1,this.downloading=!1,this.ngUnsubscribe=new Z.a}return v(e,[{key:"ngOnInit",value:function(){this.initReviewListeners()}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"initReviewListeners",value:function(){var e=this;Object(zc.b)([this.questions$,this.submissions$]).pipe(Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){var n=d(t,2),i=n[0],o=n[1];e.questions=i,e.quizScore=$o(i,o),e.changeRef.markForCheck()})),this.quizSettings$.pipe(Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){var n=t.showSummary,i=t.showExplanation;e.showSummaryEnabled=!1!==n,e.showExplanationEnabled=!1!==i,e.changeRef.markForCheck()}))}},{key:"handleToggleSummaryClick",value:function(){this.showExplanation=!this.showExplanation,this.changeRef.markForCheck()}},{key:"handleDownloadSummaryClick",value:function(){this.downloadResults()}},{key:"downloadResults",value:function(){var e=this,t=this.showExplanation;this.store.dispatch(new _.ShowScrim(!0,"Downloading")),this.showExplanation=!0,this.changeRef.detectChanges(),this.downloading=!0,this.changeRef.detectChanges(),wr()(this.summary.nativeElement,{onclone:function(e){e.querySelector(".review").classList.add("review--download")}}).then((function(n){var i=e.store.selectSnapshot(Ic.getStory).displayName.replace(/\ /g,"_")||"anatomy",o=n.toDataURL("image/png");!0===T.native||T.platform===z.SDK?e.clipboardService.copyToClipboard(o,"image").toPromise():Object(Cr.saveAs)(o,i+"_quiz_results.png"),e.showExplanation=t,e.downloading=!1,e.store.dispatch(new _.HideScrim),e.changeRef.markForCheck()}))}},{key:"handleRestartClick",value:function(){this.quizService.resetQuiz(),this.quizService.startQuiz()}},{key:"handleExitClick",value:function(){this.quizService.exitQuiz()}}]),e}()).\u0275fac=function(e){return new(e||Xx)(j.Pb(j.i),j.Pb(Ef),j.Pb(L.g),j.Pb(Ju))},Xx.\u0275cmp=j.Jb({type:Xx,selectors:[["app-view-quiz-review"]],viewQuery:function(e,t){var n;1&e&&j.Pc(Nx,!0),2&e&&j.sc(n=j.dc())&&(t.summary=n.first)},decls:3,vars:5,consts:[["data-test","quizReview",1,"review",3,"ngClass"],[4,"ngIf"],["class","review__actions",4,"ngIf"],["data-test","quizDownload",1,"review__container"],["summary",""],["class","pv-4",4,"ngIf"],["data-test","quizSummary",1,"text-center"],["size","medium",3,"progress"],["data-html2canvas-ignore","true",1,"mt-8","text-18","text-semibold"],[1,"mv-4","text-14","text-medium"],["class","review__summary mb-4","data-test","quizExplanation",4,"ngIf"],[1,"pv-4"],["class","pb-4 pr-4",4,"ngIf"],[1,"text-18","text-semibold","text-center"],[1,"pb-4","pr-4"],[1,"text-right","text-semibold","text-14"],[1,"text-right","text-14"],["data-test","quizExplanation",1,"review__summary","mb-4"],["class","mv-6",4,"ngFor","ngForOf"],[1,"mv-6"],[3,"question","questionNumber","answer","summary"],[1,"review__actions"],["class","w-100","app-button","","buttonType","outline","buttonTheme","light","data-test","quizToggleSummaryButton",3,"click",4,"ngIf"],["class","w-100 mt-3","app-button","","buttonType","outline","buttonTheme","light","data-test","quizDownloadSummaryButton",3,"click",4,"ngIf"],["class","mt-8 w-100","app-button","","buttonType","info","buttonTheme","light","data-test","quizTakeAgainButton",3,"click",4,"ngIf"],["class","mt-3 w-100","app-button","","buttonType","info","buttonTheme","light","data-test","quizExitButton",3,"click",4,"ngIf"],["app-button","","buttonType","outline","buttonTheme","light","data-test","quizToggleSummaryButton",1,"w-100",3,"click"],["app-button","","buttonType","outline","buttonTheme","light","data-test","quizDownloadSummaryButton",1,"w-100","mt-3",3,"click"],["icon","download"],["app-button","","buttonType","info","buttonTheme","light","data-test","quizTakeAgainButton",1,"mt-8","w-100",3,"click"],["app-button","","buttonType","info","buttonTheme","light","data-test","quizExitButton",1,"mt-3","w-100",3,"click"]],template:function(e,t){1&e&&(j.Vb(0,"div",0),j.Ic(1,$x,11,5,"ng-container",1),j.Ic(2,Jx,7,8,"div",2),j.Ub()),2&e&&(j.lc("ngClass",j.nc(3,Yx,t.downloading)),j.Db(1),j.lc("ngIf",t.showSummaryEnabled),j.Db(1),j.lc("ngIf",!t.downloading))},directives:[we.i,we.l,Ax,we.k,Nm,Dd,vp],pipes:[we.b],styles:[".review[_ngcontent-%COMP%]{position:relative}.review--downloading[_ngcontent-%COMP%]   .review__download-scrim[_ngcontent-%COMP%]{display:flex}.review--download[_ngcontent-%COMP%]{width:595px}.review--download[_ngcontent-%COMP%], .review--download[_ngcontent-%COMP%]   .review__summary[_ngcontent-%COMP%]{background-color:#fff}.review__summary[_ngcontent-%COMP%]{background-color:#f9fafd;padding:4px 12px}"],changeDetection:0}),Rx([Object(L.d)(rr.getAllQuestions),Vx("design:type",J.a)],Xx.prototype,"questions$",void 0),Rx([Object(L.d)(rr.getAllSubmissions),Vx("design:type",J.a)],Xx.prototype,"submissions$",void 0),Rx([Object(L.d)(rr.getQuizSettings),Vx("design:type",J.a)],Xx.prototype,"quizSettings$",void 0),Rx([Object(L.d)(rr.getQuizModeLocked),Vx("design:type",J.a)],Xx.prototype,"quizLocked$",void 0),Rx([Object(L.d)(rr.getEnableQuizRetake),Vx("design:type",J.a)],Xx.prototype,"enableQuizRetake$",void 0),Rx([Object(L.d)(Ex.getUserProfile),Vx("design:type",J.a)],Xx.prototype,"userProfile$",void 0),Rx([Object(L.d)(Ex.getUserFullName),Vx("design:type",J.a)],Xx.prototype,"userFullName$",void 0),Rx([Object(L.d)(Ex.getUserEmail),Vx("design:type",J.a)],Xx.prototype,"userEmail$",void 0),Xx),tO=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},nO=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function iO(e,t){if(1&e){var n=j.Wb();j.Vb(0,"button",10),j.cc("click",(function(){return j.xc(n),j.gc(2).handleExitClick()})),j.Vb(1,"span",11),j.Kc(2,"Exit Quiz"),j.Ub(),j.Ub()}}function oO(e,t){if(1&e&&(j.Qb(0,"app-view-quiz-progress",12),j.hc(1,"async"),j.hc(2,"async")),2&e){var n=j.gc(2);j.lc("index",j.ic(1,2,n.questionIndex$))("total",j.ic(2,4,n.questionTotal$))}}function rO(e,t){if(1&e&&(j.Vb(0,"div",5),j.Vb(1,"div",6),j.Vb(2,"h1",7),j.Kc(3,"Quiz"),j.Ub(),j.Ic(4,iO,3,0,"button",8),j.hc(5,"async"),j.Ub(),j.Ic(6,oO,3,6,"app-view-quiz-progress",9),j.hc(7,"async"),j.hc(8,"async"),j.Ub()),2&e){var n,i=j.gc();j.Db(4),j.lc("ngIf",!j.ic(5,2,i.quizLocked$)),j.Db(2),j.lc("ngIf",(null==(n=j.ic(7,4,i.quizSettings$))?null:n.showProgress)&&j.ic(8,6,i.lifecycle$)!==i.Lifecycle.Review)}}function aO(e,t){if(1&e&&(j.Qb(0,"app-view-quiz-question",16),j.hc(1,"async")),2&e){var n=j.gc(2);j.lc("question",j.ic(1,1,n.question$))}}function sO(e,t){if(1&e&&(j.Vb(0,"div"),j.Kc(1),j.hc(2,"async"),j.Ub()),2&e){var n,i=j.gc(3);j.Db(1),j.Mc(" ",(null==(n=j.ic(2,1,i.question$))?null:n.nextLabel)||i.defaultNextButtonNext," ")}}function cO(e,t){1&e&&(j.Vb(0,"div"),j.Kc(1,"Submit"),j.Ub())}function lO(e,t){if(1&e&&(j.Vb(0,"button",17),j.Vb(1,"div",18),j.hc(2,"async"),j.Ic(3,sO,3,3,"div",19),j.Ic(4,cO,2,0,"div",20),j.Ub(),j.Ub()),2&e){var n,i=j.gc(2);j.lc("disabled",!i.form.valid),j.Db(1),j.lc("ngSwitch",null==(n=j.ic(2,3,i.question$))?null:n.type),j.Db(2),j.lc("ngSwitchCase",i.quizQuestionType.Instructions)}}function pO(e,t){if(1&e){var n=j.Wb();j.Vb(0,"form",13),j.cc("submit",(function(){return j.xc(n),j.gc().handleSubmit()})),j.Ic(1,aO,2,3,"app-view-quiz-question",14),j.hc(2,"async"),j.Ic(3,lO,5,5,"button",15),j.hc(4,"async"),j.hc(5,"async"),j.Ub()}if(2&e){var i,o=j.gc();j.lc("formGroup",o.form),j.Db(1),j.lc("ngIf",j.ic(2,3,o.question$)),j.Db(2),j.lc("ngIf",(null==(i=j.ic(4,5,o.quizSettings$))?null:i.showSubmit)&&j.ic(5,7,o.lifecycle$)===o.Lifecycle.Question)}}function uO(e,t){if(1&e){var n=j.Wb();j.Vb(0,"button",24),j.cc("click",(function(){return j.xc(n),j.gc(2).nextQuestion()})),j.Kc(1),j.hc(2,"async"),j.Ub()}if(2&e){var i,o=j.gc(2);j.Db(1),j.Mc(" ",(null==(i=j.ic(2,1,o.question$))?null:i.nextLabel)||o.defaultNextButtonNext," ")}}function dO(e,t){if(1&e){var n=j.Wb();j.Vb(0,"button",26),j.cc("click",(function(){return j.xc(n),j.gc(3).handleViewSummaryClick()})),j.Kc(1," See Results "),j.Ub()}}function gO(e,t){if(1&e&&(j.Tb(0),j.Ic(1,dO,2,0,"button",25),j.hc(2,"async"),j.Sb()),2&e){var n=j.gc(2);j.Db(1),j.lc("ngIf",j.ic(2,1,n.quizReviewEnabled$))}}function hO(e,t){if(1&e&&(j.Tb(0),j.Vb(1,"div",21),j.Qb(2,"app-view-quiz-answer",22),j.hc(3,"async"),j.hc(4,"async"),j.Ub(),j.Tb(5,18),j.hc(6,"async"),j.Ic(7,uO,3,3,"button",23),j.Ic(8,gO,3,3,"ng-container",20),j.Sb(),j.Sb()),2&e){var n=j.gc();j.Db(2),j.lc("question",j.ic(3,5,n.question$))("answer",j.ic(4,7,n.submission$).answer)("summary",!1),j.Db(3),j.lc("ngSwitch",j.ic(6,9,n.hasQuestionsRemaining$)),j.Db(2),j.lc("ngSwitchCase",!0)}}function fO(e,t){1&e&&(j.Tb(0),j.Qb(1,"app-view-quiz-review"),j.Sb())}function bO(e,t){if(1&e&&(j.Vb(0,"div",27),j.Kc(1),j.hc(2,"async"),j.Ub()),2&e){var n,i=j.gc();j.Db(1),j.Mc(" ",1===(null==(n=j.ic(2,1,i.questions$))?null:n.length)?"Answer":"Answers"," submitted ")}}var mO,vO=((mO=function(){function e(t,n,i,o,r,a,s){y(this,e),this.store=t,this.actions=n,this.formBuilder=i,this.viewService=o,this.engineService=r,this.quizService=a,this.pendoService=s,this.defaultNextButtonNext="Next Question",this.showHeader=!0,this.Lifecycle=Ko,this.quizQuestionType=No,this.sceneConfigStash={},this.ngUnsubscribe=new Z.a}return v(e,[{key:"ngOnInit",value:function(){if(!this.store.selectSnapshot(rr.getActiveQuestionId)){var e=this.store.selectSnapshot(rr).questions[0].id;this.store.dispatch(new Eo.SetActiveQuestion(e))}this.store.dispatch(new Eo.SetQuizLifecycle(Ko.Question)),this.form=this.formBuilder.group({question:new mh.f("",this.getQuizValidation())}),this.initQuestionObserver(),this.initAnswerObserver(),this.initEngineInteractionObserver(),this.engineService.fireEvent(yn.QuizEntered,!0)}},{key:"ngOnDestroy",value:function(){var e=this;Object.entries(this.sceneConfigStash).forEach((function(t){var n=d(t,2),i=n[0],o=n[1];e.store.dispatch(new ki(i,o.background))})),this.engineService.fireEvent(yn.QuizExited,!0),this.viewService.selectTool(ks.Select),this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"answer",get:function(){var e=this.form.get("question").value;return Array.isArray(e)?e:[e]}},{key:"initQuestionObserver",value:function(){var e=this;this.question$.pipe(Object(X.a)(this.ngUnsubscribe),Object(Y.a)((function(e){return void 0!==e}))).subscribe((function(t){var n=e.store.selectSnapshot(vs.getSelectedChapterId);t.chapterId!==n&&e.store.dispatch(new ci(t.chapterId)),e.form.reset(),e.setSceneConfig(t),e.store.dispatch(new Eo.SetActiveSubmission(void 0)),t.type===No.Instructions&&e.form.get("question").setValue("-"),e.engineService.fireEvent(yn.QuizQuestionLoaded,t)}))}},{key:"initAnswerObserver",value:function(){var e=this;this.form.get("question").valueChanges.pipe(Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){var n=e.store.selectSnapshot(rr.getActiveQuestion),i=e.store.selectSnapshot(rr.getActiveSubmission);void 0!==n&&(e.store.selectSnapshot(rr.getAllSubmissions).some((function(e){return e.questionId===n.id}))||(i&&Object(ie.isEqual)(i.answer,t)||e.store.dispatch(new Eo.SetActiveSubmission({questionId:n.id,answer:t})),Object(ie.isNil)(t)||e.engineService.fireEvent(yn.QuizAnswerSelected,{questionId:n.id,answerId:t})))}))}},{key:"initEngineInteractionObserver",value:function(){var e=this;this.viewService.selectTool(ks.Quiz),this.store.dispatch(new Eo.SetQuizPickMode("single")),this.actions.pipe(Object(L.j)(_t),Object(Y.a)((function(t){var n=t.node,i=t.event;return!Object(ie.isNil)(n)&&e.store.selectSnapshot(zs.getActiveTool)===ks.Quiz&&!i.srcEvent.shiftKey}))).pipe(Object(Y.a)((function(){return"none"!==e.store.selectSnapshot(rr.getPickMode)})),Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){"single"===e.store.selectSnapshot(rr.getPickMode)&&e.viewService.clearSelectedNodes();var n=Object(ie.get)(t,"hit.objectId");if(n){var i=e.store.selectSnapshot(jo.getCheckedNodeIds).includes(n);e.store.dispatch(new Yi.UpdateNodesChecked(!i,[n]))}})),this.question$.pipe(Object(Zc.a)((function(e,t){return Object(ie.get)(e,"id")===Object(ie.get)(t,"id")})),Object(Y.a)((function(e){return!Object(ie.isNil)(e)}))).pipe(Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){var n=t.type,i=t.data;e.store.dispatch(new Eo.SetQuizPickMode(n===No.SelectAnatomy&&i.correctAnswer.length>1&&"any"!==i.selectType?"multi":"single"))}))}},{key:"handleSubmit",value:function(){var e=this.store.selectSnapshot(rr.getActiveQuestion);(this.form.valid||e.type===No.Instructions)&&this.quizService.submitQuestion(e.id,this.answer)}},{key:"handleViewSummaryClick",value:function(){this.viewSummary()}},{key:"handleExitClick",value:function(){this.quizService.exitQuiz()}},{key:"nextQuestion",value:function(){this.quizService.nextQuestion()}},{key:"viewSummary",value:function(){this.store.dispatch(new Eo.SetQuizLifecycle(Ko.Review)),this.engineService.fireEvent(yn.QuizCompleted,!0)}},{key:"setSceneConfig",value:function(e){var t=this,n=(null==e?void 0:e.sceneConfig)||{},i=n.camera,o=n.background,r=this.store.selectSnapshot(vs.getChapter(e.chapterId));i&&(this.setStash(e.chapterId,{camera:r.camera.location}),setTimeout((function(){t.store.dispatch(new zn(i.location,!0,1))}))),o&&(this.setStash(e.chapterId,{background:r.background}),this.store.dispatch(new ki(e.chapterId,o)))}},{key:"setStash",value:function(e,t){this.sceneConfigStash[e]=Object.assign(Object.assign({},this.sceneConfigStash[e]||{}),t)}},{key:"getQuizValidation",value:function(){var e=this;return function(t){var n=t.value,i=Array.isArray(n)?n:[n],o=function(e){switch(Object(ie.get)(e,"type","")){case No.MultipleChoice:var t=Object(ie.get)(e,"data.correctAnswer","");return t&&""!==t;case No.SelectAnatomy:case No.LabelAnatomy:return Object(ie.get)(e,"data.correctAnswer",[]).length>0;default:return!0}}(e.store.selectSnapshot(rr.getActiveQuestion)),r=i.some((function(e){return Object(ie.isNil)(e)||""===e}));return o&&r?{invalidValues:r}:null}}}]),e}()).\u0275fac=function(e){return new(e||mO)(j.Pb(L.g),j.Pb(L.b),j.Pb(mh.e),j.Pb(Wp),j.Pb(Sn),j.Pb(Ef),j.Pb(Oe))},mO.\u0275cmp=j.Jb({type:mO,selectors:[["app-view-quiz"]],inputs:{showHeader:"showHeader"},decls:13,vars:19,consts:[["data-test","quiz",1,"view-quiz"],["class","pb-2 mb-4 view-quiz__header",4,"ngIf"],[3,"formGroup","submit",4,"ngIf"],[4,"ngIf"],["class","text-16 text-bold text-center",4,"ngIf"],[1,"pb-2","mb-4","view-quiz__header"],[1,"flex"],[1,"text-20","text-semibold","flex-grow"],["app-pin-button","","icon","times","size","small","data-test","quizHeaderExit",3,"click",4,"ngIf"],["class","mt-3",3,"index","total",4,"ngIf"],["app-pin-button","","icon","times","size","small","data-test","quizHeaderExit",3,"click"],[1,"visually-hidden"],[1,"mt-3",3,"index","total"],[3,"formGroup","submit"],["formControlName","question",3,"question",4,"ngIf"],["app-button","","class","w-100","buttonType","info","data-test","questionSubmit",3,"disabled",4,"ngIf"],["formControlName","question",3,"question"],["app-button","","buttonType","info","data-test","questionSubmit",1,"w-100",3,"disabled"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[1,"mb-8"],[3,"question","answer","summary"],["app-button","","buttonType","info","class","w-100","data-test","questionNextButton",3,"click",4,"ngSwitchCase"],["app-button","","buttonType","info","data-test","questionNextButton",1,"w-100",3,"click"],["data-test","quizViewSummaryButton","app-button","","buttonType","info","class","w-100",3,"click",4,"ngIf"],["data-test","quizViewSummaryButton","app-button","","buttonType","info",1,"w-100",3,"click"],[1,"text-16","text-bold","text-center"]],template:function(e,t){if(1&e&&(j.Vb(0,"div",0),j.Ic(1,rO,9,8,"div",1),j.Ic(2,pO,6,9,"form",2),j.hc(3,"async"),j.Ic(4,hO,9,11,"ng-container",3),j.hc(5,"async"),j.Ic(6,fO,2,0,"ng-container",3),j.hc(7,"async"),j.hc(8,"async"),j.Ic(9,bO,3,3,"div",4),j.hc(10,"async"),j.hc(11,"async"),j.hc(12,"async"),j.Ub()),2&e){var n=null;j.Db(1),j.lc("ngIf",t.showHeader),j.Db(1),j.lc("ngIf",j.ic(3,5,t.lifecycle$)===t.Lifecycle.Question),j.Db(2),j.lc("ngIf",j.ic(5,7,t.lifecycle$)===t.Lifecycle.Explanation),j.Db(2),j.lc("ngIf",j.ic(7,9,t.lifecycle$)===t.Lifecycle.Review&&j.ic(8,11,t.quizReviewEnabled$)),j.Db(3),j.lc("ngIf",!(j.ic(10,13,t.hasQuestionsRemaining$)||j.ic(11,15,t.quizReviewEnabled$)||null!=(n=j.ic(12,17,t.quizSettings$))&&n.showExplanation))}},directives:[we.l,Dg,qb,mh.v,mh.o,mh.i,mm,mh.n,mh.h,Dd,we.n,we.o,we.p,Nm,eO],pipes:[we.b],styles:[".view-quiz__header[_ngcontent-%COMP%]{border-bottom:1px solid #eaeff5}"],changeDetection:0}),tO([Object(L.d)(rr.getQuizReviewEnabled),nO("design:type",J.a)],mO.prototype,"quizReviewEnabled$",void 0),tO([Object(L.d)(rr.getActiveQuestion),nO("design:type",J.a)],mO.prototype,"question$",void 0),tO([Object(L.d)(rr.getAllQuestions),nO("design:type",J.a)],mO.prototype,"questions$",void 0),tO([Object(L.d)(rr.getActiveQuestionIndex),nO("design:type",J.a)],mO.prototype,"questionIndex$",void 0),tO([Object(L.d)(rr.getQuestionTotal),nO("design:type",J.a)],mO.prototype,"questionTotal$",void 0),tO([Object(L.d)(rr.getCorrectAnswerTotal),nO("design:type",J.a)],mO.prototype,"correctAnswerTotal$",void 0),tO([Object(L.d)(rr.hasQuestionRemaining),nO("design:type",J.a)],mO.prototype,"hasQuestionsRemaining$",void 0),tO([Object(L.d)(rr.getQuizSettings),nO("design:type",J.a)],mO.prototype,"quizSettings$",void 0),tO([Object(L.d)(rr.getLifecycle),nO("design:type",J.a)],mO.prototype,"lifecycle$",void 0),tO([Object(L.d)(rr.getQuizModeLocked),nO("design:type",J.a)],mO.prototype,"quizLocked$",void 0),tO([Object(L.d)(rr.getActiveSubmission),nO("design:type",J.a)],mO.prototype,"submission$",void 0),mO),yO=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},xO=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},OO=["viewDrawer"],wO=["viewDrawerOuter"];function kO(e,t){if(1&e&&(j.Vb(0,"div",7),j.Qb(1,"app-spinner",8),j.hc(2,"async"),j.Ub()),2&e){var n,i=j.gc();j.Db(1),j.lc("label",null==(n=j.ic(2,1,i.scrim$))?null:n.label)}}function CO(e,t){1&e&&j.Qb(0,"app-icon",21)}function SO(e,t){1&e&&j.Qb(0,"app-icon",22)}function _O(e,t){if(1&e&&(j.Vb(0,"div",23),j.Qb(1,"app-content-blocks",24),j.hc(2,"async"),j.Ub()),2&e){var n,i=j.gc(2);j.Db(1),j.lc("contentBlocks",null==(n=j.ic(2,2,i.selectedLabel$))?null:n.contentBlocks)("layout","compact")}}function jO(e,t){if(1&e){var n=j.Wb();j.Tb(0),j.Vb(1,"div",9),j.Vb(2,"div",10),j.Vb(3,"button",11),j.cc("click",(function(){return j.xc(n),j.gc().handleLabelBack()})),j.Qb(4,"app-icon",12),j.Ub(),j.Ub(),j.Vb(5,"div",13),j.Qb(6,"app-html",14),j.hc(7,"async"),j.Ub(),j.Vb(8,"div",15),j.Vb(9,"button",11),j.cc("click",(function(){return j.xc(n),j.gc().handleToggleClick()})),j.Ic(10,CO,1,0,"app-icon",16),j.Ic(11,SO,1,0,"app-icon",17),j.Ub(),j.Ub(),j.Ub(),j.Ic(12,_O,3,4,"div",18),j.hc(13,"async"),j.Vb(14,"div",19),j.Qb(15,"app-html",20),j.hc(16,"async"),j.Ub(),j.Sb()}if(2&e){var i,o,r,a=j.gc();j.Db(6),j.lc("markdownText",null==(i=j.ic(7,7,a.selectedLabel$))?null:i.title),j.Db(3),j.Eb("aria-expanded",a.open)("aria-label",a.open?"Close Info Panel":"Open Info Panel"),j.Db(1),j.lc("ngIf",!a.open),j.Db(1),j.lc("ngIf",a.open),j.Db(1),j.lc("ngIf",null==(o=j.ic(13,9,a.selectedLabel$))?null:o.contentBlocks),j.Db(3),j.lc("markdownText",null==(r=j.ic(16,11,a.selectedLabel$))?null:r.description)}}function PO(e,t){1&e&&(j.Tb(0),j.Qb(1,"app-view-title",29),j.Sb()),2&e&&(j.Db(1),j.lc("menuEnabled",!1))}function MO(e,t){if(1&e){var n=j.Wb();j.Vb(0,"button",35),j.cc("click",(function(){return j.xc(n),j.gc(3).handleExitQuiz()})),j.Qb(1,"app-icon",36),j.Ub()}}function IO(e,t){if(1&e&&(j.Vb(0,"span",37),j.Vb(1,"span",38),j.Kc(2),j.hc(3,"async"),j.Ub(),j.Kc(4),j.hc(5,"async"),j.Ub()),2&e){var n=j.gc(3);j.Db(2),j.Mc("Question ",j.ic(3,2,n.activeQuestionIndex$)+1,""),j.Db(2),j.Mc(" of ",j.ic(5,4,n.questionTotal$)," ")}}function zO(e,t){if(1&e&&(j.Tb(0),j.Vb(1,"div",30),j.Ic(2,MO,2,0,"button",31),j.hc(3,"async"),j.Ub(),j.Vb(4,"div",13),j.Vb(5,"div",32),j.Vb(6,"span",33),j.Kc(7,"Quiz"),j.Ub(),j.Ic(8,IO,6,6,"span",34),j.hc(9,"async"),j.hc(10,"async"),j.Ub(),j.Ub(),j.Sb()),2&e){var n,i=j.gc(2);j.Db(2),j.lc("ngIf",!j.ic(3,2,i.quizLocked$)),j.Db(6),j.lc("ngIf",(null==(n=j.ic(9,4,i.quizSettings$))?null:n.showProgress)&&j.ic(10,6,i.questionRemaining$)>0)}}function TO(e,t){1&e&&j.Qb(0,"app-icon",21)}function UO(e,t){1&e&&j.Qb(0,"app-icon",22)}function DO(e,t){if(1&e){var n=j.Wb();j.Vb(0,"button",39),j.cc("click",(function(){return j.xc(n),j.gc(2).handleToggleClick()})),j.Ic(1,TO,1,0,"app-icon",16),j.Ic(2,UO,1,0,"app-icon",17),j.Ub()}if(2&e){var i=j.gc(2);j.Eb("aria-expanded",i.open)("aria-label",i.open?"Close Info Panel":"Open Info Panel"),j.Db(1),j.lc("ngIf",!i.open),j.Db(1),j.lc("ngIf",i.open)}}function LO(e,t){1&e&&j.Qb(0,"app-view-content-mode",41)}function EO(e,t){if(1&e&&(j.Tb(0),j.Ic(1,LO,1,0,"app-view-content-mode",40),j.Sb()),2&e){var n=j.gc(2);j.Db(1),j.lc("ngIf",n.expandable)}}function FO(e,t){1&e&&j.Qb(0,"app-view-quiz",42),2&e&&j.lc("showHeader",!1)}function AO(e,t){if(1&e&&(j.Tb(0),j.Vb(1,"article",9),j.Ic(2,PO,2,1,"ng-container",25),j.hc(3,"async"),j.Ic(4,zO,11,8,"ng-container",25),j.hc(5,"async"),j.Vb(6,"div",26),j.Ic(7,DO,3,4,"button",27),j.Ub(),j.Ub(),j.Vb(8,"div",19),j.Ic(9,EO,2,1,"ng-container",25),j.hc(10,"async"),j.Ic(11,FO,1,1,"app-view-quiz",28),j.hc(12,"async"),j.Ub(),j.Sb()),2&e){var n=j.gc();j.Db(2),j.lc("ngIf",!j.ic(3,5,n.quizModeActive$)),j.Db(2),j.lc("ngIf",j.ic(5,7,n.quizModeActive$)),j.Db(3),j.lc("ngIf",n.expandable),j.Db(2),j.lc("ngIf",!j.ic(10,9,n.quizModeActive$)),j.Db(2),j.lc("ngIf",j.ic(12,11,n.quizModeActive$))}}var RO,VO=function(e,t,n,i){return{"view-drawer--closed":e,"view-drawer--active":t,"view-drawer--scrollable":n,"view-drawer--fixed":i}},NO=((RO=function(){function e(t,n,i,o,r,a){y(this,e),this.renderer=t,this.changeDetectorRef=n,this.viewService=i,this.quizService=o,this.store=r,this.layoutService=a,this.offsetYChange=new j.p,this.breakpoints={minimumDrawer:{velocity:1/0,point:0},halfDrawer:{velocity:1,point:0}},this.ngUnsubscribe=new Z.a,this.viewMode=Uc,this.viewToolsMode=Lf,this.mode=Uc.Content,this.open=!1}return v(e,[{key:"expandable",get:function(){return"full"===this.layoutService.getVisibleContent()||this.mode===Uc.LabelInfo||this.mode===Uc.NodeInfo||this.open}},{key:"ngOnInit",value:function(){this.initWindowSizeObserver(),this.initLayoutObserver(),this.initQuizObserver()}},{key:"ngAfterViewInit",value:function(){this.refresh(this.store.selectSnapshot(hs.getUI).drawer.isExpandedInitially)}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"initWindowSizeObserver",value:function(){var e=this;Object(mr.a)(Object(ka.a)(window,"resize"),Object(ka.a)(window,"orientationchange")).pipe(Object(_c.a)(0),Object(X.a)(this.ngUnsubscribe)).subscribe((function(){e.refresh(!1)}))}},{key:"initLayoutObserver",value:function(){var e=this;this.layout$.pipe(Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){e.updateMode(t)}))}},{key:"initQuizObserver",value:function(){var e=this,t=this.selectedChapterReady$.pipe(Object(se.a)((function(e){return e&&e.model})),Object(Y.a)((function(e){return e})),Object(Gp.a)(300));Object(zc.b)([t,this.quizModeActive$]).pipe(Object(Y.a)((function(e){var t=d(e,2),n=t[0],i=t[1];return n&&i})),Object(X.a)(this.ngUnsubscribe)).subscribe((function(){setTimeout((function(){e.toggleDrawer(!0),e.changeDetectorRef.markForCheck()}))}))}},{key:"updateViewHeight",value:function(){var e=T.application!==P.Viewer,t=bp(this.store.selectSnapshot(fp.getSiteHeader),e);this.viewDrawer.nativeElement.style.setProperty("--vh",t+"px")}},{key:"updateStops",value:function(){var e=window.innerHeight,t=this.store.selectSnapshot(fp.getSiteHeader)===up.Hide?0:56;this.breakpoints.minimumDrawer.point=-64,this.breakpoints.halfDrawer.point=Math.floor(-.5*(e-t))}},{key:"updateMode",value:function(e){this.mode=this.viewService.inferDrawerMode(e),this.changeDetectorRef.markForCheck()}},{key:"resetDrawerPosition",value:function(e){var t=this;setTimeout((function(){t.slideDrawerToPoint(e?t.breakpoints.halfDrawer.point:t.breakpoints.minimumDrawer.point),t.open=e,t.changeDetectorRef.markForCheck()}))}},{key:"refresh",value:function(e){var t=this;setTimeout((function(){t.updateViewHeight(),t.updateStops(),t.resetDrawerPosition(e)}))}},{key:"handleToggleClick",value:function(){this.expandable&&this.toggleDrawer()}},{key:"handleDrawerKeydown",value:function(e){"ArrowDown"!==e.key&&"ArrowUp"!==e.key||e.stopPropagation()}},{key:"handleLabelBack",value:function(){this.viewService.clearSelectedLabel()}},{key:"toggleDrawer",value:function(e){null==e&&(e=!this.open),this.slideDrawerToPoint((e?this.breakpoints.halfDrawer:this.breakpoints.minimumDrawer).point),this.open=e}},{key:"handleExitQuiz",value:function(){this.quizService.exitQuiz()}},{key:"slideDrawerToPoint",value:function(e){this.renderer.setStyle(this.viewDrawer.nativeElement,"transform","translate3d(0, ".concat(e,"px, 0)")),this.offsetYChange.emit(e)}},{key:"getDrawerY",value:function(){if(this.viewDrawer){var e=this.viewService.getComputedTransform(this.viewDrawer.nativeElement);return e?e.y:null}return null}}]),e}()).\u0275fac=function(e){return new(e||RO)(j.Pb(j.H),j.Pb(j.i),j.Pb(Wp),j.Pb(Ef),j.Pb(L.g),j.Pb(pl))},RO.\u0275cmp=j.Jb({type:RO,selectors:[["app-view-drawer"]],viewQuery:function(e,t){var n;1&e&&(j.Pc(OO,!0),j.Pc(wO,!0)),2&e&&(j.sc(n=j.dc())&&(t.viewDrawer=n.first),j.sc(n=j.dc())&&(t.viewDrawerOuter=n.first))},inputs:{expandable:"expandable"},outputs:{offsetYChange:"offsetYChange"},decls:9,vars:13,consts:[[1,"view-drawer",3,"ngClass"],["viewDrawer",""],["class","view-drawer__scrim",4,"ngIf"],["role","region","aria-label","Chapter Description",1,"view-drawer__outer",3,"keydown"],["viewDrawerOuter",""],[1,"view-drawer__inner",3,"ngSwitch"],[4,"ngSwitchCase"],[1,"view-drawer__scrim"],["size","large",3,"label"],[1,"view-drawer__header",2,"height","64px"],[1,"view-drawer__button","view-drawer__button--left"],["app-pin-button","","buttonType","outline",3,"click"],["icon","arrow-left"],[1,"view-drawer__title"],[1,"text-semibold","text-14",3,"markdownText"],[1,"view-drawer__button","view-drawer__button--right"],["icon","caret-up",4,"ngIf"],["icon","caret-down",4,"ngIf"],["class","mv-1","appEventFence","",4,"ngIf"],[1,"view-drawer__content"],[1,"text-14",3,"markdownText"],["icon","caret-up"],["icon","caret-down"],["appEventFence","",1,"mv-1"],[3,"contentBlocks","layout"],[4,"ngIf"],["appEventFence","",1,"view-drawer__button","view-drawer__button--right"],["type","button","app-pin-button","","buttonType","outline",3,"click",4,"ngIf"],[3,"showHeader",4,"ngIf"],["alignTitle","center","size","medium",1,"view-drawer__title",3,"menuEnabled"],["appEventFence","",1,"view-drawer__button","view-drawer__button--left"],["app-pin-button","","buttonType","outline","type","button",3,"click",4,"ngIf"],[1,"flex","flex-column","text-center"],[1,"text-11","text-semibold","text-uppercase"],["class","text-14",4,"ngIf"],["app-pin-button","","buttonType","outline","type","button",3,"click"],["icon","times"],[1,"text-14"],[1,"text-semibold"],["type","button","app-pin-button","","buttonType","outline",3,"click"],["layout","drawer",4,"ngIf"],["layout","drawer"],[3,"showHeader"]],template:function(e,t){var n;(1&e&&(j.Vb(0,"div",0,1),j.Ic(2,kO,3,3,"div",2),j.hc(3,"async"),j.Vb(4,"div",3,4),j.cc("keydown",(function(e){return t.handleDrawerKeydown(e)})),j.Vb(6,"div",5),j.Ic(7,jO,17,13,"ng-container",6),j.Ic(8,AO,13,13,"ng-container",6),j.Ub(),j.Ub(),j.Ub()),2&e)&&(j.lc("ngClass",j.qc(8,VO,!t.open,t.open,t.open,!t.expandable)),j.Db(2),j.lc("ngIf",null==(n=j.ic(3,6,t.scrim$))?null:n.show),j.Db(2),j.Eb("tabindex",t.open?0:-1),j.Db(2),j.lc("ngSwitch",t.mode),j.Db(1),j.lc("ngSwitchCase",t.viewMode.LabelInfo),j.Db(1),j.lc("ngSwitchCase",t.viewMode.Content))},directives:[we.i,we.l,we.n,we.o,Bg,Dg,vp,Cg,Mu,ch,cb,Vb,vO],pipes:[we.b],styles:[".text-8{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-28{font-size:28px;letter-spacing:.7px;line-height:1.4em}.text-28.text-uppercase{font-size:28px;letter-spacing:1.68px;line-height:1.25em;text-transform:uppercase}.text-header{font-weight:700}.text--code{font-family:Courier New,Courier,monospace}.text-uppercase{text-transform:uppercase}.text-xlight{font-weight:200}.text-light{font-weight:300}.text-medium{font-weight:500}.text-semibold{font-weight:600}.text-bold{font-weight:700}.text-underline{text-decoration:underline}.text-italic{font-style:italic}.text-bright{color:#fff}.text-dim{color:#96a8c0}.text-error{color:#ed4758}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.text-ellipsis{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link,.text-link:visited{color:inherit;cursor:pointer}.text-link:not(.text-underline),.text-link:visited:not(.text-underline){text-decoration:none}.text-success{color:#38de38}.text-danger{color:#de3535}.text-info{color:#2d72dc}.text-nowrap{white-space:nowrap}.text-pre-line{white-space:pre-line}.view-drawer{border-top:rgba(234,239,245,.8);box-shadow:0 -1px 0 0 rgba(28,42,63,.16);background:hsla(0,0%,100%,.8);left:0;min-height:100vh;right:0;position:absolute;z-index:20;top:100vh;top:calc(var(--vh, 1vh) * 100);transform:translate3d(0,-56px,0);transition:transform .3s}.view-drawer--active,.view-drawer--closed{background-color:#fff}.view-drawer--scrollable{min-height:0}.view-drawer--scrollable .view-drawer__outer{height:50vh;height:calc(var(--vh, 1vh) * 50);overflow-y:scroll}.view-drawer--fixed{height:56px;overflow:hidden}.view-drawer--fixed .view-drawer__inner{height:56px;padding:0 16px}.view-drawer--fixed .view-drawer__content{justify-content:center;padding-top:0}.view-drawer__header{position:relative}.view-drawer__header,.view-drawer__title{height:64px;display:flex;justify-content:center;align-items:center}.view-drawer__title{flex-grow:1;margin:0 64px;padding:0 8px}.view-drawer__button{height:40px;width:40px;display:flex;align-items:center;justify-content:center;position:absolute}.view-drawer__button--left{left:16px}.view-drawer__button--right{right:16px}.view-drawer__inner{position:relative}.view-drawer__outer{outline:none}.view-drawer__content{display:flex;flex:1 1 100%;flex-direction:column;max-width:600px;min-height:56px;margin:0 auto;padding:8px 16px 48px}.view-drawer__scrim{background-color:#fff;position:absolute;display:flex;justify-content:center;align-items:center;z-index:50;left:0;right:0;top:0;bottom:0}"],encapsulation:2,changeDetection:0}),yO([Object(L.d)(hs.getUI),xO("design:type",J.a)],RO.prototype,"layout$",void 0),yO([Object(L.d)(hs.getScrim),xO("design:type",J.a)],RO.prototype,"scrim$",void 0),yO([Object(L.d)(vs.getSelectedChapterReadyState),xO("design:type",J.a)],RO.prototype,"selectedChapterReady$",void 0),yO([Object(L.d)(vs.getSelectedChapterIndex),xO("design:type",J.a)],RO.prototype,"chapterIndex$",void 0),yO([Object(L.d)(vs.getChapterCount),xO("design:type",J.a)],RO.prototype,"chapterCount$",void 0),yO([Object(L.d)(kc.getSelectedLabel),xO("design:type",J.a)],RO.prototype,"selectedLabel$",void 0),yO([Object(L.d)(rr.getQuizModeActive),xO("design:type",J.a)],RO.prototype,"quizModeActive$",void 0),yO([Object(L.d)(rr.getActiveQuestionIndex),xO("design:type",J.a)],RO.prototype,"activeQuestionIndex$",void 0),yO([Object(L.d)(rr.getQuestionTotal),xO("design:type",J.a)],RO.prototype,"questionTotal$",void 0),yO([Object(L.d)(rr.getQuestionsRemaining),xO("design:type",J.a)],RO.prototype,"questionRemaining$",void 0),yO([Object(L.d)(rr.getQuizSettings),xO("design:type",J.a)],RO.prototype,"quizSettings$",void 0),yO([Object(L.d)(rr.getQuizModeLocked),xO("design:type",J.a)],RO.prototype,"quizLocked$",void 0),RO),BO=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},HO=["viewColumn"];function QO(e,t){if(1&e&&(j.Vb(0,"div",6),j.Qb(1,"app-spinner",7),j.hc(2,"async"),j.Ub()),2&e){var n,i=j.gc();j.Db(1),j.lc("label",null==(n=j.ic(2,1,i.scrim$))?null:n.label)}}var qO,$O,WO=[[["","view-column-header",""]],"*"],KO=function(e,t,n){return{"view-column--unpadded":e,"view-column--left":t,"view-column--right":n}},GO=["[view-column-header]","*"],ZO=((qO=function(){function e(){y(this,e),this.unpadded=!1,this.placement="left"}return v(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||qO)},qO.\u0275cmp=j.Jb({type:qO,selectors:[["app-view-column"]],viewQuery:function(e,t){var n;1&e&&j.Pc(HO,!0),2&e&&j.sc(n=j.dc())&&(t.viewColumn=n.first)},inputs:{unpadded:"unpadded",placement:"placement"},ngContentSelectors:GO,decls:9,vars:8,consts:[[1,"view-column",3,"ngClass"],["viewColumn",""],["class","view-column__scrim",4,"ngIf"],[1,"view-column__inner"],[1,"view-column__header"],[1,"view-column__body"],[1,"view-column__scrim"],["size","large",3,"label"]],template:function(e,t){var n;(1&e&&(j.kc(WO),j.Vb(0,"div",0,1),j.Ic(2,QO,3,3,"div",2),j.hc(3,"async"),j.Vb(4,"article",3),j.Vb(5,"div",4),j.jc(6),j.Ub(),j.Vb(7,"div",5),j.jc(8,1),j.Ub(),j.Ub(),j.Ub()),2&e)&&(j.lc("ngClass",j.pc(4,KO,t.unpadded,"left"===t.placement,"right"===t.placement)),j.Db(2),j.lc("ngIf",null==(n=j.ic(3,2,t.scrim$))?null:n.show))},directives:[we.i,we.l,Bg],pipes:[we.b],styles:[".view-column[_ngcontent-%COMP%]{pointer-events:auto;background:#fff;box-shadow:1px -1px 2px 0 rgba(28,42,63,.1),0 1px 2px 0 rgba(28,42,63,.3);color:#131c2a;width:320px;height:100%;position:absolute;z-index:30}.view-column--left[_ngcontent-%COMP%]{left:0}.view-column--right[_ngcontent-%COMP%]{right:0;box-shadow:0 -1px 24px rgba(0,0,0,.4)}.view-column--unpadded[_ngcontent-%COMP%]   .view-column__body[_ngcontent-%COMP%]{padding:0}.view-column__inner[_ngcontent-%COMP%]{background:#fff;border-right:1px solid #eaeff5;display:flex;flex-direction:column;height:100%;width:320px;position:absolute;left:0;z-index:10}.view-column__header[_ngcontent-%COMP%]{flex-shrink:1;background:#fff}.view-column__header[_ngcontent-%COMP%]:empty{display:none}.view-column__body[_ngcontent-%COMP%]{overflow-y:auto;flex-grow:1;height:100%;padding:16px 12px}.view-column__scrim[_ngcontent-%COMP%]{background-color:#fff;position:absolute;display:flex;justify-content:center;align-items:center;z-index:50;left:0;right:0;top:0;bottom:0}"],changeDetection:0}),function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);r>3&&a&&Object.defineProperty(t,n,a)}([Object(L.d)(hs.getScrim),BO("design:type",J.a)],qO.prototype,"scrim$",void 0),qO),JO=["*"],XO=(($O=function(){function e(){y(this,e)}return v(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||$O)},$O.\u0275cmp=j.Jb({type:$O,selectors:[["app-view-list-container"],["","app-view-list-container",""]],ngContentSelectors:JO,decls:2,vars:0,consts:[[1,"view-list-container"]],template:function(e,t){1&e&&(j.kc(),j.Vb(0,"div",0),j.jc(1),j.Ub())},styles:[".view-list-container{display:flex;flex-direction:column}"],encapsulation:2,changeDetection:0}),$O),YO=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},ew=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},tw=function(e,t,n,i){return{"view-logo--full-color":e,"view-logo--full-white":t,"view-logo--small-color":n,"view-logo--small-white":i}};function nw(e,t){if(1&e&&(j.Tb(0),j.Qb(1,"a",1),j.Sb()),2&e){var n=j.gc();j.Db(1),j.lc("href","https://www.biodigital.com?utm_source="+(n.isNative?"human_mobile":"human_web")+"&utm_medium=PLG&utm_campaign=poweredby&ref=poweredby",j.Ac)("ngClass",j.qc(3,tw,"color"===n.logoColor&&"full"===n.logoSize,"white"===n.logoColor&&"full"===n.logoSize,"color"===n.logoColor&&"small"===n.logoSize,"white"===n.logoColor&&"small"===n.logoSize))("gaLabel",n.contentId)}}function iw(e,t){if(1&e&&(j.Tb(0),j.Qb(1,"span",2),j.Sb()),2&e){var n=j.gc();j.Db(1),j.lc("ngClass",j.qc(1,tw,"color"===n.logoColor&&"full"===n.logoSize,"white"===n.logoColor&&"full"===n.logoSize,"color"===n.logoColor&&"small"===n.logoSize,"white"===n.logoColor&&"small"===n.logoSize))}}var ow,rw,aw=((ow=function(){function e(){y(this,e),this.logoSize="full",this.logoColor="color",this.contentId="",this.source="",this.isNative=!1,this.isLight=!0,this.breakpoint=Gc,this.ngUnsubscribe=new Z.a}return v(e,[{key:"ngOnInit",value:function(){this.isNative=T.native}}]),e}()).\u0275fac=function(e){return new(e||ow)},ow.\u0275cmp=j.Jb({type:ow,selectors:[["app-view-logo"]],inputs:{logoSize:"logoSize",logoColor:"logoColor",contentId:"contentId"},decls:4,vars:6,consts:[[4,"ngIf"],["target","_blank","title","Powered by BioDigital","aria-label","Powered by BioDigital (opens in a new tab)","data-test","viewLogo","gaCategory","Logo","gaEvent","clicked_powered_by",1,"view-logo",3,"href","ngClass","gaLabel"],["title","Powered by BioDigital",1,"view-logo",3,"ngClass"]],template:function(e,t){var n,i;(1&e&&(j.Ic(0,nw,2,8,"ng-container",0),j.hc(1,"async"),j.Ic(2,iw,2,6,"ng-container",0),j.hc(3,"async")),2&e)&&(j.lc("ngIf",null==(n=j.ic(1,2,t.layout$))?null:n.logo.isHyperLink),j.Db(2),j.lc("ngIf",!(null!=(i=j.ic(3,4,t.layout$))&&i.logo.isHyperLink)))},directives:[we.l,ne.a,ne.b,we.i],pipes:[we.b],styles:["[_nghost-%COMP%]{display:flex;height:52px;align-items:center}.view-logo[_ngcontent-%COMP%]:focus{border-radius:4px;outline:2px solid #2d72dc!important}.view-logo--small-color[_ngcontent-%COMP%]{width:28px;height:44px;background:url(logo-color.svg) 50% no-repeat}.view-logo--full-color[_ngcontent-%COMP%]{width:120px;height:32px;background:url(powered-by-biodigital-color.svg) 50% no-repeat}.view-logo--small-white[_ngcontent-%COMP%]{width:28px;height:44px;background:url(logo-white.svg) 50% no-repeat}.view-logo--full-white[_ngcontent-%COMP%]{width:120px;height:32px;background:url(powered-by-biodigital-white.svg) 50% no-repeat}.view-logo[_ngcontent-%COMP%]:not([hidden]){display:flex}.view-logo[href][_ngcontent-%COMP%]:hover{cursor:pointer}"],changeDetection:0}),YO([Object(L.d)(hs.getUI),ew("design:type",J.a)],ow.prototype,"layout$",void 0),YO([Object(L.d)(vs.getSelectedChapterBackground),ew("design:type",J.a)],ow.prototype,"background$",void 0),YO([Object(L.d)(tl.getBreakpoint),ew("design:type",J.a)],ow.prototype,"breakpoint$",void 0),ow),sw=function(e){return{"view-list-item--selected":e}},cw=["*"],lw=((rw=function(){function e(){y(this,e),this.selected=!1}return v(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||rw)},rw.\u0275cmp=j.Jb({type:rw,selectors:[["app-view-list-item"],["","app-view-list-item",""]],inputs:{selected:"selected"},ngContentSelectors:cw,decls:2,vars:3,consts:[[1,"view-list-item",3,"ngClass"]],template:function(e,t){1&e&&(j.kc(),j.Vb(0,"div",0),j.jc(1),j.Ub()),2&e&&j.lc("ngClass",j.nc(1,sw,t.selected))},directives:[we.i],styles:['.text-8{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-28{font-size:28px;letter-spacing:.7px;line-height:1.4em}.text-28.text-uppercase{font-size:28px;letter-spacing:1.68px;line-height:1.25em;text-transform:uppercase}.text-header{font-weight:700}.text--code{font-family:Courier New,Courier,monospace}.text-uppercase{text-transform:uppercase}.text-xlight{font-weight:200}.text-light{font-weight:300}.text-medium{font-weight:500}.text-semibold{font-weight:600}.text-bold{font-weight:700}.text-underline{text-decoration:underline}.text-italic{font-style:italic}.text-bright{color:#fff}.text-dim{color:#96a8c0}.text-error{color:#ed4758}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.text-ellipsis{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link,.text-link:visited{color:inherit;cursor:pointer}.text-link:not(.text-underline),.text-link:visited:not(.text-underline){text-decoration:none}.text-success{color:#38de38}.text-danger{color:#de3535}.text-info{color:#2d72dc}.text-nowrap{white-space:nowrap}.text-pre-line{white-space:pre-line}.button{font-size:12px;letter-spacing:.3px;line-height:1.4em;align-items:center;background:none;border-color:transparent;border-radius:4px;border-width:0;color:inherit;display:flex;font-family:Inter UI,sans-serif;justify-content:center;margin:0;outline:0 none;padding:0 16px;position:relative;text-align:center;text-decoration:none;transition:background-color .12s;width:100%}.button:not([disabled]):hover{cursor:pointer}.button:focus .button--themed{outline:2px solid #2d72dc!important}.button:after{content:" ";background-color:#283853;border-radius:4px;display:block;position:absolute;left:0;top:0;bottom:0;right:0;opacity:0;z-index:1;transition:opacity .06s}.button:not(.button--disabled):hover:after{opacity:.7}.button__container{position:relative;z-index:2;width:100%}.button--uppercase{text-transform:uppercase}.button--expanded{display:flex;flex:1}.button--xsmall{height:24px;min-width:24px;padding:0 8px;font-size:10px;letter-spacing:.25px;line-height:1.4em}.button--small{height:32px;min-width:32px;padding:0 12px}.button--medium,.button--small{font-size:12px;letter-spacing:.3px;line-height:1.4em}.button--medium{height:36px;min-width:36px;padding:0 16px}.button--large{height:48px;min-width:48px;padding:0 16px;font-size:14px;letter-spacing:.35px;line-height:1.4em}.button--no-border,.button--no-border:after{border-radius:0!important}.button--left{text-align:left}.button--themed{color:#374a68}.button--themed:hover{color:#1c2a3f}.button--themed:after{background-color:#d7e0ea}.button--dark{color:#d7e0ea}.button--dark:hover{color:#fff}.button--dark:after{background-color:#283853}.button--dark.button--flat{background:#374a68}.button--dark.button--default{background:transparent}.button--dark.button--outline{background:transparent;border:1px solid #374a68;transition:border-color .12s}.button--dark.button--outline:hover{border-color:#96a8c0}.button--dark.button--outline:hover:after{background-color:transparent;display:none}.button--dark.button--text{background:transparent;color:#d7e0ea}.button--dark.button--text:hover{color:#fff}.button--dark.button--text:hover:after{display:none}.button--dark.button--selected{background-color:#2d72dc;color:#fff}.button--dark.button--selected:hover:after{display:none}.button--light{color:#283853}.button--light:hover{color:#1c2a3f}.button--light:after{background-color:#96a8c0}.button--light:not(.button--disabled):hover:after{opacity:.6}.button--light.button--flat{background:#d7e0ea;font-weight:500}.button--light.button--flat.button--selected{background-color:#96a8c0}.button--light.button--default{background:transparent;color:#131c2a}.button--light.button--default:not(.button--disabled):hover:after{opacity:.2}.button--light.button--outline{background:transparent;border:1px solid #96a8c0;color:#283853;transition:border-color .12s}.button--light.button--outline:after{display:none}.button--light.button--outline:hover{background:rgba(55,74,104,.05);border-color:#374a68;color:#1c2a3f}.button--light.button--outline:hover:after{background-color:transparent}.button--light.button--selected{background-color:#eaeff5}.button--light.button--selected:hover:after{display:none}.button--light.button--text{color:#283853}.button--light.button--text:hover{color:#1c2a3f}.button--light.button--text:hover:after{display:none}.button--primary{background:#de3535;color:#fff}.button--primary:after{background:#f9fafd}.button--primary:not([disabled]):hover:after{opacity:.1}.button--info{background:#3892dc;color:#fff}.button--info:after{background:#f9fafd}.button--info:hover:after{opacity:.1}.button--selected{background-color:#2d72dc}.button--disabled{opacity:.5}.button--circle{border-radius:50%}.button--circle.button--xsmall{width:24px}.button--circle.button--small{width:32px;padding:0 6px}.button--circle.button--medium{width:36px;padding:0 8px}.button--circle.button--large{width:48px}.button--circle:after{border-radius:50%}.button--rounded,.button--rounded:after{border-radius:18px}[app-view-list-item]{border-color:transparent;background:none;border-width:0;padding:0;outline:none;margin:0;pointer-events:all;display:flex;width:100%}[app-view-list-item]::-moz-focus-inner{border:0}[app-view-list-item]:not([disabled]):hover{cursor:pointer}.view-list-item{font-size:14px;letter-spacing:.35px;line-height:1.4em;display:flex;flex-grow:1;flex-direction:row;padding:12px;border-radius:2px;border-left:4px solid transparent;background-color:transparent;color:#131c2a;transition:background-color 125ms,color 125ms,border 125ms}.view-list-item:hover{cursor:pointer;background:#eaeff5}.view-list-item:focus{outline:2px solid #2d72dc!important}.view-list-item--selected{border-left:4px solid #2d72dc;background-color:#f0f8ff}.view-list-item__index{display:flex;flex:0 0 32px;justify-content:center}.view-list-item__title{word-wrap:break-word;overflow-wrap:break-word;display:flex;flex:1 1 auto;padding-right:4px}.view-list-item__thumb{background-color:#f9fafd;background-size:cover;border-radius:4px;background-repeat:no-repeat;flex:0 0 56px;height:56px;width:56px;transition:border-color .1s}'],encapsulation:2,changeDetection:0}),rw),pw=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},uw=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function dw(e,t){if(1&e){var n=j.Wb();j.Vb(0,"div",2),j.cc("click",(function(){return j.xc(n),j.gc().handleCloseClick()})),j.Ub()}}function gw(e,t){1&e&&(j.Vb(0,"span"),j.Kc(1,"Hide Labels"),j.Ub())}function hw(e,t){1&e&&(j.Vb(0,"span"),j.Kc(1,"Show Labels"),j.Ub())}function fw(e,t){if(1&e){var n=j.Wb();j.Vb(0,"app-view-column",3),j.Vb(1,"nav",4),j.Vb(2,"app-view-panel",5),j.Qb(3,"app-view-logo"),j.Ub(),j.Vb(4,"app-view-panel",5),j.Vb(5,"button",6),j.cc("click",(function(){return j.xc(n),j.gc().handleCloseClick()})),j.Kc(6,"Close"),j.Ub(),j.Ub(),j.Vb(7,"app-view-panel",5),j.Vb(8,"button",6),j.cc("click",(function(){return j.xc(n),j.gc().handleToggleToolbar("tools")})),j.Qb(9,"app-icon",7),j.Kc(10," Open Explore Tools "),j.Ub(),j.Vb(11,"button",6),j.cc("click",(function(){return j.xc(n),j.gc().handleToggleToolbar("media")})),j.Qb(12,"app-icon",8),j.Kc(13," Open Media Controls "),j.Ub(),j.Vb(14,"button",6),j.cc("click",(function(){return j.xc(n),j.gc().handleSearchClick()})),j.Qb(15,"app-icon",9),j.Kc(16," Search Anatomy "),j.Ub(),j.Ub(),j.Vb(17,"app-view-panel",5),j.Vb(18,"button",6),j.cc("click",(function(){return j.xc(n),j.gc().handleFullscreenClick()})),j.Qb(19,"app-icon",10),j.Kc(20," Enter Fullscreen "),j.Ub(),j.Ub(),j.Vb(21,"app-view-panel",5),j.Vb(22,"button",6),j.cc("click",(function(){return j.xc(n),j.gc().handleToggleLabelsClick()})),j.Qb(23,"app-icon",11),j.Ic(24,gw,2,0,"span",12),j.hc(25,"async"),j.Ic(26,hw,2,0,"span",12),j.hc(27,"async"),j.Ub(),j.Ub(),j.Vb(28,"app-view-panel",5),j.Vb(29,"button",13),j.cc("click",(function(){return j.xc(n),j.gc().handleTutorialClick()})),j.hc(30,"async"),j.Kc(31," Launch Tutorial "),j.Ub(),j.Vb(32,"button",6),j.cc("click",(function(){return j.xc(n),j.gc().handleHelpBasicsClick()})),j.Kc(33,"3D Navigation Basics"),j.Ub(),j.Vb(34,"button",6),j.cc("click",(function(){return j.xc(n),j.gc().handleHelpShortcutsClick()})),j.Kc(35,"Keyboard Shortcuts"),j.Ub(),j.Ub(),j.Ub(),j.Ub()}if(2&e){var i,o=j.gc();j.lc("@slideInOut",void 0),j.Db(2),j.lc("showHeader",!1),j.Db(2),j.lc("showHeader",!1),j.Db(3),j.lc("showHeader",!1),j.Db(10),j.lc("showHeader",!1),j.Db(4),j.lc("showHeader",!1),j.Db(3),j.lc("ngIf",j.ic(25,10,o.showLabels$)),j.Db(2),j.lc("ngIf",!j.ic(27,12,o.showLabels$)),j.Db(2),j.lc("showHeader",!1),j.Db(1),j.lc("disabled",!(null!=(i=j.ic(30,14,o.selectedChapterReady$))&&i.model))}}var bw,mw=((bw=function(){function e(t,n){y(this,e),this.store=t,this.viewService=n}return v(e,[{key:"ngOnInit",value:function(){}},{key:"handleCloseClick",value:function(){this.store.dispatch(new _.ToggleMenu(!1))}},{key:"handleToggleLabelsClick",value:function(){this.viewService.toggleLabels()}},{key:"handleFullscreenClick",value:function(){this.handleCloseClick(),Nr.toggleFullscreen()}},{key:"handleNewTabClick",value:function(){this.handleCloseClick(),this.viewService.openInNewTab()}},{key:"handleSearchClick",value:function(){this.handleCloseClick(),this.viewService.toggleSearch()}},{key:"handleTutorialClick",value:function(){this.handleCloseClick(),this.viewService.toggleTutorial(!0)}},{key:"handleHelpBasicsClick",value:function(){this.handleCloseClick(),this.viewService.toggleHelp(ee.Basics)}},{key:"handleHelpShortcutsClick",value:function(){this.handleCloseClick(),this.viewService.toggleHelp(ee.Shortcuts)}},{key:"handleToggleToolbar",value:function(e){this.handleCloseClick();var t=this.store.selectSnapshot(hs.getUI);t.media.status=ba.Hide,t.tools.status=ba.Hide,t.toolbar.status=ba.Hide,t[e].status=ba.Show,this.store.dispatch(new _.SetUI(t))}}]),e}()).\u0275fac=function(e){return new(e||bw)(j.Pb(L.g),j.Pb(Wp))},bw.\u0275cmp=j.Jb({type:bw,selectors:[["app-view-menu-column"]],decls:4,vars:6,consts:[["class","view-menu-scrim",3,"click",4,"ngIf"],["placement","right","class","view-menu-column",4,"ngIf"],[1,"view-menu-scrim",3,"click"],["placement","right",1,"view-menu-column"],["app-view-list-container",""],["padding","dense",3,"showHeader"],["app-view-list-item","",3,"click"],["icon","pen",1,"mr-3"],["icon","play",1,"mr-3"],["icon","search",1,"mr-3"],["icon","expand",1,"mr-3"],["icon","tag",1,"mr-3"],[4,"ngIf"],["app-view-list-item","",3,"disabled","click"]],template:function(e,t){1&e&&(j.Ic(0,dw,1,0,"div",0),j.hc(1,"async"),j.Ic(2,fw,36,16,"app-view-column",1),j.hc(3,"async")),2&e&&(j.lc("ngIf",j.ic(1,2,t.menuOpen$)),j.Db(2),j.lc("ngIf",j.ic(3,4,t.menuOpen$)))},directives:[we.l,ZO,XO,hb,aw,lw,vp],pipes:[we.b],styles:[".view-menu-column[_ngcontent-%COMP%]{position:absolute;top:0;right:0;z-index:10000;height:100%}.view-menu-scrim[_ngcontent-%COMP%]{background:rgba(0,0,0,.2);display:flex;position:fixed;justify-content:center;align-items:center;top:0;bottom:0;left:0;right:0;transition:background-color .25s,opacity .25s;z-index:10000}.view-menu-scrim[_ngcontent-%COMP%]:hover{opacity:1;cursor:pointer;background:rgba(0,0,0,.2)}"],data:{animation:[Object(du.n)("slideInOut",[Object(du.m)(":enter",[Object(du.l)({transform:"translateX(320px)"}),Object(du.e)("200ms ease-out",Object(du.l)({transform:"*"}))]),Object(du.m)(":leave",[Object(du.e)("200ms",Object(du.l)({transform:"translateX(320px)"}))])])]},changeDetection:0}),pw([Object(L.d)(vs.getSelectedChapterReadyState),uw("design:type",J.a)],bw.prototype,"selectedChapterReady$",void 0),pw([Object(L.d)(hs.getMenuOpen),uw("design:type",J.a)],bw.prototype,"menuOpen$",void 0),pw([Object(L.d)(hs.getCanTouch),uw("design:type",J.a)],bw.prototype,"canTouch$",void 0),pw([Object(L.d)(zs.getShowLabels),uw("design:type",J.a)],bw.prototype,"showLabels$",void 0),bw),vw=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},yw=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function xw(e,t){if(1&e){var n=j.Wb();j.Vb(0,"div",1),j.cc("click",(function(){return j.xc(n),j.gc().handleToggle()}))("keyup.enter",(function(){return j.xc(n),j.gc().handleToggle()})),j.Qb(1,"app-icon",2),j.Ub()}if(2&e){var i=j.gc();j.lc("@show",void 0)("matTooltip",i.isIn?"Open Info Panel":"Close Info Panel"),j.Eb("aria-label",i.isIn?"Open Info Panel":"Close Info Panel")("aria-expanded",!i.isIn),j.Db(1),j.lc("icon",i.isIn?"caret-right":"caret-left")}}var Ow,ww,kw,Cw=((Ow=function(){function e(t,n,i,o){y(this,e),this.viewService=t,this.layoutService=n,this.changeDetectorRef=i,this.store=o,this.ngUnsubscribe=new Z.a,this.isIn=!1,this.columnToggleVisible=!1}return v(e,[{key:"ngOnInit",value:function(){var e=this;Object(zc.b)(this.chapter$,this.layout$).pipe(Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){var n=d(t,2),i=(n[0],n[1]);e.isIn=i.column.status===ba.Collapse,e.columnToggleVisible=e.layoutService.isVisible(nl.ColumnToggle),e.changeDetectorRef.markForCheck()}))}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"isVisible",value:function(){return this.layoutService.isVisible(nl.ColumnToggle)}},{key:"handleToggle",value:function(){this.viewService.toggleColumn(),this.viewService.toggleSearch(null,!1),this.viewService.toggleNodeInfo(!1),this.viewService.toggleLabelInfo(!1),this.changeDetectorRef.markForCheck()}}]),e}()).\u0275fac=function(e){return new(e||Ow)(j.Pb(Wp),j.Pb(pl),j.Pb(j.i),j.Pb(L.g))},Ow.\u0275cmp=j.Jb({type:Ow,selectors:[["app-view-column-toggle"]],decls:1,vars:1,consts:[["class","view-column-toggle","data-test","viewInformationPanel","role","button","tabindex","0","matTooltipPosition","right",3,"matTooltip","click","keyup.enter",4,"ngIf"],["data-test","viewInformationPanel","role","button","tabindex","0","matTooltipPosition","right",1,"view-column-toggle",3,"matTooltip","click","keyup.enter"],[3,"icon"]],template:function(e,t){1&e&&j.Ic(0,xw,2,5,"div",0),2&e&&j.lc("ngIf",t.columnToggleVisible)},directives:[we.l,Lg.c,vp],styles:[".view-column-toggle{color:#131c2a;background:hsla(0,0%,100%,.8);box-shadow:1px -1px 2px 0 rgba(28,42,63,.1),0 1px 2px 0 rgba(28,42,63,.3);border-radius:0 4px 4px 0;display:flex;justify-content:center;align-items:center;width:24px;height:48px}.view-column-toggle:hover{background-color:#eaeff5;cursor:pointer}"],encapsulation:2,data:{animation:[Object(du.n)("show",[Object(du.m)(":enter",[Object(du.l)({opacity:0,transform:"translateX(-32px)"}),Object(du.e)("300ms ease-in-out",Object(du.l)({opacity:1,transform:"*"}))]),Object(du.m)(":leave",[Object(du.e)("300ms ease-in-out",Object(du.l)({transform:"translateX(-32px)",opacity:0}))])])]},changeDetection:0}),vw([Object(L.d)(hs.getUI),yw("design:type",J.a)],Ow.prototype,"layout$",void 0),vw([Object(L.d)(vs.getSelectedChapter),yw("design:type",J.a)],Ow.prototype,"chapter$",void 0),Ow);function Sw(e,t){if(1&e&&(j.Vb(0,"div",7),j.Vb(1,"div",8),j.Qb(2,"app-icon",9),j.Ub(),j.Ub()),2&e){var n=j.gc(2);j.Db(2),j.lc("icon",n.icon)}}function _w(e,t){if(1&e&&(j.Vb(0,"h3",10),j.Kc(1),j.Ub()),2&e){var n=j.gc(2);j.Db(1),j.Lc(n.title)}}function jw(e,t){if(1&e){var n=j.Wb();j.Vb(0,"button",11),j.cc("click",(function(){return j.xc(n),j.gc(2).handleDismissClicked()})),j.Qb(1,"app-icon",12),j.Ub()}}function Pw(e,t){if(1&e&&(j.Vb(0,"div",1),j.Vb(1,"div",2),j.Ic(2,Sw,3,1,"div",3),j.Vb(3,"div",4),j.Ic(4,_w,2,1,"h3",5),j.Vb(5,"p"),j.jc(6),j.Ub(),j.Ub(),j.Ub(),j.Ic(7,jw,2,0,"button",6),j.Ub()),2&e){var n=j.gc();j.Hb("toggle--message","message"===n.type)("toggle--error","error"===n.type)("toggle--notification","notification"===n.type)("toggle--warning","warning"===n.type)("toggle--rounded","rounded"===n.toggleStyle)("toggle--light","light"===n.theme)("toggle--dark","dark"===n.theme)("toggle--left","left"===n.toggleAlign)("toggle--center","center"===n.toggleAlign),j.lc("@show",void 0),j.Db(2),j.lc("ngIf",n.icon),j.Db(2),j.lc("ngIf",n.title),j.Db(3),j.lc("ngIf",n.dismiss)}}(kw=ww||(ww={})).slideTransition=Object(du.g)([Object(du.l)({transform:"translateY({{ from }}%)",opacity:0}),Object(du.e)("{{ duration }}ms ease-out",Object(du.l)({transform:"translateY({{ to }})",opacity:1}))]),kw.fadeIn=Object(du.g)([Object(du.l)({opacity:0}),Object(du.e)("{{ duration }}ms ease-out",Object(du.l)({opacity:1}))]),kw.fadeOut=Object(du.g)([Object(du.l)({opacity:"*"}),Object(du.e)("{{ duration }}ms ease-in",Object(du.l)({opacity:0}))]);var Mw,Iw=["*"],zw=((Mw=function(){function e(t){y(this,e),this.changeRef=t,this.type="message",this.theme="light",this.toggleAlign="left",this.showDelay=0,this.hideDelay=5e3,this.dismiss=!1,this.toggleStyle="rounded",this.handleDismiss=new Z.a,this._shown=!0,this.shownSubject=new Z.a,this.ngUnsubscribe=new Z.a}return v(e,[{key:"shown",get:function(){return this._shown},set:function(e){this._shown!==e&&(this._shown=e,this.shownSubject.next(e),this.changeRef.markForCheck())}},{key:"ngOnInit",value:function(){this.initViewShownListeners()}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"handleDismissClicked",value:function(){this.handleDismiss.next()}},{key:"initViewShownListeners",value:function(){var e=this;this.shownSubject.pipe(Object(Y.a)((function(){return e.hideDelay>0})),Object(Gp.a)(this.hideDelay),Object(Y.a)((function(e){return e})),Object(X.a)(this.ngUnsubscribe)).subscribe((function(){e._shown=!1,e.changeRef.markForCheck()}))}}]),e}()).\u0275fac=function(e){return new(e||Mw)(j.Pb(j.i))},Mw.\u0275cmp=j.Jb({type:Mw,selectors:[["app-message-toggle"]],inputs:{type:"type",theme:"theme",toggleAlign:"toggleAlign",icon:"icon",title:"title",showDelay:"showDelay",hideDelay:"hideDelay",dismiss:"dismiss",toggleStyle:"toggleStyle",shown:"shown"},outputs:{handleDismiss:"handleDismiss"},ngContentSelectors:Iw,decls:1,vars:1,consts:[["class","toggle flex flex-row items-start justify-between",3,"toggle--message","toggle--error","toggle--notification","toggle--warning","toggle--rounded","toggle--light","toggle--dark","toggle--left","toggle--center",4,"ngIf"],[1,"toggle","flex","flex-row","items-start","justify-between"],[1,"toggle__wrapper","flex","flex-row","flex-auto"],["class","mr-3",4,"ngIf"],[1,"toggle__content"],["class","text-semibold mb-1",4,"ngIf"],["class","toggle__icon toggle__dismiss",3,"click",4,"ngIf"],[1,"mr-3"],[1,"toggle__icon"],[3,"icon"],[1,"text-semibold","mb-1"],[1,"toggle__icon","toggle__dismiss",3,"click"],["icon","times"]],template:function(e,t){1&e&&(j.kc(),j.Ic(0,Pw,8,22,"div",0)),2&e&&j.lc("ngIf",t.shown)},directives:[we.l,vp],styles:[".text-8{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-28{font-size:28px;letter-spacing:.7px;line-height:1.4em}.text-28.text-uppercase{font-size:28px;letter-spacing:1.68px;line-height:1.25em;text-transform:uppercase}.text-header{font-weight:700}.text--code{font-family:Courier New,Courier,monospace}.text-uppercase{text-transform:uppercase}.text-xlight{font-weight:200}.text-light{font-weight:300}.text-medium{font-weight:500}.text-semibold{font-weight:600}.text-bold{font-weight:700}.text-underline{text-decoration:underline}.text-italic{font-style:italic}.text-bright{color:#fff}.text-dim{color:#96a8c0}.text-error{color:#ed4758}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.text-ellipsis{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link,.text-link:visited{color:inherit;cursor:pointer}.text-link:not(.text-underline),.text-link:visited:not(.text-underline){text-decoration:none}.text-success{color:#38de38}.text-danger{color:#de3535}.text-info{color:#2d72dc}.text-nowrap{white-space:nowrap}.text-pre-line{white-space:pre-line}:root{--message-toggle-color:#1c2a3f;--message-toggle-background-color:#f0f8ff;--message-toggle-icon-color:#2d72dc}.toggle{padding:16px;box-sizing:border-box;font-size:13px;line-height:20px;color:var(--message-toggle-color);background-color:var(--message-toggle-background-color)}.toggle--rounded{border-radius:4px}.toggle__icon{display:flex;flex-direction:column;align-items:center;justify-content:center;margin-top:1px;color:#fff;font-size:16px;background:none;border:none;color:var(--message-toggle-icon-color)}.toggle__content{padding:0 2px;word-break:break-word}.toggle__dismiss{font-size:14px;color:var(--message-toggle-color)}.toggle--left .toggle__content{flex:1 1 auto}.toggle--center .toggle__wrapper{justify-content:center}.toggle.toggle--message{--message-toggle-color:#1c2a3f;--message-toggle-background-color:#f0fff0;--message-toggle-icon-color:#33cd54}.toggle.toggle--notification{--message-toggle-color:#1c2a3f;--message-toggle-background-color:#f0f8ff;--message-toggle-icon-color:#2d72dc}.toggle.toggle--warning{--message-toggle-color:#1c2a3f;--message-toggle-background-color:#fffcf0;--message-toggle-icon-color:#ffb92e}.toggle.toggle--error{--message-toggle-color:#1c2a3f;--message-toggle-background-color:#fff3f0;--message-toggle-icon-color:#f44336}.toggle--dark.toggle--message{--message-toggle-background-color:#e3ffe5}.toggle--dark.toggle--notification{--message-toggle-background-color:#d6ecff}.toggle--dark.toggle--warning{--message-toggle-background-color:#fff6d1}.toggle--dark.toggle--error{--message-toggle-background-color:#ffe2db}"],encapsulation:2,data:{animation:[Object(du.n)("show",[Object(du.m)(":enter",[Object(du.o)(ww.fadeIn,{params:{duration:300}})]),Object(du.m)(":leave",[Object(du.o)(ww.fadeOut,{params:{duration:300}})])])]},changeDetection:0}),Mw);function Tw(e,t){if(1&e){var n=j.Wb();j.Vb(0,"div",1),j.Vb(1,"app-message-toggle",2),j.cc("handleDismiss",(function(){return j.xc(n),j.gc().handleDismiss()})),j.Vb(2,"div"),j.Kc(3," This model appears to be performing slowly on your device. For an optimal experience, please switch to a different device or try another model. "),j.Ub(),j.Ub(),j.Ub()}2&e&&(j.Db(1),j.lc("dismiss",!0))}var Uw,Dw,Lw,Ew,Fw,Aw,Rw,Vw,Nw,Bw=[],Hw=((Aw=function(){function e(t,n){y(this,e),this.storageService=t,this.changeRef=n,this.shown=!1,this.sampling=!1}return v(e,[{key:"ngOnInit",value:function(){this.storageService.getLocalItem(ns.Iphone12Warning)||this.testDevices()}},{key:"ngOnDestroy",value:function(){this.sampling=!1}},{key:"testDevices",value:function(){var e=window.matchMedia("only screen and (device-width: 390px) and (device-height: 844px) and (-webkit-device-pixel-ratio: 3)"),t=window.matchMedia("only screen and (device-width: 428px) and (device-height: 926px) and (-webkit-device-pixel-ratio: 3)"),n=window.matchMedia("only screen and (device-width: 820px) and (device-height: 1180px) and (-webkit-device-pixel-ratio: 2)"),i=e.matches||t.matches||n.matches,o=/iPhone|iPad/.test(navigator.userAgent),r=/OS\s14/.test(navigator.userAgent);i&&o&&r&&this.startFrameSampling()}},{key:"startFrameSampling",value:function(){var e=this;this.sampling=!0,Uw=0,Dw=Date.now(),requestAnimationFrame((function t(){e.frame()?(e.shown=!0,e.changeRef.markForCheck()):e.sampling&&requestAnimationFrame(t)}))}},{key:"frame",value:function(){Uw++;var e=Date.now();if(e>=Dw+500){var t=Math.floor(500*Uw/(e-Dw)*2);if(Bw.push(t),Bw.length>3&&Bw.shift(),3===Bw.length&&(Bw[0]+Bw[1]+Bw[2])/3<10)return!0;Dw=e,Uw=0}}},{key:"handleDismiss",value:function(){this.shown=!1,this.changeRef.markForCheck(),this.storageService.setLocalItem(ns.Iphone12Warning,!0)}}]),e}()).\u0275fac=function(e){return new(e||Aw)(j.Pb(as),j.Pb(j.i))},Aw.\u0275cmp=j.Jb({type:Aw,selectors:[["app-view-iphone12-warning"]],decls:1,vars:1,consts:[["class","warning",4,"ngIf"],[1,"warning"],["type","warning","toggleStyle","flat","icon","info-circle",3,"dismiss","handleDismiss"]],template:function(e,t){1&e&&j.Ic(0,Tw,4,1,"div",0),2&e&&j.lc("ngIf",t.shown)},directives:[we.l,zw],styles:[".warning[_ngcontent-%COMP%]{position:fixed;top:0;left:0;right:0;z-index:1002}"],changeDetection:0}),Aw),Qw=((Fw=function(){function e(){y(this,e)}return v(e,[{key:"supportsWebGl",value:function(){var e=document.createElement("canvas"),t=e.getContext("webgl")||e.getContext("experimental-webgl");return t&&t instanceof WebGLRenderingContext}},{key:"isHoverSupported",value:function(){return window.matchMedia("(hover: hover)").matches}}]),e}()).\u0275fac=function(e){return new(e||Fw)},Fw.\u0275prov=j.Lb({token:Fw,factory:Fw.\u0275fac,providedIn:"root"}),Fw),qw=((Ew=function(){function e(t,n){y(this,e),this.el=t,this.compatibilityService=n}return v(e,[{key:"ngAfterContentInit",value:function(){var e=this;this.compatibilityService.isHoverSupported()&&setTimeout((function(){e.el.nativeElement.focus()}),0)}}]),e}()).\u0275fac=function(e){return new(e||Ew)(j.Pb(j.m),j.Pb(Qw))},Ew.\u0275dir=j.Kb({type:Ew,selectors:[["input","appAutoFocus",""]]}),Ew),$w=((Lw=function(){function e(){y(this,e)}return v(e,[{key:"onClick",value:function(e,t){t.select()}}]),e}()).\u0275fac=function(e){return new(e||Lw)},Lw.\u0275dir=j.Kb({type:Lw,selectors:[["","appSelectOnFocus",""]],hostBindings:function(e,t){1&e&&j.cc("click",(function(e){return t.onClick(e,e.target)}))}}),Lw),Ww=r("C9yA"),Kw=function e(){y(this,e)},Gw=function e(){y(this,e)},Zw=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},Jw=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Xw={currentRecipe:Mo,brushMode:(Vw={},Vw[Vw.Modify=0]="Modify",Vw[Vw.Replace=1]="Replace",Vw).Replace,storyRecipes:{},recentRecipes:[],uniqueStoryRecipes:[],palettes:[]},Yw=((Nw=Rw=function(){function e(t){y(this,e),this.storageService=t}return v(e,[{key:"setCurrentRecipe",value:function(e,t){var n=t.colorRecipe;e.patchState({currentRecipe:n})}},{key:"setBrushMode",value:function(e,t){e.patchState({brushMode:t.brushMode})}},{key:"clearCurrentRecipe",value:function(e,t){e.patchState({currentRecipe:null})}},{key:"resetPaint",value:function(e,t){e.setState(Xw)}},{key:"addRecentRecipe",value:function(e,t){var n=e.getState().recentRecipes;n.some((function(e){return zo.isEqual(e,t.recipe)}))||(n.splice(0,0,t.recipe),n.length>14&&(n=n.slice(0,14)),this.storageService.setLocalItem(ns.RecentRecipes,n),e.patchState({recentRecipes:p(n)}))}},{key:"setRecentRecipes",value:function(e,t){var n=Object(ie.isNil)(t.recipes)?[]:p(t.recipes);e.patchState({recentRecipes:n}),this.storageService.setLocalItem(ns.RecentRecipes,n)}},{key:"setStoryRecipesForChapter",value:function(e,t){var n=zo.generateUniqueRecipes(p(t.recipes)),i=e.getState().storyRecipes;i[t.chapterId]=Object(ie.isNil)(n)?[]:p(n),e.patchState({storyRecipes:i});var o=Object.values(i).reduce((function(e,t){return[].concat(p(e),p(t))}),[]);(o=zo.generateUniqueRecipes(o)).sort(zo.compare),e.patchState({uniqueStoryRecipes:o})}},{key:"resetStoryRecipes",value:function(e,t){e.patchState({storyRecipes:{}})}},{key:"addPalette",value:function(e,t){t.palette.id=qi.idWithPrefix("palette");var n=[].concat(p(e.getState().palettes),[t.palette]);e.dispatch(new ld(n))}},{key:"updatePalette",value:function(e,t){var n=e.getState().palettes,i=n.findIndex((function(e){return e.id===t.palette.id}));i>=0&&(n[i]=Object.assign({},t.palette)),e.dispatch(new ld(n))}},{key:"removePalette",value:function(e,t){var n=p(e.getState().palettes.filter((function(e){return e.id!==t.paletteId})));e.dispatch(new ld(n))}},{key:"setPalettes",value:function(e,t){var n=Object(ie.cloneDeep)(t.palettes?p(t.palettes):[]);e.patchState({palettes:n}),localStorage.setItem(ns.PaintPalettes,JSON.stringify(n))}},{key:"addRecipeToPalette",value:function(e,t){var n=e.getState().palettes,i=n.findIndex((function(e){return e.id===t.paletteId}));i>=0&&n[i].recipes.push(t.recipe),e.dispatch(new ld(n))}},{key:"togglePalette",value:function(e,t){var n=e.getState().palettes,i=n.findIndex((function(e){return e.id===t.paletteId}));i>=0&&(n[i].open=Object(ie.isNil)(t.open)?!n[i].open:t.open,e.dispatch(new ld(n)))}},{key:"ngxsOnInit",value:function(e){}}],[{key:"getCurrentRecipe",value:function(e){return e.currentRecipe}},{key:"getCurrentRecipeForEngine",value:function(e){return ko.toEngine(e.currentRecipe)}},{key:"getPaintBrushMode",value:function(e){return e.brushMode}},{key:"getRecentRecipes",value:function(e){return e.recentRecipes}},{key:"getStoryRecipes",value:function(e){return e.storyRecipes}},{key:"getUniqueStoryRecipes",value:function(e){return e.uniqueStoryRecipes}},{key:"getPalettes",value:function(e){return e.palettes}},{key:"getCurrentChapterRecipes",value:function(e,t){return e.storyRecipes[t.selectedChapter]}},{key:"getChapterRecipes",value:function(e){return Object(L.h)([Rw],(function(t){return t.storyRecipes[e]}))}}]),e}()).\u0275fac=function(e){return new(e||Nw)(j.Zb(as))},Nw.\u0275prov=j.Lb({token:Nw,factory:Nw.\u0275fac}),Zw([Object(L.a)(Xu),Jw("design:type",Function),Jw("design:paramtypes",[Object,Xu]),Jw("design:returntype",void 0)],Nw.prototype,"setCurrentRecipe",null),Zw([Object(L.a)(Yu),Jw("design:type",Function),Jw("design:paramtypes",[Object,Yu]),Jw("design:returntype",void 0)],Nw.prototype,"setBrushMode",null),Zw([Object(L.a)(ed),Jw("design:type",Function),Jw("design:paramtypes",[Object,ed]),Jw("design:returntype",void 0)],Nw.prototype,"clearCurrentRecipe",null),Zw([Object(L.a)(td),Jw("design:type",Function),Jw("design:paramtypes",[Object,td]),Jw("design:returntype",void 0)],Nw.prototype,"resetPaint",null),Zw([Object(L.a)(nd),Jw("design:type",Function),Jw("design:paramtypes",[Object,nd]),Jw("design:returntype",void 0)],Nw.prototype,"addRecentRecipe",null),Zw([Object(L.a)(id),Jw("design:type",Function),Jw("design:paramtypes",[Object,id]),Jw("design:returntype",void 0)],Nw.prototype,"setRecentRecipes",null),Zw([Object(L.a)(rd),Jw("design:type",Function),Jw("design:paramtypes",[Object,rd]),Jw("design:returntype",void 0)],Nw.prototype,"setStoryRecipesForChapter",null),Zw([Object(L.a)(od),Jw("design:type",Function),Jw("design:paramtypes",[Object,od]),Jw("design:returntype",void 0)],Nw.prototype,"resetStoryRecipes",null),Zw([Object(L.a)(ad),Jw("design:type",Function),Jw("design:paramtypes",[Object,ad]),Jw("design:returntype",void 0)],Nw.prototype,"addPalette",null),Zw([Object(L.a)(cd),Jw("design:type",Function),Jw("design:paramtypes",[Object,cd]),Jw("design:returntype",void 0)],Nw.prototype,"updatePalette",null),Zw([Object(L.a)(sd),Jw("design:type",Function),Jw("design:paramtypes",[Object,sd]),Jw("design:returntype",void 0)],Nw.prototype,"removePalette",null),Zw([Object(L.a)(ld),Jw("design:type",Function),Jw("design:paramtypes",[Object,ld]),Jw("design:returntype",void 0)],Nw.prototype,"setPalettes",null),Zw([Object(L.a)(pd),Jw("design:type",Function),Jw("design:paramtypes",[Object,pd]),Jw("design:returntype",void 0)],Nw.prototype,"addRecipeToPalette",null),Zw([Object(L.a)(ud),Jw("design:type",Function),Jw("design:paramtypes",[Object,ud]),Jw("design:returntype",void 0)],Nw.prototype,"togglePalette",null),Zw([Object(L.e)(),Jw("design:type",Function),Jw("design:paramtypes",[Gw]),Jw("design:returntype",void 0)],Nw,"getCurrentRecipe",null),Zw([Object(L.e)(),Jw("design:type",Function),Jw("design:paramtypes",[Gw]),Jw("design:returntype",void 0)],Nw,"getCurrentRecipeForEngine",null),Zw([Object(L.e)(),Jw("design:type",Function),Jw("design:paramtypes",[Gw]),Jw("design:returntype",void 0)],Nw,"getPaintBrushMode",null),Zw([Object(L.e)(),Jw("design:type",Function),Jw("design:paramtypes",[Gw]),Jw("design:returntype",void 0)],Nw,"getRecentRecipes",null),Zw([Object(L.e)(),Jw("design:type",Function),Jw("design:paramtypes",[Gw]),Jw("design:returntype",void 0)],Nw,"getStoryRecipes",null),Zw([Object(L.e)(),Jw("design:type",Function),Jw("design:paramtypes",[Gw]),Jw("design:returntype",void 0)],Nw,"getUniqueStoryRecipes",null),Zw([Object(L.e)(),Jw("design:type",Function),Jw("design:paramtypes",[Gw]),Jw("design:returntype",void 0)],Nw,"getPalettes",null),Zw([Object(L.e)([vs]),Jw("design:type",Function),Jw("design:paramtypes",[Gw,ti]),Jw("design:returntype",void 0)],Nw,"getCurrentChapterRecipes",null),Nw=Rw=Zw([Object(L.f)({name:"editPaint",defaults:Xw})],Nw)),ek=function e(t,n,i){y(this,e),this.label=t,this.width=n,this.height=i},tk=new ek("Don't Resize",-1,-1);new ek("Common (Mobile)",360,640),new ek("Common (Minimum)",300,300),new ek("Common (Publish Default)",700,550),new ek("iPhone X",375,812),new ek("iPad (Portrait)",768,1024),new ek("iPad (Landscape)",1024,768);var nk,ik=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},ok=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},rk={view:Cd.Chapter,showColumns:!0,showLeftColumn:!0,showRightColumn:!0,showHeader:!0,showFooter:!0,showTimelineEditor:!1,autoCapture:T.application!==P.Loft,record:!0,layerOrderMode:!1,showTreeNodeIds:!1,showRootNodes:!1,canvasSize:tk,canvasSettings:{emulateDrawer:!0,emulateColumn:!0}},ak=((nk=function(){function e(t){y(this,e),this.storageService=t}return v(e,[{key:"SetLayerOrderMode",value:function(e,t){e.patchState({layerOrderMode:t.layerOrderMode})}},{key:"ShowTreeNodeIds",value:function(e,t){var n=null!=t.show?t.show:!e.getState().showTreeNodeIds;e.patchState({showTreeNodeIds:n})}},{key:"showRootNodes",value:function(e,t){e.patchState({showRootNodes:t.show})}},{key:"setView",value:function(e,t){e.patchState({view:t.view})}},{key:"nextView",value:function(e,t){var n=e.getState().view,i=Object.values(Cd),o=i[i.indexOf(n)+1]||i[0];e.patchState({view:o})}},{key:"previousView",value:function(e,t){var n=e.getState().view,i=Object.values(Cd),o=i[i.indexOf(n)-1]||i[i.length-1];e.patchState({view:o})}},{key:"showColumns",value:function(e,t){e.patchState({showColumns:t.show})}},{key:"showColumn",value:function(e,t){switch(t.column){case"left":e.patchState({showLeftColumn:t.show});break;case"right":e.patchState({showRightColumn:t.show});break;case"header":e.patchState({showHeader:t.show});break;case"footer":e.patchState({showFooter:t.show})}}},{key:"showTimelineEditor",value:function(e,t){e.patchState({showTimelineEditor:t.show})}},{key:"resetEditPage",value:function(e,t){e.setState(rk),e.dispatch(new td)}},{key:"setCanvasSize",value:function(e,t){e.patchState({canvasSize:t.size})}},{key:"autoCapture",value:function(e,t){e.patchState({autoCapture:t.enable}),T.application===P.Studio&&this.storageService.setLocalItem(ns.AutoCapture,t.enable)}},{key:"ngxsOnInit",value:function(e){var t=this;setTimeout((function(){t.initAutoCapture(e)}))}},{key:"initAutoCapture",value:function(e){if(T.application===P.Studio){var t=this.storageService.getLocalJSON(ns.AutoCapture);"boolean"==typeof t&&e.patchState({autoCapture:t})}}}],[{key:"getView",value:function(e){return e.view}},{key:"getShowColumns",value:function(e){return e.showColumns}},{key:"getShowLeftColumn",value:function(e){return e.showLeftColumn}},{key:"getShowRightColumn",value:function(e){return e.showRightColumn}},{key:"getShowHeader",value:function(e){return e.showHeader}},{key:"getShowFooter",value:function(e){return e.showFooter}},{key:"getShowTimelineEditor",value:function(e){return e.showTimelineEditor}},{key:"getRecord",value:function(e){return e.record}},{key:"getLayerOrderMode",value:function(e){return e.layerOrderMode}},{key:"getShowTreeNodeIds",value:function(e){return e.showTreeNodeIds}},{key:"getCanvasSize",value:function(e){return e.canvasSize}},{key:"getCanvasSettings",value:function(e){return e.canvasSettings}},{key:"getAutoCapture",value:function(e){return e.autoCapture}},{key:"getShowRootNodes",value:function(e){return e.showRootNodes}}]),e}()).\u0275fac=function(e){return new(e||nk)(j.Zb(as))},nk.\u0275prov=j.Lb({token:nk,factory:nk.\u0275fac}),ik([Object(L.a)(yd),ok("design:type",Function),ok("design:paramtypes",[Object,yd]),ok("design:returntype",void 0)],nk.prototype,"SetLayerOrderMode",null),ik([Object(L.a)(xd),ok("design:type",Function),ok("design:paramtypes",[Object,xd]),ok("design:returntype",void 0)],nk.prototype,"ShowTreeNodeIds",null),ik([Object(L.a)(Od),ok("design:type",Function),ok("design:paramtypes",[Object,Od]),ok("design:returntype",void 0)],nk.prototype,"showRootNodes",null),ik([Object(L.a)(dd),ok("design:type",Function),ok("design:paramtypes",[Object,dd]),ok("design:returntype",void 0)],nk.prototype,"setView",null),ik([Object(L.a)(gd),ok("design:type",Function),ok("design:paramtypes",[Object,gd]),ok("design:returntype",void 0)],nk.prototype,"nextView",null),ik([Object(L.a)(hd),ok("design:type",Function),ok("design:paramtypes",[Object,gd]),ok("design:returntype",void 0)],nk.prototype,"previousView",null),ik([Object(L.a)(fd),ok("design:type",Function),ok("design:paramtypes",[Object,fd]),ok("design:returntype",void 0)],nk.prototype,"showColumns",null),ik([Object(L.a)(bd),ok("design:type",Function),ok("design:paramtypes",[Object,bd]),ok("design:returntype",void 0)],nk.prototype,"showColumn",null),ik([Object(L.a)(md),ok("design:type",Function),ok("design:paramtypes",[Object,md]),ok("design:returntype",void 0)],nk.prototype,"showTimelineEditor",null),ik([Object(L.a)(vd),ok("design:type",Function),ok("design:paramtypes",[Object,vd]),ok("design:returntype",void 0)],nk.prototype,"resetEditPage",null),ik([Object(L.a)(wd),ok("design:type",Function),ok("design:paramtypes",[Object,wd]),ok("design:returntype",void 0)],nk.prototype,"setCanvasSize",null),ik([Object(L.a)(kd),ok("design:type",Function),ok("design:paramtypes",[Object,kd]),ok("design:returntype",void 0)],nk.prototype,"autoCapture",null),ik([Object(L.e)(),ok("design:type",Function),ok("design:paramtypes",[Kw]),ok("design:returntype",void 0)],nk,"getView",null),ik([Object(L.e)(),ok("design:type",Function),ok("design:paramtypes",[Kw]),ok("design:returntype",void 0)],nk,"getShowColumns",null),ik([Object(L.e)(),ok("design:type",Function),ok("design:paramtypes",[Kw]),ok("design:returntype",void 0)],nk,"getShowLeftColumn",null),ik([Object(L.e)(),ok("design:type",Function),ok("design:paramtypes",[Kw]),ok("design:returntype",void 0)],nk,"getShowRightColumn",null),ik([Object(L.e)(),ok("design:type",Function),ok("design:paramtypes",[Kw]),ok("design:returntype",void 0)],nk,"getShowHeader",null),ik([Object(L.e)(),ok("design:type",Function),ok("design:paramtypes",[Kw]),ok("design:returntype",void 0)],nk,"getShowFooter",null),ik([Object(L.e)(),ok("design:type",Function),ok("design:paramtypes",[Kw]),ok("design:returntype",void 0)],nk,"getShowTimelineEditor",null),ik([Object(L.e)(),ok("design:type",Function),ok("design:paramtypes",[Kw]),ok("design:returntype",void 0)],nk,"getRecord",null),ik([Object(L.e)(),ok("design:type",Function),ok("design:paramtypes",[Kw]),ok("design:returntype",void 0)],nk,"getLayerOrderMode",null),ik([Object(L.e)(),ok("design:type",Function),ok("design:paramtypes",[Kw]),ok("design:returntype",void 0)],nk,"getShowTreeNodeIds",null),ik([Object(L.e)(),ok("design:type",Function),ok("design:paramtypes",[Kw]),ok("design:returntype",void 0)],nk,"getCanvasSize",null),ik([Object(L.e)(),ok("design:type",Function),ok("design:paramtypes",[Kw]),ok("design:returntype",void 0)],nk,"getCanvasSettings",null),ik([Object(L.e)(),ok("design:type",Function),ok("design:paramtypes",[Kw]),ok("design:returntype",void 0)],nk,"getAutoCapture",null),ik([Object(L.e)(),ok("design:type",Function),ok("design:paramtypes",[Kw]),ok("design:returntype",void 0)],nk,"getShowRootNodes",null),nk=ik([Object(L.f)({name:"edit",defaults:rk,children:[Yw]})],nk)),sk=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},ck=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function lk(e,t){if(1&e){var n=j.Wb();j.Vb(0,"button",9),j.cc("click",(function(){j.xc(n);var e=j.gc();return e.handleExpandClick(e.node,e.node.boolState.expanded)})),j.Qb(1,"app-icon",10),j.Ub()}if(2&e){var i=j.gc();j.lc("buttonTheme",i.theme),j.Eb("aria-label",i.node.boolState.expanded?"Collapse "+i.node.label:"Expand "+i.node.label)("aria-expanded",i.node.boolState.expanded),j.Db(1),j.Hb("rotate-45",i.node.boolState.expanded)}}function pk(e,t){if(1&e&&(j.Vb(0,"div",16),j.Kc(1),j.Ub()),2&e){var n=j.gc(2);j.Db(1),j.Mc(" ",n.shortId," ")}}var uk=function(e){return{"tree-node__label--padded":e}};function dk(e,t){if(1&e){var n=j.Wb();j.Vb(0,"div",11),j.cc("dblclick",(function(){return j.xc(n),j.gc().setEditLabelMode(!0)})),j.Vb(1,"div",12),j.Ic(2,pk,2,1,"div",13),j.hc(3,"async"),j.Vb(4,"div",14),j.Vb(5,"span",15),j.Kc(6,"Select"),j.Ub(),j.Kc(7),j.Ub(),j.Ub(),j.Ub()}if(2&e){var i=j.gc();j.lc("ngClass",j.nc(6,uk,!i.hasChildren&&i.nested)),j.Eb("aria-current",i.checked),j.Db(2),j.lc("ngIf",j.ic(3,4,i.showTreeNodeIds$)),j.Db(5),j.Mc(" ",i.node.label," ")}}function gk(e,t){if(1&e){var n=j.Wb();j.Vb(0,"input",17),j.cc("blur",(function(e){return j.xc(n),j.gc().handleObjectLabel(e)}))("keyup",(function(e){return j.xc(n),j.gc().handleObjectLabel(e)})),j.Ub()}if(2&e){var i=j.gc();j.lc("value",i.node.label)}}function hk(e,t){if(1&e){var n=j.Wb();j.Vb(0,"input",18),j.cc("change",(function(e){j.xc(n);var t=j.gc();return t.handleLayerOrder(e,t.node)})),j.Ub()}if(2&e){var i=j.gc();j.lc("value",i.node.numState.layer)}}var fk,bk=function(e,t,n,i){return{"tree-node--light":e,"tree-node--hidden":t,"tree-node--selected":n,"tree-node--unpickable":i}},mk=((fk=function(){function e(t,n,i,o,r){y(this,e),this.store=t,this.graphService=n,this.engineService=i,this.router=o,this.changeDetection=r,this.themeEnum=_d,this.isLoft="module"===T.exportType,this.nested=!0,this._theme=_d.Dark,this.checked=!1,this.hasChildren=!1,this.editLabelMode=!1,this.sanitizedID="",this.parentId="",this.shortId="",this.ngUnsubscribe=new Z.a}return v(e,[{key:"node",get:function(){return this._node},set:function(e){this._node=e,this.sanitizedID=this.graphService.sanitizeNodeID(this.node.id),this.checked=this.isNodeChecked(this.node.id);var t=this.node.id.split("-");2===t.length?(this.parentId=t[0],this.shortId=t[1]):(this.shortId=t[0],this.parentId=""),this.shortId=this.shortId.replace(/_/g," "),this.nested&&(this.hasChildren=Be.getSuccessors(this.graph,this.node.id).length>0),this.changeDetection.markForCheck()}},{key:"theme",get:function(){return this._theme},set:function(e){this._theme=e}},{key:"isNodeChecked",value:function(e){return this.store.selectSnapshot(jo.getNodes)[e].checked}},{key:"isNodeShown",value:function(e){return this.store.selectSnapshot(jo.getNodes)[e].shown}},{key:"ngOnInit",value:function(){var e=this;this.checkedNodesIds$.pipe(Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){e.checked=t.some((function(t){return t===e.node.id})),e.changeDetection.markForCheck()})),this.labelEditNode$.pipe(Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){e.editLabelMode=t===e.node})),this.isEditMode=this.router.url.indexOf("/edit")>=0}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"handleExpandClick",value:function(e,t){this.store.dispatch(t?new en(e):new Yt(e))}},{key:"handleNodeClick",value:function(e,t){e.shiftKey?this.checkNode(t):(this.setCheckedNodes(t),this.isFlyToNodeEnabled(t)&&this.store.dispatch(new Pt(t.id)),this.handleExpandClick(t,!t.boolState.expanded))}},{key:"toggleVisible",value:function(e,t){var n=void 0===t?!this.isNodeShown(e.id):t;this.store.dispatch(new Yi.UpdateNodesShown(n,[e.id])),this.changeDetection.markForCheck()}},{key:"handleLayerOrder",value:function(e,t){var n=parseInt(e.target.value,10);this.setLayerOrder(t,n)}},{key:"checkNode",value:function(e,t){var n=void 0===t?!this.isNodeChecked(e.id):t;this.store.dispatch(new Yi.UpdateNodesChecked(n,[e.id]))}},{key:"setCheckedNodes",value:function(e,t){this.store.dispatch(new Yi.UpdateNodesChecked(!1));var n=void 0===t?!this.isNodeChecked(e.id):t;this.store.dispatch(new Yi.UpdateNodesChecked(n,[e.id]))}},{key:"setLayerOrder",value:function(e,t){this.store.dispatch(new Qt([e],t)),this.changeDetection.markForCheck()}},{key:"handleObjectLabel",value:function(e){var t=e.target;e instanceof KeyboardEvent?("enter"===e.key.toLowerCase()&&(this.setLabel(t.value),this.setEditLabelMode(!1)),"escape"===e.key.toLowerCase()&&this.setEditLabelMode(!1)):e instanceof FocusEvent&&"blur"===e.type&&(this.setLabel(t.value),this.setEditLabelMode(!1))}},{key:"setLabel",value:function(e){this.node.label=e,this.store.dispatch(new qt(this.node.id,e))}},{key:"setEditLabelMode",value:function(e){T.application===P.Loft&&this.isEditMode&&this.store.dispatch(new on(e?this.node:null))}},{key:"isFlyToNodeEnabled",value:function(e){return!this.isEditMode&&(e.boolState.shown||this.engineService.getObjectLoaded(e.id))}}]),e}()).\u0275fac=function(e){return new(e||fk)(j.Pb(L.g),j.Pb(mn),j.Pb(Sn),j.Pb(te.e),j.Pb(j.i))},fk.\u0275cmp=j.Jb({type:fk,selectors:[["app-tree-nested-node"]],inputs:{graph:"graph",node:"node",nested:"nested",theme:"theme"},decls:10,vars:16,consts:[["data-test","treeNode",1,"tree-node",3,"ngClass","keyup.enter","click"],["app-button","","appEventFence","","buttonSize","xsmall","class","tree-node__button","data-test","treeNodeExpand",3,"buttonTheme","click",4,"ngIf"],["class","tree-node__label","tabindex","0","role","button",3,"ngClass","dblclick",4,"ngIf"],["type","text","appEventFence","","appAutoFocus","","data-test","treeNodeEditLabel","class","input",3,"value","blur","keyup",4,"ngIf"],["appEventFence","","type","text","data-test","treeNodeLayerOrder","class","input input--small tree-node__layer-order",3,"value","change",4,"ngIf"],["app-button","","buttonSize","xsmall","data-test","treeNodeVisible","tabindex","-1","aria-hidden","true","appEventFence","",1,"tree-node__visible",3,"buttonTheme","click"],["icon","eye","data-test","treeNodeVisibleTrue","size","xs",1,"text-14","tree-node__eye"],["icon","eye-slash","data-test","treeNodeVisibleFalse","size","xs",1,"text-14","tree-node__eye-slash"],["eventCategory","Search Node","appEventFence","",3,"theme","node"],["app-button","","appEventFence","","buttonSize","xsmall","data-test","treeNodeExpand",1,"tree-node__button",3,"buttonTheme","click"],["icon","caret-right",1,"inline-block","text-14"],["tabindex","0","role","button",1,"tree-node__label",3,"ngClass","dblclick"],[1,"flex","flex-column"],["data-test","treeNodeId","class","text-10 text-uppercase","style","opacity: 0.7",4,"ngIf"],["data-test","treeNodeLabel"],[1,"visually-hidden"],["data-test","treeNodeId",1,"text-10","text-uppercase",2,"opacity","0.7"],["type","text","appEventFence","","appAutoFocus","","data-test","treeNodeEditLabel",1,"input",3,"value","blur","keyup"],["appEventFence","","type","text","data-test","treeNodeLayerOrder",1,"input","input--small","tree-node__layer-order",3,"value","change"]],template:function(e,t){1&e&&(j.Vb(0,"div",0),j.cc("keyup.enter",(function(e){return t.handleNodeClick(e,t.node)}))("click",(function(e){return t.handleNodeClick(e,t.node)})),j.Ic(1,lk,2,5,"button",1),j.Ic(2,dk,8,8,"div",2),j.Ic(3,gk,1,1,"input",3),j.Ic(4,hk,1,1,"input",4),j.hc(5,"async"),j.Vb(6,"button",5),j.cc("click",(function(){return t.toggleVisible(t.node)})),j.Qb(7,"app-icon",6),j.Qb(8,"app-icon",7),j.Ub(),j.Qb(9,"app-node-actions",8),j.Ub()),2&e&&(j.lc("ngClass",j.qc(11,bk,t.theme===t.themeEnum.Light,!t.node.boolState.shown,t.checked,!t.node.boolState.pickable)),j.Eb("data-id",t.sanitizedID),j.Db(1),j.lc("ngIf",t.nested&&t.hasChildren),j.Db(1),j.lc("ngIf",!t.editLabelMode),j.Db(1),j.lc("ngIf",t.editLabelMode),j.Db(1),j.lc("ngIf",j.ic(5,9,t.layerOrderMode$)),j.Db(2),j.lc("buttonTheme",t.theme),j.Db(3),j.lc("theme",t.theme)("node",t.node))},directives:[we.i,we.l,Dd,Mu,vp,Zd,qw],pipes:[we.b],styles:[".text-8{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-28{font-size:28px;letter-spacing:.7px;line-height:1.4em}.text-28.text-uppercase{font-size:28px;letter-spacing:1.68px;line-height:1.25em;text-transform:uppercase}.text-header{font-weight:700}.text--code{font-family:Courier New,Courier,monospace}.text-uppercase{text-transform:uppercase}.text-xlight{font-weight:200}.text-light{font-weight:300}.text-medium{font-weight:500}.text-semibold{font-weight:600}.text-bold{font-weight:700}.text-underline{text-decoration:underline}.text-italic{font-style:italic}.text-bright{color:#fff}.text-dim{color:#96a8c0}.text-error{color:#ed4758}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.text-ellipsis{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link,.text-link:visited{color:inherit;cursor:pointer}.text-link:not(.text-underline),.text-link:visited:not(.text-underline){text-decoration:none}.text-success{color:#38de38}.text-danger{color:#de3535}.text-info{color:#2d72dc}.text-nowrap{white-space:nowrap}.text-pre-line{white-space:pre-line}:host{display:block}.tree-node{border-radius:4px;padding:4px;margin-bottom:4px;display:flex;align-items:center;height:100%;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;min-width:200px;transition:background-color .12s}.tree-node--light{padding-right:12px}.tree-node--light:focus{outline:2px solid #2d72dc!important;outline-offset:-2px;border-radius:4px}.tree-node--light .tree-node__label{color:#101823;font-size:13px;letter-spacing:.325px;line-height:1.4em}.tree-node--light.tree-node--selected{background:transparent;border-left-color:transparent}.tree-node--light.tree-node--selected .tree-node__label{color:#101823!important}.tree-node--light.tree-node--selected .tree-node__expand,.tree-node--light.tree-node--selected .tree-node__visible{color:#101823}.tree-node--light.tree-node--unpickable{border:none}.tree-node--light.tree-node--hidden .tree-node__label{color:#61779e}.tree-node--light .tree-node__expand,.tree-node--light .tree-node__visible{background-color:transparent;color:#96a8c0;border-radius:4px}.tree-node--selected{background-color:#2d72dc}.tree-node--selected .tree-node__label{color:#fff}.tree-node--unpickable{border:1px dashed #61779e}.tree-node--hidden .tree-node__expand,.tree-node--hidden .tree-node__label,.tree-node--hidden .tree-node__visible{color:#96a8c0}.tree-node--hidden .tree-node__visible{visibility:visible}.tree-node.tree-node--hidden.tree-node--selected .tree-node__expand,.tree-node.tree-node--hidden.tree-node--selected .tree-node__label,.tree-node.tree-node--hidden.tree-node--selected .tree-node__visible{color:#fff}.tree-node__label{font-size:12px;letter-spacing:.3px;line-height:1.4em;letter-spacing:.5px;font-weight:400;line-height:1.3em;color:#d7e0ea;padding:8px 4px 8px 12px;display:flex;align-items:center;flex:1 1 100%;min-height:28px}.tree-node__label--padded{padding-left:36px}.tree-node__button{display:flex;flex:0 0 24px;height:24px;justify-content:center;align-items:center;border:none}.tree-node__expand i{transition:transform .12s}.tree-node__expand--open app-icon{transform:rotate(45deg)}.tree-node .tree-node__expand+.tree-node__label{margin-left:-8px}.tree-node__expand,.tree-node__visible{border-radius:4px;color:#d7e0ea;display:flex;flex:0 0 24px;height:24px;justify-content:center;align-items:center;border:none}.tree-node__layer-order{font-size:10px;flex:0 0 56px;min-height:28px;height:28px;padding:4px;margin:2px;text-align:center}.tree-node .tree-node__eye,.tree-node .tree-node__eye-slash{display:none}.tree-node.tree-node--hidden .tree-node__eye-slash,.tree-node:not(.tree-node--hidden) .tree-node__eye{display:inline}@media (hover:hover){.tree-node__visible{visibility:hidden}.tree-node:hover{cursor:pointer}.tree-node:hover .tree-node__visible{visibility:visible}.tree-node:hover .tree-node__label{color:#fff}.tree-node--light:hover{background-color:#d6ecff}.tree-node--light:hover .tree-node__label{color:#101823}.tree-node--light.tree-node--selected{background-color:#d6ecff}.tree-node--light.tree-node--selected:hover{background-color:#bde0ff}.tree-node--light.tree-node--selected .tree-node__label{color:#101823}.tree-node--light.tree-node--selected .tree-node__expand:hover,.tree-node--light.tree-node--selected .tree-node__visible:hover,.tree-node--light .tree-node__expand:hover,.tree-node--light .tree-node__visible:hover{background-color:transparent;color:inherit}.tree-node__expand:hover,.tree-node__visible:hover{background-color:#1c2a3f;color:#fff;cursor:pointer}.tree-node--selected .tree-node__expand:hover,.tree-node--selected .tree-node__visible:hover{background-color:#2d72dc}.tree-node .tree-node__eye,.tree-node .tree-node__eye-slash{display:none}.tree-node.tree-node--hidden .tree-node__eye-slash,.tree-node:hover:not(.tree-node--hidden) .tree-node__eye{display:inline}}"],encapsulation:2,changeDetection:0}),sk([Object(L.d)(jo.getCheckedNodeIds),ck("design:type",J.a)],fk.prototype,"checkedNodesIds$",void 0),sk([Object(L.d)(ak.getLayerOrderMode),ck("design:type",J.a)],fk.prototype,"layerOrderMode$",void 0),sk([Object(L.d)(zs.getLabelEditNode),ck("design:type",J.a)],fk.prototype,"labelEditNode$",void 0),sk([Object(L.d)(ak.getShowTreeNodeIds),ck("design:type",J.a)],fk.prototype,"showTreeNodeIds$",void 0),fk);function vk(e,t){if(1&e){var n=j.Wb();j.Vb(0,"div",6),j.cc("click",(function(){j.xc(n);var e=j.gc(2).$implicit;return j.gc().handleExpandClick(e,!0)})),j.Ub()}if(2&e){var i=j.gc(2).$implicit;j.lc("title",i.label)}}function yk(e,t){if(1&e&&(j.Vb(0,"div",4),j.Ic(1,vk,1,1,"div",5),j.Qb(2,"app-tree-group",2),j.Ub()),2&e){var n=j.gc().$implicit,i=j.gc();j.Db(1),j.lc("ngIf",i.hasChildren(n)),j.Db(1),j.lc("graph",i.graph)("node",n)("theme",i.theme)}}var xk=function(e){return{"tree-group--light":e}};function Ok(e,t){if(1&e&&(j.Vb(0,"div",1),j.Qb(1,"app-tree-nested-node",2),j.Ic(2,yk,3,4,"div",3),j.Ub()),2&e){var n=t.$implicit,i=j.gc();j.lc("ngClass",j.nc(5,xk,i.theme===i.themeEnum.Light)),j.Db(1),j.lc("graph",i.graph)("node",n)("theme",i.theme),j.Db(1),j.lc("ngIf",n.boolState.expanded)}}var wk,kk,Ck=((wk=function(){function e(t,n){y(this,e),this.graphService=t,this.store=n,this.themeEnum=_d,this.graphSubject=new kp.a(null),this.theme=_d.Dark,this.nodes=[],this.ngUnsubscribe=new Z.a}return v(e,[{key:"graph",get:function(){return this._graph},set:function(e){e&&(this._graph=e,this.graphSubject.next(e))}},{key:"ngOnInit",value:function(){var e=this;this.graphSubject.pipe(Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){t&&e.getNodes()}))}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"getNodes",value:function(){var e=this.node?Be.getSuccessors(this.graph,this.node.id):Be.getRoots(this.graph);this.nodes=this.graphService.getNodes(this.graph,e)}},{key:"countChildren",value:function(e){return Be.getSuccessors(this.graph,e.id).length}},{key:"hasChildren",value:function(e){return this.countChildren(e)>0}},{key:"trackTreeNode",value:function(e,t){return t.id}},{key:"handleExpandClick",value:function(e,t){this.store.dispatch(t?new en(e):new Yt(e))}}]),e}()).\u0275fac=function(e){return new(e||wk)(j.Pb(mn),j.Pb(L.g))},wk.\u0275cmp=j.Jb({type:wk,selectors:[["app-tree-group"]],inputs:{graph:"graph",theme:"theme",node:"node"},decls:1,vars:2,consts:[["class","tree-group",3,"ngClass",4,"ngFor","ngForOf","ngForTrackBy"],[1,"tree-group",3,"ngClass"],[3,"graph","node","theme"],["class","tree-group__children",4,"ngIf"],[1,"tree-group__children"],["class","tree-group__collapse",3,"title","click",4,"ngIf"],[1,"tree-group__collapse",3,"title","click"]],template:function(e,t){1&e&&j.Ic(0,Ok,3,7,"div",0),2&e&&j.lc("ngForOf",t.nodes)("ngForTrackBy",t.trackTreeNode)},directives:[we.k,we.i,mk,we.l,wk],styles:['.text-8[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase[_ngcontent-%COMP%]{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase[_ngcontent-%COMP%]{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase[_ngcontent-%COMP%]{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase[_ngcontent-%COMP%]{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-28[_ngcontent-%COMP%]{font-size:28px;letter-spacing:.7px;line-height:1.4em}.text-28.text-uppercase[_ngcontent-%COMP%]{font-size:28px;letter-spacing:1.68px;line-height:1.25em;text-transform:uppercase}.text-header[_ngcontent-%COMP%]{font-weight:700}.text--code[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.text-xlight[_ngcontent-%COMP%]{font-weight:200}.text-light[_ngcontent-%COMP%]{font-weight:300}.text-medium[_ngcontent-%COMP%]{font-weight:500}.text-semibold[_ngcontent-%COMP%]{font-weight:600}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-underline[_ngcontent-%COMP%]{text-decoration:underline}.text-italic[_ngcontent-%COMP%]{font-style:italic}.text-bright[_ngcontent-%COMP%]{color:#fff}.text-dim[_ngcontent-%COMP%]{color:#96a8c0}.text-error[_ngcontent-%COMP%]{color:#ed4758}.text-left[_ngcontent-%COMP%]{text-align:left}.text-center[_ngcontent-%COMP%]{text-align:center}.text-right[_ngcontent-%COMP%]{text-align:right}.text-ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link[_ngcontent-%COMP%], .text-link[_ngcontent-%COMP%]:visited{color:inherit;cursor:pointer}.text-link[_ngcontent-%COMP%]:not(.text-underline), .text-link[_ngcontent-%COMP%]:visited:not(.text-underline){text-decoration:none}.text-success[_ngcontent-%COMP%]{color:#38de38}.text-danger[_ngcontent-%COMP%]{color:#de3535}.text-info[_ngcontent-%COMP%]{color:#2d72dc}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.text-pre-line[_ngcontent-%COMP%]{white-space:pre-line}.tree-group[_ngcontent-%COMP%]{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.tree-group--light[_ngcontent-%COMP%]   .tree-group__collapse[_ngcontent-%COMP%]:after{background:#eaeff5}.tree-group--light[_ngcontent-%COMP%]   .tree-group__collapse[_ngcontent-%COMP%]:hover{background:transparent}.tree-group--light[_ngcontent-%COMP%]   .tree-group__collapse[_ngcontent-%COMP%]:hover:after{background:#d7e0ea}.tree-group__children[_ngcontent-%COMP%]{padding-left:20px;position:relative}.tree-group__collapse[_ngcontent-%COMP%]{position:absolute;left:0;top:0;bottom:0;width:20px;z-index:1}.tree-group__collapse[_ngcontent-%COMP%]:after{content:" ";display:block;position:absolute;width:1px;left:10px;top:0;bottom:0;background:#1c2a3f}.tree-group__collapse[_ngcontent-%COMP%]:hover{cursor:pointer}.tree-group__collapse[_ngcontent-%COMP%]:hover:after{background:#283853}'],changeDetection:0}),wk),Sk=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},_k=((kk=function(){function e(t,n){y(this,e),this.store=t,this.graphService=n,this.theme=_d.Dark,this.ngUnsubscribe=new Z.a}return v(e,[{key:"ngOnInit",value:function(){var e=this;this.store.select(jo.getCheckedNodes).pipe(Object(Y.a)((function(e){return 1===e.length})),Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){setTimeout((function(){e.scrollNodeIntoView(t[0])}))}))}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"scrollNodeIntoView",value:function(e){var t=this.graphService.sanitizeNodeID(e.objectId),n=document.querySelector('[data-id="'.concat(t,'"]'));n&&"scrollBehavior"in document.documentElement.style&&n.scrollIntoView({behavior:"smooth",block:"nearest"})}}]),e}()).\u0275fac=function(e){return new(e||kk)(j.Pb(L.g),j.Pb(mn))},kk.\u0275cmp=j.Jb({type:kk,selectors:[["app-tree"]],inputs:{theme:"theme",searchGraph:"searchGraph"},decls:2,vars:4,consts:[[3,"theme","graph"]],template:function(e,t){1&e&&(j.Qb(0,"app-tree-group",0),j.hc(1,"async")),2&e&&j.lc("theme",t.theme)("graph",t.searchGraph?t.searchGraph:j.ic(1,2,t.viewGraph$))},directives:[Ck],pipes:[we.b],styles:[""]}),function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);r>3&&a&&Object.defineProperty(t,n,a)}([Object(L.d)(zs.getViewGraph),Sk("design:type",J.a)],kk.prototype,"viewGraph$",void 0),kk),jk=r("vxfF");function Pk(e,t){1&e&&(j.Vb(0,"div",4),j.Kc(1,"No results"),j.Ub())}function Mk(e,t){if(1&e&&(j.Vb(0,"div",5),j.Qb(1,"app-tree",6),j.Ub()),2&e){var n=j.gc();j.Db(1),j.lc("theme",n.theme)("searchGraph",n.searchGraph)}}function Ik(e,t){if(1&e&&(j.Vb(0,"div"),j.Qb(1,"app-tree-nested-node",9),j.Ub()),2&e){var n=t.$implicit,i=j.gc(2);j.Db(1),j.lc("theme",i.theme)("nested",!1)("node",n)("graph",i.prunedViewGraph)}}function zk(e,t){if(1&e&&(j.Vb(0,"cdk-virtual-scroll-viewport",7),j.Ic(1,Ik,2,4,"div",8),j.Ub()),2&e){var n=j.gc();j.Fc("height",n.searchHeight,"px"),j.lc("itemSize",64),j.Db(1),j.lc("cdkVirtualForOf",n.searchResults)("cdkVirtualForTrackBy",n.trackTreeNode)}}var Tk,Uk,Dk=((Tk=function(){function e(t,n,i,o,r,a){y(this,e),this.renderer=t,this.changeDetectorRef=n,this.elementRef=i,this.engineService=o,this.store=r,this.liveAnnouncer=a,this._query="",this._displayMode=cs.List,this.displayModeChange=new j.p,this.theme=_d.Dark,this.treeSearchDisplayMode=cs,this.searchResults=[],this.searchHeight=0,this.ngUnsubscribe=new Z.a,this.numResults$=new kp.a(0)}return v(e,[{key:"query",get:function(){return this._query},set:function(e){this._query=e||"",this.handleQueryChange(),void 0!==this.viewGraph&&this.numResults$.next(this.searchResults.length)}},{key:"displayMode",get:function(){return this._displayMode},set:function(e){null!=e&&(this._displayMode=e,this.handleQueryChange(),this.displayModeChange.emit(this.displayMode))}},{key:"viewGraph",get:function(){return this._viewGraph},set:function(e){this._viewGraph=e,this.leafNodes=this.engineService.getLeaves(),this.buildPrunedViewGraph(this.displayMode),this.handleQueryChange(),this.changeDetectorRef.markForCheck()}},{key:"ngOnInit",value:function(){}},{key:"buildPrunedViewGraph",value:function(e){var t=this.store.selectSnapshot(vs.getSelectedChapter),n=this.engineService.createViewGraph(t.showObjects,!0);this.prunedViewGraph=n}},{key:"ngAfterViewInit",value:function(){var e=this;this.renderer.listen("window","resize",(function(t){e.resize()})),this.numResults$.pipe(Object(Gp.a)(600)).subscribe((function(t){e.liveAnnouncer.announce(e.searchResults.length+" structures found")}))}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"handleQueryChange",value:function(){var e=this.search(this._query,this.displayMode===cs.List?this.prunedViewGraph:this.viewGraph);this.displayMode===cs.Tree&&(this.searchGraph=function(e,t){return t.reduce((function(t,n){return function e(t,n,i){Be.addNode(t,n);var o=Be.getAncestor(i,n.id);if(o){var r=t.successors[o]||[];return r.push(n.id),t.successors[o]=Object(ie.uniq)(r),t.predecessors[n.id]=o,e(t,Be.getNode(i,o),i)}return Be.addRootNode(t,n),t}(t,n,e)}),{nodes:{},successors:{},predecessors:{},roots:{}})}(this.viewGraph,e)),this.searchResults=e,this.resize()}},{key:"resize",value:function(){var e=this;this.getSearchHeight().pipe(Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){e.searchHeight=t,e.changeDetectorRef.markForCheck()}))}},{key:"getSearchHeight",value:function(){var e=this;return new J.a((function(t){setTimeout((function(){var n=e.elementRef.nativeElement.offsetHeight;null!=n&&(t.next(n),t.complete())}))}))}},{key:"search",value:function(e,t){return void 0===t?[]:(e=Object(Ww.remove)(e.toLowerCase()),Object.values(t.nodes).filter((function(t){return 0===e.length||Object(Ww.remove)(t.label.toLowerCase()).indexOf(e)>=0})).sort((function(e,t){return e.label.localeCompare(t.label)})))}},{key:"trackTreeNode",value:function(e,t){return t.id}}]),e}()).\u0275fac=function(e){return new(e||Tk)(j.Pb(j.H),j.Pb(j.i),j.Pb(j.m),j.Pb(Sn),j.Pb(L.g),j.Pb(qp.i))},Tk.\u0275cmp=j.Jb({type:Tk,selectors:[["app-tree-search"]],inputs:{query:"query",displayMode:"displayMode",viewGraph:"viewGraph",theme:"theme"},outputs:{displayModeChange:"displayModeChange"},decls:4,vars:3,consts:[[1,"tree-search"],["class","tree-search__empty",4,"ngIf"],["class","pr-3 pv-3",4,"ngIf"],["class","pv-3",3,"itemSize","height",4,"ngIf"],[1,"tree-search__empty"],[1,"pr-3","pv-3"],[1,"tree-search__tree",3,"theme","searchGraph"],[1,"pv-3",3,"itemSize"],[4,"cdkVirtualFor","cdkVirtualForOf","cdkVirtualForTrackBy"],[1,"mr-3",2,"height","64px",3,"theme","nested","node","graph"]],template:function(e,t){1&e&&(j.Vb(0,"div",0),j.Ic(1,Pk,2,0,"div",1),j.Ic(2,Mk,2,2,"div",2),j.Ic(3,zk,2,5,"cdk-virtual-scroll-viewport",3),j.Ub()),2&e&&(j.Db(1),j.lc("ngIf",0===t.searchResults.length),j.Db(1),j.lc("ngIf",t.displayMode===t.treeSearchDisplayMode.Tree),j.Db(1),j.lc("ngIf",t.displayMode===t.treeSearchDisplayMode.List))},directives:[we.l,_k,jk.e,jk.a,jk.d,mk],styles:[".text-8{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-28{font-size:28px;letter-spacing:.7px;line-height:1.4em}.text-28.text-uppercase{font-size:28px;letter-spacing:1.68px;line-height:1.25em;text-transform:uppercase}.text-header{font-weight:700}.text--code{font-family:Courier New,Courier,monospace}.text-uppercase{text-transform:uppercase}.text-xlight{font-weight:200}.text-light{font-weight:300}.text-medium{font-weight:500}.text-semibold{font-weight:600}.text-bold{font-weight:700}.text-underline{text-decoration:underline}.text-italic{font-style:italic}.text-bright{color:#fff}.text-dim{color:#96a8c0}.text-error{color:#ed4758}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.text-ellipsis{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link,.text-link:visited{color:inherit;cursor:pointer}.text-link:not(.text-underline),.text-link:visited:not(.text-underline){text-decoration:none}.text-success{color:#38de38}.text-danger{color:#de3535}.text-info{color:#2d72dc}.text-nowrap{white-space:nowrap}.text-pre-line{white-space:pre-line}.tree-search{display:flex;flex-direction:column;flex:1 1 auto;height:100%}.tree-search__tree{flex-grow:1;width:100%}.tree-search__empty{font-size:14px;letter-spacing:.35px;line-height:1.4em;padding:12px;font-style:italic;margin-top:12px}.tree-search cdk-virtual-scroll-viewport{flex:1 1 auto}.tree-search cdk-virtual-scroll-viewport .cdk-virtual-scroll-content-wrapper{padding-right:12px}"],encapsulation:2,changeDetection:0}),Tk),Lk=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},Ek=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Fk=["searchInput"],Ak=["tabButton"],Rk=function(e){return{"view-search__action--selected":e}},Vk=((Uk=function(){function e(t,n,i){y(this,e),this.viewService=t,this.engineService=n,this.store=i,this.ngUnsubscribe=new Z.a,this.query="",this.themeEnum=_d,this.treeSearchDisplayMode=cs}return v(e,[{key:"ngOnInit",value:function(){this.initViewGraphSubscription(),this.initDisplayModeSubscription()}},{key:"initViewGraphSubscription",value:function(){var e=this;this.store.select(vs.getSelectedChapterId).pipe(Object(Y.a)((function(e){return null!=e})),Object(Zc.a)(),Object(X.a)(this.ngUnsubscribe)).subscribe((function(){e.store.dispatch(new Ot(e.engineService.createViewGraph({},!1)))}))}},{key:"initDisplayModeSubscription",value:function(){var e=this;this.searchDisplayMode$.pipe(Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){setTimeout((function(){e.searchInput.nativeElement.focus()}))}))}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"handleSearchKeyup",value:function(e,t){"Escape"===e.key&&(this.handleExitClick(),this.searchInput.nativeElement.blur()),this.query=t}},{key:"handleExitClick",value:function(){this.query="",this.viewService.toggleSearch(null,!1)}},{key:"toggleDisplayMode",value:function(){var e=this.store.selectSnapshot(hs.getSearchDisplayMode);e=e===cs.List?cs.Tree:cs.List,this.setDisplayMode(e)}},{key:"setDisplayMode",value:function(e){this.store.dispatch(new _.SetSearchDisplayMode(e))}},{key:"handleTreeButtonClick",value:function(){this.setDisplayMode(cs.Tree)}},{key:"handleListButtonClick",value:function(){this.setDisplayMode(cs.List)}},{key:"getActiveTab",value:function(){switch(this.store.selectSnapshot(hs.getSearchDisplayMode)){case cs.List:return"searchTab";case cs.Tree:return"treeTab";default:return null}}},{key:"shiftFocus",value:function(e,t){e.stopPropagation();var n=this._buttonRefs.toArray(),i=n.findIndex((function(e){return e.nativeElement==document.activeElement}));n[(i+t+n.length)%n.length].nativeElement.focus()}}]),e}()).\u0275fac=function(e){return new(e||Uk)(j.Pb(Wp),j.Pb(Sn),j.Pb(L.g))},Uk.\u0275cmp=j.Jb({type:Uk,selectors:[["app-view-search"]],viewQuery:function(e,t){var n;1&e&&(j.Pc(Fk,!0),j.Pc(Ak,!0)),2&e&&(j.sc(n=j.dc())&&(t.searchInput=n.first),j.sc(n=j.dc())&&(t._buttonRefs=n))},decls:29,vars:33,consts:[["role","dialog","cdkTrapFocus","",1,"view-search",3,"keyup.escape"],[1,"view-search__header"],[1,"view-search__actions-row"],["role","tablist",1,"view-search__actions",3,"keydown.arrowleft","keydown.arrowright"],["type","button","role","tab","id","treeTab",1,"view-search__action",3,"ngClass","click","keyup.space"],["tabButton",""],["aria-hidden","true",1,"view-search__action-icon",3,"icon"],["type","button","role","tab","id","searchTab",1,"view-search__action",3,"ngClass","click","keyup.space"],["aria-hidden","true","icon","search",1,"view-search__action-icon"],["type","button","matTooltip","Close Search","aria-label","Close Search",1,"view-search__exit",3,"click"],["icon","times"],[1,"view-search__input-row"],[1,"view-search__input-container"],["icon","search",1,"view-search__input-icon"],["appAutoFocus","","appSelectOnFocus","","role","search","type","text","aria-label","Start typing the search term, then use tab to navigate the results","placeholder","Search Anatomy",1,"view-search__input",3,"value","keyup"],["searchInput",""],["role","tabpanel",1,"view-search__body"],[3,"displayMode","theme","query","viewGraph"]],template:function(e,t){if(1&e){var n=j.Wb();j.Vb(0,"div",0),j.cc("keyup.escape",(function(){return t.handleExitClick()})),j.Vb(1,"div",1),j.Vb(2,"div",2),j.Vb(3,"div",3),j.cc("keydown.arrowleft",(function(e){return t.shiftFocus(e,-1)}))("keydown.arrowright",(function(e){return t.shiftFocus(e,1)})),j.Vb(4,"button",4,5),j.cc("click",(function(){return t.handleTreeButtonClick()}))("keyup.space",(function(){return t.handleTreeButtonClick()})),j.hc(6,"async"),j.hc(7,"async"),j.hc(8,"async"),j.Qb(9,"app-icon",6),j.Kc(10,"Tree "),j.Ub(),j.Vb(11,"button",7,5),j.cc("click",(function(){return t.handleListButtonClick()}))("keyup.space",(function(){return t.handleListButtonClick()})),j.hc(13,"async"),j.hc(14,"async"),j.hc(15,"async"),j.Qb(16,"app-icon",8),j.Kc(17,"Search "),j.Ub(),j.Ub(),j.Vb(18,"button",9),j.cc("click",(function(){return t.handleExitClick()})),j.Qb(19,"app-icon",10),j.Ub(),j.Ub(),j.Vb(20,"div",11),j.Vb(21,"div",12),j.Qb(22,"app-icon",13),j.Vb(23,"input",14,15),j.cc("keyup",(function(e){j.xc(n);var i=j.tc(24);return t.handleSearchKeyup(e,i.value)})),j.Ub(),j.Ub(),j.Ub(),j.Ub(),j.Vb(25,"div",16),j.Qb(26,"app-tree-search",17),j.hc(27,"async"),j.hc(28,"async"),j.Ub(),j.Ub()}2&e&&(j.Db(4),j.lc("ngClass",j.nc(29,Rk,j.ic(6,13,t.searchDisplayMode$)===t.treeSearchDisplayMode.Tree)),j.Eb("aria-selected",j.ic(7,15,t.searchDisplayMode$)===t.treeSearchDisplayMode.Tree)("tabIndex",j.ic(8,17,t.searchDisplayMode$)===t.treeSearchDisplayMode.Tree?0:-1),j.Db(5),j.lc("icon","sitemap"),j.Db(2),j.lc("ngClass",j.nc(31,Rk,j.ic(13,19,t.searchDisplayMode$)===t.treeSearchDisplayMode.List)),j.Eb("aria-selected",j.ic(14,21,t.searchDisplayMode$)===t.treeSearchDisplayMode.List)("tabIndex",j.ic(15,23,t.searchDisplayMode$)===t.treeSearchDisplayMode.List?0:-1),j.Db(12),j.lc("value",t.query),j.Db(2),j.Eb("aria-labelledby",t.getActiveTab()),j.Db(1),j.lc("displayMode",j.ic(27,25,t.searchDisplayMode$))("theme",t.themeEnum.Light)("query",t.query)("viewGraph",j.ic(28,27,t.viewGraph$)))},directives:[qp.d,we.i,vp,Lg.c,qw,$w,Dk],pipes:[we.b],styles:[".text-8{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-28{font-size:28px;letter-spacing:.7px;line-height:1.4em}.text-28.text-uppercase{font-size:28px;letter-spacing:1.68px;line-height:1.25em;text-transform:uppercase}.text-header{font-weight:700}.text--code{font-family:Courier New,Courier,monospace}.text-uppercase{text-transform:uppercase}.text-xlight{font-weight:200}.text-light{font-weight:300}.text-medium{font-weight:500}.text-semibold{font-weight:600}.text-bold{font-weight:700}.text-underline{text-decoration:underline}.text-italic{font-style:italic}.text-bright{color:#fff}.text-dim{color:#96a8c0}.text-error{color:#ed4758}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.text-ellipsis{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link,.text-link:visited{color:inherit;cursor:pointer}.text-link:not(.text-underline),.text-link:visited:not(.text-underline){text-decoration:none}.text-success{color:#38de38}.text-danger{color:#de3535}.text-info{color:#2d72dc}.text-nowrap{white-space:nowrap}.text-pre-line{white-space:pre-line}.view-search{display:flex;flex-direction:column;height:100%}@-webkit-keyframes appear{0%{background-color:transparent}}@keyframes appear{0%{background-color:transparent}}.view-search__header{flex:0 0 auto;flex-direction:column;display:flex;-webkit-animation:appear .25s ease-out;animation:appear .25s ease-out}.view-search__actions-row{flex:0 0 auto;display:flex;padding:0 12px;justify-content:space-between;align-items:center;border-bottom:1px solid #d7e0ea}.view-search__actions{display:flex;height:56px;flex:1;justify-content:space-between}.view-search__action{font-size:14px;letter-spacing:.35px;line-height:1.4em;font-weight:500;text-transform:uppercase;background:transparent;display:flex;align-items:center;justify-content:center;border:0;border-bottom:2px solid transparent;color:#374a68;cursor:pointer;width:49%;padding-top:4px}.view-search__action:hover:not(.view-search__action--selected){color:#131c2a;border-bottom-color:#d7e0ea}.view-search__action--selected{color:#131c2a;border-bottom-color:#2d72dc}.view-search__action-icon{margin-right:8px}.view-search__exit{display:flex;align-items:center;justify-content:center;border:0;border-radius:50%;color:#374a68;background-color:#d7e0ea;opacity:.8;cursor:pointer;width:28px;height:28px;margin-left:12px;outline:none}.view-search__input-row{flex:0 0 auto;display:flex;padding:12px}.view-search__input-container{background-color:#fff;border:1px solid #fff;display:flex;flex-grow:1;border-radius:4px}.view-search__input-container:hover{border-color:#61779e}.view-search__input-container:focus-within{outline:2px solid #2d72dc!important;outline-offset:-2px}.view-search__input-icon{background:0 0;display:flex;align-items:center;justify-content:center;color:#61779e;width:36px;height:36px;outline:0}.view-search__input{font-size:13px;letter-spacing:.325px;line-height:1.4em;font-weight:400;color:#131c2a;background:transparent;border:1px solid transparent;outline:none;flex:1 0 auto;padding:8px 12px 8px 0}.view-search__input::-ms-clear{display:none}.view-search__input::-moz-placeholder{color:#61779e;opacity:1}.view-search__input:-ms-input-placeholder{color:#61779e;opacity:1}.view-search__input::placeholder{color:#61779e;opacity:1}.view-search__body{flex:1 1 100%;overflow-y:scroll;padding-left:12px}.view-search__input{font-family:Inter UI,Font Awesome\\ 5 Pro!important}@media not all and (min-resolution:0.001dpcm){@supports (-webkit-appearance:none){.view-search__input{font-size:16px;padding:4px 8px;width:0}}}"],encapsulation:2,changeDetection:0}),Lk([Object(L.d)(zs.getViewGraph),Ek("design:type",J.a)],Uk.prototype,"viewGraph$",void 0),Lk([Object(L.d)(hs.getSearchDisplayMode),Ek("design:type",J.a)],Uk.prototype,"searchDisplayMode$",void 0),Uk),Nk=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function Bk(e,t){if(1&e){var n=j.Wb();j.Vb(0,"button",7),j.cc("click",(function(){return j.xc(n),j.gc().handleCloseClick()})),j.Ub()}2&e&&j.Eb("aria-label","Close")}function Hk(e,t){if(1&e&&(j.Vb(0,"i",8),j.Kc(1),j.Ub()),2&e){var n=j.gc();j.Db(1),j.Mc(" ",n.node.info.latinLabel," ")}}function Qk(e,t){if(1&e&&j.Qb(0,"p",9),2&e){var n=j.gc();j.Hb("text-italic",!(null!=n.node.info&&n.node.info.description)),j.lc("innerHTML",n.formatHTML((null==n.node.info?null:n.node.info.description)||"No description available"),j.yc)}}function qk(e,t){if(1&e&&(j.Vb(0,"a",10),j.Kc(1," View source "),j.Ub()),2&e){var n=j.gc();j.Eb("href",null==n.node.info?null:n.node.info.sourceLink,j.Ac)}}var $k,Wk=function(e,t){return{"view-node-description--layout-column":e,"view-node-description--layout-drawer":t}},Kk=(($k=function(){function e(t,n,i){y(this,e),this.store=t,this.actions=n,this.changeRef=i,this.layout=il.Drawer,this.showClose=!0,this.isOpen=!1,this.ngUnsubscribe=new Z.a}return v(e,[{key:"ngOnInit",value:function(){var e=this;this.initInfoListeners(),this.store.select(jo.getSelectedNode).pipe(Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){void 0!==t&&(e.node=e.store.selectSnapshot(zs.getViewGraphNode)(t.objectId))}))}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"handleHideClick",value:function(e){this.store.dispatch(new Yi.UpdateNodesShown(!1,[e.id]))}},{key:"handleCloseClick",value:function(){var e=this.store.selectSnapshot(hs.getUI);e.nodeInfo.status=ba.Hide,this.store.dispatch(new _.SetUI(e))}},{key:"initInfoListeners",value:function(){var e=this;this.actions.pipe(Object(L.i)(sn,cn,rn),Object(X.a)(this.ngUnsubscribe)).subscribe((function(){e.isOpen=!0,e.changeRef.markForCheck()}))}},{key:"formatHTML",value:function(e){return e.trim().replace(new RegExp("\r?\n","g"),"<br><br>")}}]),e}()).\u0275fac=function(e){return new(e||$k)(j.Pb(L.g),j.Pb(L.b),j.Pb(j.i))},$k.\u0275cmp=j.Jb({type:$k,selectors:[["app-view-node-description"]],inputs:{layout:"layout",showClose:"showClose"},decls:9,vars:11,consts:[[1,"view-node-description",3,"ngClass"],[1,"view-node-description__header","mb-3"],["type","button","app-pin-button","","size","small","icon","arrow-left","class","mr-1 mt-1",3,"click",4,"ngIf"],[1,"view-node-description__title"],["class","mv-1 text-14 text-medium text-italic",4,"ngIf"],["class","view-node-description__body mv-2",3,"text-italic","innerHTML",4,"ngIf"],["class","view-node-description__attribution text-link text-underline mv-1","target","_blank","rel","noreferrer nofollow",4,"ngIf"],["type","button","app-pin-button","","size","small","icon","arrow-left",1,"mr-1","mt-1",3,"click"],[1,"mv-1","text-14","text-medium","text-italic"],[1,"view-node-description__body","mv-2",3,"innerHTML"],["target","_blank","rel","noreferrer nofollow",1,"view-node-description__attribution","text-link","text-underline","mv-1"]],template:function(e,t){1&e&&(j.Vb(0,"div",0),j.Vb(1,"div",1),j.Ic(2,Bk,1,1,"button",2),j.Vb(3,"h2",3),j.Kc(4),j.Ub(),j.Ub(),j.Ic(5,Hk,2,1,"i",4),j.Ic(6,Qk,1,3,"p",5),j.hc(7,"async"),j.Ic(8,qk,2,1,"a",6),j.Ub()),2&e&&(j.lc("ngClass",j.oc(8,Wk,"column"===t.layout,"drawer"===t.layout)),j.Db(2),j.lc("ngIf",t.showClose),j.Db(2),j.Lc(null==t.node?null:t.node.label),j.Db(1),j.lc("ngIf",null==t.node.info?null:t.node.info.latinLabel),j.Db(1),j.lc("ngIf",!j.ic(7,6,t.querying$)),j.Db(2),j.lc("ngIf",null==t.node.info?null:t.node.info.sourceLink))},directives:[we.i,we.l,Dg],pipes:[we.b],styles:[".text-8{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-28{font-size:28px;letter-spacing:.7px;line-height:1.4em}.text-28.text-uppercase{font-size:28px;letter-spacing:1.68px;line-height:1.25em;text-transform:uppercase}.text-header{font-weight:700}.text--code{font-family:Courier New,Courier,monospace}.text-uppercase{text-transform:uppercase}.text-xlight{font-weight:200}.text-light{font-weight:300}.text-medium{font-weight:500}.text-semibold{font-weight:600}.text-bold{font-weight:700}.text-underline{text-decoration:underline}.text-italic{font-style:italic}.text-bright{color:#fff}.text-dim{color:#96a8c0}.text-error{color:#ed4758}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.text-ellipsis{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link,.text-link:visited{color:inherit;cursor:pointer}.text-link:not(.text-underline),.text-link:visited:not(.text-underline){text-decoration:none}.text-success{color:#38de38}.text-danger{color:#de3535}.text-info{color:#2d72dc}.text-nowrap{white-space:nowrap}.text-pre-line{white-space:pre-line}.view-node-description{display:flex;flex-direction:column}.view-node-description--layout-drawer .view-node-description__body{margin-top:8px}.view-node-description--layout-column .view-node-description__body{margin-top:4px}.view-node-description__header{display:flex}.view-node-description__title{font-size:18px;letter-spacing:.45px;line-height:1.4em;flex:1 1 auto;font-weight:600;align-self:center}.view-node-description--layout-drawer .view-node-description__title,.view-node-description__body{font-size:14px;letter-spacing:.35px;line-height:1.4em}.view-node-description__body{color:#374a68}.view-node-description__attribution{font-size:12px;letter-spacing:.3px;line-height:1.4em;color:#374a68}.view-node-description__actions{cursor:pointer;outline:none;border:none;background:transparent;padding:4px 8px}"],encapsulation:2,changeDetection:0}),function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);r>3&&a&&Object.defineProperty(t,n,a)}([Object(L.d)(zs.getQuerying),Nk("design:type",J.a)],$k.prototype,"querying$",void 0),$k),Gk=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},Zk=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function Jk(e,t){1&e&&(j.Tb(0),j.Qb(1,"app-view-title"),j.Qb(2,"app-view-content-mode",6),j.Sb())}function Xk(e,t){1&e&&j.Qb(0,"app-view-quiz")}function Yk(e,t){if(1&e&&(j.Vb(0,"app-view-column",3),j.Tb(1,4),j.Ic(2,Jk,3,0,"ng-container",5),j.hc(3,"async"),j.Ic(4,Xk,1,0,"app-view-quiz",5),j.hc(5,"async"),j.Sb(),j.Ub()),2&e){var n=j.gc();j.lc("@slideInOut",void 0),j.Db(2),j.lc("ngIf",!j.ic(3,3,n.quizModeActive$)),j.Db(2),j.lc("ngIf",j.ic(5,5,n.quizModeActive$))}}function eC(e,t){1&e&&(j.Vb(0,"app-view-column",7),j.Qb(1,"app-view-search"),j.Ub()),2&e&&j.lc("unpadded",!0)("@slideInOut",void 0)}function tC(e,t){1&e&&(j.Vb(0,"app-view-column",3),j.Qb(1,"app-view-node-description",6),j.Ub()),2&e&&j.lc("@slideInOut",void 0)}var nC,iC,oC,rC,aC=function(){return{"view-column-container--header-offset":!0}},sC=((nC=function(){function e(t,n,i){y(this,e),this.viewService=t,this.layoutService=n,this.changeDetectorRef=i,this.ngUnsubscribe=new Z.a,this.viewLayout=nl,this.application=P,this.columnVisible=!1,this.searchVisible=!1,this.nodeInfoVisible=!1}return v(e,[{key:"ngOnInit",value:function(){this.initLayoutObserver()}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"initLayoutObserver",value:function(){var e=this;Object(zc.b)(this.layout$,this.chapter$).pipe(Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){var n;b(n=t)||u(n)||h(n)||g(),e.columnVisible=e.layoutService.isVisible(nl.Column),e.searchVisible=e.layoutService.isVisible(nl.Search),e.nodeInfoVisible=e.layoutService.isVisible(nl.NodeInfo),e.changeDetectorRef.markForCheck()}))}},{key:"handleSearchClick",value:function(){this.viewService.toggleSearch(null,!0)}}]),e}()).\u0275fac=function(e){return new(e||nC)(j.Pb(Wp),j.Pb(pl),j.Pb(j.i))},nC.\u0275cmp=j.Jb({type:nC,selectors:[["app-view-column-container"]],decls:4,vars:5,consts:[[1,"view-column-container",3,"ngClass"],["class","view-column-container__inner",4,"ngIf"],["class","view-column-container__inner",3,"unpadded",4,"ngIf"],[1,"view-column-container__inner"],["view-column-body",""],[4,"ngIf"],["layout","column"],[1,"view-column-container__inner",3,"unpadded"]],template:function(e,t){1&e&&(j.Vb(0,"div",0),j.Ic(1,Yk,6,7,"app-view-column",1),j.Ic(2,eC,2,2,"app-view-column",2),j.Ic(3,tC,2,1,"app-view-column",1),j.Ub()),2&e&&(j.lc("ngClass",j.mc(4,aC)),j.Db(1),j.lc("ngIf",t.columnVisible),j.Db(1),j.lc("ngIf",t.searchVisible),j.Db(1),j.lc("ngIf",t.nodeInfoVisible))},directives:[we.i,we.l,ZO,cb,Vb,vO,Vk,Kk],pipes:[we.b],styles:[".view-column-container{pointer-events:none;height:100%;width:320px;position:absolute;left:0;top:0;z-index:30}.view-column-container app-view-column{position:absolute;left:0;top:0;height:100%;z-index:40}"],encapsulation:2,data:{animation:[Object(du.n)("slideInOut",[Object(du.m)(":enter",[Object(du.l)({transform:"translateX(-320px)"}),Object(du.e)("300ms ease-in-out",Object(du.l)({transform:"*"}))]),Object(du.m)(":leave",[Object(du.e)("300ms ease-in-out",Object(du.l)({transform:"translateX(-320px)"}))])])]},changeDetection:0}),Gk([Object(L.d)(vs.getSelectedChapter),Zk("design:type",J.a)],nC.prototype,"chapter$",void 0),Gk([Object(L.d)(hs.getUI),Zk("design:type",J.a)],nC.prototype,"layout$",void 0),Gk([Object(L.d)(rr.getQuizModeActive),Zk("design:type",J.a)],nC.prototype,"quizModeActive$",void 0),nC),cC=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},lC=((iC=function(){function e(t){y(this,e),this.store=t,this.audioVisible=!1,this.ngUnsubscribe=new Z.a}return v(e,[{key:"ngOnInit",value:function(){}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"handleAudioClick",value:function(){var e=this.store.selectSnapshot(zs.getPlayAudio);this.store.dispatch(new Nt(!e))}}]),e}()).\u0275fac=function(e){return new(e||iC)(j.Pb(L.g))},iC.\u0275cmp=j.Jb({type:iC,selectors:[["app-engine-audio"]],decls:7,vars:9,consts:[["type","button",1,"audio",3,"click"],[1,"audio__icon",3,"icon"],[1,"audio__label","text-10","text-uppercase","text-semibold"]],template:function(e,t){1&e&&(j.Vb(0,"button",0),j.cc("click",(function(){return t.handleAudioClick()})),j.hc(1,"async"),j.Qb(2,"app-icon",1),j.hc(3,"async"),j.Vb(4,"span",2),j.Kc(5),j.hc(6,"async"),j.Ub(),j.Ub()),2&e&&(j.Eb("aria-label",j.ic(1,3,t.playAudio$)?"Stop Audio":"Play Audio"),j.Db(2),j.lc("icon",j.ic(3,5,t.playAudio$)?"volume-up":"volume-slash"),j.Db(3),j.Mc(" ",j.ic(6,7,t.playAudio$)?"Stop Audio":"Play Audio"," "))},directives:[vp],pipes:[we.b],styles:[".audio[_ngcontent-%COMP%]{border:none;background:#283853;box-shadow:1px -1px 2px 0 rgba(28,42,63,.1),0 1px 2px 0 rgba(28,42,63,.3);color:#fff;border-radius:4px;height:26px;width:26px;padding:0;display:flex;justify-content:flex-start;align-items:center;overflow:hidden;transition:width .3s ease-in-out;text-transform:uppercase}.audio[_ngcontent-%COMP%]:hover{background:#374a68;cursor:pointer;width:100px}.audio[_ngcontent-%COMP%]:hover   .audio__label[_ngcontent-%COMP%]{flex:1 0 auto;display:inline-block;padding:0 8px 0 0}.audio__icon[_ngcontent-%COMP%]{flex:0 0 26px}.audio__label[_ngcontent-%COMP%]{display:none}"],changeDetection:0}),function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);r>3&&a&&Object.defineProperty(t,n,a)}([Object(L.d)(zs.getPlayAudio),cC("design:type",J.a)],iC.prototype,"playAudio$",void 0),iC),pC=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},uC=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},dC={stacksForChapter:{}},gC=((rC=function(){function e(t){y(this,e),this.store=t}return v(e,[{key:"reset",value:function(e,t){e.patchState(immer.produce(e.getState(),(function(e){e.stacksForChapter={}})))}},{key:"undoAll",value:function(e,t){var n=e.getState();if(void 0!==n.stacksForChapter[t.chapterId]){var i=p(n.stacksForChapter[t.chapterId].undoStack).reverse(),o=i.flat().reduce((function(e,t){return void 0===e[t.patchAction]&&(e[t.patchAction]={action:t.patchAction,patches:[]}),e[t.patchAction].patches=[].concat(p(e[t.patchAction].patches),p(t.inverse)),e}),{});Object.keys(o).forEach((function(t){e.dispatch(new o[t].action(o[t].patches))}));var r=immer.produce(n,(function(e){e.stacksForChapter[t.chapterId].undoStack=[],e.stacksForChapter[t.chapterId].redoStack=i}));e.patchState(r)}}},{key:"preserveState",value:function(e,t){var n=this.store.selectSnapshot(vs.getSelectedChapterId),i=immer.produce(e.getState(),(function(e){0!==t.patches.length&&(t.patches.some((function(e){return 0===e.forward.length}))&&t.patches.some((function(e){return 0===e.inverse.length}))||(void 0===e.stacksForChapter[n]&&(e.stacksForChapter[n]={redoStack:[],undoStack:[]}),e.stacksForChapter[n].redoStack=[],e.stacksForChapter[n].undoStack.push(t.patches)))}));e.patchState(i)}},{key:"redo",value:function(e,t){var n=e.getState(),i=Object(ie.get)(n.stacksForChapter[t.chapterId],"redoStack",[]);if(0!==i.length){var o=i[i.length-1],r=immer.produce(n,(function(e){e.stacksForChapter[t.chapterId].redoStack.pop(),e.stacksForChapter[t.chapterId].undoStack.push(o)}));e.patchState(r),o.forEach((function(t){e.dispatch(new t.patchAction(t.forward))}))}}},{key:"undo",value:function(e,t){var n=e.getState(),i=Object(ie.get)(n.stacksForChapter[t.chapterId],"undoStack",[]);if(0!==i.length){var o=i[i.length-1],r=immer.produce(n,(function(e){e.stacksForChapter[t.chapterId].undoStack.pop(),e.stacksForChapter[t.chapterId].redoStack.push(o)}));e.patchState(r),o.forEach((function(t){e.dispatch(new t.patchAction(t.inverse))}))}}}],[{key:"canUndo",value:function(e,t){return e.stacksForChapter[t.selectedChapter].undoStack.length>0}},{key:"canRedo",value:function(e,t){return e.stacksForChapter[t.selectedChapter].redoStack.length>0}},{key:"getUndoCount",value:function(e,t){return e.stacksForChapter[t.selectedChapter].undoStack.length||0}}]),e}()).\u0275fac=function(e){return new(e||rC)(j.Zb(L.g))},rC.\u0275prov=j.Lb({token:rC,factory:rC.\u0275fac}),pC([Object(L.a)(eo.Reset),uC("design:type",Function),uC("design:paramtypes",[Object,eo.Reset]),uC("design:returntype",void 0)],rC.prototype,"reset",null),pC([Object(L.a)(eo.UndoAll),uC("design:type",Function),uC("design:paramtypes",[Object,eo.UndoAll]),uC("design:returntype",void 0)],rC.prototype,"undoAll",null),pC([Object(L.a)(eo.SavePatches),uC("design:type",Function),uC("design:paramtypes",[Object,eo.SavePatches]),uC("design:returntype",void 0)],rC.prototype,"preserveState",null),pC([Object(L.a)(eo.Redo),uC("design:type",Function),uC("design:paramtypes",[Object,eo.Redo]),uC("design:returntype",void 0)],rC.prototype,"redo",null),pC([Object(L.a)(eo.Undo),uC("design:type",Function),uC("design:paramtypes",[Object,eo.Undo]),uC("design:returntype",void 0)],rC.prototype,"undo",null),pC([Object(L.e)([vs]),uC("design:type",Function),uC("design:paramtypes",[Object,ti]),uC("design:returntype",Boolean)],rC,"canUndo",null),pC([Object(L.e)([vs]),uC("design:type",Function),uC("design:paramtypes",[Object,ti]),uC("design:returntype",Boolean)],rC,"canRedo",null),pC([Object(L.e)([vs]),uC("design:type",Function),uC("design:paramtypes",[Object,ti]),uC("design:returntype",Number)],rC,"getUndoCount",null),rC=pC([Object(L.f)({name:"undo",defaults:dC})],rC)),hC=((oC=function(){function e(){y(this,e)}return v(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||oC)},oC.\u0275cmp=j.Jb({type:oC,selectors:[["app-pillbox-divider"]],decls:1,vars:0,consts:[[1,"pillbox-divider"]],template:function(e,t){1&e&&j.Qb(0,"div",0)},styles:[".pillbox-divider{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;border-right:1px solid rgba(0,0,0,.1);height:18px;margin:0 8px}"],encapsulation:2,changeDetection:0}),oC);function fC(e,t){if(1&e){var n=j.Wb();j.Tb(0),j.Qb(1,"app-pillbox-divider"),j.Vb(2,"button",2),j.cc("click",(function(){return j.xc(n),j.gc().handleExitClick()})),j.Ub(),j.Sb()}if(2&e){var i=j.gc();j.Db(2),j.lc("matTooltip","Close "+i.name),j.Eb("aria-label","Close "+i.name)}}var bC,mC=function(e,t,n){return{"pillbox--padding-dense":e,"pillbox--padding-none":t,"pillbox--vertical":n}},vC=["*"],yC=((bC=function(){function e(){y(this,e),this.canExit=!1,this.padding="normal",this.orientation="horizontal",this.name="",this.eventCategory="",this.exit=new j.p}return v(e,[{key:"ngOnInit",value:function(){}},{key:"handleExitClick",value:function(){this.exit.emit()}}]),e}()).\u0275fac=function(e){return new(e||bC)},bC.\u0275cmp=j.Jb({type:bC,selectors:[["app-pillbox"]],inputs:{canExit:"canExit",padding:"padding",orientation:"orientation",name:"name",eventCategory:"eventCategory"},outputs:{exit:"exit"},ngContentSelectors:vC,decls:3,vars:6,consts:[[1,"pillbox",3,"ngClass"],[4,"ngIf"],["data-test","closePillboxButton","app-pin-button","","buttonType","ghost","icon","times",3,"matTooltip","click"]],template:function(e,t){1&e&&(j.kc(),j.Vb(0,"div",0),j.jc(1),j.Ic(2,fC,3,2,"ng-container",1),j.Ub()),2&e&&(j.lc("ngClass",j.pc(2,mC,"dense"===t.padding,"none"===t.padding,"vertical"===t.orientation)),j.Db(2),j.lc("ngIf",t.canExit))},directives:[we.i,we.l,hC,Dg,Lg.c],styles:[".pillbox{border-radius:32px;background-color:hsla(0,0%,100%,.9);box-shadow:1px -1px 2px 0 rgba(28,42,63,.1),0 1px 2px 0 rgba(28,42,63,.3);color:#131c2a;padding:6px;display:inline-flex;justify-content:center;align-items:center;overflow:hidden;transition:padding .15s}.pillbox--padding-dense{padding:4px}.pillbox--padding-none{padding:0}.pillbox--vertical{flex-direction:column;padding:6px}"],encapsulation:2,changeDetection:0}),bC),xC=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},OC=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function wC(e,t){if(1&e){var n=j.Wb();j.Vb(0,"div",1),j.Vb(1,"app-pillbox",2),j.Vb(2,"button",3),j.cc("click",(function(){return j.xc(n),j.gc().handleUndoClick()})),j.hc(3,"async"),j.hc(4,"async"),j.Ub(),j.Vb(5,"button",4),j.cc("click",(function(){return j.xc(n),j.gc().handleRedoClick()})),j.hc(6,"async"),j.hc(7,"async"),j.Ub(),j.Vb(8,"button",5),j.cc("click",(function(){return j.xc(n),j.gc().handleResetClick()})),j.hc(9,"async"),j.hc(10,"async"),j.Vb(11,"span",6),j.Kc(12,"Reset"),j.Ub(),j.Ub(),j.Ub(),j.Ub()}if(2&e){var i=j.gc();j.lc("@show",void 0),j.Db(2),j.lc("disabled",!j.ic(4,9,i.canUndo$)),j.Eb("aria-disabled",!j.ic(3,7,i.canUndo$)),j.Db(3),j.lc("disabled",!j.ic(7,13,i.canRedo$)),j.Eb("aria-disabled",!j.ic(6,11,i.canRedo$)),j.Db(3),j.lc("disabled",!j.ic(10,17,i.canUndo$)),j.Eb("aria-disabled",!j.ic(9,15,i.canUndo$))}}var kC,CC,SC=((kC=function(){function e(t){y(this,e),this.viewService=t}return v(e,[{key:"ngOnInit",value:function(){}},{key:"handleUndoClick",value:function(){this.viewService.undo()}},{key:"handleRedoClick",value:function(){this.viewService.redo()}},{key:"handleResetClick",value:function(){this.viewService.resetChapter()}}]),e}()).\u0275fac=function(e){return new(e||kC)(j.Pb(Wp))},kC.\u0275cmp=j.Jb({type:kC,selectors:[["app-view-undo"]],decls:2,vars:3,consts:[["class","view-undo",4,"ngIf"],[1,"view-undo"],["padding","dense"],["app-pin-button","","data-test","undo-btn","buttonType","ghost","icon","undo","aria-label","Undo","matTooltip","Undo",1,"mr-2",3,"disabled","click"],["buttonType","ghost","app-pin-button","","data-test","redo-btn","aria-label","Redo","matTooltip","Redo","icon","redo",1,"mr-2",3,"disabled","click"],["app-pin-button","","buttonShape","rounded","buttonType","ghost","data-test","reset-btn",3,"disabled","click"],[1,"ph-4","text-bold"]],template:function(e,t){1&e&&(j.Ic(0,wC,13,19,"div",0),j.hc(1,"async")),2&e&&j.lc("ngIf",j.ic(1,1,t.canUndo$))},directives:[we.l,yC,Dg,Lg.c],pipes:[we.b],styles:["[_nghost-%COMP%]{display:flex;justify-content:center;width:100%;padding:8px 0;pointer-events:none}"],data:{animation:[Object(du.n)("show",[Object(du.m)(":enter",Object(du.j)([Object(du.l)({transform:"translateY(-100%)",opacity:0}),Object(du.e)("150ms ease-in-out",Object(du.l)({transform:"translateY(0%)",opacity:1}))]))])]},changeDetection:0}),xC([Object(L.d)(gC.canUndo),OC("design:type",J.a)],kC.prototype,"canUndo$",void 0),xC([Object(L.d)(gC.canRedo),OC("design:type",J.a)],kC.prototype,"canRedo$",void 0),xC([Object(L.d)(gC.getUndoCount),OC("design:type",J.a)],kC.prototype,"undoCount$",void 0),kC),_C=r("PqYM"),jC=r("JX91"),PC=r("32Ea"),MC=r("gcYM"),IC=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},zC=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},TC=["scrubber"],UC=["track"],DC=["bar"],LC=["handle"],EC=function(e){return{"view-scrubber--draggable":e}},FC=function(e,t){return{"view-scrubber__handle--hide":e,"view-scrubber__handle-touch":t}},AC=((CC=function(){function e(t,n,i,o,r,a){y(this,e),this.engineService=t,this.animationService=n,this.renderer=i,this.viewService=o,this.changeDetectorRef=r,this.store=a,this.showHandle=!0,this.ngUnsubscribe=new Z.a,this.trackWidth=0,this.dragPosition={x:16,y:0},this.playing=!0}return v(e,[{key:"ngOnInit",value:function(){this.initChapterListener(),this.initTimelineListener()}},{key:"ngAfterViewInit",value:function(){this.initDragListener()}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"initChapterListener",value:function(){var e=this;this.selectedChapterId$.pipe(Object(Y.a)((function(e){return null!=e})),Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){e.timerange=e.animationService.getChapterLocalTimerange(t),e.tick(e.animationService.getTime())}))}},{key:"initTimelineListener",value:function(){var e=this;this.engineService.getEvent(yn.TimelinePlaying).pipe(Object(MC.a)(20),Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){return e.tick(t.time)})),this.engineService.getEvent(yn.TimelineScrubbed).pipe(Object(MC.a)(20),Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){var n=e.getPercent(t.time);e.setScrubberBar(n)}))}},{key:"initDragListener",value:function(){var e=this;this.dragInstance.moved.pipe(Object(Jp.a)(20),Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){var n=e.calculateHandlePercent();e.scrubToPercent(n)}))}},{key:"handleDragStart",value:function(){this.playing=this.store.selectSnapshot(zs.getAnimationPlaying),this.store.dispatch(new At(!1))}},{key:"handleDragEnd",value:function(){this.store.dispatch(new At(this.playing))}},{key:"handleTrackClick",value:function(e){if(this.showHandle){var t=e.offsetX/this.track.nativeElement.getBoundingClientRect().width*100;this.playing=this.store.selectSnapshot(zs.getAnimationPlaying),this.scrubToPercent(t),this.setScrubberBar(t),this.setScrubberHandle(t),this.store.dispatch(new At(this.playing))}}},{key:"tick",value:function(e){if(this.timerange){var t=this.getPercent(e);this.setScrubberBar(t),this.setScrubberHandle(t)}}},{key:"getPercent",value:function(e){return this.animationService.getLocalTime(e)/this.timerange.lastTime*100}},{key:"calculateHandlePercent",value:function(){var e=this.scrubber.nativeElement.getBoundingClientRect(),t=e.left,n=e.right-t-this.handle.nativeElement.offsetWidth,i=this.handle.nativeElement.getBoundingClientRect().left;return Math.min(Math.max((i-t)/n*100,0),100)}},{key:"scrubToPercent",value:function(e){var t=e/100*this.timerange.lastTime,n=0===e?"second":"first",i=this.store.selectSnapshot(vs.getSelectedChapterId),o=this.animationService.mapLocalTimeToGlobal(i,t);this.animationService.scrub({time:o,which:n})}},{key:"handlePlayClick",value:function(){this.viewService.toggleAnimation()}},{key:"setScrubberBar",value:function(e){this.renderer.setStyle(this.bar.nativeElement,"width",e+"%")}},{key:"setScrubberHandle",value:function(e){0===this.trackWidth&&(this.trackWidth=this.track.nativeElement.offsetWidth-32),this.showHandle&&(this.dragPosition=Object.assign(Object.assign({},this.dragPosition),{x:16+this.trackWidth*(e/100)}),this.changeDetectorRef.markForCheck())}}]),e}()).\u0275fac=function(e){return new(e||CC)(j.Pb(Sn),j.Pb($r),j.Pb(j.H),j.Pb(Wp),j.Pb(j.i),j.Pb(L.g))},CC.\u0275cmp=j.Jb({type:CC,selectors:[["app-view-scrubber"]],viewQuery:function(e,t){var n;1&e&&(j.Ec(TC,!0),j.Ec(UC,!0),j.Ec(DC,!0),j.Ec(LC,!0),j.Pc(fa.a,!0)),2&e&&(j.sc(n=j.dc())&&(t.scrubber=n.first),j.sc(n=j.dc())&&(t.track=n.first),j.sc(n=j.dc())&&(t.bar=n.first),j.sc(n=j.dc())&&(t.handle=n.first),j.sc(n=j.dc())&&(t.dragInstance=n.first))},inputs:{showHandle:"showHandle"},decls:9,vars:10,consts:[[1,"view-scrubber",3,"ngClass"],["scrubber",""],[1,"view-scrubber__track",3,"click"],["track",""],[1,"view-scrubber__bar"],["bar",""],["cdkDrag","","cdkDragLockAxis","x","cdkDragBoundary",".view-scrubber",1,"view-scrubber__handle",3,"cdkDragFreeDragPosition","ngClass","cdkDragStarted","cdkDragEnded"],["handle",""]],template:function(e,t){1&e&&(j.Vb(0,"div",0,1),j.Vb(2,"div",2,3),j.cc("click",(function(e){return t.handleTrackClick(e)})),j.Qb(4,"div",4,5),j.Ub(),j.Vb(6,"div",6,7),j.cc("cdkDragStarted",(function(){return t.handleDragStart()}))("cdkDragEnded",(function(){return t.handleDragEnd()})),j.hc(8,"async"),j.Ub(),j.Ub()),2&e&&(j.lc("ngClass",j.nc(5,EC,t.showHandle)),j.Db(6),j.lc("cdkDragFreeDragPosition",t.dragPosition)("ngClass",j.oc(7,FC,!t.showHandle,j.ic(8,3,t.canTouch$))))},directives:[we.i,fa.a],pipes:[we.b],styles:['.view-scrubber{position:relative;display:flex;justify-content:center;align-items:center;height:40px;width:100%}.view-scrubber:hover .view-scrubber__handle:after{opacity:1}.view-scrubber--draggable .view-scrubber__track{left:16px;right:16px}.view-scrubber__track{background:rgba(150,168,192,.6);z-index:1;right:0}.view-scrubber__bar,.view-scrubber__track{border-radius:2px;position:absolute;height:4px;left:0}.view-scrubber__bar{background:#374a68;z-index:2;width:0}.view-scrubber__handle{width:40px;height:40px;margin-left:-16px;left:0;display:flex;align-items:center;justify-content:center;position:absolute;z-index:2}.view-scrubber__handle--hide{display:none}.view-scrubber__handle:after{opacity:1;transition:opacity .25s;content:"";width:8px;height:8px;border-radius:4px;background:#374a68;box-shadow:1px -1px 2px 0 rgba(28,42,63,.1),0 1px 2px 0 rgba(28,42,63,.3)}.view-scrubber__handle:hover:after{background:#2d72dc}.view-scrubber__handle:hover{cursor:pointer}.view-scrubber__handle-touch:after{opacity:1}'],encapsulation:2,changeDetection:0}),IC([Object(L.d)(zs.getAnimationPlaying),zC("design:type",J.a)],CC.prototype,"animationPlaying$",void 0),IC([Object(L.d)(vs.getSelectedChapterId),zC("design:type",J.a)],CC.prototype,"selectedChapterId$",void 0),IC([Object(L.d)(hs.getCanTouch),zC("design:type",J.a)],CC.prototype,"canTouch$",void 0),CC),RC=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},VC=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function NC(e,t){if(1&e){var n=j.Wb();j.Vb(0,"button",9),j.cc("click",(function(){return j.xc(n),j.gc(2).handlePlayClick()})),j.hc(1,"async"),j.hc(2,"async"),j.Ub()}if(2&e){var i=j.gc(2);j.lc("matTooltip",j.ic(1,2,i.animationPlaying$)?"Pause":"Play")("icon",j.ic(2,4,i.animationPlaying$)?"pause":"play")}}function BC(e,t){if(1&e){var n=j.Wb();j.Vb(0,"button",10),j.cc("click",(function(){return j.xc(n),j.gc(2).handlePlayChapterFromStartClick()})),j.Ub()}}function HC(e,t){1&e&&j.Qb(0,"app-view-scrubber",11)}function QC(e,t){if(1&e&&(j.Vb(0,"div",3),j.Ic(1,NC,3,6,"button",4),j.Ic(2,BC,1,0,"button",5),j.Ic(3,HC,1,0,"app-view-scrubber",6),j.Vb(4,"button",7),j.Vb(5,"span",8),j.Kc(6),j.hc(7,"async"),j.Ub(),j.Ub(),j.Ub()),2&e){var n=j.gc(),i=j.tc(2);j.Db(1),j.lc("ngIf",n.showPlayPause),j.Db(1),j.lc("ngIf",n.showPlayPause),j.Db(1),j.lc("ngIf",n.showScrubber),j.Db(1),j.lc("matMenuTriggerFor",i),j.Db(2),j.Mc("",j.ic(7,5,n.playbackSpeed$),"x")}}var qC,$C=((qC=function(){function e(t,n,i,o,r){y(this,e),this.animationService=t,this.viewService=n,this.layoutService=i,this.store=o,this.changeDetectorRef=r,this.viewLayout=nl,this.size="small",this.showPlayPause=!0,this.showScrubber=!0,this.showBar=!0,this.ngUnsubscribe=new Z.a}return v(e,[{key:"template",get:function(){return this._template},set:function(e){this._template=e,this.updateLayoutProperties(this.template)}},{key:"ngOnInit",value:function(){this.initChapterListener()}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"initChapterListener",value:function(){var e=this;this.selectedChapterId$.pipe(Object(Y.a)((function(e){return null!=e})),Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){e.timerange=e.animationService.getChapterLocalTimerange(t)}))}},{key:"updateLayoutProperties",value:function(e){this.showBar=e!==ma.None,this.showScrubber=e===ma.Full,this.showPlayPause=e!==ma.None}},{key:"handlePlayClick",value:function(){this.viewService.toggleAnimation()}},{key:"handlePlayChapterFromStartClick",value:function(){this.viewService.playChapterFromStart()}},{key:"setPlaybackSpeed",value:function(e){this.store.dispatch(new Vt(e))}}]),e}()).\u0275fac=function(e){return new(e||qC)(j.Pb($r),j.Pb(Wp),j.Pb(pl),j.Pb(L.g),j.Pb(j.i))},qC.\u0275cmp=j.Jb({type:qC,selectors:[["app-view-media-bar"]],inputs:{template:"template",size:"size"},decls:11,vars:1,consts:[["class","view-media-bar",4,"ngIf"],["playbackMenu","matMenu"],["mat-menu-item","",3,"click"],[1,"view-media-bar"],["app-pin-button","","buttonType","ghost","data-test","Play/Pause__small","matTooltipPosition","above",3,"matTooltip","icon","click",4,"ngIf"],["app-pin-button","","buttonType","ghost","matTooltipPosition","above","matTooltip","Play Chapter from Start","icon","step-backward",3,"click",4,"ngIf"],["class","view-media-bar__scrubber","data-test","Scrub__small",4,"ngIf"],["app-pin-button","","buttonType","ghost","matTooltipPosition","above","matTooltip","Playback Speed",3,"matMenuTriggerFor"],[1,"text-semibold"],["app-pin-button","","buttonType","ghost","data-test","Play/Pause__small","matTooltipPosition","above",3,"matTooltip","icon","click"],["app-pin-button","","buttonType","ghost","matTooltipPosition","above","matTooltip","Play Chapter from Start","icon","step-backward",3,"click"],["data-test","Scrub__small",1,"view-media-bar__scrubber"]],template:function(e,t){1&e&&(j.Ic(0,QC,8,7,"div",0),j.Vb(1,"mat-menu",null,1),j.Vb(3,"button",2),j.cc("click",(function(){return t.setPlaybackSpeed(1)})),j.Kc(4,"Normal"),j.Ub(),j.Vb(5,"button",2),j.cc("click",(function(){return t.setPlaybackSpeed(.5)})),j.Kc(6,"0.5"),j.Ub(),j.Vb(7,"button",2),j.cc("click",(function(){return t.setPlaybackSpeed(.25)})),j.Kc(8,"0.25"),j.Ub(),j.Vb(9,"button",2),j.cc("click",(function(){return t.setPlaybackSpeed(.1)})),j.Kc(10,"0.1"),j.Ub(),j.Ub()),2&e&&j.lc("ngIf",t.showBar)},directives:[we.l,Ld.a,Ld.b,Dg,Lg.c,Ld.d,AC],pipes:[we.b],styles:[".view-media-bar{display:flex}.view-media-bar__scrubber{width:120px;display:flex;justify-content:center;align-items:center}"],encapsulation:2,changeDetection:0}),RC([Object(L.d)(zs.getAnimationPlaying),VC("design:type",J.a)],qC.prototype,"animationPlaying$",void 0),RC([Object(L.d)(vs.getSelectedChapterId),VC("design:type",J.a)],qC.prototype,"selectedChapterId$",void 0),RC([Object(L.d)(zs.getPlaybackSpeed),VC("design:type",J.a)],qC.prototype,"playbackSpeed$",void 0),qC),WC=r("rDax"),KC=function(){function e(t,n,i){var o=this;y(this,e),this.overlay=t,this.content=n,this.data=i,this.afterClosed=new Z.a,this.afterClosed$=this.afterClosed.asObservable(),t.backdropClick().subscribe((function(){return o._close("backdropClick",i)})),this.entered$=Object(Ca.a)(Object(ka.a)(t.overlayElement,"mouseenter"),Object(ka.a)(t.overlayElement,"mouseleave")).pipe(Object(se.a)((function(e){return"mouseenter"===e.type})),Object(X.a)(this.afterClosed$))}return v(e,[{key:"close",value:function(e){this._close("close",e)}},{key:"_close",value:function(e,t){this.overlay.dispose(),this.afterClosed.next({type:e,data:t}),this.afterClosed.complete()}}]),e}(),GC=r("+rOU");function ZC(e,t){if(1&e&&j.Qb(0,"div",4),2&e){var n=j.gc();j.lc("innerHTML",n.content,j.yc)}}function JC(e,t){1&e&&j.Rb(0)}function XC(e,t){if(1&e&&(j.Tb(0),j.Ic(1,JC,1,0,"ng-container",5),j.Sb()),2&e){var n=j.gc();j.Db(1),j.lc("ngTemplateOutlet",n.content)("ngTemplateOutletContext",n.context)}}function YC(e,t){1&e&&j.Rb(0)}function eS(e,t){if(1&e&&(j.Tb(0),j.Ic(1,YC,1,0,"ng-container",6),j.Sb()),2&e){var n=j.gc();j.Db(1),j.lc("ngComponentOutlet",n.content)}}var tS,nS,iS,oS=((tS=function(){function e(t){y(this,e),this.popupRef=t,this.renderMethod="component"}return v(e,[{key:"ngOnInit",value:function(){this.content=this.popupRef.content,"string"==typeof this.content?this.renderMethod="text":this.content instanceof j.O&&(this.renderMethod="template",this.context={close:this.popupRef.close.bind(this.popupRef)})}}]),e}()).\u0275fac=function(e){return new(e||tS)(j.Pb(KC))},tS.\u0275cmp=j.Jb({type:tS,selectors:[["app-popup"]],decls:5,vars:4,consts:[[1,"popup"],[3,"ngSwitch"],[3,"innerHTML",4,"ngSwitchCase"],[4,"ngSwitchCase"],[3,"innerHTML"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[4,"ngComponentOutlet"]],template:function(e,t){1&e&&(j.Vb(0,"div",0),j.Tb(1,1),j.Ic(2,ZC,1,1,"div",2),j.Ic(3,XC,2,2,"ng-container",3),j.Ic(4,eS,2,1,"ng-container",3),j.Sb(),j.Ub()),2&e&&(j.Db(1),j.lc("ngSwitch",t.renderMethod),j.Db(1),j.lc("ngSwitchCase","text"),j.Db(1),j.lc("ngSwitchCase","template"),j.Db(1),j.lc("ngSwitchCase","component"))},directives:[we.n,we.o,we.q,we.j],styles:["[_nghost-%COMP%]{width:100%;height:100%}.popup[_ngcontent-%COMP%]{background:#fff;border-radius:4px;padding:8px;overflow-y:auto;box-shadow:1px -1px 2px 0 rgba(28,42,63,.1),0 1px 2px 0 rgba(28,42,63,.3)}"],changeDetection:0}),tS),rS=function(e){return e.Above="above",e.Below="below",e.Left="left",e.Right="right",e}({}),aS=(c(O={},rS.Above,{originX:"center",originY:"top",overlayX:"center",overlayY:"bottom",offsetY:-12}),c(O,rS.Below,{originX:"center",originY:"bottom",overlayX:"center",overlayY:"top",offsetY:12}),c(O,rS.Left,{originX:"start",originY:"center",overlayX:"end",overlayY:"center",offsetX:-12}),c(O,rS.Right,{originX:"end",originY:"center",overlayX:"start",overlayY:"center",offsetX:12}),O),sS=((nS=function(){function e(t,n){y(this,e),this.overlay=t,this.injector=n}return v(e,[{key:"open",value:function(e){var t=e.origin,n=e.content,i=e.data,o=e.width,r=e.height,a=e.hasBackdrop,s=this.overlay.create(this.getOverlayConfig({origin:t,width:o,height:r,hasBackdrop:a})),c=new KC(s,n,i),l=this.createInjector(c,this.injector);return s.attach(new GC.c(oS,null,l)),c}},{key:"createInjector",value:function(e,t){var n=new WeakMap([[KC,e]]);return new GC.e(t,n)}},{key:"getPositionStrategy",value:function(e,t){return this.overlay.position().flexibleConnectedTo(e).withPositions(this.getPositions(t))}},{key:"getOverlayConfig",value:function(e){var t=e.origin,n=e.width,i=e.height,o=e.hasBackdrop;return new WC.d({width:n,height:i,hasBackdrop:null==o||o,backdropClass:"popup-scrim",positionStrategy:this.getOverlayPosition(t),scrollStrategy:this.overlay.scrollStrategies.reposition()})}},{key:"getOverlayPosition",value:function(e,t){return t=t||[rS.Above,rS.Below,rS.Left,rS.Right],this.overlay.position().flexibleConnectedTo(e).withPositions(this.getPositions(t)).withPush(!0)}},{key:"getPositions",value:function(e){return e.map((function(e){return aS[e]}))}}]),e}()).\u0275fac=function(e){return new(e||nS)(j.Zb(WC.c),j.Zb(j.t))},nS.\u0275prov=j.Lb({token:nS,factory:nS.\u0275fac,providedIn:"root"}),nS),cS=function(){return window.navigator.userAgent.includes("Trident")},lS=((iS=function(){function e(t,n){y(this,e),this.el=t,this.renderer=n}return v(e,[{key:"ngOnInit",value:function(){cS()&&this.renderer.setStyle(this.el.nativeElement,"display","none")}}]),e}()).\u0275fac=function(e){return new(e||iS)(j.Pb(j.m),j.Pb(j.H))},iS.\u0275dir=j.Kb({type:iS,selectors:[["","appHideIE11",""]]}),iS),pS=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},uS=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},dS=["chapterCount"],gS=["mediaToggle"];function hS(e,t){if(1&e){var n=j.Wb();j.Vb(0,"div",4),j.Vb(1,"button",5),j.cc("click",(function(){return j.xc(n),j.gc(2).handlePreviousClick()})),j.hc(2,"async"),j.hc(3,"async"),j.hc(4,"async"),j.hc(5,"async"),j.Ub(),j.Vb(6,"button",6),j.cc("click",(function(){return j.xc(n),j.gc(2).handleNextClick()})),j.hc(7,"async"),j.hc(8,"async"),j.hc(9,"async"),j.hc(10,"async"),j.hc(11,"async"),j.hc(12,"async"),j.Ub(),j.Ub()}if(2&e){var i=j.gc(2),o=null,r=null;j.Db(1),j.lc("disabled",0===j.ic(2,6,i.chapterIndex$))("matTooltip",j.ic(4,10,i.previousChapter$)?"Previous: "+(null==(o=j.ic(5,12,i.previousChapter$))?null:o.info.displayName):""),j.Eb("aria-disabled",0===j.ic(3,8,i.chapterIndex$)),j.Db(5),j.lc("disabled",j.ic(9,18,i.chapterIndex$)===j.ic(10,20,i.chapterCount$)-1)("matTooltip",j.ic(11,22,i.nextChapter$)?"Next: "+(null==(r=j.ic(12,24,i.nextChapter$))?null:r.info.displayName):""),j.Eb("aria-disabled",j.ic(7,14,i.chapterIndex$)===j.ic(8,16,i.chapterCount$)-1)}}function fS(e,t){if(1&e&&(j.Vb(0,"div",7),j.Vb(1,"app-view-chapters",8),j.Vb(2,"div",9),j.Kc(3),j.hc(4,"async"),j.hc(5,"async"),j.Qb(6,"app-icon",10),j.Ub(),j.Vb(7,"span",11),j.Kc(8),j.hc(9,"async"),j.hc(10,"async"),j.Ub(),j.Ub(),j.Ub()),2&e){var n=j.gc(2);j.Db(3),j.Nc(" ",j.ic(4,4,n.chapterIndex$)+1," of ",j.ic(5,6,n.chapterCount$)," "),j.Db(5),j.Nc(" Toggle Chapter List, Chapter ",j.ic(9,8,n.chapterIndex$)+1," of ",j.ic(10,10,n.chapterCount$)," ")}}function bS(e,t){if(1&e){var n=j.Wb();j.Vb(0,"button",14),j.cc("click",(function(){return j.xc(n),j.gc(3).handlePlayClick()})),j.hc(1,"async"),j.hc(2,"async"),j.hc(3,"async"),j.Ub()}if(2&e){var i=j.gc(3);j.lc("icon",j.ic(1,3,i.animationPlaying$)?"pause":"play")("matTooltip",j.ic(3,7,i.animationPlaying$)?"Pause Animation":"Play Animation"),j.Eb("aria-label",j.ic(2,5,i.animationPlaying$)?"Pause Animation":"Play Animation")}}function mS(e,t){if(1&e){var n=j.Wb();j.Vb(0,"button",15),j.cc("click",(function(){return j.xc(n),j.gc(3).toggleToolbar("media")})),j.Qb(1,"app-view-scrubber",16),j.Ub()}2&e&&(j.Db(1),j.lc("showHandle",!1))}function vS(e,t){if(1&e&&(j.Vb(0,"div",7),j.Ic(1,bS,4,9,"button",12),j.Ic(2,mS,2,1,"button",13),j.Ub()),2&e){var n=j.gc(2);j.Db(1),j.lc("ngIf",n.isVisible(n.viewUI.Media)),j.Db(1),j.lc("ngIf",n.isVisible(n.viewUI.ScrubberButton))}}function yS(e,t){if(1&e&&(j.Tb(0),j.Ic(1,hS,13,26,"div",2),j.Ic(2,fS,11,12,"div",3),j.Ic(3,vS,3,2,"div",3),j.Sb()),2&e){var n=j.gc();j.Db(1),j.lc("ngIf",n.paginationVisible),j.Db(1),j.lc("ngIf",n.paginationVisible&&!n.collapsePagination),j.Db(1),j.lc("ngIf",n.mediaVisible)}}function xS(e,t){if(1&e){var n=j.Wb();j.Tb(0),j.Vb(1,"div",7),j.Vb(2,"div",17),j.Vb(3,"button",18),j.cc("click",(function(){j.xc(n);var e=j.gc();return e.handleSelectTool(e.toolEnum.Select)})),j.hc(4,"async"),j.hc(5,"async"),j.Ub(),j.Vb(6,"button",19),j.cc("click",(function(){j.xc(n);var e=j.gc();return e.handleSelectTool(e.toolEnum.Hide)})),j.hc(7,"async"),j.hc(8,"async"),j.Ub(),j.Vb(9,"button",20),j.cc("click",(function(){j.xc(n);var e=j.gc();return e.handleSelectTool(e.toolEnum.Fade)})),j.hc(10,"async"),j.hc(11,"async"),j.Ub(),j.Ub(),j.Ub(),j.Sb()}if(2&e){var i=j.gc();j.Db(3),j.lc("selected",j.ic(4,6,i.activeTool$)===i.toolEnum.Select),j.Eb("aria-pressed",j.ic(5,8,i.activeTool$)===i.toolEnum.Select),j.Db(3),j.lc("selected",j.ic(7,10,i.activeTool$)===i.toolEnum.Hide),j.Eb("aria-pressed",j.ic(8,12,i.activeTool$)===i.toolEnum.Hide),j.Db(3),j.lc("selected",j.ic(10,14,i.activeTool$)===i.toolEnum.Fade),j.Eb("aria-pressed",j.ic(11,16,i.activeTool$)===i.toolEnum.Fade)}}var OS,wS,kS,CS=((OS=function(){function e(t,n,i,o,r,a){y(this,e),this.viewService=t,this.viewUIService=n,this.store=i,this.changeDetectorRef=o,this.popupService=r,this.ga=a,this.viewToolsMode=Lf,this.viewUI=nl,this.breakpointEnum=Gc,this.canFullscreen=!0,this.isFullscreen=!1,this.toolEnum=ks,this.mediaControlsEnum=ma,this.paginationVisible=!1,this.mediaVisible=!1,this.ngUnsubscribe=new Z.a,this.animate=!0,this._mode=Lf.Main,this.collapsePagination=!1,this.collapseScrubber=!1,this.modeChange=new j.p}return v(e,[{key:"mode",get:function(){return this._mode},set:function(e){this._mode=e}},{key:"ngOnInit",value:function(){this.canFullscreen=Nr.canFullscreen(),this.initLayoutListener(),this.initBreakpointListener(),this.initFullscreenListener()}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"initLayoutListener",value:function(){var e=this;this.store.select(hs.getUI).pipe(Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){e.mediaTemplate=t.media.template,e.paginationVisible=e.viewUIService.isVisible(nl.Pagination),e.mediaVisible=e.viewUIService.isVisible(nl.Media),e.changeDetectorRef.markForCheck()}))}},{key:"initBreakpointListener",value:function(){var e=this;this.store.select(tl.getBreakpoint).pipe(Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){e.breakpoint=t,e.changeDetectorRef.markForCheck()}))}},{key:"initFullscreenListener",value:function(){var e=this;this.fullscreen$=Nr.onFullscreenChange(),this.fullscreen$.pipe(Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){e.isFullscreen=Nr.isFullscreen(),e.changeDetectorRef.markForCheck()}))}},{key:"handleSelectTool",value:function(e){var t=this.store.selectSnapshot(zs.getActiveTool);this.viewService.selectTool(e===t?ks.Select:e)}},{key:"handlePlayClick",value:function(){this.viewService.toggleAnimation()}},{key:"handleMenuClick",value:function(){this.store.dispatch(new _.ToggleMenu(!0))}},{key:"handlePreviousClick",value:function(){this.viewService.previousChapter("Toolbar")}},{key:"handleNextClick",value:function(){this.viewService.nextChapter("Toolbar")}},{key:"handleMediaClick",value:function(){this.toggleMediaPopup()}},{key:"toggleMediaPopup",value:function(){var e=this;this.mediaPopup?this.mediaPopup.close():(this.mediaPopup=this.popupService.open({origin:this.mediaToggle.nativeElement,content:$C,width:"300px"}),this.mediaPopup.afterClosed$.pipe(Object(X.a)(this.ngUnsubscribe),Object(Tc.a)(1)).subscribe((function(t){e.mediaPopup=null})))}},{key:"toggleToolbar",value:function(e){this.viewService.toggleToolbar(e)}},{key:"isEnabled",value:function(e){return this.viewUIService.isUIEnabled(e)}},{key:"isVisible",value:function(e){return this.viewUIService.isVisible(e)}}]),e}()).\u0275fac=function(e){return new(e||OS)(j.Pb(Wp),j.Pb(pl),j.Pb(L.g),j.Pb(j.i),j.Pb(sS),j.Pb(ne.c))},OS.\u0275cmp=j.Jb({type:OS,selectors:[["app-view-tools"]],viewQuery:function(e,t){var n;1&e&&(j.Pc(dS,!0),j.Pc(gS,!0)),2&e&&(j.sc(n=j.dc())&&(t.chapterCount=n.first),j.sc(n=j.dc())&&(t.mediaToggle=n.first))},inputs:{animate:"animate",mode:"mode",collapsePagination:"collapsePagination",collapseScrubber:"collapseScrubber"},outputs:{modeChange:"modeChange"},features:[j.Cb([sS])],decls:3,vars:2,consts:[["role","toolbar","aria-label","Tools","data-test","viewTools",1,"view-tools"],[4,"ngIf"],["class","view-tools__group","role","navigation","aria-label","Chapters",4,"ngIf"],["class","view-tools__group",4,"ngIf"],["role","navigation","aria-label","Chapters",1,"view-tools__group"],["data-test","viewToolsPreviousChapter","aria-label","Previous Chapter","app-pin-button","","buttonType","ghost","icon","chevron-left",1,"view-tools__item",3,"disabled","matTooltip","click"],["data-test","viewToolsNextChapter","aria-label","Next Chapter","app-pin-button","","buttonType","ghost","icon","chevron-right",1,"view-tools__item",3,"disabled","matTooltip","click"],[1,"view-tools__group"],["buttonShape","rounded"],["aria-hidden","true",1,"ph-2","text-13","text-semibold",2,"white-space","nowrap"],["icon","caret-up",1,"ml-2"],[1,"visually-hidden"],["data-test","viewToolsPlay","app-pin-button","","buttonType","ghost","class","view-tools__item",3,"icon","matTooltip","click",4,"ngIf"],["data-test","viewToolsMedia","app-pin-button","","buttonType","ghost","class","view-tools__item","aria-label","Open Media Bar","matTooltip","Open Media Bar",3,"click",4,"ngIf"],["data-test","viewToolsPlay","app-pin-button","","buttonType","ghost",1,"view-tools__item",3,"icon","matTooltip","click"],["data-test","viewToolsMedia","app-pin-button","","buttonType","ghost","aria-label","Open Media Bar","matTooltip","Open Media Bar",1,"view-tools__item",3,"click"],[2,"width","32px","margin","0 8px",3,"showHandle"],["role","radiogroup",1,"flex"],["app-pin-button","","buttonType","ghost","icon","mouse-pointer","aria-label","Select","matTooltip","Select","data-test","viewToolsSelect",1,"view-tools__item",3,"selected","click"],["app-pin-button","","buttonType","ghost","icon","eye-slash","aria-label","Hide","matTooltip","Hide","data-test","viewToolsHide",1,"view-tools__item",3,"selected","click"],["app-pin-button","","appHideIE11","","buttonType","ghost","aria-label","Fade","matTooltip","Fade","icon","adjust","data-test","viewToolsFade",1,"view-tools__item",3,"selected","click"]],template:function(e,t){1&e&&(j.Vb(0,"div",0),j.Ic(1,yS,4,3,"ng-container",1),j.Ic(2,xS,12,18,"ng-container",1),j.Ub()),2&e&&(j.Db(1),j.lc("ngIf",t.mode===t.viewToolsMode.Main),j.Db(1),j.lc("ngIf",t.mode===t.viewToolsMode.Tools))},directives:[we.l,Dg,Lg.c,Xf,vp,AC,lS],pipes:[we.b],styles:[".text-8{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-28{font-size:28px;letter-spacing:.7px;line-height:1.4em}.text-28.text-uppercase{font-size:28px;letter-spacing:1.68px;line-height:1.25em;text-transform:uppercase}.text-header{font-weight:700}.text--code{font-family:Courier New,Courier,monospace}.text-uppercase{text-transform:uppercase}.text-xlight{font-weight:200}.text-light{font-weight:300}.text-medium{font-weight:500}.text-semibold{font-weight:600}.text-bold{font-weight:700}.text-underline{text-decoration:underline}.text-italic{font-style:italic}.text-bright{color:#fff}.text-dim{color:#96a8c0}.text-error{color:#ed4758}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.text-ellipsis{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link,.text-link:visited{color:inherit;cursor:pointer}.text-link:not(.text-underline),.text-link:visited:not(.text-underline){text-decoration:none}.text-success{color:#38de38}.text-danger{color:#de3535}.text-info{color:#2d72dc}.text-nowrap{white-space:nowrap}.text-pre-line{white-space:pre-line}.view-tools{display:flex;justify-content:center;overflow:hidden}@-webkit-keyframes viewToolsToggle{0%{opacity:1}50%{opacity:0}to{opacity:1}}@keyframes viewToolsToggle{0%{opacity:1}50%{opacity:0}to{opacity:1}}.view-tools--swap{-webkit-animation:viewToolsToggle .3s ease-in-out;animation:viewToolsToggle .3s ease-in-out}.view-tools--dense .view-tools__divider{margin:4px}.view-tools__inner{display:flex;justify-content:center}.view-tools__group{border-right:1px solid rgba(0,0,0,.1);padding:0 8px;display:flex}.view-tools__group:empty{display:none}.view-tools__group:empty:first-of-type+.view-tools__group:not(:empty),.view-tools__group:first-of-type{padding-left:0}.view-tools__group:last-of-type{border-right:none;padding-right:0}.view-tools__item{display:flex;align-items:center}.view-tools__item:not(:last-child){margin-right:4px}.view-tools__divider{border-right:1px solid rgba(0,0,0,.1);margin:4px 8px}.view-tools__count{font-size:12px;letter-spacing:.3px;line-height:1.4em;white-space:nowrap}"],encapsulation:2,changeDetection:0}),pS([Object(L.d)(vs.getSelectedChapterReadyState),uS("design:type",J.a)],OS.prototype,"selectedChapterReady$",void 0),pS([Object(L.d)(zs.getActiveTool),uS("design:type",J.a)],OS.prototype,"activeTool$",void 0),pS([Object(L.d)(hs.getPresentationActive),uS("design:type",J.a)],OS.prototype,"presentationActive$",void 0),pS([Object(L.d)(vs.getIsChapterAnimated),uS("design:type",J.a)],OS.prototype,"isChapterAnimated$",void 0),pS([Object(L.d)(zs.getShowLabels),uS("design:type",J.a)],OS.prototype,"showLabels$",void 0),pS([Object(L.d)(zs.getAnimationPlaying),uS("design:type",J.a)],OS.prototype,"animationPlaying$",void 0),pS([Object(L.d)(kc.getChapterLabels),uS("design:type",J.a)],OS.prototype,"labels$",void 0),pS([Object(L.d)(vs.getSelectedChapterTitle),uS("design:type",J.a)],OS.prototype,"chapterTitle$",void 0),pS([Object(L.d)(vs.getSelectedChapterIndex),uS("design:type",J.a)],OS.prototype,"chapterIndex$",void 0),pS([Object(L.d)(vs.getNextChapter),uS("design:type",J.a)],OS.prototype,"nextChapter$",void 0),pS([Object(L.d)(vs.getPreviousChapter),uS("design:type",J.a)],OS.prototype,"previousChapter$",void 0),pS([Object(L.d)(vs.getChapterCount),uS("design:type",J.a)],OS.prototype,"chapterCount$",void 0),pS([Object(L.d)(hs.getCanTouch),uS("design:type",J.a)],OS.prototype,"canTouch$",void 0),OS),SS=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},_S=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},jS=["slider"],PS=["track"],MS=["bar"],IS=["handle"],zS=function(e){return{"view-layers-slider__handle-touch":e}},TS=((wS=function(){function e(t,n,i){y(this,e),this.renderer=t,this.visibilityLayersService=n,this.changeDetectorRef=i,this.ngUnsubscribe=new Z.a,this.currentLayers=[],this.fullOffset=0,this.dragMove=new Z.a,this.dragPosition={x:0,y:0},this.currentLayerName="",this.currentOffset=0}return v(e,[{key:"ngOnInit",value:function(){this.initLayersObserver(),this.initIndexPositionObserver(),this.initDragMoveObserver()}},{key:"ngAfterViewInit",value:function(){var e=this;setTimeout((function(){e.handle.nativeElement.focus()}),200),this.fullOffset=this.track.nativeElement.offsetWidth}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"initLayersObserver",value:function(){var e=this;this.selectedChapterCurrentLayers$.pipe(Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){e.currentLayers=t}))}},{key:"initIndexPositionObserver",value:function(){var e=this;Object(zc.b)([this.selectedChapterCurrentLayersIndex$,this.selectedChapterCurrentLayersPosition$,this.selectedChapterCurrentLayers$]).pipe(Object(Y.a)((function(e){var t=d(e,3),n=t[0],i=t[1],o=t[2];return!Object(ie.isNil)(n)&&!Object(ie.isNil)(i)&&!Object(ie.isNil)(o)})),Object(Gp.a)(0),Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){var n=d(t,3),i=n[0],o=n[1],r=n[2];e.currentLayerName=r[i].name;var a=e.visibilityLayersService.indexPositionToFraction(i,o);e.currentOffset=Math.round(100*a),e.setSliderBar(a),e.setSliderHandle(a)}))}},{key:"initDragMoveObserver",value:function(){var e=this;this.dragMove.pipe(Object(Jp.a)(20),Object(X.a)(this.ngUnsubscribe)).subscribe((function(){return e.handleAuditedDrag()}))}},{key:"handleDragEnded",value:function(){var e=this.calculateHandleFraction(),t=this.visibilityLayersService.fractionToIndex(e),n=this.visibilityLayersService.fractionToPosition(e,t);this.visibilityLayersService.recordLayerIndexPosition(t,n)}},{key:"handleDragMoved",value:function(e){this.dragMove.next(e)}},{key:"handleAuditedDrag",value:function(){var e=this.calculateHandleFraction(),t=this.visibilityLayersService.fractionToIndex(e),n=this.visibilityLayersService.fractionToPosition(e,t);this.currentLayerName=this.currentLayers[t].name,this.visibilityLayersService.synchronizeScene(t,n,!1),this.setSliderBar(e)}},{key:"handleTrackClick",value:function(e){var t=e.offsetX/this.fullOffset,n=this.visibilityLayersService.fractionToIndex(t),i=this.visibilityLayersService.fractionToPosition(t,n);this.visibilityLayersService.recordLayerIndexPosition(n,i)}},{key:"handleKeyDown",value:function(e){switch(e.key){case"Home":this.handleIncriment(-1),e.stopPropagation();break;case"End":this.handleIncriment(1),e.stopPropagation();break;case"PageDown":this.handleIncriment(-.1),e.stopPropagation();break;case"PageUp":this.handleIncriment(.1),e.stopPropagation();break;case"ArrowLeft":case"ArrowDown":this.handleIncriment(-.01),e.stopPropagation();break;case"ArrowRight":case"ArrowUp":this.handleIncriment(.01),e.stopPropagation()}}},{key:"handleIncriment",value:function(e){var t=Object(ie.clamp)(this.calculateHandleFraction()+e,0,1),n=this.visibilityLayersService.fractionToIndex(t),i=this.visibilityLayersService.fractionToPosition(t,n);this.visibilityLayersService.recordLayerIndexPosition(n,i)}},{key:"calculateHandleFraction",value:function(){var e=this.slider.nativeElement.getBoundingClientRect();return(this.handle.nativeElement.getBoundingClientRect().left-e.left)/this.fullOffset}},{key:"setSliderBar",value:function(e){this.renderer.setStyle(this.bar.nativeElement,"width",100*e+"%")}},{key:"setSliderHandle",value:function(e){this.dragPosition={x:e*this.fullOffset,y:this.dragPosition.y},this.changeDetectorRef.markForCheck()}}]),e}()).\u0275fac=function(e){return new(e||wS)(j.Pb(j.H),j.Pb(cu),j.Pb(j.i))},wS.\u0275cmp=j.Jb({type:wS,selectors:[["app-view-layers-slider"]],viewQuery:function(e,t){var n;1&e&&(j.Ec(jS,!0),j.Ec(PS,!0),j.Ec(MS,!0),j.Ec(IS,!0)),2&e&&(j.sc(n=j.dc())&&(t.slider=n.first),j.sc(n=j.dc())&&(t.track=n.first),j.sc(n=j.dc())&&(t.bar=n.first),j.sc(n=j.dc())&&(t.handle=n.first))},decls:9,vars:8,consts:[[1,"view-layers-slider"],["slider",""],[1,"view-layers-slider__track",3,"click"],["track",""],[1,"view-layers-slider__bar"],["bar",""],["cdkDrag","","cdkDragLockAxis","x","cdkDragBoundary",".view-layers-slider","role","slider","tabindex","0","aria-valuemin","0","aria-valuemax","100",1,"view-layers-slider__handle",3,"cdkDragFreeDragPosition","ngClass","matTooltip","cdkDragEnded","cdkDragMoved","keydown"],["handle",""]],template:function(e,t){1&e&&(j.Vb(0,"div",0,1),j.Vb(2,"div",2,3),j.cc("click",(function(e){return t.handleTrackClick(e)})),j.Qb(4,"div",4,5),j.Ub(),j.Vb(6,"div",6,7),j.cc("cdkDragEnded",(function(){return t.handleDragEnded()}))("cdkDragMoved",(function(e){return t.handleDragMoved(e)}))("keydown",(function(e){return t.handleKeyDown(e)})),j.hc(8,"async"),j.Ub(),j.Ub()),2&e&&(j.Db(6),j.lc("cdkDragFreeDragPosition",t.dragPosition)("ngClass",j.nc(6,zS,j.ic(8,4,t.canTouch$)))("matTooltip",t.currentLayerName),j.Eb("aria-valuenow",t.currentOffset))},directives:[fa.a,we.i,Lg.c],pipes:[we.b],styles:['.view-layers-slider[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:center;align-items:center;height:28px;width:100%}.view-layers-slider__track[_ngcontent-%COMP%]{position:absolute;background:rgba(150,168,192,.6);z-index:1;height:5px;border-radius:5px;left:14px;right:14px}.view-layers-slider__bar[_ngcontent-%COMP%]{position:absolute;background:#374a68;height:5px;border-radius:5px;z-index:2;width:0;left:0;pointer-events:none}.view-layers-slider__handle[_ngcontent-%COMP%]{width:28px;height:28px;margin-left:-14px;left:14px;display:flex;align-items:center;justify-content:center;position:absolute;z-index:2}.view-layers-slider__handle--hide[_ngcontent-%COMP%]{display:none}.view-layers-slider__handle[_ngcontent-%COMP%]:after{content:"";width:12px;height:12px;border-radius:6px;background:#374a68;box-shadow:1px -1px 2px 0 rgba(28,42,63,.1),0 1px 2px 0 rgba(28,42,63,.3)}.view-layers-slider__handle[_ngcontent-%COMP%]:hover:after{background:#2d72dc}'],changeDetection:0}),SS([Object(L.d)(vs.getSelectedChapterCurrentLayers),_S("design:type",J.a)],wS.prototype,"selectedChapterCurrentLayers$",void 0),SS([Object(L.d)(vs.getSelectedChapterCurrentLayersIndex),_S("design:type",J.a)],wS.prototype,"selectedChapterCurrentLayersIndex$",void 0),SS([Object(L.d)(vs.getSelectedChapterCurrentLayersPosition),_S("design:type",J.a)],wS.prototype,"selectedChapterCurrentLayersPosition$",void 0),SS([Object(L.d)(hs.getCanTouch),_S("design:type",J.a)],wS.prototype,"canTouch$",void 0),wS),US=function(e,t,n){return{"view-layers-bar__slider--large":e,"view-layers-bar__slider--small":t,"view-layers-bar__slider--disabled":n}},DS=((kS=function(){function e(t,n,i){y(this,e),this.store=t,this.engineService=n,this.changeDetectorRef=i,this.ngUnsubscribe=new Z.a,this.assetsLoading=!1}return v(e,[{key:"ngOnInit",value:function(){var e=this;this.engineService.getEvent(yn.AssetsLoadProgress).pipe(Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){e.assetsLoading=t.requestedAssets!==t.receivedAssets,e.changeDetectorRef.markForCheck()}))}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"isLarge",value:function(){return this.store.selectSnapshot(tl.getBreakpoint)>=Gc.Medium}}]),e}()).\u0275fac=function(e){return new(e||kS)(j.Pb(L.g),j.Pb(Sn),j.Pb(j.i))},kS.\u0275cmp=j.Jb({type:kS,selectors:[["app-view-layers-bar"]],decls:2,vars:5,consts:[[1,"view-layers-bar"],[1,"view-layers-bar__slider",3,"ngClass"]],template:function(e,t){1&e&&(j.Vb(0,"div",0),j.Qb(1,"app-view-layers-slider",1),j.Ub()),2&e&&(j.Db(1),j.lc("ngClass",j.pc(1,US,t.isLarge(),!t.isLarge(),t.assetsLoading)))},directives:[TS,we.i],styles:[".view-layers-bar[_ngcontent-%COMP%]{display:flex}.view-layers-bar__slider[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;margin-left:4px}.view-layers-bar__slider--large[_ngcontent-%COMP%]{width:300px}.view-layers-bar__slider--small[_ngcontent-%COMP%]{width:180px}.view-layers-bar__slider--disabled[_ngcontent-%COMP%]{opacity:.25;pointer-events:none}"],changeDetection:0}),kS),LS=["viewToolbar"],ES=["exploreTrigger"];function FS(e,t){if(1&e&&(j.Vb(0,"app-pillbox",6),j.Qb(1,"app-view-tools",7),j.Ub()),2&e){var n=j.gc(2);j.Db(1),j.lc("collapsePagination",n.collapsePagination)("collapseScrubber",n.collapseScrubber)("mode",n.viewToolsMode.Main)}}function AS(e,t){if(1&e){var n=j.Wb();j.Vb(0,"app-pillbox",8),j.Vb(1,"button",9,10),j.cc("click",(function(){return j.xc(n),j.gc(2).handleExploreToolsClick()})),j.Ub(),j.Ub()}2&e&&(j.Db(1),j.lc("matTooltip","Explore"),j.Eb("aria-label","Explore"))}function RS(e,t){if(1&e&&(j.Vb(0,"div",3),j.Ic(1,FS,2,3,"app-pillbox",4),j.Ic(2,AS,3,2,"app-pillbox",5),j.Ub()),2&e){var n=j.gc();j.lc("@inOutAnimation",void 0),j.Db(1),j.lc("ngIf",n.isVisible(n.viewUI.Pagination)||n.isVisible(n.viewUI.Mediabar)),j.Db(1),j.lc("ngIf",n.isEnabled(n.viewUI.Tools))}}function VS(e,t){if(1&e){var n=j.Wb();j.Vb(0,"div",3),j.Vb(1,"app-pillbox",11),j.cc("exit",(function(){return j.xc(n),j.gc().handleExitClick()})),j.Qb(2,"app-view-media-bar",12),j.Ub(),j.Ub()}if(2&e){var i=j.gc();j.lc("@inOutAnimation",void 0),j.Db(1),j.lc("canExit",i.canExit),j.Db(1),j.lc("template",i.mediaTemplate)}}function NS(e,t){if(1&e){var n=j.Wb();j.Vb(0,"div",3),j.Vb(1,"app-pillbox",13),j.cc("exit",(function(){return j.xc(n),j.gc().handleExitClick()})),j.Qb(2,"app-view-tools",14),j.Ub(),j.Ub()}if(2&e){var i=j.gc();j.lc("@inOutAnimation",void 0),j.Db(1),j.lc("canExit",i.canExit),j.Db(1),j.lc("mode",i.viewToolsMode.Tools)}}function BS(e,t){if(1&e){var n=j.Wb();j.Vb(0,"div",3),j.Vb(1,"app-pillbox",15),j.cc("exit",(function(){return j.xc(n),j.gc().handleExitClick()})),j.Qb(2,"app-view-layers-bar"),j.Ub(),j.Ub()}if(2&e){var i=j.gc();j.lc("@inOutAnimation",void 0),j.Db(1),j.lc("canExit",i.canExit)}}var HS,QS,qS,$S,WS,KS,GS,ZS=((HS=function(){function e(t,n,i,o,r){y(this,e),this.store=t,this.changeDetectorRef=n,this.viewService=i,this.viewUIService=o,this.elementRef=r,this.viewUI=nl,this.canExit=!0,this.mode=Lf.Main,this.lockMode=!1,this.position="center",this.ngUnsubscribe=new Z.a,this.breakpoint=Gc,this.viewToolsMode=Lf,this.viewLayout=nl,this.collapsePagination=!1,this.collapseScrubber=!1,this.modeSubject=new kp.a(Lf.Main)}return v(e,[{key:"ngOnInit",value:function(){this.initLayoutListener(),this.initBreakpointListener(),this.initFocusListeners()}},{key:"initLayoutListener",value:function(){var e=this;this.store.select(hs.getUI).pipe(Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){e.lockMode||(e.mode=Lf.Main,e.viewUIService.isUIVisible(nl.Media)&&(e.mediaTemplate=t.media.template,e.mode=Lf.Media),e.viewUIService.isToolsVisible()&&(e.mode=Lf.Tools),e.viewUIService.isVisibilityLayersVisible()&&e.viewUIService.isUIVisible(nl.VisibilityLayers)&&(e.mode=Lf.VisibilityLayers),e.modeSubject.next(e.mode),e.changeDetectorRef.markForCheck())}))}},{key:"initBreakpointListener",value:function(){var e=this;this.store.select(tl.getBreakpoint).pipe(Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){var n=t<=Gc.Small;e.collapseScrubber=n,e.collapsePagination=n,e.changeDetectorRef.markForCheck()}))}},{key:"initFocusListeners",value:function(){var e=this,t=this.modeSubject.asObservable().pipe(Object(jC.a)(this.mode),Object(Cp.a)(),Object(Y.a)((function(e){var t=d(e,2),n=t[0],i=t[1];return n===Lf.Tools&&i===Lf.Main})),Object(Zc.a)(),Object(X.a)(this.ngUnsubscribe));Object(ka.a)(this.elementRef.nativeElement,"keypress").pipe(Object(PC.a)((function(){return e.mode===Lf.Tools})),Object(tc.a)((function(){return t.pipe(Object(X.a)(Object(_C.a)(125)))})),Object(Gp.a)(301),Object(X.a)(this.ngUnsubscribe)).subscribe((function(){e.exploreTrigger&&e.exploreTrigger.focus()}))}},{key:"isVisible",value:function(e){return this.viewUIService.isVisible(e)}},{key:"isEnabled",value:function(e){return this.viewUIService.isUIEnabled(e)}},{key:"handleExitClick",value:function(){var e=this.store.selectSnapshot(hs.getUI);e.media.status=ba.Hide,e.tools.status=ba.Hide,e.visibilityLayers.status=ba.Hide,this.viewService.selectTool(ks.Select),this.store.dispatch(new _.SetUI(e))}},{key:"handleExploreToolsClick",value:function(){this.viewService.toggleToolbar("tools")}}]),e}()).\u0275fac=function(e){return new(e||HS)(j.Pb(L.g),j.Pb(j.i),j.Pb(Wp),j.Pb(pl),j.Pb(j.m))},HS.\u0275cmp=j.Jb({type:HS,selectors:[["app-view-toolbar"]],viewQuery:function(e,t){var n;1&e&&(j.Pc(LS,!0),j.Pc(ES,!0)),2&e&&(j.sc(n=j.dc())&&(t.viewToolbar=n.first),j.sc(n=j.dc())&&(t.exploreTrigger=n.first))},inputs:{canExit:"canExit",mode:"mode",lockMode:"lockMode",position:"position"},decls:5,vars:4,consts:[[3,"ngSwitch"],["data-test","viewToolbar","class","view-toolbar",4,"ngSwitchDefault"],["data-test","viewToolbar","class","view-toolbar",4,"ngSwitchCase"],["data-test","viewToolbar",1,"view-toolbar"],["eventCategory","View Primary Toolbar","name","Primary Toolbar",4,"ngIf"],["name","Explore Toolbar","class","ml-3",4,"ngIf"],["eventCategory","View Primary Toolbar","name","Primary Toolbar"],[3,"collapsePagination","collapseScrubber","mode"],["name","Explore Toolbar",1,"ml-3"],["data-test","viewExploreToolbar","icon","mouse-pointer","app-pin-button","","buttonType","ghost",3,"matTooltip","click"],["exploreTrigger",""],["eventCategory","View Media Bar","name","Media Bar",3,"canExit","exit"],[3,"template"],["eventCategory","View Explore Tools","name","Explore Tools",3,"canExit","exit"],[3,"mode"],["name","Visibility Layers",3,"canExit","exit"]],template:function(e,t){1&e&&(j.Tb(0,0),j.Ic(1,RS,3,3,"div",1),j.Ic(2,VS,3,3,"div",2),j.Ic(3,NS,3,3,"div",2),j.Ic(4,BS,3,2,"div",2),j.Sb()),2&e&&(j.lc("ngSwitch",t.mode),j.Db(2),j.lc("ngSwitchCase",t.viewToolsMode.Media),j.Db(1),j.lc("ngSwitchCase",t.viewToolsMode.Tools),j.Db(1),j.lc("ngSwitchCase",t.viewToolsMode.VisibilityLayers))},directives:[we.n,we.p,we.o,we.l,yC,CS,Dg,Lg.c,$C,DS],styles:[".view-toolbar{position:absolute;display:flex;z-index:20;bottom:0;right:0}"],encapsulation:2,data:{animation:[Object(du.n)("inOutAnimation",[Object(du.m)(":enter",[Object(du.l)({opacity:0,transform:"translateY(200px)"}),Object(du.e)("300ms ease-in-out",Object(du.l)({opacity:1,transform:"*"}))]),Object(du.m)(":leave",[Object(du.e)("300ms ease-in-out",Object(du.l)({transform:"translateY(200px)",opacity:0}))])])]},changeDetection:0}),HS),JS=function e(){y(this,e)},XS=r("MtjB"),YS=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},e_=(QS=function e(){y(this,e)},function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);r>3&&a&&Object.defineProperty(t,n,a)}([Object(ce.Type)((function(){return oc})),YS("design:type",String)],QS.prototype,"objectId",void 0),QS),t_=function e(){y(this,e)},n_=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},i_=(qS=function e(){y(this,e)},function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);r>3&&a&&Object.defineProperty(t,n,a)}([Object(ce.Type)((function(){return e_})),Object(ce.Type)((function(){return vn})),Object(ce.Type)((function(){return t_})),n_("design:type",String)],qS.prototype,"moduleId",void 0),qS),o_=function(e){return e.UserGeneratedTour="user_generated_tour",e.Animated="animated",e.Quiz="quiz",e.ModeQuiz="mode_quiz",e.ModeContent="mode_content",e}({}),r_=function(e){return e.Private="private",e.Group="enterprise",e.Public="public",e}({}),a_={headers:new Q.d({"Content-Type":"application/json; charset=utf-8"})},s_=(($S=function(){function e(t,n,i,o,r){y(this,e),this.store=t,this.http=n,this.serializeModuleService=i,this.storyService=o,this.productService=r}return v(e,[{key:"getBookmarkData",value:function(e){return this.http.get("/search/bookmarks/data?be="+e).pipe(Object(XS.a)((function(e){return e.pipe(Object(_c.a)(1e3),Object(Tc.a)(3))})),Object(se.a)((function(e){return(e=e.bookmark).moduleId=e.customData?e.customData.moduleId:e.modules.activeModules[0],Object(ce.plainToClass)(i_,e)})))}},{key:"getBookmarkModel",value:function(e){return this.http.get("/ws/search/bookmarks?eid="+e).pipe(Object(XS.a)((function(e){return e.pipe(Object(_c.a)(1e3),Object(Tc.a)(3))})),Object(se.a)((function(e){return Object(ce.plainToClass)(ue,e.bookmark_info)})),Object(se.a)((function(e){return ge(e)})))}},{key:"getUserBookmarks",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e4,i=arguments.length>3?arguments[3]:void 0,o={q:t,page_size:""+n};return Object(ie.isNil)(i)||(o.is_owner=""+(i?1:0)),this.http.get("/ws/search/bookmarks/"+e,{params:o}).pipe(Object(XS.a)((function(e){return e.pipe(Object(_c.a)(1e3),Object(Tc.a)(3))})),Object(se.a)((function(e){return e.map((function(e){return Object(ce.plainToClass)(ue,e)})).map((function(e){return ge(e)}))})))}},{key:"getUserConditions",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e4,o="";switch(e){case r_.Private:o="user";break;case r_.Group:o="group"}return this.http.get("/ws/search/conditions/private?q=".concat(t,"&page_size=").concat(i)).pipe(Object(se.a)((function(e){return e.filter((function(e){return e.module_accessor_level===o&&(!n||e.module_accessor_id===n)}))})),Object(se.a)((function(e){return Object(ce.plainToClass)(ue,e)})),Object(se.a)((function(e){return e.map((function(e){return ge(e)}))})))}},{key:"getPrivateBookmarks",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e4;return this.getUserBookmarks(r_.Private,e,t,!0)}},{key:"getPrivateConditions",value:function(){return this.getUserConditions(r_.Private)}},{key:"getOrganizationBookmarks",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e4;return this.getUserBookmarks(r_.Private,t,n).pipe(Object(se.a)((function(t){return t.filter((function(e){return e.tags.includes("enterprise")})).filter((function(t){return t.group_access.some((function(t){return t.group_id===e}))}))})))}},{key:"getOrganizationConditions",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return this.getUserConditions(r_.Group,t,e)}},{key:"getOrganizationContent",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return Object(Ls.a)([this.getOrganizationBookmarks(e,t),this.getOrganizationConditions(e,t)]).pipe(Object(se.a)((function(e){var t=d(e,2),n=t[0],i=t[1];return[].concat(p(n),p(i))})))}},{key:"getPrivateContent",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return Object(Ls.a)([this.getPrivateBookmarks(e),this.getPrivateConditions(e)]).pipe(Object(se.a)((function(e){var t=d(e,2),n=t[0],i=t[1];return[].concat(p(n),p(i))})))}},{key:"createBookmarkStory",value:function(e){return this.serializeModuleService.serialize({},new Sc,!1,this.store.selectSnapshot(Ic.getStory),this.store.selectSnapshot(vs.getStoryChapters),e)}},{key:"getPublicBookmarks",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this.getUserBookmarks(r_.Public,e)}},{key:"saveBookmark",value:function(e){var t=this,n=this.getNormalizedBookmarkEntry(e);return this.http.post(e.id?"/ws/user/bookmark/v4/update":"/ws/user/bookmark/v4/save",n,a_).pipe(Object(vr.a)((function(e){return t.getBookmarkModel(e.id)})))}},{key:"deleteBookmark",value:function(e){return this.http.delete("/ws/user/bookmark/v4/delete?eid=".concat(e,"&app_producttype=").concat(this.productService.productType,"&app_productkey=").concat(this.productService.productKey)).pipe(Object(xr.a)((function(e){var t=e.error.error,n=t?t.message:"";return Object(_s.a)(n)})))}},{key:"atMaxFreeBookmarkCount",value:function(){return this.http.get("/ws/user/content/limit/check?version=2").pipe(Object(xr.a)((function(e){return Object(br.a)({limit_reached:!1})})))}},{key:"filterByTags",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return e.filter((function(e){return n?t.every((function(t){return e.tags.includes(t)})):t.some((function(t){return e.tags.includes(t)}))}))}},{key:"getGalleryTags",value:function(e){if(e){var t=[],n=function(e,t){var n=jx(e,my.EditBookmarks);return!!n&&(t.type===M.Module?n:!(!0!==t.is_owner)||!!Px(t)&&function(e,t){if(jx(e,my.EditAllTeamBookmarks))return!0;var n=jx(e,my.EditTeamBookmarks),i=Px(t)&&t.group_access[0].member_edit;return n&&i}(e,t))}(this.store.selectSnapshot(Ex.getUserRole),e);return e.type===M.Bookmark&&!n&&t.push("View Only"),e.animated&&t.push("Animated"),e.tour&&t.push("Tour"),e.quiz&&t.push("Quiz"),t}return[]}},{key:"getShowcase",value:function(e){var t=this,n=[],i=this.getPrivateBookmarks("",10).pipe(Object(se.a)((function(e){return t.createPrivateShowcase(e)})));if(n.push(i),!Object(ie.isNil)(e)){var o=this.getOrganizationBookmarks(e.id,"",10).pipe(Object(se.a)((function(n){return t.createOrganizationShowcase(n,e)})));n.push(o)}return Object(Ls.a)(n)}},{key:"createMockBookmark",value:function(e){return Object.assign({author:"",author_first_name:"",author_last_name:"",cost:0,create_date_time:new Date,description:"",id:"",is_owner:!0,last_editor:"",last_editor_first_name:"",last_editor_last_name:"",tags:[],thumbnail_url:"",title:"",update_date_time:new Date,type:M.Bookmark},e?{animated:!0,tour:!0}:{})}},{key:"createMockBookmarks",value:function(e){var t=this;return p(Array(e).keys()).map((function(e){return t.createMockBookmark(e%2==0)}))}},{key:"createPrivateShowcase",value:function(e){return{title:"Pick up where you left off",description:"",url:"/results/bookmarks?type=Private",bookmarks:e}}},{key:"createOrganizationShowcase",value:function(e,t){return{title:"Recently added to "+t.name,description:"Recently added models to your Team library.",url:"/results/bookmarks?organizationId=".concat(t.id,"&type=Organization"),bookmarks:e}}},{key:"translateBookmark",value:function(e,t,n,i){var o=this,r=n===M.Module||n===M.Internal?t.replace(".json",""):t;return Object(Ls.a)([this.storyService.getStory(e,M.Bookmark),this.storyService.getStoryTranslation(r,n,i)]).pipe(Object(se.a)((function(e){var t=d(e,2),n=t[0],i=t[1];return o.storyService.translateStory(n,i)})),Object(vr.a)((function(t){return o.saveBookmark({isOwner:!0,title:t.displayName.substr(0,60),id:e,index:t})})),Object(se.a)((function(e){return e.id})),Object(xr.a)((function(t){return 404===t.status?Object(br.a)(e):Object(_s.a)(t)})))}},{key:"getNormalizedBookmarkEntry",value:function(e){var t,n,i,o,r=this;if(e.isOwner){if(t=e.add_group_access?this.getGroupAccess(e.add_group_access):[],e.remove_group_access&&e.remove_group_access.forEach((function(e){var n=r.getNormalizeGroupAccess({group_id:e.group_id,remove:!0});t.push(n)})),n=this.getNormalizedBool(e.public_access),e.index){i={},e.index.chapters&&(i[o_.UserGeneratedTour]=this.getNormalizedBool(e.index.chapters.length>1));var a=(e.index.tags||[]).includes("animated");i[o_.Animated]=this.getNormalizedBool(a),i[o_.ModeQuiz]=this.getNormalizedBool(e.viewMode===de.Quiz),i[o_.ModeContent]=this.getNormalizedBool(e.viewMode===de.Content);var s=Object(ie.get)(e.index,"quizSettings.enabled",!1);i[o_.Quiz]=this.getNormalizedBool(s)}o=this.getNormalizedBool(e.is_content_copy)}return{eid:e.id,name:e.title,description:e.description,index:e.index,group_access:t,public_access:n,flags:i,is_content_copy:o,app_producttype:this.productService.productType,app_productkey:this.productService.productKey}}},{key:"getGroupAccess",value:function(e){var t=this;return e.map((function(e){return t.getNormalizeGroupAccess(e)}))}},{key:"getNormalizeGroupAccess",value:function(e){var t=e.group_id,n=e.group_name,i=e.member_edit,o=e.visible,r=e.remove;return{group_id:t,group_name:n,member_edit:this.getNormalizedBool(i),visibility:this.getNormalizedBool(o),remove:this.getNormalizedBool(r)}}},{key:"getNormalizedBool",value:function(e){return!0===e?"1":!1===e?"0":""}}]),e}()).\u0275fac=function(e){return new(e||$S)(j.Zb(L.g),j.Zb(Q.b),j.Zb(Cc),j.Zb(Qs),j.Zb(Ry))},$S.\u0275prov=j.Lb({token:$S,factory:$S.\u0275fac,providedIn:"root"}),$S),c_={label:"Relevance",fields:[],ascending:!0},l_={label:"Most Recent",fields:["collection_content_createdate","update_date_time","create_date_time"],ascending:!1},p_={label:"Title (A-Z)",fields:["title"],ascending:!0},u_={label:"Title (Z-A)",fields:["title"],ascending:!1},d_={label:"Author (A-Z)",fields:["author"],ascending:!0},g_={label:"Author (Z-A)",fields:["author"],ascending:!1},h_=function(e){return e.Enabled="enabled",e.Disabled="disabled",e.Locked="locked",e}({}),f_=function e(){y(this,e),this.background={colors:null},this.uiAnnotations=!1,this.uiAudio=!1,this.uiInfo=!0,this.uiFullscreen=!0,this.uiScrubber=!1,this.uiHelp=!0,this.uiBd="",this.loadRotate=null,this.initial={button:!1,handHint:!1,play:!1},this.disableScroll={alert:!1,overlay:!1},this.uiQuiz={mode:h_.Enabled,number:void 0},this.autoLoad=!0,this.uiTour=!1,this.uiNav=!0,this.uiSearch=!0,this.uiTools=!0,this.uiUndo=!0,this.uiLabelList=!0,this.uiChapterList=!1,this.all=!1,this.collapseLabel=null,this.uiMenu=!0,this.uiAnatomyDescriptions=!1,this.uiTutorial=!1,this.uiLegend=!0,this.uiLoader=ya,this.uiWhiteboard=!0,this.uiVisibilityLayers=!0,this.uiAnatomyLabels=!0},b_={title:"Desktop",type:"desktop",dimensions:{width:700,height:550},orientation:"vertical"},m_=r("P6Fj"),v_=new j.s(""),y_=new j.s(""),x_=T.deploy===I.Production?"https://human.biodigital.com":window.location.origin,O_=T.deploy===I.Local?"https://localhost:4202":x_+"/viewer",w_=((WS=function e(){y(this,e)}).\u0275mod=j.Nb({type:WS}),WS.\u0275inj=j.Mb({factory:function(e){return new(e||WS)},providers:[{provide:v_,useValue:x_},{provide:y_,useValue:O_}],imports:[[we.c]]}),WS),k_=function(e){return e.Single="share.widget.link",e.Bulk="share.widget.export",e}({}),C_={headers:new Q.d({"Content-Type":"application/json; charset=utf-8"})},S_=new f_,__={id:"embedded-human",dimensions:b_.dimensions,fullScreen:!0},j_=((KS=function(){function e(t,n,i,o,r,a,s,c){y(this,e),this.http=t,this.cameraService=n,this.numberService=i,this.orgnanizationService=o,this.contentViewService=r,this.matSnackbar=a,this.APP_BASE_URL=s,this.VIEWER_BASE_URL=c}return v(e,[{key:"exportBookmarks",value:function(e,t,n,i,o,r,a,s){var c=this,l=arguments.length>8&&void 0!==arguments[8]&&arguments[8],p=arguments.length>9&&void 0!==arguments[9]?arguments[9]:"";this.matSnackbar.open("Exporting ".concat(e.length," models to CSV..."));var u=[{label:"Title",field:"title"},{label:"ID",field:"id"},{label:"Collection",field:"collection"},{label:"URL",field:"url"},{label:"iFrame",field:"iFrame"},{label:"Author",field:"author"},{label:"Thumbnail URL",field:"thumbnail_url"},{label:"Created Date",field:"create_date_time"},{label:"Updated Date",field:"update_date_time"}];l&&u.push({label:"Offline Package URL",field:"offline_url"});var g=s?Object(br.a)(null):this.getUAID(k_.Bulk),h=l?this.getDownloadURLs(e):Object(br.a)([]),f=new Map,b=n.length?Object(Ls.a)(n.map((function(e){return c.orgnanizationService.getCollectionContent(t,e.collection_id).pipe(Object(se.a)((function(t){t.forEach((function(t){f.set(t.id,e)}))})))}))):Object(br.a)(!0);return Object(Ls.a)([g,h,b]).pipe(Object(se.a)((function(t){var n=d(t,2),l=n[0],u=n[1];return e.map((function(e,t){var n,d,g=e.id,h=e.title,b=e.author,m=e.thumbnail_url,v=e.create_date_time,y=e.update_date_time,x=null!==(d=null===(n=f.get(e.id))||void 0===n?void 0:n.collection_name)&&void 0!==d?d:"",O=c.getWidgetURL(e,i,o,null,l,a,s,p),w=c.getWidgetEmbed(O,r),k=c.buildThumbnailURL(m),C=u[t]||"";return{title:h,id:g,collection:x,url:O,iFrame:w,author:b,thumbnail_url:k,create_date_time:Object(we.v)(new Date(v),"shortDate","en"),update_date_time:Object(we.v)(new Date(y),"shortDate","en"),offline_url:C}}))})),Object(tc.a)((function(e){return function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=new m_.a,o=[];return n&&o.push(t.map((function(e){return e.label}))),e.forEach((function(e){var n=t.map((function(t){return e[t.field]}));o.push(n)})),new J.a((function(e){var t=i.unparse(o,{quotes:!0,header:!1});e.next(t),e.complete()}))}(e,u)})),Object(tc.a)((function(e){var t="BioDigital-Widgets-".concat((new Date).toISOString().split("T")[0],"-export.csv"),n=new Blob([e],{type:"text/csv;charset=utf-8"});return Object(Cr.saveAs)(n,t),Object(br.a)(!0)})))}},{key:"generateWidgetURL",value:function(e,t,n,i,o,r,a,s){var c=this,l=a||!o?Object(br.a)(null):this.getUAID(o);return Object(Ls.a)([l,this.contentViewService.trackContentPublish(e.id,e.type)]).pipe(Object(se.a)((function(o){var l=d(o,1)[0];return c.getWidgetURL(e,t,n,i,l,r,a,s)})))}},{key:"getWidgetURL",value:function(e,t,n,i,o){var r=this,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"en",s=arguments.length>6?arguments[6]:void 0,c=arguments.length>7?arguments[7]:void 0;n=n||S_;var l="bookmark"===e.type,p={};p[l?"id":"m"]=""+(l?e.id:e.module_name);var u=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},p),this.getParamsForUIOptions(n||S_)),this.getParamsForLoadingExperience(n||S_)),this.getParamsForScrollMode(n||S_)),this.getParamsForLoadRotate(n||S_)),this.getParamsForLabelScale(n||S_)),d=Object(ie.get)(n,"background.colors");if(Array.isArray(d)&&d.length>=3){var g=d.slice(0,4).map((function(e){return r.numberService.roundNumber(e,3)}));u["background.colors"]=""+g}if(i){var h=this.cameraService.roundCamera(i,3),f=h.eye,b=h.look,m=h.up;u.camera=""+[f.x,f.y,f.z,b.x,b.y,b.z,m.x,m.y,m.z]}s?u.dk=s.app_apikey:o&&(u.uaid=o),a&&"en"!==a&&(u.lang=a),c&&(u.paid=c);var v=this.isCustomWidget(e.embed_url_path)?e.embed_url_path:t;return this.buildWidgetURL(v,u)}},{key:"generateWidgetEmbed",value:function(e,t,n,i,o,r,a,s,c){var l=this;return this.generateWidgetURL(e,t,n,o,r,a,s,c).pipe(Object(se.a)((function(e){return l.getWidgetEmbed(e,i)})))}},{key:"getWidgetEmbed",value:function(e,t){var n=t||__.dimensions,i=n.width,o=n.height;return'<iframe id="'.concat(__.id,'" frameBorder="0" width="').concat(i,'" height="').concat(o,'" allowFullScreen="').concat(__.fullScreen,'" loading="lazy" src="').concat(e,'"></iframe>')}},{key:"getImageEmbed",value:function(e,t,n){var i=("BioDigital Human: "+e).replace(/"/g,"&quot;");return'<a href="'.concat(t,'" target="_blank"><img src="').concat(n,'" alt="').concat(i,'" title="').concat(i,'" /></a>')}},{key:"getUAID",value:function(e){return this.http.post("/ws/user/analytics",{analytic_type:""+e,analytic_platform:"app"},C_).pipe(Object(se.a)((function(e){return e.id})))}},{key:"getDownloadURLs",value:function(e){var t=this,n=e.filter((function(e){return!e.favorite&&!e.unavailable})).map((function(e){return{type:e.type,id:"module"===e.type?e.module_name:e.id}}));return this.http.post("/ws/download/reserve",{content:n},{headers:{"Content-Type":"application/json"}}).pipe(Object(se.a)((function(n){var i=n.tokens;return e.map((function(e){var n=e.type,o="module"===e.type?e.module_name:e.id,r=i.find((function(e){return e.type===n&&e.id===o}));return r&&r.token?t.buildDownloadURL(r.token):""}))})),Object(xr.a)((function(){return Object(br.a)(e.map((function(){return""})))})))}},{key:"extendWidgetOptions",value:function(e,t){var n=this.expandWidgetOptions(t);return this.deepExtendWidgetOptions(e,n),e}},{key:"getWidgetConfig",value:function(e){var t=this,n={};return Object.keys(e).forEach((function(i){var o=e[i];if(null!==o){var r=t.getConfigName(i);n[r]=o}})),n}},{key:"getConfigName",value:function(e){var t=this.camelToDashCase(e).replace(/^ui-/g,"");return this.dashCaseToCamelCase(t)}},{key:"getParamsForLoadingExperience",value:function(e){return e.autoLoad?e.initial.button?{"initial.button":!0}:e.initial.handHint?{"initial.hand":!0}:e.initial.play?{"initial.play":!0}:{}:{"auto-load":!1}}},{key:"getParamsForScrollMode",value:function(e){return e.disableScroll.alert?{"disable-scroll.alert":!0}:e.disableScroll.overlay?{"disable-scroll":!0}:{"disable-scroll":!1}}},{key:"getParamsForLoadRotate",value:function(e){return"number"==typeof e.loadRotate?{"load-rotate":e.loadRotate}:{}}},{key:"getParamsForLabelScale",value:function(e){return{}}},{key:"getParamsForUIOptions",value:function(e){return Object.assign({"ui-info":e.uiInfo,"ui-search":e.uiSearch,"ui-undo":e.uiUndo,"ui-fullscreen":e.uiFullscreen,"ui-nav":e.uiNav,"ui-tools":e.uiTools,"ui-help":e.uiHelp,"ui-chapter-list":e.uiChapterList,"ui-label-list":e.uiLabelList,"ui-anatomy-descriptions":e.uiAnatomyDescriptions,"ui-tutorial":e.uiTutorial,"ui-loader":e.uiLoader,"ui-whiteboard":e.uiWhiteboard,"ui-layers":e.uiVisibilityLayers,"ui-anatomy-labels":e.uiAnatomyLabels},this.getParamsForUIQuiz(e))}},{key:"getParamsForUIQuiz",value:function(e){var t={},n=Object(ie.get)(e,"uiQuiz.mode"),i=Object(ie.get)(e,"uiQuiz.number");return n===h_.Disabled&&(t["ui-quiz"]=!1),n===h_.Locked&&(t["ui-quiz-locked"]=!0),Object(ie.isNil)(i)||(t["ui-quiz-start"]=i,t["ui-quiz-end"]=i),t}},{key:"camelToDashCase",value:function(e){return e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}},{key:"dashCaseToCamelCase",value:function(e){return e.replace(/-([a-z])/g,(function(e){return e[1].toUpperCase()}))}},{key:"isCustomWidget",value:function(e){return/widgets\/([^\/]+)\//.test(e)}},{key:"saveUserImage",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"jpeg";return this.http.post("/ws/user/image/v1-0",{image_src:e,image_type:t},C_).pipe(Object(se.a)((function(e){return e.url})))}},{key:"buildWidgetURL",value:function(e,t){var n=Object.entries(t).map((function(e){var t=d(e,2),n=t[0],i=t[1];return"".concat(n,"=").concat(i)})).join("&"),i="",o=e.replace(/^\/|\/$/g,"");return!1===t["auto-load"]&&"viewer"===o&&(o="tiny-viewer",i="/tiny-viewer"),T.deploy===I.Local?"".concat(this.VIEWER_BASE_URL).concat(i,"/?").concat(n):"".concat(this.APP_BASE_URL,"/").concat(o,"/?").concat(n)}},{key:"buildThumbnailURL",value:function(e){return"".concat(this.APP_BASE_URL).concat(e)}},{key:"buildDownloadURL",value:function(e){return"".concat(this.APP_BASE_URL,"/download?t=").concat(e)}},{key:"deepExtendWidgetOptions",value:function(e,t){var n=this;Object.entries(e).forEach((function(i){var o=d(i,2),r=o[0],a=o[1],s=typeof a;[r,n.camelToDashCase(r),n.getConfigName(r)].forEach((function(i){if(t.hasOwnProperty(i)&&null!==t[i]){var o=t[i],c=typeof o;null===a?e[r]=o:s===c&&("object"===s?n.deepExtendWidgetOptions(a,o):e[r]=o)}}))}))}},{key:"expandWidgetOptions",value:function(e){var t={};return Object.entries(e).forEach((function(n){var i=d(n,2),o=i[0],r=i[1],a=o.split(".");if(a.length>1){var s=a[0],c=a.slice(1).join(".");null!==t[s]&&"object"==typeof t[s]||(t[s]={}),t[s][c]=r}else t[o]=e[o]})),t}}]),e}()).\u0275fac=function(e){return new(e||KS)(j.Zb(Q.b),j.Zb(Xn),j.Zb(Zn),j.Zb(ye),j.Zb(_x),j.Zb(Sd.b),j.Zb(v_),j.Zb(y_))},KS.\u0275prov=j.Lb({token:KS,factory:KS.\u0275fac,providedIn:"root"}),KS),P_={main:[{title:"All Models",id:"all",type:"Category",translations:{es:{title:"Todas las Categor\xedas"},zh:{title:"\u6240\u6709\u7c7b\u522b"},fr:{title:"Toutes les cat\xe9gories"},de:{title:"Alle Kategorien"},it:{title:"Tutte le categorie"},ja:{title:"\u3059\u3079\u3066\u306e\u30ab\u30c6\u30b4\u30ea"},pt:{title:"Todas as categorias"}}}],categories:[{title:"Anatomy by Regions",id:"regional",type:"Category",translations:{es:{title:"Anatom\xeda por Regiones"},zh:{title:"\u5c40\u90e8\u89e3\u5256"},fr:{title:"Anatomie par r\xe9gions"},de:{title:"Anatomie nach Regionen"},it:{title:"Anatomia per regioni"},ja:{title:"\u5404\u90e8\u4f4d\u306e\u69cb\u9020"},pt:{title:"Anatomia por Regi\xf5es"}}},{title:"Anatomy by Systems",id:"system",type:"Category",translations:{es:{title:"Anatom\xeda por Sistemas"},zh:{title:"\u7cfb\u7edf\u89e3\u5256"},fr:{title:"Anatomie par syst\xe8mes"},de:{title:"Anatomie nach Systemen"},it:{title:"Anatomia per sistemi"},ja:{title:"\u5404\u5668\u5b98\u7cfb\u306e\u69cb\u9020"},pt:{title:"Anatomia por Sistemas"}}},{title:"Complete Anatomy",id:"complete anatomy",type:"Category",translations:{de:{title:"Komplette Anatomie"},es:{title:"Anatom\xeda completa"},fr:{title:"Anatomie compl\xe8te"},it:{title:"Anatomia completa"},ja:{title:"\u4eba\u4f53\u306e\u5168\u4f53\u69cb\u9020"},pt:{title:"Anatomia Completa"},zh:{title:"\u5b8c\u6574\u89e3\u5256"}}},{title:"Bony Landmarks",id:"Bony Landmarks",type:"Category",translations:{de:{title:"Knochenmarksteine"},es:{title:"Hitos huesudos"},fr:{title:"Points de rep\xe8re osseux"},it:{title:"Punti di riferimento ossei"},ja:{title:"\u9aa8\u306e\u30e9\u30f3\u30c9\u30de\u30fc\u30af"},pt:{title:"Marcos \xf3sseos"},zh:{title:"\u9aa8\u6027\u6807\u5fd7"}}},{title:"Cross Sections & Micro Anatomy",id:"Cross Section and Micro Anatomy",type:"Category",translations:{de:{title:"Querschnitte & Mikro-Anatomie"},es:{title:"Secciones transversales y Micro Anatom\xeda"},fr:{title:"Sections transversales et micro anatomie"},it:{title:"Sezioni trasversali & Micro Anatomia"},ja:{title:"\u65ad\u9762\u56f3\u30fb\u30de\u30a4\u30af\u30ed\u89e3\u5256\u5b66"},pt:{title:"Se\xe7\xf5es Transversais e Micro Anatomia"},zh:{title:"\u6a2a\u65ad\u9762&\u663e\u5fae\u89e3\u5256"}}},{title:"Origins & Insertions",id:"Origins and Insertions",type:"Category",translations:{de:{title:"Urspr\xfcnge und Einf\xfcgungen"},es:{title:"Or\xedgenes e inserciones"},fr:{title:"Origines et insertions"},it:{title:"Origini e Inserzioni"},ja:{title:"\u8d77\u6e90\u3068\u633f\u5165"},pt:{title:"Origens e Inser\xe7\xf5es"},zh:{title:"\u808c\u8089\u8d77\u6b62\u70b9"}}},{title:"Anatomy Quizzes",id:"quiz",type:"Category",translations:{de:{title:"Anatomie-Quiz"},es:{title:"Cuestionarios de anatom\xeda"},fr:{title:"Quiz d'anatomie"},it:{title:"Quiz di anatomia"},ja:{title:"\u89e3\u5256\u5b66\u30af\u30a4\u30ba"},pt:{title:"Quizzes de anatomia"},zh:{title:"\u89e3\u5256\u6d4b\u9a8c"}}}],specialties:[{title:"Allergy & Immunology",id:"Allergy and Immunology",type:"Category",translations:{de:{title:"Allergie und Immunologie"},es:{title:"Alergia e Inmunolog\xeda"},fr:{title:"Allergie et Immunologie"},it:{title:"Allergia e Immunologia"},ja:{title:"\u30a2\u30ec\u30eb\u30ae\u30fc\u3068\u514d\u75ab\u5b66"},pt:{title:"Alergia e Imunologia"},zh:{title:"\u8fc7\u654f\u4e0e\u514d\u75ab\u5b66"}}},{title:"Cardiology",id:"Cardiology",type:"Category",translations:{de:{title:"Kardiologie"},es:{title:"Cardiolog\xeda"},fr:{title:"Cardiologie"},it:{title:"Cardiologia"},ja:{title:"\u5fc3\u81d3\u75c5\u5b66"},pt:{title:"Cardiologia"},zh:{title:"\u5fc3\u810f\u79d1"}}},{title:"Dentistry",id:"Dentistry",type:"Category",translations:{de:{title:"Zahnmedizin"},es:{title:"Odontolog\xeda"},fr:{title:"Dentisterie"},it:{title:"Odontoiatria"},ja:{title:"\u6b6f\u5b66"},pt:{title:"Odontologia"},zh:{title:"\u7259\u79d1"}}},{title:"Dermatology",id:"Dermatology",type:"Category",translations:{de:{title:"Dermatologie"},es:{title:"Dermatolog\xeda"},fr:{title:"Dermatologie"},it:{title:"Dermatologia"},ja:{title:"\u76ae\u819a\u5b66"},pt:{title:"Dermatologia"},zh:{title:"\u76ae\u80a4\u79d1"}}},{title:"Endocrinology",id:"Endocrinology",type:"Category",translations:{de:{title:"Endokrinologie"},es:{title:"Endocrinolog\xeda"},fr:{title:"Endocrinologie"},it:{title:"Endocrinologia"},ja:{title:"\u5185\u5206\u6ccc\u5b66"},pt:{title:"Endocrinologia"},zh:{title:"\u5185\u5206\u6ccc\u79d1"}}},{title:"Gastroenterology",id:"Gastroenterology and Hepatology",type:"Category",translations:{de:{title:"Gastroenterologie"},es:{title:"Gastroenterolog\xeda"},fr:{title:"Gastroent\xe9rologie"},it:{title:"Gastroenterologia"},ja:{title:"\u80c3\u8178\u5b66\u30fb\u809d\u81d3\u5b66"},pt:{title:"Gastroenterologia"},zh:{title:"\u80c3\u80a0\u79d1&\u809d\u810f\u79d1"}}},{title:"Gynecology",id:"Gynecology",type:"Category",translations:{de:{title:"Gyn\xe4kologie"},es:{title:"Ginecolog\xeda"},fr:{title:"Gyn\xe9cologie"},it:{title:"Ginecologia"},ja:{title:"\u5a66\u4eba\u79d1"},pt:{title:"Ginecologia"},zh:{title:"\u5987\u79d1"}}},{title:"Hematology & Oncology",id:"Oncology and Hematology",type:"Category",translations:{de:{title:"H\xe4matologie/Onkologie"},es:{title:"Hematolog\xeda/Oncolog\xeda"},fr:{title:"H\xe9matologie/Oncologie"},it:{title:"Ematologia/Oncologia"},ja:{title:"\u816b\u760d\u5b66\u30fb\u8840\u6db2\u5b66"},pt:{title:"Hematologia/Oncologia"},zh:{title:"\u80bf\u7624\u79d1/\u8840\u6db2\u79d1"}}},{title:"Infectious Disease",id:"Infectious Disease",type:"Category",translations:{de:{title:"Infektionskrankheit"},es:{title:"Enfermedades Infecciosas"},fr:{title:"Maladies infectieuses"},it:{title:"Malattie Infettive"},ja:{title:"\u611f\u67d3\u75c7"},pt:{title:"Doen\xe7a Infecciosa"},zh:{title:"\u4f20\u67d3\u75c5"}}},{title:"Nephrology",id:"Nephrology",type:"Category",translations:{de:{title:"Nephrologie"},es:{title:"Nefrolog\xeda"},fr:{title:"N\xe9phrologie"},it:{title:"Nefrologia"},ja:{title:"\u814e\u81d3\u5b66"},pt:{title:"Nefrologia"},zh:{title:"\u80be\u79d1"}}},{title:"Neurology & Psychiatry",id:"Neurology and Psychiatry",type:"Category",translations:{de:{title:"Neurologie & Psychiatrie"},es:{title:"Neurolog\xeda y Psiquiatr\xeda"},fr:{title:"Neurologie & Psychiatrie"},it:{title:"Neurologia & Psichiatria"},ja:{title:"\u795e\u7d4c\u5b66\u30fb\u7cbe\u795e\u533b\u5b66"},pt:{title:"Neurologia e Psiquiatria"},zh:{title:"\u795e\u7ecf\u79d1&\u7cbe\u795e\u79d1"}}},{title:"Obstetrics",id:"Obstetrics",type:"Category",translations:{de:{title:"Geburtshilfe"},es:{title:"Obstetricia "},fr:{title:"Obst\xe9trique"},it:{title:"Ostetricia"},ja:{title:"\u7523\u79d1"},pt:{title:"Obstetr\xedcia"},zh:{title:"\u4ea7\u79d1"}}},{title:"Ophthalmology",id:"Ophthalmology",type:"Category",translations:{de:{title:"Ophthalmologie"},es:{title:"Oftalmolog\xeda"},fr:{title:"Ophtalmologie"},it:{title:"Oftalmologia"},ja:{title:"\u773c\u79d1\u5b66"},pt:{title:"Oftalmologia"},zh:{title:"\u773c\u79d1"}}},{title:"Orthopedics",id:"Orthopedics",type:"Category",translations:{de:{title:"Orthop\xe4die"},es:{title:"Ortopedia"},fr:{title:"Orthop\xe9die"},it:{title:"Ortopedia"},ja:{title:"\u6574\u5f62\u5916\u79d1\u5b66"},pt:{title:"Ortopedia"},zh:{title:"\u9aa8\u79d1"}}},{title:"Otolaryngology",id:"Otolaryngology",type:"Category",translations:{de:{title:"HNO-Heilkunde"},es:{title:"Otorrinolaringolog\xeda"},fr:{title:"Otorhinolaryngologie"},it:{title:"Otorinolaringoiatria"},ja:{title:"\u8033\u9f3b\u79d1\u5b66"},pt:{title:"Otorrinolaringologia"},zh:{title:"\u8033\u9f3b\u5589\u79d1"}}},{title:"Pediatrics",id:"Pediatrics",type:"Category",translations:{de:{title:"P\xe4diatrie"},es:{title:"Pediatr\xeda"},fr:{title:"P\xe9diatrie"},it:{title:"Pediatria"},ja:{title:"\u5c0f\u5150\u79d1\u5b66"},pt:{title:"Pediatria"},zh:{title:"\u513f\u79d1"}}},{title:"Physical Therapy",id:"Physical Therapy",type:"Category",translations:{de:{title:"Physikalische Therapie"},es:{title:"Fisioterapia"},fr:{title:"Physioth\xe9rapie"},it:{title:"Terapia fisica"},ja:{title:"\u7406\u5b66\u7642\u6cd5"},pt:{title:"Fisioterapia"},zh:{title:"\u7269\u7406\u7597\u6cd5"}}},{title:"Pulmonology",id:"Pulmonology and Respiratory",type:"Category",translations:{de:{title:"Pulmonologie"},es:{title:"Neumolog\xeda"},fr:{title:"Pneumologie"},it:{title:"Pneumologia"},ja:{title:"\u547c\u5438\u5668\u5b66"},pt:{title:"Pneumologia"},zh:{title:"\u80ba\u75c5\u79d1/\u547c\u5438\u79d1"}}},{title:"Rheumatology",id:"Rheumatology",type:"Category",translations:{de:{title:"Rheumatologie"},es:{title:"Reumatolog\xeda"},fr:{title:"Rhumatologie"},it:{title:"Reumatologia"},ja:{title:"\u30ea\u30a6\u30de\u30c1\u5b66"},pt:{title:"Reumatologia"},zh:{title:"\u98ce\u6e7f\u79d1"}}},{title:"Urology",id:"Urology",type:"Category",translations:{de:{title:"Urologie"},es:{title:"Urolog\xeda"},fr:{title:"Urologie"},it:{title:"Urologia"},ja:{title:"\u6ccc\u5c3f\u5668\u79d1\u5b66"},pt:{title:"Urologia"},zh:{title:"\u6ccc\u5c3f\u5916\u79d1"}}}],community:[{title:"Community Bookmarks",id:"public",type:"Community",translations:{de:{title:"Community-Lesezeichen"},es:{title:"Marcadores de la comunidad"},fr:{title:"Signets communautaires"},it:{title:"Segnalibri della community"},ja:{title:"\u30b3\u30df\u30e5\u30cb\u30c6\u30a3\u306e\u30d6\u30c3\u30af\u30de\u30fc\u30af"},pt:{title:"Favoritos da comunidade"},zh:{title:"\u793e\u533a\u4e66\u7b7e"}}}]},M_=[{icon:"search",tag:"Heart",params:{categoryId:"all",query:"Heart",type:"Category"}},{icon:"search",tag:"Brain",params:{categoryId:"all",query:"Brain",type:"Category"}},{icon:"search",tag:"Cardiology",params:{categoryId:"Cardiology",type:"Category"}},{icon:"search",tag:"COVID-19",params:{categoryId:"all",query:"COVID-19",type:"Category"}},{icon:"search",tag:"Treatments",params:{categoryId:"all",query:"Treatments",type:"Category"}},{icon:"search",tag:"Eye",params:{categoryId:"all",query:"Eye",type:"Category"}},{icon:"search",tag:"Skull",params:{categoryId:"all",query:"Skull",type:"Category"}},{icon:"search",tag:"Nervous System",params:{categoryId:"all",query:"Nervous System",type:"Category"}},{icon:"search",tag:"Muscles",params:{categoryId:"all",query:"Muscles",type:"Category"}},{icon:"search",tag:"Skeleton",params:{categoryId:"all",query:"Skeleton",type:"Category"}},{icon:"search",tag:"Digestive System",params:{categoryId:"all",query:"Digestive System",type:"Category"}}],I_=["assets/images/hero/biodigital-human-muscular-system.jpg","assets/images/hero/biodigital-human-cardiovascular-system.jpg","assets/images/hero/biodigital-human-nervous-system.jpg","assets/images/hero/biodigital-human-multiple-systems.jpg"],z_=["live"],T_=((GS=function(){function e(t){y(this,e),this.http=t}return v(e,[{key:"search",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"en",o=t.split(/[ ]+/).join("+"),r=z_.concat(n).filter((function(e){return""!==e&&null!=e})).map((function(e){return'"'.concat(e,'"')})).join("+");return this.http.get("/search?k=".concat(o,"&t=").concat(r,"&il=").concat(i,"&ol=").concat(i,"&odns=true")).pipe(Object(se.a)((function(t){return e.resultsToBookmarks(t)})))}},{key:"searchInternal",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return this.http.get("/ws/search/internal?k=".concat(t,"&dir=").concat(n)).pipe(Object(se.a)((function(t){return e.resultsToBookmarks(t)})))}},{key:"getAnatomyCategory",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3?arguments[3]:void 0;return this.search(e,[t].concat(p(n)),i)}},{key:"getConditionModel",value:function(e){var t=this;if(T.offline)return Object(br.a)(null);var n=this.toDatabaseContentId(e);return this.http.get("/search/conditions?q="+n).pipe(Object(XS.a)((function(e){return e.pipe(Object(_c.a)(1e3),Object(Tc.a)(3))})),Object(se.a)((function(e){return t.resultsToBookmarks(e)})),Object(se.a)((function(e){return e[0]})))}},{key:"getShowcase",value:function(){var e=this;return this.http.get("/assets/bookmarks/showcase.json").pipe(Object(se.a)((function(t){return t.forEach((function(t){return t.bookmarks=e.resultsToBookmarks(t.bookmarks),t})),t})))}},{key:"createMockShowcase",value:function(e){return{title:" ",description:" ",url:"",bookmarks:p(e),loading:!0}}},{key:"createMockShowcases",value:function(e,t){var n=this;return p(Array(e).keys()).map((function(){return n.createMockShowcase(t)}))}},{key:"resultsToBookmarks",value:function(e){return e.forEach((function(e){e=ge(e)})),Object(ce.plainToClass)(ue,e)}},{key:"getBookmarkCategory",value:function(e){if(!e.tags)return null;var t=P_.categories.map((function(e){return e.id.toLocaleLowerCase()}));return e.tags.find((function(e){return t.includes(e.toLocaleLowerCase())}))}},{key:"getStoryCategory",value:function(e){if(!e.tags)return null;var t=[].concat(p(P_.main),p(P_.categories),p(P_.specialties),p(P_.community)).map((function(e){return e.id.toLocaleLowerCase()}));return e.tags.find((function(e){return t.includes(e.toLocaleLowerCase())}))}},{key:"toAppContentId",value:function(e){return e.replace("Condition.content.","").replace(".json","").split(".").join("/")}},{key:"toDatabaseContentId",value:function(e){return e.match("Condition.content")?e:"Condition.content.".concat(e.replace(".json","").split("/").join("."),".json")}},{key:"getHeroImages",value:function(){return Object(br.a)(I_)}},{key:"getHeroQuickTags",value:function(){return Object(br.a)(M_)}}]),e}()).\u0275fac=function(e){return new(e||GS)(j.Zb(Q.b))},GS.\u0275prov=j.Lb({token:GS,factory:GS.\u0275fac,providedIn:"root"}),GS);function U_(e,t,n){var i=t.map((function(t){return e[t]})).filter((function(e){return!Object(ie.isNil)(e)}));return n?i.sort().shift():i.sort().pop()}function D_(e,t,n){if(0===t.length)return e;var i=new Intl.Collator("en-US",{sensitivity:"base"});return e.sort((function(e,o){var r=U_(e,t,n)||"",a=U_(o,t,n)||"";return(n?1:-1)*i.compare(r.toString(),a.toString())}))}var L_,E_=function e(){y(this,e)},F_=((L_=function(){function e(t){y(this,e),this.http=t}return v(e,[{key:"generateFreshChapterImages",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=[];return e.forEach((function(e){var o=Xs.getChapterThumbnail(e,t);(o.legacy||n)&&i.push(Xs.makeFreshThumbnail(o.storyId,o.chapterId,o.urls.large))})),i.length?Object(Ls.a)(i):Object(br.a)([])}},{key:"saveChapterThumbnails",value:function(e,t,n){var i=this;return e.reduce((function(e,o){var r=t.get(n[o.id]),a=Object(ie.get)(r,"snapshot");return a&&e.push(i.saveNewChapterImage(o.id,a)),e}),[])}},{key:"saveNewChapterImage",value:function(e,t){var n=this;return new J.a((function(i){nc(t).pipe(Object(tc.a)((function(e){return n.saveImageBlob(e)})),Object(se.a)((function(t){return Object.assign({chapterId:e},t)}))).subscribe((function(e){i.next(e),i.complete()}),(function(){i.next(null),i.complete()}))}))}},{key:"getIndexThumbnail",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"large";return"".concat("undefined"==typeof localBaseDirectory?"":localBaseDirectory,"thumbs/modules/").concat(e,"/").concat(t,"/index.jpg")}},{key:"saveImageBlob",value:function(e){var t=new File([e],"image.jpg",{type:"image/jpeg"}),n=new FormData;return n.append("file",t),this.http.post("/ws/media/images/upload",n)}}]),e}()).\u0275fac=function(e){return new(e||L_)(j.Zb(Q.b))},L_.\u0275prov=j.Lb({token:L_,factory:L_.\u0275fac,providedIn:"root"}),L_),A_=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},R_=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function V_(e,t,n,i,o,r){return r?Object(kr.a)(n.getDatabaseItem(os.PreviewBookmark)):o===M.Bookmark?e.getBookmarkModel(i):t.getConditionModel(i)}var N_,B_={loading:!0,exporting:!1,copying:!1,saving:!1,bookmarks:[],selectedBookmark:null,sort:l_,checkedBookmarks:[],selectedCategory:null},H_=((N_=function(){function e(t,n,i,o,r,a,s,c,l,p,u){y(this,e),this.store=t,this.actions=n,this.bookmarksService=i,this.imagesService=o,this.storyService=r,this.exploreService=a,this.publishService=s,this.organizationsService=c,this.snackbar=l,this.pendoService=p,this.storageService=u}return v(e,[{key:"loadBookmarks",value:function(e,t){e.patchState({loading:!0,bookmarks:[],checkedBookmarks:[]}),Object(Ls.a)(this.bookmarksService.getPrivateBookmarks(t.query),this.bookmarksService.getPrivateConditions(t.query)).pipe(Object(Ss.a)((function(){return e.patchState({loading:!1})}))).subscribe((function(t){var n=d(t,2),i=n[0],o=n[1];e.dispatch(new bl([].concat(p(i),p(o))))}))}},{key:"loadOrganizationBookmarks",value:function(e,t){var n=t.organizationId;e.patchState({loading:!0,bookmarks:[],checkedBookmarks:[]}),this.bookmarksService.getOrganizationContent(n).pipe(Object(Ss.a)((function(){return e.patchState({loading:!1})}))).subscribe((function(t){e.dispatch(new bl(t))}))}},{key:"loadCollectionBookmarks",value:function(e,t){e.patchState({loading:!0,bookmarks:[],checkedBookmarks:[]}),this.organizationsService.getCollectionContent(t.organizationId,t.collectionId).pipe(Object(Ss.a)((function(){return e.patchState({loading:!1})}))).subscribe((function(t){e.dispatch(new bl(t))}))}},{key:"loadSuccess",value:function(e,t){(0,e.patchState)({bookmarks:t.result})}},{key:"selectBookmark",value:function(e,t){var n=t.id,i=t.type,o=t.preview;V_(this.bookmarksService,this.exploreService,this.storageService,n,i,o).subscribe((function(t){e.dispatch(new fl(t))}))}},{key:"selectBookmarkSuccess",value:function(e,t){var n=t.bookmark;n&&(n=ge(n)),e.patchState({selectedBookmark:n})}},{key:"saveBookmark",value:function(e,t){return n=this,o=regeneratorRuntime.mark((function n(){var i,o,r,a,s,c,l,p,u=this;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(e.patchState({saving:!0}),o=t.bookmarkEntry,r=this.store.selectSnapshot(vs.getStoryChapters),a=!1===t.inplace,s=Mr.makeChapterIdMap(r,a),n.t0=a,!n.t0){n.next=6;break}return n.next=6,this.store.dispatch(new xo.UpdateTweenParticleLookupChapters(s)).toPromise();case 6:t.includeIndex&&(i=this.bookmarksService.createBookmarkStory(s),o.index=i.story),c=Object(br.a)([]),t.includeIndex&&(l=this.store.selectSnapshot(Lr.getRegisteredThumbnails),(p=this.imagesService.saveChapterThumbnails(o.index.chapters,l,Object(ie.invert)(s))).length&&(c=Object(Ls.a)(p))),c.pipe(Object(vr.b)((function(t){var n=u.store.selectSnapshot(Lr.getRegisteredThumbnails);return t.forEach((function(e){var t=new gr;t.storyId=o.id,t.chapterId=e.chapterId,t.urls={small:e.uris.small,large:e.uris.large},n.set(e.chapterId,t);var i=o.index.chapters.findIndex((function(t){return t.id===e.chapterId}));i>=0&&(o.index.chapters[i].thumbnails=Object.assign({},e.uris))})),e.dispatch(new lr(n)),u.bookmarksService.saveBookmark(o)}))).subscribe((function(t){e.patchState({saving:!1});var n=i?i.story:null,r=o.id?"update":"save",a=Array.isArray(o.addCollections)&&o.addCollections.length>0,s=o.removeCollections&&Array.from(o.removeCollections.keys()).length>0;a||s?(u.actions.pipe(Object(L.j)(El,Fl),Object(Tc.a)(1)).subscribe((function(){e.dispatch(new Cl(t,n,r))})),e.dispatch(new Ll(t,o.addCollections,o.removeCollections))):e.dispatch(new Cl(t,n,r))}),(function(){e.dispatch(new Sl(o))})),this.pendoService.track("Bookmark Save - Start");case 10:case"end":return n.stop()}}),n,this)})),new((i=void 0)||(i=Promise))((function(e,t){function r(e){try{s(o.next(e))}catch(n){t(n)}}function a(e){try{s(o.throw(e))}catch(n){t(n)}}function s(t){var n;t.done?e(t.value):(n=t.value,n instanceof i?n:new i((function(e){e(n)}))).then(r,a)}s((o=o.apply(n,[])).next())}));var n,i,o}},{key:"saveBookmarkSuccess",value:function(e,t){var n=t.bookmark,i=e.getState().bookmarks,o=i.findIndex((function(e){return e.id===n.id}));-1!==o&&(i[o]=n,e.patchState({bookmarks:p(i)})),"save"===t.method&&e.patchState({selectedBookmark:t.bookmark}),this.pendoService.track("Bookmark Save - Success")}},{key:"saveBookmarkFail",value:function(e,t){this.pendoService.track("Bookmark Save - Failure")}},{key:"deleteBookmark",value:function(e,t){var n=t.bookmarkId;this.bookmarksService.deleteBookmark(n).subscribe((function(){e.dispatch(new vl(n))}),(function(t){e.dispatch(new yl(n,t))}))}},{key:"deleteBookmarkSuccess",value:function(e,t){var n=e.getState().bookmarks.filter((function(e){return e.id!==t.bookmarkId}));e.patchState({bookmarks:p(n)}),this.snackbar.open("Successfully deleted 3D model")}},{key:"bulkDeleteBookmark",value:function(e,t){var n=this,i=t.bookmarkIds,o=t.bookmarkIds.map((function(e){return n.bookmarksService.deleteBookmark(e)}));Object(Ls.a)(o).subscribe((function(){e.dispatch(new Ol(i))}),(function(t){e.dispatch(new wl(i,t))}))}},{key:"bulkDeleteBookmarkSuccess",value:function(e,t){var n=e.getState().bookmarks.filter((function(e){return!t.bookmarkIds.some((function(t){return t===e.id}))}));e.patchState({bookmarks:p(n)}),this.snackbar.open("Successfully deleted 3D models")}},{key:"sortBookmarks",value:function(e,t){var n=e.getState().bookmarks;e.patchState({sort:t.sort,bookmarks:p(n)})}},{key:"clearBookmarks",value:function(e,t){e.patchState({bookmarks:[],checkedBookmarks:[]})}},{key:"resetBookmarks",value:function(e,t){e.setState(B_)}},{key:"checkBookmark",value:function(e,t){var n=e.getState().checkedBookmarks,i=n.some((function(e){return e===t.id}));t.checked&&!i?n=[].concat(p(n),[t.id]):t.checked||(n=n.filter((function(e){return e!==t.id}))),e.patchState({checkedBookmarks:n})}},{key:"setCheckedBookmarks",value:function(e,t){e.patchState({checkedBookmarks:t.ids})}},{key:"exportBookmarks",value:function(e,t){var n=t.bookmarks,i=t.organizationId,o=t.collections,r=t.widgetURL,a=t.widgetOptions,s=t.offlineEnabled,c=t.productAccountId,l=a||new f_;e.patchState({exporting:!0}),this.publishService.exportBookmarks(n,i,o,r,l,null,t.userLanguage,t.userApp,s,c).pipe(Object(Ss.a)((function(){e.patchState({exporting:!1})}))).subscribe((function(t){e.dispatch(t?new Ul(n):new Dl(n))}))}},{key:"updateBookmarkCollections",value:function(e,t){var n=t.addCollections,i=n.map((function(e){return{collection_id:e.collection_id,content_list:[{content_type:t.bookmark.type,content_id:t.bookmark.id}]}})),o=Array.from(t.removeCollections.keys()),r=o.map((function(e){return{collection_id:e.collection_id,collection_content_id_list:[t.removeCollections.get(e)]}})),a=n.concat(o)[0].group_id;this.organizationsService.updateCollectionContent(a,i,r).subscribe((function(){n.length>0&&e.dispatch(new Al(t.bookmark,n)),o.length>0&&e.dispatch(new Vl(t.bookmark,o)),e.dispatch(new El(t.bookmark,n,o))}),(function(){n.length>0&&e.dispatch(new Rl(t.bookmark,n)),o.length>0&&e.dispatch(new Nl(t.bookmark,o)),e.dispatch(new Fl(t.bookmark,n,o))}))}},{key:"removeBookmarkCollectionSuccess",value:function(e,t){var n=e.getState(),i=n.bookmarks;if("collection"===n.selectedCategory){var o=t.bookmark.id,r=i.filter((function(e){return e.id!==o}));e.patchState({bookmarks:p(r)})}}},{key:"copyBookmark",value:function(e,t){var n=this;this.pendoService.track("Bookmark Copy - Start");var i,o,r,a,s,c=t.groupAccess,l=t.collections;e.patchState({copying:!0,saving:!0});var p=V_(this.bookmarksService,this.exploreService,this.storageService,t.id,t.type,!1),u=this.storyService.getStory(t.id,t.type,t.lang);Object(Ls.a)([p,u]).pipe(Object(se.a)((function(e){var t=d(e,2),n=t[0],i=t[1];o=Object(ie.cloneDeep)(i),r=Object(ie.cloneDeep)(i),a=Mr.makeChapterIdMap(o.chapters,!0),r.chapters.forEach((function(e){e.id=a[e.id]})),r.tweenParticleLookup&&(r.tweenParticleLookup=Oo.updateChapterIds(r.tweenParticleLookup,a)),s=n.viewMode})),Object(tc.a)((function(){return n.imagesService.generateFreshChapterImages(o.chapters,t.id)})),Object(tc.a)((function(e){var t=e.map((function(e){return n.imagesService.saveNewChapterImage(e.chapterId,e.snapshot)}));return t.length?Object(Ls.a)(t):Object(br.a)([])})),Object(se.a)((function(e){e.forEach((function(e){e.chapterId=a[e.chapterId]})),r.chapters.forEach((function(t){var n=e.find((function(e){return e.chapterId===t.id}));n&&(t.thumbnails=Object.assign({},n.uris))}))})),Object(tc.a)((function(){var e=new E_;return e.title=t.title,e.isOwner=!0,e.index=r,e.viewMode=s,e.is_content_copy=!0,c&&(e.add_group_access=[c]),n.bookmarksService.saveBookmark(e)})),Object(ei.a)((function(e){i=e})),Object(tc.a)((function(){if(c&&l&&l.length>0){var e=l[0].group_id,t=l.map((function(e){return{collection_id:e.collection_id,content_list:[{content_type:i.type,content_id:i.id}]}}));return n.organizationsService.updateCollectionContent(e,t,[])}return Object(br.a)(!0)})),Object(Ss.a)((function(){e.patchState({copying:!1,saving:!1})}))).subscribe((function(){n.pendoService.track("Bookmark Copy - Success"),e.dispatch(new Hl(i))}),(function(i){n.pendoService.track("Bookmark Copy - Failure"),e.dispatch(new Ql(t.id,i))}))}},{key:"setBookmarkText",value:function(e,t){var n=e.getState().selectedBookmark;e.patchState({selectedBookmark:Object.assign(Object.assign({},n),{title:t.title})})}},{key:"setBookmarkViewMode",value:function(e,t){var n=e.getState().selectedBookmark;e.patchState({selectedBookmark:Object.assign(Object.assign({},n),{viewMode:t.viewMode})})}},{key:"setSelectedCategory",value:function(e,t){var n=t.category;e.patchState({selectedCategory:n||null})}},{key:"cancelSaveBookmark",value:function(e,t){e.patchState({saving:!1})}},{key:"cancelCopyBookmark",value:function(e,t){e.patchState({copying:!1})}}],[{key:"getBookmarks",value:function(e){var t=e.bookmarks,n=e.sort,i=n.ascending;return D_(t,n.fields,i)}},{key:"getCheckedBookmarks",value:function(e){return e.checkedBookmarks}},{key:"getSelectedBookmark",value:function(e){return e.selectedBookmark}},{key:"getSelectedBookmarkViewMode",value:function(e){return e.selectedBookmark.viewMode||de.All}},{key:"getLoading",value:function(e){return e.loading}},{key:"getExporting",value:function(e){return e.exporting}},{key:"getSaving",value:function(e){return e.saving}},{key:"getCopying",value:function(e){return e.copying}},{key:"getSort",value:function(e){return e.sort}},{key:"getSelectedCategory",value:function(e){return e.selectedCategory}}]),e}()).\u0275fac=function(e){return new(e||N_)(j.Zb(L.g),j.Zb(L.b),j.Zb(s_),j.Zb(F_),j.Zb(Qs),j.Zb(T_),j.Zb(j_),j.Zb(ye),j.Zb(Sd.b),j.Zb(Oe),j.Zb(as))},N_.\u0275prov=j.Lb({token:N_,factory:N_.\u0275fac}),A_([Object(L.a)(ul),R_("design:type",Function),R_("design:paramtypes",[Object,ul]),R_("design:returntype",void 0)],N_.prototype,"loadBookmarks",null),A_([Object(L.a)(dl),R_("design:type",Function),R_("design:paramtypes",[Object,dl]),R_("design:returntype",void 0)],N_.prototype,"loadOrganizationBookmarks",null),A_([Object(L.a)(gl),R_("design:type",Function),R_("design:paramtypes",[Object,gl]),R_("design:returntype",void 0)],N_.prototype,"loadCollectionBookmarks",null),A_([Object(L.a)(bl),R_("design:type",Function),R_("design:paramtypes",[Object,bl]),R_("design:returntype",void 0)],N_.prototype,"loadSuccess",null),A_([Object(L.a)(hl),R_("design:type",Function),R_("design:paramtypes",[Object,hl]),R_("design:returntype",void 0)],N_.prototype,"selectBookmark",null),A_([Object(L.a)(fl),R_("design:type",Function),R_("design:paramtypes",[Object,fl]),R_("design:returntype",void 0)],N_.prototype,"selectBookmarkSuccess",null),A_([Object(L.a)(kl),R_("design:type",Function),R_("design:paramtypes",[Object,kl]),R_("design:returntype",Promise)],N_.prototype,"saveBookmark",null),A_([Object(L.a)(Cl),R_("design:type",Function),R_("design:paramtypes",[Object,Cl]),R_("design:returntype",void 0)],N_.prototype,"saveBookmarkSuccess",null),A_([Object(L.a)(Sl),R_("design:type",Function),R_("design:paramtypes",[Object,Sl]),R_("design:returntype",void 0)],N_.prototype,"saveBookmarkFail",null),A_([Object(L.a)(ml),R_("design:type",Function),R_("design:paramtypes",[Object,ml]),R_("design:returntype",void 0)],N_.prototype,"deleteBookmark",null),A_([Object(L.a)(vl),R_("design:type",Function),R_("design:paramtypes",[Object,vl]),R_("design:returntype",void 0)],N_.prototype,"deleteBookmarkSuccess",null),A_([Object(L.a)(xl),R_("design:type",Function),R_("design:paramtypes",[Object,xl]),R_("design:returntype",void 0)],N_.prototype,"bulkDeleteBookmark",null),A_([Object(L.a)(Ol),R_("design:type",Function),R_("design:paramtypes",[Object,Ol]),R_("design:returntype",void 0)],N_.prototype,"bulkDeleteBookmarkSuccess",null),A_([Object(L.a)(Ml),R_("design:type",Function),R_("design:paramtypes",[Object,Ml]),R_("design:returntype",void 0)],N_.prototype,"sortBookmarks",null),A_([Object(L.a)(Pl),R_("design:type",Function),R_("design:paramtypes",[Object,Pl]),R_("design:returntype",void 0)],N_.prototype,"clearBookmarks",null),A_([Object(L.a)(jl),R_("design:type",Function),R_("design:paramtypes",[Object,jl]),R_("design:returntype",void 0)],N_.prototype,"resetBookmarks",null),A_([Object(L.a)(Il),R_("design:type",Function),R_("design:paramtypes",[Object,Il]),R_("design:returntype",void 0)],N_.prototype,"checkBookmark",null),A_([Object(L.a)(zl),R_("design:type",Function),R_("design:paramtypes",[Object,zl]),R_("design:returntype",void 0)],N_.prototype,"setCheckedBookmarks",null),A_([Object(L.a)(Tl),R_("design:type",Function),R_("design:paramtypes",[Object,Tl]),R_("design:returntype",void 0)],N_.prototype,"exportBookmarks",null),A_([Object(L.a)(Ll),R_("design:type",Function),R_("design:paramtypes",[Object,Ll]),R_("design:returntype",void 0)],N_.prototype,"updateBookmarkCollections",null),A_([Object(L.a)(Vl),R_("design:type",Function),R_("design:paramtypes",[Object,Vl]),R_("design:returntype",void 0)],N_.prototype,"removeBookmarkCollectionSuccess",null),A_([Object(L.a)(Bl),R_("design:type",Function),R_("design:paramtypes",[Object,Bl]),R_("design:returntype",void 0)],N_.prototype,"copyBookmark",null),A_([Object(L.a)($l),R_("design:type",Function),R_("design:paramtypes",[Object,$l]),R_("design:returntype",void 0)],N_.prototype,"setBookmarkText",null),A_([Object(L.a)(Wl),R_("design:type",Function),R_("design:paramtypes",[Object,Wl]),R_("design:returntype",void 0)],N_.prototype,"setBookmarkViewMode",null),A_([Object(L.a)(Kl),R_("design:type",Function),R_("design:paramtypes",[Object,Kl]),R_("design:returntype",void 0)],N_.prototype,"setSelectedCategory",null),A_([Object(L.a)(_l),R_("design:type",Function),R_("design:paramtypes",[Object,_l]),R_("design:returntype",void 0)],N_.prototype,"cancelSaveBookmark",null),A_([Object(L.a)(ql),R_("design:type",Function),R_("design:paramtypes",[Object,ql]),R_("design:returntype",void 0)],N_.prototype,"cancelCopyBookmark",null),A_([Object(L.e)(),R_("design:type",Function),R_("design:paramtypes",[JS]),R_("design:returntype",void 0)],N_,"getBookmarks",null),A_([Object(L.e)(),R_("design:type",Function),R_("design:paramtypes",[JS]),R_("design:returntype",void 0)],N_,"getCheckedBookmarks",null),A_([Object(L.e)(),R_("design:type",Function),R_("design:paramtypes",[JS]),R_("design:returntype",void 0)],N_,"getSelectedBookmark",null),A_([Object(L.e)(),R_("design:type",Function),R_("design:paramtypes",[JS]),R_("design:returntype",void 0)],N_,"getSelectedBookmarkViewMode",null),A_([Object(L.e)(),R_("design:type",Function),R_("design:paramtypes",[JS]),R_("design:returntype",void 0)],N_,"getLoading",null),A_([Object(L.e)(),R_("design:type",Function),R_("design:paramtypes",[JS]),R_("design:returntype",void 0)],N_,"getExporting",null),A_([Object(L.e)(),R_("design:type",Function),R_("design:paramtypes",[JS]),R_("design:returntype",void 0)],N_,"getSaving",null),A_([Object(L.e)(),R_("design:type",Function),R_("design:paramtypes",[JS]),R_("design:returntype",void 0)],N_,"getCopying",null),A_([Object(L.e)(),R_("design:type",Function),R_("design:paramtypes",[JS]),R_("design:returntype",void 0)],N_,"getSort",null),A_([Object(L.e)(),R_("design:type",Function),R_("design:paramtypes",[JS]),R_("design:returntype",void 0)],N_,"getSelectedCategory",null),N_=A_([Object(L.f)({name:"bookmarks",defaults:B_})],N_)),Q_=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},q_=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function $_(e,t){if(1&e){var n=j.Wb();j.Tb(0),j.Vb(1,"button",15),j.cc("click",(function(){return j.xc(n),j.gc().handleTreeClick()})),j.Qb(2,"app-icon",16),j.Vb(3,"span",17),j.Kc(4,"Anatomy Tree"),j.Ub(),j.Ub(),j.Vb(5,"button",18),j.cc("click",(function(){return j.xc(n),j.gc().handleSearchClick()})),j.Qb(6,"app-icon",19),j.Vb(7,"span",17),j.Kc(8,"Search"),j.Ub(),j.Ub(),j.Qb(9,"mat-divider"),j.Sb()}}function W_(e,t){if(1&e){var n=j.Wb();j.Vb(0,"button",20),j.cc("click",(function(){return j.xc(n),j.gc().toggleToolbar("visibilityLayers")})),j.Qb(1,"app-icon",21),j.Vb(2,"span",17),j.Kc(3,"Layers"),j.Ub(),j.Ub()}}function K_(e,t){if(1&e){var n=j.Wb();j.Vb(0,"button",22),j.cc("click",(function(){return j.xc(n),j.gc().handleDrawClick()})),j.hc(1,"async"),j.Qb(2,"app-icon",23),j.Vb(3,"span",17),j.Kc(4,"Draw"),j.Ub(),j.Ub()}if(2&e){var i,o=j.gc();j.lc("disabled",!(null!=(i=j.ic(1,1,o.selectedChapterReady$))&&i.model))}}function G_(e,t){if(1&e){var n=j.Wb();j.Vb(0,"button",24),j.cc("click",(function(){return j.xc(n),j.gc().handleTakeQuizClick()})),j.hc(1,"async"),j.hc(2,"async"),j.Qb(3,"app-icon",25),j.Vb(4,"span",17),j.Kc(5,"Take Quiz"),j.Ub(),j.Ub()}if(2&e){var i,o=j.gc();j.lc("disabled",!(null!=(i=j.ic(1,1,o.selectedChapterReady$))&&i.model)||j.ic(2,3,o.quizActive$))}}function Z_(e,t){if(1&e){var n=j.Wb();j.Vb(0,"button",26),j.cc("click",(function(){return j.xc(n),j.gc().toggleToolbar("media")})),j.Qb(1,"app-icon",27),j.Kc(2," Open Media Bar "),j.Ub()}}function J_(e,t){if(1&e&&(j.Vb(0,"button",28),j.Kc(1," Settings "),j.Ub()),2&e){j.gc();var n=j.tc(16);j.lc("matMenuTriggerFor",n)}}function X_(e,t){if(1&e&&(j.Vb(0,"button",28),j.Kc(1,"Help"),j.Ub()),2&e){j.gc();var n=j.tc(20);j.lc("matMenuTriggerFor",n)}}function Y_(e,t){1&e&&(j.Tb(0),j.Kc(1,"Exit Fullscreen"),j.Sb())}function ej(e,t){1&e&&(j.Tb(0),j.Kc(1,"Enter Fullscreen"),j.Sb())}function tj(e,t){if(1&e){var n=j.Wb();j.Vb(0,"button",31),j.cc("click",(function(){return j.xc(n),j.gc(2).handleFullscreenClick()})),j.Ic(1,Y_,2,0,"ng-container",3),j.Ic(2,ej,2,0,"ng-container",3),j.Ub()}if(2&e){var i=j.gc(2);j.Db(1),j.lc("ngIf",i.isFullscreen),j.Db(1),j.lc("ngIf",!i.isFullscreen)}}function nj(e,t){if(1&e){var n=j.Wb();j.Vb(0,"button",33),j.cc("click",(function(){return j.xc(n),j.gc(3).handleNewTabClick()})),j.Kc(1," Open in New Tab "),j.Ub()}}function ij(e,t){if(1&e&&(j.Tb(0),j.Ic(1,nj,2,0,"button",32),j.Sb()),2&e){var n=j.gc(2);j.Db(1),j.lc("ngIf",!n.canFullscreen)}}function oj(e,t){if(1&e&&(j.Tb(0),j.Ic(1,tj,3,2,"button",29),j.Ic(2,ij,2,1,"ng-container",30),j.Sb()),2&e){var n=j.gc();j.Db(1),j.lc("ngIf",n.canFullscreen),j.Db(1),j.lc("appFlagApplication",n.application.All)("appFlagApplicationMode","exclude")("appFlagApplicationNative",n.nativePlatform.All)}}function rj(e,t){1&e&&(j.Tb(0),j.Kc(1,"Hide Labels"),j.Sb())}function aj(e,t){1&e&&(j.Tb(0),j.Kc(1,"Show Labels"),j.Sb())}function sj(e,t){if(1&e){var n=j.Wb();j.Vb(0,"button",34),j.cc("click",(function(){return j.xc(n),j.gc().handleToggleLabelsClick()})),j.Ic(1,rj,2,0,"ng-container",3),j.hc(2,"async"),j.Ic(3,aj,2,0,"ng-container",3),j.hc(4,"async"),j.Ub()}if(2&e){var i=j.gc();j.Db(1),j.lc("ngIf",j.ic(2,2,i.showLabels$)),j.Db(2),j.lc("ngIf",!j.ic(4,4,i.showLabels$))}}var cj,lj=((cj=function(){function e(t,n,i,o,r){y(this,e),this.viewUIService=t,this.viewService=n,this.quizService=i,this.changeDetectorRef=o,this.store=r,this.application=P,this.nativePlatform=Ed,this.bookmarkViewMode=de,this.viewUI=nl,this.isFullscreen=!1,this.canFullscreen=!1,this.ngUnsubscribe=new Z.a,this.visibilityLayersVisible=!1,this.showTakeQuiz=!1}return v(e,[{key:"ngOnInit",value:function(){this.canFullscreen=Nr.canFullscreen(),this.initFullscreenListener(),this.initLayoutListener()}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"initFullscreenListener",value:function(){var e=this;this.fullscreen$=Nr.onFullscreenChange(),this.fullscreen$.pipe(Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){e.isFullscreen=Nr.isFullscreen(),e.changeDetectorRef.markForCheck()}))}},{key:"initLayoutListener",value:function(){var e=this;this.store.select(hs.getUI).pipe(Object(X.a)(this.ngUnsubscribe)).subscribe((function(){e.visibilityLayersVisible=e.viewUIService.isVisible(nl.VisibilityLayers),e.changeDetectorRef.markForCheck()}))}},{key:"initTakeQuizButton",value:function(){var e=this;Object(zc.b)([this.hasQuiz$,this.quizEnabled$,this.quizLocked$,this.selectedBookmarkViewMode$]).pipe(Object(se.a)((function(e){var t=d(e,4),n=t[0],i=t[1],o=t[2],r=t[3];return!!n&&!!i&&(!(!o||r===de.Content)||void 0)})),Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){e.showTakeQuiz=t}))}},{key:"handleToggleLabelsClick",value:function(){this.viewService.showLabels()}},{key:"handleFullscreenClick",value:function(){Nr.toggleFullscreen()}},{key:"handleTutorialClick",value:function(){this.viewService.toggleTutorial(!0)}},{key:"handleTakeQuizClick",value:function(){this.quizService.startQuiz()}},{key:"handleHelpBasicsClick",value:function(){this.viewService.toggleHelp(ee.Basics)}},{key:"handleHelpShortcutsClick",value:function(){this.viewService.toggleHelp(ee.Shortcuts)}},{key:"handlePresentClick",value:function(){this.viewService.togglePresentation()}},{key:"handleNewTabClick",value:function(){this.viewService.openInNewTab()}},{key:"handleSearchClick",value:function(){this.viewService.toggleSearch(cs.List,!0)}},{key:"handleTreeClick",value:function(){this.viewService.toggleSearch(cs.Tree,!0)}},{key:"handleDrawClick",value:function(){this.viewService.toggleWhiteboard(!0)}},{key:"toggleToolbar",value:function(e){this.viewService.toggleToolbar(e)}},{key:"isEnabled",value:function(e){return this.viewUIService.isUIEnabled(e)}},{key:"isVisible",value:function(e){return this.viewUIService.isVisible(e)}}]),e}()).\u0275fac=function(e){return new(e||cj)(j.Pb(pl),j.Pb(Wp),j.Pb(Ef),j.Pb(j.i),j.Pb(L.g))},cj.\u0275cmp=j.Jb({type:cj,selectors:[["app-view-menu"]],decls:28,vars:22,consts:[["type","button","data-test","viewMenu","matTooltip","Menu","app-pin-button","","buttonType","secondary","icon","bars","aria-label","View Menu",2,"width","52px","height","52px",3,"matMenuTriggerFor","fill"],[1,"view-menu"],["viewMenu","matMenu"],[4,"ngIf"],["mat-menu-item","","data-test","viewLayersButton",3,"click",4,"ngIf"],["mat-menu-item","","data-test","viewDrawButton",3,"disabled","click",4,"ngIf"],["mat-menu-item","","data-test","viewQuizButton",3,"disabled","click",4,"ngIf"],["mat-menu-item","","data-test","viewMediaBarButton",3,"click",4,"ngIf"],["mat-menu-item","",3,"matMenuTriggerFor",4,"ngIf"],["settingsMenu","matMenu"],["mat-menu-item","","data-test","viewToggleLabels",3,"click",4,"ngIf"],["helpMenu","matMenu"],["mat-menu-item","","data-test","viewLaunchTutorial",3,"disabled","click"],["mat-menu-item","","data-test","view3DNavigationBasics",3,"click"],["mat-menu-item","","data-test","viewKeyboardShortcuts",3,"click"],["mat-menu-item","","data-test","viewTreeButton",3,"click"],["icon","sitemap",1,"view-menu__icon"],[1,"ml-2"],["mat-menu-item","","data-test","viewSearchButton",3,"click"],["icon","search",1,"view-menu__icon"],["mat-menu-item","","data-test","viewLayersButton",3,"click"],["icon","layer-group",1,"view-menu__icon"],["mat-menu-item","","data-test","viewDrawButton",3,"disabled","click"],["icon","signature",1,"view-menu__icon"],["mat-menu-item","","data-test","viewQuizButton",3,"disabled","click"],["icon","check",1,"view-menu__icon"],["mat-menu-item","","data-test","viewMediaBarButton",3,"click"],["icon","play",1,"view-menu__icon"],["mat-menu-item","",3,"matMenuTriggerFor"],["mat-menu-item","","data-test","viewHandleFullscreen",3,"click",4,"ngIf"],[4,"appFlagApplication","appFlagApplicationMode","appFlagApplicationNative"],["mat-menu-item","","data-test","viewHandleFullscreen",3,"click"],["mat-menu-item","",3,"click",4,"ngIf"],["mat-menu-item","",3,"click"],["mat-menu-item","","data-test","viewToggleLabels",3,"click"]],template:function(e,t){if(1&e&&(j.Qb(0,"button",0),j.Vb(1,"mat-menu",1,2),j.Ic(3,$_,10,0,"ng-container",3),j.Ic(4,W_,4,0,"button",4),j.Ic(5,K_,5,3,"button",5),j.Ic(6,G_,6,5,"button",6),j.hc(7,"async"),j.hc(8,"async"),j.hc(9,"async"),j.hc(10,"async"),j.Ic(11,Z_,3,0,"button",7),j.Qb(12,"mat-divider"),j.Ic(13,J_,2,1,"button",8),j.Ic(14,X_,2,1,"button",8),j.Ub(),j.Vb(15,"mat-menu",null,9),j.Ic(17,oj,3,4,"ng-container",3),j.Ic(18,sj,5,6,"button",10),j.Ub(),j.Vb(19,"mat-menu",null,11),j.Vb(21,"button",12),j.cc("click",(function(){return t.handleTutorialClick()})),j.hc(22,"async"),j.Kc(23," Launch Tutorial "),j.Ub(),j.Vb(24,"button",13),j.cc("click",(function(){return t.handleHelpBasicsClick()})),j.Kc(25," 3D Navigation Basics "),j.Ub(),j.Vb(26,"button",14),j.cc("click",(function(){return t.handleHelpShortcutsClick()})),j.Kc(27," Keyboard Shortcuts "),j.Ub(),j.Ub()),2&e){var n,i=j.tc(2);j.lc("matMenuTriggerFor",i)("fill",!0),j.Db(3),j.lc("ngIf",t.isEnabled(t.viewUI.Search)),j.Db(1),j.lc("ngIf",t.visibilityLayersVisible),j.Db(1),j.lc("ngIf",t.isEnabled(t.viewUI.Whiteboard)),j.Db(1),j.lc("ngIf",j.ic(7,12,t.hasQuiz$)&&j.ic(8,14,t.quizEnabled$)&&!j.ic(9,16,t.quizLocked$)&&j.ic(10,18,t.selectedBookmarkViewMode$)!==t.bookmarkViewMode.Content),j.Db(5),j.lc("ngIf",t.isVisible(t.viewUI.ScrubberItem)),j.Db(2),j.lc("ngIf",t.isEnabled(t.viewUI.Fullscreen)||t.isEnabled(t.viewUI.ToggleLabels)),j.Db(1),j.lc("ngIf",t.isEnabled(t.viewUI.Help)),j.Db(3),j.lc("ngIf",t.isEnabled(t.viewUI.Fullscreen)),j.Db(1),j.lc("ngIf",t.isEnabled(t.viewUI.ToggleLabels)),j.Db(3),j.lc("disabled",!(null!=(n=j.ic(22,20,t.selectedChapterReady$))&&n.model))}},directives:[Dg,Lg.c,Ld.d,Ld.a,we.l,Ad.a,Ld.b,vp,Fd],pipes:[we.b],styles:[".view-menu__icon[_ngcontent-%COMP%]{display:inline-flex;justify-content:center;width:16px}"],changeDetection:0}),Q_([Object(L.d)(H_.getSelectedBookmarkViewMode),q_("design:type",J.a)],cj.prototype,"selectedBookmarkViewMode$",void 0),Q_([Object(L.d)(vs.getSelectedChapterReadyState),q_("design:type",J.a)],cj.prototype,"selectedChapterReady$",void 0),Q_([Object(L.d)(rr.hasQuiz),q_("design:type",J.a)],cj.prototype,"hasQuiz$",void 0),Q_([Object(L.d)(rr.getQuizEnabled),q_("design:type",J.a)],cj.prototype,"quizEnabled$",void 0),Q_([Object(L.d)(rr.getQuizModeLocked),q_("design:type",J.a)],cj.prototype,"quizLocked$",void 0),Q_([Object(L.d)(rr.getQuizModeActive),q_("design:type",J.a)],cj.prototype,"quizActive$",void 0),Q_([Object(L.d)(zs.getShowLabels),q_("design:type",J.a)],cj.prototype,"showLabels$",void 0),cj),pj=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},uj=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function dj(e,t){if(1&e){var n=j.Wb();j.Vb(0,"button",8),j.cc("touchend",(function(){return j.xc(n),j.gc(2).setZoomFixed("out")}))("mouseup",(function(){return j.xc(n),j.gc(2).setZoomFixed("out")}))("keyup.enter",(function(){return j.xc(n),j.gc(2).setZoomFixed("out")})),j.Ub()}}function gj(e,t){if(1&e){var n=j.Wb();j.Vb(0,"button",9),j.cc("touchend",(function(){return j.xc(n),j.gc(2).setZoomFixed("in")}))("mouseup",(function(){return j.xc(n),j.gc(2).setZoomFixed("in")}))("keyup.enter",(function(){return j.xc(n),j.gc(2).setZoomFixed("in")})),j.Ub()}}function hj(e,t){if(1&e){var n=j.Wb();j.Vb(0,"button",10),j.cc("click",(function(){return j.xc(n),j.gc(2).returnToChapterCamera()})),j.Vb(1,"span",11),j.Kc(2,"Clicking this button will reset the camera viewing the 3D model"),j.Ub(),j.Ub()}}function fj(e,t){if(1&e){var n=j.Wb();j.Vb(0,"button",12),j.cc("click",(function(){return j.xc(n),j.gc(2).togglePan()})),j.hc(1,"async"),j.hc(2,"async"),j.hc(3,"async"),j.Vb(4,"span",11),j.Kc(5,"Clicking this button changes whether the mouse movement rotates or pans the camera"),j.Ub(),j.Ub()}if(2&e){var i=j.gc(2);j.lc("selected","pan"===j.ic(1,3,i.panMode$))("matTooltip","pan"===j.ic(2,5,i.panMode$)?"Switch to Rotate Mode":"Switch to Pan Mode"),j.Eb("aria-pressed","pan"===j.ic(3,7,i.panMode$))}}function bj(e,t){if(1&e&&(j.Vb(0,"app-pillbox",2),j.Vb(1,"ul",3),j.Vb(2,"li"),j.Ic(3,dj,1,0,"button",4),j.Ub(),j.Vb(4,"li"),j.Ic(5,gj,1,0,"button",5),j.Ub(),j.Vb(6,"li"),j.Ic(7,hj,3,0,"button",6),j.Ub(),j.Vb(8,"li"),j.Ic(9,fj,6,9,"button",7),j.Ub(),j.Ub(),j.Ub()),2&e){var n=j.gc();j.Db(3),j.lc("ngIf",n.showZoom),j.Db(2),j.lc("ngIf",n.showZoom),j.Db(2),j.lc("ngIf",n.showResetPosition),j.Db(2),j.lc("ngIf",n.showPan)}}var mj,vj,yj,xj=((yj=function(){function e(t,n,i){y(this,e),this.store=t,this.cameraService=n,this.liveAnnouncer=i,this.showNav=!0,this.showZoom=!0,this.showPan=!0,this.showResetPosition=!0,this.viewLayout=nl,this.toolEnum=ks,this.expandNav=!1,this.breakpointEnum=Gc,this.padding="none",this.ngUnsubscribe=new Z.a}return v(e,[{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"setZoomFixed",value:function(e){this.cameraService.setCameraZoomWithVelocity("in"===e?-8:8),this.liveAnnouncer.announce("zoom ".concat(e," complete"))}},{key:"returnToChapterCamera",value:function(){var e=this,t=this.store.selectSnapshot(vs.getSelectedChapter);this.store.dispatch(new zn(t.camera.location)).subscribe((function(){e.liveAnnouncer.announce("recenter complete")}))}},{key:"resetChapter",value:function(){this.returnToChapterCamera();var e=this.store.selectSnapshot(vs.getSelectedChapterId);this.store.dispatch(new eo.UndoAll(e)),this.store.dispatch(new Yi.UpdateNodesChecked(!1)),this.store.dispatch(new na)}},{key:"centerCamera",value:function(){this.store.dispatch(new Mt)}},{key:"togglePan",value:function(){var e="pan"===this.store.selectSnapshot(ws.getPanMode)?"rotate":"pan";this.store.dispatch(new Qn(e))}},{key:"toggleNav",value:function(){this.expandNav=!this.expandNav}}]),e}()).\u0275fac=function(e){return new(e||yj)(j.Pb(L.g),j.Pb(Xn),j.Pb(qp.i))},yj.\u0275cmp=j.Jb({type:yj,selectors:[["app-engine-camera-bar"]],inputs:{showNav:"showNav",showZoom:"showZoom",showPan:"showPan",showResetPosition:"showResetPosition"},decls:2,vars:1,consts:[["data-test","cameraBar",1,"camera-bar"],["eventCategory","Engine 3D Controls","orientation","vertical",4,"ngIf"],["eventCategory","Engine 3D Controls","orientation","vertical"],["aria-label","Camera Control Buttons",1,"camera-bar__nav"],["app-pin-button","","buttonType","ghost","icon","minus","tabIndex","0","data-test","cameraZoomOut","matTooltip","Zoom Out","matTooltipPosition","left",3,"touchend","mouseup","keyup.enter",4,"ngIf"],["app-pin-button","","buttonType","ghost","icon","plus","tabIndex","0","data-test","cameraZoomIn","matTooltip","Zoom In","matTooltipPosition","left",3,"touchend","mouseup","keyup.enter",4,"ngIf"],["app-pin-button","","icon","location","buttonType","ghost","tabIndex","0","matTooltip","Recenter 3D Model","matTooltipPosition","left","data-test","cameraReset",3,"click",4,"ngIf"],["app-pin-button","","tabIndex","0","icon","arrows-alt","buttonType","ghost","matTooltipPosition","left","data-test","cameraPan",3,"selected","matTooltip","click",4,"ngIf"],["app-pin-button","","buttonType","ghost","icon","minus","tabIndex","0","data-test","cameraZoomOut","matTooltip","Zoom Out","matTooltipPosition","left",3,"touchend","mouseup","keyup.enter"],["app-pin-button","","buttonType","ghost","icon","plus","tabIndex","0","data-test","cameraZoomIn","matTooltip","Zoom In","matTooltipPosition","left",3,"touchend","mouseup","keyup.enter"],["app-pin-button","","icon","location","buttonType","ghost","tabIndex","0","matTooltip","Recenter 3D Model","matTooltipPosition","left","data-test","cameraReset",3,"click"],[1,"visually-hidden"],["app-pin-button","","tabIndex","0","icon","arrows-alt","buttonType","ghost","matTooltipPosition","left","data-test","cameraPan",3,"selected","matTooltip","click"]],template:function(e,t){1&e&&(j.Vb(0,"div",0),j.Ic(1,bj,10,4,"app-pillbox",1),j.Ub()),2&e&&(j.Db(1),j.lc("ngIf",t.showNav))},directives:[we.l,yC,Dg,Lg.c],pipes:[we.b],styles:[":host{position:relative}.camera-bar{display:flex;flex-direction:column;align-items:center}.camera-bar button:not(:first-child){margin-top:4px}.camera-bar__nav{display:flex;flex-direction:column-reverse;overflow:hidden;transition:height .15s ease-in-out;justify-content:space-between}"],encapsulation:2,data:{animation:[Object(du.n)("expand",[Object(du.m)(":enter",[Object(du.j)([Object(du.l)({height:0}),Object(du.e)("150ms ease-in-out",Object(du.l)({height:"*"}))])]),Object(du.m)(":leave",[Object(du.j)([Object(du.e)("150ms ease-in-out",Object(du.l)({height:"0"}))])])]),Object(du.n)("show",[Object(du.m)(":enter",[Object(du.j)([Object(du.l)({height:"0"}),Object(du.e)("125ms ease-in-out",Object(du.l)({height:"*"}))])]),Object(du.m)(":leave",[Object(du.j)([Object(du.e)("125ms 125ms ease-in-out",Object(du.l)({height:"0"}))])])])]},changeDetection:0}),pj([Object(L.d)(ws.getPanMode),uj("design:type",J.a)],yj.prototype,"panMode$",void 0),pj([Object(L.d)(tl.getBreakpoint),uj("design:type",J.a)],yj.prototype,"breakpoint$",void 0),yj),Oj=((vj=function(){function e(){y(this,e)}return v(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||vj)},vj.\u0275cmp=j.Jb({type:vj,selectors:[["app-button-loader"]],decls:5,vars:0,consts:[["tabindex","0","type","button","aria-label","Interact in 3D","type","button",1,"button-loader"],[1,"button-loader__button"],["src","assets/images/widget/loading_experience/interact-in-3d-arrow.svg","alt","Interact in 3D",1,"button-loader__3d-arrow"],[1,"button-loader__label"]],template:function(e,t){1&e&&(j.Vb(0,"button",0),j.Vb(1,"div",1),j.Qb(2,"img",2),j.Vb(3,"div",3),j.Kc(4,"Interact in 3D"),j.Ub(),j.Ub(),j.Ub())},styles:[".m-1[_ngcontent-%COMP%]{margin:4px!important}.mv-1[_ngcontent-%COMP%]{margin-top:4px!important;margin-bottom:4px!important}.mh-1[_ngcontent-%COMP%]{margin-left:4px!important;margin-right:4px!important}.mt-1[_ngcontent-%COMP%]{margin-top:4px!important}.mr-1[_ngcontent-%COMP%]{margin-right:4px!important}.mb-1[_ngcontent-%COMP%]{margin-bottom:4px!important}.ml-1[_ngcontent-%COMP%]{margin-left:4px!important}.p-1[_ngcontent-%COMP%]{padding:4px!important}.pv-1[_ngcontent-%COMP%]{padding-top:4px!important;padding-bottom:4px!important}.ph-1[_ngcontent-%COMP%]{padding-left:4px!important;padding-right:4px!important}.pt-1[_ngcontent-%COMP%]{padding-top:4px!important}.pr-1[_ngcontent-%COMP%]{padding-right:4px!important}.pb-1[_ngcontent-%COMP%]{padding-bottom:4px!important}.pl-1[_ngcontent-%COMP%]{padding-left:4px!important}.m-2[_ngcontent-%COMP%]{margin:8px!important}.mv-2[_ngcontent-%COMP%]{margin-top:8px!important;margin-bottom:8px!important}.mh-2[_ngcontent-%COMP%]{margin-left:8px!important;margin-right:8px!important}.mt-2[_ngcontent-%COMP%]{margin-top:8px!important}.mr-2[_ngcontent-%COMP%]{margin-right:8px!important}.mb-2[_ngcontent-%COMP%]{margin-bottom:8px!important}.ml-2[_ngcontent-%COMP%]{margin-left:8px!important}.p-2[_ngcontent-%COMP%]{padding:8px!important}.pv-2[_ngcontent-%COMP%]{padding-top:8px!important;padding-bottom:8px!important}.ph-2[_ngcontent-%COMP%]{padding-left:8px!important;padding-right:8px!important}.pt-2[_ngcontent-%COMP%]{padding-top:8px!important}.pr-2[_ngcontent-%COMP%]{padding-right:8px!important}.pb-2[_ngcontent-%COMP%]{padding-bottom:8px!important}.pl-2[_ngcontent-%COMP%]{padding-left:8px!important}.m-3[_ngcontent-%COMP%]{margin:12px!important}.mv-3[_ngcontent-%COMP%]{margin-top:12px!important;margin-bottom:12px!important}.mh-3[_ngcontent-%COMP%]{margin-left:12px!important;margin-right:12px!important}.mt-3[_ngcontent-%COMP%]{margin-top:12px!important}.mr-3[_ngcontent-%COMP%]{margin-right:12px!important}.mb-3[_ngcontent-%COMP%]{margin-bottom:12px!important}.ml-3[_ngcontent-%COMP%]{margin-left:12px!important}.p-3[_ngcontent-%COMP%]{padding:12px!important}.pv-3[_ngcontent-%COMP%]{padding-top:12px!important;padding-bottom:12px!important}.ph-3[_ngcontent-%COMP%]{padding-left:12px!important;padding-right:12px!important}.pt-3[_ngcontent-%COMP%]{padding-top:12px!important}.pr-3[_ngcontent-%COMP%]{padding-right:12px!important}.pb-3[_ngcontent-%COMP%]{padding-bottom:12px!important}.pl-3[_ngcontent-%COMP%]{padding-left:12px!important}.m-4[_ngcontent-%COMP%]{margin:16px!important}.mv-4[_ngcontent-%COMP%]{margin-top:16px!important;margin-bottom:16px!important}.mh-4[_ngcontent-%COMP%]{margin-left:16px!important;margin-right:16px!important}.mt-4[_ngcontent-%COMP%]{margin-top:16px!important}.mr-4[_ngcontent-%COMP%]{margin-right:16px!important}.mb-4[_ngcontent-%COMP%]{margin-bottom:16px!important}.ml-4[_ngcontent-%COMP%]{margin-left:16px!important}.p-4[_ngcontent-%COMP%]{padding:16px!important}.pv-4[_ngcontent-%COMP%]{padding-top:16px!important;padding-bottom:16px!important}.ph-4[_ngcontent-%COMP%]{padding-left:16px!important;padding-right:16px!important}.pt-4[_ngcontent-%COMP%]{padding-top:16px!important}.pr-4[_ngcontent-%COMP%]{padding-right:16px!important}.pb-4[_ngcontent-%COMP%]{padding-bottom:16px!important}.pl-4[_ngcontent-%COMP%]{padding-left:16px!important}.m-5[_ngcontent-%COMP%]{margin:20px!important}.mv-5[_ngcontent-%COMP%]{margin-top:20px!important;margin-bottom:20px!important}.mh-5[_ngcontent-%COMP%]{margin-left:20px!important;margin-right:20px!important}.mt-5[_ngcontent-%COMP%]{margin-top:20px!important}.mr-5[_ngcontent-%COMP%]{margin-right:20px!important}.mb-5[_ngcontent-%COMP%]{margin-bottom:20px!important}.ml-5[_ngcontent-%COMP%]{margin-left:20px!important}.p-5[_ngcontent-%COMP%]{padding:20px!important}.pv-5[_ngcontent-%COMP%]{padding-top:20px!important;padding-bottom:20px!important}.ph-5[_ngcontent-%COMP%]{padding-left:20px!important;padding-right:20px!important}.pt-5[_ngcontent-%COMP%]{padding-top:20px!important}.pr-5[_ngcontent-%COMP%]{padding-right:20px!important}.pb-5[_ngcontent-%COMP%]{padding-bottom:20px!important}.pl-5[_ngcontent-%COMP%]{padding-left:20px!important}.m-6[_ngcontent-%COMP%]{margin:24px!important}.mv-6[_ngcontent-%COMP%]{margin-top:24px!important;margin-bottom:24px!important}.mh-6[_ngcontent-%COMP%]{margin-left:24px!important;margin-right:24px!important}.mt-6[_ngcontent-%COMP%]{margin-top:24px!important}.mr-6[_ngcontent-%COMP%]{margin-right:24px!important}.mb-6[_ngcontent-%COMP%]{margin-bottom:24px!important}.ml-6[_ngcontent-%COMP%]{margin-left:24px!important}.p-6[_ngcontent-%COMP%]{padding:24px!important}.pv-6[_ngcontent-%COMP%]{padding-top:24px!important;padding-bottom:24px!important}.ph-6[_ngcontent-%COMP%]{padding-left:24px!important;padding-right:24px!important}.pt-6[_ngcontent-%COMP%]{padding-top:24px!important}.pr-6[_ngcontent-%COMP%]{padding-right:24px!important}.pb-6[_ngcontent-%COMP%]{padding-bottom:24px!important}.pl-6[_ngcontent-%COMP%]{padding-left:24px!important}.m-7[_ngcontent-%COMP%]{margin:28px!important}.mv-7[_ngcontent-%COMP%]{margin-top:28px!important;margin-bottom:28px!important}.mh-7[_ngcontent-%COMP%]{margin-left:28px!important;margin-right:28px!important}.mt-7[_ngcontent-%COMP%]{margin-top:28px!important}.mr-7[_ngcontent-%COMP%]{margin-right:28px!important}.mb-7[_ngcontent-%COMP%]{margin-bottom:28px!important}.ml-7[_ngcontent-%COMP%]{margin-left:28px!important}.p-7[_ngcontent-%COMP%]{padding:28px!important}.pv-7[_ngcontent-%COMP%]{padding-top:28px!important;padding-bottom:28px!important}.ph-7[_ngcontent-%COMP%]{padding-left:28px!important;padding-right:28px!important}.pt-7[_ngcontent-%COMP%]{padding-top:28px!important}.pr-7[_ngcontent-%COMP%]{padding-right:28px!important}.pb-7[_ngcontent-%COMP%]{padding-bottom:28px!important}.pl-7[_ngcontent-%COMP%]{padding-left:28px!important}.m-8[_ngcontent-%COMP%]{margin:32px!important}.mv-8[_ngcontent-%COMP%]{margin-top:32px!important;margin-bottom:32px!important}.mh-8[_ngcontent-%COMP%]{margin-left:32px!important;margin-right:32px!important}.mt-8[_ngcontent-%COMP%]{margin-top:32px!important}.mr-8[_ngcontent-%COMP%]{margin-right:32px!important}.mb-8[_ngcontent-%COMP%]{margin-bottom:32px!important}.ml-8[_ngcontent-%COMP%]{margin-left:32px!important}.p-8[_ngcontent-%COMP%]{padding:32px!important}.pv-8[_ngcontent-%COMP%]{padding-top:32px!important;padding-bottom:32px!important}.ph-8[_ngcontent-%COMP%]{padding-left:32px!important;padding-right:32px!important}.pt-8[_ngcontent-%COMP%]{padding-top:32px!important}.pr-8[_ngcontent-%COMP%]{padding-right:32px!important}.pb-8[_ngcontent-%COMP%]{padding-bottom:32px!important}.pl-8[_ngcontent-%COMP%]{padding-left:32px!important}.m-9[_ngcontent-%COMP%]{margin:36px!important}.mv-9[_ngcontent-%COMP%]{margin-top:36px!important;margin-bottom:36px!important}.mh-9[_ngcontent-%COMP%]{margin-left:36px!important;margin-right:36px!important}.mt-9[_ngcontent-%COMP%]{margin-top:36px!important}.mr-9[_ngcontent-%COMP%]{margin-right:36px!important}.mb-9[_ngcontent-%COMP%]{margin-bottom:36px!important}.ml-9[_ngcontent-%COMP%]{margin-left:36px!important}.p-9[_ngcontent-%COMP%]{padding:36px!important}.pv-9[_ngcontent-%COMP%]{padding-top:36px!important;padding-bottom:36px!important}.ph-9[_ngcontent-%COMP%]{padding-left:36px!important;padding-right:36px!important}.pt-9[_ngcontent-%COMP%]{padding-top:36px!important}.pr-9[_ngcontent-%COMP%]{padding-right:36px!important}.pb-9[_ngcontent-%COMP%]{padding-bottom:36px!important}.pl-9[_ngcontent-%COMP%]{padding-left:36px!important}.m-10[_ngcontent-%COMP%]{margin:40px!important}.mv-10[_ngcontent-%COMP%]{margin-top:40px!important;margin-bottom:40px!important}.mh-10[_ngcontent-%COMP%]{margin-left:40px!important;margin-right:40px!important}.mt-10[_ngcontent-%COMP%]{margin-top:40px!important}.mr-10[_ngcontent-%COMP%]{margin-right:40px!important}.mb-10[_ngcontent-%COMP%]{margin-bottom:40px!important}.ml-10[_ngcontent-%COMP%]{margin-left:40px!important}.p-10[_ngcontent-%COMP%]{padding:40px!important}.pv-10[_ngcontent-%COMP%]{padding-top:40px!important;padding-bottom:40px!important}.ph-10[_ngcontent-%COMP%]{padding-left:40px!important;padding-right:40px!important}.pt-10[_ngcontent-%COMP%]{padding-top:40px!important}.pr-10[_ngcontent-%COMP%]{padding-right:40px!important}.pb-10[_ngcontent-%COMP%]{padding-bottom:40px!important}.pl-10[_ngcontent-%COMP%]{padding-left:40px!important}.text-8[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase[_ngcontent-%COMP%]{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase[_ngcontent-%COMP%]{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase[_ngcontent-%COMP%]{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase[_ngcontent-%COMP%]{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-28[_ngcontent-%COMP%]{font-size:28px;letter-spacing:.7px;line-height:1.4em}.text-28.text-uppercase[_ngcontent-%COMP%]{font-size:28px;letter-spacing:1.68px;line-height:1.25em;text-transform:uppercase}.text-header[_ngcontent-%COMP%]{font-weight:700}.text--code[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.text-xlight[_ngcontent-%COMP%]{font-weight:200}.text-light[_ngcontent-%COMP%]{font-weight:300}.text-medium[_ngcontent-%COMP%]{font-weight:500}.text-semibold[_ngcontent-%COMP%]{font-weight:600}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-underline[_ngcontent-%COMP%]{text-decoration:underline}.text-italic[_ngcontent-%COMP%]{font-style:italic}.text-bright[_ngcontent-%COMP%]{color:#fff}.text-dim[_ngcontent-%COMP%]{color:#96a8c0}.text-error[_ngcontent-%COMP%]{color:#ed4758}.text-left[_ngcontent-%COMP%]{text-align:left}.text-center[_ngcontent-%COMP%]{text-align:center}.text-right[_ngcontent-%COMP%]{text-align:right}.text-ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link[_ngcontent-%COMP%], .text-link[_ngcontent-%COMP%]:visited{color:inherit;cursor:pointer}.text-link[_ngcontent-%COMP%]:not(.text-underline), .text-link[_ngcontent-%COMP%]:visited:not(.text-underline){text-decoration:none}.text-success[_ngcontent-%COMP%]{color:#38de38}.text-danger[_ngcontent-%COMP%]{color:#de3535}.text-info[_ngcontent-%COMP%]{color:#2d72dc}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.text-pre-line[_ngcontent-%COMP%]{white-space:pre-line}.button-loader[_ngcontent-%COMP%]{border:0;width:100%;background:rgba(0,0,0,.2);display:flex;position:fixed;justify-content:center;align-items:center;top:0;bottom:0;left:0;right:0;transition:background-color .25s,opacity .25s;z-index:10000}.button-loader[_ngcontent-%COMP%]:hover{opacity:1;cursor:pointer;background:rgba(0,0,0,.2)}@media print{.button-loader[_ngcontent-%COMP%]{display:none}}.button-loader[_ngcontent-%COMP%]:focus   .button-loader__button[_ngcontent-%COMP%], .button-loader[_ngcontent-%COMP%]:hover   .button-loader__button[_ngcontent-%COMP%]{background-color:#2d72dc;transform:scale(1.1)}.button-loader[_ngcontent-%COMP%]:focus   .button-loader__3d-arrow[_ngcontent-%COMP%], .button-loader[_ngcontent-%COMP%]:hover   .button-loader__3d-arrow[_ngcontent-%COMP%]{transform:scale(1.2)}.button-loader__button[_ngcontent-%COMP%]{display:flex;padding:12px 28px;border-radius:32px;align-items:center;transition:transform .25s,background-color .25s;background-color:rgba(16,24,35,.8)}.button-loader__3d-arrow[_ngcontent-%COMP%]{transition:transform .25s;margin-right:4px}.button-loader__label[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em;color:#fff;font-weight:600;margin-left:4px}"],changeDetection:0}),vj),wj=((mj=function(){function e(t,n,i,o){y(this,e),this.changeRef=t,this.viewService=n,this.bookmarksService=i,this.imagesService=o,this.thumbnailURL=""}return v(e,[{key:"ngOnInit",value:function(){this.setThumbnailUrl()}},{key:"handleClick",value:function(){this.viewService.toggleOnDemand(!1)}},{key:"setThumbnailUrl",value:function(){var e=this;this.contentType===M.Bookmark?this.bookmarksService.getBookmarkModel(this.contentId).subscribe((function(t){e.thumbnailURL=t.thumbnail_url,e.changeRef.markForCheck()})):(this.thumbnailURL=this.imagesService.getIndexThumbnail(this.contentId),this.changeRef.markForCheck())}},{key:"getPoweredByUrl",value:function(){return("undefined"==typeof localBaseDirectory?"":localBaseDirectory)+"assets/images/powered-by-biodigital-logo.svg"}}]),e}()).\u0275fac=function(e){return new(e||mj)(j.Pb(j.i),j.Pb(Wp),j.Pb(s_),j.Pb(F_))},mj.\u0275cmp=j.Jb({type:mj,selectors:[["app-view-ondemand"]],inputs:{contentId:"contentId",contentType:"contentType"},decls:5,vars:2,consts:[[1,"ondemand",3,"click"],[1,"ondemand__image",3,"lazyLoad"],[1,"ondemand__logo"],[3,"src"]],template:function(e,t){1&e&&(j.Vb(0,"div",0),j.cc("click",(function(){return t.handleClick()})),j.Qb(1,"div",1),j.Qb(2,"app-button-loader"),j.Vb(3,"div",2),j.Qb(4,"img",3),j.Ub(),j.Ub()),2&e&&(j.Db(1),j.lc("lazyLoad",t.thumbnailURL),j.Db(3),j.lc("src",t.getPoweredByUrl(),j.Ac))},directives:[Af.a,Oj],styles:[".ondemand__image[_ngcontent-%COMP%]{position:absolute;top:0;bottom:0;left:0;right:0;background-size:cover;background-repeat:no-repeat;background-position:50%;filter:blur(6px)}.ondemand__logo[_ngcontent-%COMP%]{position:absolute;bottom:40px;justify-content:center;width:100%;z-index:20000;display:flex}"],changeDetection:0}),mj),kj=["circle"],Cj=["progressCircle"],Sj=["progressContainer"];function _j(e,t){if(1&e&&(j.fc(),j.ec(),j.Vb(0,"div",9),j.Kc(1),j.Ub()),2&e){var n=j.gc();j.Db(1),j.Mc("",n.percent,"%")}}var jj,Pj,Mj,Ij,zj=function(e){return{"view-progress--active":e}},Tj=function(e){return{"view-progress__ring--pulse":e}},Uj=((jj=function(){function e(t,n){y(this,e),this.renderer=t,this.changeDetectorRef=n,this.ngUnsubscribe=new Z.a,this.label="Loading...",this._show=!1,this._percent=new kp.a(0)}return v(e,[{key:"show",get:function(){return this._show},set:function(e){var t=this;setTimeout((function(){t._show=e,t.changeDetectorRef.markForCheck()}))}},{key:"percent",get:function(){return Math.floor(this._percent.value)},set:function(e){null!=e&&this._percent.next(e)}},{key:"ngOnInit",value:function(){this.initSizeObserver()}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"ngAfterViewInit",value:function(){this.updateDimensions(),this.initPercentObserver()}},{key:"initPercentObserver",value:function(){var e=this;this._percent.pipe(Object(X.a)(this.ngUnsubscribe)).subscribe((function(){e.label=e.getLoadingLabel(e.percent),e.renderProgress(0===e.percent?100:e.percent),e.changeDetectorRef.markForCheck()}))}},{key:"initSizeObserver",value:function(){var e=this;Object(ka.a)(window,"resize").pipe(Object(Gp.a)(10),Object(X.a)(this.ngUnsubscribe)).subscribe((function(){e.updateDimensions()}))}},{key:"calculateRadius",value:function(){return this.getCircleWidth()/2}},{key:"getCircleWidth",value:function(){return this.circleRef.nativeElement.offsetWidth}},{key:"getRadius",value:function(){return this.progressCircleRef.nativeElement.r.baseVal.value}},{key:"getCircumference",value:function(){return 2*this.getRadius()*Math.PI}},{key:"getOffset",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,t=this.getCircumference();return t-e/100*t}},{key:"renderProgress",value:function(e){e>=100&&(e=100);var t=this.getCircumference(),n=this.getOffset(e);this.renderer.setStyle(this.progressCircleRef.nativeElement,"strokeDasharray","".concat(t," ").concat(t)),this.renderer.setStyle(this.progressCircleRef.nativeElement,"strokeDashoffset",""+n)}},{key:"getLoadingLabel",value:function(e){return 100===e?"Launching...":"Loading..."}},{key:"updateDimensions",value:function(){var e=this.calculateRadius();this.renderer.setAttribute(this.progressContainerRef.nativeElement,"width",""+2*e),this.renderer.setAttribute(this.progressContainerRef.nativeElement,"height",""+2*e),this.renderer.setAttribute(this.progressCircleRef.nativeElement,"r",""+(e-6)),this.renderer.setAttribute(this.progressCircleRef.nativeElement,"cx",""+e),this.renderer.setAttribute(this.progressCircleRef.nativeElement,"cy",""+e);var t=this.getCircumference();this.renderer.setStyle(this.progressCircleRef.nativeElement,"strokeDasharray","".concat(t," ").concat(t)),this.renderer.setStyle(this.progressCircleRef.nativeElement,"strokeDashoffset",""+t)}}]),e}()).\u0275fac=function(e){return new(e||jj)(j.Pb(j.H),j.Pb(j.i))},jj.\u0275cmp=j.Jb({type:jj,selectors:[["app-view-progress"]],viewQuery:function(e,t){var n;1&e&&(j.Ec(kj,!0),j.Ec(Cj,!0),j.Ec(Sj,!0)),2&e&&(j.sc(n=j.dc())&&(t.circleRef=n.first),j.sc(n=j.dc())&&(t.progressCircleRef=n.first),j.sc(n=j.dc())&&(t.progressContainerRef=n.first))},inputs:{show:"show",percent:"percent"},decls:10,vars:10,consts:[["data-test","viewProgress","role","alert",1,"view-progress",3,"ngClass"],["aria-hidden","true",1,"view-progress__circle"],["circle",""],[1,"view-progress__ring",3,"ngClass"],["progressContainer",""],[1,"view-progress__ring-inner"],["progressCircle",""],["class","view-progress__count",4,"ngIf"],[1,"view-progress__label"],[1,"view-progress__count"]],template:function(e,t){1&e&&(j.Vb(0,"div",0),j.Vb(1,"div",1,2),j.fc(),j.Vb(3,"svg",3,4),j.Qb(5,"circle",5,6),j.Ub(),j.Ic(7,_j,2,1,"div",7),j.ec(),j.Vb(8,"div",8),j.Kc(9),j.Ub(),j.Ub(),j.Ub()),2&e&&(j.lc("ngClass",j.nc(6,zj,t.show)),j.Eb("aria-busy",t.show),j.Db(1),j.lc("@isOpen",t.show?"open":"closed"),j.Db(2),j.lc("ngClass",j.nc(8,Tj,0===t.percent||100===t.percent)),j.Db(4),j.lc("ngIf",t.percent>0&&t.percent<100),j.Db(2),j.Mc(" ",t.label," "))},directives:[we.i,we.l],styles:[".text-8[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase[_ngcontent-%COMP%]{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase[_ngcontent-%COMP%]{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase[_ngcontent-%COMP%]{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase[_ngcontent-%COMP%]{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-28[_ngcontent-%COMP%]{font-size:28px;letter-spacing:.7px;line-height:1.4em}.text-28.text-uppercase[_ngcontent-%COMP%]{font-size:28px;letter-spacing:1.68px;line-height:1.25em;text-transform:uppercase}.text-header[_ngcontent-%COMP%]{font-weight:700}.text--code[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.text-xlight[_ngcontent-%COMP%]{font-weight:200}.text-light[_ngcontent-%COMP%]{font-weight:300}.text-medium[_ngcontent-%COMP%]{font-weight:500}.text-semibold[_ngcontent-%COMP%]{font-weight:600}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-underline[_ngcontent-%COMP%]{text-decoration:underline}.text-italic[_ngcontent-%COMP%]{font-style:italic}.text-bright[_ngcontent-%COMP%]{color:#fff}.text-dim[_ngcontent-%COMP%]{color:#96a8c0}.text-error[_ngcontent-%COMP%]{color:#ed4758}.text-left[_ngcontent-%COMP%]{text-align:left}.text-center[_ngcontent-%COMP%]{text-align:center}.text-right[_ngcontent-%COMP%]{text-align:right}.text-ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link[_ngcontent-%COMP%], .text-link[_ngcontent-%COMP%]:visited{color:inherit;cursor:pointer}.text-link[_ngcontent-%COMP%]:not(.text-underline), .text-link[_ngcontent-%COMP%]:visited:not(.text-underline){text-decoration:none}.text-success[_ngcontent-%COMP%]{color:#38de38}.text-danger[_ngcontent-%COMP%]{color:#de3535}.text-info[_ngcontent-%COMP%]{color:#2d72dc}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.text-pre-line[_ngcontent-%COMP%]{white-space:pre-line}.view-progress[_ngcontent-%COMP%]{--circleSize:35vw;pointer-events:none;position:absolute;display:flex;justify-content:center;align-items:center;left:0;right:0;top:0;bottom:0;z-index:1000;transition:background-color .15s}@-webkit-keyframes progressPulse{0%{stroke-width:4}50%{stroke-width:1}to{stroke-width:4}}@keyframes progressPulse{0%{stroke-width:4}50%{stroke-width:1}to{stroke-width:4}}.view-progress--active[_ngcontent-%COMP%]{background-color:rgba(0,0,0,.2)}.view-progress__circle[_ngcontent-%COMP%]{transform:scale(0);width:var(--circleSize);height:var(--circleSize);border-radius:50%;background-color:rgba(16,24,35,.8);display:flex;flex-direction:column;align-items:center;justify-content:center;position:relative}.view-progress__count[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em;color:#fff;font-weight:700}.view-progress__label[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em;color:hsla(0,0%,100%,.8)}.view-progress__ring[_ngcontent-%COMP%]{position:absolute;top:0;right:0;bottom:0;left:0;z-index:3;opacity:1;stroke-dashoffset:0;stroke-width:4;stroke:hsla(0,0%,100%,.8);fill:transparent;transform:rotate(-90deg)}.view-progress__ring--pulse[_ngcontent-%COMP%]{-webkit-animation:progressPulse 2s ease-in-out infinite;animation:progressPulse 2s ease-in-out infinite}@media (min-width:600px){.view-progress__circle[_ngcontent-%COMP%]{width:160px;height:160px}}"],data:{animation:[Object(du.n)("isOpen",[Object(du.k)("open",Object(du.l)({transform:"scale(1)"})),Object(du.k)("closed",Object(du.l)({transform:"scale(0)"})),Object(du.m)("closed => open",[Object(du.e)("300ms ease-out")]),Object(du.m)("open => closed",[Object(du.e)("150ms ease-in")])])]},changeDetection:0}),jj),Dj=["viewLoader"],Lj=["*"],Ej=((Pj=function(){function e(t,n,i){y(this,e),this.renderer=t,this.viewService=n,this.actions=i,this.ngUnsubscribe=new Z.a}return v(e,[{key:"handleClick",value:function(){var e=this;this.renderer.addClass(this.viewLoaderRef.nativeElement,"view-loader--disappear"),setTimeout((function(){e.viewService.toggleInteract(!1),e.viewService.playChapterFromStart()}),250)}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}}]),e}()).\u0275fac=function(e){return new(e||Pj)(j.Pb(j.H),j.Pb(Wp),j.Pb(L.b))},Pj.\u0275cmp=j.Jb({type:Pj,selectors:[["app-view-loader"]],viewQuery:function(e,t){var n;1&e&&j.Ec(Dj,!0),2&e&&j.sc(n=j.dc())&&(t.viewLoaderRef=n.first)},ngContentSelectors:Lj,decls:4,vars:0,consts:[["role","dialog",1,"view-loader"],["viewLoader",""],["role","button",3,"click"]],template:function(e,t){1&e&&(j.kc(),j.Vb(0,"div",0,1),j.Vb(2,"div",2),j.cc("click",(function(){return t.handleClick()})),j.jc(3),j.Ub(),j.Ub())},styles:[""],encapsulation:2,changeDetection:0}),Pj),Fj=["circle"],Aj=["progressCircle"],Rj=["progressContainer"],Vj=((Ij=function(){function e(t){y(this,e),this.renderer=t,this.ngUnsubscribe=new Z.a,this._percent=0}return v(e,[{key:"percent",get:function(){return this._percent},set:function(e){null!=e&&(this._percent=e,this.setProgress(this.percent))}},{key:"ngOnInit",value:function(){this.initSizeObserver()}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"ngAfterViewInit",value:function(){this.updateDimensions()}},{key:"initSizeObserver",value:function(){var e=this;Object(ka.a)(window,"resize").pipe(Object(Gp.a)(10),Object(X.a)(this.ngUnsubscribe)).subscribe((function(){e.updateDimensions()}))}},{key:"calculateRadius",value:function(){return this.getCircleWidth()/2}},{key:"getCircleWidth",value:function(){return this.circleRef.nativeElement.offsetWidth}},{key:"getRadius",value:function(){return this.progressCircleRef.nativeElement.r.baseVal.value}},{key:"getCircumference",value:function(){return 2*this.getRadius()*Math.PI}},{key:"getOffset",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,t=this.getCircumference();return t-e/100*t}},{key:"setProgress",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;e>=100&&(e=100);var t=this.getCircumference(),n=this.getOffset(e);this.renderer.setStyle(this.progressCircleRef.nativeElement,"strokeDasharray","".concat(t," ").concat(t)),this.renderer.setStyle(this.progressCircleRef.nativeElement,"strokeDashoffset",""+n)}},{key:"updateDimensions",value:function(){var e=this,t=this.calculateRadius();this.renderer.setAttribute(this.progressContainerRef.nativeElement,"width",""+2*t),this.renderer.setAttribute(this.progressContainerRef.nativeElement,"height",""+2*t),this.renderer.setAttribute(this.progressCircleRef.nativeElement,"r",""+(t-6)),this.renderer.setAttribute(this.progressCircleRef.nativeElement,"cx",""+t),this.renderer.setAttribute(this.progressCircleRef.nativeElement,"cy",""+t);var n=this.getCircumference();this.renderer.setStyle(this.progressCircleRef.nativeElement,"strokeDasharray","".concat(n," ").concat(n)),this.renderer.setStyle(this.progressCircleRef.nativeElement,"strokeDashoffset",""+n),setTimeout((function(){e.renderer.setStyle(e.progressCircleRef.nativeElement,"transition","stroke-dashoffset 300ms")}))}}]),e}()).\u0275fac=function(e){return new(e||Ij)(j.Pb(j.H))},Ij.\u0275cmp=j.Jb({type:Ij,selectors:[["app-play-loader"]],viewQuery:function(e,t){var n;1&e&&(j.Ec(Fj,!0),j.Ec(Aj,!0),j.Ec(Rj,!0)),2&e&&(j.sc(n=j.dc())&&(t.circleRef=n.first),j.sc(n=j.dc())&&(t.progressCircleRef=n.first),j.sc(n=j.dc())&&(t.progressContainerRef=n.first))},inputs:{percent:"percent"},decls:10,vars:0,consts:[["tabindex","0","type","button","aria-label","Interact in 3D",1,"play-loader"],[1,"play-loader__circle"],["circle",""],[1,"play-loader__ring"],["progressContainer",""],[1,"play-loader__ring-inner"],["progressCircle",""],["icon","play",1,"play-loader__icon"],[1,"play-loader__label"]],template:function(e,t){1&e&&(j.Vb(0,"button",0),j.Vb(1,"div",1,2),j.fc(),j.Vb(3,"svg",3,4),j.Qb(5,"circle",5,6),j.Ub(),j.ec(),j.Qb(7,"app-icon",7),j.Vb(8,"div",8),j.Kc(9,"3D"),j.Ub(),j.Ub(),j.Ub())},directives:[vp],styles:[".play-loader[_ngcontent-%COMP%]{--buttonSize:35vw;border:0;width:100%;background:rgba(0,0,0,.2);display:flex;position:fixed;justify-content:center;align-items:center;top:0;bottom:0;left:0;right:0;transition:background-color .25s,opacity .25s;z-index:10000}.play-loader[_ngcontent-%COMP%]:hover{opacity:1;cursor:pointer;background:rgba(0,0,0,.2)}.play-loader[_ngcontent-%COMP%]:focus   .play-loader__circle[_ngcontent-%COMP%], .play-loader[_ngcontent-%COMP%]:hover   .play-loader__circle[_ngcontent-%COMP%]{background:hsla(0,0%,100%,.8);transform:scale(1.1)}.play-loader[_ngcontent-%COMP%]:focus   .play-loader__icon[_ngcontent-%COMP%], .play-loader[_ngcontent-%COMP%]:hover   .play-loader__icon[_ngcontent-%COMP%]{color:#2d72dc;transform:scale(1.2)}.play-loader[_ngcontent-%COMP%]:focus   .play-loader__label[_ngcontent-%COMP%], .play-loader[_ngcontent-%COMP%]:hover   .play-loader__label[_ngcontent-%COMP%]{color:#fff}.play-loader[_ngcontent-%COMP%]:focus   .play-loader__ring[_ngcontent-%COMP%], .play-loader[_ngcontent-%COMP%]:hover   .play-loader__ring[_ngcontent-%COMP%]{stroke:#2d72dc}.play-loader__circle[_ngcontent-%COMP%]{width:var(--buttonSize);height:var(--buttonSize);border-radius:50%;background-color:rgba(16,24,35,.8);display:flex;align-items:center;justify-content:center;position:relative;transition:background-color .25s,color .25s,transform .25s}.play-loader__icon[_ngcontent-%COMP%]{font-size:calc(var(--buttonSize) / 2);color:hsla(0,0%,100%,.9);transition:color .25s,transform .25s;margin-right:-10%}.play-loader__label[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%;display:flex;justify-content:center;align-items:center;z-index:2;font-weight:600}.play-loader__ring[_ngcontent-%COMP%]{position:absolute;top:0;right:0;bottom:0;left:0;z-index:3;stroke-width:4;stroke:#fff;fill:transparent;transform:rotate(-90deg)}@media (min-width:600px){.play-loader__circle[_ngcontent-%COMP%]{width:160px;height:160px}.play-loader__icon[_ngcontent-%COMP%]{font-size:80px}}"],changeDetection:0}),Ij),Nj=((Mj=function(){function e(){y(this,e)}return v(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||Mj)},Mj.\u0275cmp=j.Jb({type:Mj,selectors:[["app-hand-loader"]],decls:6,vars:0,consts:[["tabindex","0","type","button","aria-label","Interact in 3D",1,"hand-loader"],[1,"hand-loader__container"],[1,"hand-loader__circle"],["src","assets/images/widget/loading_experience/interact-in-3d-hand.svg","alt","Interact in 3D",1,"hand-loader__3d-hand"],[1,"hand-loader__label"]],template:function(e,t){1&e&&(j.Vb(0,"button",0),j.Vb(1,"div",1),j.Qb(2,"div",2),j.Qb(3,"img",3),j.Vb(4,"div",4),j.Kc(5,"Interact in 3D"),j.Ub(),j.Ub(),j.Ub())},styles:[".text-8[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase[_ngcontent-%COMP%]{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase[_ngcontent-%COMP%]{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase[_ngcontent-%COMP%]{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase[_ngcontent-%COMP%]{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-28[_ngcontent-%COMP%]{font-size:28px;letter-spacing:.7px;line-height:1.4em}.text-28.text-uppercase[_ngcontent-%COMP%]{font-size:28px;letter-spacing:1.68px;line-height:1.25em;text-transform:uppercase}.text-header[_ngcontent-%COMP%]{font-weight:700}.text--code[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.text-xlight[_ngcontent-%COMP%]{font-weight:200}.text-light[_ngcontent-%COMP%]{font-weight:300}.text-medium[_ngcontent-%COMP%]{font-weight:500}.text-semibold[_ngcontent-%COMP%]{font-weight:600}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-underline[_ngcontent-%COMP%]{text-decoration:underline}.text-italic[_ngcontent-%COMP%]{font-style:italic}.text-bright[_ngcontent-%COMP%]{color:#fff}.text-dim[_ngcontent-%COMP%]{color:#96a8c0}.text-error[_ngcontent-%COMP%]{color:#ed4758}.text-left[_ngcontent-%COMP%]{text-align:left}.text-center[_ngcontent-%COMP%]{text-align:center}.text-right[_ngcontent-%COMP%]{text-align:right}.text-ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link[_ngcontent-%COMP%], .text-link[_ngcontent-%COMP%]:visited{color:inherit;cursor:pointer}.text-link[_ngcontent-%COMP%]:not(.text-underline), .text-link[_ngcontent-%COMP%]:visited:not(.text-underline){text-decoration:none}.text-success[_ngcontent-%COMP%]{color:#38de38}.text-danger[_ngcontent-%COMP%]{color:#de3535}.text-info[_ngcontent-%COMP%]{color:#2d72dc}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.text-pre-line[_ngcontent-%COMP%]{white-space:pre-line}.hand-loader[_ngcontent-%COMP%]{border:0;width:100%;background:rgba(0,0,0,.2);display:flex;position:fixed;justify-content:center;align-items:center;top:0;bottom:0;left:0;right:0;transition:background-color .25s,opacity .25s;z-index:10000}.hand-loader[_ngcontent-%COMP%]:hover{opacity:1;cursor:pointer;background:rgba(0,0,0,.2)}@-webkit-keyframes handKeyframes{0%{transform:scale(1.2)}25%{transform:scale(1)}40%{transform:scale(1)}60%{transform:scale(1.2)}to{transform:scale(1.2)}}@keyframes handKeyframes{0%{transform:scale(1.2)}25%{transform:scale(1)}40%{transform:scale(1)}60%{transform:scale(1.2)}to{transform:scale(1.2)}}@-webkit-keyframes circleKeyframes{0%{transform:scale(0)}20%{transform:scale(0);opacity:1}to{transform:scale(1);opacity:0}}@keyframes circleKeyframes{0%{transform:scale(0)}20%{transform:scale(0);opacity:1}to{transform:scale(1);opacity:0}}.hand-loader[_ngcontent-%COMP%]:focus   .hand-loader__3d-hand[_ngcontent-%COMP%], .hand-loader[_ngcontent-%COMP%]:hover   .hand-loader__3d-hand[_ngcontent-%COMP%]{filter:drop-shadow(0 0 8px #2d72dc)}.hand-loader__container[_ngcontent-%COMP%]{position:relative;width:200px;height:200px}.hand-loader__circle[_ngcontent-%COMP%]{background-color:#fff;position:absolute;left:50%;margin-left:-40.5px;margin-top:-1.5px;width:70px;height:70px;border-radius:50%;-webkit-animation:circleKeyframes 2s infinite;animation:circleKeyframes 2s infinite}.hand-loader__3d-hand[_ngcontent-%COMP%]{-webkit-animation:handKeyframes 2s ease-in-out infinite;animation:handKeyframes 2s ease-in-out infinite;position:absolute;height:96px;width:86px;left:50%;margin-left:-43px;margin-top:27px;transition:filter .3s ease-out}.hand-loader__label[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em;font-weight:600;color:#fff;text-shadow:0 1px 5px #000;bottom:40px;position:absolute;text-align:center;width:100%}"],changeDetection:0}),Mj),Bj=["app-view-rounded-button",""];function Hj(e,t){if(1&e&&j.Qb(0,"app-icon",3),2&e){var n=j.gc();j.lc("icon",n.icon)}}var Qj,qj=((Qj=function(){function e(){y(this,e),this.iconPlacement="left",this.compact=!1,this.buttonType="outline"}return v(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||Qj)},Qj.\u0275cmp=j.Jb({type:Qj,selectors:[["button","app-view-rounded-button",""]],inputs:{icon:"icon",iconPlacement:"iconPlacement",label:"label",compact:"compact",buttonType:"buttonType",shadow:"shadow"},attrs:Bj,decls:4,vars:12,consts:[[1,"view-rounded-button"],["class","view-rounded-button__icon mh-1",3,"icon",4,"ngIf"],[1,"view-rounded-button__label","mh-1"],[1,"view-rounded-button__icon","mh-1",3,"icon"]],template:function(e,t){1&e&&(j.Vb(0,"div",0),j.Ic(1,Hj,1,1,"app-icon",1),j.Vb(2,"div",2),j.Kc(3),j.Ub(),j.Ub()),2&e&&(j.Hb("view-rounded-button--outline","outline"===t.buttonType)("view-rounded-button--solid","solid"===t.buttonType)("view-rounded-button--shadow",t.shadow)("view-rounded-button--compact",t.compact)("view-rounded-button--reverse","right"===t.iconPlacement),j.Db(1),j.lc("ngIf",t.icon),j.Db(2),j.Lc(t.label))},directives:[we.l,vp],styles:[".text-8{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-28{font-size:28px;letter-spacing:.7px;line-height:1.4em}.text-28.text-uppercase{font-size:28px;letter-spacing:1.68px;line-height:1.25em;text-transform:uppercase}.text-header{font-weight:700}.text--code{font-family:Courier New,Courier,monospace}.text-uppercase{text-transform:uppercase}.text-xlight{font-weight:200}.text-light{font-weight:300}.text-medium{font-weight:500}.text-semibold{font-weight:600}.text-bold{font-weight:700}.text-underline{text-decoration:underline}.text-italic{font-style:italic}.text-bright{color:#fff}.text-dim{color:#96a8c0}.text-error{color:#ed4758}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.text-ellipsis{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link,.text-link:visited{color:inherit;cursor:pointer}.text-link:not(.text-underline),.text-link:visited:not(.text-underline){text-decoration:none}.text-success{color:#38de38}.text-danger{color:#de3535}.text-info{color:#2d72dc}.text-nowrap{white-space:nowrap}.text-pre-line{white-space:pre-line}button[app-view-rounded-button]{border-color:transparent;background:none;border-width:0;padding:0;outline:none;margin:0;pointer-events:all}button[app-view-rounded-button]:focus .view-rounded-button,button[app-view-rounded-button]:hover .view-rounded-button{color:#f9fafd;border-color:#f9fafd;background:rgba(249,250,253,.25)}button[app-view-rounded-button]:focus .view-rounded-button--solid,button[app-view-rounded-button]:hover .view-rounded-button--solid{border-color:rgba(249,250,253,.25)}.view-rounded-button{cursor:pointer;display:flex;flex-direction:row;align-items:center;justify-content:center;padding:12px 16px;border-radius:24px;color:#f9fafd;border:1px solid #f9fafd}.view-rounded-button__label{font-size:16px;letter-spacing:.4px;line-height:1.4em}.view-rounded-button--solid{color:#060502;border-color:#060502;background:#f9fafd}.view-rounded-button--shadow{box-shadow:0 0 8px rgba(0,0,0,.32)}.view-rounded-button--reverse{flex-direction:row-reverse}.view-rounded-button--compact{padding:4px 8px}"],encapsulation:2,changeDetection:0}),Qj),$j=function(e){return e.CameraZoom="camera-zoom",e.CameraRotate="camera-rotate",e.CameraPan="camera-pan",e.NodeSelection="node-selection",e}({});function Wj(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.001;return Zj(e).pipe(Object(jC.a)(t.getCameraZoom()),Object(se.a)((function(){return t.getCameraZoom()})),Object(Cp.a)(),Object(se.a)((function(e){var t=d(e,2),n=t[0];return t[1]-n})),Object(Y.a)((function(e){return Math.abs(e)>i})),Object(Gp.a)(n))}function Kj(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:125;return Zj(e).pipe(Object(jC.a)(t.getLookDirection()),Object(se.a)((function(){return t.getLookDirection()})),Object(Cp.a)(),Object(se.a)((function(e){var t=d(e,2);return function(e,t){return Jn.a.angle(e,t)>.001}(t[0],t[1])})),Object(Y.a)((function(e){return e})),Object(Gp.a)(n))}function Gj(e){return{camera:e.getCamera(),zoom:e.getCameraZoom()}}function Zj(e){return e.getEvent(yn.CameraRested)}function Jj(e){var t=e.eye,n=e.look,i=Jn.a.fromValues(t.x,t.y,t.z),o=Jn.a.fromValues(n.x,n.y,n.z),r=Jn.a.create();return Jn.a.sub(r,i,o),r}var Xj=r("vqkR");function Yj(e,t){if(1&e&&(j.Vb(0,"h2",6),j.Kc(1),j.Ub()),2&e){var n=j.gc(2);j.Db(1),j.Mc(" ",n.title," ")}}function eP(e,t){if(1&e&&j.Qb(0,"img",7),2&e){var n=j.gc(2);j.lc("src",n.image,j.Ac)("alt",n.alt)}}function tP(e,t){if(1&e&&(j.Vb(0,"div",1),j.Ic(1,Yj,2,1,"h2",2),j.Vb(2,"article",3),j.jc(3),j.Ub(),j.Ic(4,eP,1,2,"img",4),j.Vb(5,"div",5),j.jc(6,1),j.Ub(),j.Ub()),2&e){var n=j.gc();j.Hb("slide--expanded","expanded"===n.spacing),j.lc("@refresh",void 0),j.Db(1),j.lc("ngIf",n.title),j.Db(3),j.lc("ngIf",n.image)}}var nP,iP=["*",[["","slide-footer",""]]],oP=["*","[slide-footer]"],rP=((nP=function(){function e(t,n,i,o,r){y(this,e),this.store=t,this.actions=n,this.engineService=i,this.cameraService=o,this.changeRef=r,this.alt="",this.spacing="compact",this.exitEnabled=!0,this.triggerDelay=300,this.triggerComplete=new j.p,this._shown=!1,this.ngUnsubscribe=new Z.a}return v(e,[{key:"shown",get:function(){return this._shown},set:function(e){this._shown=e,this.initTrigger(),this.changeRef.markForCheck()}},{key:"ngOnInit",value:function(){}},{key:"ngAfterViewInit",value:function(){this.initTrigger()}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"initTrigger",value:function(){var e=this;if(this.ngUnsubscribe.next(),this.shown&&this.trigger){var t=this.resetCamera(),n=this.store.selectSnapshot(hs.getCanTouch);(function(e,t,n,i,o){switch(e){case $j.CameraZoom:return o?Wj(n,i):function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.001,o=e.getCanvas(),r=Object(ka.a)(o,"wheel"),a=Object(ka.a)(o,"touchmove").pipe(Object(Y.a)((function(e){return 2===e.touches.length}))),s=Wj(e,t,n,i);return Object(Ca.a)(r,a).pipe(Object(vr.a)((function(){return s})))}(n,i);case $j.CameraPan:return function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:125,i=e.getCanvas(),o=Object(ka.a)(i,"mousemove").pipe(Object(Y.a)((function(e){return 1===e.buttons&&e.shiftKey||2===e.buttons||4===e.buttons}))),r=Object(ka.a)(i,"touchmove").pipe(Object(Y.a)((function(e){return 2===e.touches.length}))),a=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:125;return Zj(e).pipe(Object(jC.a)(Gj(t)),Object(se.a)((function(){return Gj(t)})),Object(Gp.a)(n),Object(Cp.a)(),Object(se.a)((function(e){var t=d(e,2);return function(e,t){var n=Jj(e.camera),i=Jj(t.camera),o=Jn.a.create();Jn.a.sub(o,n,i);var r=o.reduce((function(e,t){return e+t})),a=t.zoom-e.zoom;return(0!==a||0!==r)&&Math.abs(r)<1&&Math.abs(a)<.001}(t[0],t[1])})),Object(Y.a)((function(e){return e})))}(e,t,n);return Object(Ca.a)(o,r).pipe(Object(vr.a)((function(){return a})))}(n,i);case $j.CameraRotate:return o?Kj(n,i):function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e3,o=t.getCanvas(),r=Object(ka.a)(o,"mousemove").pipe(Object(Y.a)((function(e){return 1===e.buttons}))),a=Object(ka.a)(o,"touchmove").pipe(Object(Y.a)((function(e){return 1===e.touches.length}))),s=Kj(t,n,i);return Object(Ca.a)(r,a).pipe(Object(vr.a)((function(){return s})),Object(Y.a)((function(){return"rotate"===e.selectSnapshot(ws.getPanMode)})),Object(Gp.a)(125))}(t,n,i);case $j.NodeSelection:return function(e){return e.select(jo.getCheckedNodes).pipe(Object(Cp.a)(),Object(Y.a)((function(e){var t=d(e,2);return t[0],t[1].length>0})))}(t)}})(this.trigger,this.store,this.engineService,this.cameraService,n).pipe(Object(Xj.a)(t),Object(_c.a)(this.triggerDelay),Object(X.a)(this.ngUnsubscribe)).subscribe((function(){e.triggerComplete.next()}))}}},{key:"resetCamera",value:function(){var e=this,t=this.store.selectSnapshot(vs.getSelectedChapter);return this.store.dispatch(new zn(t.camera.location,!0)).pipe(Object(vr.a)((function(){return e.actions.pipe(Object(L.j)(Tn))})),Object(Tc.a)(1))}}]),e}()).\u0275fac=function(e){return new(e||nP)(j.Pb(L.g),j.Pb(L.b),j.Pb(Sn),j.Pb(Xn),j.Pb(j.i))},nP.\u0275cmp=j.Jb({type:nP,selectors:[["app-view-tour-slide"]],inputs:{title:"title",image:"image",alt:"alt",spacing:"spacing",shown:"shown",exitEnabled:"exitEnabled",trigger:"trigger",triggerDelay:"triggerDelay"},outputs:{triggerComplete:"triggerComplete"},ngContentSelectors:oP,decls:1,vars:1,consts:[["class","slide",3,"slide--expanded",4,"ngIf"],[1,"slide"],["class","slide__title",4,"ngIf"],[1,"slide__content"],["class","slide__image",3,"src","alt",4,"ngIf"],[1,"slide__footer"],[1,"slide__title"],[1,"slide__image",3,"src","alt"]],template:function(e,t){1&e&&(j.kc(iP),j.Ic(0,tP,7,5,"div",0)),2&e&&j.lc("ngIf",t.shown)},directives:[we.l],styles:[".text-8[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase[_ngcontent-%COMP%]{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase[_ngcontent-%COMP%]{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase[_ngcontent-%COMP%]{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase[_ngcontent-%COMP%]{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-28[_ngcontent-%COMP%]{font-size:28px;letter-spacing:.7px;line-height:1.4em}.text-28.text-uppercase[_ngcontent-%COMP%]{font-size:28px;letter-spacing:1.68px;line-height:1.25em;text-transform:uppercase}.text-header[_ngcontent-%COMP%]{font-weight:700}.text--code[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.text-xlight[_ngcontent-%COMP%]{font-weight:200}.text-light[_ngcontent-%COMP%]{font-weight:300}.text-medium[_ngcontent-%COMP%]{font-weight:500}.text-semibold[_ngcontent-%COMP%]{font-weight:600}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-underline[_ngcontent-%COMP%]{text-decoration:underline}.text-italic[_ngcontent-%COMP%]{font-style:italic}.text-bright[_ngcontent-%COMP%]{color:#fff}.text-dim[_ngcontent-%COMP%]{color:#96a8c0}.text-error[_ngcontent-%COMP%]{color:#ed4758}.text-left[_ngcontent-%COMP%]{text-align:left}.text-center[_ngcontent-%COMP%]{text-align:center}.text-right[_ngcontent-%COMP%]{text-align:right}.text-ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link[_ngcontent-%COMP%], .text-link[_ngcontent-%COMP%]:visited{color:inherit;cursor:pointer}.text-link[_ngcontent-%COMP%]:not(.text-underline), .text-link[_ngcontent-%COMP%]:visited:not(.text-underline){text-decoration:none}.text-success[_ngcontent-%COMP%]{color:#38de38}.text-danger[_ngcontent-%COMP%]{color:#de3535}.text-info[_ngcontent-%COMP%]{color:#2d72dc}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.text-pre-line[_ngcontent-%COMP%]{white-space:pre-line}.slide[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;text-align:center;max-width:500px}.slide__title[_ngcontent-%COMP%]{font-weight:600;font-size:18px;letter-spacing:.45px}.slide__content[_ngcontent-%COMP%], .slide__title[_ngcontent-%COMP%]{margin-bottom:16px;line-height:1.4em}.slide__content[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.5em;max-width:100%}.slide__image[_ngcontent-%COMP%]{margin:24px auto;max-width:100%;min-height:1px}.slide__footer[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em;font-weight:500;display:flex;flex-direction:row;align-items:center;justify-content:center;max-width:100%}.slide--expanded[_ngcontent-%COMP%]   .slide__title[_ngcontent-%COMP%]{margin:16px}.slide--expanded[_ngcontent-%COMP%]   .slide__content[_ngcontent-%COMP%]{margin:48px}.slide--expanded[_ngcontent-%COMP%]   .slide__image[_ngcontent-%COMP%]{margin:48px auto}@media (max-width:768px){.slide[_ngcontent-%COMP%]{max-width:400px}.slide__image[_ngcontent-%COMP%]{margin:16px}.slide__title[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em;margin-bottom:12px}.slide__content[_ngcontent-%COMP%]{margin-bottom:12px}.slide__content[_ngcontent-%COMP%], .slide__footer[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}}@media (max-width:640px){.slide[_ngcontent-%COMP%]{max-width:320px}}@media (max-width:480px){.slide[_ngcontent-%COMP%]{max-width:240px}.slide__title[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px}.slide__content[_ngcontent-%COMP%], .slide__title[_ngcontent-%COMP%]{line-height:1.4em;margin-bottom:8px}.slide__content[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px}.slide__image[_ngcontent-%COMP%]{margin:4px auto}.slide__footer[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}}@media (max-width:320px){.slide[_ngcontent-%COMP%]{max-width:160px}}"],data:{animation:[Object(du.n)("refresh",[Object(du.m)(":enter",[Object(du.o)(ww.slideTransition,{params:{duration:500,from:100,to:0}})])])]},changeDetection:0}),nP);function aP(e,t){1&e&&(j.Vb(0,"div",1),j.Vb(1,"div",2),j.jc(2),j.Ub(),j.Ub())}var sP,cP=["*"],lP=((sP=function(){function e(t){y(this,e),this.changeRef=t,this.selectedSlideIndex=0,this._shown=!1,this.ngUnsubscribe=new Z.a}return v(e,[{key:"shown",get:function(){return this._shown},set:function(e){this._shown=e,this.setSelectedSlide(0)}},{key:"ngOnInit",value:function(){}},{key:"ngAfterViewInit",value:function(){var e=this;this.initListeners(),setTimeout((function(){e.setSlideShown(e.selectedSlideIndex)}))}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"goToPrevSlide",value:function(){this.setSelectedSlide(this.selectedSlideIndex-1)}},{key:"goToNextSlide",value:function(){this.setSelectedSlide(this.selectedSlideIndex+1)}},{key:"setSelectedSlide",value:function(e){if(this.selectedSlideIndex=e,this.slides){var t=Math.max(0,Math.min(this.slides.length-1,e));this.selectedSlideIndex=t}this.setSlideShown(this.selectedSlideIndex)}},{key:"initListeners",value:function(){var e=this;Object(Ca.a).apply(void 0,p(this.slides.map((function(e){return e.triggerComplete.asObservable()})))).pipe(Object(X.a)(this.ngUnsubscribe)).subscribe((function(){e.goToNextSlide()}))}},{key:"setSlideShown",value:function(e){this.slides&&this.slides.forEach((function(t,n){t.shown=n===e})),this.changeRef.markForCheck()}}]),e}()).\u0275fac=function(e){return new(e||sP)(j.Pb(j.i))},sP.\u0275cmp=j.Jb({type:sP,selectors:[["app-view-tour-page"]],contentQueries:function(e,t,n){var i;1&e&&j.Ib(n,rP,!1),2&e&&j.sc(i=j.dc())&&(t.slides=i)},inputs:{shown:"shown"},ngContentSelectors:cP,decls:1,vars:1,consts:[["class","page",4,"ngIf"],[1,"page"],[1,"page__contents"]],template:function(e,t){1&e&&(j.kc(),j.Ic(0,aP,3,0,"div",0)),2&e&&j.lc("ngIf",t.shown)},directives:[we.l],styles:[".text-8[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase[_ngcontent-%COMP%]{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase[_ngcontent-%COMP%]{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase[_ngcontent-%COMP%]{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase[_ngcontent-%COMP%]{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-28[_ngcontent-%COMP%]{font-size:28px;letter-spacing:.7px;line-height:1.4em}.text-28.text-uppercase[_ngcontent-%COMP%]{font-size:28px;letter-spacing:1.68px;line-height:1.25em;text-transform:uppercase}.text-header[_ngcontent-%COMP%]{font-weight:700}.text--code[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.text-xlight[_ngcontent-%COMP%]{font-weight:200}.text-light[_ngcontent-%COMP%]{font-weight:300}.text-medium[_ngcontent-%COMP%]{font-weight:500}.text-semibold[_ngcontent-%COMP%]{font-weight:600}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-underline[_ngcontent-%COMP%]{text-decoration:underline}.text-italic[_ngcontent-%COMP%]{font-style:italic}.text-bright[_ngcontent-%COMP%]{color:#fff}.text-dim[_ngcontent-%COMP%]{color:#96a8c0}.text-error[_ngcontent-%COMP%]{color:#ed4758}.text-left[_ngcontent-%COMP%]{text-align:left}.text-center[_ngcontent-%COMP%]{text-align:center}.text-right[_ngcontent-%COMP%]{text-align:right}.text-ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link[_ngcontent-%COMP%], .text-link[_ngcontent-%COMP%]:visited{color:inherit;cursor:pointer}.text-link[_ngcontent-%COMP%]:not(.text-underline), .text-link[_ngcontent-%COMP%]:visited:not(.text-underline){text-decoration:none}.text-success[_ngcontent-%COMP%]{color:#38de38}.text-danger[_ngcontent-%COMP%]{color:#de3535}.text-info[_ngcontent-%COMP%]{color:#2d72dc}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.text-pre-line[_ngcontent-%COMP%]{white-space:pre-line}.page[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center}.page__contents[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}@media (max-width:768px){.page__contents[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}}@media (max-width:480px){.page__contents[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}}"],changeDetection:0}),sP),pP=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function uP(e,t){if(1&e){var n=j.Wb();j.Vb(0,"div",5),j.Vb(1,"button",6),j.cc("click",(function(){return j.xc(n),j.gc(2).handlePrevClick()})),j.Ub(),j.Vb(2,"div",7),j.Kc(3),j.Ub(),j.Vb(4,"button",8),j.cc("click",(function(){return j.xc(n),j.gc(2).handleNextClick()})),j.Ub(),j.Ub()}if(2&e){var i=j.gc().$implicit;j.Db(1),j.lc("disabled",i.pageIndex<1),j.Eb("aria-disabled",i.pageIndex<1)("tabindex",i.pageIndex<1?-1:0),j.Db(2),j.Nc("",i.pageIndex+1," / ",i.pageSize,""),j.Db(1),j.lc("disabled",i.pageIndex===i.pageSize-1),j.Eb("aria-disabled",i.pageIndex===i.pageSize-1)("tabindex",i.pageIndex===i.pageSize-1?-1:0)}}var dP=function(e){return{"pages--opaquer":e}};function gP(e,t){if(1&e){var n=j.Wb();j.Vb(0,"div",1),j.Vb(1,"button",2),j.cc("click",(function(){return j.xc(n),j.gc().handleExitClick()})),j.Ub(),j.Vb(2,"div",3),j.jc(3),j.Ub(),j.Ic(4,uP,5,8,"div",4),j.Ub()}if(2&e){var i=t.$implicit;j.lc("ngClass",j.nc(2,dP,i.pageIndex==i.pageSize-1)),j.Db(4),j.lc("ngIf",i.pageIndex<i.pageSize-1)}}var hP,fP,bP,mP=["*"],vP=((bP=function(){function e(t,n){y(this,e),this.store=t,this.changeRef=n,this.ngUnsubscribe=new Z.a}return v(e,[{key:"ngOnInit",value:function(){}},{key:"ngAfterViewInit",value:function(){var e=this;this.tutorial$.pipe(Object(X.a)(this.ngUnsubscribe),Object(Y.a)((function(e){return null!=e&&e.pageSize>0}))).subscribe((function(t){e.handleTutorialPages(t)})),this.store.dispatch(new _.SetTutorial({pageSize:this.pages.length,pageIndex:0}))}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"handlePrevClick",value:function(){this.store.dispatch(new _.TutorialPrevious)}},{key:"handleNextClick",value:function(){this.store.dispatch(new _.TutorialNext)}},{key:"handleExitClick",value:function(){this.store.dispatch(new _.ToggleWindow(Ea.Tutorial,!1))}},{key:"handleTutorialPages",value:function(e){this.pages.forEach((function(t,n){t.shown=n===e.pageIndex})),this.changeRef.markForCheck()}}]),e}()).\u0275fac=function(e){return new(e||bP)(j.Pb(L.g),j.Pb(j.i))},bP.\u0275cmp=j.Jb({type:bP,selectors:[["app-view-tour-pages"]],contentQueries:function(e,t,n){var i;1&e&&j.Ib(n,lP,!1),2&e&&j.sc(i=j.dc())&&(t.pages=i)},ngContentSelectors:mP,decls:2,vars:3,consts:[["class","pages",3,"ngClass",4,"ngIf"],[1,"pages",3,"ngClass"],["app-pin-button","","buttonType","dark","size","medium","icon","times","aria-label","Exit Tutorial","matTooltip","Exit Tutorial","matTooltipPosition","right","data-test","tutorialExitButton",1,"pages__close",3,"click"],[1,"pages__contents"],["class","pages__footer",4,"ngIf"],[1,"pages__footer"],["app-pin-button","","buttonType","dark","size","large","icon","angle-left","aria-label","Previous Tutorial Step","matTooltip","Previous Tutorial Step","matTooltipPosition","left","data-test","tutorialPreviousButton",1,"pages__nav",3,"disabled","click"],[1,"mh-8"],["app-pin-button","","buttonType","dark","size","large","icon","angle-right","aria-label","Next Tutorial Step","matTooltip"," Next Tutorial Step","matTooltipPosition","right","data-test","tutorialNextButton",1,"pages__nav",3,"disabled","click"]],template:function(e,t){1&e&&(j.kc(),j.Ic(0,gP,5,4,"div",0),j.hc(1,"async")),2&e&&j.lc("ngIf",j.ic(1,1,t.tutorial$))},directives:[we.l,we.i,Dg,Lg.c],pipes:[we.b],styles:[".text-8[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase[_ngcontent-%COMP%]{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase[_ngcontent-%COMP%]{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase[_ngcontent-%COMP%]{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase[_ngcontent-%COMP%]{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-28[_ngcontent-%COMP%]{font-size:28px;letter-spacing:.7px;line-height:1.4em}.text-28.text-uppercase[_ngcontent-%COMP%]{font-size:28px;letter-spacing:1.68px;line-height:1.25em;text-transform:uppercase}.text-header[_ngcontent-%COMP%]{font-weight:700}.text--code[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.text-xlight[_ngcontent-%COMP%]{font-weight:200}.text-light[_ngcontent-%COMP%]{font-weight:300}.text-medium[_ngcontent-%COMP%]{font-weight:500}.text-semibold[_ngcontent-%COMP%]{font-weight:600}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-underline[_ngcontent-%COMP%]{text-decoration:underline}.text-italic[_ngcontent-%COMP%]{font-style:italic}.text-bright[_ngcontent-%COMP%]{color:#fff}.text-dim[_ngcontent-%COMP%]{color:#96a8c0}.text-error[_ngcontent-%COMP%]{color:#ed4758}.text-left[_ngcontent-%COMP%]{text-align:left}.text-center[_ngcontent-%COMP%]{text-align:center}.text-right[_ngcontent-%COMP%]{text-align:right}.text-ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link[_ngcontent-%COMP%], .text-link[_ngcontent-%COMP%]:visited{color:inherit;cursor:pointer}.text-link[_ngcontent-%COMP%]:not(.text-underline), .text-link[_ngcontent-%COMP%]:visited:not(.text-underline){text-decoration:none}.text-success[_ngcontent-%COMP%]{color:#38de38}.text-danger[_ngcontent-%COMP%]{color:#de3535}.text-info[_ngcontent-%COMP%]{color:#2d72dc}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.text-pre-line[_ngcontent-%COMP%]{white-space:pre-line}.pages[_ngcontent-%COMP%]{pointer-events:none;display:flex;flex-direction:column;align-items:center;justify-content:center;margin:20px auto 48px;max-width:600px;position:relative;background:rgba(16,24,35,.8);border-radius:16px;padding:24px 28px 20px}.pages--opaquer[_ngcontent-%COMP%]{background:rgba(16,24,35,.9)}.pages__footer[_ngcontent-%COMP%]{flex-direction:row;font-size:16px;letter-spacing:.4px;line-height:1.4em;font-weight:500}.pages__close[_ngcontent-%COMP%], .pages__footer[_ngcontent-%COMP%]{display:flex;align-items:center}.pages__close[_ngcontent-%COMP%]{z-index:1;position:absolute;top:8px;right:8px;align-self:flex-end;justify-content:center}.pages__contents[_ngcontent-%COMP%]{padding:16px 0}@media (max-width:768px){.pages[_ngcontent-%COMP%]{margin:16px 12% 48px;border-radius:10px;padding:18px 22px 14px}.pages__contents[_ngcontent-%COMP%]{padding:24px 0}.pages__footer[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.pages__nav[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}}@media (max-width:480px){.pages[_ngcontent-%COMP%]{margin:12px 10% 48px;border-radius:8px;padding:24px 20px 12px}.pages__footer[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.pages__nav[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}}"],changeDetection:0}),function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);r>3&&a&&Object.defineProperty(t,n,a)}([Object(L.d)(hs.getTutorial),pP("design:type",J.a)],bP.prototype,"tutorial$",void 0),bP),yP=((fP=function(){function e(){y(this,e)}return v(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||fP)},fP.\u0275cmp=j.Jb({type:fP,selectors:[["app-view-tour-success"]],inputs:{inline:"inline"},decls:2,vars:2,consts:[[1,"view-tour-success"],["icon","check",1,"view-tour-success__icon"]],template:function(e,t){1&e&&(j.Vb(0,"div",0),j.Qb(1,"app-icon",1),j.Ub()),2&e&&j.Hb("view-tour-success--inline",t.inline)},directives:[vp],styles:[".text-8{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-28{font-size:28px;letter-spacing:.7px;line-height:1.4em}.text-28.text-uppercase{font-size:28px;letter-spacing:1.68px;line-height:1.25em;text-transform:uppercase}.text-header{font-weight:700}.text--code{font-family:Courier New,Courier,monospace}.text-uppercase{text-transform:uppercase}.text-xlight{font-weight:200}.text-light{font-weight:300}.text-medium{font-weight:500}.text-semibold{font-weight:600}.text-bold{font-weight:700}.text-underline{text-decoration:underline}.text-italic{font-style:italic}.text-bright{color:#fff}.text-dim{color:#96a8c0}.text-error{color:#ed4758}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.text-ellipsis{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link,.text-link:visited{color:inherit;cursor:pointer}.text-link:not(.text-underline),.text-link:visited:not(.text-underline){text-decoration:none}.text-success{color:#38de38}.text-danger{color:#de3535}.text-info{color:#2d72dc}.text-nowrap{white-space:nowrap}.text-pre-line{white-space:pre-line}.view-tour-success{width:52px;height:52px;display:flex;background-color:#1bbc66;border-radius:50%;justify-content:center;align-items:center}.view-tour-success__icon{font-size:36px;letter-spacing:.9px;line-height:1.4em;color:#fff}.view-tour-success--inline{display:inline-flex;width:32px;height:32px}.view-tour-success--inline .view-tour-success__icon{font-size:18px;letter-spacing:.45px;line-height:1.4em}@media (max-width:768px){.view-tour-success{width:36px;height:36px}.view-tour-success__icon{font-size:20px;letter-spacing:.5px;line-height:1.4em}.view-tour-success--inline{display:inline-flex;width:24px;height:24px}.view-tour-success--inline .view-tour-success__icon{font-size:12px;letter-spacing:.3px;line-height:1.4em}}"],encapsulation:2,changeDetection:0}),fP),xP=((hP=function(){function e(t){y(this,e),this.viewService=t,this.triggers=$j}return v(e,[{key:"handleStartClick",value:function(){this.viewService.toggleTutorial(!1)}}]),e}()).\u0275fac=function(e){return new(e||hP)(j.Pb(Wp))},hP.\u0275cmp=j.Jb({type:hP,selectors:[["app-view-tour-mobile"]],decls:31,vars:5,consts:[["title","Rotate",3,"trigger"],["title","Zoom",3,"trigger"],["title","Pan",3,"trigger"],["title","Explore the Anatomy",3,"trigger"],[1,"flex","justify-start","items-center"],[1,"mr-2",3,"inline"],[1,"text-semibold"],["title","Toolbar","image","assets/images/tutorial/tutorial-toolbar@3x.png","alt","Toolbars used for navigating content"],["slide-footer","",1,"flex","flex-column","items-center","justify-center"],["app-view-rounded-button","","buttonType","solid","label","Start Exploring!","aria-label","Start Exploring",1,"mt-4",3,"click"]],template:function(e,t){1&e&&(j.Vb(0,"app-view-tour-pages"),j.Vb(1,"app-view-tour-page"),j.Vb(2,"app-view-tour-slide",0),j.Kc(3," Tap and drag with one finger to change the viewing angle. "),j.Ub(),j.Vb(4,"app-view-tour-slide"),j.Qb(5,"app-view-tour-success"),j.Ub(),j.Ub(),j.Vb(6,"app-view-tour-page"),j.Vb(7,"app-view-tour-slide",1),j.Kc(8," Pinch with two fingers to zoom in or out. "),j.Ub(),j.Vb(9,"app-view-tour-slide"),j.Qb(10,"app-view-tour-success"),j.Ub(),j.Ub(),j.Vb(11,"app-view-tour-page"),j.Vb(12,"app-view-tour-slide",2),j.Kc(13," Use two fingers to adjust the model's position. "),j.Ub(),j.Vb(14,"app-view-tour-slide"),j.Qb(15,"app-view-tour-success"),j.Ub(),j.Ub(),j.Vb(16,"app-view-tour-page"),j.Vb(17,"app-view-tour-slide",3),j.Kc(18," Tap on an individual part of the model to highlight anatomy. "),j.Ub(),j.Vb(19,"app-view-tour-slide"),j.Vb(20,"div",4),j.Vb(21,"div"),j.Qb(22,"app-view-tour-success",5),j.Vb(23,"strong",6),j.Kc(24,"Tip:"),j.Ub(),j.Kc(25," Double-tap to zoom in on specific structures. "),j.Ub(),j.Ub(),j.Ub(),j.Ub(),j.Vb(26,"app-view-tour-page"),j.Vb(27,"app-view-tour-slide",7),j.Kc(28," Use the toolbar to navigate through the 3D experience, launch deeper exploration tools, and relaunch this tutorial. "),j.Vb(29,"div",8),j.Vb(30,"button",9),j.cc("click",(function(){return t.handleStartClick()})),j.Ub(),j.Ub(),j.Ub(),j.Ub(),j.Ub()),2&e&&(j.Db(2),j.lc("trigger","camera-rotate"),j.Db(5),j.lc("trigger",t.triggers.CameraZoom),j.Db(5),j.lc("trigger",t.triggers.CameraPan),j.Db(5),j.lc("trigger",t.triggers.NodeSelection),j.Db(5),j.lc("inline",!0))},directives:[vP,lP,rP,yP,qj],styles:[""],changeDetection:0}),hP);function OP(e,t){if(1&e&&j.Qb(0,"app-icon",5),2&e){var n=j.gc(2);j.lc("icon",n.icon)}}function wP(e,t){if(1&e&&(j.Vb(0,"span",6),j.Kc(1),j.Ub()),2&e){var n=j.gc(2);j.Db(1),j.Lc(n.label)}}function kP(e,t){if(1&e&&(j.Tb(0),j.Ic(1,OP,1,1,"app-icon",3),j.Ic(2,wP,2,1,"span",4),j.Sb()),2&e){var n=j.gc();j.Db(1),j.lc("ngIf",n.icon),j.Db(1),j.lc("ngIf",n.icon)}}function CP(e,t){if(1&e&&(j.Vb(0,"span"),j.Kc(1),j.Ub()),2&e){var n=j.gc();j.Db(1),j.Mc(" ",n.label," ")}}var SP,_P=((SP=function(){function e(){y(this,e)}return v(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||SP)},SP.\u0275cmp=j.Jb({type:SP,selectors:[["app-view-tour-tip-button"]],inputs:{label:"label",icon:"icon"},decls:3,vars:2,consts:[[1,"view-tour-tip-button","mv-1","mh-1",3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[3,"icon",4,"ngIf"],["class","visually-hidden",4,"ngIf"],[3,"icon"],[1,"visually-hidden"]],template:function(e,t){1&e&&(j.Vb(0,"div",0),j.Ic(1,kP,3,2,"ng-container",1),j.Ic(2,CP,2,1,"span",2),j.Ub()),2&e&&(j.lc("ngSwitch",!!t.icon),j.Db(1),j.lc("ngSwitchCase",!0))},directives:[we.n,we.o,we.p,we.l,vp],styles:[".view-tour-tip-button{display:inline-flex;align-items:center;justify-content:center;vertical-align:middle;color:#131c2a;background-color:#fff;border-radius:2px;font-weight:700;padding:4px;width:24px;height:24px}@media (max-width:768px){.view-tour-tip-button{width:20px;height:20px}}"],encapsulation:2,changeDetection:0}),SP),jP=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function PP(e,t){1&e&&(j.Tb(0),j.Kc(1," Hold the control key and scroll up and down to zoom in or out. "),j.Sb())}function MP(e,t){1&e&&(j.Tb(0),j.Kc(1," Scroll up and down to zoom in or out. "),j.Sb())}var IP,zP=((IP=function(){function e(t){y(this,e),this.viewService=t,this.triggers=$j}return v(e,[{key:"ngOnInit",value:function(){this.captureScroll$=this.scrollMode$.pipe(Object(se.a)((function(e){return e===Cs.Capture})))}},{key:"handleStartClick",value:function(){this.viewService.toggleTutorial(!1)}}]),e}()).\u0275fac=function(e){return new(e||IP)(j.Pb(Wp))},IP.\u0275cmp=j.Jb({type:IP,selectors:[["app-view-tour-desktop"]],decls:62,vars:12,consts:[["title","Rotate",3,"trigger"],[1,"flex","justify-start","items-center"],[1,"mr-2",3,"inline"],[1,"text-semibold"],["icon","caret-up","label","up"],["icon","caret-down","label","down"],["icon","caret-left","label","left"],["icon","caret-right","label","right"],["title","Zoom",3,"trigger","ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],["label","+"],["label","-"],["title","Pan",3,"trigger"],["label","W"],["label","A"],["label","S"],["label","D"],["title","Explore the Anatomy",3,"trigger"],["image","assets/images/tutorial/tutorial-toolbar@3x.png","alt","Toolbars used for navigating content"],["slide-footer","",1,"flex","flex-column","items-center","justify-center"],["app-view-rounded-button","","buttonType","solid","label","Start Exploring!","aria-label","Start Exploring",1,"mt-4",3,"click"]],template:function(e,t){1&e&&(j.Vb(0,"app-view-tour-pages"),j.Vb(1,"app-view-tour-page"),j.Vb(2,"app-view-tour-slide",0),j.Kc(3," Click and drag the model to change the viewing angle. "),j.Ub(),j.Vb(4,"app-view-tour-slide"),j.Vb(5,"div",1),j.Vb(6,"div"),j.Qb(7,"app-view-tour-success",2),j.Vb(8,"strong",3),j.Kc(9,"Tip:"),j.Ub(),j.Kc(10," You can also use the arrow keys "),j.Qb(11,"app-view-tour-tip-button",4),j.Qb(12,"app-view-tour-tip-button",5),j.Qb(13,"app-view-tour-tip-button",6),j.Qb(14,"app-view-tour-tip-button",7),j.Kc(15," to rotate. "),j.Ub(),j.Ub(),j.Ub(),j.Ub(),j.Vb(16,"app-view-tour-page"),j.Vb(17,"app-view-tour-slide",8),j.hc(18,"async"),j.Ic(19,PP,2,0,"ng-container",9),j.Ic(20,MP,2,0,"ng-container",10),j.Ub(),j.Vb(21,"app-view-tour-slide"),j.Vb(22,"div",1),j.Vb(23,"div"),j.Qb(24,"app-view-tour-success",2),j.Vb(25,"strong",3),j.Kc(26,"Tip:"),j.Ub(),j.Kc(27," You can also use "),j.Qb(28,"app-view-tour-tip-button",11),j.Kc(29," to zoom in and "),j.Qb(30,"app-view-tour-tip-button",12),j.Kc(31," to zoom out. "),j.Ub(),j.Ub(),j.Ub(),j.Ub(),j.Vb(32,"app-view-tour-page"),j.Vb(33,"app-view-tour-slide",13),j.Kc(34," Hold the shift key and drag to move the model's position. "),j.Ub(),j.Vb(35,"app-view-tour-slide"),j.Vb(36,"div",1),j.Vb(37,"div"),j.Qb(38,"app-view-tour-success",2),j.Vb(39,"strong",3),j.Kc(40,"Tip:"),j.Ub(),j.Kc(41," You can also use the "),j.Qb(42,"app-view-tour-tip-button",14),j.Qb(43,"app-view-tour-tip-button",15),j.Qb(44,"app-view-tour-tip-button",16),j.Qb(45,"app-view-tour-tip-button",17),j.Kc(46," keys to pan. "),j.Ub(),j.Ub(),j.Ub(),j.Ub(),j.Vb(47,"app-view-tour-page"),j.Vb(48,"app-view-tour-slide",18),j.Kc(49," Click on an individual part of the model to highlight anatomy. "),j.Ub(),j.Vb(50,"app-view-tour-slide"),j.Vb(51,"div",1),j.Vb(52,"div"),j.Qb(53,"app-view-tour-success",2),j.Vb(54,"strong",3),j.Kc(55,"Tip:"),j.Ub(),j.Kc(56," Double-click to zoom in on specific structures. "),j.Ub(),j.Ub(),j.Ub(),j.Ub(),j.Vb(57,"app-view-tour-page"),j.Vb(58,"app-view-tour-slide",19),j.Kc(59," Use the toolbar to navigate through the 3D experience, launch deeper exploration tools, and relaunch this tutorial. "),j.Vb(60,"div",20),j.Vb(61,"button",21),j.cc("click",(function(){return t.handleStartClick()})),j.Ub(),j.Ub(),j.Ub(),j.Ub(),j.Ub()),2&e&&(j.Db(2),j.lc("trigger",t.triggers.CameraRotate),j.Db(5),j.lc("inline",!0),j.Db(10),j.lc("trigger",t.triggers.CameraZoom)("ngSwitch",j.ic(18,10,t.captureScroll$)),j.Db(2),j.lc("ngSwitchCase",!1),j.Db(5),j.lc("inline",!0),j.Db(9),j.lc("trigger",t.triggers.CameraPan),j.Db(5),j.lc("inline",!0),j.Db(10),j.lc("trigger",t.triggers.NodeSelection),j.Db(5),j.lc("inline",!0))},directives:[vP,lP,rP,yP,_P,we.n,we.o,we.p,qj],pipes:[we.b],styles:[""],changeDetection:0}),function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);r>3&&a&&Object.defineProperty(t,n,a)}([Object(L.d)(zs.getScrollMode),jP("design:type",J.a)],IP.prototype,"scrollMode$",void 0),IP),TP=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},UP=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function DP(e,t){if(1&e){var n=j.Wb();j.Vb(0,"div",3),j.Vb(1,"h2",4),j.Kc(2,"Getting Started"),j.Ub(),j.Vb(3,"p",5),j.Kc(4," Welcome! This tutorial will teach you how to navigate and explore in 3D using your "),j.Qb(5,"button",6),j.hc(6,"async"),j.hc(7,"async"),j.Vb(8,"mat-menu",null,7),j.Vb(10,"button",8),j.cc("click",(function(){j.xc(n);var e=j.gc();return e.handleSelectInputModeClick(e.inputModes.Mouse)})),j.Kc(11),j.Ub(),j.Vb(12,"button",8),j.cc("click",(function(){j.xc(n);var e=j.gc();return e.handleSelectInputModeClick(e.inputModes.Touch)})),j.Kc(13),j.Ub(),j.Ub(),j.Ub(),j.Vb(14,"div",9),j.Vb(15,"button",10),j.cc("click",(function(){return j.xc(n),j.gc().handleExitClick()})),j.Ub(),j.Vb(16,"button",11),j.cc("click",(function(){return j.xc(n),j.gc().handleStartClick()})),j.Ub(),j.Ub(),j.Ub()}if(2&e){var i=j.tc(9),o=j.gc();j.Db(5),j.lc("compact",!0)("label",o.inputModesText[j.ic(6,6,o.inputMode$)])("matMenuTriggerFor",i),j.Eb("aria-label",o.inputModesText[j.ic(7,8,o.inputMode$)]),j.Db(6),j.Mc(" ",o.inputModesText[o.inputModes.Mouse]," "),j.Db(2),j.Mc(" ",o.inputModesText[o.inputModes.Touch]," ")}}function LP(e,t){1&e&&j.Qb(0,"app-view-tour-mobile")}function EP(e,t){1&e&&j.Qb(0,"app-view-tour-desktop")}function FP(e,t){if(1&e&&(j.Vb(0,"div",12),j.hc(1,"async"),j.Ic(2,LP,1,0,"app-view-tour-mobile",13),j.Ic(3,EP,1,0,"app-view-tour-desktop",14),j.Ub()),2&e){var n=j.gc();j.lc("ngSwitch",j.ic(1,2,n.inputMode$)),j.Db(2),j.lc("ngSwitchCase",n.inputModes.Touch)}}var AP,RP=(c(w={},Xa.Mouse,"mouse, trackpad, or keyboard"),c(w,Xa.Touch,"touchscreen"),w),VP=((AP=function(){function e(t,n,i){y(this,e),this.store=t,this.viewService=n,this.storageService=i,this.inputModes=Xa,this.inputModesText=RP,this.tourStarted=!1,this.tourEnded=!1,this.ngUnsubscribe=new Z.a}return v(e,[{key:"ngOnInit",value:function(){this.initListeners(),this.store.dispatch(new _.TutorialSeen(!0))}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"initListeners",value:function(){var e=this;this.tutorial$.pipe(Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){var n=t.pageIndex,i=t.pageSize;e.tourStarted=n>-1,e.tourEnded=n===i-1})),Object(ka.a)(window,"keyup").pipe(Object(Y.a)((function(e){return"Escape"===e.key})),Object(X.a)(this.ngUnsubscribe)).subscribe((function(){e.exit()}))}},{key:"handleExitClick",value:function(){this.exit()}},{key:"handleStartClick",value:function(){this.store.dispatch(new _.StartTutorial(!1))}},{key:"handleSelectInputModeClick",value:function(e){this.store.dispatch(new _.SetInputMode(e))}},{key:"exit",value:function(){this.viewService.toggleTutorial(!1)}}]),e}()).\u0275fac=function(e){return new(e||AP)(j.Pb(L.g),j.Pb(Wp),j.Pb(as))},AP.\u0275cmp=j.Jb({type:AP,selectors:[["app-view-tour"]],decls:3,vars:7,consts:[["role","dialog","aria-label","Getting Started Tutorial","cdkTrapFocus","",1,"tour"],["class","tour__intro",4,"ngIf"],["class","tour__contents",3,"ngSwitch",4,"ngIf"],[1,"tour__intro"],[1,"tour__title"],[1,"tour__welcome"],["app-view-rounded-button","","buttonType","outline","icon","chevron-down","iconPlacement","right",1,"tour__input-selection","text-small",3,"compact","label","matMenuTriggerFor"],["inputSelectionMenu","matMenu"],["mat-menu-item","",3,"click"],[1,"tour__footer"],["app-view-rounded-button","","buttonType","outline","label","No, Thanks.","data-test","tutorialExitButton",1,"mr-3","text-medium",3,"click"],["app-view-rounded-button","","buttonType","solid","label","Start Tutorial","aria-label","Start Tutorial","data-test","tutorialStartButton",1,"ml-3","text-medium",3,"click"],[1,"tour__contents",3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"]],template:function(e,t){1&e&&(j.Vb(0,"div",0),j.Ic(1,DP,17,10,"div",1),j.Ic(2,FP,4,4,"div",2),j.Ub()),2&e&&(j.Hb("tour--started",t.tourStarted)("tour--ended",t.tourEnded),j.lc("@refresh",void 0),j.Db(1),j.lc("ngIf",!t.tourStarted),j.Db(1),j.lc("ngIf",t.tourStarted))},directives:[qp.d,we.l,qj,Ld.d,Ld.a,Ld.b,we.n,we.o,we.p,xP,zP],pipes:[we.b],styles:[".text-8[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase[_ngcontent-%COMP%]{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase[_ngcontent-%COMP%]{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase[_ngcontent-%COMP%]{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase[_ngcontent-%COMP%]{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-28[_ngcontent-%COMP%]{font-size:28px;letter-spacing:.7px;line-height:1.4em}.text-28.text-uppercase[_ngcontent-%COMP%]{font-size:28px;letter-spacing:1.68px;line-height:1.25em;text-transform:uppercase}.text-header[_ngcontent-%COMP%]{font-weight:700}.text--code[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.text-xlight[_ngcontent-%COMP%]{font-weight:200}.text-light[_ngcontent-%COMP%]{font-weight:300}.text-medium[_ngcontent-%COMP%]{font-weight:500}.text-semibold[_ngcontent-%COMP%]{font-weight:600}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-underline[_ngcontent-%COMP%]{text-decoration:underline}.text-italic[_ngcontent-%COMP%]{font-style:italic}.text-bright[_ngcontent-%COMP%]{color:#fff}.text-dim[_ngcontent-%COMP%]{color:#96a8c0}.text-error[_ngcontent-%COMP%]{color:#ed4758}.text-left[_ngcontent-%COMP%]{text-align:left}.text-center[_ngcontent-%COMP%]{text-align:center}.text-right[_ngcontent-%COMP%]{text-align:right}.text-ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link[_ngcontent-%COMP%], .text-link[_ngcontent-%COMP%]:visited{color:inherit;cursor:pointer}.text-link[_ngcontent-%COMP%]:not(.text-underline), .text-link[_ngcontent-%COMP%]:visited:not(.text-underline){text-decoration:none}.text-success[_ngcontent-%COMP%]{color:#38de38}.text-danger[_ngcontent-%COMP%]{color:#de3535}.text-info[_ngcontent-%COMP%]{color:#2d72dc}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.text-pre-line[_ngcontent-%COMP%]{white-space:pre-line}.tour[_ngcontent-%COMP%]{color:#fff;position:absolute;top:0;right:0;bottom:0;left:0;z-index:100;pointer-events:none;display:flex;flex-direction:column;align-items:center;overflow:auto}.tour__title[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.tour__welcome[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em;margin:16px auto 32px}.tour__intro[_ngcontent-%COMP%]{background:rgba(16,24,35,.9);border-radius:16px;margin:auto;padding:28px 32px;text-align:center;max-width:560px}.tour__input-selection[_ngcontent-%COMP%]{vertical-align:middle}.tour__header[_ngcontent-%COMP%]{flex:none;align-self:flex-end;justify-self:flex-start;margin:24px}.tour__contents[_ngcontent-%COMP%]{flex:auto;display:flex;flex-direction:column;justify-content:flex-end;width:100%}.tour__footer[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em;display:flex;flex-direction:row;align-items:center;justify-content:center}.tour__nav-arrow[_ngcontent-%COMP%]{font-size:32px;letter-spacing:.8px;line-height:1.4em;cursor:pointer}.tour--ended[_ngcontent-%COMP%]   .tour__contents[_ngcontent-%COMP%]{justify-content:center}@media (max-width:768px){.tour__intro[_ngcontent-%COMP%]{border-radius:12px;padding:20px 24px;margin:auto 12%;max-width:100%}.tour__intro__title[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.tour__intro__content[_ngcontent-%COMP%]{max-width:80%}.tour__header[_ngcontent-%COMP%], .tour__intro__content[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.tour__header[_ngcontent-%COMP%]{margin:12px}.tour__footer[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.tour__nav-arrow[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}}@media (max-width:480px){.tour__intro[_ngcontent-%COMP%]{border-radius:8px;padding:16px 20px;margin:auto 10%}.tour__intro__title[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.tour__intro__content[_ngcontent-%COMP%]{margin:12px auto 16px}.tour__header[_ngcontent-%COMP%], .tour__intro__content[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.tour__header[_ngcontent-%COMP%]{margin:12px}.tour__footer[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.tour__nav-arrow[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}}"],data:{animation:[Object(du.n)("refresh",[Object(du.m)(":enter",[Object(du.o)(ww.slideTransition,{params:{duration:500,from:100,to:0}})])])]},changeDetection:0}),TP([Object(L.d)(hs.getTutorial),UP("design:type",J.a)],AP.prototype,"tutorial$",void 0),TP([Object(L.d)(hs.getInputMode),UP("design:type",J.a)],AP.prototype,"inputMode$",void 0),AP),NP=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},BP=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},HP=["colorBtn"];function QP(e,t){1&e&&(j.Vb(0,"div"),j.Qb(1,"app-icon",19),j.Vb(2,"span",20),j.Kc(3,"current"),j.Ub(),j.Ub())}function qP(e,t){if(1&e){var n=j.Wb();j.Vb(0,"button",14),j.cc("click",(function(){j.xc(n);var e=t.$implicit;return j.gc().setTextSize(e.size)})),j.Vb(1,"div",15),j.Vb(2,"div",16),j.Ic(3,QP,4,0,"div",17),j.hc(4,"async"),j.Ub(),j.Vb(5,"div",18),j.Vb(6,"span"),j.Kc(7),j.Ub(),j.Ub(),j.Ub(),j.Ub()}if(2&e){var i=t.$implicit,o=j.gc();j.Db(3),j.lc("ngIf",i.size===j.ic(4,2,o.textSize$)),j.Db(4),j.Mc("",i.label,"px")}}function $P(e,t){1&e&&(j.Vb(0,"div"),j.Qb(1,"app-icon",19),j.Vb(2,"span",20),j.Kc(3,"current"),j.Ub(),j.Ub())}function WP(e,t){if(1&e){var n=j.Wb();j.Vb(0,"button",14),j.cc("click",(function(){j.xc(n);var e=t.$implicit;return j.gc().setBrushSize(e.size)})),j.Vb(1,"div",15),j.Vb(2,"div",16),j.Ic(3,$P,4,0,"div",17),j.hc(4,"async"),j.Ub(),j.Vb(5,"div",18),j.Qb(6,"app-icon",21),j.Vb(7,"span"),j.Kc(8),j.Ub(),j.Ub(),j.Ub(),j.Ub()}if(2&e){var i=t.$implicit,o=j.gc();j.Db(3),j.lc("ngIf",i.size===j.ic(4,4,o.brushSize$)),j.Db(3),j.Fc("font-size",i.size,"px"),j.Db(2),j.Lc(i.label)}}function KP(e,t){1&e&&(j.Vb(0,"div"),j.Qb(1,"app-icon",19),j.Vb(2,"span",20),j.Kc(3,"current"),j.Ub(),j.Ub())}function GP(e,t){if(1&e){var n=j.Wb();j.Vb(0,"button",14),j.cc("click",(function(){j.xc(n);var e=t.$implicit;return j.gc().setEraserSize(e.size)})),j.Vb(1,"div",15),j.Vb(2,"div",16),j.Ic(3,KP,4,0,"div",17),j.hc(4,"async"),j.Ub(),j.Vb(5,"div",18),j.Qb(6,"app-icon",21),j.Vb(7,"span"),j.Kc(8),j.Ub(),j.Ub(),j.Ub(),j.Ub()}if(2&e){var i=t.$implicit,o=j.gc();j.Db(3),j.lc("ngIf",i.size===j.ic(4,4,o.eraserSize$)),j.Db(3),j.Fc("font-size",i.size,"px"),j.Db(2),j.Lc(i.label)}}function ZP(e,t){1&e&&(j.Vb(0,"div"),j.Qb(1,"app-icon",19),j.Vb(2,"span",20),j.Kc(3,"current"),j.Ub(),j.Ub())}function JP(e,t){if(1&e){var n=j.Wb();j.Vb(0,"button",14),j.cc("click",(function(){j.xc(n);var e=t.$implicit;return j.gc().setBrushColor(e.color)})),j.Vb(1,"div",15),j.Vb(2,"div",16),j.Ic(3,ZP,4,0,"div",17),j.hc(4,"async"),j.Ub(),j.Vb(5,"div",18),j.Qb(6,"span",22),j.Vb(7,"span"),j.Kc(8),j.Ub(),j.Ub(),j.Ub(),j.Ub()}if(2&e){var i=t.$implicit,o=j.gc();j.Db(3),j.lc("ngIf",i.color===j.ic(4,4,o.brushColor$)),j.Db(3),j.Fc("background-color",i.color),j.Db(2),j.Lc(i.label)}}var XP,YP=((XP=function(){function e(t){y(this,e),this.store=t,this.textSizes=Na,this.brushSizes=Va,this.brushColors=qa,this.eraserSizes=Ba,this.modeEnum=Fa,this.downloadClick=new j.p,this.clearClick=new j.p,this.exitClick=new j.p,this.ngUnsubscribe=new Z.a}return v(e,[{key:"ngOnInit",value:function(){}},{key:"ngAfterViewInit",value:function(){var e=this;this.brushColor$.pipe(Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){e.colorBtn.nativeElement.style.setProperty("--pin-button-pin-color",t)})),this.hasPaint$.pipe(Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){t||e.store.selectSnapshot(hs.getWhiteboardAnnotateMode)!==Fa.Erase||e.handleModeSelect(Fa.Paint)}))}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"setBrushSize",value:function(e){this.store.dispatch(new _.SetWhiteboardBrushSize(e))}},{key:"setBrushColor",value:function(e){this.store.dispatch(new _.SetWhiteboardBrushColor(e))}},{key:"setTextSize",value:function(e){this.store.dispatch(new _.SetWhiteboardTextSize(e))}},{key:"handleModeSelect",value:function(e){this.store.dispatch(new _.SetWhiteboardAnnotateMode(e))}},{key:"setEraserSize",value:function(e){this.store.dispatch(new _.SetWhiteboardEraserSize(e))}},{key:"handleDownloadClick",value:function(){this.downloadClick.next()}},{key:"handleClearClick",value:function(){this.clearClick.next()}},{key:"handleExitClick",value:function(){this.exitClick.next()}}]),e}()).\u0275fac=function(e){return new(e||XP)(j.Pb(L.g))},XP.\u0275cmp=j.Jb({type:XP,selectors:[["app-view-whiteboard-tools"]],viewQuery:function(e,t){var n;1&e&&j.Ec(HP,!0,j.m),2&e&&j.sc(n=j.dc())&&(t.colorBtn=n.first)},outputs:{downloadClick:"downloadClick",clearClick:"clearClick",exitClick:"exitClick"},decls:39,vars:52,consts:[[1,"view-whiteboard-tools"],["eventCategory","View Whiteboard Tools","name","Whiteboard","padding","dense",3,"canExit","exit"],["app-pin-button","","buttonType","ghost","icon","text-size","aria-label","Text","matTooltip","Text",1,"mr-1",3,"matMenuTriggerFor","selected","click"],["app-pin-button","","buttonType","ghost","icon","paint-brush","aria-label","Brush","matTooltip","Brush",1,"mr-1",3,"matMenuTriggerFor","selected","click"],["app-pin-button","","buttonType","ghost","icon","eraser","aria-label","Eraser","matTooltip","Eraser",3,"matMenuTriggerFor","selected","disabled","click"],["app-pin-button","","buttonType","ghost","icon","tint","aria-label","Color","matTooltip","Color",3,"matMenuTriggerFor","selected"],["colorBtn","matMenuTrigger"],["app-pin-button","","buttonType","ghost","icon","download","aria-label","Download","matTooltip","Download",3,"click"],["app-pin-button","","buttonType","ghost","aria-label","Clear","matTooltip","Clear",3,"disabled","click"],["textSizeMenu","matMenu"],["mat-menu-item","",3,"click",4,"ngFor","ngForOf"],["brushSizeMenu","matMenu"],["eraserSizeMenu","matMenu"],["brushColorMenu","matMenu"],["mat-menu-item","",3,"click"],[1,"flex","flex-row","items-center","justify-end"],[1,"view-whiteboard-tools__check"],[4,"ngIf"],[1,"view-whiteboard-tools__label"],["icon","check","aria-hidden","true",1,"mr-2"],[1,"visually-hidden"],["icon","circle","aria-hidden","true",1,"mr-2"],[1,"view-whiteboard-tools__swatch"]],template:function(e,t){if(1&e&&(j.Vb(0,"div",0),j.Vb(1,"app-pillbox",1),j.cc("exit",(function(){return t.handleExitClick()})),j.Vb(2,"button",2),j.cc("click",(function(){return t.handleModeSelect(t.modeEnum.Text)})),j.hc(3,"async"),j.hc(4,"async"),j.Ub(),j.Vb(5,"button",3),j.cc("click",(function(){return t.handleModeSelect(t.modeEnum.Paint)})),j.hc(6,"async"),j.hc(7,"async"),j.hc(8,"async"),j.Ub(),j.Vb(9,"button",4),j.cc("click",(function(){return t.handleModeSelect(t.modeEnum.Erase)})),j.hc(10,"async"),j.hc(11,"async"),j.hc(12,"async"),j.hc(13,"async"),j.hc(14,"async"),j.Ub(),j.Qb(15,"app-pillbox-divider"),j.Qb(16,"button",5,6),j.Qb(18,"app-pillbox-divider"),j.Vb(19,"button",7),j.cc("click",(function(){return t.handleDownloadClick()})),j.Ub(),j.Qb(20,"app-pillbox-divider"),j.Vb(21,"button",8),j.cc("click",(function(){return t.handleClearClick()})),j.hc(22,"async"),j.hc(23,"async"),j.hc(24,"async"),j.hc(25,"async"),j.Kc(26," Clear "),j.Ub(),j.Vb(27,"mat-menu",null,9),j.Ic(29,qP,8,4,"button",10),j.Ub(),j.Vb(30,"mat-menu",null,11),j.Ic(32,WP,9,6,"button",10),j.Ub(),j.Vb(33,"mat-menu",null,12),j.Ic(35,GP,9,6,"button",10),j.Ub(),j.Vb(36,"mat-menu",null,13),j.Ic(38,JP,9,6,"button",10),j.Ub(),j.Ub(),j.Ub()),2&e){var n=j.tc(17),i=j.tc(28),o=j.tc(31),r=j.tc(34),a=j.tc(37);j.Db(1),j.lc("canExit",!0),j.Db(1),j.lc("matMenuTriggerFor",i)("selected",j.ic(3,24,t.mode$)===t.modeEnum.Text),j.Eb("aria-pressed",j.ic(4,26,t.mode$)===t.modeEnum.Text),j.Db(3),j.lc("matMenuTriggerFor",o)("selected",j.ic(6,28,t.mode$)===t.modeEnum.Paint),j.Eb("aria-selected",j.ic(7,30,t.mode$)===t.modeEnum.Paint)("aria-pressed",j.ic(8,32,t.mode$)===t.modeEnum.Paint),j.Db(4),j.lc("matMenuTriggerFor",r)("selected",j.ic(10,34,t.mode$)===t.modeEnum.Erase)("disabled",!1===j.ic(13,40,t.hasPaint$)),j.Eb("aria-selected",j.ic(11,36,t.mode$)===t.modeEnum.Erase)("aria-pressed",j.ic(12,38,t.mode$)===t.modeEnum.Erase)("aria-disabled",!1===j.ic(14,42,t.hasPaint$)),j.Db(7),j.lc("matMenuTriggerFor",a)("selected",n.menuOpen),j.Eb("aria-selected",n.menuOpen)("aria-pressed",n.menuOpen),j.Db(5),j.lc("disabled",!1===j.ic(22,44,t.hasPaint$)&&!1===j.ic(23,46,t.hasText$)),j.Eb("aria-disabled",!1===j.ic(24,48,t.hasPaint$)&&!1===j.ic(25,50,t.hasText$)),j.Db(8),j.lc("ngForOf",t.textSizes),j.Db(3),j.lc("ngForOf",t.brushSizes),j.Db(3),j.lc("ngForOf",t.eraserSizes),j.Db(3),j.lc("ngForOf",t.brushColors)}},directives:[yC,Dg,Lg.c,Ld.d,hC,Ld.a,we.k,Ld.b,we.l,vp],pipes:[we.b],styles:[".view-whiteboard-tools__check{flex:2 1 0;color:#2d72dc}.view-whiteboard-tools__label{display:flex;flex:6 1 0;align-items:center}.view-whiteboard-tools__swatch{display:inline-block;width:14px;height:14px;border-radius:50%;margin-right:8px;box-shadow:0 0 0 1px #96a8c0}"],encapsulation:2,changeDetection:0}),NP([Object(L.d)(hs.getWhiteboardAnnotateMode),BP("design:type",J.a)],XP.prototype,"mode$",void 0),NP([Object(L.d)(hs.getWhiteboardBrushSize),BP("design:type",J.a)],XP.prototype,"brushSize$",void 0),NP([Object(L.d)(hs.getWhiteboardTextSize),BP("design:type",J.a)],XP.prototype,"textSize$",void 0),NP([Object(L.d)(hs.getWhiteboardBrushColor),BP("design:type",J.a)],XP.prototype,"brushColor$",void 0),NP([Object(L.d)(hs.getWhiteboardEraserSize),BP("design:type",J.a)],XP.prototype,"eraserSize$",void 0),NP([Object(L.d)(hs.getWhiteboardHasPaint),BP("design:type",J.a)],XP.prototype,"hasPaint$",void 0),NP([Object(L.d)(hs.getWhiteboardHasText),BP("design:type",J.a)],XP.prototype,"hasText$",void 0),XP),eM=["textRef"];function tM(e,t){if(1&e){var n=j.Wb();j.Vb(0,"div"),j.Vb(1,"div",4),j.cc("cdkDragMoved",(function(e){return j.xc(n),j.gc().dragMoved(e,"corner1")})),j.Ub(),j.Vb(2,"div",5),j.cc("cdkDragMoved",(function(e){return j.xc(n),j.gc().dragMoved(e,"corner2")})),j.Ub(),j.Vb(3,"div",6),j.cc("cdkDragMoved",(function(e){return j.xc(n),j.gc().dragMoved(e,"corner3")})),j.Ub(),j.Vb(4,"div",7),j.cc("cdkDragMoved",(function(e){return j.xc(n),j.gc().dragMoved(e,"corner4")})),j.Ub(),j.Vb(5,"div",8),j.cc("cdkDragMoved",(function(e){return j.xc(n),j.gc().translateHandleMoved(e)})),j.Ub(),j.Ub()}if(2&e){var i=j.gc();j.Db(1),j.lc("cdkDragFreeDragPosition",i.dragHandles.corner1),j.Db(1),j.lc("cdkDragFreeDragPosition",i.dragHandles.corner2),j.Db(1),j.lc("cdkDragFreeDragPosition",i.dragHandles.corner3),j.Db(1),j.lc("cdkDragFreeDragPosition",i.dragHandles.corner4),j.Db(1),j.lc("cdkDragFreeDragPosition",i.dragHandles.translate)}}var nM,iM=function(e){return{"whiteboard-label__label--active":e}},oM=((nM=function(){function e(t,n){var i=this;y(this,e),this.changeDetectorRef=t,this.renderer=n,this.active=!0,this.initialized=!1,this.labelActive=new j.p,this.labelEmpty=new j.p,this.dragHandles={translate:{x:0,y:0},corner1:{x:0,y:0},corner2:{x:0,y:0},corner3:{x:0,y:0},corner4:{x:0,y:0}},this.handleCoords={translate:{x:0,y:0},corner1:{x:0,y:0},corner2:{x:0,y:0},corner3:{x:0,y:0},corner4:{x:0,y:0}},this.textareaTransform={x:0,y:0,width:110,height:40},this.handleDocumentBackspace=function(e){var t=i.textRef.nativeElement.activeElement;"Backspace"===e.key&&i.active&&!t&&i.deleteLabel()},this.handleTextboxMouseDown=function(e){i.active=!0,i.labelActive.next(i.id),i.refreshHandles()},this.handleDocumentMouseDown=function(e){var t=e.target.className.includes("view-whiteboard__canvas"),n=e.target.className.includes("whiteboard-label__label"),o=e.target.dataset.id===i.id;i.isLabelEmpty()&&!o&&i.initialized?i.deleteLabel():(t||n&&!o)&&(i.active=!1,i.changeDetectorRef.markForCheck())},this.handleTextKeyDown=function(e){if(e.stopPropagation(),i.isLabelEmpty()&&"Backspace"===e.key)i.deleteLabel();else{var t=i.textRef.nativeElement.scrollHeight,n=i.handleCoords,o=n.corner1,r=n.corner3,a=n.corner4,s=o.y+t;i.handleCoords.corner3=Object.assign(Object.assign({},r),{y:s}),i.handleCoords.corner4=Object.assign(Object.assign({},a),{y:s}),i.dragHandles.corner3=Object.assign({},i.handleCoords.corner3),i.dragHandles.corner4=Object.assign({},i.handleCoords.corner4),i.updateTextarea(),i.changeDetectorRef.markForCheck()}}}return v(e,[{key:"id",get:function(){return this._id},set:function(e){this._id=e,this.initialized=!1}},{key:"color",set:function(e){this.renderer.setStyle(this.textRef.nativeElement,"color",e)}},{key:"exporting",set:function(e){e&&(this.active=!1,this.labelActive.next(void 0))}},{key:"size",set:function(e){this.renderer.setStyle(this.textRef.nativeElement,"font-size",e+"px")}},{key:"ngOnInit",value:function(){var e=this;this.initHandles(),this.initInteractionListeners(),setTimeout((function(){e.textRef.nativeElement.focus(),e.initialized=!0}))}},{key:"ngOnDestroy",value:function(){this.textRef.nativeElement.removeEventListener("keydown",this.handleTextKeyDown),this.textRef.nativeElement.removeEventListener("mousedown",this.handleTextboxMouseDown),this.mouseDownListener(),this.backspaceListener()}},{key:"initHandles",value:function(){this.textareaTransform.x=this.initialPos.x,this.textareaTransform.y=this.initialPos.y;var e=this.textareaTransform,t=e.x,n=e.y,i=e.width,o=e.height;this.dragHandles.corner1={x:t,y:n},this.dragHandles.corner2={x:t+i,y:n},this.dragHandles.corner3={x:t+i,y:n+o},this.dragHandles.corner4={x:t,y:n+o},this.dragHandles.translate={x:t+i/2,y:n+-10},this.handleCoords.corner1=Object.assign({},this.dragHandles.corner1),this.handleCoords.corner2=Object.assign({},this.dragHandles.corner2),this.handleCoords.corner3=Object.assign({},this.dragHandles.corner3),this.handleCoords.corner4=Object.assign({},this.dragHandles.corner4),this.handleCoords.translate=Object.assign({},this.dragHandles.translate),this.updateTextarea()}},{key:"initInteractionListeners",value:function(){this.mouseDownListener=this.renderer.listen("document","mousedown",this.handleDocumentMouseDown),this.backspaceListener=this.renderer.listen("document","keydown",this.handleDocumentBackspace),this.textRef.nativeElement.addEventListener("mousedown",this.handleTextboxMouseDown),this.textRef.nativeElement.addEventListener("keydown",this.handleTextKeyDown)}},{key:"refreshHandles",value:function(){this.dragHandles.corner1=Object.assign({},this.handleCoords.corner1),this.dragHandles.corner2=Object.assign({},this.handleCoords.corner2),this.dragHandles.corner3=Object.assign({},this.handleCoords.corner3),this.dragHandles.corner4=Object.assign({},this.handleCoords.corner4),this.dragHandles.translate=Object.assign({},this.handleCoords.translate),this.changeDetectorRef.markForCheck()}},{key:"isLabelEmpty",value:function(){return""===this.textRef.nativeElement.innerText||"\n"===this.textRef.nativeElement.innerText}},{key:"deleteLabel",value:function(){this.labelEmpty.next(this.id)}},{key:"updateTextarea",value:function(){var e=this.handleCoords,t=e.corner1,n=e.corner2,i=e.corner3;this.textareaTransform.x=t.x,this.textareaTransform.y=t.y,this.textareaTransform.width=n.x-t.x,this.textareaTransform.height=i.y-n.y,this.renderer.setStyle(this.textRef.nativeElement,"transform","translate(".concat(this.textareaTransform.x,"px, ").concat(this.textareaTransform.y,"px)")),this.renderer.setStyle(this.textRef.nativeElement,"width",this.textareaTransform.width+"px"),this.renderer.setStyle(this.textRef.nativeElement,"height",this.textareaTransform.height+"px")}},{key:"updateTranslateHandle",value:function(){var e=this.handleCoords,t=e.corner1,n=e.corner2;this.handleCoords.translate={x:(n.x-t.x)/2+t.x,y:t.y+-10},this.dragHandles.translate=Object.assign({},this.handleCoords.translate)}},{key:"setHandle",value:function(e,t,n){this.handleCoords[e]=Object.assign(Object.assign({},this.handleCoords[e]),c({},t,n[t])),this.dragHandles[e]=Object.assign({},this.handleCoords[e])}},{key:"addDiffToHandle",value:function(e,t){this.handleCoords[e]={x:this.handleCoords[e].x+t.x,y:this.handleCoords[e].y+t.y},this.dragHandles[e]=Object.assign({},this.handleCoords[e])}},{key:"translateHandleMoved",value:function(e){var t=e.source._dragRef.getFreeDragPosition(),n={x:t.x-this.handleCoords.translate.x,y:t.y-this.handleCoords.translate.y};this.handleCoords.translate=Object.assign({},t),this.addDiffToHandle("corner1",n),this.addDiffToHandle("corner2",n),this.addDiffToHandle("corner3",n),this.addDiffToHandle("corner4",n),this.updateTextarea()}},{key:"dragMoved",value:function(e,t){var n=e.source._dragRef.getFreeDragPosition();this.handleCoords[t]=Object.assign({},n),"corner1"===t&&(this.setHandle("corner2","y",n),this.setHandle("corner4","x",n)),"corner2"===t&&(this.setHandle("corner1","y",n),this.setHandle("corner3","x",n)),"corner3"===t&&(this.setHandle("corner2","x",n),this.setHandle("corner4","y",n)),"corner4"===t&&(this.setHandle("corner1","x",n),this.setHandle("corner3","y",n)),this.updateTranslateHandle(),this.updateTextarea()}}]),e}()).\u0275fac=function(e){return new(e||nM)(j.Pb(j.i),j.Pb(j.H))},nM.\u0275cmp=j.Jb({type:nM,selectors:[["app-view-whiteboard-label"]],viewQuery:function(e,t){var n;1&e&&j.Ec(eM,!0),2&e&&j.sc(n=j.dc())&&(t.textRef=n.first)},inputs:{id:"id",initialPos:"initialPos",color:"color",exporting:"exporting",size:"size"},outputs:{labelActive:"labelActive",labelEmpty:"labelEmpty"},decls:4,vars:5,consts:[[1,"whiteboard-label"],[4,"ngIf"],["contenteditable","true","data-placeholder","Type..",1,"whiteboard-label__label",3,"ngClass"],["textRef",""],["cdkDrag","",1,"whiteboard-label__handle","whiteboard-label__handle--top-left",3,"cdkDragFreeDragPosition","cdkDragMoved"],["cdkDrag","",1,"whiteboard-label__handle","whiteboard-label__handle--top-right",3,"cdkDragFreeDragPosition","cdkDragMoved"],["cdkDrag","",1,"whiteboard-label__handle","whiteboard-label__handle--bottom-right",3,"cdkDragFreeDragPosition","cdkDragMoved"],["cdkDrag","",1,"whiteboard-label__handle","whiteboard-label__handle--bottom-left",3,"cdkDragFreeDragPosition","cdkDragMoved"],["cdkDrag","",1,"whiteboard-label__handle","whiteboard-label__handle--move",3,"cdkDragFreeDragPosition","cdkDragMoved"]],template:function(e,t){1&e&&(j.Vb(0,"div",0),j.Ic(1,tM,6,5,"div",1),j.Qb(2,"div",2,3),j.Ub()),2&e&&(j.Db(1),j.lc("ngIf",!0===t.active),j.Db(1),j.lc("ngClass",j.nc(3,iM,!0===t.active)),j.Eb("data-id",t.id))},directives:[we.l,we.i,fa.a],styles:['.whiteboard-label[_ngcontent-%COMP%]{position:relative;z-index:1000}.whiteboard-label__handle[_ngcontent-%COMP%]{position:fixed;z-index:10;width:32px;height:32px;left:-16px;top:-16px}.whiteboard-label__handle[_ngcontent-%COMP%]:after{content:"";position:absolute;width:12px;height:12px;left:10px;top:10px;border-radius:50%;background-color:#2d72dc}.whiteboard-label__handle[_ngcontent-%COMP%]:hover{cursor:pointer}.whiteboard-label__handle--top-left[_ngcontent-%COMP%]:hover{cursor:nw-resize}.whiteboard-label__handle--top-right[_ngcontent-%COMP%]:hover{cursor:ne-resize}.whiteboard-label__handle--bottom-right[_ngcontent-%COMP%]:hover{cursor:se-resize}.whiteboard-label__handle--bottom-left[_ngcontent-%COMP%]:hover{cursor:sw-resize}.whiteboard-label__handle--move[_ngcontent-%COMP%]:hover{cursor:move}.whiteboard-label__label[_ngcontent-%COMP%]{box-sizing:border-box;position:absolute;border:none;padding:5px;overflow-y:hidden}.whiteboard-label__label--active[_ngcontent-%COMP%]{box-shadow:inset 0 0 0 1px #2d72dc}.whiteboard-label__label[_ngcontent-%COMP%]:focus{outline:none}.whiteboard-label__label[_ngcontent-%COMP%]:empty:before{content:attr(data-placeholder);color:rgba(55,74,104,.5)}'],changeDetection:0}),nM),rM=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},aM=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},sM=["drawCanvas"],cM=["annotateWrapper"];function lM(e,t){if(1&e){var n=j.Wb();j.Vb(0,"app-view-whiteboard-label",7),j.cc("labelActive",(function(e){return j.xc(n),j.gc().handleLabelActive(e)}))("labelEmpty",(function(e){return j.xc(n),j.gc().handleLabelEmpty(e)})),j.hc(1,"async"),j.Ub()}if(2&e){var i=t.$implicit,o=j.gc();j.Hb("view-whiteboard__label--clickthrough",j.ic(1,7,o.annotateMode$)!==o.whiteboardAnnotateMode.Text),j.lc("exporting",o.exporting)("id",i.id)("initialPos",i.pos)("color",i.color)("size",i.size)}}var pM,uM,dM=cr.PNG,gM=((pM=function(){function e(t,n,i,o,r){y(this,e),this.store=t,this.actions=n,this.viewService=i,this.clipboardService=o,this.changeRef=r,this.whiteboardAnnotateMode=Fa,this.labels=[],this.exporting=!1,this.brushSize=0,this.eraserSize=0,this.lineWidth=0,this.ngUnsubscribe=new Z.a}return v(e,[{key:"initTextModeListener",value:function(){var e=this;this.inputManager=new Hammer.Manager(this.drawCanvas.nativeElement),this.inputManager.add(new Hammer.Tap({event:"tap"})),this.inputManager.on("tap",(function(t){if(e.activeLabelId)e.activeLabelId=void 0;else{var n=Object(ie.uniqueId)(),i=t.center.x,o=t.center.y;void 0!==t.pointers[0].x&&(i=t.pointers[0].x,o=t.pointers[0].y);var r=e.store.selectSnapshot(hs.getWhiteboardBrushColor),a=e.store.selectSnapshot(hs.getWhiteboardTextSize);e.labels.push({id:n,pos:{x:i,y:o},color:r,size:a}),e.activeLabelId=n,e.changeRef.markForCheck(),e.dispatchHasText()}}))}},{key:"handleLabelActive",value:function(e){this.activeLabelId=e;var t=this.labels.find((function(t){return t.id===e}));t&&this.store.dispatch([new _.SetWhiteboardTextSize(t.size),new _.SetWhiteboardBrushColor(t.color)])}},{key:"handleLabelEmpty",value:function(e){this.labels=this.labels.filter((function(t){return t.id!==e})),this.changeRef.markForCheck(),this.dispatchHasText()}},{key:"dispatchHasText",value:function(){this.store.dispatch(new _.SetWhiteboardHasText(this.labels.length>0))}},{key:"ngOnInit",value:function(){var e=this;this.canvasElement=this.drawCanvas.nativeElement,this.canvasContext=this.canvasElement.getContext("2d"),this.siteHeader=this.store.selectSnapshot(fp.getSiteHeader),this.store.dispatch(new rp.SetHeader(up.Hide)),this.brushColor$.pipe(Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){var n=e.labels.find((function(t){return t.id===e.activeLabelId}));n&&(n.color=t,e.changeRef.markForCheck())})),this.textSize$.pipe(Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){var n=e.labels.find((function(t){return t.id===e.activeLabelId}));n&&(n.size=t,e.changeRef.markForCheck())})),this.annotateMode$.pipe(Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){e.inputManager&&e.inputManager.destroy(),t===Fa.Paint?(e.canvasContext.globalCompositeOperation="source-over",e.setLineWidth(e.brushSize),e.initInputListeners()):t===Fa.Text?e.initTextModeListener():t===Fa.Erase&&(e.canvasContext.globalCompositeOperation="destination-out",e.setLineWidth(e.eraserSize),e.initInputListeners())})),this.background$.pipe(Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){var n=Ki.isLight(t)?Za:Ja;e.store.dispatch(new _.SetWhiteboardBrushColor(n.color))}))}},{key:"ngAfterViewInit",value:function(){this.initCanvasListeners()}},{key:"ngOnDestroy",value:function(){this.inputManager.destroy(),this.reset(),this.store.dispatch(new rp.SetHeader(this.siteHeader)),this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"initCanvasListeners",value:function(){var e=this;this.brushSize$.pipe(Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){e.setBrushSize(t)})),this.brushColor$.pipe(Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){e.setBrushColor(t)})),this.eraserSize$.pipe(Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){e.setEraserSize(t)})),this.syncCanvas()}},{key:"initInputListeners",value:function(){var e=this;this.inputManager=new Hammer.Manager(this.drawCanvas.nativeElement),this.inputManager.add(new Hammer.Pan({event:"pan",pointers:0})),this.inputManager.add(new Hammer.Tap({event:"tap"}));var t=new Map;this.inputManager.on("tap",(function(t){t.pointers.forEach((function(n){if(void 0!==n.x){var i=n.x,o=n.y;e.drawPoint(i,o)}else{var r=t.center,a=r.x,s=r.y;e.drawPoint(a,s)}e.checkCanvasPaint()}))})),this.inputManager.on("panstart",(function(e){e.pointers.forEach((function(n){if(void 0===n.x)t.set(1,e.center);else{var i=n.x,o=n.y;t.set(n.pointerId,{x:i,y:o})}}))})),this.inputManager.on("pan",(function(n){n.pointers.forEach((function(i){var o=n.center.x,r=n.center.y,a=1;void 0!==i.pointerId&&(o=i.x,r=i.y,a=i.pointerId);var s=t.get(a),c=s.x,l=s.y;e.drawLine(c,l,o,r),e.drawPoint(o,r),t.set(a,{x:o,y:r})}))})),this.inputManager.on("panend",(function(){t.clear(),e.checkCanvasPaint()}))}},{key:"handleResetClick",value:function(){this.reset()}},{key:"handleDownloadClick",value:function(){var e=this;this.exporting=!0,this.changeRef.detectChanges();var t=this.canvasElement,n=t.width,i=t.height,o=this.store.selectSnapshot(vs.getSelectedChapterId),r=this.store.selectSnapshot(vs.getSelectedChapterBackground),a=this.store.selectSnapshot(zs.getWatermarkEnabled),s=document.querySelector(".engine__watermark"),c=[this.annotateElement.nativeElement];a&&!Object(ie.isNil)(s)&&c.push(s),this.store.dispatch(new pr(o,r,dM,100,{width:n,height:i},"original",!0,!0,c)).pipe(Object(vr.a)((function(){return e.actions.pipe(Object(L.j)(ur),Object(Tc.a)(1))})),Object(X.a)(this.ngUnsubscribe),Object(Ss.a)((function(){e.exporting=!1,e.changeRef.markForCheck()}))).subscribe((function(t){e.downloadSnapshot(t.blob)}))}},{key:"handleExitClick",value:function(){this.resetCanvas(),this.viewService.toggleWhiteboard(!1)}},{key:"checkCanvasPaint",value:function(){var e=this.canvasContext.getImageData(0,0,this.canvasElement.width,this.canvasElement.height),t=new Uint32Array(e.data.buffer).some((function(e){return 0!==e}));this.store.dispatch(new _.SetWhiteboardHasPaint(t))}},{key:"drawPoint",value:function(e,t){var n=this.lineWidth/2,i=2*Math.PI;this.canvasContext.beginPath(),this.canvasContext.arc(e,t,n,0,i),this.canvasContext.fill()}},{key:"drawLine",value:function(e,t,n,i){this.canvasContext.beginPath(),this.canvasContext.moveTo(e,t),this.canvasContext.lineTo(n,i),this.canvasContext.stroke(),this.canvasContext.closePath()}},{key:"reset",value:function(){this.resetCanvas(),this.labels=[],this.changeRef.markForCheck(),this.dispatchHasText()}},{key:"setBrushSize",value:function(e){this.brushSize=e,this.setLineWidth(e)}},{key:"setBrushColor",value:function(e){this.canvasContext.fillStyle=e,this.canvasContext.strokeStyle=e}},{key:"setEraserSize",value:function(e){this.eraserSize=e,this.setLineWidth(e)}},{key:"setLineWidth",value:function(e){this.canvasContext.lineWidth=e,this.lineWidth=e}},{key:"syncCanvas",value:function(){var e=this.store.selectSnapshot(hs.getWhiteboardBrushSize),t=this.store.selectSnapshot(hs.getWhiteboardBrushColor),n=this.store.selectSnapshot(hs.getWhiteboardEraserSize),i=this.getScreenDimensions(),o=i.width,r=i.height;this.canvasElement.width=o,this.canvasElement.height=r,this.setBrushSize(e),this.setBrushColor(t),this.setEraserSize(n),this.canvasContext.lineJoin="round"}},{key:"resetCanvas",value:function(){var e=this.canvasElement,t=e.width,n=e.height;this.canvasContext.clearRect(0,0,t,n),this.store.dispatch(new _.SetWhiteboardHasPaint(!1))}},{key:"downloadSnapshot",value:function(e){var t=this,n=this.store.selectSnapshot(Ic.getStory).displayName,i="".concat((n||"").replace(/ /g,"_").replace(/\W/g,"").toLowerCase(),"_drawing.").concat(dM===cr.PNG?"png":"jpg");!0===T.native||T.platform===z.SDK?hr.blobToBase64(e).pipe(Object(vr.a)((function(e){return t.clipboardService.copyToClipboard(e,"image")})),Object(X.a)(this.ngUnsubscribe)).subscribe((function(e){})):hr.exportImage(e,dM,i)}},{key:"getScreenDimensions",value:function(){var e=window;return{width:e.innerWidth,height:e.innerHeight}}}]),e}()).\u0275fac=function(e){return new(e||pM)(j.Pb(L.g),j.Pb(L.b),j.Pb(Wp),j.Pb(Ju),j.Pb(j.i))},pM.\u0275cmp=j.Jb({type:pM,selectors:[["app-view-whiteboard"]],viewQuery:function(e,t){var n;1&e&&(j.Ec(sM,!0),j.Ec(cM,!0)),2&e&&(j.sc(n=j.dc())&&(t.drawCanvas=n.first),j.sc(n=j.dc())&&(t.annotateElement=n.first))},decls:10,vars:15,consts:[[1,"view-whiteboard"],["annotateWrapper",""],["class","view-whiteboard__label",3,"view-whiteboard__label--clickthrough","exporting","id","initialPos","color","size","labelActive","labelEmpty",4,"ngFor","ngForOf"],["data-test","drawCanvas",1,"view-whiteboard__canvas"],["drawCanvas",""],[1,"view-whiteboard__tools"],[3,"clearClick","downloadClick","exitClick"],[1,"view-whiteboard__label",3,"exporting","id","initialPos","color","size","labelActive","labelEmpty"]],template:function(e,t){1&e&&(j.Vb(0,"div",0,1),j.hc(2,"async"),j.hc(3,"async"),j.hc(4,"async"),j.Ic(5,lM,2,9,"app-view-whiteboard-label",2),j.Qb(6,"canvas",3,4),j.Vb(8,"div",5),j.Vb(9,"app-view-whiteboard-tools",6),j.cc("clearClick",(function(){return t.handleResetClick()}))("downloadClick",(function(){return t.handleDownloadClick()}))("exitClick",(function(){return t.handleExitClick()})),j.Ub(),j.Ub(),j.Ub()),2&e&&(j.Hb("view-whiteboard--exporting",t.exporting)("view-whiteboard--cursor-paint",j.ic(2,9,t.annotateMode$)===t.whiteboardAnnotateMode.Paint)("view-whiteboard--cursor-erase",j.ic(3,11,t.annotateMode$)===t.whiteboardAnnotateMode.Erase)("view-whiteboard--cursor-text",j.ic(4,13,t.annotateMode$)===t.whiteboardAnnotateMode.Text),j.Db(5),j.lc("ngForOf",t.labels))},directives:[we.k,YP,oM],pipes:[we.b],styles:[".view-whiteboard{position:fixed;top:0;left:0;right:0;bottom:0;z-index:20;display:flex;flex-direction:column;align-items:center;justify-content:space-between;box-shadow:inset 0 0 0 4px #38de38;padding:8px;transition:border .3s linear}.view-whiteboard--exporting{box-shadow:none}.view-whiteboard--exporting .view-whiteboard__tools{display:none}.view-whiteboard--cursor-paint:hover{cursor:url(/assets/images/cursor-whiteboard-paint.svg) 7 20,pointer}.view-whiteboard--cursor-erase:hover{cursor:url(/assets/images/cursor-whiteboard-erase.svg) 7 20,pointer}.view-whiteboard--cursor-text:hover{cursor:url(/assets/images/cursor-whiteboard-text.svg) 7 20,pointer}.view-whiteboard__label{position:absolute;top:0;left:0;z-index:10}.view-whiteboard__label--clickthrough{pointer-events:none}.view-whiteboard__canvas{position:fixed;top:0;left:0;right:0;bottom:0;z-index:1}.view-whiteboard__tools{z-index:1;right:8px;bottom:8px;position:absolute}"],encapsulation:2,changeDetection:0}),rM([Object(L.d)(hs.getWhiteboardAnnotateMode),aM("design:type",J.a)],pM.prototype,"annotateMode$",void 0),rM([Object(L.d)(hs.getWhiteboardBrushSize),aM("design:type",J.a)],pM.prototype,"brushSize$",void 0),rM([Object(L.d)(hs.getWhiteboardBrushColor),aM("design:type",J.a)],pM.prototype,"brushColor$",void 0),rM([Object(L.d)(hs.getWhiteboardTextSize),aM("design:type",J.a)],pM.prototype,"textSize$",void 0),rM([Object(L.d)(hs.getWhiteboardEraserSize),aM("design:type",J.a)],pM.prototype,"eraserSize$",void 0),rM([Object(L.d)(vs.getSelectedChapterBackground),aM("design:type",J.a)],pM.prototype,"background$",void 0),pM),hM=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},fM=((uM=function(){function e(t,n){y(this,e),this.store=t,this.changeDetectorRef=n,this.ngUnsubscribe=new Z.a,this.visible=!1}return v(e,[{key:"beforePrint",value:function(e){this.visible=!0,this.changeDetectorRef.markForCheck()}},{key:"afterPrint",value:function(e){this.visible=!1,this.changeDetectorRef.markForCheck()}},{key:"ngOnInit",value:function(){this.initImageUrlListener()}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"initImageUrlListener",value:function(){var e=this;Object(zc.b)(this.storyChapters$,this.store.select(Lr.getRegisteredThumbnails)).pipe(Object(Y.a)((function(e){var t=d(e,2),n=t[0],i=t[1];return n.length>0&&i.size>0})),Object(se.a)((function(e){var t=d(e,2),n=t[0];return t[1].get(n[0].id).urls.large})),Object(Zc.a)(),Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){e.imageUrl=t,e.changeDetectorRef.markForCheck()}))}}]),e}()).\u0275fac=function(e){return new(e||uM)(j.Pb(L.g),j.Pb(j.i))},uM.\u0275cmp=j.Jb({type:uM,selectors:[["app-view-print"]],hostBindings:function(e,t){1&e&&j.cc("beforeprint",(function(){return t.beforePrint()}),!1,j.wc)("afterprint",(function(){return t.afterPrint()}),!1,j.wc)},decls:3,vars:1,consts:[[1,"view-print"],["src","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=",1,"view-print__scrim"],[1,"view-print__image",3,"src"]],template:function(e,t){1&e&&(j.Vb(0,"div",0),j.Qb(1,"img",1),j.Qb(2,"img",2),j.Ub()),2&e&&(j.Db(2),j.lc("src",t.imageUrl,j.Ac))},styles:[".view-print[_ngcontent-%COMP%]{background-color:#fff;display:none;position:absolute;top:0;left:0;width:100%;height:100%;z-index:10000;justify-content:space-around;margin:auto;margin-top:0!important}@media print{.view-print[_ngcontent-%COMP%]{display:flex}}.view-print__scrim[_ngcontent-%COMP%]{display:block;width:100%;height:100%;position:absolute;z-index:-1;top:0;right:0;bottom:0;left:0}.view-print__image[_ngcontent-%COMP%]{display:block;flex:1 1 auto;-o-object-fit:contain;object-fit:contain;margin:0 auto;z-index:1}"],changeDetection:0}),function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);r>3&&a&&Object.defineProperty(t,n,a)}([Object(L.d)(vs.getStoryChapters),hM("design:type",J.a)],uM.prototype,"storyChapters$",void 0),uM),bM=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function mM(e,t){if(1&e){var n=j.Wb();j.Vb(0,"div",1),j.Vb(1,"app-message-toggle",2),j.cc("handleDismiss",(function(){return j.xc(n),j.gc().handleDismiss()})),j.Vb(2,"div"),j.Kc(3," This model is not optimized for use on mobile devices. For an optimal experience, please switch to a desktop device or try our Anatomy by Regions. "),j.Ub(),j.Ub(),j.Ub()}2&e&&(j.Db(1),j.lc("dismiss",!0))}var vM,yM=((vM=function(){function e(t){y(this,e),this.changeRef=t,this.shown=!1,this.ngUnsubscribe=new Z.a}return v(e,[{key:"ngOnInit",value:function(){var e=this;this.bookmark$.pipe(Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){var n=Object(ie.get)(t,"tags",[]);e.shown=n.includes("complete anatomy"),e.changeRef.markForCheck()}))}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"handleDismiss",value:function(){this.shown=!1,this.changeRef.markForCheck()}}]),e}()).\u0275fac=function(e){return new(e||vM)(j.Pb(j.i))},vM.\u0275cmp=j.Jb({type:vM,selectors:[["app-view-content-warning"]],decls:2,vars:3,consts:[["class","warning",4,"ngIf"],[1,"warning"],["type","warning","toggleStyle","flat","icon","info-circle",3,"dismiss","handleDismiss"]],template:function(e,t){1&e&&(j.Ic(0,mM,4,1,"div",0),j.hc(1,"async")),2&e&&j.lc("ngIf",j.ic(1,1,t.bookmark$)&&t.shown)},directives:[we.l,zw],pipes:[we.b],styles:[".warning{position:fixed;top:0;left:0;right:0;z-index:1001}"],encapsulation:2,changeDetection:0}),function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);r>3&&a&&Object.defineProperty(t,n,a)}([Object(L.d)(H_.getSelectedBookmark),bM("design:type",J.a)],vM.prototype,"bookmark$",void 0),vM),xM=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},OM=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},wM=["engineContainer"],kM=["viewContainer"],CM=["view"],SM=["viewCameraBar"],_M=["viewLogo"],jM=["viewSceneBase"],PM=["viewToolbar"],MM=["drawer"];function IM(e,t){1&e&&j.Qb(0,"app-view-column-container")}function zM(e,t){1&e&&(j.Vb(0,"div",25),j.Qb(1,"app-view-title",26),j.Ub())}function TM(e,t){1&e&&(j.Vb(0,"div",27),j.Qb(1,"app-engine-audio"),j.Ub())}function UM(e,t){1&e&&(j.Vb(0,"div",28),j.Qb(1,"app-view-undo"),j.Ub())}function DM(e,t){1&e&&j.Qb(0,"app-view-toolbar",29)}function LM(e,t){1&e&&(j.Vb(0,"div",30),j.Qb(1,"app-view-menu",31),j.Ub())}function EM(e,t){if(1&e&&j.Qb(0,"app-engine-camera-bar",32),2&e){var n=j.gc();j.lc("showNav",n.cameraVisible)}}function FM(e,t){if(1&e&&(j.Vb(0,"div",33),j.Qb(1,"app-view-logo",34),j.hc(2,"async"),j.Ub()),2&e){var n=j.gc();j.Db(1),j.lc("logoColor",n.isBackgroundLight?"color":"white")("logoSize",j.ic(2,3,n.breakpoint$)>n.breakpoint.Small?"full":"small")("contentId",n.contentId)}}function AM(e,t){if(1&e){var n=j.Wb();j.Tb(0),j.Vb(1,"app-view-drawer",35,36),j.cc("offsetYChange",(function(e){return j.xc(n),j.gc().handleDrawerOffsetChange(e)})),j.Ub(),j.Sb()}}function RM(e,t){1&e&&j.Qb(0,"div",37)}function VM(e,t){if(1&e&&j.Qb(0,"app-view-ondemand",38),2&e){var n=j.gc();j.lc("contentId",n.contentId)("contentType",n.contentType)}}function NM(e,t){if(1&e&&(j.Qb(0,"app-view-progress",39),j.hc(1,"async")),2&e){var n=j.gc();j.lc("show",j.ic(1,2,n.viewWindow$)===n.viewWindow.Loader)("percent",n.chunkLoadProgress)}}function BM(e,t){if(1&e&&j.Qb(0,"app-play-loader",41),2&e){var n=j.gc(2);j.lc("percent",n.chunkLoadProgress)}}function HM(e,t){1&e&&j.Qb(0,"app-button-loader")}function QM(e,t){1&e&&j.Qb(0,"app-hand-loader")}function qM(e,t){if(1&e&&(j.Vb(0,"app-view-loader"),j.Ic(1,BM,1,1,"app-play-loader",40),j.hc(2,"async"),j.Ic(3,HM,1,0,"app-button-loader",4),j.hc(4,"async"),j.Ic(5,QM,1,0,"app-hand-loader",4),j.hc(6,"async"),j.Ub()),2&e){var n=j.gc();j.Db(1),j.lc("ngIf","play"===j.ic(2,3,n.interactType$)),j.Db(2),j.lc("ngIf","button"===j.ic(4,5,n.interactType$)),j.Db(2),j.lc("ngIf","hand"===j.ic(6,7,n.interactType$))}}function $M(e,t){1&e&&j.Qb(0,"app-view-tour")}function WM(e,t){1&e&&j.Qb(0,"app-view-whiteboard")}function KM(e,t){1&e&&j.Qb(0,"app-view-print")}function GM(e,t){1&e&&j.Qb(0,"app-view-content-warning")}var ZM,JM,XM,YM,eI,tI=function(e,t,n){return{"view-page--column-in":e,"view-page--column-out":t,"view-page--drawer-push":n}},nI=((JM=function(){function e(t,n,i,o,r,a,s,c,l,p,u,d){y(this,e),this.activatedRoute=t,this.renderer=n,this.changeDetectorRef=i,this.store=o,this.actions=r,this.liveAnnouncer=a,this.viewService=s,this.quizService=c,this.layoutService=l,this.engineService=p,this.pendoService=u,this.title=d,this.application=P,this.nativePlatform=Ed,this.breakpoint=Gc,this.viewLayoutStatus=ba,this.viewMode=Uc,this.viewUI=nl,this.viewWindow=Ea,this.columnLayoutStatus=ba.Hide,this.drawerExpandable=!0,this.drawerOpen=!1,this.drawerY=0,this.loadLabel="",this.chunkLoadProgress=0,this.chaptersLoaded=0,this.isBackgroundLight=!0,this.selectedChapterLoading=!1,this.viewToolsMode=Lf,this.audioVisible=!1,this.cameraVisible=!1,this.columnVisible=!1,this.drawerVisible=!1,this.logoVisible=!1,this.menuVisible=!1,this.nodeInfoVisible=!1,this.searchVisible=!1,this.titleOnlyVisible=!1,this.toolbarVisible=!1,this.undoVisible=!1,this.ngUnsubscribe=new Z.a,this.audioListening=new Z.a}return v(e,[{key:"onClick",value:function(e){this.handleFirstClickTracking(e)}},{key:"ngOnInit",value:function(){this.resetScene();var e=this.viewService.normalizeQueryParams(this.activatedRoute.snapshot.queryParams);this.contentId=e.id,this.contentType=e.type,this.contentLang=e.lang}},{key:"ngAfterViewInit",value:function(){var e=this;this.viewService.setViewLanguage(this.contentLang),this.loadStory(),this.store.dispatch(new ha({tag:!0,pin:!1})),this.store.dispatch(new Ht(!0));var t=this.store.selectSnapshot(hs.getUI).loader.template;this.store.dispatch(new Dt(t===va.Bar)),t!==va.None&&this.store.dispatch(new _.ToggleWindow(Ea.Loader,!0)),this.checkCapabilities(),this.initSizeObservers(),this.initHeaderObserver(),this.initLayoutObserver(),this.initBreakpointObservers(),this.initKeyboardObserver(),this.initLoadProgressObserver(),this.initWindowObserver(),this.initBackgroundColorObserver(),this.initResponsiveLabels(),this.initNodeObserver(),this.initChapterObserver(),this.initAudioObserver(),this.initAccessibility(),this.positionRelativeElements(this.drawerY),this.storyId$.pipe(Object(Y.a)((function(e){return!Object(ie.isNil)(e)&&"preview"!==e})),Object(Tc.a)(1),Object(X.a)(this.ngUnsubscribe)).subscribe((function(){return e.initPendoEvents()}))}},{key:"ngOnDestroy",value:function(){this.store.dispatch(new ft(!1)),this.store.dispatch(new rl),this.store.dispatch(new na),Nr.isFullscreen()&&Nr.exitFullscreen(),this.quizService.exitQuiz(),this.unbindKeyboard(),this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"loadStory",value:function(){var e=this;this.onDemand$.pipe(Object(Y.a)((function(e){return!e})),Object(Tc.a)(1),Object(X.a)(this.ngUnsubscribe)).subscribe((function(){e.viewService.initStory(e.contentId,e.contentType,e.contentLang)}))}},{key:"checkCapabilities",value:function(){var e=this,t=this.renderer.listen("window","mouseover",(function(){t(),e.store.dispatch(new _.SetCanHover(!0))})),n="ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0;this.store.dispatch(new _.SetCanTouch(n)),this.store.dispatch(new _.SetCanFullscreen(Nr.canFullscreen())),this.store.dispatch(new _.SetInputMode(n?Xa.Touch:Xa.Mouse))}},{key:"initBreakpointObservers",value:function(){var e=this;this.breakpoint$.pipe(Object(X.a)(this.ngUnsubscribe)).subscribe((function(){e.handleResize()}))}},{key:"initResponsiveLabels",value:function(){var e=this,t=Object(ka.a)(window,"resize").pipe(Object(Gp.a)(100)),n=this.store.select(hs.getLabelsBreakpoint),i=this.store.select(kc.getSelectedLabel),o=this.store.select(kc.getLabelsCollapsed);i.pipe(Object(Y.a)((function(){return e.store.selectSnapshot(kc.getLabelsCollapsed)})),Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){e.viewService.toggleLabelInfo(!!t)})),o.pipe(Object(Y.a)((function(){return!!e.store.selectSnapshot(kc.getSelectedLabel)})),Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){e.viewService.toggleLabelInfo(t)})),Object(zc.b)(t,n).pipe(Object(Y.a)((function(e){var t=d(e,2)[1];return!Object(ie.isNil)(t)})),Object(X.a)(this.ngUnsubscribe)).subscribe((function(){e.checkLabelsCollapsed()})),this.checkLabelsCollapsed()}},{key:"initSizeObservers",value:function(){var e=this,t=Df({strategy:"scroll"});Object(ka.a)(window,"resize").pipe(Object(Gp.a)(10),Object(X.a)(this.ngUnsubscribe)).subscribe((function(){e.updateViewHeight(),e.refreshLayout()})),new J.a((function(n){t.listenTo(e.engineContainer.nativeElement,(function(){n.next()}))})).pipe(Object(Gp.a)(10)).subscribe((function(){e.resizeEngineContainer()}))}},{key:"initHeaderObserver",value:function(){var e=this;this.store.select(fp.getSiteHeader).pipe(Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){e.updateViewHeight()}))}},{key:"initLayoutObserver",value:function(){var e=this;this.layout$.pipe(Object(Y.a)((function(e){return null!=e})),Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){e.refreshLayout()}))}},{key:"initKeyboardObserver",value:function(){var e=this;this.inputEnabled$.pipe(Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){t?e.bindKeyboard():e.unbindKeyboard()}))}},{key:"initNodeObserver",value:function(){var e=this;this.actions.pipe(Object(L.j)(_t),Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){e.viewService.delegateNodeClick(t.node,t.event)})),this.store.select(jo.getSelectedNode).pipe(Object(Cp.a)(),Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){var n=d(t,2),i=n[0],o=n[1],r=Object(ie.get)(i,"objectId",void 0),a=Object(ie.get)(o,"objectId",void 0);void 0!==o&&r===a||e.viewService.toggleNodeInfo(!1)}))}},{key:"initChapterObserver",value:function(){var e=this;this.store.select(vs.getSelectedChapterId).pipe(Object(Y.a)((function(e){return null!=e})),Object(se.a)((function(){return e.store.selectSnapshot(vs.getSelectedChapter)})),Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){e.viewService.initChapter(t),e.store.dispatch(new na),e.setPageTitle(t),e.refreshLayout()}))}},{key:"initLoadProgressObserver",value:function(){var e=this;this.storyLoadProgress$.pipe(Object(X.a)(this.ngUnsubscribe),Object(Y.a)((function(e){return 1===e}))).subscribe((function(){e.viewService.resetLayout()})),this.store.select(ll.getChunkLoadProgress).pipe(Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){e.chunkLoadProgress=100*t,e.engineService.fireEvent(yn.HumanProgress,{progress:e.chunkLoadProgress}),e.changeDetectorRef.markForCheck(),e.checkShowLoader()})),this.store.select(Ic.getLoadingChunk).pipe(Object(Y.a)((function(){return null!=e.store.selectSnapshot(vs.getSelectedChapterId)})),Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){null!==t&&t.chapterId===e.store.selectSnapshot(vs.getSelectedChapterId)||T.offline?e.store.dispatch(new _.ToggleWindow(Ea.Loader,!0)):(e.engineService.enableRender(),e.store.dispatch(new _.ToggleWindow(Ea.Loader,!1)),e.refreshLayout(),setTimeout((function(){e.engineService.enableAnimation()}),500))})),this.actions.pipe(Object(L.i)(et),Object(X.a)(this.ngUnsubscribe)).subscribe((function(){0===e.store.selectSnapshot(Ic.getLoadChunksRemaining).length&&(e.engineService.fireEvent(yn.SceneLoaded,null),e.store.dispatch(new _.ToggleWindow(Ea.Loader,!1)),T.offline)&&setTimeout((function(){e.engineService.enableAnimation()}),1750)}))}},{key:"checkShowLoader",value:function(){if(this.store.selectSnapshot(vs.getSelectedChapterIndex)>0){var e=this.store.selectSnapshot(vs.getSelectedChapterId),t=this.store.selectSnapshot(Ic.getLoadingChunk);null!==t&&e===t.chapterId&&this.store.dispatch(new _.ToggleWindow(Ea.Loader,!0))}}},{key:"initWindowObserver",value:function(){var e=this;this.viewWindow$.pipe(Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){e.viewService.resetLayout(),t===Ea.Tutorial?(e.viewService.resetChapter(),e.viewService.toggleLabels(!1)):e.viewService.toggleLabels(!0)}))}},{key:"initBackgroundColorObserver",value:function(){var e=this;this.background$.pipe(Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){e.isBackgroundLight=Ki.isLight(t),e.changeDetectorRef.markForCheck()}))}},{key:"initAudioObserver",value:function(){var e=this,t=Object(Ca.a)(this.ngUnsubscribe,this.audioListening),n=this.viewWindow$.pipe(Object(se.a)((function(e){return e===Ea.Tutorial||e===Ea.Interact})),Object(Y.a)((function(e){return e})),Object(Tc.a)(1));Object(zc.b)(this.viewWindow$,n,this.audio$).pipe(Object(Y.a)((function(e){var t=d(e,1)[0];return Object(ie.isNil)(t)})),Object(X.a)(t)).subscribe((function(t){var n=d(t,3),i=n[1],o=n[2];i?Object(ie.isNil)(o)||e.playAudio():e.stopAudioListening()}))}},{key:"initPendoEvents",value:function(){var e=this,t={totalQuestions:0};this.store.select(rr.getQuestionTotal).pipe(Object(X.a)(this.ngUnsubscribe)).subscribe((function(e){t.totalQuestions=e})),this.store.select(rr.getQuizModeActive).pipe(Object(Y.a)((function(){return e.store.selectSnapshot(rr.getQuestionTotal)>0})),Object(X.a)(this.ngUnsubscribe)).subscribe((function(n){n&&e.pendoService.track("Quiz - Entered",t)})),this.actions.pipe(Object(L.j)(Eo.SubmitQuestionAnswer),Object(X.a)(this.ngUnsubscribe)).subscribe((function(){var n=e.store.selectSnapshot(rr.getActiveQuestionIndex),i=e.store.selectSnapshot(rr.getQuestionsRemaining);0===n&&e.pendoService.track("Quiz - First Question Answered",t),0===i&&e.pendoService.track("Quiz - Completed",t)})),this.store.select(vs.getSelectedChapterModelReady).pipe(Object(Y.a)((function(e){return e})),Object(Tc.a)(1),Object(X.a)(this.ngUnsubscribe)).subscribe((function(){var t=e.store.selectSnapshot(Ic.getStoryId),n=e.store.selectSnapshot(Ic.getStory);e.pendoService.trackOncePerPage("View - Loaded",{id:t,chapters:n.chapters.length,tour:n.tags.includes("tour"),animated:n.tags.includes("animated"),quiz:e.store.selectSnapshot(rr.hasQuiz),edit:!1})}))}},{key:"initAccessibility",value:function(){var e=this;this.chapter$.pipe(Object(Y.a)((function(e){return null!==e})),Object(Zc.a)((function(e,t){return e.id===t.id})),Object(se.a)((function(e){return Object(ie.get)(e,"info.displayName","")}))).subscribe((function(t){e.liveAnnouncer.announce("Opened chapter "+t)}))}},{key:"handleFirstClickTracking",value:function(e){e.composedPath().some((function(e){return"APP-SITE-HEADER"===e.nodeName}))||1===this.store.selectSnapshot(ll.getStoryLoadProgress)&&this.pendoService.trackOncePerPage("First Click")}},{key:"stopAudioListening",value:function(){this.audioListening.next(),this.audioListening.complete()}},{key:"playAudio",value:function(){this.store.dispatch(new Nt(!0)),this.stopAudioListening()}},{key:"handleColumnToggle",value:function(){this.viewService.toggleColumn(),this.changeDetectorRef.markForCheck()}},{key:"handleDrawerOffsetChange",value:function(e){this.drawerY=e,this.drawerOpen=-64!==e,this.positionRelativeElements(this.drawerY)}},{key:"checkLabelsCollapsed",value:function(){var e=this.store.selectSnapshot(tl.getBreakpoint),t=this.store.selectSnapshot(hs.getLabelsBreakpoint),n=this.isLabelBreaking(t);this.store.dispatch(new ga(n,e>=Gc.Large?Kr.Toggle:Kr.None))}},{key:"isLabelBreaking",value:function(e){return window.innerWidth<e}},{key:"bindKeyboard",value:function(){var e=this;Uf.bind("1",(function(){return e.viewService.selectTool(ks.Select)})),Uf.bind("2",(function(){return e.viewService.selectTool(ks.Hide)})),Uf.bind("3",(function(){return e.viewService.selectTool(ks.Fade)})),Uf.bind(["command+,","ctrl+,"],(function(t){t.preventDefault(),e.store.selectSnapshot(tl.getBreakpoint)>Gc.Medium?e.viewService.toggleColumn():e.drawer.toggleDrawer(),e.changeDetectorRef.markForCheck()})),Uf.bind(["command+enter","ctrl+enter","command+p"],(function(e){e.preventDefault(),Nr.toggleFullscreen()})),Uf.bind("meta+z",(function(t){t.preventDefault(),e.viewService.undo()})),Uf.bind(["meta+y","meta+shift+z"],(function(t){t.preventDefault(),e.viewService.redo()})),Uf.bind([".","pagedown"],(function(){return e.viewService.nextChapter("Keyboard")})),Uf.bind([",","pageup"],(function(){return e.viewService.previousChapter("Keyboard")})),Uf.bind(["del","backspace"],(function(t){t.preventDefault(),e.viewService.hideSelectedStructures()})),Uf.bind("R",(function(t){t.preventDefault(),e.viewService.resetChapter()})),Uf.bind("/",(function(){return e.viewService.toggleSearch()})),Uf.bind("?",(function(){return e.viewService.toggleHelp()})),Uf.bind("space",(function(t){t.preventDefault(),e.viewService.toggleAnimation()}))}},{key:"unbindKeyboard",value:function(){Uf.reset()}},{key:"resizeEngineContainer",value:function(){var e=this.engineContainer.nativeElement.getBoundingClientRect(),t=e.top,n=e.left,i=e.width,o=e.height,r=new _n(n,t,i,o,jn.Shown);this.store.dispatch(new Kt(r))}},{key:"updateViewHeight",value:function(){var e=T.application!==P.Viewer,t=bp(this.store.selectSnapshot(fp.getSiteHeader),e);this.view.nativeElement.style.setProperty("--vh",t+"px")}},{key:"handleResize",value:function(){this.viewService.resetLayout()}},{key:"resetScene",value:function(){var e=this;this.store.dispatch(new ft(!0)),this.store.dispatch(new vt(!1)),this.store.dispatch(new Et(ks.Select)),this.store.dispatch(new rl),this.store.dispatch(new $n(!1)),this.engineService.getEvent(yn.AssetsLoadProgress).pipe(Object(Tc.a)(1),Object(X.a)(this.ngUnsubscribe)).subscribe((function(){e.store.dispatch(new vt(!0))}))}},{key:"refreshLayout",value:function(){var e=this,t=this.store.selectSnapshot(hs.getUI);this.columnLayoutStatus=t.column.status,this.audioVisible=this.layoutService.isVisible(nl.Audio),this.cameraVisible=this.layoutService.isVisible(nl.Camera),this.columnVisible=this.layoutService.isVisible(nl.Column),this.drawerVisible=this.layoutService.isVisible(nl.Drawer),this.logoVisible=this.layoutService.isVisible(nl.Logo),this.menuVisible=this.layoutService.isVisible(nl.Menu),this.nodeInfoVisible=this.layoutService.isVisible(nl.NodeInfo),this.searchVisible=this.layoutService.isVisible(nl.Search),this.titleOnlyVisible=this.layoutService.isVisible(nl.TitleOnly),this.toolbarVisible=this.layoutService.isVisible(nl.Toolbar),this.undoVisible=this.layoutService.isVisible(nl.Undo),this.updateViewHeight(),this.resizeEngineContainer(),this.store.dispatch(new pa(!1!==t.anatomyLabels.enable,!1!==t.nodeInfo.enable,!0)),this.store.dispatch(new Lt(!1!==t.labels.enable&&!1!==t.labels.shown)),setTimeout((function(){e.drawer?e.positionRelativeElements(e.drawerY):e.positionRelativeElements(),e.changeDetectorRef.markForCheck()}))}},{key:"positionRelativeElements",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.store.selectSnapshot(tl.getBreakpoint),null!=this.viewCameraBar&&this.cameraVisible&&this.renderer.setStyle(this.viewCameraBar.nativeElement,"transform","translate3d(-4px, ".concat(this.menuVisible?-64:0,"px, 0)")),this.renderer.setStyle(this.viewToolbar.nativeElement,"transform","translate3d(-8px, 0, 0)"),this.renderer.setStyle(this.viewSceneBase.nativeElement,"transform","translate3d(0, -8px, 0)"),this.renderer.setStyle(this.view.nativeElement,"padding-bottom",-e+"px")}},{key:"setPageTitle",value:function(e){var t=Object(ie.get)(e,"info.displayName");this.title.setTitle((t?t+" | ":"")+"BioDigital Human Platform")}},{key:"isVisible",value:function(e){return this.layoutService.isVisible(e)}},{key:"isEnabled",value:function(e){return this.layoutService.isUIEnabled(e)}}]),e}()).\u0275fac=function(e){return new(e||JM)(j.Pb(te.a),j.Pb(j.H),j.Pb(j.i),j.Pb(L.g),j.Pb(L.b),j.Pb(qp.i),j.Pb(Wp),j.Pb(Ef),j.Pb(pl),j.Pb(Sn),j.Pb(Oe),j.Pb(U.c))},JM.\u0275cmp=j.Jb({type:JM,selectors:[["app-view-page"]],viewQuery:function(e,t){var n;1&e&&(j.Ec(wM,!0),j.Ec(kM,!0),j.Ec(CM,!0),j.Pc(SM,!0),j.Pc(_M,!0),j.Ec(jM,!0),j.Pc(PM,!0),j.Pc(MM,!0,NO)),2&e&&(j.sc(n=j.dc())&&(t.engineContainer=n.first),j.sc(n=j.dc())&&(t.viewContainer=n.first),j.sc(n=j.dc())&&(t.view=n.first),j.sc(n=j.dc())&&(t.viewCameraBar=n.first),j.sc(n=j.dc())&&(t.viewLogo=n.first),j.sc(n=j.dc())&&(t.viewSceneBase=n.first),j.sc(n=j.dc())&&(t.viewToolbar=n.first),j.sc(n=j.dc())&&(t.drawer=n.first))},hostBindings:function(e,t){1&e&&j.cc("click",(function(e){return t.onClick(e)}),!1,j.vc)},decls:41,vars:40,consts:[["role","main"],["viewContainer",""],[1,"view-page",3,"ngClass"],["view",""],[4,"ngIf"],["class","view-page__title-only",4,"ngIf"],[1,"view-page__engine"],["engineContainer",""],["class","view-page__audio",4,"ngIf"],["class","view-page__undo",4,"ngIf"],[1,"view-page__column-toggle"],[1,"view-page__scene-base"],["viewSceneBase",""],[1,"view-page__toolbar"],["viewToolbar",""],["position","right",4,"ngIf"],["class","view-page__menu",4,"ngIf"],[1,"view-page__camera-bar"],["viewCameraBar",""],[3,"showNav",4,"ngIf"],["class","view-page__logo",4,"ngIf"],["class","view-block-input",4,"ngIf"],[3,"contentId","contentType",4,"ngIf"],[3,"show","percent",4,"ngIf"],[4,"appFlagApplication","appFlagApplicationMode","appFlagApplicationNative"],[1,"view-page__title-only"],["layout","column"],[1,"view-page__audio"],[1,"view-page__undo"],["position","right"],[1,"view-page__menu"],[1,"ml-4"],[3,"showNav"],[1,"view-page__logo"],[3,"logoColor","logoSize","contentId"],[3,"offsetYChange"],["drawer",""],[1,"view-block-input"],[3,"contentId","contentType"],[3,"show","percent"],[3,"percent",4,"ngIf"],[3,"percent"]],template:function(e,t){if(1&e&&(j.Vb(0,"div",0,1),j.Vb(2,"div",2,3),j.Ic(4,IM,1,0,"app-view-column-container",4),j.Qb(5,"app-view-menu-column"),j.Ic(6,zM,2,0,"div",5),j.hc(7,"async"),j.Vb(8,"div",6,7),j.Ic(10,TM,2,0,"div",8),j.Ic(11,UM,2,0,"div",9),j.Vb(12,"div",10),j.Qb(13,"app-view-column-toggle"),j.Ub(),j.Vb(14,"div",11,12),j.Vb(16,"div",13,14),j.Ic(18,DM,1,0,"app-view-toolbar",15),j.Ub(),j.Ic(19,LM,2,0,"div",16),j.Vb(20,"div",17,18),j.Ic(22,EM,1,1,"app-engine-camera-bar",19),j.Ub(),j.Ic(23,FM,3,5,"div",20),j.Ub(),j.Ic(24,AM,3,0,"ng-container",4),j.Ub(),j.Ub(),j.Ub(),j.Ic(25,RM,1,0,"div",21),j.hc(26,"async"),j.Ic(27,VM,1,2,"app-view-ondemand",22),j.hc(28,"async"),j.Ic(29,NM,2,4,"app-view-progress",23),j.hc(30,"async"),j.Ic(31,qM,7,9,"app-view-loader",4),j.hc(32,"async"),j.Ic(33,$M,1,0,"app-view-tour",4),j.hc(34,"async"),j.Ic(35,WM,1,0,"app-view-whiteboard",4),j.hc(36,"async"),j.Ic(37,KM,1,0,"app-view-print",4),j.hc(38,"async"),j.Ic(39,GM,1,0,"app-view-content-warning",24),j.Qb(40,"app-view-iphone12-warning")),2&e){var n,i=null;j.Db(2),j.lc("ngClass",j.pc(36,tI,t.columnVisible,!t.columnVisible,t.drawerVisible)),j.Db(2),j.lc("ngIf",t.columnVisible||t.searchVisible||t.nodeInfoVisible),j.Db(2),j.lc("ngIf",t.titleOnlyVisible&&(null==(i=j.ic(7,20,t.chapter$))?null:i.info.displayName)),j.Db(4),j.lc("ngIf",t.audioVisible),j.Db(1),j.lc("ngIf",t.undoVisible),j.Db(7),j.lc("ngIf",t.toolbarVisible),j.Db(1),j.lc("ngIf",t.menuVisible),j.Db(3),j.lc("ngIf",t.cameraVisible),j.Db(1),j.lc("ngIf",t.logoVisible),j.Db(1),j.lc("ngIf",t.drawerVisible),j.Db(1),j.lc("ngIf",!j.ic(26,22,t.inputEnabled$)),j.Db(2),j.lc("ngIf",j.ic(28,24,t.viewWindow$)===t.viewWindow.OnDemand),j.Db(2),j.lc("ngIf","circle"===(null==(n=j.ic(30,26,t.layout$))?null:n.loader.template)),j.Db(2),j.lc("ngIf",j.ic(32,28,t.viewWindow$)===t.viewWindow.Interact),j.Db(2),j.lc("ngIf",j.ic(34,30,t.viewWindow$)===t.viewWindow.Tutorial),j.Db(2),j.lc("ngIf",j.ic(36,32,t.viewWindow$)===t.viewWindow.Whiteboard),j.Db(2),j.lc("ngIf",j.ic(38,34,t.usePrintImage$)),j.Db(2),j.lc("appFlagApplication",t.application.All)("appFlagApplicationMode","include")("appFlagApplicationNative",t.nativePlatform.All)}},directives:[we.i,we.l,mw,Cw,Fd,Hw,sC,cb,lC,SC,ZS,lj,xj,aw,NO,wj,Uj,Ej,Vj,Oj,Nj,VP,gM,fM,yM],pipes:[we.b],styles:[".view-page{border:none;width:100vw;height:100vh;height:calc(var(--vh, 1vh) * 100);max-height:100vh;overflow:hidden;transition:padding-left .25s,padding-bottom .3s}.view-page--column-in{padding-left:320px}.view-page--column-out{padding-left:0}.view-page--drawer-push{padding-bottom:64px}.view-page__audio{position:absolute;z-index:10;top:12px;left:12px}.view-page__column{height:100%}.view-page__column-toggle{position:absolute;top:50%;margin-top:-18px;left:0;z-index:10}.view-page__engine{width:100%;height:100%;position:relative}.view-page__menu{position:absolute;right:8px;bottom:0;z-index:30}.view-page__camera-bar{position:absolute;bottom:0;right:4px;z-index:20}.view-page__logo{display:inline-block;position:absolute;left:16px;bottom:0;z-index:10}.view-page__media-bar{position:absolute;left:50%;margin-left:-100px;width:200px;bottom:0;z-index:10;justify-content:center}.view-page__media-bar:not([hidden]){display:flex}.view-page__notifications{position:absolute;top:12px;right:12px;z-index:20}.view-page__title-only{position:absolute;top:8px;left:8px;max-width:304px;z-index:10;padding:12px;border-radius:4px;background:hsla(0,0%,100%,.8);box-shadow:1px -1px 2px 0 rgba(28,42,63,.1),0 1px 2px 0 rgba(28,42,63,.3);color:#131c2a}.view-page__scene-base{position:absolute;left:0;bottom:0;right:0;z-index:10;transition:transform .3s}.view-page__toolbar{position:absolute;display:inline-block;z-index:20;bottom:0;right:64px;transition:transform .25s}.view-page__undo{position:absolute;display:flex;justify-content:center;pointer-events:none;left:0;z-index:10;width:100%}.view-block-input{position:fixed;top:0;bottom:0;left:0;right:0;z-index:10000}"],encapsulation:2,changeDetection:0}),xM([Object(L.d)(Ic.getStoryId),OM("design:type",J.a)],JM.prototype,"storyId$",void 0),xM([Object(L.d)(hs.getUI),OM("design:type",J.a)],JM.prototype,"layout$",void 0),xM([Object(L.d)(hs.getInputEnabled),OM("design:type",J.a)],JM.prototype,"inputEnabled$",void 0),xM([Object(L.d)(hs.getFullscreenActive),OM("design:type",J.a)],JM.prototype,"fullscreenActive$",void 0),xM([Object(L.d)(hs.getDrawerCoversContent),OM("design:type",J.a)],JM.prototype,"drawerCoversContent$",void 0),xM([Object(L.d)(hs.getInteractType),OM("design:type",J.a)],JM.prototype,"interactType$",void 0),xM([Object(L.d)(hs.getOnDemand),OM("design:type",J.a)],JM.prototype,"onDemand$",void 0),xM([Object(L.d)(hs.getShowHelpTab),OM("design:type",J.a)],JM.prototype,"showHelpTab$",void 0),xM([Object(L.d)(hs.getUsePrintImage),OM("design:type",J.a)],JM.prototype,"usePrintImage$",void 0),xM([Object(L.d)(hs.getOpenWindow),OM("design:type",J.a)],JM.prototype,"viewWindow$",void 0),xM([Object(L.d)(hs.getTutorialSeen),OM("design:type",J.a)],JM.prototype,"tutorialSeen$",void 0),xM([Object(L.d)(ll.getStoryLoadProgress),OM("design:type",J.a)],JM.prototype,"storyLoadProgress$",void 0),xM([Object(L.d)(tl.getBreakpoint),OM("design:type",J.a)],JM.prototype,"breakpoint$",void 0),xM([Object(L.d)(vs.getSelectedChapter),OM("design:type",J.a)],JM.prototype,"chapter$",void 0),xM([Object(L.d)(vs.getSelectedChapterReadyState),OM("design:type",J.a)],JM.prototype,"selectedChapterReady$",void 0),xM([Object(L.d)(vs.getChaptersLoaded),OM("design:type",J.a)],JM.prototype,"chaptersLoaded$",void 0),xM([Object(L.d)(vs.getSelectedChapterBackground),OM("design:type",J.a)],JM.prototype,"background$",void 0),xM([Object(L.d)(vs.getSelectedChapterAudio),OM("design:type",J.a)],JM.prototype,"audio$",void 0),xM([Object(L.d)(kc.getSelectedLabel),OM("design:type",J.a)],JM.prototype,"selectedLabel$",void 0),JM),iI=((ZM=function(){function e(){y(this,e)}return v(e,[{key:"resolve",value:function(e){var t=Object.assign({},e.queryParams);return Vc(Object.keys(t).reduce((function(e,n){var i=Array.isArray(t[n]);return e[n]=i?Object(ie.last)(t[n]):t[n],e}),{}))}}]),e}()).\u0275fac=function(e){return new(e||ZM)},ZM.\u0275prov=j.Lb({token:ZM,factory:ZM.\u0275fac}),ZM),oI=r("1uah"),rI=r("l5mm"),aI=r("eNwd"),sI=function(e){return e.Content="content",e.SceneJS="scenejs",e}({}),cI=function(e){return e.Auth="auth",e}({}),lI=function(){var e=function e(){y(this,e)};return e.type="[Analytics] Authorize App",e}(),pI=function(){var e=function e(t,n){y(this,e),this.userType=t,this.response=n};return e.type="[Analytics] Auth Success",e}(),uI=function(){var e=function e(t,n){y(this,e),this.userType=t,this.response=n};return e.type="[Analytics] Auth Failure",e}(),dI=function(){var e=function e(t,n){y(this,e),this.interaction=t,this.source=n};return e.type="[Analytics] Log Interaction",e}(),gI=function(){var e=function e(t,n){y(this,e),this.interaction=t,this.response=n};return e.type="[Analyics] Log Interaction Success",e}(),hI=function(){var e=function e(t,n){y(this,e),this.interaction=t,this.response=n};return e.type="[Analyics] Log Interaction Failure",e}(),fI=function(){var e=function e(){y(this,e)};return e.type="[Analytics] Log View Analytic",e}(),bI=function(){var e=function e(){y(this,e)};return e.type="[Analytics] Log Interaction Chance",e}(),mI=function(){var e=function e(){y(this,e)};return e.type="[Analytics] Log First Interaction",e}(),vI=function(){var e=function e(){y(this,e)};return e.type="[Analytics] Reset First Interaction",e}(),yI=function(e){return e.Widget="widget",e.WidgetAPI="widgetapi",e}({}),xI=r("Qyje"),OI=function(e){return e.InvalidUAID="analytic id does not exist",e.InvalidDeveloperId="Client id invalid",e.InvalidProductKey="app product key",e.MissingUAID="analytic id missing",e.WebOnlyAPI="Api key only compatible with Web Widget",e.AndroidOnlyAPI="Api key only compatible with Mobile Widget SDK for Android",e.IOSOnlyAPI="Api key only compatible with Mobile Widget SDK for iOS",e.MixedAPIKeys="Use of both an app product key and an app api key not allowed",e.ProductKeyNotRegistered='App product key "xxx" has not been registered or is incorrect.  Ensure it has been registered by the system admin',e.ProductKeyInvalidAppBundleID='The app product key "xxx" has not been authorized to be used for app bundle id "yyy".  Confirm the correct values are being used from the system admin',e.ProductKeyBundleIDWhitelist='Use of app product key "xxx" requires the affiliated app bundle id (app_domain) to be white-listed.  Ensure the system admin has white-listed "yyy"',e.ImproperProductKeyUsage='Improper use of app product key "xxx" detected. Contact the system admin if issue continues',e.InvalidPlatformSource="Invalid platform source",e.MissingSource="Missing source",e.MissingPlatform="Missing platform",e.MissingAppDomain="Missing app domain",e.APIKeyMissing="Api key missing",e.APIKeyInvalid="Api key invalid",e.DeveloperDeactivated="Developer account for api key is deactivated",e.BundleIDNotAllowed="App bundle id not allowed",e.BundleIDUnregistered="App bundle id unregistered",e}({}),wI=function e(){y(this,e)},kI=function e(){y(this,e)},CI=function e(){y(this,e)},SI={headers:new Q.d({"Content-Type":"application/json; charset=utf-8"})},_I=((XM=function(){function e(t,n,i){y(this,e),this.http=t,this.storageService=n,this.store=i}return v(e,[{key:"getAnalytic",value:function(e){var t=this;return T.offline?(fetch("https://human.biodigital.com/ws/user/analytics?analytic_id="+e,{method:"GET",mode:"no-cors"}),Object(br.a)({success:!0})):this.http.get("/ws/user/analytics?analytic_id="+e).pipe(Object(se.a)((function(){return{success:!0}})),Object(xr.a)((function(e){return Object(br.a)(t.parseError(e))})))}},{key:"sendAnalytic",value:function(e){var t=this;if(T.offline){var n=e instanceof wI?"https://human.biodigital.com/ws/user/analytics":"https://human.biodigital.com/ws/developer/apps/access/key",i=Object(xI.stringify)(e);if(navigator.onLine)this.sendOfflineAnalytic(n,i),this.sendSavedOfflineMessages(n);else{var o=(new Date).toISOString().substring(0,19);this.storageService.setDatabaseAnalyticItem("offline_event=1&event_timestamp="+o+"&"+i)}return Object(br.a)({success:!0})}return this.http.post(e instanceof wI?"/ws/user/analytics":"/ws/developer/apps/access/key",e,SI).pipe(Object(se.a)((function(){return{success:!0}})),Object(xr.a)((function(e){return Object(br.a)(t.parseError(e))})))}},{key:"sendOfflineAnalytic",value:function(e,t){return n=this,o=regeneratorRuntime.mark((function n(){var i=this;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:fetch(e,{headers:{"Content-Type":"application/x-www-form-urlencoded"},method:"POST",mode:"no-cors",body:t}).catch((function(){navigator.onLine?setTimeout((function(){fetch(e,{headers:{"Content-Type":"application/x-www-form-urlencoded"},method:"POST",mode:"no-cors",body:t})}),300):i.storageService.setDatabaseAnalyticItem(t)}));case 1:case"end":return n.stop()}}),n)})),new((i=void 0)||(i=Promise))((function(e,t){function r(e){try{s(o.next(e))}catch(n){t(n)}}function a(e){try{s(o.throw(e))}catch(n){t(n)}}function s(t){var n;t.done?e(t.value):(n=t.value,n instanceof i?n:new i((function(e){e(n)}))).then(r,a)}s((o=o.apply(n,[])).next())}));var n,i,o}},{key:"sendSavedOfflineMessages",value:function(e){var t=this;this.storageService.getDatabaseOfflineAnalytics((function(n){n.forEach((function(n){t.sendOfflineAnalytic(e,n)}))}))}},{key:"buildUserAnalytic",value:function(e,t){var n=this.store.selectSnapshot(G.getWidgetState),i=n.widgetUrlConfig,o=n.parentUrl,r=i.uaid,a=o.domain,s=Object.assign(Object.assign({},this.buildAppActivityData()),c({parent_analytic_identifier:r,referer_domain:a},e+"_source",t)),l={analytic_platform:yI.Widget,analytic_type:e,analytic_data:s};return Object(ce.plainToClass)(wI,l)}},{key:"buildDeveloperAnalytic",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:yI.Widget,n=arguments.length>2?arguments[2]:void 0,i=this.store.selectSnapshot(G.getWidgetState),o=i.widgetUrlConfig,r=i.parentUrl,a=i.embedded,s={platform:t,app_activity:e,app_productkey:o["app-productkey"],app_userid:o["app-userid"],app_apikey:o.dk,app_domain:r.full,app_activity_data:n,widget_is_fullscreen:!a};return Object(ce.plainToClass)(kI,s)}},{key:"buildAppActivityData",value:function(){var e=this.store.selectSnapshot(G.getWidgetState),t=e.engineVersion,n=e.engineAPIVersion,i=e.widgetUrlConfig,o={engine_version:t,api_version:n};return Object.entries(i).filter((function(e){return"dk"!==d(e,1)[0]})).forEach((function(e){var t=d(e,2),n=t[0],i=t[1];o["url_param_"+n]=i})),Object(ce.plainToClass)(CI,o)}},{key:"parseError",value:function(e){if(T.offline)return{success:!0,message:"",errorCode:null};var t=e.error.error,n=e.status,i=t&&t.message?t.message:"";return{success:n>=500&&n<=504,message:i,errorCode:Object.values(OI).includes(i)?i:null}}}]),e}()).\u0275fac=function(e){return new(e||XM)(j.Zb(Q.b),j.Zb(as),j.Zb(L.g))},XM.\u0275prov=j.Lb({token:XM,factory:XM.\u0275fac,providedIn:"root"}),XM),jI=function(e){return e.Init="init",e.View="view",e.ChanceInteraction="interactionc",e.FirstInteraction="interactionf",e.Call="call",e}({}),PI=function e(){y(this,e)},MI=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},II=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},zI={authenticating:!1,authenticated:!1,bypassAnalytics:!1,loggedInteractions:{init:!1,view:!1,interactionc:!1,interactionf:!1,call:!1}},TI=((eI=YM=function(){function e(t,n){y(this,e),this.store=t,this.analyticsService=n}return v(e,[{key:"autherizeAnalyticId",value:function(e){var t,n=this.store.selectSnapshot(G.getWidgetState),i=n.embedded,o=n.userType,r=n.widgetUrlConfig,a=r["bypass-analytics"];e.patchState({bypassAnalytics:a}),!i||T.native||a?e.patchState({authenticated:!0}):(t=o===H.User?this.analyticsService.getAnalytic(r.uaid):this.analyticsService.sendAnalytic(this.analyticsService.buildDeveloperAnalytic(jI.Init,yI.WidgetAPI,this.analyticsService.buildAppActivityData())),e.patchState({authenticating:!0}),t.pipe(Object(Ss.a)((function(){return e.patchState({authenticating:!1})}))).subscribe((function(t){var n=t.success;e.patchState({authenticated:n}),e.dispatch(n?new pI(o,t):new uI(o,t))})))}},{key:"logInteraction",value:function(e,t){var n=t.interaction,i=t.source,o=this.store.selectSnapshot(G.getWidgetState).userType===H.User?this.analyticsService.buildUserAnalytic(n,i):this.analyticsService.buildDeveloperAnalytic(n,yI.Widget,this.analyticsService.buildAppActivityData());this.analyticsService.sendAnalytic(o).subscribe((function(t){e.dispatch(t.success?new gI(n,t):new hI(n,t))}))}},{key:"logInteractionSuccess",value:function(e,t){var n=e.getState().loggedInteractions;n[t.interaction]=!0,e.patchState({loggedInteractions:n})}},{key:"initView",value:function(e){var t=this,n=["interactive","complete"].includes(document.readyState),i=n?Object(br.a)(n):Object(ka.a)(document,"DOMContentLoaded");this.store.select(YM.isAuthenticated).pipe(Object(Xj.a)(i),Object(Y.a)((function(e){return!0===e})),Object(Tc.a)(1)).subscribe((function(){e.getState().bypassAnalytics||t.store.dispatch(new dI(jI.View))}))}},{key:"logInteractionChance",value:function(e){var t=e.getState();t.loggedInteractions.interactionc||t.bypassAnalytics||e.dispatch(new dI(jI.ChanceInteraction))}},{key:"logFirstInteraction",value:function(e){e.getState().loggedInteractions.interactionf||e.dispatch(new dI(jI.FirstInteraction))}},{key:"resetFirstInteraction",value:function(e){var t=e.getState().loggedInteractions;t.interactionf=!1,e.patchState({loggedInteractions:t})}},{key:"ngxsOnInit",value:function(e){e.dispatch(new fI)}}],[{key:"isAuthenticated",value:function(e){return e.authenticated}},{key:"isFirstInteractionLogged",value:function(e){return e.loggedInteractions.interactionf}}]),e}()).\u0275fac=function(e){return new(e||eI)(j.Zb(L.g),j.Zb(_I))},eI.\u0275prov=j.Lb({token:eI,factory:eI.\u0275fac}),MI([Object(L.a)(lI),II("design:type",Function),II("design:paramtypes",[Object]),II("design:returntype",void 0)],eI.prototype,"autherizeAnalyticId",null),MI([Object(L.a)(dI),II("design:type",Function),II("design:paramtypes",[Object,dI]),II("design:returntype",void 0)],eI.prototype,"logInteraction",null),MI([Object(L.a)(gI),II("design:type",Function),II("design:paramtypes",[Object,gI]),II("design:returntype",void 0)],eI.prototype,"logInteractionSuccess",null),MI([Object(L.a)(fI),II("design:type",Function),II("design:paramtypes",[Object]),II("design:returntype",void 0)],eI.prototype,"initView",null),MI([Object(L.a)(bI),II("design:type",Function),II("design:paramtypes",[Object]),II("design:returntype",void 0)],eI.prototype,"logInteractionChance",null),MI([Object(L.a)(mI),II("design:type",Function),II("design:paramtypes",[Object]),II("design:returntype",void 0)],eI.prototype,"logFirstInteraction",null),MI([Object(L.a)(vI),II("design:type",Function),II("design:paramtypes",[Object]),II("design:returntype",void 0)],eI.prototype,"resetFirstInteraction",null),MI([Object(L.e)(),II("design:type",Function),II("design:paramtypes",[PI]),II("design:returntype",void 0)],eI,"isAuthenticated",null),MI([Object(L.e)(),II("design:type",Function),II("design:paramtypes",[PI]),II("design:returntype",void 0)],eI,"isFirstInteractionLogged",null),eI=YM=MI([Object(L.f)({name:"modules",defaults:zI})],eI));function UI(e,t){var n=t.procName,i=t.actionFn,o=t.aliases,r=void 0===o?[]:o,a=t.mapFnIn,s=t.mapFnOut,c=t.hideDefinition,l=void 0!==c&&c,u=function(e){var t=this,n=a?a(e):e,o=i(n);if(void 0!==o)if(o instanceof J.a)o.subscribe((function(e){var n=s?s(e):e;t.setResult(n)}));else{var r=s?s(o):o;t.setResult(r)}};[n].concat(p(r)).forEach((function(t){var n=function(){return e.rpc.define(t,u)};l?e.rpc.hideDefinitions((function(){return n()})):n()}))}var DI=function(e){return e.AnnotationsCreate="annotations.create",e.AnnotationsDestroy="annotations.destroy",e.AnnotationsInfo="annotations.info",e.AnnotationsSetDescription="annotations.setDescription",e.AnnotationsSetLabelsShown="annotations.setLabelsShown",e.AnnotationsSetTitle="annotations.setTitle",e.AnnotationsUpdate="annotations.update",e.AnnotationsSetEnabled="annotations.setEnabled",e.CameraInfo="camera.info",e.CameraOrbit="camera.orbit",e.CameraPan="camera.pan",e.CameraReset="camera.reset",e.CameraSet="camera.set",e.CameraZoom="camera.zoom",e.setCameraMode="camera.setCameraMode",e.CameraDisableChapterCamera="camera.disableChapterCamera",e.CameraEnableChapterCamera="camera.enableChapterCamera",e.GetAnnotationInfo="annotations.info",e.HideAnnotations="annotations.hide",e.HotspotsCreate="hotspots.create",e.HotspotsDestroy="hotspots.destroy",e.HotspotsHide="hotspots.hide",e.HotspotsInfo="hotspots.info",e.HotspotsShow="hotspots.show",e.HotspotsTypes="hotspots.types",e.HotspotsUpdate="hotspots.update",e.HumanInfo="human.info",e.HumanCanvasInfo="human.canvasInfo",e.InputDisable="input.disable",e.InputEnable="input.enable",e.LabelsCreate="labels.create",e.LabelsDestroy="labels.destroy",e.LabelsInfo="labels.info",e.LabelsHide="labels.hide",e.LabelsSetEnabled="labels.setEnabled",e.LabelsShow="labels.show",e.LabelsUpdate="labels.update",e.LabelsCanvasUpdate="labels.canvasUpdate",e.LabelsSetScale="labels.setScale",e.NativeErrorMessage="native.errorMessage",e.NativeSetSdkOffline="native.setSdkOffline",e.NativeSetAppVersion="native.setAppVersion",e.NativeRedirect="native.redirect",e.NativeReload="native.reload",e.NativeOfflineModelIds="native.offlineModelIDs",e.QuizInfo="quiz.info",e.QuizEnter="quiz.enter",e.QuizExit="quiz.exit",e.QuizQuestion="quiz.currentQuestion",e.QuizSubmit="quiz.submit",e.QuizNextQuestion="quiz.next",e.QuizPreviousQuestion="quiz.previous",e.QuizSelectQuestion="quiz.select",e.QuizSet="quiz.set",e.QuizReset="quiz.reset",e.SceneMetaData="scene.metadata",e.SceneSetHighlightColor="scene.setHighlightColor",e.SceneColorObject="scene.colorObject",e.SceneDisableHighlight="scene.disableHighlight",e.SceneEnableHighlight="scene.enableHighlight",e.SceneGetColor="scene.getColor",e.SceneInfo="scene.info",e.SceneLoad="scene.load",e.ScenePick="scene.pick",e.SceneReset="scene.reset",e.SceneSelectObjects="scene.selectObjects",e.SceneShowObjects="scene.showObjects",e.SceneTransformObject="scene.transformObject",e.SceneUncolorObject="scene.uncolorObject",e.SceneSnapshot="scene.snapshot",e.SceneCapture="scene.capture",e.SceneRestore="scene.restore",e.SceneEnableXrayMode="scene.enableXray",e.SceneDisableXrayMode="scene.disableXray",e.SceneSetLayersSliderPosition="scene.setLayersSliderPosition",e.SceneGetLayers="scene.getLayers",e.SceneSetBaseDirectory="scene.setBaseDirectory",e.ShowAnnotations="annotations.show",e.SetAnnotationsShown="annotations.setShown",e.TimelineInfo="timeline.info",e.TimelineQuery="timeline.query",e.TimelineNext="timeline.nextChapter",e.TimelinePause="timeline.pause",e.TimelinePlay="timeline.play",e.TimelinePrev="timeline.previousChapter",e.TimelineSet="timeline.set",e.UIGetBackground="ui.getBackground",e.UIGetDisplay="ui.getDisplay",e.UIGetWorldPosition="ui.getWorldPosition",e.UISetBackground="ui.setBackground",e.UIPresetBackground="ui.presetBackground",e.UISetDisplay="ui.setDisplay",e.UIResetDisplay="ui.resetDisplay",e.UISnapshot="ui.snapshot",e.focusObject="focus.focusObject",e.dissectSetEnabled="dissect.setEnabled",e.pickSingleSetEnabled="pick.single.setEnabled",e.pickMultiSetEnabled="pick.multi.setEnabled",e.getCanvasPos="scene.getCanvasPos",e.sceneSetClickMode="scene.setClickMode",e.sceneGetClickMode="scene.getClickMode",e.IsolateObject="scene.isolateObject",e.UISetOndemand="ui.setOndemand",e.UISetLoadingExperience="ui.setLoadingExperience",e.UISetScrollCaptureMode="ui.setScrollCaptureMode",e.UISetTutorial="ui.setTutorial",e.UISetQuizLock="ui.setQuizLock",e}({});function LI(e){var t=e.captureCamera();return{position:t.lookAt.eye,target:t.lookAt.look,up:t.lookAt.up,zoom:t.zoom}}var EI,FI,AI=r("SxV6");function RI(e){if(!e)return null;var t=e.objectId,n=e.canvasPos,i=e.worldPos;return{objectId:t||void 0,canvasPosition:n?{x:n[0],y:n[1]}:void 0,mode:"query",position:i?{x:i[0],y:i[1],z:i[2]}:void 0}}function VI(e,t,n){var i=e.scene.objects[n].parent;return null!==i&&(t[i.objectId].checked||VI(e,t,i.objectId))}function NI(e,t){var n=t.includes("/")?M.Module:M.Bookmark;e.dispatch(new qe(t,n))}function BI(e,t){return e.dispatch(new kt(!0)),t.fireEvent(yn.SceneXrayEnabled,void 0),!0}function HI(e,t,n,i){e.rpc.defineEvent(t,{events:n||[t],map:i||function(e){return e}})}(EI||(EI={})).getCanvasPos=function(e,t,n,i,o){n&&Jn.a.add(t,n,t);var r=e.renderer.getViewMat(),a=e.renderer.getProjMat(),s=Jn.b.create();Jn.a.transformMat4(s,t,r),s[3]=1,Jn.b.transformMat4(s,s,a);var c=s[1],l=s[3];return[Math.round((1+s[0]/l)*i/2),Math.round((1-c/l)*o/2)]},function(e){e.isLegacyCaptureFormat=function(e){return void 0!==e.engineVersion},e.convertCaptureFormat=function(e){var t=Object.keys(e.objects).reduce((function(e,t){return e.push({objectId:t,selected:!1,hidden:!1}),e}),[]);return{storyId:e.timeline.rootName.replace(".json",""),camera:{lookAt:e.camera,zoom:void 0},labels:[],objects:t,background:[],activeChapterId:e.timeline.scrub?e.timeline.scrub.chapterId:void 0}},e.convertMediaFormat=function(e){var t={};return Object.entries(e).forEach((function(e){var n=d(e,2),i=n[0],o=n[1];t[i]={fullUrl:o.data.fullUrl,lang:o.data.lang,streamType:o.data.streamType}})),t}}(FI||(FI={}));var QI=r("I65S");function qI(e){return bn.getColors(e).map((function(e){return e[255]}))}function $I(e,t){var n,i=e.selectSnapshot(vs.getSelectedChapterBackground),o=i.colors,r=i.colorStops,a=i.gradientType,s=t.colors?(n=[]).concat.apply(n,p(t.colors)):o;return new Ki(s,t.gradientType||a,t.colorStops||r)}function WI(e){return e.selectSnapshot(kc.getChapterLabels)}function KI(e,t){return function(e,t){return e.find((function(e){return t===e.id}))}(WI(e),t)}function GI(e,t){var n=function(e,t){return e.scene.markers.markers[t]}(e,t.id);return{annotationId:t.id,objectId:t.objectId||null,title:t.title,description:t.description,shown:t.shown,occludable:t.occludable,position:n?{x:n.pos[0],y:n.pos[1],z:n.pos[2]}:null,canvasPosition:n?{x:n.canvasPos[0],y:n.canvasPos[1]}:null}}function ZI(e,t){var n=KI(e,t.annotationId);return n?Object.assign(Object.assign({},n),t):null}function JI(e,t){return t&&e.dispatch(new oa(t)),!0}function XI(e,t){return e.dispatch(new da(t)),!0}function YI(e,t){return e.reduce((function(e,n){return Object.assign(Object.assign({},e),c({},""+n,t))}),{})}function ez(e,t){return function(e,n){return Object.entries(e).filter((function(e){var n=d(e,2);n[0];return function(e,n){return n===t}(0,n[1])})).reduce((function(e,t){var n=d(t,2),i=n[0],o=n[1];return Object.assign(Object.assign({},e),c({},""+i,o))}),{})}(e)}function tz(e,t){return Object.keys(ez(e,t))}function nz(e,t,n){return function(e,t){return e.filter((function(e){return t.includes(e.id)}))}(e,tz(t,n))}function iz(e,t,n){var i,o=tz(t,n).map((function(t){return function(e){for(var t,n=arguments.length,i=new Array(n>1?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];var r,a,s=i.map((function(t){return e.filter((function(e){return t===e.objectId}))}));return r=(t=[]).concat.apply(t,p(s)),a=new Set(r),Array.from(a.values())}(e,t)})).map((function(e){return e.map((function(e){return e.id}))}));return YI((i=[]).concat.apply(i,p(o)),n)}var oz={};function rz(e,t){t.hasOwnProperty("data")&&(t[e]=t.data)}var az={hotspotSeedId:0,hotspotIdMap:new Map,getHotspotMap:function(e){var t=az.hotspotIdMap,n=az.createHotspotId;return e.selectSnapshot(kc.getLabels).forEach((function(e){var i=e.id;void 0===t.get(i)&&n(i)})),t},createHotspotId:function(e){return az.hotspotSeedId++,az.hotspotIdMap.set(e,az.hotspotSeedId),az.hotspotSeedId},getHotspotIdByLabel:function(e,t,n){var i=az.getHotspotMap,o=az.createHotspotId,r=i(e).get(t);return n&&void 0===r?o(t):r},getLabelIdByHotspotId:function(e,t){var n=az.getHotspotMap(e),i=Array.from(n).find((function(e){var n=d(e,2);n[0];return n[1]===t}));return i?i[0]:null}};function sz(e,t){var n=e.selectSnapshot(kc.getLabels);return void 0!==t?n.filter((function(e){return e.chapterId===t})):n}function cz(e,t){var n=sz(e),i=az.getLabelIdByHotspotId(e,t);return n.find((function(e){return e.id===i}))}function lz(e){return e===so.CirclePlus?Ai.Plus:e===so.CircleMinus?Ai.Minus:Ai.Default}function pz(e,t){return az.getHotspotIdByLabel(e,t)}function uz(e,t){return Object.assign(Object.assign({},t),{id:pz(e,t.id)})}function dz(e,t,n){var i=t.selectSnapshot(vs.getStoryChapters);return n.map((function(n){return function(e,t,n,i){var o,r=i.id,a=i.chapterId,s=i.title,c=i.objectId,l=n.findIndex((function(e){return a===e.id})),p=az.getHotspotIdByLabel(t,r,!0),u=function(e,t){return e.scene.markers.markers[t]}(e,r);return{id:p,title:s,objectId:c,position:u?gz(u.pos):null,direction:u?gz(u.dir):null,canvasPosition:u?(o=u.canvasPos,{x:o[0],y:o[1]}):null,chapterScope:l,type:i.pinType===Ai.PlusMinus?so.CirclePlus:so.Circle,shown:i.shown,data:oz[i.id]}}(e,t,i,n)}))}function gz(e){return{x:e[0],y:e[1],z:e[2]}}function hz(e){return[e.x,e.y,e.z]}function fz(e,t,n){return e.dispatch(new ua(t,n)),!0}function bz(e,t){if("number"==typeof t){var n=cz(e,t);return n?[n]:[]}return sz(e)}function mz(e){return e.selectSnapshot(kc.getChapterLabels)}function vz(e,t){return e.dispatch(new da(t)),!0}function yz(e,t){return mz(e).find((function(e){return t===e.id}))}function xz(e,t){return mz(e).filter((function(e){return t.includes(e.id)}))}function Oz(e,t,n){return t&&t.objectId?(e.dispatch(n?new Xr(t):new oa(t)),t):null}function wz(e,t){var n=document.createElement("span");return n.innerHTML=e,Object(ie.trim)(n.textContent).length<=t}function kz(e,t,n){var i=e;return i.title=t.title&&wz(t.title,100)?t.title:i.title,i.description=t.description&&wz(t.description,300)?t.description:i.description,i.theme=t.theme||i.theme,i.pinType=t.pinType||i.pinType,i.sequentialType=t.sequentialType||i.sequentialType,i.offset=function(e,t){return t||[-(e.hideWire?20:32),0]}(i,t.labelOffset),i.pinGlow=void 0!==t.pinGlow?t.pinGlow:i.pinGlow,i.hideWire=void 0!==t.hideWire?t.hideWire:i.hideWire,i.hideTag=void 0!==t.hideTag?t.hideTag:i.hideTag,i.collapseDescription=void 0!==t.collapseDescription?t.collapseDescription:i.collapseDescription,i.occludable=void 0!==t.occludable?t.occludable:i.occludable,i.cameraPosition=t.flyToCamera||i.cameraPosition,i.flyTo=function(e,t){return!1!==t&&(t||e.flyTo)}(i,t.flyTo),i.states=function(e){if(!e.flyTo)return[];var t=[new io,new io];t[0].errands=[new co],t[1].errands=e.cameraPosition?[new ao(e.cameraPosition)]:[new ro(e.objectId)]}(i),i}function Cz(e,t){if(t){var n=e.scene.markers.markers[t.id];return{labelId:t.id,objectId:t.objectId,title:t.title,description:t.description,theme:t.theme,pinType:t.pinType,labelOffset:t.offset,hideWire:t.hideWire,pinGlow:t.pinGlow,occludable:t.occludable,sequentialType:t.sequentialType,shown:t.shown,collapseDescription:t.collapseDescription,hideTag:t.hideTag,flyTo:!0===t.flyTo,flyToCamera:t.cameraPosition,position:n?[n.pos[0],n.pos[1],n.pos[2]]:t.pos,canvasPosition:n?[n.canvasPos[0],n.canvasPos[1]]:[-1,-1],occluded:!n||n.occluded}}return null}function Sz(e,t){return t.reduce((function(t,n){return t[n.id]=Cz(e,n),t}),{})}function _z(e){return e.selectSnapshot(rr.getAllQuestions)}function jz(e,t){return _z(e).find((function(e){return e.id===t}))}function Pz(e){return jz(e,Uz(e))}function Mz(e){return{enabled:e.selectSnapshot(rr.getQuizEnabled),active:e.selectSnapshot(rr.getQuizModeActive),questions:(t=_z(e),i=t.map((function(e){return Ez(e)})),void 0!==n?i.filter((function(e){return n.includes(e.questionId)})):i),questionId:Uz(e),submissions:Iz(e,Tz(e))};var t,n,i}function Iz(e,t){return t.map((function(t){return zz(e,t)}))}function zz(e,t){var n=Pz(e);return{questionId:t.questionId,answerIds:n.data.correctAnswer,correctAnswerIds:Fz(n),correct:qo(n,t.answer)}}function Tz(e){return e.selectSnapshot(rr.getAllSubmissions)}function Uz(e){return e.selectSnapshot(rr.getActiveQuestionId)}function Dz(e){var t=Pz(e),n=function(e){return Tz(e).find((function(t){return t.questionId===Uz(e)}))}(e);return{question:Ez(t),submission:n?zz(e,n):void 0}}function Lz(e){return e.map((function(e){return function(e){var t=e.type;switch(t){case Vo.Markdown:return{type:t,content:e.markdown};case Vo.Images:return{type:t,content:e.images.map((function(e){return e.urls.default}))};default:return{type:t,content:""}}}(e)}))}function Ez(e){var t=[],n="";switch(e.type){case No.MultipleChoice:var i=e.data;t=i.options.map((function(e){return function(e){return{answerId:e.value,displayText:e.label}}(e)})),n=i.correctAnswer;break;case No.SelectAnatomy:t=e.data.correctAnswer.map((function(e){return{answerId:e,displayText:e}})),n="";break;case No.LabelAnatomy:t=e.data.options.map((function(e){return{answerId:e.value,displayText:e.label.title}})),n=""}return{questionId:e.id,questionType:e.type,questionPrompt:Lz(e.questionPrompt),answerExplanation:Lz(e.explanation),answers:t,answerId:n}}function Fz(e){var t=Ez(e);switch(t.questionType){case No.LabelAnatomy:case No.SelectAnatomy:return t.answers.map((function(e){return e.answerId}));case No.Instructions:return["-"];default:return[t.answerId]}}var Az,Rz,Vz,Nz=((Rz=function(){function e(t,n,i,o,r,a,s,c,l,p,u,d){y(this,e),this.store=t,this.actions=n,this.cameraService=i,this.engineService=o,this.animationService=r,this.paintService=a,this.labelsService=s,this.graphService=c,this.viewService=l,this.analyticsService=p,this.visibilityLayersService=u,this.quizService=d,this.webGLInfo=SceneJS.WEBGL_INFO}return v(e,[{key:"listen",value:function(e){this.initProcedures(),this.initEvents(),e&&this.logAPIUsage()}},{key:"logAPIUsage",value:function(){var e=this;setInterval((function(){var t=Human.rpc.getLog(),n=Object(ie.uniqBy)(t,(function(e){return e.identifier}));if(n.length>0){var i=JSON.stringify(n),o=e.analyticsService.buildDeveloperAnalytic(jI.Call,yI.WidgetAPI,i);e.analyticsService.sendAnalytic(o).subscribe({next:function(e){},error:function(e){throw new Error(e)}}),Human.rpc.resetLog()}}),1e4)}},{key:"initEvents",value:function(){var e,t;HI(Human,yn.HumanProgress,void 0,(function(e){return e})),(e=this.store,[{eventName:yn.HumanReady,aliasEvents:[yn.HumanStarted]},{eventName:yn.Error,aliasEvents:[yn.HumanError],mapFn:function(e){return e}},{eventName:yn.HumanCanvasResized,aliasEvents:[yn.CanvasResized],mapFn:function(){return e.selectSnapshot(zs.getEnginePosition)}}]).forEach((function(e){HI(Human,e.eventName,e.aliasEvents,e.mapFn)})),[{eventName:yn.SceneLoaded,mapFn:function(e){return e}},{eventName:yn.ScenePicked,aliasEvents:[yn.PickPicked],mapFn:RI},{eventName:yn.SceneObjectsSelected,mapFn:function(e){return e.selectedObjectsUpdate}},{eventName:yn.SceneObjectsShown,mapFn:function(e){return e.enabledObjectsUpdate}},{eventName:yn.SceneReady,aliasEvents:[yn.Started]},{eventName:yn.SceneRestored,mapFn:function(){return!0}},{eventName:yn.SceneXrayEnabled,mapFn:function(){return!0}},{eventName:yn.SceneXrayDisabled,mapFn:function(){return!0}},{eventName:yn.NativeShare,mapFn:function(e){return e}},{eventName:yn.NativeDebugMessage,mapFn:function(e){return e}}].forEach((function(e){HI(Human,e.eventName,e.aliasEvents,e.mapFn)})),(t=this.cameraService,[{eventName:yn.CameraUpdated,aliasEvents:[yn.CameraRested],mapFn:function(){return LI(t)}}]).forEach((function(e){HI(Human,e.eventName,e.aliasEvents,e.mapFn)})),[{eventName:yn.TimelinePlaying,mapFn:function(e){return e}},{eventName:yn.TimelineCompleted,mapFn:function(e){return!0}},{eventName:yn.TimelineChapterTransition,aliasEvents:[yn.TimelineChaptersActivated],mapFn:function(e){return{previousChapter:e.oldChapterIndex,currentChapter:e.newChapterIndex,time:e.time}}}].forEach((function(e){HI(Human,e.eventName,e.aliasEvents,e.mapFn)})),[].forEach((function(e){HI(Human,e.eventName,e.aliasEvents,e.mapFn)})),[].forEach((function(e){HI(Human,e.eventName,e.aliasEvents,e.mapFn)})),function(e,t){return[].concat(p(function(e,t){return[{eventName:yn.AnnotationsCreated,aliasEvents:[yn.LabelsCreated],mapFn:function(t){return GI(e,t)}},{eventName:yn.AnnotationsDestroyed,aliasEvents:[yn.LabelsDestroyed],mapFn:function(e){return{annotationId:e.id}}},{eventName:yn.AnnotationsShown,aliasEvents:[yn.LabelsEnabled],mapFn:function(){return!0}},{eventName:yn.AnnotationsHidden,aliasEvents:[yn.LabelsDisabled],mapFn:function(){return!0}}]}(e)),p(function(e,t){return[{eventName:yn.HotspotsEntered,mapFn:function(e){return uz(t,e)}},{eventName:yn.HotspotsLeft,mapFn:function(e){return uz(t,e)}},{eventName:yn.HotspotsPicked,mapFn:function(e){return uz(t,e)}},{eventName:yn.HotspotsDisplayUpdated,mapFn:function(e){return uz(t,e)}},{eventName:yn.HotspotsPositionUpdated,mapFn:function(e){return function(e,t){var n=t.id,i=t.canvasPos,o=i.x,r=i.y;return{id:pz(e,n),canvasPosition:{x:o,y:r,0:o,1:r},occluded:t.occluded}}(t,e)}}]}(0,t)),[{eventName:yn.LabelsChapterInfo,mapFn:function(t){return Sz(e,t)}},{eventName:yn.LabelsCreated,mapFn:function(t){return Cz(e,t)}},{eventName:yn.LabelsUpdated,mapFn:function(t){return Cz(e,t)}},{eventName:yn.LabelsDestroyed,mapFn:function(e){return{labelId:e.id}}},{eventName:yn.LabelsEntered,mapFn:function(e){return e}},{eventName:yn.LabelsLeft,mapFn:function(e){return e}},{eventName:yn.LabelsPicked,mapFn:function(e){return e}},{eventName:yn.LabelsMoved,mapFn:function(e){return e}},{eventName:yn.LabelsEnabled,mapFn:function(){return!0}},{eventName:yn.LabelsDisabled,mapFn:function(){return!0}},{eventName:yn.LabelsShown,mapFn:function(e){return e}},{eventName:yn.LabelsHidden,mapFn:function(e){return e}}])}(Human,this.store).forEach((function(e){HI(Human,e.eventName,e.aliasEvents,e.mapFn)})),function(e){return[{eventName:yn.QuizEntered,mapFn:function(){return Mz(e)}},{eventName:yn.QuizExited,mapFn:function(){return!0}},{eventName:yn.QuizQuestionLoaded,mapFn:function(e){return e}},{eventName:yn.QuizAnswerSelected,mapFn:function(t){return{questionId:t.questionId,answerId:t.answerId,correctAnswerIds:Fz(jz(e,t.questionId))}}},{eventName:yn.QuizAnswerSubmitted,mapFn:function(t){var n=jz(e,t.questionId),i=Fz(n);return{questionId:t.questionId,answerIds:t.answer,correctAnswerIds:i,correct:qo(n,t.answer)}}},{eventName:yn.QuizCompleted,mapFn:function(){return $o(_z(e),Tz(e))}}]}(this.store).forEach((function(e){HI(Human,e.eventName,e.aliasEvents,e.mapFn)}))}},{key:"initProcedures",value:function(){var e,t,n;(e=Human,t=this.webGLInfo,n=this.store,[{procName:DI.HumanInfo,actionFn:function(){return{version:e.VERSION,webglInfo:t,apiFunctions:e.rpc.getProcedures().sort(),apiEvents:e.rpc.getEvents().sort()}}},{procName:DI.HumanCanvasInfo,actionFn:function(){return n.selectSnapshot(zs.getEnginePosition)}}]).forEach((function(e){UI(Human,e)})),function(e,t,n,i,o,r,a,s,u){return[{procName:DI.SceneMetaData,actionFn:function(){var e=t.selectSnapshot(Ic.getStory),n=t.selectSnapshot(vs.getStoryChapters);return{title:e.displayName,description:e.description,chapters:n.map((function(e){return{id:e.id,title:e.info.displayName,description:e.info.description,isAnimated:a.isChapterAnimated(e),loops:a.isChapterLooped(e),duration:a.getChapterLocalTimerange(e.id),media:FI.convertMediaFormat(e.media),images:e.contentBlocks?(t=e.contentBlocks,o=t.find((function(e){return e.type==Vo.Images})),null!==(i=null===(n=null==o?void 0:o.images)||void 0===n?void 0:n.filter((function(e){var t;return null!=(null===(t=e.urls)||void 0===t?void 0:t.default)})).map((function(e){return e.urls.default})))&&void 0!==i?i:[]):[],thumbnail:e.thumbnails?e.thumbnails.default:""};var t,n,i,o}))}}},{procName:DI.focusObject,actionFn:function(e){return function(e,t,n){e.select&&e.xray?BI(t,n):Xp(t,n),e.select&&t.dispatch(new Yi.UpdateNodesChecked(!0,[e.objectId])),t.dispatch(new Pt(e.objectId,!0,1))}(e,t,n),!0},hideDefinition:!0},{procName:DI.dissectSetEnabled,actionFn:function(e){return t.dispatch(new Et(e.enable?ks.Hide:ks.Select)),!0},hideDefinition:!0},{procName:DI.sceneSetClickMode,actionFn:function(e){return t.dispatch(new Et("select"===e?ks.Select:"hide"===e?ks.Hide:"fade"===e?ks.Fade:ks.Select)),!0}},{procName:DI.sceneGetClickMode,actionFn:function(){return t.selectSnapshot(zs.getActiveTool)}},{procName:DI.pickSingleSetEnabled,actionFn:function(e){var n=function(){switch(e.enable){case void 0:return!t.selectSnapshot(hs.getMultiPickModeEnabled);case!0:return!1;case!1:return!0}}();return t.dispatch(new _.SetMultiPickModeEnabled(n)),!0},hideDefinition:!0},{procName:DI.pickMultiSetEnabled,actionFn:function(e){var n=function(){switch(e.enable){case void 0:return!t.selectSnapshot(hs.getMultiPickModeEnabled);default:return e.enable}}();return t.dispatch(new _.SetMultiPickModeEnabled(n)),!0},hideDefinition:!0},{procName:DI.getCanvasPos,actionFn:function(t){var i=n.getCanvas();return EI.getCanvasPos(e,t.worldPos,t.offset,i.width,i.height)},hideDefinition:!0},{procName:DI.SceneCapture,actionFn:function(){return function(e,t,n){var i=n.captureCamera(),o=t.selectSnapshot(jo.getNodes),r=Object.keys(o).map((function(t){return{objectId:t,selected:o[t].checked||VI(e,o,t),hidden:!o[t].shown}})),a=t.selectSnapshot(vs.getStoryChapters).map((function(e){return{chapterId:e.id,background:e.background||sr}})),s=t.selectSnapshot(Ic.getStoryId);return{camera:i,labels:t.selectSnapshot(kc.getLabels),storyId:s,objects:r,background:a,activeChapterId:t.selectSnapshot(vs.getSelectedChapterId)}}(e,t,o)}},{procName:DI.SceneRestore,actionFn:function(i){var o=FI.isLegacyCaptureFormat(i),r=o?FI.convertCaptureFormat(i):i;return function(e,t,n,i,o){return new J.a((function(r){i.getEvent(yn.HumanStarted).pipe(Object(AI.a)()).subscribe((function(){(function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return new Promise((function(o){n.selectSnapshot(zs.getViewGraph);var r=t.objects.filter((function(e){return!0===e.selected})).map((function(e){return e.objectId})),a=i?e.scene.getLeaves().filter((function(e){return void 0===t.objects.find((function(t){return t.objectId===e}))})):t.objects.filter((function(e){return!0===e.hidden})).map((function(e){return e.objectId})),s=t.background.map((function(e){return new ki(e.chapterId,e.background)})),c=t.activeChapterId?[new ci(t.activeChapterId)]:[],l=void 0!==t.camera.zoom?[new Fn(t.camera.zoom)]:[];setTimeout((function(){n.dispatch([new zn(t.camera.lookAt,!1),new Jr(t.labels),new Yi.UpdateNodesShown(!1,a),new Yi.UpdateNodesChecked(!0,r)].concat(l,c,p(s))),o(void 0)}))}))})(e,t,n,o).then((function(){i.fireEvent(yn.SceneRestored,void 0),r.next(!0),r.complete()}))})),NI(n,t.storyId)}))}(e,r,t,n,o)}},{procName:DI.SceneEnableXrayMode,actionFn:function(){return BI(t,n)}},{procName:DI.SceneDisableXrayMode,actionFn:function(){return Xp(t,n)}},{procName:DI.SceneLoad,actionFn:function(e){return NI(t,e),t.dispatch(new vI),!0}},{procName:DI.SceneSetBaseDirectory,actionFn:function(t){return e.events.fire("scene.setBaseDirectory",t),!0}},{procName:DI.NativeSetSdkOffline,actionFn:function(t){return e.events.fire("native.setSdkOffline",t),!0}},{procName:DI.SceneReset,actionFn:function(){return s.resetChapter(),!0}},{procName:DI.SceneInfo,actionFn:function(n){var i=n&&n.objectId?[n.objectId]:Object.keys(e.scene.objects),o=t.selectSnapshot(Ic.getStory).displayName;return function(e,t,n,i){var o=i.selectSnapshot(jo.getNodes);return{name:t,objects:n.reduce((function(t,n){return t[n]=function(t){var n=e.scene.objects[t],i=n.isLeaf()?o[t].checked||VI(e,o,t):void 0;return{objectId:n.objectId,name:n.displayName,description:n.description||"",shown:n.shown,selected:i,children:n.objects.map((function(e){return e.objectId})),parent:n.parent?n.parent.objectId:null}}(n),t}),{})}}(e,o,i,t)}},{procName:DI.ScenePick,actionFn:function(e){return RI(n.pickScene({x:e.x,y:e.y,rayPick:!0}))}},{procName:DI.SceneSelectObjects,actionFn:function(e){var n=!0===e.replace,i=e;return delete i.replace,n&&t.dispatch(new Yi.UpdateNodesChecked(!1)),t.dispatch(new Yi.UpdateNodesChecked(!1,[],i)),!0}},{procName:DI.SceneShowObjects,actionFn:function(n){delete n.replace;var i=Object.entries(n).reduce((function(t,i){var o=d(i,2),r=o[0],a=o[1];return Object.assign(Object.assign({},t),function t(i,o){var r,a=e.scene.objects[i].objects,s=c({},i,o),p=l(a);try{for(p.s();!(r=p.n()).done;){var u=r.value;void 0!==n[u.objectId]||(s[u.objectId]=o,s=Object.assign(Object.assign({},s),t(u.objectId,o)))}}catch(d){p.e(d)}finally{p.f()}return s}(r,a))}),{});return t.dispatch(new Yi.UpdateNodesShown(!1,[],i)),!0}},{procName:DI.IsolateObject,actionFn:function(e){var n="string"==typeof e?[e]:e,i=t.selectSnapshot(zs.getViewGraph),o=r.getInverseSelection(i,n),a=r.getNodes(i,o);return t.dispatch(new Yi.UpdateNodesShown(!1,a.map((function(e){return e.id})))),!0}},{procName:DI.SceneTransformObject,actionFn:function(e){return n.transformObject(e.objectId,e),!0}},{procName:DI.SceneColorObject,actionFn:function(e){var n=e.objectId,i=e.tintColor,o=e.saturation,r=e.contrast,a=e.brightness,s=e.opacity;return t.dispatch(new Yi.UpdateNodesPaint(ko.fromEngine({tintColor:i,saturation:o,contrast:r,brightness:a,opacity:s}),[n])),!0}},{procName:DI.SceneGetColor,actionFn:function(e){var n=t.selectSnapshot(jo.getNodePaint)(e.objectId);return ko.toEngine(n)}},{procName:DI.SceneUncolorObject,actionFn:function(e){return t.dispatch(new Yi.UpdateNodesPaint(Po,[e.objectId])),!0}},{procName:DI.SceneDisableHighlight,actionFn:function(){return i.disableHighlight(),!0}},{procName:DI.SceneEnableHighlight,actionFn:function(){return i.enableHighlight(),!0}},{procName:DI.SceneSetHighlightColor,actionFn:function(e){return i.setHighlightColor(e),!0}},{procName:DI.SceneSetLayersSliderPosition,actionFn:function(e){var t=Math.min(1,Math.max(e.position,0)),n=u.fractionToIndex(t),i=u.fractionToPosition(t,n);return e.record?u.recordLayerIndexPosition(n,i):u.synchronizeScene(n,i,!1),!0}},{procName:DI.SceneGetLayers,actionFn:function(){return t.selectSnapshot(vs.getAllChaptersCurrentLayers)}}]}(Human,this.store,this.engineService,this.paintService,this.cameraService,this.graphService,this.animationService,this.viewService,this.visibilityLayersService).forEach((function(e){UI(Human,e)})),function(e,t){return[{procName:DI.CameraInfo,actionFn:function(){return LI(t)}},{procName:DI.CameraOrbit,actionFn:function(t){return e.dispatch(new Hn(void 0===t.pitch?0:t.pitch,void 0===t.yaw?0:t.yaw)),!0}},{procName:DI.CameraPan,actionFn:function(t){return e.dispatch(new Vn(void 0===t.x?0:t.x,void 0===t.y?0:t.y,void 0===t.z?0:t.z)),!0}},{procName:DI.CameraReset,actionFn:function(){return e.dispatch(new Ln)}},{procName:DI.CameraSet,actionFn:function(n){var i=n.animate||!1;if(n.objectId)return e.dispatch(new Pt(n.objectId,i,n.animationDuration)),!0;var o=LI(t);return e.dispatch(new zn({eye:n.position||o.position,look:n.target||o.target,up:n.up||o.up},i)),!0}},{procName:DI.CameraZoom,actionFn:function(t){return e.dispatch(new Fn(t||0)),!0}},{procName:DI.setCameraMode,actionFn:function(t){return e.dispatch(new Qn("pan"===t?"pan":"rotate")),!0}},{procName:DI.CameraDisableChapterCamera,actionFn:function(){return e.dispatch(new Un(!1)),!0}},{procName:DI.CameraEnableChapterCamera,actionFn:function(){return e.dispatch(new Un(!0)),!0}}]}(this.store,this.cameraService).forEach((function(e){UI(Human,e)})),function(e,t,n,i){return[{procName:DI.TimelineQuery,actionFn:function(){return{chapters:e.selectSnapshot(vs.getStoryChapters).map((function(e){var t=e.info;return{description:t.description,displayName:t.displayName,annotations:e.labels.map((function(e){return{title:e.title,description:e.description}}))}}))}},hideDefinition:!0},{procName:DI.TimelineInfo,actionFn:function(){return function(e,t){var n=t.getTimeFrame();return{time:t.getTime(),startTime:n.firstTime,endTime:n.lastTime,chapters:e.selectSnapshot(vs.getStoryChapters).map((function(e){return e.id})),playing:t.isPlaying()}}(e,n)}},{procName:DI.TimelinePlay,actionFn:function(i){var o=i.loop||!1;if(void 0===i.time&&void 0===i.chapterId){var r=e.selectSnapshot(vs.getSelectedChapterId);return n.play({numChapters:1,loop:o,queue:!1,startChapterId:r}),!0}var a=Math.max(0,i.time),s=n.getTimeFrame().lastTime,c=Math.min(a,s-.001);return new J.a((function(r){t.pipe(Object(L.i)(ci),Object(Tc.a)(1)).subscribe((function(){n.play(Object.assign(Object.assign({},{numChapters:1,queue:!1,loop:o}),void 0!==i.time?{startTime:c}:{startChapterId:i.chapterId})),r.next(!0),r.complete()}));var a=i.chapterId?i.chapterId:n.mapGlobalTimeToLocal(c,{tie:"later"}).branch.id;e.dispatch(new ci(a))}))}},{procName:DI.TimelinePause,actionFn:function(){return n.pause(),!0}},{procName:DI.TimelineSet,actionFn:function(i){if(void 0===i.time&&void 0===i.chapterId)return!0;if(void 0!==i.chapterId)return e.dispatch(new ci(i.chapterId)),!0;var o=Math.max(0,i.time),r=n.getTimeFrame().lastTime,a=Math.min(o,r);return new J.a((function(i){t.pipe(Object(L.i)(ci),Object(Tc.a)(1)).subscribe((function(){n.scrub({time:a,which:0===a?"second":"first"}),i.next(!0),i.complete()}));var o=n.mapGlobalTimeToLocal(a,0===a?{tie:"later"}:{});e.dispatch(new ci(o.branch.id))}))}},{procName:DI.TimelineNext,actionFn:function(){return i.nextChapter("API"),!0}},{procName:DI.TimelinePrev,actionFn:function(){return i.previousChapter("API"),!0}}]}(this.store,this.actions,this.animationService,this.viewService).forEach((function(e){UI(Human,e)})),function(e){return[{procName:DI.InputEnable,actionFn:function(){return e.dispatch(new R(!0)),!0}},{procName:DI.InputDisable,actionFn:function(){return e.dispatch(new R(!1)),!0}}]}(this.store).forEach((function(e){UI(Human,e)})),function(e,t,n,i,o){var r=new kp.a(!1);return n.pipe(Object(L.i)(li)).subscribe((function(){r.next(!0)})),[{procName:DI.UIGetBackground,actionFn:function(){return e=t.selectSnapshot(vs.getSelectedChapterBackground),n=e.colors,i=e.gradientType,o=e.colorStops,{colors:[[n[0],n[1],n[2],n[3]],[n[4],n[5],n[6],n[7]]],gradientType:i,colorStops:o};var e,n,i,o}},{procName:DI.UISetBackground,mapFnIn:function(e){var t=e.colors,n=e.colorStops,i=e.gradientType;return{colors:t?qI(t):t,gradientType:i,colorStops:n}},actionFn:function(e){if(e){var n=$I(t,e);t.dispatch(new _i(n))}return!0}},{procName:DI.UIPresetBackground,mapFnIn:function(e){var t=e.colors,n=e.colorStops,i=e.gradientType;return{colors:t?qI(t):t,gradientType:i,colorStops:n}},actionFn:function(e){if(e){var n=$I(t,e);T.platform===z.SDK&&r.next(!1),r.pipe(Object(Y.a)((function(e){return!!e})),Object(Tc.a)(1)).subscribe((function(){t.dispatch(new Ci(n))}))}return!0}},{procName:DI.UIGetWorldPosition,actionFn:function(t){var n=e.renderer.pick.pick(t.x,t.y,{rayPick:!0}).worldPos;return n?{x:n[0],y:n[1],z:n[2]}:null}},{procName:DI.UISetOndemand,actionFn:function(e){return t.dispatch([new _.ToggleWindow(Ea.OnDemand,e.enabled)]),!0}},{procName:DI.UISetLoadingExperience,actionFn:function(e){return Object(ie.isEmpty)(e)?t.dispatch(new _.CloseWindow(Ea.Interact)):t.dispatch([new _.SetInteractType(e),new _.OpenWindow(Ea.Interact)]),!0}},{procName:DI.UISetScrollCaptureMode,actionFn:function(e){return t.dispatch(new bt(e)),!0}},{procName:DI.UISetTutorial,actionFn:function(e){return t.dispatch([new _.ToggleWindow(Ea.Tutorial,e.enabled),new _.StartTutorial(e.enabled)]),!0}},{procName:DI.UIGetDisplay,actionFn:function(){var e=t.selectSnapshot(hs.getUI);return{audio:e.audio.enable,fullscreen:e.fullscreen.enable,help:e.help.enable,nav:e.camera.enable,cameraMode:e.camera.enable,center:e.camera.enable,zoomIn:e.camera.enable,zoomOut:e.camera.enable,info:e.column.enable||e.drawer.enable,playPause:e.media.enable,scrubber:e.media.enable,"scrubber.chapters":e.media.enable,tools:e.tools.enable,"tools-display":e.tools.enable,tour:e.pagination.enable,"tour.chapters":e.pagination.enable,objectTree:e.search.enable,anatomyLabels:e.anatomyLabels.enable,share:!1,dissect:!1,xray:!1,annotations:!1,crossSection:!1,isolate:!1}}},{procName:DI.UISetDisplay,actionFn:function(e){var n=function(e){var t,n=null!=e.all?np(e.all):new Zl;return ip((c(t={all:e.all},nl.Loader,ep(e.loader)),c(t,nl.Help,Xl(e.help,e.help)),c(t,nl.Tools,Xl(e.tools,e.tools)),c(t,nl.Layout,e.layout),c(t,nl.Toolbar,e.toolbar),c(t,nl.Fullscreen,Xl(e.fullscreen,e.fullscreen)),c(t,nl.Search,Xl(e.objectTree,e.search)),c(t,nl.Audio,e.audio),c(t,nl.Media,Yl(e.playPause,Xl(e.scrubber,e["scrubber.chapters"]),e.media)),c(t,nl.Camera,Xl(e.nav,e.cameraMode,e.center,e.zoomIn,e.zoomOut,e.nav)),c(t,nl.Pagination,Xl(e.tour,e["tour.chapters"])),c(t,nl.Column,Xl(e.info,e.info)),c(t,nl.Drawer,Xl(e.info,e.info)),c(t,nl.TitleOnly,Xl(e.info,e.info)),c(t,nl.LabelList,Xl(e.labelList,e.labelList)),c(t,nl.NodeInfo,e.anatomyDescriptions),c(t,nl.Legend,e.legend),c(t,nl.Menu,e.menu),c(t,nl.InternetExplorerWarning,void 0),c(t,nl.Logo,e.logo),c(t,nl.Labels,void 0),c(t,nl.Presenter,void 0),c(t,"logoIsHyperLink",void 0),c(t,"drawerExpandedInitially",void 0),c(t,nl.Tutorial,void 0),c(t,nl.AnatomyLabels,Xl(e.anatomyLabels,e.anatomyLabels)),c(t,nl.Undo,Xl(e.reset,e.undo)),c(t,nl.Whiteboard,e.whiteboard),c(t,nl.VisibilityLayers,e.visibilityLayers),c(t,nl.ContextActions,e.contextActions),c(t,nl.ToggleLabels,void 0),t),n)}(e);return t.dispatch(new V(n)),e}},{procName:DI.UIResetDisplay,actionFn:function(){var e=t.selectSnapshot(hs.getInitialUI);t.dispatch(new _.SetUI(e))}},{procName:DI.UISetQuizLock,actionFn:function(e){return n.pipe(Object(L.j)(lt),Object(Tc.a)(1)).subscribe((function(){t.dispatch(new Eo.SetQuizLocked(e)),t.dispatch(new Eo.SetEnableQuizRetake(e)),!0===e&&o.startQuiz()})),!0}},{procName:DI.UISnapshot,aliases:[DI.SceneSnapshot],mapFnIn:function(e){var t=i.getCanvas(),n=t.width,o=t.height;return Object.assign({width:n,height:o,openInTab:!1,fileType:"jpeg",quality:.92},e)},actionFn:function(e){var i=e.width,o=e.height,r=e.openInTab,a=e.fileType,s=t.selectSnapshot(vs.getSelectedChapterId),c={width:i,height:o},l="jpeg"===a?cr.JPEG:cr.PNG,p=t.selectSnapshot(vs.getSelectedChapterBackground);return t.dispatch(new pr(s,p,l,.92,c,"original",!0,!0)).pipe(Object(vr.a)((function(){return n.pipe(Object(L.j)(ur),Object(Tc.a)(1))})),Object(vr.a)((function(e){return hr.blobToBase64(e.blob)})),Object(ei.a)((function(e){r&&e&&function(e){var t=window.open("","_blank");if(t){var n=t.document.createElement("img");n.src=e,t.document.body.appendChild(n)}}(e)})),Object(xr.a)((function(){return Object(QI.of)(null)})))}}]}(Human,this.store,this.actions,this.engineService,this.quizService).forEach((function(e){UI(Human,e)})),function(e,t,n,i){return[].concat(p(function(e,t,n){return[{procName:DI.AnnotationsInfo,actionFn:function(){return WI(t)},mapFnOut:function(t){return function(e,t){return t.reduce((function(t,n){return t[n.id]=GI(e,n),t}),{})}(e,t)}},{procName:DI.AnnotationsCreate,mapFnIn:function(i){return function(e,t,n,i){var o=t.selectSnapshot(vs.getSelectedChapter),r={annotationId:i.annotationId,title:i.title,description:i.description,objectId:e.scene.objects[i.objectId]?i.objectId:void 0,pos:i.position,occludable:i.occludable,labelOffset:i.labelOffset,shown:i.shown,labelShown:i.shown};return r.objectId&&void 0===r.pos&&(r.pos=e.scene.objects[r.objectId].center),n.deserializeAnnotation(r,o,Ri.Annotation)}(e,t,n,i)},actionFn:function(e){return function(e,t){return t.objectId||t.pos?(e.dispatch(new Xr(t)),t):null}(t,e)},mapFnOut:function(t){return t?GI(e,t):null}},{procName:DI.AnnotationsUpdate,mapFnIn:function(e){return ZI(t,e)},actionFn:function(e){return JI(t,e)}},{procName:DI.AnnotationsSetTitle,mapFnIn:function(e){return ZI(t,e)},actionFn:function(e){return JI(t,e)},hideDefinition:!0},{procName:DI.AnnotationsSetDescription,mapFnIn:function(e){return ZI(t,e)},actionFn:function(e){return JI(t,e)},hideDefinition:!0},{procName:DI.AnnotationsDestroy,mapFnIn:function(e){return KI(t,e)},actionFn:function(e){return function(e,t){return t&&e.dispatch(new ta(t)),!0}(t,e)}},{procName:DI.ShowAnnotations,actionFn:function(){return XI(t,!0)}},{procName:DI.SetAnnotationsShown,actionFn:function(){return XI(t,!0)},hideDefinition:!0},{procName:DI.HideAnnotations,actionFn:function(){return XI(t,!1)}},{procName:DI.AnnotationsSetLabelsShown,mapFnIn:function(e){return function(e,t){var n=t.annotations,i=t.objects,o=t.replace,r=n||{},a=i||{},s=WI(e),c=Object.assign(Object.assign(Object.assign(Object.assign({},ez(r,!0)),ez(r,!1)),iz(s,a,!0)),iz(s,a,!1));return o?Object.assign(Object.assign({},YI(s.map((function(e){return e.id})),!1)),c):c}(t,e)},actionFn:function(e){return function(e,t){var n=WI(e),i=nz(n,t,!1),o=nz(n,t,!0);e.dispatch(new ua(o,!0)),e.dispatch(new ua(i,!1))}(t,e)},hideDefinition:!0}]}(e,t,n)),p(function(e,t,n){return[{procName:DI.HotspotsInfo,actionFn:function(n){var i="number"==typeof n?n:void 0;if(void 0!==i){var o=cz(t,i);return dz(e,t,[o])[0]}var r=bz(t,i);return dz(e,t,r)}},{procName:DI.HotspotsTypes,mapFnIn:function(){return Object.values(so).map((function(e){return""+e}))},actionFn:function(e){return e}},{procName:DI.HotspotsCreate,mapFnIn:function(e){return function(e,t,n){var i=n.title,o=n.objectId,r=n.position,a=n.direction,s=n.chapterScope,c=n.type,l=e.selectSnapshot(vs.getStoryChapters),p=e.selectSnapshot(vs.getSelectedChapter),u=e.selectSnapshot(vs.getSelectedChapterIndex),d="number"==typeof s?s:u,g=l[d]||p,h=!1!==n.shown,f=h&&!!i,b={title:i,type:c||so.CircleLabel,objectId:o,pos:r?hz(r):null,dir:a?hz(a):null,shown:h,symbol:"",className:""},m=t.deserializeHotspots({},g,d,b);return m.title=i,m.expandTag=!0,m.flyTo=!1,m.flyToTarget=null,m.occludable=!0,m.pinGlow=!1,m.pinType=Ai.PlusMinus,m.shown=h,m.hideTag=!f,m.hideWire=!0,m.theme=Ri.StudioNext,m.pinType=lz(c),rz(m.id,n),m}(t,n,e)},actionFn:function(e){return function(e,t){return t.objectId||t.pos?(e.dispatch(new Xr(t)),t):null}(t,e)},mapFnOut:function(e){return e?pz(t,e.id):null}},{procName:DI.HotspotsUpdate,mapFnIn:function(e){return function(e,t){var n=cz(e,t.id);return n?function(e,t){var n=e.title,i=e.objectId,o=e.direction,r=e.position,a=e.shown,s=e.type,c=Object.assign(Object.assign({},t),{title:n,objectId:i,shown:a,pos:r?hz(r):null,dir:o?hz(o):null,pinType:s?lz(s):null});return rz(t.id,e),Object.assign(Object.assign({},t),Object(ie.omitBy)(c,ie.isNil))}(t,n):null}(t,e)},actionFn:function(e){return e?function(e,t){return e.dispatch(new oa(t)),t}(t,e):null}},{procName:DI.HotspotsDestroy,mapFnIn:function(e){return cz(t,e)},actionFn:function(e){return e?function(e,t){return e.dispatch(new ta(t)),t}(t,e):null}},{procName:DI.HotspotsShow,mapFnIn:function(e){return bz(t,e)},actionFn:function(e){return fz(t,e,!0)}},{procName:DI.HotspotsHide,mapFnIn:function(e){return bz(t,e)},actionFn:function(e){return fz(t,e,!1)}}]}(e,t,n)),[{procName:DI.LabelsInfo,actionFn:function(e){return e.length>0?xz(t,e):t.selectSnapshot(kc.getChapterLabels)},mapFnOut:function(t){return Sz(e,t)}},{procName:DI.LabelsCreate,mapFnIn:function(e){return e.labelId&&yz(t,e.labelId)?null:e.objectId&&e.position?function(e,t,n,i){var o=n.makeDefaultStudioLabel();o.id=i.labelId||qi.idWithPrefix("label"),o.objectId=i.objectId,o.pos=i.position,o.renderableIndex=0,o.occludable=!0,o.flyTo=!0,o.description="",o.shown=!0;var r=t.selectSnapshot(vs.getSelectedChapter);return o.chapterId=r.id,kz(o,i)}(0,t,n,e):(console.log("attempt to create a label with no objectId and position"),null)},actionFn:function(e){return Oz(t,e,!0)},mapFnOut:function(t){return Cz(e,t)}},{procName:DI.LabelsUpdate,mapFnIn:function(e){return yz(t,e.labelId)?function(e,t){return kz(yz(e,t.labelId),t,e.selectSnapshot(vs.getSelectedChapter))}(t,e):null},actionFn:function(e){return Oz(t,e,!1)},mapFnOut:function(t){return Cz(e,t)}},{procName:DI.LabelsCanvasUpdate,mapFnIn:function(e){return yz(t,e.labelId)?function(e,t,n){var i=yz(e,n.labelId),o=n.canvasPosition,r=t.pickScene({x:o[0],y:o[1],rayPick:!0});return r&&r.objectId?(i.objectId=r.objectId,i.pos=[r.worldPos[0],r.worldPos[1],r.worldPos[2]],i.offset=[i.hideWire?20:32,0],i.barycentric=[r.barycentric[0],r.barycentric[1],r.barycentric[2]],i.primitiveIndex=r.primitiveIndex,i.renderableIndex=r.renderableIndex||0,i):null}(t,i,e):null},actionFn:function(e){return Oz(t,e,!1)},mapFnOut:function(t){return Cz(e,t)}},{procName:DI.LabelsDestroy,mapFnIn:function(e){return yz(t,e)},actionFn:function(e){return e?(t.dispatch(new ta(e)),{labelId:e.id}):null}},{procName:DI.LabelsShow,actionFn:function(e){return e.length>0?t.dispatch(new ua(xz(t,e),!0)):vz(t,!0),!0}},{procName:DI.LabelsHide,actionFn:function(e){return e.length>0?t.dispatch(new ua(xz(t,e),!1)):vz(t,!1),!0}},{procName:DI.LabelsSetEnabled,aliases:[DI.AnnotationsSetEnabled],actionFn:function(e){t.dispatch(new Lt(e.enable))},hideDefinition:!0},{procName:DI.LabelsSetScale,actionFn:function(e){t.dispatch(new aa(e.scale))}}])}(Human,this.store,this.labelsService,this.engineService).forEach((function(e){UI(Human,e)})),function(e,t){function n(t){return e.selectSnapshot(rr.getQuizModeActive)?t():{error:"quiz mode is not active"}}return[{procName:DI.QuizInfo,actionFn:function(){return e.selectSnapshot(rr.hasQuiz)?Mz(e):null}},{procName:DI.QuizSubmit,actionFn:function(i){return n((function(){return t.submitQuestion(i.questionId,i.answerIds),Mz(e)}))}},{procName:DI.QuizQuestion,actionFn:function(){return n((function(){return Dz(e)}))}},{procName:DI.QuizEnter,actionFn:function(){return e.selectSnapshot(rr.hasQuiz)?(t.startQuiz(),!0):{error:"quiz not found"}}},{procName:DI.QuizExit,actionFn:function(){return t.exitQuiz(),!0}},{procName:DI.QuizSelectQuestion,actionFn:function(t){return n((function(){return e.dispatch(new Eo.SetActiveQuestion(t)),Mz(e)}))}},{procName:DI.QuizNextQuestion,actionFn:function(){return n((function(){return t.nextQuestion(),Dz(e)}))}},{procName:DI.QuizPreviousQuestion,actionFn:function(){return n((function(){return e.dispatch(new Eo.SetQuizLifecycle(Ko.Question)),e.dispatch(new Eo.PreviousQuestion),Dz(e)}))}},{procName:DI.QuizReset,actionFn:function(){return t.resetQuiz(),Mz(e)}},{procName:DI.QuizSet,actionFn:function(t){var n=t.settings,i=t.startNumber,o=t.endNumber,r=t.locked;if(!Object(ie.isNil)(n)){var a=e.selectSnapshot(rr.getQuizSettings);e.dispatch(new Eo.SetQuizSettings(Object.assign(Object.assign({},a),n)))}if("number"==typeof i||"number"==typeof o){var s=Ho(e.selectSnapshot(vs.getStoryChapters)),c=s.slice("number"==typeof i?i-1:0,"number"==typeof o?o:s.length);e.dispatch(new Eo.SetQuestions(c))}return"boolean"==typeof r&&e.dispatch(new Eo.SetQuizLocked(r)),e.dispatch(new Eo.SetQuizQuestionsMode("number"==typeof i&&"number"==typeof o?"restricted":"all")),Mz(e)}}]}(this.store,this.quizService).forEach((function(e){UI(Human,e)}))}}]),e}()).\u0275fac=function(e){return new(e||Rz)(j.Zb(L.g),j.Zb(L.b),j.Zb(Xn),j.Zb(Sn),j.Zb($r),j.Zb(ru),j.Zb(po),j.Zb(mn),j.Zb(Wp),j.Zb(_I),j.Zb(cu),j.Zb(Ef))},Rz.\u0275prov=j.Lb({token:Rz,factory:Rz.\u0275fac,providedIn:"root"}),Rz),Bz=((Az=function(){function e(t,n,i){y(this,e),this.locationStrategy=t,this.router=n,this.errorLoggingService=i,window.SceneJS_error.setFatalErrorHandler(this.handleSceneJSFatalErrors.bind(this))}return v(e,[{key:"handleSceneJSFatalErrors",value:function(e){var t={log:Human.log.messages.join("\n"),stack:e.stackTrace,webglInfo:window.SceneJS.WEBGL_INFO},n={category:e.errorName,log:JSON.stringify(t),message:e.messageFromCaller};this.errorLoggingService.logError(n,!0).subscribe();var i=btoa(JSON.stringify(e));this.redirectToErrorPage(sI.SceneJS,void 0,i)}},{key:"redirectToErrorPage",value:function(e,t,n){if(!(this.router.url||"").match("/error")){var i=this.locationStrategy.getBaseHref(),o=this.router.createUrlTree([T.application===P.Viewer?i+"/error":i+"/view/error"],{queryParams:{errorType:e,errorCode:t,errorBlob:n,errorUrl:this.router.url}}),r=this.router.serializeUrl(o);window.location.href=r}}}]),e}()).\u0275fac=function(e){return new(e||Az)(j.Zb(we.h),j.Zb(te.e),j.Zb(vx))},Az.\u0275prov=j.Lb({token:Az,factory:Az.\u0275fac,providedIn:"root"}),Az),Hz=["*"],Qz=((Vz=function(){function e(){y(this,e)}return v(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||Vz)},Vz.\u0275cmp=j.Jb({type:Vz,selectors:[["app-warning-message"]],ngContentSelectors:Hz,decls:2,vars:0,consts:[[1,"message","p-4","text-12"]],template:function(e,t){1&e&&(j.kc(),j.Vb(0,"div",0),j.jc(1),j.Ub())},styles:[".message{background-color:#2d72dc;color:#fff}@media print{.message{display:none}}"],encapsulation:2,changeDetection:0}),Vz),qz=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function $z(e,t){if(1&e){var n=j.Wb();j.Vb(0,"app-warning-message"),j.Vb(1,"div",1),j.Vb(2,"div",2),j.Kc(3),j.Ub(),j.Vb(4,"div"),j.Vb(5,"div",3),j.cc("click",(function(){return j.xc(n),j.gc().handleDismissClick()})),j.Qb(6,"app-icon",4),j.Ub(),j.Ub(),j.Ub(),j.Ub()}if(2&e){var i=j.gc();j.Db(3),j.Mc(" ",i.message," ")}}var Wz,Kz,Gz=((Kz=function(){function e(t,n){y(this,e),this.changeDetector=t,this.storageService=n,this.show=!1,this.message="For the full interactive 3D experience please try loading this content in Chrome or Firefox.",this.ngUnsubscribe=new Z.a}return v(e,[{key:"ngOnInit",value:function(){this.initLayoutListener()}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"handleDismissClick",value:function(){this.show=!1,this.storageService.setLocalItem(ns.InternetExplorerWarning,!0)}},{key:"shouldShow",value:function(e){var t=this.storageService.getLocalItem(ns.InternetExplorerWarning);return cS()&&!t&&e.internetExplorerWarning.enable}},{key:"initLayoutListener",value:function(){var e=this;this.layout$.pipe(Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){e.show=e.shouldShow(t),e.changeDetector.markForCheck()}))}}]),e}()).\u0275fac=function(e){return new(e||Kz)(j.Pb(j.i),j.Pb(as))},Kz.\u0275cmp=j.Jb({type:Kz,selectors:[["app-ie-warning"]],decls:1,vars:1,consts:[[4,"ngIf"],[1,"warning","flex","flex-row","justify-between"],[1,"warning__text","flex-auto"],[1,"warning__close","flex","justify-center",3,"click"],["icon","times","size","lg","title","Close"]],template:function(e,t){1&e&&j.Ic(0,$z,7,1,"app-warning-message",0),2&e&&j.lc("ngIf",!0===t.show)},directives:[we.l,Qz,vp],styles:[".warning[_ngcontent-%COMP%]{align-items:center}.warning__text[_ngcontent-%COMP%]{text-align:center}.warning__close[_ngcontent-%COMP%]{cursor:pointer;align-items:center;width:32px;height:32px}"],changeDetection:0}),function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);r>3&&a&&Object.defineProperty(t,n,a)}([Object(L.d)(hs.getUI),qz("design:type",J.a)],Kz.prototype,"layout$",void 0),Kz),Zz=((Wz=function(){function e(t,n){y(this,e),this.el=t,this.renderer=n}return v(e,[{key:"ngOnInit",value:function(){cS()||this.renderer.setStyle(this.el.nativeElement,"display","none")}}]),e}()).\u0275fac=function(e){return new(e||Wz)(j.Pb(j.m),j.Pb(j.H))},Wz.\u0275dir=j.Kb({type:Wz,selectors:[["","appShowIE11",""]]}),Wz),Jz=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},Xz=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function Yz(e,t){1&e&&j.Qb(0,"div",4)}var eT={title:"We're unable to find the model you're looking for.",description:'Please check your URL or visit the <a href="/" target="_blank">BioDigital Human</a> to see what\'s available in our 3D model library.'},tT={title:"Your BioDigital Human embed requires proper authentication.",description:""},nT=c({},OI.InvalidUAID,{title:"Authentication Issues",description:"Your Human Widget has invalid user credentials.",url:"https://support.biodigital.com"});function iT(e,t){if(1&e){var n=j.Wb();j.Vb(0,"button",13),j.cc("click",(function(){return j.xc(n),j.gc(2).handleSeeDetailsClick()})),j.Kc(1," See Details "),j.Ub()}}function oT(e,t){if(1&e&&(j.Vb(0,"textarea",14),j.Kc(1,"        "),j.Ub()),2&e){var n=j.gc(2);j.lc("value",n.sceneJSErrorReport)}}function rT(e,t){if(1&e){var n=j.Wb();j.Vb(0,"div"),j.Vb(1,"h1",3),j.Kc(2,"The BioDigital Human encountered an error."),j.Ub(),j.Vb(3,"h2",4),j.Kc(4," Error: "),j.Vb(5,"span",5),j.Kc(6),j.Ub(),j.Ub(),j.Vb(7,"div",6),j.Kc(8," To receive assistance with this error, please follow these steps: "),j.Ub(),j.Vb(9,"ol",7),j.Vb(10,"li",8),j.Vb(11,"button",9),j.cc("click",(function(){return j.xc(n),j.gc().handleDownloadClick()})),j.Kc(12," Download "),j.Ub(),j.Kc(13," the error report. "),j.Ub(),j.Vb(14,"li",8),j.Vb(15,"button",9),j.cc("click",(function(){j.xc(n);var e=j.gc();return e.handleActionClick(e.supportURL)})),j.Kc(16," Share the report "),j.Ub(),j.Kc(17," with the customer support team. "),j.Ub(),j.Ub(),j.Vb(18,"div",10),j.Ic(19,iT,2,0,"button",11),j.Vb(20,"div"),j.Ic(21,oT,2,1,"textarea",12),j.Ub(),j.Ub(),j.Ub()}if(2&e){var i=j.gc();j.Db(6),j.Lc(i.sceneJSErrorTeaser),j.Db(13),j.lc("ngIf",!i.viewSceneJSErrorDetails),j.Db(2),j.lc("ngIf",i.viewSceneJSErrorDetails)}}function aT(e,t){if(1&e){var n=j.Wb();j.Vb(0,"div",3),j.Kc(1),j.Ub(),j.Vb(2,"div",15),j.Tb(3),j.Vb(4,"button",9),j.cc("click",(function(){j.xc(n);var e=j.gc();return e.handleActionClick(e.supportURL)})),j.Kc(5," Contact Support "),j.Ub(),j.Sb(),j.Ub(),j.Qb(6,"div",16)}if(2&e){var i=j.gc();j.Db(1),j.Mc(" ",i.title," "),j.Db(5),j.lc("innerHTML",i.description,j.yc)}}var sT,cT,lT,pT,uT,dT,gT,hT=[{path:"",component:(cT=function(){function e(t,n,i,o,r,a,s,c,l,p,u){y(this,e),this.store=t,this.actions=n,this.activatedRoute=i,this.widgetAPIHandler=o,this.errorService=r,this.engineService=a,this.cameraService=s,this.storageService=c,this.renderer=l,this.viewService=p,this.quizService=u,this.title="Biodigital Human",this.environmentApplication=P,this.environmentPlatform=z,this.ngUnsubscribe=new Z.a}return v(e,[{key:"ngOnInit",value:function(){this.initErrorHandling(),this.initInteractions();var e=this.activatedRoute.snapshot.data.widgetUrlConfig;this.initWidgetBreakpoints(e),this.initWidgetLabelScale(e),this.initWidgetLayout(e),this.initWidgetSetup(e),this.initCustomWidgetSettings(e.paid),this.store.dispatch(new lI),this.initBackgroundFromWidget(e),this.initBackgroundFromChapter(),this.initCamera(e),this.initRotation(e),this.initQuizInteractions(e),this.widgetAPIHandler.listen(T.deploy===I.Production),this.initChaptersReadyListener(),this.initHumanReadyListener(),this.initDynamicLayout()}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"initWidgetSetup",value:function(e){var t=window!==window.top,n=t?BD_DOCUMENT_REFERRER:window.location.href;this.store.dispatch(new F(n,t,e));var i=this.store.selectSnapshot(hs.getUI),o=tp(e),r=op(i,o);this.store.dispatch(new _.SetUI(r)),this.store.dispatch(new _.SetInitialUI(r));var a=function(e){return e["disable-scroll"]?Cs.DoNotCapture:e["disable-scroll.alert"]||e["disable-scroll.overlay"]?Cs.DoNotCaptureShowMessage:Cs.Capture}(e);this.store.dispatch(new bt(a));var s=function(e){return!0===e["ui-print-image"]}(e),c=function(e){return!1===e["auto-load"]}(e),l=function(e,t,n){var i=e["initial.play"]||e.initial||e["initial.button"]||e["initial.hand"]||e["initial.hand-hint"]||t;return{interactType:function(){switch(!0){case e.initial:case e["initial.button"]:return La.Button;case e["initial.hand"]:case e["initial.hand-hint"]:return La.Hand;case e["initial.play"]:return La.Play;default:return n}}(),isInteractActive:i}}(e,this.store.selectSnapshot(hs.shouldWindowOpen(Ea.Interact)),this.store.selectSnapshot(hs.getInteractType)),p=l.interactType,u=l.isInteractActive,d=this.storageService.getLocalItem(ns.GettingStartedTutorial),g=!0===o.tutorial&&"true"!==d;this.store.dispatch([new _.SetOnDemand(c),new _.ToggleWindow(Ea.OnDemand,c),new _.SetInteractType(p),new _.ToggleWindow(Ea.Interact,u),new _.ToggleWindow(Ea.Tutorial,g),new _.StartTutorial(g),new _.SetUsePrintImage(s)])}},{key:"initCustomWidgetSettings",value:function(e){var t=this;T.offline||e&&(this.store.select(G.getWidgetSettings).pipe(Object(Y.a)((function(e){return!Object(ie.isNil)(e)&&e.length>0})),Object(X.a)(this.ngUnsubscribe)).subscribe((function(e){e.forEach((function(e){e.anatomy_description_fallback&&t.viewService.setAnatomyDescriptionFallback(e.anatomy_description_fallback)}))})),this.store.dispatch(new N(e)))}},{key:"initErrorHandling",value:function(){var e=this;this.actions.pipe(Object(L.j)(it),Object(X.a)(this.ngUnsubscribe)).subscribe((function(){return e.handleContentErrors()})),this.actions.pipe(Object(L.j)(uI),Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){return e.handleAuthErrors(t)}))}},{key:"initWidgetBreakpoints",value:function(e){var t=[e["ui-collapse-label"],e["annotation-collapse"]].find((function(e){return!Object(ie.isNil)(e)}));Object(ie.isNil)(t)||this.store.dispatch(new _.SetLabelBreakpoint(t))}},{key:"initWidgetLabelScale",value:function(e){var t=e["label-scale"];Object(ie.isNil)(t)||this.store.dispatch(new aa(t))}},{key:"initWidgetLayout",value:function(e){var t=e["ui-layout"];Object(ie.isNil)(t)||this.store.dispatch(new _.SetLayout(t))}},{key:"initQuizInteractions",value:function(e){var t=this,n=this.store.select(H_.getSelectedBookmark);Object(zc.b)([this.store.select(rr.hasQuiz),n]).pipe(Object(Y.a)((function(e){var t=d(e,2),n=t[0],i=t[1];return!Object(ie.isNil)(i)&&n})),Object(Tc.a)(1),Object(X.a)(this.ngUnsubscribe)).subscribe((function(n){var i=d(n,2),o=(i[0],i[1]),r=t.store.selectSnapshot(rr.getAllQuestions),a=e["ui-quiz"];a&&t.store.dispatch(new Eo.SetQuizEnabled(""+a!="false"));var s=""+e["ui-quiz-locked"]=="true",c=o.viewMode===de.Quiz;t.store.dispatch(new Eo.SetQuizLocked(s||c)),s&&t.store.dispatch(new Eo.SetEnableQuizRetake(!1));var l=parseInt(e["ui-quiz-start"],10),p=parseInt(e["ui-quiz-end"],10),u=r.length,g=isNaN(l)?1:l,h=isNaN(p)?u:p;if(1!==g||h!==u){var f=r.filter((function(e,t){var n=t+1;return n>=g&&n<=h}));t.store.dispatch(new Eo.SetQuestions(f))}var b=isNaN(l)&&isNaN(p)?"all":"restricted";t.store.dispatch(new Eo.SetQuizQuestionsMode(b)),(s||c)&&setTimeout((function(){t.quizService.startQuiz()}))}))}},{key:"initInteractions",value:function(){var e=this,t=this.getCanvasInteraction(),n=this.actions.pipe(Object(L.j)(Yi.UpdateNodeSelected,Yi.UpdateNodesChecked,Yi.UpdateNodesShown,Yi.UpdateNodesPickable,Yi.UpdateNodesPaint),Object(Y.a)((function(e){return void 0!==e.objectId||void 0!==e.objectIds}))),i=this.store.select(vs.getSelectedChapter).pipe(Object(Y.a)((function(e){return e&&e.readyState.model})),Object(X.a)(this.ngUnsubscribe)),o=this.engineService.getCanvas();Object(oI.a)([i,this.getIntersectionObserver(o,.75)]).pipe(Object(Tc.a)(1)).subscribe((function(){e.store.dispatch(new bI)})),Object(Ca.a)(t,n).pipe(Object(Xj.a)(i),Object(Gp.a)(125)).subscribe((function(){e.store.dispatch(new mI)}))}},{key:"initBackgroundFromWidget",value:function(e){var t=this,n=e.background;n&&(this.setWidgetTransparent(Ki.isTransparent(n)),this.actions.pipe(Object(L.i)(li),Object(Tc.a)(1),Object(X.a)(this.ngUnsubscribe)).subscribe((function(){t.store.dispatch(new Ci(n))})))}},{key:"initBackgroundFromChapter",value:function(){var e=this;this.store.select(vs.getSelectedChapter).pipe(Object(Y.a)((function(e){return null!=e})),Object(se.a)((function(e){return Ki.isTransparent(e.background)})),Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){e.setWidgetTransparent(t)}))}},{key:"initCamera",value:function(e){var t=this,n=e.camera;n&&this.actions.pipe(Object(L.j)(et),Object(Tc.a)(1),Object(X.a)(this.ngUnsubscribe)).subscribe((function(){t.store.dispatch(new zn(n,!1))}))}},{key:"initRotation",value:function(e){var t=this,n=e["load-rotate"];if(n){var i=performance.now();Object(rI.a)(0,aI.a).pipe(Object(se.a)((function(){return n*(performance.now()-i)*.001})),Object(ei.a)((function(){return i=performance.now()})),Object(X.a)(this.isFirstInteractionLogged$.pipe(Object(Y.a)((function(e){return!0===e})))),Object(X.a)(this.ngUnsubscribe)).subscribe((function(e){t.cameraService.rotateCameraStatic(0,e)})),this.isFirstInteractionLogged$.pipe(Object(Y.a)((function(e){return!0===e})),Object(X.a)(this.ngUnsubscribe)).subscribe((function(){var e=t.store.selectSnapshot(vs.getSelectedChapter),n=Object(ie.get)(e,"camera.location");n&&t.store.dispatch(new zn(n,!0,2))}))}}},{key:"initHumanReadyListener",value:function(){var e=this;this.actions.pipe(Object(L.j)(T.platform===z.SDK?lt:ct)).pipe(Object(X.a)(this.ngUnsubscribe)).subscribe((function(){e.engineService.fireEvent(yn.Started,null)}))}},{key:"initChaptersReadyListener",value:function(){var e=this;this.store.select(vs.getAllChaptersModelsReady).pipe(Object(Y.a)((function(e){return!0===e})),Object(X.a)(this.ngUnsubscribe)).subscribe((function(){e.store.dispatch(new ct),e.engineService.fireEvent(yn.TimelineChaptersActivated,{oldChapterIndex:0,newChapterIndex:0,time:0})}))}},{key:"initDynamicLayout",value:function(){var e=this;Object(zc.b)([this.store.select(G.getWidgetApiUIConfig),this.store.select(G.getWidgetUrlConfig),this.store.select(vs.getSelectedChapter),this.store.select(rr.getQuizModeActive),this.store.select(rr.getActiveQuestion)]).pipe(Object(Y.a)((function(e){var t=d(e,3),n=(t[0],t[1]);return null!=t[2]&&null!=n})),Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){var n,i=d(t,5),o=i[0],r=i[1],a=i[2],s=i[3],c=(i[4],tp(r)),l=function(e){if(!e||!e.config)return null;var t=new Zl;return t[nl.Column]=e.config.info,t[nl.Drawer]=e.config.info,t[nl.Fullscreen]=e.config.fullscreen,t[nl.Search]=e.config.objectTree,t[nl.Camera]=e.config.nav,t[nl.Loader]=ep(e.config.loader),t[nl.Whiteboard]=e.config.whiteboard,t[nl.VisibilityLayers]=e.config.visibilityLayers,t[nl.ContextActions]=e.config.contextActions,t[nl.Media]=Yl(e.config.playPause,e.config.scrubber,e.config.mediaControls),t}(a.ui),p=((n=new Zl).search=!1,n.pagination=!1,n.labelList=!1,n.labels=!1,n.anatomyLabels=!1,n.nodeInfo=!1,n.toggleLabels=!1,n.legend=!1,n);e.viewService.setUI({apiUIConfig:o,urlUIConfig:c,chapterUIConfig:l,quizUIConfig:s?p:null})}))}},{key:"handleContentErrors",value:function(){this.store.dispatch(new Je(null,null)),this.errorService.redirectToErrorPage(sI.Content)}},{key:"handleAuthErrors",value:function(e){T.deploy!==I.Local&&this.errorService.redirectToErrorPage(cI.Auth,e.response.errorCode)}},{key:"getCanvasInteraction",value:function(){var e,t=this;return new J.a((function(n){var i=t.engineService.getCanvas();(e=new eu.Manager(i)).add([new eu.Tap({event:"singletap"}),new eu.Tap({event:"doubletap",taps:2}),new eu.Pan({event:"pan",direction:eu.DIRECTION_ALL,threshold:0})]);var o=(function(){return n.next()}).bind(t);e.on("panstart",o),e.on("singletap",o)})).pipe(Object(Ss.a)((function(){e&&(e.destroy(),e=null)})),Object(X.a)(this.ngUnsubscribe))}},{key:"getIntersectionObserver",value:function(e,t){return new J.a((function(n){var i=new IntersectionObserver((function(o){o[0].intersectionRatio>=t&&(n.next(e),n.complete(),i.unobserve(e))}),{root:null,threshold:t});i.observe(e)}))}},{key:"setWidgetTransparent",value:function(e){e?this.renderer.setStyle(document.body,"background","none transparent"):this.renderer.removeStyle(document.body,"background")}}]),e}(),cT.\u0275fac=function(e){return new(e||cT)(j.Pb(L.g),j.Pb(L.b),j.Pb(te.a),j.Pb(Nz),j.Pb(Bz),j.Pb(Sn),j.Pb(Xn),j.Pb(as),j.Pb(j.H),j.Pb(Wp),j.Pb(Ef))},cT.\u0275cmp=j.Jb({type:cT,selectors:[["app-widget-master"]],decls:5,vars:3,consts:[[1,"widget","theme-light"],[1,"widget__messages","pt-2","pr-2","pl-2"],["appShowIE11",""],["class","widget-shell",4,"appFlagApplication","appFlagApplicationPlatform","appFlagApplicationMode"],[1,"widget-shell"]],template:function(e,t){1&e&&(j.Vb(0,"div",0),j.Qb(1,"router-outlet"),j.Vb(2,"div",1),j.Qb(3,"app-ie-warning",2),j.Ub(),j.Ub(),j.Ic(4,Yz,1,0,"div",3)),2&e&&(j.Db(4),j.lc("appFlagApplication",t.environmentApplication.All)("appFlagApplicationPlatform",t.environmentPlatform.SDK)("appFlagApplicationMode","exclude"))},directives:[te.g,Gz,Zz,Fd],styles:[".widget__messages[_ngcontent-%COMP%]{display:flex;flex-direction:column;z-index:101}.widget-shell[_ngcontent-%COMP%], .widget__messages[_ngcontent-%COMP%]{position:fixed;top:0;left:0;right:0}.widget-shell[_ngcontent-%COMP%]{pointer-events:none;bottom:0;z-index:99999;border:1px solid #eaeff5}"]}),Jz([Object(L.d)(G.getBypassAnalytics),Xz("design:type",J.a)],cT.prototype,"bypassAnalytics$",void 0),Jz([Object(L.d)(TI.isFirstInteractionLogged),Xz("design:type",J.a)],cT.prototype,"isFirstInteractionLogged$",void 0),cT),resolve:{widgetUrlConfig:iI},children:[{path:"",component:nI},{path:"error",component:(sT=function(){function e(t,n){y(this,e),this.route=t,this.snackBar=n,this.supportURL="https://support.biodigital.com",this.isSceneJSError=!1,this.viewSceneJSErrorDetails=!1}return v(e,[{key:"handleSeeDetailsClick",value:function(){this.viewSceneJSErrorDetails=!0}},{key:"buildSceneJSErrorReport",value:function(e,t){return{contentId:e,error:JSON.parse(atob(t)),webglInfo:window.SceneJS.WEBGL_INFO}}},{key:"title",get:function(){return this.errorConfig.title}},{key:"description",get:function(){return this.errorConfig.description}},{key:"ngOnInit",value:function(){var e=this.route.snapshot.queryParams,t=e.errorType,n=e.errorCode,i=e.errorBlob,o=e.errorUrl;if(t===sI.SceneJS){this.isSceneJSError=!0;var r=this.buildSceneJSErrorReport(o,i);this.sceneJSErrorTeaser=r.error.errorName,this.sceneJSErrorReport=JSON.stringify(r,null,2)}else this.errorConfig=t===sI.Content?eT:nT[n]||tT}},{key:"handleDownloadClick",value:function(){Object(Cr.saveAs)(new Blob([this.sceneJSErrorReport],{type:"text/plain"}),"BioDigital_Error_Report.txt")}},{key:"handleActionClick",value:function(e){window.open(e)||this.snackBar.open("Unable to open link in new window, please check your pop-up settings.")}}]),e}(),sT.\u0275fac=function(e){return new(e||sT)(j.Pb(te.a),j.Pb(Sd.b))},sT.\u0275cmp=j.Jb({type:sT,selectors:[["app-error-page"]],decls:4,vars:2,consts:[[1,"error"],[4,"ngIf","ngIfElse"],["notSceneJSError",""],[1,"text-24","text-bold"],[1,"text-16","mt-4","mb-8"],[1,"text-semibold"],[1,"text-16","mb-4"],[1,"text-16"],[1,"mv-4"],["app-button","","buttonType","outline","buttonTheme","light",3,"click"],[1,"mt-8"],["app-button","","buttonType","outline","buttonTheme","light","buttonSize","xsmall",3,"click",4,"ngIf"],["class","error__details mt-2",3,"value",4,"ngIf"],["app-button","","buttonType","outline","buttonTheme","light","buttonSize","xsmall",3,"click"],[1,"error__details","mt-2",3,"value"],[1,"flex","items-start","mt-10"],[1,"error__description","text-16","mt-8",3,"innerHTML"]],template:function(e,t){if(1&e&&(j.Vb(0,"div",0),j.Ic(1,rT,22,3,"div",1),j.Ic(2,aT,7,2,"ng-template",null,2,j.Jc),j.Ub()),2&e){var n=j.tc(3);j.Db(1),j.lc("ngIf",t.isSceneJSError)("ngIfElse",n)}},directives:[we.l,Dd],styles:[".error[_ngcontent-%COMP%]{margin:0 auto;max-width:640px;display:flex;flex-direction:column;padding:40px;color:#283853}.error[_ngcontent-%COMP%]   ol[_ngcontent-%COMP%]{list-style:decimal}.error__details[_ngcontent-%COMP%]{width:100%;height:200px}.error__description[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .error__description[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:visited{color:#283853}"],changeDetection:0}),sT)}]}],fT=!0===T.offline?te.f.forRoot(hT,{useHash:!0}):te.f.forRoot(hT),bT=((lT=function e(){y(this,e)}).\u0275mod=j.Nb({type:lT}),lT.\u0275inj=j.Mb({factory:function(e){return new(e||lT)},providers:[iI],imports:[[fT],te.f]}),lT),mT=r("f6nW"),vT=r("FvrZ"),yT=r("bSwM"),xT=r("FKr1"),OT=r("bTqV"),wT=r("d3UM"),kT=r("/t3+"),CT=r("jaxi"),ST=r("XhcP"),_T=r("bv9b"),jT={disabled:!0,animation:{enterDuration:0,exitDuration:0}},PT=Object.assign(Object.assign({},Object(Lg.b)()),{touchGestures:"off"}),MT=((pT=function e(){y(this,e)}).\u0275mod=j.Nb({type:pT}),pT.\u0275inj=j.Mb({factory:function(e){return new(e||pT)},providers:[{provide:Sd.a,useValue:{duration:3e3}},{provide:xT.d,useValue:jT},{provide:Lg.a,useValue:PT}],imports:[[fa.b,mT.a,yT.a,yT.a,OT.b,$b.c,wT.a,Ld.c,kT.a,CT.a,ap.f,Lg.d,Sd.c,Ad.b,ST.a,jk.g,WC.f,GC.f],fa.b,mT.a,vT.a,yT.a,yT.a,OT.b,$b.c,wT.a,Ld.c,kT.a,CT.a,ap.f,Lg.d,Sd.c,Ad.b,ST.a,jk.g,WC.f,GC.f,_T.a]}),pT),IT=r("R9Cn"),zT=((gT=function e(){y(this,e)}).\u0275mod=j.Nb({type:gT}),gT.\u0275inj=j.Mb({factory:function(e){return new(e||gT)},imports:[[we.c]]}),gT),TT=((dT=function e(){y(this,e)}).\u0275mod=j.Nb({type:dT}),dT.\u0275inj=j.Mb({factory:function(e){return new(e||dT)},imports:[[MT,mh.j,we.c,zT]]}),dT),UT=((uT=function e(){y(this,e)}).\u0275mod=j.Nb({type:uT}),uT.\u0275inj=j.Mb({factory:function(e){return new(e||uT)},imports:[[we.c,mh.j]]}),uT),DT=function e(){y(this,e)},LT=function(e){return e.WoltersKluwer="wolters_kluwer",e}({}),ET=c({},LT.WoltersKluwer,"https://tools.ovid.com/support/index_inner.html");function FT(){return window}var AT,RT,VT,NT,BT,HT,QT,qT,$T,WT,KT,GT,ZT,JT,XT,YT,eU,tU,nU,iU,oU,rU,aU,sU,cU,lU,pU,uU,dU=((RT=function(){function e(t){var n=this;if(y(this,e),!t.accountUrl)throw new Error("Missing accountUrl. Please set in app config via ZendeskWidgetProvider");this.window=FT();var i=this.window;i.zEmbed||function(e,n){var o,r,a,s,c=[],l=document.createElement("iframe");i.zEmbed=function(){c.push(arguments)},i.zE=i.zE||i.zEmbed,l.src="javascript:false",l.title="",l.style.cssText="display: none",(a=(a=document.getElementsByTagName("script"))[a.length-1]).parentNode.insertBefore(l,a),s=l.contentWindow.document;try{r=s}catch(e){o=document.domain,l.src='javascript:var d=document.open();d.domain="'+o+'";void(0);',r=s}r.open()._l=function(){var e=this.createElement("script");o&&(this.domain=o),e.id="js-iframe-async",e.src="https://assets.zendesk.com/embeddable_framework/main.js",this.t=+new Date,this.zendeskHost=t.accountUrl,this.zEQueue=c,this.body.appendChild(e)},r.write('<body onload="document._l();">'),r.close()}(),this.window.zE((function(){t.beforePageLoad(n.window.zE)}))}return v(e,[{key:"setLocale",value:function(e){var t=this;this.window.zE((function(){t.window.zE.setLocale(e)}))}},{key:"identify",value:function(e){var t=this;this.window.zE((function(){Object(ie.isNil)(e)?t.window.zE("webWidget","clear"):t.window.zE.identify({name:t.getUserFullName(e),email:e.email})}))}},{key:"hide",value:function(){var e=this;this.window.zE((function(){e.window.zE.hide()}))}},{key:"show",value:function(){var e=this;this.window.zE((function(){e.window.zE.show()}))}},{key:"activate",value:function(e){var t=this;this.window.zE((function(){t.window.zE.activate(e)}))}},{key:"showWidget",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"help";this.hide(),this.setSettings({webWidget:{helpCenter:{suppress:"contact"===e}}}),this.activate({hideOnClose:!0})}},{key:"setHelpCenterSuggestions",value:function(e){var t=this;this.window.zE((function(){t.window.zE.setHelpCenterSuggestions(e)}))}},{key:"setSettings",value:function(e){var t=this;this.window.zE((function(){t.window.zE("webWidget","updateSettings",e)}))}},{key:"updateFromProfile",value:function(e){var t=[];if(null!=e){var n=e.premium_account,i=e.premium_account_type,o=e.developer_account,r=e.subscription;n?(t.push("premium_account_"+i),r&&t.push("subscription_"+r.subscription_provider)):t.push("free_account"),o&&t.push("developer_account")}var a=function(e){var t,n;return!(null===(n=null===(t=null==e?void 0:e.organizations[0])||void 0===t?void 0:t.external_account)||void 0===n?void 0:n.is_external_account)&&function(e){return!0===(null==e?void 0:e.premium_account_valid)||"group"===(null==e?void 0:e.premium_account_type)}(e)}(e);this.setSettings({webWidget:{position:{horizontal:"right",vertical:"bottom"},offset:{horizontal:"0px",vertical:"0px"},contactForm:{suppress:!a,tags:t,fields:[{id:"name",prefill:{"*":this.getUserFullName(e)}}]}}})}},{key:"getUserFullName",value:function(e){if(e){var t=e.first_name,n=e.last_name;return"".concat(t," ").concat(n)}return""}}]),e}()).\u0275fac=function(e){return new(e||RT)(j.Zb(DT))},RT.\u0275prov=j.Lb({token:RT,factory:RT.\u0275fac,providedIn:"root"}),RT),gU=((AT=function(){function e(){y(this,e)}return v(e,null,[{key:"forRoot",value:function(t){return{ngModule:e,providers:[{provide:t,useClass:t},{provide:dU,useClass:dU,deps:[t]}]}}}]),e}()).\u0275mod=j.Nb({type:AT}),AT.\u0275inj=j.Mb({factory:function(e){return new(e||AT)},imports:[[we.c]]}),AT),hU=function(e){n(i,e);var t=o(i);function i(){var e;return y(this,i),(e=t.apply(this,arguments)).accountUrl="biodigital.zendesk.com",e}return v(i,[{key:"beforePageLoad",value:function(e){e.setLocale("en"),e.hide()}}]),i}(DT),fU=((tU=function e(){y(this,e)}).\u0275mod=j.Nb({type:tU}),tU.\u0275inj=j.Mb({factory:function(e){return new(e||tU)},imports:[[gU.forRoot(hU)]]}),tU),bU=((eU=function e(){y(this,e)}).\u0275mod=j.Nb({type:eU}),eU.\u0275inj=j.Mb({factory:function(e){return new(e||eU)},imports:[[we.c,zT,MT]]}),eU),mU=((YT=function e(){y(this,e)}).\u0275mod=j.Nb({type:YT}),YT.\u0275inj=j.Mb({factory:function(e){return new(e||YT)},imports:[[we.c]]}),YT),vU=((XT=function e(){y(this,e)}).\u0275mod=j.Nb({type:XT}),XT.\u0275inj=j.Mb({factory:function(e){return new(e||XT)},imports:[[we.c,mU,MT,bU,zT,ne.d]]}),XT),yU=((JT=function e(){y(this,e)}).\u0275mod=j.Nb({type:JT}),JT.\u0275inj=j.Mb({factory:function(e){return new(e||JT)},imports:[[we.c,zT,MT,bU,vU,mU,ne.d]]}),JT),xU=((ZT=function e(){y(this,e)}).\u0275mod=j.Nb({type:ZT}),ZT.\u0275inj=j.Mb({factory:function(e){return new(e||ZT)},imports:[[we.c]]}),ZT),OU=((GT=function e(){y(this,e)}).\u0275mod=j.Nb({type:GT}),GT.\u0275inj=j.Mb({factory:function(e){return new(e||GT)},imports:[[we.c,Af.b,MT,xU,mU]]}),GT),wU=((KT=function e(){y(this,e)}).\u0275mod=j.Nb({type:KT}),KT.\u0275inj=j.Mb({factory:function(e){return new(e||KT)},imports:[[we.c]]}),KT),kU=((WT=function e(){y(this,e)}).\u0275mod=j.Nb({type:WT}),WT.\u0275inj=j.Mb({factory:function(e){return new(e||WT)},imports:[[we.c]]}),WT),CU=(($T=function e(){y(this,e)}).\u0275mod=j.Nb({type:$T}),$T.\u0275inj=j.Mb({factory:function(e){return new(e||$T)},imports:[[we.c,bU,MT,ne.d]]}),$T),SU=((qT=function e(){y(this,e)}).\u0275mod=j.Nb({type:qT}),qT.\u0275inj=j.Mb({factory:function(e){return new(e||qT)},imports:[[we.c]]}),qT),_U=((QT=function e(){y(this,e)}).\u0275mod=j.Nb({type:QT}),QT.\u0275inj=j.Mb({factory:function(e){return new(e||QT)},imports:[[we.c,xU]]}),QT),jU=((HT=function e(){y(this,e)}).\u0275mod=j.Nb({type:HT}),HT.\u0275inj=j.Mb({factory:function(e){return new(e||HT)},imports:[[we.c,zT]]}),HT),PU=((BT=function e(){y(this,e)}).\u0275mod=j.Nb({type:BT}),BT.\u0275inj=j.Mb({factory:function(e){return new(e||BT)},imports:[[we.c,zT]]}),BT),MU=((NT=function e(){y(this,e)}).\u0275mod=j.Nb({type:NT}),NT.\u0275inj=j.Mb({factory:function(e){return new(e||NT)},imports:[[we.c,TT,zT]]}),NT),IU=((VT=function e(){y(this,e)}).\u0275mod=j.Nb({type:VT}),VT.\u0275inj=j.Mb({factory:function(e){return new(e||VT)},imports:[[te.f,bU,OU,IT.a,_U,we.c,mU,zT,wU,TT,MT,jU,vU,CU,kU,xU,mh.r,UT,SU,PU,yU,fU,Jd.a.forChild()],bU,OU,_U,mU,wU,zT,TT,jU,vU,kU,CU,MU,xU,UT,SU,PU,yU]}),VT),zU=function e(){y(this,e)},TU=function(){var e=function e(t){y(this,e),this.widgetURL=t};return e.type="[Publish] Set Widget URL",e}(),UU=function(){var e=function e(t){y(this,e),this.dimensions=t};return e.type="[Publish] Set Dimensions",e}(),DU=function(){var e=function e(t,n,i){y(this,e),this.model=t,this.widgetOptions=n,this.camera=i};return e.type="[Publish] Get iFrame",e}(),LU=function(){var e=function e(t){y(this,e),this.embed=t};return e.type="[Publish] Get iFrame Success",e}(),EU=function(){var e=function e(){y(this,e)};return e.type="[Publish] Get iFrame Fail",e}(),FU=function(){var e=function e(t,n,i){y(this,e),this.model=t,this.widgetOptions=n,this.camera=i};return e.type="[Publish] Get URL",e}(),AU=function(){var e=function e(t,n){y(this,e),this.model=t,this.url=n};return e.type="[Publish] Get URL Success",e}(),RU=function(){var e=function e(t){y(this,e),this.model=t};return e.type="[Publish] Get URL Fail",e}(),VU=function(){var e=function e(t){y(this,e),this.publishing=t};return e.type="[Publish] Set Publishing",e}(),NU=function(){var e=function e(){y(this,e)};return e.type="[Publish] Reset Publishing",e}(),BU=function(){var e=function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"jpeg";y(this,e),this.imageData=t,this.imageType=n};return e.type="[Publish] Save Publish Image",e}(),HU=function(){var e=function e(t){y(this,e),this.imageURL=t};return e.type="[Publish] Save Publish Image Success",e}(),QU=function(){var e=function e(){y(this,e)};return e.type="[Publish] Save Publish Image Fail",e}(),qU=function(){var e=function e(t,n,i,o,r){y(this,e),this.model=t,this.imageData=n,this.fileType=i,this.widgetOptions=o,this.camera=r};return e.type="[Publish] Get Publish Image Code",e}(),$U=function(){var e=function e(t){y(this,e),this.embed=t};return e.type="[Publish] Get Publish Image Code Success",e}(),WU=function(){var e=function e(){y(this,e)};return e.type="[Publish] Get Publish Image Code Fail",e}(),KU=function e(){y(this,e)},GU=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},ZU=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},JU={creating:!1,updating:!1,loadingCollections:!1,addingCollection:!1,reorderingCollections:!1,removingCollection:!1,updatingCollection:!1,collectionRenaming:null},XU=((nU=function(){function e(t,n,i,o){y(this,e),this.organizationsService=t,this.publishService=n,this.pendoService=i,this.productService=o}return v(e,[{key:"selectOrganization",value:function(e,t){var n=t.organization;e.patchState({selectedOrganization:n,selectedCollection:null}),n&&e.dispatch(new qy(n.id))}},{key:"setOrganizations",value:function(e,t){var n,i=t.organizations||[],o=i[0],r=null,a=Object.assign({},e.getState().appFeatures);if(o&&o.group_attributes){var s=o.group_attributes,c=this.organizationsService.getOrganizationAttribute(s,"widget_settings","widget_custom_url_path");c&&c.value&&(n=c.value);var l=this.organizationsService.getOrganizationAttribute(s,"widget_settings","widget_url_params");l&&l.value&&(r=this.publishService.extendWidgetOptions(new f_,l.value));var p=this.organizationsService.getOrganizationAttribute(s,"app_settings","web_app_features");p&&(a=Object.assign(Object.assign({},a),p.value))}e.patchState({organization:o,organizations:i,widgetURL:n,widgetOptions:r,appFeatures:a}),e.dispatch(new TU(n))}},{key:"getCollections",value:function(e,t){e.patchState({loadingCollections:!0}),this.organizationsService.getCollections({group_id:t.organizationId}).pipe(Object(Ss.a)((function(){return e.patchState({loadingCollections:!1})}))).subscribe((function(t){e.dispatch(new $y(t))}))}},{key:"getCollectionsSuccess",value:function(e,t){e.patchState({collections:t.collections})}},{key:"selectCollection",value:function(e,t){var n=e.getState(),i=n.organization,o=n.selectedOrganization;e.patchState({selectedOrganization:o||i,selectedCollection:t.collection})}},{key:"addCollection",value:function(e,t){e.patchState({addingCollection:!0}),this.organizationsService.addCollection(t.organizationId,t.collectionName).pipe(Object(Ss.a)((function(){e.patchState({addingCollection:!1})}))).subscribe((function(){e.dispatch(new Ky(t.organizationId,t.collectionName))}),(function(t){e.dispatch(new Gy(t))}))}},{key:"addCollectionSuccess",value:function(e,t){this.pendoService.track("Add Collection - Success",{platform:this.productService.productType})}},{key:"addCollectionError",value:function(e,t){this.pendoService.track("Add Collection - Failure",{error:Object(ie.get)(t,"error.error.error.message")||"There was an error with collection creation."})}},{key:"removeCollection",value:function(e,t){e.patchState({removingCollection:!0}),this.organizationsService.removeCollection(t.collection).pipe(Object(Ss.a)((function(){e.patchState({removingCollection:!1})}))).subscribe((function(){e.dispatch(new Jy(t.collection))}),(function(t){e.dispatch(new Xy(t))}))}},{key:"removeCollectionSuccess",value:function(e,t){this.pendoService.track("Remove Collection - Success",{platform:this.productService.productType})}},{key:"removeCollectionError",value:function(e,t){this.pendoService.track("Remove Collection - Failure",{error:Object(ie.get)(t,"error.error.error.message")||"There was an error with collection removal."})}},{key:"setCollectionRenameMode",value:function(e,t){e.patchState({collectionRenaming:t.collection})}},{key:"renameCollection",value:function(e,t){e.patchState({updatingCollection:!0}),this.organizationsService.renameCollection(t.collection,t.collectionName).pipe(Object(Ss.a)((function(){e.patchState({updatingCollection:!1})}))).subscribe((function(){e.dispatch(new tx(t.collection,t.collectionName))}),(function(t){e.dispatch(new nx(t))}))}},{key:"renameCollectionSuccess",value:function(e,t){this.pendoService.track("Rename Collection - Success",{platform:this.productService.productType})}},{key:"renameCollectionError",value:function(e,t){this.pendoService.track("Rename Collection - Failure",{error:Object(ie.get)(t,"error.error.error.message")||"There was an error with collection renaming."})}},{key:"reorderCollections",value:function(e,t){e.patchState({reorderingCollections:!0}),this.organizationsService.reorderCollections(t.organizationId,t.collections).pipe(Object(Ss.a)((function(){e.patchState({reorderingCollections:!1})}))).subscribe((function(){e.dispatch(new ox(t.organizationId,t.collections))}),(function(t){e.dispatch(new rx(t))}))}},{key:"reorderCollectionsSuccess",value:function(e,t){e.patchState({collections:p(t.collections)})}},{key:"resetOrganizations",value:function(e,t){e.setState(JU)}},{key:"createOrganization",value:function(e,t){var n=t.organization;e.patchState({creating:!0}),this.organizationsService.createOrganization(n).pipe(Object(Ss.a)((function(){return e.patchState({creating:!1})}))).subscribe((function(){return e.dispatch(new cx)}),(function(t){return e.dispatch(new lx(t))}))}},{key:"createOrganizationSuccess",value:function(e){this.pendoService.track("Team Creation - Success",{platform:this.productService.productType})}},{key:"createOrganizationFail",value:function(e,t){this.pendoService.track("Team Creation - Failure",{error:Object(ie.get)(t,"error.error.error.message")||"There was an error with team creation."})}},{key:"updateOrganization",value:function(e,t){var n=t.organization;e.patchState({updating:!0}),this.organizationsService.updateOrganization(n).pipe(Object(Ss.a)((function(){return e.patchState({updating:!1})}))).subscribe((function(){return e.dispatch(new ux)}),(function(t){return e.dispatch(new dx(t))}))}},{key:"getOrganizationProfile",value:function(e,t){var n=t.request;e.patchState({updating:!0}),this.organizationsService.getPublicProfile(n).pipe().subscribe((function(t){return e.dispatch(new hx(t))}),(function(t){return e.dispatch(new fx(t))}))}},{key:"getOrganizationProfileSuccess",value:function(e,t){var n=t.organizationProfile;e.patchState({organizationProfile:n})}},{key:"clearOrganizationProfile",value:function(e,t){e.patchState({organizationProfile:void 0})}}],[{key:"getOrganizations",value:function(e){return e.organizations}},{key:"getOrganization",value:function(e){return e.organization}},{key:"getOrganizationLogo",value:function(e){return e.organization?e.organization.group_logos.default:""}},{key:"getSelectedOrganization",value:function(e){return e.selectedOrganization}},{key:"getSelectedOrganizationProductAccountId",value:function(e){return Object(ie.get)(e,"organization.product_acctid")}},{key:"getOrganizationProfile",value:function(e){return e.organizationProfile}},{key:"getOrganizationAccountSettings",value:function(e){return Object(ie.get)(e,"organization.group_attributes",[]).filter((function(e){return"account_settings"===e.type})).map((function(e){return c({},e.name,{value:e.value})}))}},{key:"getCollections",value:function(e){return e.collections}},{key:"getSelectedCollection",value:function(e){return e.selectedCollection}},{key:"getReorderingCollections",value:function(e){return e.reorderingCollections}},{key:"getAddingCollection",value:function(e){return e.addingCollection}},{key:"getRemovingCollection",value:function(e){return e.removingCollection}},{key:"getUpdatingCollection",value:function(e){return e.updatingCollection}},{key:"getCollectionRenaming",value:function(e){return e.collectionRenaming}},{key:"getWidgetURL",value:function(e){return e.widgetURL}},{key:"getWidgetOptions",value:function(e){return e.widgetOptions}},{key:"getAppFeatures",value:function(e){return e.appFeatures}},{key:"getCreating",value:function(e){return e.creating}},{key:"getUpdating",value:function(e){return e.updating}},{key:"getCollectionsLoading",value:function(e){return e.loadingCollections}},{key:"hasOrganization",value:function(e){return!Object(ie.isNil)(e.organization)}},{key:"isTrial",value:function(e){return Object(ie.get)(e,"organization.subscription.type","").includes("Trial")}},{key:"isTrialExpired",value:function(e){return!0===Object(ie.get)(e,"organization.subscription.expired",!1)}},{key:"getSubscriptionEndDate",value:function(e){var t=Object(ie.get)(e,"organization.subscription.paid_through_date_time");return Object(ie.isNil)(t)?void 0:new Date(t)}},{key:"getExternalAccount",value:function(e){var t=e.organization;return null==t?void 0:t.external_account}}]),e}()).\u0275fac=function(e){return new(e||nU)(j.Zb(ye),j.Zb(j_),j.Zb(Oe),j.Zb(Ry))},nU.\u0275prov=j.Lb({token:nU,factory:nU.\u0275fac}),GU([Object(L.a)(Hy),ZU("design:type",Function),ZU("design:paramtypes",[Object,Hy]),ZU("design:returntype",void 0)],nU.prototype,"selectOrganization",null),GU([Object(L.a)(By),ZU("design:type",Function),ZU("design:paramtypes",[Object,By]),ZU("design:returntype",void 0)],nU.prototype,"setOrganizations",null),GU([Object(L.a)(qy),ZU("design:type",Function),ZU("design:paramtypes",[Object,qy]),ZU("design:returntype",void 0)],nU.prototype,"getCollections",null),GU([Object(L.a)($y),ZU("design:type",Function),ZU("design:paramtypes",[Object,$y]),ZU("design:returntype",void 0)],nU.prototype,"getCollectionsSuccess",null),GU([Object(L.a)(Qy),ZU("design:type",Function),ZU("design:paramtypes",[Object,Qy]),ZU("design:returntype",void 0)],nU.prototype,"selectCollection",null),GU([Object(L.a)(Wy),ZU("design:type",Function),ZU("design:paramtypes",[Object,Wy]),ZU("design:returntype",void 0)],nU.prototype,"addCollection",null),GU([Object(L.a)(Ky),ZU("design:type",Function),ZU("design:paramtypes",[Object,Ky]),ZU("design:returntype",void 0)],nU.prototype,"addCollectionSuccess",null),GU([Object(L.a)(Gy),ZU("design:type",Function),ZU("design:paramtypes",[Object,Gy]),ZU("design:returntype",void 0)],nU.prototype,"addCollectionError",null),GU([Object(L.a)(Zy),ZU("design:type",Function),ZU("design:paramtypes",[Object,Zy]),ZU("design:returntype",void 0)],nU.prototype,"removeCollection",null),GU([Object(L.a)(Jy),ZU("design:type",Function),ZU("design:paramtypes",[Object,Jy]),ZU("design:returntype",void 0)],nU.prototype,"removeCollectionSuccess",null),GU([Object(L.a)(Xy),ZU("design:type",Function),ZU("design:paramtypes",[Object,Xy]),ZU("design:returntype",void 0)],nU.prototype,"removeCollectionError",null),GU([Object(L.a)(Yy),ZU("design:type",Function),ZU("design:paramtypes",[Object,Yy]),ZU("design:returntype",void 0)],nU.prototype,"setCollectionRenameMode",null),GU([Object(L.a)(ex),ZU("design:type",Function),ZU("design:paramtypes",[Object,ex]),ZU("design:returntype",void 0)],nU.prototype,"renameCollection",null),GU([Object(L.a)(tx),ZU("design:type",Function),ZU("design:paramtypes",[Object,tx]),ZU("design:returntype",void 0)],nU.prototype,"renameCollectionSuccess",null),GU([Object(L.a)(nx),ZU("design:type",Function),ZU("design:paramtypes",[Object,nx]),ZU("design:returntype",void 0)],nU.prototype,"renameCollectionError",null),GU([Object(L.a)(ix),ZU("design:type",Function),ZU("design:paramtypes",[Object,ix]),ZU("design:returntype",void 0)],nU.prototype,"reorderCollections",null),GU([Object(L.a)(ox),ZU("design:type",Function),ZU("design:paramtypes",[Object,ox]),ZU("design:returntype",void 0)],nU.prototype,"reorderCollectionsSuccess",null),GU([Object(L.a)(ax),ZU("design:type",Function),ZU("design:paramtypes",[Object,ax]),ZU("design:returntype",void 0)],nU.prototype,"resetOrganizations",null),GU([Object(L.a)(sx),ZU("design:type",Function),ZU("design:paramtypes",[Object,sx]),ZU("design:returntype",void 0)],nU.prototype,"createOrganization",null),GU([Object(L.a)(cx),ZU("design:type",Function),ZU("design:paramtypes",[Object]),ZU("design:returntype",void 0)],nU.prototype,"createOrganizationSuccess",null),GU([Object(L.a)(lx),ZU("design:type",Function),ZU("design:paramtypes",[Object,lx]),ZU("design:returntype",void 0)],nU.prototype,"createOrganizationFail",null),GU([Object(L.a)(px),ZU("design:type",Function),ZU("design:paramtypes",[Object,px]),ZU("design:returntype",void 0)],nU.prototype,"updateOrganization",null),GU([Object(L.a)(gx),ZU("design:type",Function),ZU("design:paramtypes",[Object,gx]),ZU("design:returntype",void 0)],nU.prototype,"getOrganizationProfile",null),GU([Object(L.a)(hx),ZU("design:type",Function),ZU("design:paramtypes",[Object,hx]),ZU("design:returntype",void 0)],nU.prototype,"getOrganizationProfileSuccess",null),GU([Object(L.a)(bx),ZU("design:type",Function),ZU("design:paramtypes",[Object,bx]),ZU("design:returntype",void 0)],nU.prototype,"clearOrganizationProfile",null),GU([Object(L.e)(),ZU("design:type",Function),ZU("design:paramtypes",[KU]),ZU("design:returntype",void 0)],nU,"getOrganizations",null),GU([Object(L.e)(),ZU("design:type",Function),ZU("design:paramtypes",[KU]),ZU("design:returntype",void 0)],nU,"getOrganization",null),GU([Object(L.e)(),ZU("design:type",Function),ZU("design:paramtypes",[KU]),ZU("design:returntype",String)],nU,"getOrganizationLogo",null),GU([Object(L.e)(),ZU("design:type",Function),ZU("design:paramtypes",[KU]),ZU("design:returntype",void 0)],nU,"getSelectedOrganization",null),GU([Object(L.e)(),ZU("design:type",Function),ZU("design:paramtypes",[KU]),ZU("design:returntype",String)],nU,"getSelectedOrganizationProductAccountId",null),GU([Object(L.e)(),ZU("design:type",Function),ZU("design:paramtypes",[KU]),ZU("design:returntype",void 0)],nU,"getOrganizationProfile",null),GU([Object(L.e)(),ZU("design:type",Function),ZU("design:paramtypes",[KU]),ZU("design:returntype",Array)],nU,"getOrganizationAccountSettings",null),GU([Object(L.e)(),ZU("design:type",Function),ZU("design:paramtypes",[KU]),ZU("design:returntype",void 0)],nU,"getCollections",null),GU([Object(L.e)(),ZU("design:type",Function),ZU("design:paramtypes",[KU]),ZU("design:returntype",void 0)],nU,"getSelectedCollection",null),GU([Object(L.e)(),ZU("design:type",Function),ZU("design:paramtypes",[KU]),ZU("design:returntype",void 0)],nU,"getReorderingCollections",null),GU([Object(L.e)(),ZU("design:type",Function),ZU("design:paramtypes",[KU]),ZU("design:returntype",void 0)],nU,"getAddingCollection",null),GU([Object(L.e)(),ZU("design:type",Function),ZU("design:paramtypes",[KU]),ZU("design:returntype",void 0)],nU,"getRemovingCollection",null),GU([Object(L.e)(),ZU("design:type",Function),ZU("design:paramtypes",[KU]),ZU("design:returntype",void 0)],nU,"getUpdatingCollection",null),GU([Object(L.e)(),ZU("design:type",Function),ZU("design:paramtypes",[KU]),ZU("design:returntype",void 0)],nU,"getCollectionRenaming",null),GU([Object(L.e)(),ZU("design:type",Function),ZU("design:paramtypes",[KU]),ZU("design:returntype",void 0)],nU,"getWidgetURL",null),GU([Object(L.e)(),ZU("design:type",Function),ZU("design:paramtypes",[KU]),ZU("design:returntype",void 0)],nU,"getWidgetOptions",null),GU([Object(L.e)(),ZU("design:type",Function),ZU("design:paramtypes",[KU]),ZU("design:returntype",void 0)],nU,"getAppFeatures",null),GU([Object(L.e)(),ZU("design:type",Function),ZU("design:paramtypes",[KU]),ZU("design:returntype",void 0)],nU,"getCreating",null),GU([Object(L.e)(),ZU("design:type",Function),ZU("design:paramtypes",[KU]),ZU("design:returntype",void 0)],nU,"getUpdating",null),GU([Object(L.e)(),ZU("design:type",Function),ZU("design:paramtypes",[KU]),ZU("design:returntype",void 0)],nU,"getCollectionsLoading",null),GU([Object(L.e)(),ZU("design:type",Function),ZU("design:paramtypes",[KU]),ZU("design:returntype",void 0)],nU,"hasOrganization",null),GU([Object(L.e)(),ZU("design:type",Function),ZU("design:paramtypes",[KU]),ZU("design:returntype",void 0)],nU,"isTrial",null),GU([Object(L.e)(),ZU("design:type",Function),ZU("design:paramtypes",[KU]),ZU("design:returntype",void 0)],nU,"isTrialExpired",null),GU([Object(L.e)(),ZU("design:type",Function),ZU("design:paramtypes",[KU]),ZU("design:returntype",void 0)],nU,"getSubscriptionEndDate",null),GU([Object(L.e)(),ZU("design:type",Function),ZU("design:paramtypes",[KU]),ZU("design:returntype",Object)],nU,"getExternalAccount",null),nU=GU([Object(L.f)({name:"organizations",defaults:JU})],nU)),YU=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},eD=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},tD={publishing:!1,widgetURL:"/viewer",dimensions:b_.dimensions,minDimensions:{width:300,height:400}},nD=((rU=function(){function e(t,n,i,o){y(this,e),this.publishService=t,this.store=n,this.snackbar=i,this.pendoService=o}return v(e,[{key:"setPublishWidgetURL",value:function(e,t){e.patchState({widgetURL:t.widgetURL||"/viewer"})}},{key:"setPublishDimensions",value:function(e,t){e.patchState({dimensions:t.dimensions})}},{key:"getPublishURL",value:function(e,t){var n=t.model,i=t.camera,o=t.widgetOptions,r=e.getState().widgetURL,a=this.store.selectSnapshot(Ex.getUserLanguage),s=this.store.selectSnapshot(Ex.getSelectedUserApp),c=this.store.selectSnapshot(XU.getSelectedOrganizationProductAccountId);this.publishService.generateWidgetURL(n,r,o,i,k_.Single,a,s,c).subscribe((function(t){e.dispatch(new AU(n,t))}),(function(){e.dispatch(new RU(n))}))}},{key:"getPublishURLSuccess",value:function(e,t){this.pendoService.track("Publish - Success",{type:"url",source:"publish"})}},{key:"getPublishURLFail",value:function(e,t){this.snackbar.open("Unable to generate URL.")}},{key:"getPublishIFrame",value:function(e,t){var n=t.model,i=t.camera,o=t.widgetOptions,r=e.getState(),a=r.widgetURL,s=r.dimensions,c=this.store.selectSnapshot(Ex.getUserLanguage),l=this.store.selectSnapshot(Ex.getSelectedUserApp),p=this.store.selectSnapshot(XU.getSelectedOrganizationProductAccountId);this.publishService.generateWidgetEmbed(n,a,o,s,i,k_.Single,c,l,p).subscribe((function(t){e.dispatch(new LU(t))}),(function(){e.dispatch(new EU)}))}},{key:"setPublishIFrameSuccess",value:function(e,t){this.pendoService.track("Publish - Success",{type:"iframe",source:"publish"})}},{key:"savePublishImage",value:function(e,t){var n=t.imageData,i=t.imageType;this.publishService.saveUserImage(n,i).subscribe((function(t){e.dispatch(new HU(t))}),(function(){e.dispatch(new QU)}))}},{key:"savePublishImageSuccess",value:function(e,t){this.pendoService.track("Publish - Success",{type:"image",source:"publish"})}},{key:"getPublishImage",value:function(e,t){var n=this,i=t.model,o=t.camera,r=t.widgetOptions,a=t.imageData,s=t.fileType,c=e.getState().widgetURL,l=this.store.selectSnapshot(Ex.getUserLanguage),p=this.store.selectSnapshot(Ex.getSelectedUserApp);Object(Ls.a)(this.publishService.generateWidgetURL(i,c,r,o,k_.Single,l,p),this.publishService.saveUserImage(a,s)).subscribe((function(t){var o=d(t,2),r=o[0],a=o[1],s=n.publishService.getImageEmbed(i.title,r,a);e.dispatch(new $U(s))}),(function(){e.dispatch(new WU)}))}},{key:"setPublishing",value:function(e,t){var n=t.publishing;e.patchState({publishing:n})}},{key:"resetPublish",value:function(e,t){e.setState(tD)}}],[{key:"getDimensions",value:function(e){return e.dimensions}},{key:"getMinDimensions",value:function(e){return e.minDimensions}},{key:"getWidgetURL",value:function(e){return e.widgetURL}},{key:"getPublishing",value:function(e){return e.publishing}}]),e}()).\u0275fac=function(e){return new(e||rU)(j.Zb(j_),j.Zb(L.g),j.Zb(Sd.b),j.Zb(Oe))},rU.\u0275prov=j.Lb({token:rU,factory:rU.\u0275fac}),YU([Object(L.a)(TU),eD("design:type",Function),eD("design:paramtypes",[Object,TU]),eD("design:returntype",void 0)],rU.prototype,"setPublishWidgetURL",null),YU([Object(L.a)(UU),eD("design:type",Function),eD("design:paramtypes",[Object,UU]),eD("design:returntype",void 0)],rU.prototype,"setPublishDimensions",null),YU([Object(L.a)(FU),eD("design:type",Function),eD("design:paramtypes",[Object,FU]),eD("design:returntype",void 0)],rU.prototype,"getPublishURL",null),YU([Object(L.a)(AU),eD("design:type",Function),eD("design:paramtypes",[Object,AU]),eD("design:returntype",void 0)],rU.prototype,"getPublishURLSuccess",null),YU([Object(L.a)(RU),eD("design:type",Function),eD("design:paramtypes",[Object,RU]),eD("design:returntype",void 0)],rU.prototype,"getPublishURLFail",null),YU([Object(L.a)(DU),eD("design:type",Function),eD("design:paramtypes",[Object,DU]),eD("design:returntype",void 0)],rU.prototype,"getPublishIFrame",null),YU([Object(L.a)(LU),eD("design:type",Function),eD("design:paramtypes",[Object,LU]),eD("design:returntype",void 0)],rU.prototype,"setPublishIFrameSuccess",null),YU([Object(L.a)(BU),eD("design:type",Function),eD("design:paramtypes",[Object,BU]),eD("design:returntype",void 0)],rU.prototype,"savePublishImage",null),YU([Object(L.a)(HU),eD("design:type",Function),eD("design:paramtypes",[Object,HU]),eD("design:returntype",void 0)],rU.prototype,"savePublishImageSuccess",null),YU([Object(L.a)(qU),eD("design:type",Function),eD("design:paramtypes",[Object,qU]),eD("design:returntype",void 0)],rU.prototype,"getPublishImage",null),YU([Object(L.a)(VU),eD("design:type",Function),eD("design:paramtypes",[Object,VU]),eD("design:returntype",void 0)],rU.prototype,"setPublishing",null),YU([Object(L.a)(NU),eD("design:type",Function),eD("design:paramtypes",[Object,NU]),eD("design:returntype",void 0)],rU.prototype,"resetPublish",null),YU([Object(L.e)(),eD("design:type",Function),eD("design:paramtypes",[zU]),eD("design:returntype",void 0)],rU,"getDimensions",null),YU([Object(L.e)(),eD("design:type",Function),eD("design:paramtypes",[zU]),eD("design:returntype",void 0)],rU,"getMinDimensions",null),YU([Object(L.e)(),eD("design:type",Function),eD("design:paramtypes",[zU]),eD("design:returntype",void 0)],rU,"getWidgetURL",null),YU([Object(L.e)(),eD("design:type",Function),eD("design:paramtypes",[zU]),eD("design:returntype",void 0)],rU,"getPublishing",null),rU=YU([Object(L.f)({name:"publish",defaults:tD})],rU)),iD=((oU=function e(){y(this,e)}).\u0275mod=j.Nb({type:oU}),oU.\u0275inj=j.Mb({factory:function(e){return new(e||oU)},imports:[[we.c,MT,mh.r,IU,IT.a,L.c.forFeature([nD])]]}),oU),oD=((iU=function e(){y(this,e)}).\u0275mod=j.Nb({type:iU}),iU.\u0275inj=j.Mb({factory:function(e){return new(e||iU)},imports:[[L.c.forFeature([H_]),we.c,MT,mh.r,IU,te.f,iD,ne.d]]}),iU),rD=function e(){y(this,e)},aD=function(e){return e[e.Query=0]="Query",e[e.Path=1]="Path",e}({}),sD=function(e){return e[e.List=0]="List",e[e.Card=1]="Card",e}({}),cD=T.application===P.Loft?sD.List:sD.Card,lD=function(e){return e.Success="success",e.Fail="fail",e}({}),pD="cdb/content",uD="cdb/copy/content",dD={headers:new Q.d({"Content-Type":"application/json; charset=utf-8"})},gD=["production","client","preview","internal_content","public_preview","demos","social","exports","real_data"],hD=((aU=function(){function e(t,n){y(this,e),this.http=t,this.serializeModuleService=n}return v(e,[{key:"saveModule",value:function(e,t){t=this.formatModulePath(t);var n=[pD,"modules",t].join("/"),i=this.JSONStringify(e);return this.http.put(n,i,dD).pipe(Object(se.a)((function(){return lD.Success})),Object(xr.a)((function(e){var t=e.status;return t>=200&&t<=202?Object(br.a)(lD.Success):Object(br.a)(lD.Fail)})))}},{key:"mergeModule",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"exception";return this.http.post("/cdb/merge/modules",{loft:e+".json",bridge:t+".json",merge_option:n})}},{key:"copyState",value:function(e,t){var n=[uD,"states",t].join("/"),i={headers:new Q.d({"Content-Type":"application/json; charset=utf-8","source-state":e})};return this.http.put(n,{},i)}},{key:"listContents",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=this.generateModulePath(e,t||"",n||"");return this.http.get("/cdb/ls/content/modules/"+o).pipe(Object(se.a)((function(e){return i?e.contents.map((function(e){var t=e.name.replace("/content/modules/","").replace(".json",""),n=e.name.split("/").pop().replace("/content/modules","").replace(".json",""),i=new ue;return i.id=t,i.title=n,i.type=M.Module,i})):e.contents})))}},{key:"getState",value:function(e){return this.http.get("/cdb/ls/content/states/"+e).pipe(Object(se.a)((function(e){return e.contents})))}},{key:"getClients",value:function(){return this.http.get("/search/client").pipe(Object(se.a)((function(e){return e.clients})))}},{key:"getUsedStates",value:function(){var e=this,t={};return Object.values(Human.scene.objects).reduce((function(n,i){return["transformId","morphId","geometryId","materialId"].forEach((function(n){var o=e.getPropertyState(i,n);o.length&&(t[o]=!0)})),i.hasOwnProperty("renderables")&&["morphId","geometryId","materialId"].forEach((function(n){i.renderables.forEach((function(i){var o=e.getPropertyState(i,n);o.length&&(t[o]=!0)}))})),n}),{}),Object.keys(t)}},{key:"parseScenePath",value:function(e){var t=e.split("/");return 1===t.length?null:{fullPath:"https://qa.biodigital.com/content/modules/"+e,relativePath:t.slice(0,t.length-1).join("/"),sceneName:t[t.length-1]}}},{key:"formatModulePath",value:function(e){var t=e;return/\.json$/.test(e)||(t+=".json"),t}},{key:"getPrimaryCategories",value:function(){return Object(br.a)(gD)}},{key:"getSecondaryCategories",value:function(e){switch(e){case"production":return Object(br.a)(["maleAdult","femaleAdult"]);case"client":return this.getClients();default:return Object(br.a)([])}}},{key:"generateSaveModule",value:function(e){var t=this.parseScenePath(e),n=t.relativePath.split("/");return{id:e,name:t.sceneName,primaryCategory:n[0]||"",secondaryCategory:n[1]||""}}},{key:"generateModulePath",value:function(e,t,n){var i=[];return e.length&&i.push(e),t.length&&i.push(t),n.length&&(n.indexOf(".json")<0&&(n+=".json"),i.push(n)),i.join("/")}},{key:"getPropertyState",value:function(e,t){return null!=e[t]?e[t].split("/")[0]:""}},{key:"JSONStringify",value:function(e){return JSON.stringify(e).replace(/[\u007f-\uffff]/g,(function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)}))}}]),e}()).\u0275fac=function(e){return new(e||aU)(j.Zb(Q.b),j.Zb(Cc))},aU.\u0275prov=j.Lb({token:aU,factory:aU.\u0275fac,providedIn:"root"}),aU),fD=function(e){return e.Organization="Organization",e.Collection="Collection",e.Private="Private",e.Category="Category",e.Community="Community",e.Internal="Internal",e.Loft="Loft",e}({}),bD=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1?arguments[1]:void 0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:25,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;y(this,e),this.query=t,this.sortBy=n,this.pageSize=i,this.offset=o},mD=function e(){y(this,e)},vD=((cU=function(){function e(t){y(this,e),this.store=t}return v(e,[{key:"ngOnInit",value:function(){}},{key:"close",value:function(){this.store.dispatch(new zy.ShowFilters(!1,!0))}}]),e}()).\u0275fac=function(e){return new(e||cU)(j.Pb(L.g))},cU.\u0275cmp=j.Jb({type:cU,selectors:[["app-gallery-drawer"]],decls:8,vars:2,consts:[["appEventFence","","data-test","galleryDrawer",1,"gallery-drawer"],[1,"gallery-drawer__header"],[1,"gallery-drawer__label"],["app-button","","buttonType","ghost","buttonTheme","light","type","button","title","Close","data-test","galleryDrawerClose",3,"click"],["icon","times","size","lg"],[1,"gallery-drawer__body"],["viewMode","expanded"]],template:function(e,t){1&e&&(j.Vb(0,"div",0),j.Vb(1,"div",1),j.Vb(2,"h1",2),j.Kc(3,"Filters"),j.Ub(),j.Vb(4,"button",3),j.cc("click",(function(){return t.close()})),j.Qb(5,"app-icon",4),j.Ub(),j.Ub(),j.Vb(6,"div",5),j.Qb(7,"app-gallery-filters",6),j.Ub(),j.Ub()),2&e&&(j.lc("@expand",void 0),j.Db(4),j.Eb("aria-label","Close"))},styles:[".text-8[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase[_ngcontent-%COMP%]{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase[_ngcontent-%COMP%]{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase[_ngcontent-%COMP%]{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase[_ngcontent-%COMP%]{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-28[_ngcontent-%COMP%]{font-size:28px;letter-spacing:.7px;line-height:1.4em}.text-28.text-uppercase[_ngcontent-%COMP%]{font-size:28px;letter-spacing:1.68px;line-height:1.25em;text-transform:uppercase}.text-header[_ngcontent-%COMP%]{font-weight:700}.text--code[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.text-xlight[_ngcontent-%COMP%]{font-weight:200}.text-light[_ngcontent-%COMP%]{font-weight:300}.text-medium[_ngcontent-%COMP%]{font-weight:500}.text-semibold[_ngcontent-%COMP%]{font-weight:600}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-underline[_ngcontent-%COMP%]{text-decoration:underline}.text-italic[_ngcontent-%COMP%]{font-style:italic}.text-bright[_ngcontent-%COMP%]{color:#fff}.text-dim[_ngcontent-%COMP%]{color:#96a8c0}.text-error[_ngcontent-%COMP%]{color:#ed4758}.text-left[_ngcontent-%COMP%]{text-align:left}.text-center[_ngcontent-%COMP%]{text-align:center}.text-right[_ngcontent-%COMP%]{text-align:right}.text-ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link[_ngcontent-%COMP%], .text-link[_ngcontent-%COMP%]:visited{color:inherit;cursor:pointer}.text-link[_ngcontent-%COMP%]:not(.text-underline), .text-link[_ngcontent-%COMP%]:visited:not(.text-underline){text-decoration:none}.text-success[_ngcontent-%COMP%]{color:#38de38}.text-danger[_ngcontent-%COMP%]{color:#de3535}.text-info[_ngcontent-%COMP%]{color:#2d72dc}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.text-pre-line[_ngcontent-%COMP%]{white-space:pre-line}.gallery-drawer[_ngcontent-%COMP%]{box-shadow:0 11px 15px rgba(0,0,0,.2),0 24px 38px rgba(0,0,0,.14),0 9px 46px rgba(0,0,0,.12);background:#fff;border-radius:16px 16px 0 0;display:block;position:fixed;bottom:0;top:auto;width:100vw}.gallery-drawer__header[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em;font-weight:600;border-bottom:1px solid #eaeff5;height:52px;padding:0 12px 0 20px;display:flex;align-items:center}.gallery-drawer__label[_ngcontent-%COMP%]{flex:1 0 auto}.gallery-drawer__body[_ngcontent-%COMP%]{padding:20px}"],data:{animation:[Object(du.n)("expand",[Object(du.m)(":enter",[Object(du.j)([Object(du.l)({top:"100%"}),Object(du.e)("250ms ease-in-out",Object(du.l)({top:"*"}))])])])]},changeDetection:0}),cU),yD=((sU=function(){function e(t,n){y(this,e),this.overlay=t,this.store=n}return v(e,[{key:"openDrawer",value:function(){this.overlayRef||this._createOverlay();var e=new GC.c(vD);this.overlayRef.attach(e)}},{key:"closeDrawer",value:function(){this.overlayRef.detach()}},{key:"_createOverlay",value:function(){var e=this,t=new WC.d({hasBackdrop:!0,scrollStrategy:this.overlay.scrollStrategies.block()});this.overlayRef=this.overlay.create(t),this.overlayRef.backdropClick().subscribe((function(){e.store.dispatch(new zy.ShowFilters(!1,!0))}))}}]),e}()).\u0275fac=function(e){return new(e||sU)(j.Zb(WC.c),j.Zb(L.g))},sU.\u0275prov=j.Lb({token:sU,factory:sU.\u0275fac,providedIn:"root"}),sU),xD={title:"Tags",tags:["Animated","Tour","Quiz","featured","new"]},OD={title:"Type",tags:["Anatomy","Disease","Pharmacology","Physiology","Procedure"]},wD={title:"Level of Detail",tags:["Gross Anatomy","Tissue","Cellular","Molecular"]},kD={title:"Downloaded",tags:["Downloaded"]},CD=[{title:"Status",tags:["Live","obsolete"]},{title:"Paywall",tags:["Premium","Basic"]},{title:"Platform",tags:["web platform","ios platform","android platform"]},xD,{title:"Flags",tags:["animated","tour","Audio","low definition"]},{title:"Gender",tags:["male","female"]},OD,wD,{title:"Anatomy Categories",tags:["complete anatomy","system","regional","Bony Landmarks","Cross Section","Cross Section and Micro Anatomy","Micro Anatomy","Origins and Insertions"]},{title:"Clinical Specialty",tags:["Allergy and Immunology","Cardiology","Dentistry","Dermatology","Endocrinology","Gastroenterology and Hepatology","Gynecology","Infectious Disease","Nephrology","Neurology and Psychiatry","Obstetrics","Oncology and Hematology","Ophthalmology","Orthopedics","Otolaryngology","Pediatrics","Physical Therapy","Pulmonology and Respiratory","Rheumatology","Urology"]},{title:"Health Conditions",tags:["Blood, Heart and Circulation","Brain and Nerves","Ear, Nose and Throat","Eyes and Vision","Immune System","Lungs and Breathing","Mouth and Teeth","Bones, Joints and Muscles","Digestive System","Endocrine System","Female Reproductive System","Male Reproductive System","Skin, Hair and Nail"]},kD],SD=function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";y(this,e),this.categoryId=t,this.tags=n,this.query=i,this.type=fD.Category},_D=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];y(this,e),this.query=t,this.tags=n,this.categoryId="public",this.type=fD.Community},jD=((lU=function(){function e(){y(this,e)}return v(e,[{key:"on",value:function(e,t){Human.events.on(e,t)}},{key:"send",value:function(t,n){var i=null,o={};switch(t){case DI.NativeErrorMessage:(i=e.snackBar.open(n,"OK",{duration:6e3,verticalPosition:"top"})).onAction().subscribe((function(){i.dismiss()}));break;case DI.NativeSetAppVersion:e.appVersion=n.appVersion;break;case DI.NativeRedirect:o=JSON.parse(n.queryItems),e.router.navigate([n.url],{queryParams:o});break;case DI.NativeReload:window.location.href=n.url;break;case DI.NativeOfflineModelIds:e.setOfflineModelIDs(n.modelIds);break;default:Human.events.fire(yn.NativeDebugMessage,"unprocessed HumanWindowAPI send "+t)}}}],[{key:"getOfflineModelIDs",value:function(){return e._offlineModelIDs$}},{key:"setOfflineModelIDs",value:function(t){e._offlineModelIDs.next(t)}},{key:"getOfflineModelIDList",value:function(){return this._offlineModelIDs.getValue()}},{key:"setStore",value:function(t){e.store=t}},{key:"setSnackBar",value:function(t){e.snackBar=t}},{key:"setRouter",value:function(t){e.router=t}},{key:"debug",value:function(e){"undefined"!=typeof Human&&void 0!==Human.events&&Human.events.fire(yn.NativeDebugMessage,e)}},{key:"fire",value:function(e,t){Human.events.fire(e,t)}}]),e}()).store=null,lU.snackBar=null,lU.router=null,lU.appVersion="",lU._offlineModelIDs=new kp.a([]),lU._offlineModelIDs$=lU._offlineModelIDs.asObservable(),lU),PD=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},MD=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},ID={loading:!0,searchMode:aD.Query,viewMode:cD,showFilters:!1,searchResults:{total:0,items:[]},checkedResults:[],searchConfig:null,searchOptions:null,sidenav:{enabled:!0,open:!0,disableClose:!1},bulkActions:{enabled:!0,active:!1,items:[]},cardActions:{enabled:!0}},zD=[].concat(p(OD.tags),p(wD.tags),p(xD.tags)),TD=((pU=function(){function e(t,n,i,o,r,a){y(this,e),this.organizationsService=t,this.modulesService=n,this.exploreService=i,this.bookmarksService=o,this.galleryService=r,this.store=a}return v(e,[{key:"setSearchMode",value:function(e,t){e.patchState({searchMode:t.searchMode})}},{key:"setViewMode",value:function(e,t){e.patchState({viewMode:t.viewMode})}},{key:"showFilters",value:function(e,t){e.patchState({showFilters:t.show}),t.triggerDrawer&&(t.show?this.galleryService.openDrawer():this.galleryService.closeDrawer())}},{key:"setSearchOptions",value:function(e,t){e.patchState({searchOptions:Object.assign({},t.options)})}},{key:"setActiveTags",value:function(e,t){var n=e.getState().searchConfig,i=Object.assign(Object.assign({},n),{tags:Object(ie.flatten)(Object.values(t.activeTags))});this.store.dispatch(new zy.SetSearchConfig(i))}},{key:"setSearchConfig",value:function(e,t){var n=t.config||e.getState().searchConfig,i=t.options||e.getState().searchOptions;null!==n&&e.patchState({searchOptions:Object.assign({},i),searchConfig:Object.assign({},n)})}},{key:"searchCategory",value:function(e,t){var n=t.categoryId,i="public"===n?new _D(""):new SD(n);e.dispatch(new zy.SetSearchConfig(i))}},{key:"searchStudio",value:function(e,t){var n=e.getState(),i=n.searchConfig,o=n.searchOptions,r=new bD("",p_),a=this.store.selectSnapshot(Ex.getUserLanguage);e.patchState({loading:!0,searchOptions:Object.assign(Object.assign({},o),{pageSize:r.pageSize,offset:r.offset}),checkedResults:[]});var s=new J.a;switch(i.type){case fD.Category:s=this.exploreService.getAnatomyCategory(i.query,"all"===i.categoryId?"":i.categoryId,i.tags.filter((function(e){return!e.startsWith("Downloaded")})),a);break;case fD.Organization:s=this.bookmarksService.getOrganizationContent(i.organizationId,i.query);break;case fD.Collection:s=this.organizationsService.getCollectionContent(i.organizationId,i.collectionId,i.query);break;case fD.Community:s=this.bookmarksService.getPublicBookmarks(i.query);break;case fD.Private:s=this.bookmarksService.getPrivateContent(i.query);break;case fD.Internal:s=this.exploreService.searchInternal(i.query,i.directory);break;case fD.Loft:var c=i.query.indexOf(".json")>0;s=this.modulesService.listContents(i.primary,i.secondary,c?i.query:"",!0).pipe(Object(se.a)((function(e){return c?e:e.filter((function(e){return e.title.indexOf(i.query)>=0}))})))}s.pipe(Object(Ss.a)((function(){return e.patchState({loading:!1})}))).subscribe((function(t){var n=T.native?jD.getOfflineModelIDList():[],o=i.tags.includes("Downloaded")?t.filter((function(e){return n.includes(e.id)})):t;e.dispatch(new zy.SearchSuccess(o))}))}},{key:"searchSuccess",value:function(e,t){e.patchState({searchResults:{items:t.bookmarks,total:t.bookmarks.length}})}},{key:"checkItem",value:function(e,t){var n=e.getState().checkedResults,i=n.some((function(e){return e===t.id}));t.checked&&!i?n=[].concat(p(n),[t.id]):t.checked||(n=n.filter((function(e){return e!==t.id}))),e.patchState({checkedResults:n})}},{key:"checkAll",value:function(e,t){var n=e.getState().searchResults.items.map((function(e){return e.id}));e.patchState({checkedResults:n})}},{key:"uncheckAll",value:function(e,t){e.patchState({checkedResults:[]})}},{key:"setCheckedItems",value:function(e,t){e.patchState({checkedResults:t.ids})}},{key:"setSidenav",value:function(e,t){e.patchState({sidenav:Object.assign({},t.sidenav)})}},{key:"setCardActions",value:function(e,t){e.patchState({cardActions:Object.assign({},t.cardActions)})}},{key:"setBulkActions",value:function(e,t){var n=e.getState().bulkActions;e.patchState({bulkActions:Object.assign(Object.assign({},n),t.bulkActions)})}},{key:"clearResults",value:function(e,t){e.patchState({searchResults:{items:[],total:0}})}},{key:"resetGallery",value:function(e,t){e.patchState(ID)}}],[{key:"getLoading",value:function(e){return e.loading}},{key:"getSearchMode",value:function(e){return e.searchMode}},{key:"getSearchConfig",value:function(e){return e.searchConfig}},{key:"getSearchOptions",value:function(e){return e.searchOptions}},{key:"getAvailableTags",value:function(e){var t=[],n=e.searchResults.items,i=T.native?jD.getOfflineModelIDList():[];return n.forEach((function(e){e.tags.forEach((function(e){"quiz"===e&&(e="Quiz"),zD.includes(e)&&!t.includes(e)&&t.push(e)})),T.native&&i.includes(e.id)&&!t.includes("Downloaded")&&t.push("Downloaded")})),t}},{key:"getActiveTags",value:function(e){var t={};return e.searchConfig.tags.forEach((function(e){var n=CD.find((function(t){return t.tags.some((function(t){return t===e}))})),i=Object(ie.get)(n,"title","");t[i]=e})),t}},{key:"getActiveTagsCount",value:function(e){var t=e.searchConfig;return Object(ie.compact)(t.tags).length}},{key:"getSearchType",value:function(e){return e.searchConfig?e.searchConfig.type:null}},{key:"getSearchGroup",value:function(e){var t;switch(null===(t=e.searchConfig)||void 0===t?void 0:t.type){case fD.Category:case fD.Community:case fD.Internal:case fD.Loft:return M.Module;case fD.Collection:case fD.Private:case fD.Organization:return M.Bookmark}}},{key:"getViewMode",value:function(e){return e.viewMode}},{key:"getShowFilters",value:function(e){return e.showFilters}},{key:"getSort",value:function(e){return e.searchOptions.sortBy}},{key:"getSortOptions",value:function(e){switch(e.searchConfig.type){case fD.Loft:return[p_,u_];case fD.Category:return[c_,l_,p_,u_];default:return[l_,p_,u_,d_,g_]}}},{key:"getSidenav",value:function(e){return e.sidenav}},{key:"getBulkActions",value:function(e){return e.bulkActions}},{key:"getBulkActionsAvailable",value:function(e){var t=e.bulkActions,n=t.enabled,i=t.items;return n&&i.length>0}},{key:"getBulkActionsActive",value:function(e){return e.bulkActions.active}},{key:"getCardActions",value:function(e){return e.cardActions}},{key:"getFilteredResults",value:function(e,t){var n=e.searchResults,i=e.searchOptions,o=i.sortBy,r=o.ascending,a=o.fields,s=i.offset,c=i.pageSize,l=D_(n.items,a,r).slice(s,s+c);return Object.assign(Object.assign({},n),{items:l})}},{key:"getAllResults",value:function(e,t){var n=e.searchResults,i=e.searchOptions.sortBy,o=i.ascending,r=i.fields,a=D_(n.items,r,o);return{total:n.total,items:a}}},{key:"getCheckedResults",value:function(e){return e.checkedResults}}]),e}()).\u0275fac=function(e){return new(e||pU)(j.Zb(ye),j.Zb(hD),j.Zb(T_),j.Zb(s_),j.Zb(yD),j.Zb(L.g))},pU.\u0275prov=j.Lb({token:pU,factory:pU.\u0275fac}),PD([Object(L.a)(zy.SetSearchMode),MD("design:type",Function),MD("design:paramtypes",[Object,zy.SetSearchMode]),MD("design:returntype",void 0)],pU.prototype,"setSearchMode",null),PD([Object(L.a)(zy.SetViewMode),MD("design:type",Function),MD("design:paramtypes",[Object,zy.SetViewMode]),MD("design:returntype",void 0)],pU.prototype,"setViewMode",null),PD([Object(L.a)(zy.ShowFilters),MD("design:type",Function),MD("design:paramtypes",[Object,zy.ShowFilters]),MD("design:returntype",void 0)],pU.prototype,"showFilters",null),PD([Object(L.a)(zy.SetSearchOptions),MD("design:type",Function),MD("design:paramtypes",[Object,zy.SetSearchOptions]),MD("design:returntype",void 0)],pU.prototype,"setSearchOptions",null),PD([Object(L.a)(zy.SetActiveTags),MD("design:type",Function),MD("design:paramtypes",[Object,zy.SetActiveTags]),MD("design:returntype",void 0)],pU.prototype,"setActiveTags",null),PD([Object(L.a)(zy.SetSearchConfig),MD("design:type",Function),MD("design:paramtypes",[Object,zy.SetSearchConfig]),MD("design:returntype",void 0)],pU.prototype,"setSearchConfig",null),PD([Object(L.a)(zy.SearchCategory),MD("design:type",Function),MD("design:paramtypes",[Object,zy.SearchCategory]),MD("design:returntype",void 0)],pU.prototype,"searchCategory",null),PD([Object(L.a)(zy.SearchStudio),MD("design:type",Function),MD("design:paramtypes",[Object,zy.SearchStudio]),MD("design:returntype",void 0)],pU.prototype,"searchStudio",null),PD([Object(L.a)(zy.SearchSuccess),MD("design:type",Function),MD("design:paramtypes",[Object,zy.SearchSuccess]),MD("design:returntype",void 0)],pU.prototype,"searchSuccess",null),PD([Object(L.a)(zy.CheckItem),MD("design:type",Function),MD("design:paramtypes",[Object,zy.CheckItem]),MD("design:returntype",void 0)],pU.prototype,"checkItem",null),PD([Object(L.a)(zy.CheckAll),MD("design:type",Function),MD("design:paramtypes",[Object,zy.CheckAll]),MD("design:returntype",void 0)],pU.prototype,"checkAll",null),PD([Object(L.a)(zy.UncheckAll),MD("design:type",Function),MD("design:paramtypes",[Object,zy.UncheckAll]),MD("design:returntype",void 0)],pU.prototype,"uncheckAll",null),PD([Object(L.a)(zy.SetCheckedItems),MD("design:type",Function),MD("design:paramtypes",[Object,zy.SetCheckedItems]),MD("design:returntype",void 0)],pU.prototype,"setCheckedItems",null),PD([Object(L.a)(zy.SetSidenav),MD("design:type",Function),MD("design:paramtypes",[Object,zy.SetSidenav]),MD("design:returntype",void 0)],pU.prototype,"setSidenav",null),PD([Object(L.a)(zy.SetCardActions),MD("design:type",Function),MD("design:paramtypes",[Object,zy.SetCardActions]),MD("design:returntype",void 0)],pU.prototype,"setCardActions",null),PD([Object(L.a)(zy.SetBulkActions),MD("design:type",Function),MD("design:paramtypes",[Object,zy.SetBulkActions]),MD("design:returntype",void 0)],pU.prototype,"setBulkActions",null),PD([Object(L.a)(zy.ClearResults),MD("design:type",Function),MD("design:paramtypes",[Object,zy.ClearResults]),MD("design:returntype",void 0)],pU.prototype,"clearResults",null),PD([Object(L.a)(zy.Reset),MD("design:type",Function),MD("design:paramtypes",[Object,zy.Reset]),MD("design:returntype",void 0)],pU.prototype,"resetGallery",null),PD([Object(L.e)(),MD("design:type",Function),MD("design:paramtypes",[rD]),MD("design:returntype",void 0)],pU,"getLoading",null),PD([Object(L.e)(),MD("design:type",Function),MD("design:paramtypes",[rD]),MD("design:returntype",void 0)],pU,"getSearchMode",null),PD([Object(L.e)(),MD("design:type",Function),MD("design:paramtypes",[rD]),MD("design:returntype",void 0)],pU,"getSearchConfig",null),PD([Object(L.e)(),MD("design:type",Function),MD("design:paramtypes",[rD]),MD("design:returntype",void 0)],pU,"getSearchOptions",null),PD([Object(L.e)(),MD("design:type",Function),MD("design:paramtypes",[rD]),MD("design:returntype",void 0)],pU,"getAvailableTags",null),PD([Object(L.e)(),MD("design:type",Function),MD("design:paramtypes",[rD]),MD("design:returntype",void 0)],pU,"getActiveTags",null),PD([Object(L.e)(),MD("design:type",Function),MD("design:paramtypes",[rD]),MD("design:returntype",void 0)],pU,"getActiveTagsCount",null),PD([Object(L.e)(),MD("design:type",Function),MD("design:paramtypes",[rD]),MD("design:returntype",void 0)],pU,"getSearchType",null),PD([Object(L.e)(),MD("design:type",Function),MD("design:paramtypes",[rD]),MD("design:returntype",void 0)],pU,"getSearchGroup",null),PD([Object(L.e)(),MD("design:type",Function),MD("design:paramtypes",[rD]),MD("design:returntype",void 0)],pU,"getViewMode",null),PD([Object(L.e)(),MD("design:type",Function),MD("design:paramtypes",[rD]),MD("design:returntype",void 0)],pU,"getShowFilters",null),PD([Object(L.e)(),MD("design:type",Function),MD("design:paramtypes",[rD]),MD("design:returntype",void 0)],pU,"getSort",null),PD([Object(L.e)(),MD("design:type",Function),MD("design:paramtypes",[rD]),MD("design:returntype",void 0)],pU,"getSortOptions",null),PD([Object(L.e)(),MD("design:type",Function),MD("design:paramtypes",[rD]),MD("design:returntype",void 0)],pU,"getSidenav",null),PD([Object(L.e)(),MD("design:type",Function),MD("design:paramtypes",[rD]),MD("design:returntype",void 0)],pU,"getBulkActions",null),PD([Object(L.e)(),MD("design:type",Function),MD("design:paramtypes",[rD]),MD("design:returntype",void 0)],pU,"getBulkActionsAvailable",null),PD([Object(L.e)(),MD("design:type",Function),MD("design:paramtypes",[rD]),MD("design:returntype",Boolean)],pU,"getBulkActionsActive",null),PD([Object(L.e)(),MD("design:type",Function),MD("design:paramtypes",[rD]),MD("design:returntype",void 0)],pU,"getCardActions",null),PD([Object(L.e)([Ex]),MD("design:type",Function),MD("design:paramtypes",[rD,Bm]),MD("design:returntype",mD)],pU,"getFilteredResults",null),PD([Object(L.e)(),MD("design:type",Function),MD("design:paramtypes",[rD,Bm]),MD("design:returntype",mD)],pU,"getAllResults",null),PD([Object(L.e)(),MD("design:type",Function),MD("design:paramtypes",[rD]),MD("design:returntype",void 0)],pU,"getCheckedResults",null),pU=PD([Object(L.f)({name:"gallery",defaults:ID})],pU)),UD=["app-pill-button",""],DD=function(e){return{"pill-button--selected":e}},LD=["*"],ED=((uU=function(){function e(){y(this,e),this.selected=!1}return v(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||uU)},uU.\u0275cmp=j.Jb({type:uU,selectors:[["button","app-pill-button",""],["a","app-pill-button",""]],inputs:{selected:"selected"},attrs:UD,ngContentSelectors:LD,decls:2,vars:3,consts:[[1,"pill-button",3,"ngClass"]],template:function(e,t){1&e&&(j.kc(),j.Vb(0,"span",0),j.jc(1),j.Ub()),2&e&&j.lc("ngClass",j.nc(1,DD,t.selected))},directives:[we.i],styles:[".text-8[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase[_ngcontent-%COMP%]{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase[_ngcontent-%COMP%]{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase[_ngcontent-%COMP%]{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase[_ngcontent-%COMP%]{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-28[_ngcontent-%COMP%]{font-size:28px;letter-spacing:.7px;line-height:1.4em}.text-28.text-uppercase[_ngcontent-%COMP%]{font-size:28px;letter-spacing:1.68px;line-height:1.25em;text-transform:uppercase}.text-header[_ngcontent-%COMP%]{font-weight:700}.text--code[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.text-xlight[_ngcontent-%COMP%]{font-weight:200}.text-light[_ngcontent-%COMP%]{font-weight:300}.text-medium[_ngcontent-%COMP%]{font-weight:500}.text-semibold[_ngcontent-%COMP%]{font-weight:600}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-underline[_ngcontent-%COMP%]{text-decoration:underline}.text-italic[_ngcontent-%COMP%]{font-style:italic}.text-bright[_ngcontent-%COMP%]{color:#fff}.text-dim[_ngcontent-%COMP%]{color:#96a8c0}.text-error[_ngcontent-%COMP%]{color:#ed4758}.text-left[_ngcontent-%COMP%]{text-align:left}.text-center[_ngcontent-%COMP%]{text-align:center}.text-right[_ngcontent-%COMP%]{text-align:right}.text-ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link[_ngcontent-%COMP%], .text-link[_ngcontent-%COMP%]:visited{color:inherit;cursor:pointer}.text-link[_ngcontent-%COMP%]:not(.text-underline), .text-link[_ngcontent-%COMP%]:visited:not(.text-underline){text-decoration:none}.text-success[_ngcontent-%COMP%]{color:#38de38}.text-danger[_ngcontent-%COMP%]{color:#de3535}.text-info[_ngcontent-%COMP%]{color:#2d72dc}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.text-pre-line[_ngcontent-%COMP%]{white-space:pre-line}[_nghost-%COMP%]{border-color:transparent;background:none;border-width:0;padding:0;margin:0;border-radius:4px;outline:0 none}[_nghost-%COMP%]:not([disabled]):hover{cursor:pointer}[_nghost-%COMP%]:focus   .pill-button[_ngcontent-%COMP%]{outline:2px solid #2d72dc!important}[_nghost-%COMP%]:disabled   .pill-button[_ngcontent-%COMP%], [_nghost-%COMP%]:disabled:hover   .pill-button[_ngcontent-%COMP%]{background-color:#f9fafd;color:#96a8c0}.pill-button[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em;font-family:Inter UI,sans-serif;font-weight:500;color:#374a68;display:flex;align-items:center;justify-content:center;background-color:#eaeff5;border-radius:100px;padding:8px 16px;transition:background-color .12s,color .12s;width:100%}.pill-button[_ngcontent-%COMP%]:hover{background-color:#d7e0ea}.pill-button--selected[_ngcontent-%COMP%], .pill-button--selected[_ngcontent-%COMP%]:hover{background-color:#2d72dc;color:#fff}"],changeDetection:0}),uU),FD=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function AD(e,t){if(1&e){var n=j.Wb();j.Vb(0,"li",9),j.Vb(1,"button",10),j.cc("click",(function(){j.xc(n);var e=t.$implicit,i=j.gc().$implicit,o=j.gc(2);return o.setTag(i.title,o.activeTags[i.title]===e?"":e)})),j.hc(2,"async"),j.Kc(3),j.hc(4,"titlecase"),j.Ub(),j.Ub()}if(2&e){var i=t.$implicit,o=j.gc().$implicit,r=j.gc(2),a=null;j.Db(1),j.lc("disabled",!(null!=(a=j.ic(2,3,r.availableTags$))&&a.includes(i)))("selected",r.activeTags[o.title]===i),j.Db(2),j.Mc(" ",j.ic(4,5,i)," ")}}function RD(e,t){if(1&e&&(j.Vb(0,"div",5),j.Vb(1,"h2",6),j.Kc(2),j.Ub(),j.Vb(3,"ul",7),j.Ic(4,AD,5,7,"li",8),j.Ub(),j.Ub()),2&e){var n=t.$implicit;j.Db(2),j.Lc(n.title),j.Db(2),j.lc("ngForOf",n.tags)}}function VD(e,t){if(1&e&&(j.Vb(0,"div",3),j.Ic(1,RD,5,2,"div",4),j.Ub()),2&e){var n=j.gc();j.lc("@show",void 0),j.Db(1),j.lc("ngForOf",n.tagGroups)}}function ND(e,t){if(1&e){var n=j.Wb();j.Vb(0,"li",9),j.Vb(1,"button",14),j.cc("click",(function(){j.xc(n);var e=j.gc(2).$implicit;return j.gc(2).setTag(e.title,"")})),j.Vb(2,"span",15),j.Kc(3),j.hc(4,"titlecase"),j.Ub(),j.Qb(5,"app-icon",16),j.Ub(),j.Ub()}if(2&e){var i=j.gc().$implicit;j.Db(3),j.Lc(j.ic(4,1,i))}}function BD(e,t){if(1&e&&(j.Tb(0),j.Ic(1,ND,6,3,"li",13),j.Sb()),2&e){var n=t.$implicit,i=j.gc().$implicit,o=j.gc(2);j.Db(1),j.lc("ngIf",o.activeTags[i.title]===n)}}function HD(e,t){if(1&e&&(j.Tb(0),j.Ic(1,BD,2,1,"ng-container",12),j.Sb()),2&e){var n=t.$implicit;j.Db(1),j.lc("ngForOf",n.tags)}}function QD(e,t){if(1&e&&(j.Vb(0,"ul",11),j.Ic(1,HD,2,1,"ng-container",12),j.Ub()),2&e){var n=j.gc();j.Db(1),j.lc("ngForOf",n.tagGroups)}}var qD,$D,WD,KD=((WD=function(){function e(t,n,i){y(this,e),this.changeDetectorRef=t,this.store=n,this.router=i,this.activeTagList=[],this.ngUnsubscribe=new Z.a,this._viewMode="expanded",this.tagGroups=[],this._activeTags={},this.selectedTagChange=new j.p}return v(e,[{key:"viewMode",get:function(){return this._viewMode},set:function(e){this._viewMode=e}},{key:"activeTags",get:function(){return this._activeTags},set:function(e){null==e&&(e={}),this._activeTags=e,this.activeTagList=Object.values(this.activeTags).reduce((function(e,t){return""!=t&&e.push(t),e}),[]),this.changeDetectorRef.markForCheck()}},{key:"ngOnInit",value:function(){var e=this;this.store.select(TD.getActiveTags).pipe(Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){e.activeTags=t})),this.tagGroups=[],T.native&&this.tagGroups.push(kD),this.isExplore()&&(this.tagGroups=this.tagGroups.concat([OD,wD,Object.assign(Object.assign({},xD),{tags:Object(ie.without)(xD.tags,"Quiz")})]))}},{key:"isExplore",value:function(){return this.router.url.indexOf("/results/modules")>=0}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"setTag",value:function(e,t){var n=this.store.selectSnapshot(TD.getActiveTags);n[e]=t,this.store.dispatch(new zy.SetActiveTags(n))}}]),e}()).\u0275fac=function(e){return new(e||WD)(j.Pb(j.i),j.Pb(L.g),j.Pb(te.e))},WD.\u0275cmp=j.Jb({type:WD,selectors:[["app-gallery-filters"]],inputs:{viewMode:"viewMode"},outputs:{selectedTagChange:"selectedTagChange"},decls:3,vars:2,consts:[["data-test","galleryFilters",1,"gallery-filters"],["class","gallery-filters__expanded","data-test","galleryFiltersExpanded",4,"ngIf"],["class","gallery-filters__tags","data-test","galleryFiltersSummary",4,"ngIf"],["data-test","galleryFiltersExpanded",1,"gallery-filters__expanded"],["class","gallery-filters__group",4,"ngFor","ngForOf"],[1,"gallery-filters__group"],[1,"gallery-filters__header"],[1,"gallery-filters__tags"],["class","gallery-filters__tag",4,"ngFor","ngForOf"],[1,"gallery-filters__tag"],["app-pill-button","","data-test","galleryFiltersTag",3,"disabled","selected","click"],["data-test","galleryFiltersSummary",1,"gallery-filters__tags"],[4,"ngFor","ngForOf"],["class","gallery-filters__tag",4,"ngIf"],["app-pill-button","","data-test","galleryFiltersTag",3,"click"],[1,"mr-2"],["icon","times"]],template:function(e,t){1&e&&(j.Vb(0,"div",0),j.Ic(1,VD,2,2,"div",1),j.Ic(2,QD,2,1,"ul",2),j.Ub()),2&e&&(j.Db(1),j.lc("ngIf","expanded"===t.viewMode),j.Db(1),j.lc("ngIf","summary"===t.viewMode))},directives:[we.l,we.k,ED,vp],pipes:[we.b,we.t],styles:[".text-8[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase[_ngcontent-%COMP%]{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase[_ngcontent-%COMP%]{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase[_ngcontent-%COMP%]{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase[_ngcontent-%COMP%]{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-28[_ngcontent-%COMP%]{font-size:28px;letter-spacing:.7px;line-height:1.4em}.text-28.text-uppercase[_ngcontent-%COMP%]{font-size:28px;letter-spacing:1.68px;line-height:1.25em;text-transform:uppercase}.text-header[_ngcontent-%COMP%]{font-weight:700}.text--code[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.text-xlight[_ngcontent-%COMP%]{font-weight:200}.text-light[_ngcontent-%COMP%]{font-weight:300}.text-medium[_ngcontent-%COMP%]{font-weight:500}.text-semibold[_ngcontent-%COMP%]{font-weight:600}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-underline[_ngcontent-%COMP%]{text-decoration:underline}.text-italic[_ngcontent-%COMP%]{font-style:italic}.text-bright[_ngcontent-%COMP%]{color:#fff}.text-dim[_ngcontent-%COMP%]{color:#96a8c0}.text-error[_ngcontent-%COMP%]{color:#ed4758}.text-left[_ngcontent-%COMP%]{text-align:left}.text-center[_ngcontent-%COMP%]{text-align:center}.text-right[_ngcontent-%COMP%]{text-align:right}.text-ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link[_ngcontent-%COMP%], .text-link[_ngcontent-%COMP%]:visited{color:inherit;cursor:pointer}.text-link[_ngcontent-%COMP%]:not(.text-underline), .text-link[_ngcontent-%COMP%]:visited:not(.text-underline){text-decoration:none}.text-success[_ngcontent-%COMP%]{color:#38de38}.text-danger[_ngcontent-%COMP%]{color:#de3535}.text-info[_ngcontent-%COMP%]{color:#2d72dc}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.text-pre-line[_ngcontent-%COMP%]{white-space:pre-line}.gallery-filters__expanded[_ngcontent-%COMP%]{display:grid;grid-template-columns:33% 33% 33%;grid-gap:16px}.gallery-filters__header[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em;font-weight:600;padding-bottom:12px}.gallery-filters__tag[_ngcontent-%COMP%]{display:inline-block;margin:0 12px 12px 0}@media (max-width:1179px){.gallery-filters__expanded[_ngcontent-%COMP%]{grid-template-columns:100%}}@media (max-width:540px){.gallery-filters__group[_ngcontent-%COMP%]{padding:0 0 24px}}"],data:{animation:[Object(du.n)("show",[Object(du.m)(":enter",[Object(du.l)({height:"0"}),Object(du.e)("250ms ease-out",Object(du.l)({height:"*"}))])])]},changeDetection:0}),function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);r>3&&a&&Object.defineProperty(t,n,a)}([Object(L.d)(TD.getAvailableTags),FD("design:type",J.a)],WD.prototype,"availableTags$",void 0),WD),GD=(($D=function e(){y(this,e)}).\u0275mod=j.Nb({type:$D}),$D.\u0275inj=j.Mb({factory:function(e){return new(e||$D)},imports:[[we.c,GC.f,_U,zT,bU,IU]]}),$D),ZD=((qD=function e(){y(this,e)}).\u0275mod=j.Nb({type:qD}),qD.\u0275inj=j.Mb({factory:function(e){return new(e||qD)},imports:[[L.c.forFeature([TD]),Af.b,te.f,bU,we.c,mh.r,oD,mU,TT,MT,jU,xU,IU,yT.a,GD]]}),qD);j.Bc(vD,[Mu,Dd,vp,KD],[]);var JD,XD,YD,eL,tL,nL,iL,oL,rL,aL,sL,cL,lL,pL,uL,dL,gL,hL,fL,bL,mL=((fL=function e(){y(this,e)}).\u0275mod=j.Nb({type:fL}),fL.\u0275inj=j.Mb({factory:function(e){return new(e||fL)},imports:[[we.c,MT,te.f,IU]]}),fL),vL=((hL=function e(){y(this,e)}).\u0275mod=j.Nb({type:hL}),hL.\u0275inj=j.Mb({factory:function(e){return new(e||hL)},imports:[[IU,MT,we.c,te.f,jU,Qe,mh.r,oD,ZD,mL,L.c.forFeature([fp])]]}),hL),yL=((gL=function e(){y(this,e)}).\u0275mod=j.Nb({type:gL}),gL.\u0275inj=j.Mb({factory:function(e){return new(e||gL)},imports:[[we.c,Jd.a.forChild()]]}),gL),xL=((dL=function e(){y(this,e)}).\u0275mod=j.Nb({type:dL}),dL.\u0275inj=j.Mb({factory:function(e){return new(e||dL)},imports:[[we.c,IU,MT,yL]]}),dL),OL=((uL=function e(){y(this,e)}).\u0275mod=j.Nb({type:uL}),uL.\u0275inj=j.Mb({factory:function(e){return new(e||uL)},imports:[[L.c.forFeature([rr]),we.c,zT,mh.r]]}),uL),wL=((pL=function e(){y(this,e)}).\u0275mod=j.Nb({type:pL}),pL.\u0275inj=j.Mb({factory:function(e){return new(e||pL)},imports:[[L.c.forFeature([Ic,vs,kc,Lr]),we.c,IU,MT,vU,xL,mh.r,Jd.a.forChild(),OL]]}),pL),kL=((lL=function e(){y(this,e)}).\u0275mod=j.Nb({type:lL}),lL.\u0275inj=j.Mb({factory:function(e){return new(e||lL)},imports:[[L.c.forFeature([zs,ws,jo,ll,Ro]),ne.d,we.c,mU,MT,mh.j,wL,IU,vU]]}),lL),CL=((cL=function e(){y(this,e)}).\u0275mod=j.Nb({type:cL}),cL.\u0275inj=j.Mb({factory:function(e){return new(e||cL)},imports:[[we.c,MT,IU,iD,L.c.forFeature([XU])]]}),cL),SL=((sL=function e(){y(this,e)}).\u0275mod=j.Nb({type:sL}),sL.\u0275inj=j.Mb({factory:function(e){return new(e||sL)},imports:[[we.c,MT,IU]]}),sL),_L=((aL=function e(){y(this,e)}).\u0275mod=j.Nb({type:aL}),aL.\u0275inj=j.Mb({factory:function(e){return new(e||aL)},imports:[[we.c,MT,IU]]}),aL),jL=((rL=function e(){y(this,e)}).\u0275mod=j.Nb({type:rL}),rL.\u0275inj=j.Mb({factory:function(e){return new(e||rL)},imports:[[we.c,MT,IU,mh.r]]}),rL),PL=((oL=function e(){y(this,e)}).\u0275mod=j.Nb({type:oL}),oL.\u0275inj=j.Mb({factory:function(e){return new(e||oL)},imports:[[we.c,MT,IU]]}),oL),ML=((iL=function e(){y(this,e)}).\u0275mod=j.Nb({type:iL}),iL.\u0275inj=j.Mb({factory:function(e){return new(e||iL)},imports:[[we.c,MT,IU]]}),iL),IL=((nL=function e(){y(this,e)}).\u0275mod=j.Nb({type:nL}),nL.\u0275inj=j.Mb({factory:function(e){return new(e||nL)},imports:[[we.c,MT,IU]]}),nL),zL=((tL=function e(){y(this,e)}).\u0275mod=j.Nb({type:tL}),tL.\u0275inj=j.Mb({factory:function(e){return new(e||tL)},imports:[[we.c,MT,IU]]}),tL),TL=((eL=function e(){y(this,e)}).\u0275mod=j.Nb({type:eL}),eL.\u0275inj=j.Mb({factory:function(e){return new(e||eL)},imports:[[we.c,MT,bU]]}),eL),UL=((YD=function e(){y(this,e)}).\u0275mod=j.Nb({type:YD}),YD.\u0275inj=j.Mb({factory:function(e){return new(e||YD)},imports:[[we.c,MT,IU,mh.r]]}),YD),DL=((XD=function e(){y(this,e)}).\u0275mod=j.Nb({type:XD}),XD.\u0275inj=j.Mb({factory:function(e){return new(e||XD)},imports:[[we.c,MT,IU,mh.r]]}),XD),LL=((JD=function e(){y(this,e)}).\u0275mod=j.Nb({type:JD}),JD.\u0275inj=j.Mb({factory:function(e){return new(e||JD)},imports:[[we.c,MT,IU]]}),JD),EL=function e(){y(this,e)};!function(e){var t=function e(){y(this,e)};t.type="[Dialog] Open Limit",e.OpenLimit=t;var n=function e(t){y(this,e),this.upgrade=t};n.type="[Dialog] Close Limit",e.CloseLimit=n;var i=function e(){y(this,e)};i.type="[Dialog] Open Premium Content",e.OpenPremiumContent=i;var o=function e(t){y(this,e),this.confirmed=t};o.type="[Dialog] Close Premium Content",e.ClosePremiumContent=o;var r=function e(){y(this,e)};r.type="[Dialog] Open Upgrade",e.OpenUpgrade=r;var a=function e(){y(this,e)};a.type="[Dialog] Close Upgrade",e.CloseUpgrade=a}(bL||(bL={}));var FL,AL=((FL=function(){function e(){y(this,e)}return v(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||FL)},FL.\u0275cmp=j.Jb({type:FL,selectors:[["app-limit-dialog"]],decls:12,vars:2,consts:[["mat-dialog-title",""],["mat-dialog-content","",1,"pt-1","pb-6"],[1,"text-14","pb-3"],[1,"text-14"],["mat-dialog-actions","",1,"pt-2"],["app-button","","buttonTheme","light","cdkFocusInitial","",1,"mr-2",3,"mat-dialog-close"],["app-button","","buttonType","primary",3,"mat-dialog-close"]],template:function(e,t){1&e&&(j.Vb(0,"h1",0),j.Kc(1,"New Bookmark Limit Reached"),j.Ub(),j.Vb(2,"div",1),j.Vb(3,"div",2),j.Kc(4," You've reached your limit of 5 3D models in your Library. You can make changes to this model, but you will not be able to save as a new model. "),j.Ub(),j.Vb(5,"div",3),j.Kc(6,"Upgrade to a Premium Plan to save unlimited 3D models."),j.Ub(),j.Ub(),j.Vb(7,"div",4),j.Vb(8,"button",5),j.Kc(9," OK "),j.Ub(),j.Vb(10,"button",6),j.Kc(11,"Upgrade Now"),j.Ub(),j.Ub()),2&e&&(j.Db(8),j.lc("mat-dialog-close",!1),j.Db(2),j.lc("mat-dialog-close",!0))},directives:[ap.h,ap.e,ap.c,Dd,ap.d],styles:[""],changeDetection:0}),FL);function RL(e,t){if(1&e&&(j.Vb(0,"button",7),j.Kc(1),j.Ub()),2&e){var n=j.gc();j.Db(1),j.Mc(" ",n.settings.miscText," ")}}function VL(e,t){if(1&e&&(j.Vb(0,"button",8),j.Kc(1),j.Ub()),2&e){var n=j.gc();j.lc("mat-dialog-close",!1),j.Db(1),j.Mc(" ",n.settings.cancelText," ")}}function NL(e,t){if(1&e&&(j.Vb(0,"button",9),j.Kc(1),j.Ub()),2&e){var n=j.gc();j.lc("mat-dialog-close",!0),j.Db(1),j.Mc(" ",n.settings.confirmText," ")}}var BL,HL,QL,qL,$L,WL=((BL=function(){function e(t,n){y(this,e),this.dialogRef=t,this.data=n,this.settings={titleText:"Confirm Action",bodyText:"",confirmText:"Confirm",confirmColor:"primary",cancelText:"Cancel",confirmEnabled:!0,cancelEnabled:!0,miscText:""},n&&(this.settings=Object.assign(Object.assign({},this.settings),n))}return v(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||BL)(j.Pb(ap.g),j.Pb(ap.a))},BL.\u0275cmp=j.Jb({type:BL,selectors:[["app-confirm-dialog"]],decls:10,vars:8,consts:[["data-test","confirmDialog","role","alertdialog","aria-modal","true"],["mat-dialog-title",""],["mat-dialog-content","",1,"pt-4","pb-6","text-14"],["mat-dialog-actions","",1,"dialog__actions","pt-2"],["app-button","","buttonTheme","light",3,"mat-dialog-close",4,"ngIf"],["type","button","class","mr-1","app-button","","buttonTheme","light","data-test","confirmDialogCancelButton",3,"mat-dialog-close",4,"ngIf"],["type","button","app-button","","buttonType","primary","data-test","confirmDialogConfirmButton","cdkFocusInitial","",3,"mat-dialog-close",4,"ngIf"],["app-button","","buttonTheme","light",3,"mat-dialog-close"],["type","button","app-button","","buttonTheme","light","data-test","confirmDialogCancelButton",1,"mr-1",3,"mat-dialog-close"],["type","button","app-button","","buttonType","primary","data-test","confirmDialogConfirmButton","cdkFocusInitial","",3,"mat-dialog-close"]],template:function(e,t){1&e&&(j.Vb(0,"div",0),j.Vb(1,"h1",1),j.Kc(2),j.Ub(),j.Vb(3,"p",2),j.Kc(4),j.Ub(),j.Vb(5,"div",3),j.Ic(6,RL,2,1,"button",4),j.Vb(7,"div"),j.Ic(8,VL,2,2,"button",5),j.Ic(9,NL,2,2,"button",6),j.Ub(),j.Ub(),j.Ub()),2&e&&(j.Eb("aria-label",t.settings.titleText),j.Db(2),j.Mc(" ",t.settings.titleText," "),j.Db(2),j.Mc(" ",t.settings.bodyText," "),j.Db(1),j.Hb("dialog__actions--compact",!t.settings.miscText),j.Db(1),j.lc("ngIf",t.settings.miscText),j.Db(2),j.lc("ngIf",t.settings.cancelEnabled),j.Db(1),j.lc("ngIf",t.settings.confirmEnabled))},directives:[ap.h,ap.e,ap.c,we.l,Dd,ap.d],styles:["[_nghost-%COMP%]{display:block}.dialog__actions[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between;align-items:center}.dialog__actions--compact[_ngcontent-%COMP%]{justify-content:flex-end}@media (min-width:480px){[_nghost-%COMP%]{min-width:320px}}"],changeDetection:0}),BL),KL=["copyField"],GL=((HL=function(){function e(t,n,i){y(this,e),this.dialogRef=t,this.data=n,this.clipboardService=i,this.settings={title:"Copy to Clipboard",copyText:""},this.settings=Object.assign(Object.assign({},this.settings),n)}return v(e,[{key:"rowCount",get:function(){return this.settings.copyText.split(/\r?\n/).length+1}},{key:"ngOnInit",value:function(){}},{key:"ngAfterViewInit",value:function(){var e=this.copyField.nativeElement;e.focus(),e.select()}},{key:"handleCopyClick",value:function(){var e=this.clipboardService.copyInputFieldValue(this.copyField.nativeElement);this.close(e)}},{key:"handleCancelClick",value:function(){this.close(!1)}},{key:"close",value:function(e){this.dialogRef.close(e)}}]),e}()).\u0275fac=function(e){return new(e||HL)(j.Pb(ap.g),j.Pb(ap.a),j.Pb(Ju))},HL.\u0275cmp=j.Jb({type:HL,selectors:[["app-clipboard-dialog"]],viewQuery:function(e,t){var n;1&e&&j.Ec(KL,!0),2&e&&j.sc(n=j.dc())&&(t.copyField=n.first)},decls:11,vars:3,consts:[["mat-dialog-title",""],["mat-dialog-content","",1,"copy","flex"],[1,"copy__input","flex-auto",3,"value","rows"],["copyField",""],["mat-dialog-actions",""],["app-button","","buttonTheme","light",3,"click"],["app-button","","buttonType","primary",3,"click"]],template:function(e,t){1&e&&(j.Vb(0,"div",0),j.Kc(1),j.Ub(),j.Vb(2,"div",1),j.Vb(3,"textarea",2,3),j.Kc(5,"  "),j.Ub(),j.Ub(),j.Vb(6,"div",4),j.Vb(7,"button",5),j.cc("click",(function(){return t.handleCancelClick()})),j.Kc(8,"Cancel"),j.Ub(),j.Vb(9,"button",6),j.cc("click",(function(){return t.handleCopyClick()})),j.Kc(10,"Copy to Clipboard"),j.Ub(),j.Ub()),2&e&&(j.Db(1),j.Mc(" ",t.settings.title,"\n"),j.Db(2),j.lc("value",t.settings.copyText)("rows",t.rowCount))},directives:[ap.h,ap.e,ap.c,Dd],styles:[".copy[_ngcontent-%COMP%]{min-width:480px}"],changeDetection:0}),HL),ZL=["modalContents"],JL=((QL=function(){function e(t,n,i,o,r,a){y(this,e),this.dialogRef=t,this.data=n,this.sanitizer=i,this.renderer=o,this.pendoService=r,this.productService=a}return v(e,[{key:"onMessage",value:function(e){switch(e.data.action){case"close":this.dialogRef.close(e.data);break;case"track":this.pendoService.track(e.data.label,Object.assign(Object.assign({},e.data.metadata),{platform:this.productService.productType}))}}},{key:"ngOnInit",value:function(){this.title=this.data.title,this.url=this.data.url?this.sanitizer.bypassSecurityTrustResourceUrl(this.data.url):"",this.renderer.setStyle(this.modalContents.nativeElement,"background-color",this.data.backgroundColor||"#ffffff")}},{key:"closeDialog",value:function(){this.dialogRef.close()}}]),e}()).\u0275fac=function(e){return new(e||QL)(j.Pb(ap.g),j.Pb(ap.a),j.Pb(U.b),j.Pb(j.H),j.Pb(Oe),j.Pb(Ry))},QL.\u0275cmp=j.Jb({type:QL,selectors:[["app-iframe-dialog"]],viewQuery:function(e,t){var n;1&e&&j.Ec(ZL,!0),2&e&&j.sc(n=j.dc())&&(t.modalContents=n.first)},hostBindings:function(e,t){1&e&&j.cc("message",(function(e){return t.onMessage(e)}),!1,j.wc)},decls:6,vars:3,consts:[["role","dialog","aria-modal","true",1,"modal"],[1,"modal__contents"],["modalContents",""],["cdkFocusInitial","",1,"modal__frame",3,"src"],["app-button","","buttonTheme","dark","buttonType","white","buttonShape","circle","type","button","title","Close",1,"modal__close",3,"click"],["icon","times","size","lg"]],template:function(e,t){1&e&&(j.Vb(0,"div",0),j.Vb(1,"div",1,2),j.Qb(3,"iframe",3),j.Ub(),j.Vb(4,"button",4),j.cc("click",(function(){return t.closeDialog()})),j.Qb(5,"app-icon",5),j.Ub(),j.Ub()),2&e&&(j.Eb("aria-label",t.title),j.Db(3),j.lc("src",t.url,j.zc),j.Db(1),j.Eb("aria-label","Close"))},directives:[Dd,vp],styles:[".modal[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%;position:relative}.modal__close[_ngcontent-%COMP%]{margin-bottom:4px;align-self:flex-end;cursor:pointer;position:absolute;right:12px;top:12px}.modal__contents[_ngcontent-%COMP%]{flex-grow:1}.modal__frame[_ngcontent-%COMP%]{width:100%;height:100%}"],changeDetection:0}),QL),XL=function(e){return e.PersonalUse="Personal Use",e.Education="Education",e.Business="Business",e}({}),YL=function(){var e=function e(t){y(this,e),this.organization=t};return e.type="[Users] Join Organization",e}(),eE=function(){var e=function e(t){y(this,e),this.organization=t};return e.type="[Users] Join Organization Success",e}(),tE=function(){var e=function e(t){y(this,e),this.organization=t};return e.type="[Users] Join Organization Fail",e}(),nE=function(){var e=function e(t){y(this,e),this.code=t};return e.type="[Users] Join Organization With Code",e}(),iE=function(){var e=function e(t){y(this,e),this.organizationName=t};return e.type="[Users] Join Organization With Code Success",e}(),oE=function(){var e=function e(t){y(this,e),this.error=t};return e.type="[Users] Join Organization With Code Fail",e}(),rE=function(){var e=function e(t,n){y(this,e),this.groupEID=t,this.invites=n};return e.type="[Users] Send Organization Invite",e}(),aE=function(){var e=function e(t){y(this,e),this.responses=t};return e.type="[Users] Send Organization Invite Success",e}(),sE=function(){var e=function e(t){y(this,e),this.error=t};return e.type="[Users] Send Organization Invite Fail",e}(),cE=function(){var e=function e(t){y(this,e),this.groupId=t};return e.type="[Users] Get Organization Users",e}(),lE=function(){var e=function e(t){y(this,e),this.users=t};return e.type="[Users] Get Organization Users Success",e}(),pE=function(){var e=function e(t){y(this,e),this.error=t};return e.type="[Users] Get Organization Users Fail",e}(),uE=function(){var e=function e(t){y(this,e),this.groupId=t};return e.type="[Users] Get Organization Invited Users",e}(),dE=function(){var e=function e(t){y(this,e),this.invites=t};return e.type="[Users] Get Organization Invited Users Success",e}(),gE=function(){var e=function e(t){y(this,e),this.error=t};return e.type="[Users] Get Organization Invited Users Fail",e}(),hE=function(){var e=function e(){y(this,e)};return e.type="[Users] Reset",e}(),fE=function(){var e=function e(t,n){y(this,e),this.groupId=t,this.users=n};return e.type="[Users] Update User Roles",e}(),bE=function(){var e=function e(t,n){y(this,e),this.groupId=t,this.users=n};return e.type="[Users] Update User Roles Success",e}(),mE=function(){var e=function e(){y(this,e)};return e.type="[Users] Update User Roles Fail",e}(),vE=function(){var e=function e(t,n){y(this,e),this.groupId=t,this.users=n};return e.type="[Users] Remove Organization User",e}(),yE=function(){var e=function e(t,n){y(this,e),this.groupId=t,this.users=n};return e.type="[Users] Remove Organization User Success",e}(),xE=function(){var e=function e(){y(this,e)};return e.type="[Users] Remove Organization User Fail",e}(),OE=function(){var e=function e(t,n){y(this,e),this.groupId=t,this.users=n};return e.type="[Users] Transfer Organization Content",e}(),wE=function(){var e=function e(t,n){y(this,e),this.groupId=t,this.users=n};return e.type="[Users] Transfer Organization Content Success",e}(),kE=function(){var e=function e(){y(this,e)};return e.type="[Users] Transfer Organization Content Fail",e}(),CE=r("7HRe"),SE=r("qgXg"),_E=r("0EUg"),jE=((qL=function(){function e(t){y(this,e),this.http=t}return v(e,[{key:"getOrganizationUsers",value:function(e){var t=fe(e);return this.http.get("/ws/organization/users"+t).pipe(Object(se.a)((function(e){return e.users})),Object(se.a)((function(e){return e.map((function(e){return Object.assign(Object.assign({},e),{user_role:_y(e.user_role)})}))})))}},{key:"getOrganizationInvites",value:function(e){var t=fe(e);return this.http.get("/ws/organization/invite"+t).pipe(Object(se.a)((function(e){return e.invites})),Object(se.a)((function(e){return e.map((function(e){return Object.assign(Object.assign({},e),{invite_user:Object.assign(Object.assign({},e.inviter_user),{user_role:_y(e.inviter_user.user_role)}),invitee_user:Object.assign(Object.assign({},e.invitee_user),{user_role:_y(e.invitee_user.user_role)})})}))})))}},{key:"sendOrganizationInvites",value:function(e,t,n){return this.http.post("/ws/organization/invite",{version:2,group_eid:e,invite_emails:t,site_verify_response:n}).pipe(Object(se.a)((function(e){return e.results_summary.messages})))}},{key:"addUserToOrganization",value:function(e){return this.http.post("/ws/organization/user/add",{group_eid:e})}},{key:"addUserWithGroupCode",value:function(e){return this.http.post("/ws/organization/user/add",{group_code:e}).pipe(Object(se.a)((function(e){return e.organization_name})))}},{key:"updateUserRoles",value:function(e,t){var n=this;return this.batchUsers(t,(function(t){return n.http.post("/ws/organization/users",{group_id:e,update_users:t.map((function(e){return{user_id:e.userId,role_id:e.roleId}}))})}))}},{key:"removeUsers",value:function(e,t){var n=this;return this.batchUsers(t,(function(t){return n.http.post("/ws/organization/users",{group_id:e,remove_users:t.map((function(e){return n.createTransferRequest(e)}))})}))}},{key:"transferUserContent",value:function(e,t){var n=this;return this.batchUsers(t,(function(t){return n.http.post("/ws/organization/bookmark/transfer",{group_id:e,transfer_bookmarks:t.map((function(e){return n.createTransferRequest(e)}))})}))}},{key:"createUserDisplayModel",value:function(e,t){return{name:this.formatUserName(e),initials:this.formatBadgeLabel(e),email:e.user_email,id:e.user_id,role:e.user_role,selected:!1,invitationStatus:t}}},{key:"batchUsers",value:function(e,t){for(var n=0,i=[];n<e.length;){var o=e.slice(n,n+50);i.push(t(o)),n+=50}var r=Object(CE.a)(i,SE.b).pipe(Object(_E.a)());return Object(Ls.a)(r).pipe(Object(se.a)((function(){return!0})))}},{key:"createTransferRequest",value:function(e){var t=e.sourceUserId,n=e.targetUserId;return"number"==typeof n?{user_id:t,group_bookmarks:{transfer_ownership:1,transfer_user_id:n}}:{user_id:t}}},{key:"formatUserName",value:function(e){var t=[e.user_first_name,e.user_last_name].filter((function(e){return!!e}));return t.length>0?t.join(" "):""}},{key:"formatBadgeLabel",value:function(e){return[e.user_first_name,e.user_last_name].filter((function(e){return!!e})).map((function(e){return e[0]})).join("")}}]),e}()).\u0275fac=function(e){return new(e||qL)(j.Zb(Q.b))},qL.\u0275prov=j.Lb({token:qL,factory:qL.\u0275fac,providedIn:"root"}),qL),PE=function e(){y(this,e)},ME=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},IE=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},zE={joining:!1,inviting:!1,loadingUsers:!1,loadingInvites:!1,users:[],invites:[]},TE=(($L=function(){function e(t,n,i,o){y(this,e),this.usersService=t,this.pendoService=n,this.productService=i,this.authService=o}return v(e,[{key:"joinOrganization",value:function(e,t){var n=t.organization;e.patchState({joining:!0}),this.usersService.addUserToOrganization(n.eid).pipe(Object(Ss.a)((function(){return e.patchState({joining:!1})}))).subscribe((function(){return e.dispatch(new eE(n))}),(function(){return e.dispatch(new tE(n))}))}},{key:"joinOrganizationWithCode",value:function(e,t){var n=t.code;e.patchState({joining:!0}),this.usersService.addUserWithGroupCode(n).pipe(Object(Ss.a)((function(){return e.patchState({joining:!1})}))).subscribe((function(t){return e.dispatch(new iE(t))}),(function(t){return e.dispatch(new oE(t))}))}},{key:"joinOrganizationWithCodeSuccess",value:function(){this.pendoService.track("Account Upgrade - Free Individual to Team")}},{key:"sendOrganizationInvite",value:function(e,t){var n=this,i=t.groupEID,o=t.invites;e.patchState({inviting:!0}),this.authService.isHuman("invites",!0).pipe(Object(ei.a)((function(t){t.isHuman||e.dispatch(new $v(new Error("reCAPTCHA error. Refresh the page and try again.")))})),Object(Y.a)((function(e){return e.isHuman})),Object(vr.b)((function(e){return n.usersService.sendOrganizationInvites(i,o,e.verification)})),Object(Ss.a)((function(){return e.patchState({inviting:!1})}))).subscribe((function(t){return e.dispatch(new aE(t))}),(function(t){return e.dispatch(new sE(t))}))}},{key:"getOrganizationUsers",value:function(e,t){var n=t.groupId;e.patchState({loadingUsers:!0}),this.usersService.getOrganizationUsers({group_id:n}).pipe(Object(Ss.a)((function(){return e.patchState({loadingUsers:!1})}))).subscribe((function(t){return e.dispatch(new lE(t))}),(function(t){return e.dispatch(new pE(t))}))}},{key:"getOrganizationUsersSuccess",value:function(e,t){var n=t.users;e.patchState({users:n})}},{key:"getOrganizationUserInvites",value:function(e,t){var n=t.groupId;e.patchState({loadingInvites:!0}),this.usersService.getOrganizationInvites({group_id:n,version:1,app_productkey:this.productService.productKey,app_producttype:this.productService.productType}).pipe(Object(Ss.a)((function(){return e.patchState({loadingInvites:!1})}))).subscribe((function(t){return e.dispatch(new dE(t))}),(function(t){return e.dispatch(new gE(t))}))}},{key:"getOrganizationUserInvitesSuccess",value:function(e,t){var n=t.invites;e.patchState({invites:n})}},{key:"resetOrganizations",value:function(e){e.setState(zE)}},{key:"updateUserRoles",value:function(e,t){var n=t.groupId,i=t.users;this.usersService.updateUserRoles(n,i).subscribe((function(){return e.dispatch(new bE(n,i))}),(function(){return e.dispatch(new mE)}))}},{key:"removeOrganizationUser",value:function(e,t){var n=t.groupId,i=t.users;this.usersService.removeUsers(n,i).subscribe((function(){return e.dispatch(new yE(n,i))}),(function(){return e.dispatch(new xE)}))}},{key:"transferOrganizationContent",value:function(e,t){var n=t.groupId,i=t.users;this.usersService.transferUserContent(n,i).subscribe((function(){return e.dispatch(new wE(n,i))}),(function(){return e.dispatch(new kE)}))}}],[{key:"getUsers",value:function(e){return e.users}},{key:"getInvites",value:function(e){return e.invites}},{key:"getUsersLoading",value:function(e){return e.loadingUsers}},{key:"getJoining",value:function(e){return e.joining}},{key:"getInviting",value:function(e){return e.inviting}}]),e}()).\u0275fac=function(e){return new(e||$L)(j.Zb(jE),j.Zb(Oe),j.Zb(Ry),j.Zb(Ny))},$L.\u0275prov=j.Lb({token:$L,factory:$L.\u0275fac}),ME([Object(L.a)(YL),IE("design:type",Function),IE("design:paramtypes",[Object,YL]),IE("design:returntype",void 0)],$L.prototype,"joinOrganization",null),ME([Object(L.a)(nE),IE("design:type",Function),IE("design:paramtypes",[Object,nE]),IE("design:returntype",void 0)],$L.prototype,"joinOrganizationWithCode",null),ME([Object(L.a)(iE),IE("design:type",Function),IE("design:paramtypes",[]),IE("design:returntype",void 0)],$L.prototype,"joinOrganizationWithCodeSuccess",null),ME([Object(L.a)(rE),IE("design:type",Function),IE("design:paramtypes",[Object,rE]),IE("design:returntype",void 0)],$L.prototype,"sendOrganizationInvite",null),ME([Object(L.a)(cE),IE("design:type",Function),IE("design:paramtypes",[Object,cE]),IE("design:returntype",void 0)],$L.prototype,"getOrganizationUsers",null),ME([Object(L.a)(lE),IE("design:type",Function),IE("design:paramtypes",[Object,lE]),IE("design:returntype",void 0)],$L.prototype,"getOrganizationUsersSuccess",null),ME([Object(L.a)(uE),IE("design:type",Function),IE("design:paramtypes",[Object,uE]),IE("design:returntype",void 0)],$L.prototype,"getOrganizationUserInvites",null),ME([Object(L.a)(dE),IE("design:type",Function),IE("design:paramtypes",[Object,dE]),IE("design:returntype",void 0)],$L.prototype,"getOrganizationUserInvitesSuccess",null),ME([Object(L.a)(hE),IE("design:type",Function),IE("design:paramtypes",[Object]),IE("design:returntype",void 0)],$L.prototype,"resetOrganizations",null),ME([Object(L.a)(fE),IE("design:type",Function),IE("design:paramtypes",[Object,fE]),IE("design:returntype",void 0)],$L.prototype,"updateUserRoles",null),ME([Object(L.a)(vE),IE("design:type",Function),IE("design:paramtypes",[Object,vE]),IE("design:returntype",void 0)],$L.prototype,"removeOrganizationUser",null),ME([Object(L.a)(OE),IE("design:type",Function),IE("design:paramtypes",[Object,OE]),IE("design:returntype",void 0)],$L.prototype,"transferOrganizationContent",null),ME([Object(L.e)(),IE("design:type",Function),IE("design:paramtypes",[PE]),IE("design:returntype",void 0)],$L,"getUsers",null),ME([Object(L.e)(),IE("design:type",Function),IE("design:paramtypes",[PE]),IE("design:returntype",void 0)],$L,"getInvites",null),ME([Object(L.e)(),IE("design:type",Function),IE("design:paramtypes",[PE]),IE("design:returntype",void 0)],$L,"getUsersLoading",null),ME([Object(L.e)(),IE("design:type",Function),IE("design:paramtypes",[PE]),IE("design:returntype",void 0)],$L,"getJoining",null),ME([Object(L.e)(),IE("design:type",Function),IE("design:paramtypes",[PE]),IE("design:returntype",void 0)],$L,"getInviting",null),$L=ME([Object(L.f)({name:"users",defaults:zE})],$L));function UE(e){return function(t){var n=Cf.parseEmails(t.value),i=n.filter((function(e){return!Cf.validateEmail(e)})),o=n.length,r="number"==typeof e&&o>e,a={};return r&&(a=Object.assign(Object.assign({},a),{maxEmailsExceeded:r,currentEmailCount:o})),i.length>0&&(a=Object.assign(Object.assign({},a),{invalidEmails:i})),Object.keys(a).length>0?Object(br.a)(a):Object(br.a)(null)}}var DE=ET[LT.WoltersKluwer],LE={};function EE(e,t){var n=Object(ie.get)(e,"error.error.error_id",""),i=Object(ie.get)(e,"error.error.message","");return function(e,t){switch(e){case"OPPH01.00122":case"SUH01.00122":case"SIH01.00122":case"FSH01.00122":case"GSH01.00122":return"We were unable to find an account associated with your institution. \n      Please contact your administrator [here](".concat(DE,") and provide this error ID: ").concat(e,".");case"OPPH01.00123":case"SUH01.00123":case"SIH01.00123":case"FSH01.00123":case"GSH01.00123":return"There are multiple team accounts associated with your institution. \n      Please contact your administrator [here](".concat(DE,") and provide this error ID: ").concat(e,".");case"OPPH01.00124":case"OPPH01.00125":case"OPPH01.00110":case"OPPH01.00111":case"OPPH01.00112":case"SUH01.00124":case"SUH01.00110":case"SUH01.00111":case"SUH01.00112":case"SIH01.00124":case"SIH01.00110":case"SIH01.00111":case"SIH01.00112":case"FSH01.00124":case"FSH01.00125":case"FSH01.00110":case"FSH01.00111":case"FSH01.00112":case"GSH01.00124":case"GSH01.00110":case"GSH01.00111":case"GSH01.00112":return"There was an issue with retrieving information from your institution. \n      Please try again or contact your administrator [here](".concat(DE,") and provide this error ID: ").concat(e,".");default:return LE[e]||""}}(n)||(i?i.replace(/^\[(.+)\]$/,"$1").replace(/^\'(.+)\'$/,"$1"):"")}var FE=["labelEl"];function AE(e,t){if(1&e&&(j.Vb(0,"div",5),j.Kc(1),j.Ub()),2&e){var n=j.gc();j.Hb("text-uppercase",n.uppercase),j.Db(1),j.Mc(" ",n.label," ")}}var RE,VE=["*",[["","form-field-help",""]]],NE=function(e,t,n,i){return{"field--light":e,"field--dark":t,"field--inline":n,"field--compact":i}},BE=["*","[form-field-help]"],HE=((RE=function(){function e(){y(this,e),this.display="block",this.theme="dark",this.uppercase=!0,this.isCompact=!1,this.ngUnsubscribe=new Z.a}return v(e,[{key:"ngOnInit",value:function(){}},{key:"ngAfterViewInit",value:function(){this.labelEl.nativeElement.querySelectorAll("[contenteditable]").length>0&&Object(ka.a)(this.labelEl.nativeElement,"click").pipe(Object(X.a)(this.ngUnsubscribe)).subscribe((function(e){e.preventDefault()}))}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}}]),e}()).\u0275fac=function(e){return new(e||RE)},RE.\u0275cmp=j.Jb({type:RE,selectors:[["app-form-field"]],viewQuery:function(e,t){var n;1&e&&j.Ec(FE,!0),2&e&&j.sc(n=j.dc())&&(t.labelEl=n.first)},inputs:{label:"label",display:"display",theme:"theme",uppercase:"uppercase",isCompact:"isCompact"},ngContentSelectors:BE,decls:8,vars:8,consts:[["data-test","formField",1,"field",3,"ngClass"],["labelEl",""],["class","field__label text-10","data-test","formFieldLabel",3,"text-uppercase",4,"ngIf"],[1,"field__input"],[1,"field__help","text-dim","text-11"],["data-test","formFieldLabel",1,"field__label","text-10"]],template:function(e,t){1&e&&(j.kc(VE),j.Vb(0,"div",0),j.Vb(1,"label",null,1),j.Ic(3,AE,2,3,"div",2),j.Vb(4,"div",3),j.jc(5),j.Vb(6,"div",4),j.jc(7,1),j.Ub(),j.Ub(),j.Ub(),j.Ub()),2&e&&(j.lc("ngClass",j.qc(3,NE,"light"===t.theme,"dark"===t.theme,"inline"===t.display,t.isCompact)),j.Db(1),j.Eb("aria-label",t.label),j.Db(2),j.lc("ngIf",t.label))},directives:[we.i,we.l],styles:[".text-8[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase[_ngcontent-%COMP%]{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase[_ngcontent-%COMP%]{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase[_ngcontent-%COMP%]{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase[_ngcontent-%COMP%]{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-28[_ngcontent-%COMP%]{font-size:28px;letter-spacing:.7px;line-height:1.4em}.text-28.text-uppercase[_ngcontent-%COMP%]{font-size:28px;letter-spacing:1.68px;line-height:1.25em;text-transform:uppercase}.text-header[_ngcontent-%COMP%]{font-weight:700}.text--code[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.text-xlight[_ngcontent-%COMP%]{font-weight:200}.text-light[_ngcontent-%COMP%]{font-weight:300}.text-medium[_ngcontent-%COMP%]{font-weight:500}.text-semibold[_ngcontent-%COMP%]{font-weight:600}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-underline[_ngcontent-%COMP%]{text-decoration:underline}.text-italic[_ngcontent-%COMP%]{font-style:italic}.text-bright[_ngcontent-%COMP%]{color:#fff}.text-dim[_ngcontent-%COMP%]{color:#96a8c0}.text-error[_ngcontent-%COMP%]{color:#ed4758}.text-left[_ngcontent-%COMP%]{text-align:left}.text-center[_ngcontent-%COMP%]{text-align:center}.text-right[_ngcontent-%COMP%]{text-align:right}.text-ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link[_ngcontent-%COMP%], .text-link[_ngcontent-%COMP%]:visited{color:inherit;cursor:pointer}.text-link[_ngcontent-%COMP%]:not(.text-underline), .text-link[_ngcontent-%COMP%]:visited:not(.text-underline){text-decoration:none}.text-success[_ngcontent-%COMP%]{color:#38de38}.text-danger[_ngcontent-%COMP%]{color:#de3535}.text-info[_ngcontent-%COMP%]{color:#2d72dc}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.text-pre-line[_ngcontent-%COMP%]{white-space:pre-line}.field[_ngcontent-%COMP%]{padding-bottom:16px;display:block;width:100%}.field__input[_ngcontent-%COMP%]{margin-top:4px}.field--light[_ngcontent-%COMP%]   .field__label[_ngcontent-%COMP%]{color:#374a68}.field--dark[_ngcontent-%COMP%]   .field__label[_ngcontent-%COMP%]{color:#96a8c0}.field--inline[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;width:auto}.field--inline[_ngcontent-%COMP%]   .field__label[_ngcontent-%COMP%]{margin-right:8px}.field--inline[_ngcontent-%COMP%]   .field__input[_ngcontent-%COMP%]{margin-top:auto}.field--compact[_ngcontent-%COMP%]{padding-bottom:0}.field__help[_ngcontent-%COMP%]:not(:empty){padding-top:8px}"],changeDetection:0}),RE),QE=r("kmnG"),qE=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},$E=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function WE(e,t){if(1&e&&(j.Vb(0,"div",7),j.Vb(1,"app-message-toggle",8),j.Kc(2),j.Ub(),j.Ub()),2&e){var n=j.gc(2);j.Db(2),j.Mc(" ",n.sentResponses.length," invite(s) have been sent. Please allow up to a few minutes for invitees to receive their invitations. ")}}function KE(e,t){if(1&e&&(j.Tb(0),j.Ic(1,WE,3,1,"div",6),j.Sb()),2&e){var n=j.gc();j.Db(1),j.lc("ngIf",n.sentResponses.length>0)}}function GE(e,t){if(1&e&&(j.Vb(0,"div"),j.Kc(1),j.Ub()),2&e){var n=t.$implicit;j.Db(1),j.Mc(" ",n," ")}}function ZE(e,t){if(1&e&&(j.Vb(0,"div",16),j.Vb(1,"app-message-toggle",17),j.Vb(2,"div"),j.Kc(3),j.Ub(),j.Ic(4,GE,2,1,"div",18),j.Ub(),j.Ub()),2&e){var n=j.gc(3);j.Db(3),j.Mc("There was an error sending ",n.errorResponses.length," invite(s)."),j.Db(1),j.lc("ngForOf",n.formatResponses(n.errorResponses))}}function JE(e,t){if(1&e&&(j.Vb(0,"div",16),j.Vb(1,"app-message-toggle",17),j.Kc(2),j.Ub(),j.Ub()),2&e){var n=j.gc(3);j.Db(2),j.Mc(" ",n.errorMessage," ")}}function XE(e,t){if(1&e&&(j.Vb(0,"div",19),j.Vb(1,"mat-error"),j.Kc(2),j.Ub(),j.Ub()),2&e){var n=j.gc().$implicit,i=j.gc(2);j.Db(2),j.Nc(" Please limit your entry to ",i.maxEmailCount,". Current count: ",null==n.errors?null:n.errors.currentEmailCount,". ")}}function YE(e,t){if(1&e&&(j.Vb(0,"div",19),j.Vb(1,"mat-error"),j.Kc(2),j.Ub(),j.Ub()),2&e){var n=j.gc().$implicit,i=j.gc(2);j.Db(2),j.Nc(" ",i.formatEmails(null==n.errors?null:n.errors.invalidEmails)," ",1===n.errors.invalidEmails.length?"is not a valid email address.":"are not valid email addresses."," ")}}function eF(e,t){if(1&e&&(j.Vb(0,"option",24),j.Kc(1),j.Ub()),2&e){var n=t.$implicit;j.lc("value",n.role_id),j.Db(1),j.Mc(" ",n.role_display_name," ")}}function tF(e,t){1&e&&(j.Vb(0,"div",19),j.Vb(1,"mat-error"),j.Kc(2," Please select a valid role. "),j.Ub(),j.Ub())}function nF(e,t){if(1&e&&(j.Vb(0,"app-form-field",20),j.Vb(1,"select",21),j.Vb(2,"option",22),j.Kc(3,"--"),j.Ub(),j.Ic(4,eF,2,2,"option",23),j.Ub(),j.Ic(5,tF,3,0,"div",14),j.Ub()),2&e){var n=t.$implicit,i=j.gc(3);j.Db(4),j.lc("ngForOf",i.availableRoles),j.Db(1),j.lc("ngIf",n.touched&&n.invalid)}}function iF(e,t){if(1&e&&(j.Tb(0,10),j.Ic(1,ZE,5,2,"div",11),j.Ic(2,JE,3,1,"div",11),j.Vb(3,"app-form-field",12),j.Vb(4,"textarea",13),j.Kc(5,"          "),j.Ub(),j.Ic(6,XE,3,2,"div",14),j.Ic(7,YE,3,2,"div",14),j.Ub(),j.Ic(8,nF,6,2,"app-form-field",15),j.Sb()),2&e){var n=t.$implicit,i=j.gc(2);j.lc("formGroup",i.form),j.Db(1),j.lc("ngIf",i.errorResponses.length>0),j.Db(1),j.lc("ngIf",i.errorMessage),j.Db(2),j.lc("placeholder","Enter up to "+i.maxEmailCount+" email addresses separated by commas"),j.Db(2),j.lc("ngIf",null==n.errors?null:n.errors.maxEmailsExceeded),j.Db(1),j.lc("ngIf",null==n.errors?null:n.errors.invalidEmails),j.Db(1),j.lc("ngIf",i.form.get("roleId"))}}function oF(e,t){if(1&e&&j.Ic(0,iF,9,7,"ng-container",9),2&e){var n=j.gc();j.lc("ngIf",n.form.get("emails"))}}function rF(e,t){if(1&e){var n=j.Wb();j.Vb(0,"button",29),j.cc("click",(function(){return j.xc(n),j.gc(2).handleCancelClick()})),j.Kc(1),j.Ub()}if(2&e){var i=j.gc(2);j.lc("uppercase","inline"===i.layout),j.Db(1),j.Mc(" ",i.cancelText," ")}}function aF(e,t){if(1&e){var n=j.Wb();j.Vb(0,"button",30),j.cc("click",(function(){return j.xc(n),j.gc(2).handleInviteClick()})),j.hc(1,"async"),j.Kc(2),j.Ub()}if(2&e){var i=j.gc(2);j.lc("uppercase","inline"===i.layout)("disabled",i.form.invalid||j.ic(1,3,i.inviting$)),j.Db(2),j.Mc(" ",i.errorResponses.length>0?"Try Again":i.sendText," ")}}function sF(e,t){1&e&&j.Rb(0)}function cF(e,t){1&e&&j.Rb(0)}function lF(e,t){if(1&e&&(j.Tb(0),j.Ic(1,sF,1,0,"ng-container",31),j.Ic(2,cF,1,0,"ng-container",31),j.Sb()),2&e){j.gc();var n=j.tc(3),i=j.tc(5);j.Db(1),j.lc("ngTemplateOutlet",n),j.Db(1),j.lc("ngTemplateOutlet",i)}}function pF(e,t){1&e&&j.Rb(0)}function uF(e,t){1&e&&j.Rb(0)}function dF(e,t){if(1&e&&(j.Ic(0,pF,1,0,"ng-container",31),j.Ic(1,uF,1,0,"ng-container",31)),2&e){j.gc();var n=j.tc(5),i=j.tc(3);j.lc("ngTemplateOutlet",n),j.Db(1),j.lc("ngTemplateOutlet",i)}}function gF(e,t){if(1&e&&(j.Vb(0,"div"),j.Vb(1,"div",25),j.Ic(2,rF,2,2,"ng-template",null,26,j.Jc),j.Ic(4,aF,3,5,"ng-template",null,27,j.Jc),j.Ic(6,lF,3,2,"ng-container",2),j.Ic(7,dF,2,2,"ng-template",null,28,j.Jc),j.Ub(),j.Ub()),2&e){var n=j.tc(8),i=j.gc();j.Db(6),j.lc("ngIf","inline"===i.layout)("ngIfElse",n)}}var hF,fF,bF,mF,vF=["*"],yF=((hF=function(){function e(t,n,i,o){y(this,e),this.store=t,this.actions=n,this.formBuilder=i,this.changeRef=o,this.maxEmailCount=50,this.availableRoles=[],this.layout="inline",this.enableActions=!0,this.sendText="Send invites",this.cancelText="Cancel",this.inviteSent=new j.p,this.inviteCancelled=new j.p,this.ngUnsubscribe=new Z.a,this.sent=!1,this.sentResponses=[],this.errorResponses=[]}return v(e,[{key:"valid",get:function(){return this.form.valid}},{key:"ngOnInit",value:function(){this.initForm(),this.initInviteListeners()}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"initForm",value:function(){var e=this;this.store.dispatch(new bv),this.currentUserRole=this.store.selectSnapshot(Ex.getUserRole),this.userRoles$.pipe(Object(Y.a)((function(e){return e.length>0})),Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){e.availableRoles=t.filter((function(t){return wy.indexOf(t.role_name)<=wy.indexOf(e.currentUserRole.role_name)})),e.changeRef.markForCheck()})),this.form=this.formBuilder.group({emails:["",mh.t.required,UE(this.maxEmailCount).bind(this)],roleId:["",mh.t.required]})}},{key:"initInviteListeners",value:function(){var e=this;this.actions.pipe(Object(L.j)(rE),Object(X.a)(this.ngUnsubscribe)).subscribe((function(){e.resetState(),e.changeRef.markForCheck()})),this.actions.pipe(Object(L.j)(aE),Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){var n=t.responses;e.resetState(),e.sentResponses=n.filter((function(e){return"success"===e.status})),e.errorResponses=n.filter((function(e){return"error"===e.status})),e.sent=0===e.errorResponses.length,e.sent&&e.inviteSent.next(n),e.changeRef.markForCheck()})),this.actions.pipe(Object(L.j)(sE,$v),Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){e.resetState(),e.errorMessage=EE(t.error)||"There was an error sending the invites, please try again.",e.changeRef.markForCheck()}))}},{key:"handleCancelClick",value:function(){this.inviteCancelled.next()}},{key:"backToFormClick",value:function(){this.resetState(),this.changeRef.markForCheck()}},{key:"handleInviteClick",value:function(){var e=this,t=this.organization.eid,n=Cf.parseEmails(this.form.value.emails).map((function(t){return{user_email:t,role_id:parseInt(e.form.value.roleId,10)}}));this.store.dispatch(new rE(t,n))}},{key:"formatEmails",value:function(e){return e.join(", ")}},{key:"formatResponses",value:function(e){var t=this,n=e.map((function(e){return e.reason}));return p(new Set(p(n))).map((function(n){var i=e.filter((function(e){return e.reason===n})).map((function(e){return e.email})),o=t.formatEmails(i);return'"'.concat(n,'": ').concat(o)}))}},{key:"resetState",value:function(){this.sent=!1,this.sentResponses=[],this.errorResponses=[],this.errorMessage=""}}]),e}()).\u0275fac=function(e){return new(e||hF)(j.Pb(L.g),j.Pb(L.b),j.Pb(mh.e),j.Pb(j.i))},hF.\u0275cmp=j.Jb({type:hF,selectors:[["app-team-invite"]],inputs:{organization:"organization",layout:"layout",enableActions:"enableActions",sendText:"sendText",cancelText:"cancelText"},outputs:{inviteSent:"inviteSent",inviteCancelled:"inviteCancelled"},ngContentSelectors:vF,decls:8,vars:7,consts:[[1,"invite"],[1,"theme-light"],[4,"ngIf","ngIfElse"],["sendFormTmp",""],[4,"ngIf"],[1,"invite__footer"],["class","mv-1",4,"ngIf"],[1,"mv-1"],["data-test","teamInviteSuccess","type","message"],[3,"formGroup",4,"ngIf"],[3,"formGroup"],["class","mb-4",4,"ngIf"],["theme","light","label","Invite via email"],["formControlName","emails","data-test","teamInviteEmails","rows","8",1,"invite__input","input",3,"placeholder"],["class","mt-1",4,"ngIf"],["theme","light","label","Role",4,"ngIf"],[1,"mb-4"],["type","error"],[4,"ngFor","ngForOf"],[1,"mt-1"],["theme","light","label","Role"],["formControlName","roleId",1,"input"],["value",""],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"invite__buttons"],["cancelBtnTmp",""],["sendBtnTmp",""],["blockBtnTmp",""],["app-button","","buttonSize","large","buttonTheme","light","buttonType","default","data-test","skipInvitesButton",1,"invite__button",3,"uppercase","click"],["app-button","","buttonSize","large","buttonType","primary","data-test","sendInvitesButton",1,"invite__button",3,"uppercase","disabled","click"],[4,"ngTemplateOutlet"]],template:function(e,t){if(1&e&&(j.kc(),j.Vb(0,"div",0),j.Vb(1,"div",1),j.Ic(2,KE,2,1,"ng-container",2),j.Ic(3,oF,1,1,"ng-template",null,3,j.Jc),j.Ub(),j.Ic(5,gF,9,2,"div",4),j.Vb(6,"div",5),j.jc(7,0,["[select]","invite - footer"]),j.Ub(),j.Ub()),2&e){var n=j.tc(4);j.Hb("invite--inline","inline"===t.layout)("invite--block","block"===t.layout),j.Db(2),j.lc("ngIf",t.sent)("ngIfElse",n),j.Db(3),j.lc("ngIf",t.enableActions&&!t.sent)}},directives:[we.l,zw,mh.o,mh.i,HE,mh.c,mh.n,mh.h,we.k,QE.b,mh.s,mh.q,mh.u,Dd,we.q],pipes:[we.b],styles:[".invite__input[_ngcontent-%COMP%]{resize:vertical}.invite__actions[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between;align-items:center}.invite__actions--compact[_ngcontent-%COMP%]{justify-content:flex-end}.invite__buttons[_ngcontent-%COMP%]{display:flex;flex-direction:row;margin:8px auto}.invite--inline[_ngcontent-%COMP%]   .invite__button[_ngcontent-%COMP%]{margin-left:16px}.invite--inline[_ngcontent-%COMP%]   .invite__buttons[_ngcontent-%COMP%]{justify-content:flex-end}.invite--block[_ngcontent-%COMP%]   .invite__button[_ngcontent-%COMP%]{margin:16px 0}.invite--block[_ngcontent-%COMP%]   .invite__buttons[_ngcontent-%COMP%]{justify-content:flex-end;flex-direction:column}"],changeDetection:0}),qE([Object(L.d)(TE.getInviting),$E("design:type",J.a)],hF.prototype,"inviting$",void 0),qE([Object(L.d)(Ex.getUserRoles),$E("design:type",J.a)],hF.prototype,"userRoles$",void 0),hF),xF=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},OF=((fF=function(){function e(t,n){y(this,e),this.dialogRef=t,this.data=n,this.sent=!1,this.sentResponses=[],this.errorResponses=[],this.ngUnsubscribe=new Z.a,this.organization=n.organization}return v(e,[{key:"ngOnInit",value:function(){}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"handleInviteSent",value:function(e){var t=this;setTimeout((function(){t.inviteComplete()}),5e3)}},{key:"handleInviteCancelled",value:function(){this.inviteComplete()}},{key:"inviteComplete",value:function(){this.dialogRef.close()}}]),e}()).\u0275fac=function(e){return new(e||fF)(j.Pb(ap.g),j.Pb(ap.a))},fF.\u0275cmp=j.Jb({type:fF,selectors:[["app-team-invite-dialog"]],decls:10,vars:3,consts:[[1,"dialog"],["mat-dialog-title",""],[1,"flex","flex-row","justify-between"],["app-button","","buttonType","text","buttonTheme","light","type","button","title","Close",3,"click"],["icon","times","size","lg"],["mat-dialog-content","",1,"theme-light","p-6"],["sentText","Send invites","cancelText","Cancel",3,"organization","layout","inviteSent","inviteCancelled"]],template:function(e,t){1&e&&(j.Vb(0,"div",0),j.Vb(1,"div",1),j.Vb(2,"div",2),j.Vb(3,"h1"),j.Kc(4,"Invite Members"),j.Ub(),j.Vb(5,"button",3),j.cc("click",(function(){return t.handleInviteCancelled()})),j.Qb(6,"app-icon",4),j.Ub(),j.Ub(),j.Ub(),j.Qb(7,"mat-divider"),j.Vb(8,"div",5),j.Vb(9,"app-team-invite",6),j.cc("inviteSent",(function(e){return t.handleInviteSent(e)}))("inviteCancelled",(function(){return t.handleInviteCancelled()})),j.Ub(),j.Ub(),j.Ub()),2&e&&(j.Db(5),j.Eb("aria-label","Close"),j.Db(4),j.lc("organization",t.organization)("layout","inline"))},directives:[ap.h,Dd,vp,Ad.a,ap.e,yF],styles:[".dialog[_ngcontent-%COMP%]{width:480px;min-height:320px}.dialog__input[_ngcontent-%COMP%]{resize:vertical}.dialog__actions[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between;align-items:center}.dialog__actions--compact[_ngcontent-%COMP%]{justify-content:flex-end}@media (max-width:480px){.dialog[_ngcontent-%COMP%]{width:100%}}"],changeDetection:0}),function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);r>3&&a&&Object.defineProperty(t,n,a)}([Object(L.d)(TE.getInviting),xF("design:type",J.a)],fF.prototype,"inviting$",void 0),fF),wF=function(){var e=function e(){y(this,e)};return e.type="[Share] Reset",e}(),kF=function(){var e=function e(t){y(this,e),this.shareEmail=t};return e.type="[Share] Share Email Link",e}(),CF=function(){var e=function e(t){y(this,e),this.shareEmail=t};return e.type="[Share] Share Email Link Success",e}(),SF=function(){var e=function e(t){y(this,e),this.error=t};return e.type="[Share] Share Email Link Fail",e}(),_F=function e(){y(this,e)},jF=function(e){return e.Facebook="facebook",e.LinkedIn="linkedin",e.Twitter="twitter",e}({}),PF=function(e){return e.Model="model",e.Quiz="quiz",e}({}),MF=((bF=function(){function e(t,n){y(this,e),this.http=t,this.APP_BASE_URL=n}return v(e,[{key:"shareEmailLink",value:function(e){return this.http.post("/ws/user/share/email",e)}},{key:"generateShareLink",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"en",n=e.thumbnail_url.replace("/small/","/large/");return{type:e.quiz?PF.Quiz:PF.Model,title:e.title,relativeUrl:this.createShareUrl(e,"share",t,!1,!1),fullUrl:this.createShareUrl(e,"share",t,!0,!1),thumbUrl:n,social:[{type:jF.Facebook,url:"https://www.facebook.com/sharer/sharer.php?u="+this.createShareUrl(e,jF.Facebook,t,!0,!0)},{type:jF.LinkedIn,url:"https://www.linkedin.com/sharing/share-offsite/?url="+this.createShareUrl(e,jF.LinkedIn,t,!0,!0)},{type:jF.Twitter,url:"http://twitter.com/share?url="+this.createShareUrl(e,jF.Twitter,t,!0,!0)}]}}},{key:"createShareUrl",value:function(e,t,n,i,o){var r=e.id.replace(".json",""),a=Object.values(jF).includes(t),s="/view?id=".concat(r,"&lang=").concat(n,"&ref=").concat(t),c=i||a?"".concat(a?"https://human.biodigital.com":this.APP_BASE_URL).concat(s):s;return o?encodeURIComponent(c):c}}]),e}()).\u0275fac=function(e){return new(e||bF)(j.Zb(Q.b),j.Zb(v_))},bF.\u0275prov=j.Lb({token:bF,factory:bF.\u0275fac,providedIn:"root"}),bF),IF=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},zF=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},TF={sharing:!1},UF=((mF=function(){function e(t,n,i){y(this,e),this.shareService=t,this.productService=n,this.authService=i}return v(e,[{key:"resetShare",value:function(e,t){e.setState(TF)}},{key:"sendEmail",value:function(e,t){var n=this,i=t.shareEmail;e.patchState({sharing:!0}),this.authService.isHuman("share_email",!0).pipe(Object(ei.a)((function(t){t.isHuman||e.dispatch(new $v(new Error("reCAPTCHA error. Refresh the page and try again.")))})),Object(Y.a)((function(e){return e.isHuman})),Object(vr.b)((function(e){return n.shareService.shareEmailLink(Object.assign({version:4,app_productkey:n.productService.productKey,app_producttype:n.productService.productType,site_verify_response:e.verification},i))})),Object(Ss.a)((function(){return e.patchState({sharing:!1})}))).subscribe((function(){return e.dispatch(new CF(i))}),(function(t){return e.dispatch(new SF(t))}))}}],[{key:"getSharing",value:function(e){return e.sharing}}]),e}()).\u0275fac=function(e){return new(e||mF)(j.Zb(MF),j.Zb(Ry),j.Zb(Ny))},mF.\u0275prov=j.Lb({token:mF,factory:mF.\u0275fac}),IF([Object(L.a)(wF),zF("design:type",Function),zF("design:paramtypes",[Object,wF]),zF("design:returntype",void 0)],mF.prototype,"resetShare",null),IF([Object(L.a)(kF),zF("design:type",Function),zF("design:paramtypes",[Object,kF]),zF("design:returntype",void 0)],mF.prototype,"sendEmail",null),IF([Object(L.e)(),zF("design:type",Function),zF("design:paramtypes",[_F]),zF("design:returntype",void 0)],mF,"getSharing",null),mF=IF([Object(L.f)({name:"share",defaults:TF})],mF)),DF=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},LF=["emailField"];function EF(e,t){1&e&&(j.Tb(0),j.Vb(1,"div",11),j.Vb(2,"app-message-toggle",12),j.Kc(3," Your email was successfully sent. "),j.Ub(),j.Ub(),j.Sb())}function FF(e,t){if(1&e&&(j.Vb(0,"div",11),j.Vb(1,"app-message-toggle",20),j.Kc(2),j.Ub(),j.Ub()),2&e){var n=j.gc(2);j.Db(2),j.Mc(" ",n.errorMessage," ")}}function AF(e,t){1&e&&j.Qb(0,"app-spinner",21)}function RF(e,t){1&e&&(j.Vb(0,"div",24),j.Vb(1,"mat-error"),j.Kc(2,"Please enter a valid email address."),j.Ub(),j.Ub())}function VF(e,t){if(1&e&&(j.Vb(0,"div",26),j.Vb(1,"mat-error"),j.Kc(2),j.Ub(),j.Ub()),2&e){var n=j.gc(2).$implicit,i=j.gc(2);j.Db(2),j.Nc(" Maximum email addresses excceeded, ",n.currentEmailCount," of ",i.maxEmailCount," max. ")}}function NF(e,t){if(1&e&&j.Ic(0,VF,3,2,"div",25),2&e){var n=j.gc().$implicit;j.lc("ngIf",n.maxEmailsExceeded)}}function BF(e,t){if(1&e&&(j.Tb(0),j.Ic(1,RF,3,0,"div",22),j.Ic(2,NF,1,1,"ng-template",null,23,j.Jc),j.Sb()),2&e){var n=t.$implicit,i=j.tc(3);j.Db(1),j.lc("ngIf",n.invalidEmails)("ngIfElse",i)}}function HF(e,t){if(1&e){var n=j.Wb();j.Ic(0,FF,3,1,"div",13),j.Vb(1,"form",14),j.cc("submit",(function(){j.xc(n);var e=j.gc();return e.submitForm(e.config.shareLink)})),j.Vb(2,"textarea",15,16),j.Kc(4,"        "),j.Ub(),j.Vb(5,"button",17),j.hc(6,"async"),j.hc(7,"async"),j.Ic(8,AF,1,0,"app-spinner",18),j.hc(9,"async"),j.Kc(10),j.hc(11,"async"),j.Ub(),j.Ub(),j.Ic(12,BF,4,2,"ng-container",19)}if(2&e){var i=j.gc();j.lc("ngIf",i.errorMessage),j.Db(1),j.lc("formGroup",i.form),j.Db(4),j.lc("disabled",!i.form.valid||j.ic(6,8,i.sharing$))("loading",j.ic(7,10,i.sharing$)),j.Eb("aria-label","Send Email"),j.Db(3),j.lc("ngIf",j.ic(9,12,i.sharing$)),j.Db(2),j.Mc(" ",j.ic(11,14,i.sharing$)?"Sending":"Send Email"," "),j.Db(2),j.lc("ngIf",i.form.get("emails").errors)}}function QF(e,t){if(1&e&&(j.Vb(0,"a",27),j.hc(1,"titlecase"),j.hc(2,"titlecase"),j.Qb(3,"img",6),j.Ub()),2&e){var n=t.$implicit;j.lc("href",n.url,j.Ac)("matTooltip","Share via "+j.ic(2,7,n.type)),j.Eb("aria-label","Share via "+j.ic(1,5,n.type))("data-test",n.type+"LinkButton"),j.Db(3),j.lc("src","/assets/images/social/"+n.type+"-share.svg",j.Ac)}}function qF(e,t){if(1&e&&(j.Vb(0,"p",28),j.Kc(1),j.Ub()),2&e){var n=j.gc();j.Db(1),j.Mc(" ",n.config.description," ")}}var $F,WF,KF,GF,ZF,JF,XF,YF,eA,tA,nA,iA,oA,rA,aA,sA,cA,lA,pA,uA,dA,gA,hA,fA,bA,mA,vA,yA,xA,OA,wA,kA,CA=(($F=function(){function e(t,n,i,o,r,a,s,c){y(this,e),this.store=t,this.actions=n,this.dialogRef=i,this.data=o,this.clipboardService=r,this.snackBar=a,this.formBuilder=s,this.changeRef=c,this.maxEmailCount=50,this.config={title:"Share"},this.emailSent=!1,this.errorMessage="",this.formError="",this.ngUnsubscribe=new Z.a,this.config=Object.assign(Object.assign({},this.config),o),this.initForm()}return v(e,[{key:"ngOnInit",value:function(){this.initEmailListeners()}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"initForm",value:function(){this.form=this.formBuilder.group({emails:["",mh.t.required,UE(this.maxEmailCount).bind(this)]})}},{key:"initEmailListeners",value:function(){var e=this;this.actions.pipe(Object(L.j)(kF),Object(X.a)(this.ngUnsubscribe)).subscribe((function(){e.emailSent=!1,e.errorMessage="",e.changeRef.markForCheck()})),this.actions.pipe(Object(L.j)(CF),Object(X.a)(this.ngUnsubscribe)).subscribe((function(){e.emailSent=!0,e.errorMessage="",setTimeout((function(){e.emailSent=!1,e.form.setValue({emails:""}),e.changeRef.markForCheck(),setTimeout((function(){return e.focus()}))}),5e3),e.changeRef.markForCheck()})),this.actions.pipe(Object(L.j)(SF),Object(X.a)(this.ngUnsubscribe)).subscribe((function(t){e.emailSent=!1,e.errorMessage=EE(t.error)||"There was an error sending the email.",setTimeout((function(){return e.focus()})),e.changeRef.markForCheck()}))}},{key:"focus",value:function(){var e,t=null===(e=this.emailField)||void 0===e?void 0:e.nativeElement;t&&t.focus()}},{key:"submitForm",value:function(e){var t=e.type,n=e.title,i=e.relativeUrl,o=e.thumbUrl,r=Cf.parseEmails(this.form.value.emails);this.store.dispatch(new kF({share_type:t,share_title:n,share_thumbnail_path:o,share_link_path:i,share_emails:r}))}},{key:"handleCopyClick",value:function(e,t){var n=this;this.clipboardService.copyToClipboard(e,"url").pipe(Object(X.a)(this.ngUnsubscribe)).subscribe((function(e){n.snackBar.open("Link ".concat(e?"copied":"not copied","."))})),t.preventDefault()}},{key:"handleCloseClick",value:function(){this.dialogRef.close()}}]),e}()).\u0275fac=function(e){return new(e||$F)(j.Pb(L.g),j.Pb(L.b),j.Pb(ap.g),j.Pb(ap.a),j.Pb(Ju),j.Pb(Sd.b),j.Pb(mh.e),j.Pb(j.i))},$F.\u0275cmp=j.Jb({type:$F,selectors:[["app-share-url-dialog"]],viewQuery:function(e,t){var n;1&e&&j.Pc(LF,!0),2&e&&j.sc(n=j.dc())&&(t.emailField=n.first)},decls:14,vars:9,consts:[["role","dialog","aria-modal","true","data-test","shareUrlDialog",1,"share-url-dialog"],[1,"share-url-dialog__title","mb-5"],[4,"ngIf","ngIfElse"],["emailFormTmp",""],[1,"share-url-dialog__social"],["target","_blank","aria-label","Copy Link","matTooltip","Copy Link","matTooltipPosition","below","data-test","copyLinkButton",1,"share-url-dialog__social-link",3,"href","click"],[3,"src"],["class","share-url-dialog__social-link","target","_blank","matTooltipPosition","below",3,"href","matTooltip",4,"ngFor","ngForOf"],["class","share-url-dialog__description mv-3",4,"ngIf"],["app-button","","buttonType","text","buttonTheme","light","type","button","title","Close",1,"share-url-dialog__close",3,"click"],["icon","times","size","lg"],[1,"mv-2"],["type","message"],["class","mv-2",4,"ngIf"],[1,"share-url-dialog__form",3,"formGroup","submit"],["rows","1","formControlName","emails","placeholder","Email, comma separated","data-test","emailEntryField",1,"share-url-dialog__input","input","theme-light"],["emailField",""],["type","submit","app-button","","buttonType","primary","title","'Send Email'","data-test","emailLinkButton",1,"share-url-dialog__submit",3,"disabled","loading"],["size","small","class","mr-2","render","inline",4,"ngIf"],[4,"ngIf"],["type","error"],["size","small","render","inline",1,"mr-2"],["class","mv-1",4,"ngIf","ngIfElse"],["maxEmailErrorTmp",""],[1,"mv-1"],["class","flex flex-column mv-1",4,"ngIf"],[1,"flex","flex-column","mv-1"],["target","_blank","matTooltipPosition","below",1,"share-url-dialog__social-link",3,"href","matTooltip"],[1,"share-url-dialog__description","mv-3"]],template:function(e,t){if(1&e&&(j.Vb(0,"div",0),j.Vb(1,"h2",1),j.Kc(2),j.Ub(),j.Tb(3),j.Ic(4,EF,4,0,"ng-container",2),j.Ic(5,HF,13,16,"ng-template",null,3,j.Jc),j.Sb(),j.Vb(7,"div",4),j.Vb(8,"a",5),j.cc("click",(function(e){return t.handleCopyClick(null==t.config.shareLink?null:t.config.shareLink.fullUrl,e)})),j.Qb(9,"img",6),j.Ub(),j.Ic(10,QF,4,9,"a",7),j.Ub(),j.Ic(11,qF,2,1,"p",8),j.Vb(12,"button",9),j.cc("click",(function(){return t.handleCloseClick()})),j.Qb(13,"app-icon",10),j.Ub(),j.Ub()),2&e){var n=j.tc(6);j.Eb("aria-label",t.config.title+" Dialog"),j.Db(2),j.Mc(" ",t.config.title," "),j.Db(2),j.lc("ngIf",t.emailSent)("ngIfElse",n),j.Db(4),j.lc("href",null==t.config.shareLink?null:t.config.shareLink.fullUrl,j.Ac),j.Db(1),j.lc("src","/assets/images/social/link-share.svg",j.Ac),j.Db(1),j.lc("ngForOf",null==t.config.shareLink?null:t.config.shareLink.social),j.Db(1),j.lc("ngIf",t.config.description),j.Db(1),j.Eb("aria-label","Close")}},directives:[we.l,Lg.c,we.k,Dd,vp,zw,mh.v,mh.o,mh.i,mh.c,mh.n,mh.h,Bg,QE.b],pipes:[we.b,we.t],styles:[".text-8[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase[_ngcontent-%COMP%]{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase[_ngcontent-%COMP%]{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase[_ngcontent-%COMP%]{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase[_ngcontent-%COMP%]{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-28[_ngcontent-%COMP%]{font-size:28px;letter-spacing:.7px;line-height:1.4em}.text-28.text-uppercase[_ngcontent-%COMP%]{font-size:28px;letter-spacing:1.68px;line-height:1.25em;text-transform:uppercase}.text-header[_ngcontent-%COMP%]{font-weight:700}.text--code[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.text-xlight[_ngcontent-%COMP%]{font-weight:200}.text-light[_ngcontent-%COMP%]{font-weight:300}.text-medium[_ngcontent-%COMP%]{font-weight:500}.text-semibold[_ngcontent-%COMP%]{font-weight:600}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-underline[_ngcontent-%COMP%]{text-decoration:underline}.text-italic[_ngcontent-%COMP%]{font-style:italic}.text-bright[_ngcontent-%COMP%]{color:#fff}.text-dim[_ngcontent-%COMP%]{color:#96a8c0}.text-error[_ngcontent-%COMP%]{color:#ed4758}.text-left[_ngcontent-%COMP%]{text-align:left}.text-center[_ngcontent-%COMP%]{text-align:center}.text-right[_ngcontent-%COMP%]{text-align:right}.text-ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link[_ngcontent-%COMP%], .text-link[_ngcontent-%COMP%]:visited{color:inherit;cursor:pointer}.text-link[_ngcontent-%COMP%]:not(.text-underline), .text-link[_ngcontent-%COMP%]:visited:not(.text-underline){text-decoration:none}.text-success[_ngcontent-%COMP%]{color:#38de38}.text-danger[_ngcontent-%COMP%]{color:#de3535}.text-info[_ngcontent-%COMP%]{color:#2d72dc}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.text-pre-line[_ngcontent-%COMP%]{white-space:pre-line}.share-url-dialog[_ngcontent-%COMP%]{position:relative;max-width:420px}.share-url-dialog__title[_ngcontent-%COMP%]{color:#1c2a3f;font-size:20px;letter-spacing:.5px;line-height:1.4em;font-weight:500}.share-url-dialog__description[_ngcontent-%COMP%]{color:#61779e;font-size:11px;letter-spacing:.275px;line-height:1.4em}.share-url-dialog__form[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between;gap:8px}.share-url-dialog__submit[_ngcontent-%COMP%]{flex:1 0 120px}.share-url-dialog__social[_ngcontent-%COMP%]{display:flex;flex-direction:row;gap:24px;margin-top:32px;margin-bottom:20px}.share-url-dialog__social-link[_ngcontent-%COMP%]{width:36px;height:36px;border-radius:100%;cursor:pointer}.share-url-dialog__social-link[_ngcontent-%COMP%]:focus{outline:2px solid #2d72dc!important}.share-url-dialog__social-link[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%}.share-url-dialog__input[_ngcontent-%COMP%], .share-url-dialog__input[_ngcontent-%COMP%]:disabled{background-color:#f9fafd;color:#61779e;font-size:12px;letter-spacing:.3px;line-height:1.4em;opacity:1;resize:vertical;max-height:240px}.share-url-dialog__close[_ngcontent-%COMP%]{position:absolute;top:-4px;right:-12px}@media (max-width:480px){.share-url-dialog__form[_ngcontent-%COMP%]{flex-wrap:wrap}}"],changeDetection:0}),function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);r>3&&a&&Object.defineProperty(t,n,a)}([Object(L.d)(UF.getSharing),DF("design:type",J.a)],$F.prototype,"sharing$",void 0),$F),SA={maxWidth:"100vw",width:"100vw",height:"100vh",panelClass:"full-modal"},_A=((WF=function(){function e(t,n,i,o,r,a,s){y(this,e),this.dialog=t,this.engineService=n,this.router=i,this.store=o,this.pendoService=r,this.productService=a,this.organizationsService=s}return v(e,[{key:"isMobile",get:function(){return window.innerWidth<=959}},{key:"openClipboardDialog",value:function(e,t){var n=Object.assign({data:{id:Wg.ClipboardDialog,copyText:e}},t);return this.dialog.open(GL,n)}},{key:"openShareDialog",value:function(e,t,n){return this.dialog.open(CA,{id:Wg.ShareUrlDialog,disableClose:!0,data:{title:t,description:n,shareLink:e},maxWidth:"90vw"})}},{key:"openConfirmDialog",value:function(e){var t=Object.assign({id:Wg.ConfirmDialog},e);return this.dialog.open(WL,t)}},{key:"openLimitDialog",value:function(){return this.closeAllDialogs(),this.dialog.open(AL,{id:Wg.LimitDialog,width:"480px"})}},{key:"openUpgradeDialog",value:function(){var e,t=this,n=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];n&&this.closeAllDialogs();var i,o=this.store.selectSnapshot(Ex.getUserProfile),r=this.getContactProfileParams(o),a=o.premium_account_valid?o.premium_account_type:"free",s=Object(ie.get)(o,"organizations[0].subscription.type","").toLowerCase(),l=this.store.selectSnapshot(XU.isTrialExpired),p=oe(o.account_settings);switch(Object(ie.get)(p,"account_purpose.value","")){case XL.Business:i="business.html";break;case XL.Education:i="school.html";break;default:i="individual.html"}var u=Object.assign(Object.assign({},r),{accountType:a,subscription:s,expired:l}),g="".concat(T.native?"":(e={},c(e,I.Local,"https://localhost:1234"),c(e,I.QA,"https://pricing-qa.biodigital.com"),c(e,I.Staging,"https://pricing.biodigital.com"),c(e,I.Production,"https://pricing.biodigital.com"),e)[T.deploy],"/").concat(i,"?").concat(this.serializeQueryParams(u)),h=Object.assign(Object.assign({id:Wg.PricingDialog},SA),{data:{title:"Upgrade",url:g,backgroundColor:"#0B1220"}}),f=encodeURIComponent(this.router.url);return this.dialog.open(JL,h).afterClosed().subscribe((function(e){if(e){var n=Object.assign({action:"",plan:""},e.metadata),i={business:["starter","premium","enterprise"],education:["class","institution"]},o="Individual";Object.entries(i).forEach((function(e){var t=d(e,2),i=t[0];t[1].indexOf(n.plan)&&(o=i)})),n.action&&t.pendoService.track("Pricing - ".concat(Object(ie.capitalize)(n.action)," - ").concat(Object(ie.capitalize)(n.plan)),{platform:t.productService.productType,page:o});var r="";switch(n.action){case"buy":if(T.native)return void t.engineService.fireEvent(yn.NativeUpgrade,null);t.router.navigate(["/account/profile"],{queryParams:{section:"subscription",mode:"edit"}});break;case"contact":t.openContactDialog("pricing page");break;case"try":switch(!0){case i.business.includes(n.plan):r="/account/workflow/team/create?purpose=Business&returnTo="+f;break;case i.education.includes(n.plan):r="/account/workflow/team/create?purpose=Education&returnTo="+f;break;default:r="account/workflow"}t.router.navigateByUrl(r)}}else t.pendoService.track("Pricing - Exit")}))}},{key:"openContactDialog",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=this.store.selectSnapshot(XU.getOrganization),i=Object(ie.isNil)(n)?"":""+n.id,o=this.store.selectSnapshot(Ex.getUserProfile),r=this.getContactProfileParams(o),a=(c(e={},I.Local,"http://craft-sandbox.biodigital.local"),c(e,I.QA,"http://craft-sandbox.biodigital.local"),c(e,I.Staging,"https://www.biodigital.com"),c(e,I.Production,"https://www.biodigital.com"),e),s=T.native?a[I.Production]:a[T.deploy];if(T.native){var l=this.serializeQueryParams(Object.assign(Object.assign({},r),{organizationId:i,utm_source:"human-mobile",utm_campaign:t}));return window.open("".concat(s,"/contact?").concat(l),"_blank")}var p="".concat(s,"/headless/contact-us?").concat(this.serializeQueryParams(Object.assign(Object.assign({},r),{organizationId:i,utm_source:"human-web",utm_campaign:t}))),u=Object.assign(Object.assign({id:Wg.ContactDialog},SA),{data:{title:"Contact Us",url:p}});return this.dialog.open(JL,u)}},{key:"openPremiumContentDialog",value:function(){var e=T.native||!this.isMobile;return this.openConfirmDialog({id:Wg.PremiumContentDialog,data:{titleText:"Premium Content",bodyText:e?"This is premium content. Upgrade to a Premium Plan for unlimited access.":"This is premium content. Visit us on desktop to upgrade to a premium plan.",confirmText:"Upgrade Now",confirmEnabled:e,cancelText:"OK",confirmColor:"warn"}})}},{key:"openAddUserDialog",value:function(){var e=this.store.selectSnapshot(XU.getOrganization);this.dialog.open(OF,{id:Wg.AddTeamModelDialog,disableClose:!1,data:{organization:e}})}},{key:"closeAllDialogs",value:function(){this.dialog.closeAll()}},{key:"getContactProfileParams",value:function(e){var t=e.first_name,n=e.last_name,i=e.email,o=Object(ie.get)(e,"organizations[0].name",""),r=Object(ie.get)(e,"organizations[0].group_attributes",[]),a=oe(e.account_settings),s=Object(ie.get)(a,"account_purpose.value",""),c=Object(ie.get)(a,"account_field.value",""),l=Object(ie.get)(a,"account_field.value",""),p=Object(ie.get)(a,"account_role.value",""),u=this.organizationsService.getOrganizationAttribute(r,"account_settings","account_company_size"),d=this.organizationsService.getOrganizationAttribute(r,"account_settings","account_company_website");return{first_name:t,last_name:n,email:i,company:o,website:d?d.value:"",purpose:s,role:p,program_type:l,program_size:u?u.value:"",industry:s===XL.Education?"Academia":c}}},{key:"serializeQueryParams",value:function(e){return Object.entries(e).map((function(e){var t=d(e,2),n=t[0],i=t[1],o="string"!=typeof i?JSON.stringify(i):i;return"".concat(n,"=").concat(encodeURIComponent(o))})).join("&")}}]),e}()).\u0275fac=function(e){return new(e||WF)(j.Zb(ap.b),j.Zb(Sn),j.Zb(te.e),j.Zb(L.g),j.Zb(Oe),j.Zb(Ry),j.Zb(ye))},WF.\u0275prov=j.Lb({token:WF,factory:WF.\u0275fac,providedIn:"root"}),WF),jA=function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},PA=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},MA=((nA=function(){function e(t){y(this,e),this.dialogService=t}return v(e,[{key:"openLimit",value:function(e,t){this.dialogService.openLimitDialog().afterClosed().subscribe((function(t){e.dispatch(new bL.CloseLimit(t))}))}},{key:"closeLimit",value:function(e,t){t.upgrade&&this.dialogService.openUpgradeDialog()}},{key:"openPremiumContent",value:function(e,t){this.dialogService.openPremiumContentDialog().afterClosed().subscribe((function(t){e.dispatch(new bL.ClosePremiumContent(t))}))}},{key:"closePremiumContent",value:function(e,t){t.confirmed&&e.dispatch(new bL.OpenUpgrade)}},{key:"openUpgrade",value:function(e,t){this.dialogService.openUpgradeDialog()}}],[{key:"getOpenDialog",value:function(e){return e.openDialog}}]),e}()).\u0275fac=function(e){return new(e||nA)(j.Zb(_A))},nA.\u0275prov=j.Lb({token:nA,factory:nA.\u0275fac}),jA([Object(L.a)(bL.OpenLimit),PA("design:type",Function),PA("design:paramtypes",[Object,bL.OpenLimit]),PA("design:returntype",void 0)],nA.prototype,"openLimit",null),jA([Object(L.a)(bL.CloseLimit),PA("design:type",Function),PA("design:paramtypes",[Object,bL.CloseLimit]),PA("design:returntype",void 0)],nA.prototype,"closeLimit",null),jA([Object(L.a)(bL.OpenPremiumContent),PA("design:type",Function),PA("design:paramtypes",[Object,bL.OpenPremiumContent]),PA("design:returntype",void 0)],nA.prototype,"openPremiumContent",null),jA([Object(L.a)(bL.ClosePremiumContent),PA("design:type",Function),PA("design:paramtypes",[Object,bL.ClosePremiumContent]),PA("design:returntype",void 0)],nA.prototype,"closePremiumContent",null),jA([Object(L.a)(bL.OpenUpgrade),PA("design:type",Function),PA("design:paramtypes",[Object,bL.OpenUpgrade]),PA("design:returntype",void 0)],nA.prototype,"openUpgrade",null),jA([Object(L.e)(),PA("design:type",Function),PA("design:paramtypes",[EL]),PA("design:returntype",void 0)],nA,"getOpenDialog",null),nA=jA([Object(L.f)({name:"dialog",defaults:{openDialog:null}})],nA)),IA=((tA=function e(){y(this,e)}).\u0275mod=j.Nb({type:tA}),tA.\u0275inj=j.Mb({factory:function(e){return new(e||tA)},imports:[[we.c,MT,IU,mh.r]]}),tA),zA=((eA=function e(){y(this,e)}).\u0275mod=j.Nb({type:eA}),eA.\u0275inj=j.Mb({factory:function(e){return new(e||eA)},imports:[[we.c,MT,IU,mh.r]]}),eA),TA=((YF=function e(){y(this,e)}).\u0275mod=j.Nb({type:YF}),YF.\u0275inj=j.Mb({factory:function(e){return new(e||YF)},imports:[[we.c,MT,IU,mh.r]]}),YF),UA=((XF=function e(){y(this,e)}).\u0275mod=j.Nb({type:XF}),XF.\u0275inj=j.Mb({factory:function(e){return new(e||XF)},imports:[[we.c,MT,IU]]}),XF),DA=((JF=function e(){y(this,e)}).\u0275mod=j.Nb({type:JF}),JF.\u0275inj=j.Mb({factory:function(e){return new(e||JF)},imports:[[we.c,MT,mh.j,mh.r,IU]]}),JF),LA=((ZF=function e(){y(this,e)}).\u0275mod=j.Nb({type:ZF}),ZF.\u0275inj=j.Mb({factory:function(e){return new(e||ZF)},imports:[[we.c,MT,IU,mh.r]]}),ZF),EA=((GF=function e(){y(this,e)}).\u0275mod=j.Nb({type:GF}),GF.\u0275inj=j.Mb({factory:function(e){return new(e||GF)},imports:[[we.c,MT,IU,mh.r]]}),GF),FA=((KF=function e(){y(this,e)}).\u0275mod=j.Nb({type:KF}),KF.\u0275inj=j.Mb({factory:function(e){return new(e||KF)},imports:[[we.c,MT,zT,bU]]}),KF),AA=r("1y1q"),RA=((dA=function e(){y(this,e)}).\u0275mod=j.Nb({type:dA}),dA.\u0275inj=j.Mb({factory:function(e){return new(e||dA)},imports:[[we.c,IU,MT,_T.a,xL,AA.a]]}),dA),VA=((uA=function e(){y(this,e)}).\u0275mod=j.Nb({type:uA}),uA.\u0275inj=j.Mb({factory:function(e){return new(e||uA)},imports:[[we.c,MT,mh.j,wU,mh.r,xU,bU,RA,SU]]}),uA),NA=((pA=function e(){y(this,e)}).\u0275mod=j.Nb({type:pA}),pA.\u0275inj=j.Mb({factory:function(e){return new(e||pA)},imports:[[we.c,MT,IU,mh.r,VA]]}),pA),BA=((lA=function e(){y(this,e)}).\u0275mod=j.Nb({type:lA}),lA.\u0275inj=j.Mb({factory:function(e){return new(e||lA)},imports:[[we.c,MT,IU,mh.r]]}),lA),HA=((cA=function e(){y(this,e)}).\u0275mod=j.Nb({type:cA}),cA.\u0275inj=j.Mb({factory:function(e){return new(e||cA)},imports:[[we.c,MT,IU,mh.r]]}),cA),QA=((sA=function e(){y(this,e)}).\u0275mod=j.Nb({type:sA}),sA.\u0275inj=j.Mb({factory:function(e){return new(e||sA)},imports:[[we.c,MT,IU,mh.r]]}),sA),qA=((aA=function e(){y(this,e)}).\u0275mod=j.Nb({type:aA}),aA.\u0275inj=j.Mb({factory:function(e){return new(e||aA)},imports:[[we.c,MT,IU,mh.r]]}),aA),$A=((rA=function e(){y(this,e)}).\u0275mod=j.Nb({type:rA}),rA.\u0275inj=j.Mb({factory:function(e){return new(e||rA)},imports:[[we.c,MT,IU,mh.r]]}),rA),WA=((oA=function e(){y(this,e)}).\u0275mod=j.Nb({type:oA}),oA.\u0275inj=j.Mb({factory:function(e){return new(e||oA)},imports:[[we.c,MT,IU,mh.j,mh.r]]}),oA),KA=((iA=function e(){y(this,e)}).\u0275mod=j.Nb({type:iA}),iA.\u0275inj=j.Mb({factory:function(e){return new(e||iA)},imports:[[L.c.forFeature([MA]),SL,_L,jL,PL,ML,$A,IL,zL,FA,TL,UL,DL,LL,IA,zA,TA,UA,DA,LA,EA,NA,QA,qA,SU,wU,IU],SL,_L,jL,PL,ML,$A,IL,zL,FA,TL,UL,DL,LL,IA,NA,zA,TA,UA,DA,LA,EA,BA,HA,QA,qA,mL,WA]}),iA),GA=[],ZA=((kA=function e(){y(this,e)}).\u0275mod=j.Nb({type:kA}),kA.\u0275inj=j.Mb({factory:function(e){return new(e||kA)},imports:[[te.f.forChild(GA)],te.f]}),kA),JA=((wA=function e(){y(this,e)}).\u0275mod=j.Nb({type:wA}),wA.\u0275inj=j.Mb({factory:function(e){return new(e||wA)},imports:[[we.c]]}),wA),XA=((OA=function e(){y(this,e)}).\u0275mod=j.Nb({type:OA}),OA.\u0275inj=j.Mb({factory:function(e){return new(e||OA)},imports:[[we.c,zT]]}),OA),YA=((xA=function e(){y(this,e)}).\u0275mod=j.Nb({type:xA}),xA.\u0275inj=j.Mb({factory:function(e){return new(e||xA)},imports:[[we.c,MT,bU,mU,zT,xL,TT,mh.r,OL,xU]]}),xA),eR=((yA=function e(){y(this,e)}).\u0275mod=j.Nb({type:yA}),yA.\u0275inj=j.Mb({factory:function(e){return new(e||yA)},imports:[[L.c.forFeature([hs]),Jd.a.forChild(),ne.d,we.c,kL,ZA,MT,mh.r,mh.j,bU,mU,zT,kU,CU,JA,yU,xU,vU,Af.b,oD,wL,xL,IU,XA,OL,YA,qp.a]]}),yA),tR=((vA=function(){function e(){y(this,e)}return v(e,[{key:"intercept",value:function(e,t){return t.handle(e).pipe(Object(se.a)((function(e){return e instanceof Q.e&&e.body&&e.body.hasOwnProperty("results")&&(e=e.clone({body:e.body.results})),e})))}}]),e}()).\u0275fac=function(e){return new(e||vA)},vA.\u0275prov=j.Lb({token:vA,factory:vA.\u0275fac}),vA),nR=((mA=function e(){y(this,e)}).\u0275mod=j.Nb({type:mA}),mA.\u0275inj=j.Mb({factory:function(e){return new(e||mA)},providers:[iI],imports:[[L.c.forFeature([G]),we.c,IU]]}),mA),iR=((bA=function e(){y(this,e)}).\u0275mod=j.Nb({type:bA}),bA.\u0275inj=j.Mb({factory:function(e){return new(e||bA)},imports:[[we.c,te.f,bU,mU,zT]]}),bA),oR=((fA=function(){function e(){y(this,e)}return v(e,[{key:"parse",value:function(e){e=e.replace(/&amp;/g,"&");var t=(new te.b).parse(e);return this.ensureQueryParam(t.queryParams,"dk",e),this.ensureQueryParam(t.queryParams,"uaid",e),t}},{key:"serialize",value:function(e){return(new te.b).serialize(e).replace(/%2F/g,"/")}},{key:"ensureQueryParam",value:function(e,t,n){if(e.hasOwnProperty(t))return e;var i=this.getParameterByName(t,n);return null!==i&&(e[t]=i),e}},{key:"getParameterByName",value:function(e,t){t||(t=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");var n=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)").exec(t);return n?n[2]?decodeURIComponent(n[2].replace(/\+/g," ")):"":null}}]),e}()).\u0275fac=function(e){return new(e||fA)},fA.\u0275prov=j.Lb({token:fA,factory:fA.\u0275fac}),fA),rR=((hA=function e(){y(this,e)}).\u0275mod=j.Nb({type:hA}),hA.\u0275inj=j.Mb({factory:function(e){return new(e||hA)},imports:[[L.c.forFeature([tl]),we.c]]}),hA),aR=((gA=function e(){y(this,e)}).\u0275mod=j.Nb({type:gA}),gA.\u0275inj=j.Mb({factory:function(e){return new(e||gA)},imports:[[L.c.forFeature([gC]),we.c]]}),gA),sR=r("OnMO");function cR(){var e=new sR.Renderer;return e.link=function(e,t,n){var i;return'<a href="'.concat((i=e).match(/^(?:(?:(?:ht)tps?):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i)?i:"",'" target="_blank" rel="noreferrer nofollow">').concat(n,"</a>")},e.paragraph=function(e){return"<p>".concat(e,"</p>")},e.image=function(e,t,n){return""},{renderer:e,gfm:!1}}var lR,pR,uR,dR=((uR=function e(){y(this,e)}).\u0275mod=j.Nb({type:uR}),uR.\u0275inj=j.Mb({factory:function(e){return new(e||uR)},imports:[[we.c,Jd.a.forRoot({markedOptions:{provide:Jd.d,useFactory:cR}})]]}),uR),gR=((pR=function(){function e(){y(this,e)}return v(e,null,[{key:"forRoot",value:function(t){return{ngModule:e,providers:[Oe,{provide:"pendoConfig",useValue:t}]}}}]),e}()).\u0275mod=j.Nb({type:pR}),pR.\u0275inj=j.Mb({factory:function(e){return new(e||pR)},imports:[[]]}),pR),hR=((lR=function e(){y(this,e)}).\u0275mod=j.Nb({type:lR}),lR.\u0275inj=j.Mb({factory:function(e){return new(e||lR)},imports:[[we.c,L.c.forFeature([TI])]]}),lR);immer.enableAllPlugins(),immer.enableES5();var fR,bR,mR=[{provide:Q.a,useClass:tR,multi:!0},{provide:te.h,useClass:oR},{provide:we.a,useValue:"./"},{provide:we.h,useClass:we.e}],vR=[{provide:Q.a,useClass:tR,multi:!0},{provide:te.h,useClass:oR}],yR=((bR=function e(){y(this,e)}).\u0275mod=j.Nb({type:bR,bootstrap:[Tf]}),bR.\u0275inj=j.Mb({factory:function(e){return new(e||bR)},providers:!0===T.offline?mR:vR,imports:[[L.c.forRoot(),rR,Qe.forRoot(),ne.d.forRoot(T.googleAnalyticsId),gR.forRoot({enabled:!0,pendoId:T.pendoId,whitelist:c({},P.Viewer,T.deploy===I.Production?["48Ab","3FZO","3FN2","3Hb8","3FQJ","3FQU","38fD","3wgE","3gLk","3vSx","3XdS","3SOp","3Um8","3hOe","3QWH","4C1Q","3WvE","3epq","3Dyq","3O47","3DJ4","3fKF","3gLf","3PVx","3caY","3cTn","3tVK","3Yau","3QSx","3ZY5","3Z6w","3IF5","3fKs","45y8","3fLN","3QpZ","3J6C","3adO","3Z6v","3hjc","3a50","4EBE","44FH","3WlU","3atu","4E2N","4Bma","43bE","3xxi","3CT7","4D5X","3UVi","3T7X","3QT8","3NG8","3gyj","3UWt","3UWc"]:["production/maleAdult/coronavirus_protein_structure","production/maleAdult/eyeAnatomyTour","production/maleAdult/acute_lymphoblastic_leukemia","production/maleAdult/abdominal_aortic_aneurysm"]),idPrefixes:(fR={},c(fR,I.Local,"local-"),c(fR,I.QA,"qa-"),c(fR,I.Staging,"staging-"),c(fR,I.Production,""),fR)}),dR,U.a,D.b,Q.c,kL,oD,vL,CL,wL,aR,KA,eR,iR,nR,hR,w_,bT]]}),bR);T.production&&Object(j.V)(),U.d().bootstrapModule(yR).catch((function(e){return console.error(e)}))},qpAl:function(e,t){!function(t){var n="Modernizr"in t,i=t.Modernizr;!function(e,t,n,i){function o(e,t){return typeof e===t}function r(e,t){return!!~(""+e).indexOf(t)}function a(){return"function"!=typeof n.createElement?n.createElement(arguments[0]):y?n.createElementNS.call(n,"http://www.w3.org/2000/svg",arguments[0]):n.createElement.apply(n,arguments)}function s(e,t,i,o){var r,s,c,l,p="modernizr",u=a("div"),d=function(){var e=n.body;return e||((e=a(y?"svg":"body")).fake=!0),e}();if(parseInt(i,10))for(;i--;)(c=a("div")).id=o?o[i]:p+(i+1),u.appendChild(c);return(r=a("style")).type="text/css",r.id="s"+p,(d.fake?d:u).appendChild(r),d.appendChild(u),r.styleSheet?r.styleSheet.cssText=e:r.appendChild(n.createTextNode(e)),u.id=p,d.fake&&(d.style.background="",d.style.overflow="hidden",l=v.style.overflow,v.style.overflow="hidden",v.appendChild(d)),s=t(u,e),d.fake&&d.parentNode?(d.parentNode.removeChild(d),v.style.overflow=l):u.parentNode.removeChild(u),!!s}function c(e){return e.replace(/([A-Z])/g,(function(e,t){return"-"+t.toLowerCase()})).replace(/^ms-/,"-ms-")}function l(e,n){var o=e.length;if("CSS"in t&&"supports"in t.CSS){for(;o--;)if(t.CSS.supports(c(e[o]),n))return!0;return!1}if("CSSSupportsRule"in t){for(var r=[];o--;)r.push("("+c(e[o])+":"+n+")");return s("@supports ("+(r=r.join(" or "))+") { #modernizr { position: absolute; } }",(function(e){return"absolute"===function(e,n,i){var o;if("getComputedStyle"in t){o=getComputedStyle.call(t,e,null);var r=t.console;null!==o?o=o.getPropertyValue(i):r&&r[r.error?"error":"log"].call(r,"getComputedStyle returning null, its possible modernizr test results are inaccurate")}else o=e.currentStyle&&e.currentStyle[i];return o}(e,0,"position")}))}return i}function p(e){return e.replace(/([a-z])-([a-z])/g,(function(e,t,n){return t+n.toUpperCase()})).replace(/^-/,"")}function u(e,t,n,s){function c(){d&&(delete k.style,delete k.modElem)}if(s=!o(s,"undefined")&&s,!o(n,"undefined")){var u=l(e,n);if(!o(u,"undefined"))return u}for(var d,g,h,f,b,m=["modernizr","tspan","samp"];!k.style&&m.length;)d=!0,k.modElem=a(m.shift()),k.style=k.modElem.style;for(h=e.length,g=0;g<h;g++)if(b=k.style[f=e[g]],r(f,"-")&&(f=p(f)),k.style[f]!==i){if(s||o(n,"undefined"))return c(),"pfx"!==t||f;try{k.style[f]=n}catch(e){}if(k.style[f]!==b)return c(),"pfx"!==t||f}return c(),!1}function d(e,t){return function(){return e.apply(t,arguments)}}function g(e,t,n,i,r){var a=e.charAt(0).toUpperCase()+e.slice(1),s=(e+" "+O.join(a+" ")+a).split(" ");return o(t,"string")||o(t,"undefined")?u(s,t,i,r):function(e,t,n){var i;for(var r in e)if(e[r]in t)return!1===n?e[r]:o(i=t[e[r]],"function")?d(i,n||t):i;return!1}(s=(e+" "+C.join(a+" ")+a).split(" "),t,n)}var h=[],f={_version:"3.11.8",_config:{classPrefix:"",enableClasses:!0,enableJSClass:!0,usePrefixes:!0},_q:[],on:function(e,t){var n=this;setTimeout((function(){t(n[e])}),0)},addTest:function(e,t,n){h.push({name:e,fn:t,options:n})},addAsyncTest:function(e){h.push({name:null,fn:e})}},b=function(){};b.prototype=f,b=new b;var m=[],v=n.documentElement,y="svg"===v.nodeName.toLowerCase(),x="Moz O ms Webkit",O=f._config.usePrefixes?x.split(" "):[];f._cssomPrefixes=O;var w={elem:a("modernizr")};b._q.push((function(){delete w.elem}));var k={style:w.elem.style};b._q.unshift((function(){delete k.style}));var C=f._config.usePrefixes?x.toLowerCase().split(" "):[];f._domPrefixes=C,f.testAllProps=g;var S=function(e){var n,o=prefixes.length,r=t.CSSRule;if(void 0===r)return i;if(!e)return!1;if((n=(e=e.replace(/^@/,"")).replace(/-/g,"_").toUpperCase()+"_RULE")in r)return"@"+e;for(var a=0;a<o;a++){var s=prefixes[a];if(s.toUpperCase()+"_"+n in r)return"@-"+s.toLowerCase()+"-"+e}return!1};f.atRule=S;var _=f.prefixed=function(e,t,n){return 0===e.indexOf("@")?S(e):(-1!==e.indexOf("-")&&(e=p(e)),t?g(e,t,n):g(e,"pfx"))};b.addTest("fullscreen",!(!_("exitFullscreen",n,!1)&&!_("cancelFullScreen",n,!1))),function(){var e,t,n,i,r,a;for(var s in h)if(h.hasOwnProperty(s)){if(e=[],(t=h[s]).name&&(e.push(t.name.toLowerCase()),t.options&&t.options.aliases&&t.options.aliases.length))for(n=0;n<t.options.aliases.length;n++)e.push(t.options.aliases[n].toLowerCase());for(i=o(t.fn,"function")?t.fn():t.fn,r=0;r<e.length;r++)1===(a=e[r].split(".")).length?b[a[0]]=i:(b[a[0]]&&(!b[a[0]]||b[a[0]]instanceof Boolean)||(b[a[0]]=new Boolean(b[a[0]])),b[a[0]][a[1]]=i),m.push((i?"":"no-")+a.join("-"))}}(),function(e){var t=v.className,n=b._config.classPrefix||"";if(y&&(t=t.baseVal),b._config.enableJSClass){var i=new RegExp("(^|\\s)"+n+"no-js(\\s|$)");t=t.replace(i,"$1"+n+"js$2")}b._config.enableClasses&&(e.length>0&&(t+=" "+n+e.join(" "+n)),y?v.className.baseVal=t:v.className=t)}(m),delete f.addTest,delete f.addAsyncTest;for(var j=0;j<b._q.length;j++)b._q[j]();e.Modernizr=b}(t,t,document),e.exports=t.Modernizr,n?t.Modernizr=i:delete t.Modernizr}(window)},zn8P:function(e,t){function n(e){return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}))}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id="zn8P"}},[[0,0,5]]])}();