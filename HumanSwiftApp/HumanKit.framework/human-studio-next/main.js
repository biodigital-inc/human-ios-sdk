(self.webpackChunkhuman_studio_next=self.webpackChunkhuman_studio_next||[]).push([[792],{62497:(ge,F,n)=>{"use strict";n.d(F,{N:()=>C});var t=n(46842),e=n(65763),r=n(60177),o=n(54438);let C=(()=>{var E;class y{}return(E=y).\u0275fac=function(_){return new(_||E)},E.\u0275mod=o.$C({type:E}),E.\u0275inj=o.G2t({imports:[e.rK.forFeature([t.U]),r.MD]}),y})()},46842:(ge,F,n)=>{"use strict";n.d(F,{U:()=>y});var r,t=n(65763),e=n(54438),o=function(d,_,v,b){var g,P=arguments.length,s=P<3?_:null===b?b=Object.getOwnPropertyDescriptor(_,v):b;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(d,_,v,b);else for(var u=d.length-1;u>=0;u--)(g=d[u])&&(s=(P<3?g(s):P>3?g(_,v,s):g(_,v))||s);return P>3&&s&&Object.defineProperty(_,v,s),s},C=function(d,_){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(d,_)};const E={prefersReducedMotion:window.matchMedia("(prefers-reduced-motion: reduce)").matches};let y=((r=class{static getPrefersReducedMotion(_){return _.prefersReducedMotion}}).\u0275fac=function(_){return new(_||r)},r.\u0275prov=e.jDH({token:r,factory:r.\u0275fac}),r);o([(0,t.MD)(),C("design:type",Function),C("design:paramtypes",[Object]),C("design:returntype",void 0)],y,"getPrefersReducedMotion",null),y=o([(0,t.Uw)({name:"accessibility",defaults:E})],y)},15828:(ge,F,n)=>{"use strict";n.d(F,{j:()=>t});var t=function(e){return e.PersonalUse="Personal Use",e.Education="Education",e.Business="Business",e}(t||{})},27153:(ge,F,n)=>{"use strict";n.d(F,{E:()=>_,Iw:()=>P,NP:()=>s,RP:()=>v,YO:()=>y,dx:()=>d,eu:()=>b,fQ:()=>C,mY:()=>E,n3:()=>o});var t=n(71217),e=n(30234);const r="https://support.biodigital.com/hc/en-us",o={[e.a.WoltersKluwer]:"Wolters Kluwer",[e.a.Zspace]:"zSpace"},C={[e.a.WoltersKluwer]:"https://tools.ovid.com/support/index_inner.html",[e.a.Zspace]:"https://support.zspace.com/s/contactsupport"},E={[e.a.WoltersKluwer]:"HLRP-AcademicOperations@wolterskluwer.com"};function y(u){return r}function d(u){return!0===u?.premium_account_valid||"group"===u?.premium_account_type}function _(u){return!u?.organizations[0]?.external_account?.is_external_account&&d(u)}function v(u){const h=u?.organizations[0]?.external_account?.external_account_provider;return C[h]}function b(u){return`/login?${g(u)}`}function P(u){return`/login/create?${g(u)}`}function s(u,h="",S=""){return`mailto:${u}?subject=${encodeURIComponent(h)}&body=${encodeURIComponent(S)}`}function g(u){const h=new URLSearchParams;if(u?.type===t.P.Organization){const f=u.data,m=f?.session_source,i=f?.session_source_id;"ovid_osptok"===m&&h.append("osptok",i)}return h}},41981:(ge,F,n)=>{"use strict";n.d(F,{U:()=>t});var t=function(e){return e.InvalidUAID="analytic id does not exist",e.InvalidDeveloperId="Client id invalid",e.InvalidProductKey="app product key",e.MissingUAID="analytic id missing",e.WebOnlyAPI="Api key only compatible with Web Widget",e.AndroidOnlyAPI="Api key only compatible with Mobile Widget SDK for Android",e.IOSOnlyAPI="Api key only compatible with Mobile Widget SDK for iOS",e.MixedAPIKeys="Use of both an app product key and an app api key not allowed",e.ProductKeyNotRegistered='App product key "xxx" has not been registered or is incorrect.  Ensure it has been registered by the system admin',e.ProductKeyInvalidAppBundleID='The app product key "xxx" has not been authorized to be used for app bundle id "yyy".  Confirm the correct values are being used from the system admin',e.ProductKeyBundleIDWhitelist='Use of app product key "xxx" requires the affiliated app bundle id (app_domain) to be white-listed.  Ensure the system admin has white-listed "yyy"',e.ImproperProductKeyUsage='Improper use of app product key "xxx" detected. Contact the system admin if issue continues',e.InvalidPlatformSource="Invalid platform source",e.MissingSource="Missing source",e.MissingPlatform="Missing platform",e.MissingAppDomain="Missing app domain",e.APIKeyMissing="Api key missing",e.APIKeyInvalid="Api key invalid",e.DeveloperDeactivated="Developer account for api key is deactivated",e.BundleIDNotAllowed="App bundle id not allowed",e.BundleIDUnregistered="App bundle id unregistered",e}(t||{})},85446:(ge,F,n)=>{"use strict";n.d(F,{q:()=>d});var t=n(28407),e=n(71263),r=n(65763),o=n(16823),C=n(40215),E=n(54438),y=n(38645);let d=(()=>{var _;class v{constructor(P,s,g){this.router=P,this.authService=s,this.store=g}canActivate(P,s){var g=this;return(0,t.A)(function*(){return g.getIsLoggedIn().then(u=>!!u.signed_in||(g.redirectToLogin(s.url),!1))})()}getIsLoggedIn(){var P=this;return(0,t.A)(function*(){const s=P.store.selectSnapshot(o.k.getLoggedInState);return s?.signed_in?s:(0,C._)(P.authService.isLoggedIn())})()}redirectToLogin(P){this.router.navigate(["/login"],{queryParams:{returnUrl:P}})}}return(_=v).\u0275fac=function(P){return new(P||_)(E.KVO(y.Ix),E.KVO(e.u),E.KVO(r.il))},_.\u0275prov=E.jDH({token:_,factory:_.\u0275fac,providedIn:"root"}),v})()},71263:(ge,F,n)=>{"use strict";n.d(F,{u:()=>O});var t=n(21626),e=n(36110),r=n(11756),o=n(28577),C=n(15877),E=n(37780),y=n(40470);class d{static fromJSON(k){const q=new d;return q.isUser=k.is_user,q.email=k.user_email,q.firstName=k.user_first_name,q.lastName=k.user_last_name,q.name=`${k.user_first_name} ${k.user_last_name}`,q.isDeveloper=k.user_is_developer,q.isDeveloperActive=k.user_is_developer_active,q.isDeveloperVerified=k.user_is_developer_verified,q.isThirdParty=k.user_is_third_party,q.thirdPartyProvider=k.user_third_party_provider,q.isTeamMember=k.user_is_team_member,q}}class _{static fromJSON(k){const q=new _;return q.google=k.google_api_key,q}}var v=n(24684),b=n(99972),P=n(68845),s=n(29242),g=function(L){return L.Zendesk="zendesk",L}(g||{}),u=n(91939),h=n(49204),S=n(56081);class f{}class m{}var i=n(15318),c=n(11129),a=n(5690),l=n(29302),p=n(54438);const A=["harvard.edu","liberty.edu"];let O=(()=>{var L;class k{constructor(B,j,V,M,N){this.http=B,this.reCaptchaV3Service=j,this.userMessageService=V,this.productService=M,this.RECAPTCHA_V3_SITE_KEY=N}loginWithBiodigital(B){return this.http.post("/ws/user/sign/in",P.z.toJSON(B),{headers:this.productService.productHeader})}loginWithGoogle(B){return this.http.post("/ws/user/sign/in/google",b.o.toJSON(B),{headers:this.productService.productHeader})}loginWithGroup(B){return this.http.post("/ws/organization/sign/in",l.G.toJSON(B),{headers:this.productService.productHeader})}logout(){return google.accounts.id.disableAutoSelect(),this.http.get("/ws/user/sign/out")}logoutGroup(){return google.accounts.id.disableAutoSelect(),this.http.get("/ws/organization/sign/out",{params:{version:1,app_producttype:this.productService.productType,app_productkey:this.productService.productKey}})}checkProfile(B){return this.http.post("/ws/user/profile/check",{version:5,email:B,app_producttype:this.productService.productType,app_productkey:this.productService.productKey},{headers:this.productService.productHeader}).pipe((0,e.T)(N=>d.fromJSON(N)))}getUserProfile(B){return this.http.get("/ws/user/profile",{params:{version:2,subscription_hard_check:B?1:0}}).pipe((0,e.T)(M=>{const N=(0,y.bj)(E.s,M);return N.organizations.forEach(W=>{const $=(0,h.get)(W,"user_role",S.br);W.user_role=(0,S.t9)($)}),N}))}getUserRoles(){return this.http.get("/ws/organization/user/roles").pipe((0,e.T)(B=>B.user_roles.map(j=>{const V=(0,y.bj)(u.V,j);return(0,S.t9)(V)})))}getGroupUserProfile(){return this.http.get("/ws/organization/profile",{params:{version:1,app_producttype:this.productService.productType,app_productkey:this.productService.productKey}})}updaterUserProfile(B){return this.http.post("/ws/user/profile?version=2",B)}deleteUserProfile(){return this.http.post("/ws/user/profile/delete",{}).pipe((0,e.T)(B=>B.deleted_user_email))}getEnvironmentSettings(){return this.http.get("/ws/environment/settings?version=2").pipe((0,e.T)(B=>_.fromJSON(B)))}getUserApps(){return this.http.get("/ws/developer/apps/profile").pipe((0,e.T)(B=>B&&B.apps?JSON.parse(B.apps):[]))}getGroupConfigFromRoute(B){const V=B.queryParams.code||"",M=B.queryParams.group_invite||"",N=B.queryParams.osptok||"";return{group:B.queryParams.group||"",groupCode:V,groupCodeMode:V?1:0,groupInviteMode:M?1:0,groupInviteKey:M,groupOvidMode:N?1:0,groupOvidOsptok:N}}getPlatformConfigFromRoute(B){const{zendesk_signin:j,return_to:V,brand_id:M,locale_id:N,timestamp:W}=B.queryParams;if("1"===j)return{platform:g.Zendesk,returnTo:V,brandId:M,localeId:N,timestamp:W}}isLoggedIn(){return this.http.get("/ws/product/account/is/signed-in",{params:{version:1,app_producttype:this.productService.productType,app_productkey:this.productService.productKey}})}getProfileRestrictions(B){let j=!1,V=!1,M="";return B.organizations.forEach(N=>{j||V||(M=N.name,j=N.user_is_subscribed&&N.email_domain_restriction&&!N.user_has_email_domain_access,V=N.user_is_subscribed&&N.ip_address_restriction&&!N.user_has_domain_access)}),{organizationName:M,email:j,ip:V}}resetPassword(B){return this.http.post("/ws/user/password/forgot",{email:B})}deactivateFacebook(B){return this.http.post("/ws/user/sign/in/facebook/deactivate",B)}updatePassword(B,j,V){return this.http.post("/ws/user/password/change",{current_password:B,new_password:j,confirm_new_password:V})}signUp(B){return this.http.post("/ws/user/sign/up",v.g.toJSON(B),{headers:this.productService.productHeader})}verifyToken(B,j){return this.http.post("/ws/recaptcha/siteverify",{recaptcha_reponse_token:B,recaptcha_version:j})}verifyReCaptcha(B,j){return j&&grecaptcha.reset(this.RECAPTCHA_V3_SITE_KEY),this.reCaptchaV3Service.execute(B).pipe((0,r.Z)(V=>this.verifyToken(V,"v3")),(0,e.T)(V=>({isHuman:V.action===B&&V.score>.2,verification:V})))}isReCaptchaWhiteListed(B){return A.some(j=>new RegExp(`${j}$`,"i").test(B))}verifyIsHuman(B,j,V=!1){return this.isReCaptchaWhiteListed(j)?(0,C.of)({isHuman:!0}):this.verifyReCaptcha(B,V)}isValidGoogleDomain(){return new Set(["human-qa.biodigital.com","human-staging.biodigital.com","human.biodigital.com","loft.biodigital.com","loft-qa.biodigital.com","qa.biodigital.com","localhost:4200","localhost:4201"]).has(window.location.host)}requestVerificationCode(B){const j={...B,version:4,app_producttype:this.productService.productType,app_productkey:this.productService.productKey};return this.http.post("/ws/user/verification/request",j).pipe((0,e.T)(V=>(0,y.bj)(f,V)))}verifyProfile(B){const j={...B,version:4,app_producttype:this.productService.productType,app_productkey:this.productService.productKey};return this.http.post("/ws/user/verification/confirm",j).pipe((0,e.T)(V=>(0,y.bj)(m,V)))}checkProfileIncomplete(){return this.userMessageService.getUserMessage(c.s$.CompleteProfileAlert,"v2",!1).pipe((0,o.W)(()=>(0,C.of)({messageType:c.s$.CompleteProfileAlert,messageData:{},showUserAlert:!1})))}getUserNotices(){const j=new t.Nl({fromObject:{version:1,app_productkey:this.productService.productKey,app_producttype:this.productService.productType}});return this.http.get("ws/user/notices",{params:j})}markUserNoticeAsSeen(B){return this.http.post("ws/user/notices/seen",{version:1,app_productkey:this.productService.productKey,app_producttype:this.productService.productType,notice_id:B})}}return(L=k).\u0275fac=function(B){return new(B||L)(p.KVO(t.Qq),p.KVO(s.ob),p.KVO(i.K),p.KVO(a.b),p.KVO(s.gq))},L.\u0275prov=p.jDH({token:L,factory:L.\u0275fac,providedIn:"root"}),k})()},74707:(ge,F,n)=>{"use strict";n.d(F,{V:()=>C,k:()=>E});var t=n(54438),e=n(60177),r=n(24418),o=n(29242);const C=new t.nKC("");let E=(()=>{var y;class d{}return(y=d).\u0275fac=function(v){return new(v||y)},y.\u0275mod=t.$C({type:y}),y.\u0275inj=t.G2t({providers:[{provide:o.gq,useValue:r.c.recaptchaV3Key},{provide:C,useValue:r.c.recaptchaV2Key}],imports:[e.MD,o.tA,o.cm]}),d})()},63308:(ge,F,n)=>{"use strict";n.d(F,{j:()=>r,q:()=>o});var t=n(49204);function r(E,y=!1){return(y?C(E):E).reduce((_,v)=>({..._,...v}),{})}function o(E,y=!1){const d=Object.entries(E).map(([_,v])=>({[_]:v}));return y?C(d):d}function C(E){return E.filter(y=>Object.values(y).some(d=>!(0,t.isNil)(d.value)&&""!==d.value))}},27182:(ge,F,n)=>{"use strict";n.d(F,{I:()=>t});var t=function(e){return e.Free="free",e.Premium="premium",e.Team="team",e}(t||{})},68845:(ge,F,n)=>{"use strict";n.d(F,{z:()=>e});var t=n(98125);class e extends t.Q{constructor(o,C,E){super(),this.email=o,this.password=C,this.rememberMe=E}static toJSON(o){return{id_token:o.token,version:o.version,app_producttype:o.app_producttype,app_productkey:o.app_productkey,group_invite_mode:o.groupInviteMode,group_invite_key:o.groupInviteKey,group_code_mode:o.groupCodeMode,group_code:o.groupCode,group_ovid_mode:o.groupOvidMode,group_ovid_osptok:o.groupOvidOsptok,email:o.email,password:o.password,email_remember_me:o.rememberMe,platform:o.platform,return_to:o.returnTo,brand_id:o.brandId,locale_id:o.localeId,timestamp:o.timestamp,site_verify_response:o.site_verify_response}}}},99972:(ge,F,n)=>{"use strict";n.d(F,{o:()=>e});var t=n(98125);class e extends t.Q{constructor(o){super(),this.token=o}static toJSON(o){return{id_token:o.token,version:o.version,app_producttype:o.app_producttype,app_productkey:o.app_productkey,group_invite_mode:o.groupInviteMode,group_invite_key:o.groupInviteKey,group_code_mode:o.groupCodeMode,group_code:o.groupCode,group_ovid_mode:o.groupOvidMode,group_ovid_osptok:o.groupOvidOsptok,platform:o.platform,return_to:o.returnTo,brand_id:o.brandId,locale_id:o.localeId,timestamp:o.timestamp,site_verify_response:o.site_verify_response}}}},29302:(ge,F,n)=>{"use strict";n.d(F,{G:()=>C});var t=n(98125),e=n(24418),r=n(12215),o=n(27180);class C extends t.Q{constructor(y,d,_,v){super(),this.app_producttype=y,this.app_productkey=d,this.groupOvidMode=_,this.groupOvidOsptok=v}static toJSON(y){return{version:y.version,app_producttype:y.app_producttype,app_productkey:y.app_productkey,group_ovid_mode:y.groupOvidMode,group_ovid_osptok:y.groupOvidOsptok,ignore_ovid_exp:e.c.application===o.c.Studio&&e.c.deploy!==r.Z.Production&&!1===e.c.native?1:0}}}},98125:(ge,F,n)=>{"use strict";n.d(F,{Q:()=>t});class t{constructor(){this.version=5,this.groupInviteMode=0,this.groupCodeMode=0}}},20342:(ge,F,n)=>{"use strict";n.d(F,{O:()=>o,g:()=>C});const r=`https://www.biodigital.com?utm_source=${n(24418).c.native?"human_mobile":"human_web"}&utm_medium=PLG&utm_campaign=poweredby&ref=poweredby`,o={default:"./assets/images/powered-by-biodigital-color.svg",human_app:{default:{logo_url:"./assets/images/powered-by-biodigital-color.svg",logo_linkout_url:r}},viewer:{viewer_logo_setting:null,full_dark:{logo_url:"./assets/images/powered-by-biodigital-color.svg",logo_linkout_url:r},full_light:{logo_url:"./assets/images/powered-by-biodigital-white.svg",logo_linkout_url:r},square_dark:{logo_url:"./assets/images/logo-color.svg",logo_linkout_url:r},square_light:{logo_url:"./assets/images/logo-white.svg",logo_linkout_url:r}}};function C(E,y,d){const{full_dark:_,full_light:v,square_dark:b,square_light:P}=E.viewer;switch(y){case"full":return"color"===d?_:v;case"small":return"color"===d?b:P}}},7213:(ge,F,n)=>{"use strict";n.d(F,{c8:()=>A,E2:()=>O,D1:()=>L,Dy:()=>u,XP:()=>c,M8:()=>P,Ie:()=>p,dE:()=>v,OS:()=>d,Dx:()=>k,WV:()=>g,yq:()=>a,KZ:()=>l,$Z:()=>b,Lo:()=>j,h_:()=>V,_m:()=>y,dl:()=>_,Cy:()=>q});var t=n(49204),e=n(17766),r=n(70737),o=n(24418),C=function(M){return M.User="user",M.Group="group",M}(C||{}),E=n(52394);function y(M,N){return(0,t.get)(M,"permissions",[]).includes(N)}function d(M){return y(M,r.y.EditBookmarks)&&!o.c.native}function _(M){return!1!==M?.human_studio_access}function v(M,N){const W=y(M,r.y.EditBookmarks);return!!W&&(N.type===e.c.Module?W:!(!0!==N.is_owner)||!!B(N)&&h(M,N))}function b(){return!0}function P(M,N){return!0===N.is_owner}function g(M,N){return!!y(M,r.y.EditBookmarks)&&(!(!0!==N.is_owner&&!q(N))||!!B(N)&&h(M,N))}function u(M,N){return!!N&&y(M,r.y.BulkManageTeamBookmarks)}function h(M,N){if(y(M,r.y.EditAllTeamBookmarks))return!0;const $=y(M,r.y.EditTeamBookmarks),ne=B(N)&&N.group_access[0].member_edit;return $&&ne}function f(M){return B(M)&&!0===M.group_access[0].visible}function m(M){return B(M)&&!0===M.group_access[0].member_edit}function i(M){return!(0,t.isNil)(M.module_accessor_level)}function c(M,N,W,$){return!(!W||!$)&&y(M,r.y.CopyUrl)}function a(M){return y(M,r.y.PublishBookmarks)}function l(M,N,W,$){return!!(N&&W&&a(M))&&!0===$?.human_2dimage_access}function p(M,N){const W=!0===N.is_owner,$=y(M,r.y.DuplicateTeamBookmarks);return!(!W&&!$)}function A(M,N){return!i(N)}function O(M,N){return!(!M||N)}function L(M,N,W){return W&&M.every($=>P(0,$))}function k(M,N){return!!N&&y(M,r.y.ExportCSV)}function q(M){return M.type==e.c.Module&&M.module_accessor_level===C.Group}function B(M){return Array.isArray(M.group_access)&&M.group_access.length>0}function j(M,N,W=!0){return M.filter($=>{const ne=!0===$.is_owner,Q=f($),le=m($),pe=i($),ie=be=>{switch(be){case E.c.Private:return ne;case E.c.TeamEdit:return Q&&le;case E.c.TeamView:return Q&&!le||pe;default:return!1}};return W?N.every(ie):N.some(ie)})}function V(M){const N=new Set;return M.forEach(W=>{const $=!0===W.is_owner,ne=f(W),Q=m(W),le=i(W);$?N.add(E.c.Private):ne&&Q?N.add(E.c.TeamEdit):(ne&&!Q||le)&&N.add(E.c.TeamView)}),Array.from(N)}},56081:(ge,F,n)=>{"use strict";n.d(F,{Oj:()=>v,Ub:()=>u,Zv:()=>d,br:()=>_,t9:()=>g});var t=n(49204),r=n(70737),o=n(87732);const C=[r.y.ViewBookmarks,r.y.CopyUrl,r.y.SavePrivateBookmarks,r.y.ExportCSV],E=[...C,r.y.ViewUsers,r.y.InviteUsers,r.y.PublishBookmarks,r.y.EditBookmarks,r.y.EditTeamBookmarks,r.y.RemoveTeamBookmarks,r.y.AddTeamBookmarks,r.y.DuplicateTeamBookmarks,r.y.BulkManageTeamBookmarks],y=[...E,r.y.EditTeamAccount,r.y.EditAllTeamBookmarks,r.y.CreateCollection,r.y.TransferContent,r.y.RemoveUser,r.y.AssignRole,r.y.ManageJoinRequests],d=[o.x.Viewer,o.x.Creator,o.x.Admin],_={role_id:void 0,role_name:o.x.Creator,role_display_name:"",role_description:"",permissions:[...E]},v={permissions:[r.y.ViewBookmarks,r.y.SavePrivateBookmarks,r.y.PublishBookmarks,r.y.EditBookmarks]},b={[o.x.Viewer]:C,[o.x.Creator]:E,[o.x.Admin]:y},P={[o.x.Viewer]:"Can view team content and edit personal content",[o.x.Creator]:"Can edit and view team content",[o.x.Admin]:"Can manage team settings and edit all content"};function s(h){return b[h]||[]}function g(h){const S=h?.role_name??_.role_name,f=h?.role_description??P[S],m=h?.permissions;return{...h,role_description:f,permissions:(0,t.isNil)(m)?s(S):m}}function u(h,S){return d.indexOf(h)-d.indexOf(S)}},70737:(ge,F,n)=>{"use strict";n.d(F,{y:()=>t});var t=function(e){return e.AssignRole="assignRole",e.RemoveUser="removeUser",e.TransferContent="transferContent",e.CreateCollection="createCollection",e.DeleteCollection="deleteCollection",e.EditTeamAccount="editTeamAccount",e.EditTeamBookmarks="editTeamBookmarks",e.EditAllTeamBookmarks="editAllTeamBookmarks",e.AddTeamBookmarks="addTeamBookmarks",e.RemoveTeamBookmarks="removeTeamBookmarks",e.EditBookmarks="editBookmarks",e.PublishBookmarks="publishBookmarks",e.SavePrivateBookmarks="savePrivateBookmarks",e.CopyUrl="copyURL",e.ViewBookmarks="viewBookmarks",e.InviteUsers="inviteUsers",e.ViewUsers="viewUsers",e.ExportCSV="exportCSV",e.DuplicateTeamBookmarks="duplicateTeamBookmarks",e.BulkManageTeamBookmarks="bulkManageTeamBookmarks",e.ManageJoinRequests="manageJoinRequests",e}(t||{})},87732:(ge,F,n)=>{"use strict";n.d(F,{x:()=>t});var t=function(e){return e.Admin="admin",e.Creator="creator",e.Viewer="viewer",e}(t||{})},71217:(ge,F,n)=>{"use strict";n.d(F,{P:()=>t});var t=function(e){return e.User="user",e.Organization="organization",e}(t||{})},51036:(ge,F,n)=>{"use strict";function e(o,C){return{type:o,data:C}}function r(o){return"id"in o&&"email"in o}n.d(F,{Q:()=>r,v:()=>e}),n(71217)},24684:(ge,F,n)=>{"use strict";n.d(F,{g:()=>e});var t=n(98125);class e extends t.Q{static toJSON(o){return{version:o.version,app_producttype:o.app_producttype,app_productkey:o.app_productkey,email:o.email,password:o.password,first_name:o.firstName,last_name:o.lastName,group_invite_mode:o.groupInviteMode,group_invite_key:o.groupInviteKey,group_code_mode:o.groupCodeMode,group_code:o.groupCode,group_ovid_mode:o.groupOvidMode,group_ovid_osptok:o.groupOvidOsptok,platform:o.platform,return_to:o.returnTo,brand_id:o.brandId,locale_id:o.localeId,timestamp:o.timestamp,site_verify_response:o.site_verify_response}}}},52762:(ge,F,n)=>{"use strict";n.d(F,{MM:()=>e});var e=function(o){return o.Web="web",o.Mobile="mobilesdk",o}(e||{})},11129:(ge,F,n)=>{"use strict";n.d(F,{KH:()=>t,s$:()=>e});class t{}var e=function(o){return o.DomainAlert="join_group_through_domain_alert",o.WelcomeTour="welcome_tour_alert",o.CompleteProfileAlert="complete_profile_alert",o}(e||{})},37780:(ge,F,n)=>{"use strict";n.d(F,{W:()=>E,s:()=>C});var t=n(16938),e=n(15040);class C{}function E(y){return y.email.endsWith("@biodigital.com")}!function(y,d,_,v){var s,b=arguments.length,P=b<3?d:null===v?v=Object.getOwnPropertyDescriptor(d,_):v;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)P=Reflect.decorate(y,d,_,v);else for(var g=y.length-1;g>=0;g--)(s=y[g])&&(P=(b<3?s(P):b>3?s(d,_,P):s(d,_))||P);b>3&&P&&Object.defineProperty(d,_,P)}([(0,t.Z)(()=>e.n),function(y,d){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata("design:type",Array)}()],C.prototype,"organizations",void 0)},91939:(ge,F,n)=>{"use strict";n.d(F,{V:()=>t});class t{}},50262:(ge,F,n)=>{"use strict";n.d(F,{s:()=>t});class t extends Error{constructor(){super("reCAPTCHA error. Please complete the form to continue.")}}},38165:(ge,F,n)=>{"use strict";n.d(F,{$_:()=>rt,A$:()=>Z,CU:()=>Fe,Cx:()=>m,Cy:()=>l,Dv:()=>f,EX:()=>ke,Fm:()=>ne,Fw:()=>dt,Gu:()=>o,HP:()=>D,Hx:()=>te,JY:()=>Q,Kg:()=>A,Ko:()=>S,Mg:()=>me,Ml:()=>We,NH:()=>se,OF:()=>ye,P:()=>oe,Qb:()=>t,R$:()=>Ae,RE:()=>ie,RL:()=>e,RO:()=>W,RR:()=>Se,RW:()=>et,Sw:()=>c,T9:()=>ot,W3:()=>X,XH:()=>re,XZ:()=>ze,Xb:()=>N,YP:()=>j,YY:()=>M,ZD:()=>O,Zc:()=>_,_E:()=>U,_L:()=>H,_h:()=>L,aD:()=>T,b9:()=>b,bY:()=>Ee,bl:()=>v,cO:()=>g,cZ:()=>B,ct:()=>$,e0:()=>Ye,ec:()=>Je,eu:()=>y,fQ:()=>s,h5:()=>Xe,h8:()=>p,hg:()=>K,hs:()=>a,hz:()=>d,i1:()=>r,iM:()=>Ze,ij:()=>C,j3:()=>de,je:()=>u,kK:()=>xe,kP:()=>be,kb:()=>P,lC:()=>w,mK:()=>R,nb:()=>q,o5:()=>ae,o7:()=>le,r:()=>z,rH:()=>Ge,rK:()=>E,ru:()=>Y,sG:()=>k,sz:()=>Ue,tM:()=>Le,tk:()=>i,uG:()=>ct,uj:()=>je,vL:()=>Ce,vY:()=>V,wj:()=>Re,xG:()=>h,yO:()=>ce,z3:()=>pe,zc:()=>J});let t=(()=>{class _e{constructor(){}}return _e.type="[Auth] Is Logged In",_e})(),e=(()=>{class _e{constructor(Oe){this.sessionType=Oe}}return _e.type="[Auth] Is Logged In Success",_e})(),r=(()=>{class _e{constructor(Oe){this.sessionType=Oe}}return _e.type="[Auth] Is Logged In Failure",_e})(),o=(()=>{class _e{constructor(Oe,tt){this.login=Oe,this.verification=tt}}return _e.type="[Auth] Login With Biodigital",_e})(),C=(()=>{class _e{constructor(){}}return _e.type="[Auth] Initialize Google Auth",_e})(),E=(()=>{class _e{constructor(Oe){this.credential=Oe}}return _e.type="[Auth] Authenticate With Google",_e})(),y=(()=>{class _e{constructor(){}}return _e.type="[Auth] Prompt With Google",_e})(),d=(()=>{class _e{constructor(Oe){this.promptResult=Oe}}return _e.type="[Auth] Prompt With Google Success",_e})(),_=(()=>{class _e{constructor(Oe){this.login=Oe}}return _e.type="[Auth] Login With Google",_e})(),v=(()=>{class _e{constructor(Oe){this.login=Oe}}return _e.type="[Auth] Login With Group",_e})(),b=(()=>{class _e{constructor(Oe,tt){this.loginType=Oe,this.response=tt}}return _e.type="[Auth] Login Success",_e})(),P=(()=>{class _e{constructor(Oe,tt,gt){this.loginType=Oe,this.error=tt,this.login=gt}}return _e.type="[Auth] Login Failure",_e})(),s=(()=>{class _e{constructor(){}}return _e.type="[Auth] Logout",_e})(),g=(()=>{class _e{constructor(){}}return _e.type="[Auth] Logout Success",_e})(),u=(()=>{class _e{constructor(){}}return _e.type="[Auth] Logout Failure",_e})(),h=(()=>{class _e{constructor(){}}return _e.type="[Auth] Get Environment Settings",_e})(),S=(()=>{class _e{constructor(Oe){this.environmentSettings=Oe}}return _e.type="[Auth] Get Environment Settings Success",_e})(),f=(()=>{class _e{constructor(Oe){this.error=Oe}}return _e.type="[Auth] Get Environment Settings Failure",_e})(),m=(()=>{class _e{constructor(){}}return _e.type="[Auth] Get Group User Profile",_e})(),i=(()=>{class _e{constructor(Oe){this.groupUserProfile=Oe}}return _e.type="[Auth] Get Group User Profile Success",_e})(),c=(()=>{class _e{constructor(Oe){this.error=Oe}}return _e.type="[Auth] Get Group User Profile Failure",_e})(),a=(()=>{class _e{constructor(Oe=!1){this.hardCheck=Oe}}return _e.type="[Auth] Get User Profile",_e})(),l=(()=>{class _e{constructor(Oe){this.userProfile=Oe}}return _e.type="[Auth] Get User Profile Success",_e})(),p=(()=>{class _e{constructor(Oe){this.error=Oe}}return _e.type="[Auth] Get User Profile Failure",_e})(),A=(()=>{class _e{constructor(Oe){this.userProfile=Oe}}return _e.type="[Auth] Update User Profile",_e})(),O=(()=>{class _e{constructor(Oe){this.userProfile=Oe}}return _e.type="[Auth] Update User Profile Success",_e})(),L=(()=>{class _e{constructor(Oe){this.error=Oe}}return _e.type="[Auth] Update User Profile Failure",_e})(),k=(()=>{class _e{constructor(){}}return _e.type="[Auth] Delete User Profile",_e})(),q=(()=>{class _e{constructor(Oe){this.userEmail=Oe}}return _e.type="[Auth] Delete User Profile Success",_e})(),B=(()=>{class _e{constructor(Oe){this.error=Oe}}return _e.type="[Auth] Delete User Profile Failure",_e})(),j=(()=>{class _e{constructor(Oe){this.email=Oe}}return _e.type="[Auth] Check Profile",_e})(),V=(()=>{class _e{constructor(Oe){this.profile=Oe}}return _e.type="[Auth] Check Profile Success",_e})(),M=(()=>{class _e{constructor(Oe){this.error=Oe}}return _e.type="[Auth] Check Profile Failure",_e})(),N=(()=>{class _e{constructor(){}}return _e.type="[Auth] Get User Roles",_e})(),W=(()=>{class _e{constructor(Oe){this.email=Oe}}return _e.type="[Auth] Reset Password",_e})(),$=(()=>{class _e{constructor(Oe){this.email=Oe}}return _e.type="[Auth] Reset Password Success",_e})(),ne=(()=>{class _e{constructor(Oe){this.error=Oe}}return _e.type="[Auth] Reset Password Failure",_e})(),Q=(()=>{class _e{constructor(Oe){this.email=Oe}}return _e.type="[Auth] Transfer Facebook Account",_e})(),le=(()=>{class _e{constructor(Oe){this.email=Oe}}return _e.type="[Auth] Transfer Facebook Account Success",_e})(),pe=(()=>{class _e{constructor(Oe){this.error=Oe}}return _e.type="[Auth] Transfer Facebook Account Failure",_e})(),ie=(()=>{class _e{constructor(Oe,tt,gt){this.currentPassword=Oe,this.newPassword=tt,this.confirmNewPassword=gt}}return _e.type="[Auth] Update Password",_e})(),be=(()=>{class _e{constructor(){}}return _e.type="[Auth] Update Password Success",_e})(),de=(()=>{class _e{constructor(Oe){this.error=Oe}}return _e.type="[Auth] Update Password Failure",_e})(),w=(()=>{class _e{constructor(){}}return _e.type="[Auth] Check Session",_e})(),te=(()=>{class _e{constructor(Oe,tt){this.value=Oe,this.verification=tt}}return _e.type="[Auth] Sign Up",_e})(),R=(()=>{class _e{constructor(Oe){this.response=Oe}}return _e.type="[Auth] Sign Up Success",_e})(),D=(()=>{class _e{constructor(Oe){this.error=Oe}}return _e.type="[Auth] Sign Up Failure",_e})(),T=(()=>{class _e{constructor(Oe,tt){this.locale=Oe,this.reload=tt}}return _e.type="[Auth] Set User Locale",_e})(),re=(()=>{class _e{constructor(Oe){this.locale=Oe}}return _e.type="[Auth] Set User Locale Success",_e})(),K=(()=>{class _e{constructor(){}}return _e.type="[Auth] Check Locale",_e})(),ae=(()=>{class _e{constructor(){}}return _e.type="[Auth] Get User Apps",_e})(),ce=(()=>{class _e{constructor(Oe){this.apps=Oe}}return _e.type="[Auth] Set User Apps",_e})(),U=(()=>{class _e{constructor(){}}return _e.type="[Auth] Check Selected App",_e})(),Z=(()=>{class _e{constructor(Oe){this.appId=Oe}}return _e.type="[Auth] Set Selected User App",_e})(),z=(()=>{class _e{constructor(Oe){this.message=Oe}}return _e.type="[Auth] Send User Message",_e})(),H=(()=>{class _e{constructor(Oe){this.message=Oe}}return _e.type="[Auth] Send User Message Success",_e})(),J=(()=>{class _e{constructor(Oe){this.err=Oe}}return _e.type="[Auth] Send User Message Fail",_e})(),Y=(()=>{class _e{constructor(Oe,tt){this.type=Oe,this.mode=tt}}return _e.type="[Auth] Get User Message",_e})(),X=(()=>{class _e{constructor(Oe){this.message=Oe}}return _e.type="[Auth] Get User Message Success",_e})(),se=(()=>{class _e{constructor(Oe){this.type=Oe}}return _e.type="[Auth] Get User Message Fail",_e})(),oe=(()=>{class _e{constructor(Oe){this.messageSeenId=Oe}}return _e.type="[Auth] Set Message Viewed",_e})(),me=(()=>{class _e{constructor(){}}return _e.type="[Auth] Set Message Viewed Success",_e})(),Se=(()=>{class _e{constructor(){}}return _e.type="[Auth] Set Message Viewed Fail",_e})(),Ue=(()=>{class _e{constructor(Oe){this.error=Oe}}return _e.type="[Auth] Verify Fail",_e})(),je=(()=>{class _e{constructor(){}}return _e.type="[Auth] Reset",_e})(),Le=(()=>{class _e{constructor(){}}return _e.type="[Auth] Delete Stored Data",_e})(),Re=(()=>{class _e{constructor(Oe,tt){this.email=Oe,this.token=tt}}return _e.type="[Auth] Request Verification Code",_e})(),Ee=(()=>{class _e{constructor(Oe){this.response=Oe}}return _e.type="[Auth] Request Verification Code Success",_e})(),We=(()=>{class _e{constructor(Oe){this.error=Oe}}return _e.type="[Auth] Request Verification Code Fail",_e})(),ze=(()=>{class _e{constructor(Oe,tt,gt){this.email=Oe,this.token=tt,this.code=gt}}return _e.type="[Auth] Verify Profile",_e})(),Ze=(()=>{class _e{constructor(Oe){this.response=Oe}}return _e.type="[Auth] Verify Profile Success",_e})(),et=(()=>{class _e{constructor(Oe){this.error=Oe}}return _e.type="[Auth] Verify Profile Fail",_e})(),rt=(()=>{class _e{constructor(Oe,tt,gt){this.type=Oe,this.display=tt,this.data=gt}}return _e.type="[Auth] Notify User Restriction",_e})(),Ge=(()=>{class _e{constructor(Oe){this.displays=Oe}}return _e.type="[Auth] Clear User Restriction",_e})(),Ye=(()=>{class _e{constructor(Oe,tt){this.contentId=Oe,this.contentType=tt}}return _e.type="[Auth] Set Content Viewed",_e})(),Xe=(()=>{class _e{constructor(){}}return _e.type="[Auth] Set Content Viewed Success",_e})(),ye=(()=>{class _e{constructor(){}}return _e.type="[Auth] Check Content Viewed",_e})(),Ce=(()=>{class _e{constructor(Oe){this.contentViews=Oe}}return _e.type="[Auth] Check Content Viewed Success",_e})(),xe=(()=>{class _e{constructor(Oe){this.isDeveloperReferral=Oe}}return _e.type="[Auth] Set Developer Referral",_e})(),Je=(()=>{class _e{constructor(Oe){this.active=Oe}}return _e.type="[Auth] Set User View Gate Active",_e})(),ot=(()=>{class _e{}return _e.type="[Auth] Get User Notices",_e})(),ct=(()=>{class _e{constructor(Oe){this.userNotices=Oe}}return _e.type="[Auth] Get User Notices Success",_e})(),dt=(()=>{class _e{constructor(Oe){this.error=Oe}}return _e.type="[Auth] Get User Notices Fail",_e})(),ke=(()=>{class _e{constructor(Oe){this.noticeId=Oe}}return _e.type="[Auth] Mark User Notice As Seen",_e})(),Ae=(()=>{class _e{constructor(Oe){this.noticeId=Oe}}return _e.type="[Auth] Mark User Notice As Seen Success",_e})(),Fe=(()=>{class _e{constructor(Oe){this.error=Oe}}return _e.type="[Auth] Mark User Notice As Seen Fail",_e})()},16823:(ge,F,n)=>{"use strict";n.d(F,{k:()=>U});var t=n(65763),e=n(38165),r=n(71263),o=n(18152),C=n(15152),E=n(11756),y=n(21626),d=n(17215),_=n(11040),v=n(4158),b=n(47632),P=n(41862),s=n(47610),g=n(93915),u=n(66056),h=n(33013),S=n(15810),f=n(15318),m=n(15877),i=n(54438);class c{constructor(z,H,J){this.category=z,this.message=H,this.log=J}}let a=(()=>{var Z;class z{constructor(J){this.http=J,this.log={}}logError(J,Y=!1){const X=`${J.category}${J.message}`;return Y&&this.log[X]?(0,m.of)():(this.log[X]=!0,this.http.post("/ws/human-error",J))}}return(Z=z).\u0275fac=function(J){return new(J||Z)(i.KVO(y.Qq))},Z.\u0275prov=i.jDH({token:Z,factory:Z.\u0275fac,providedIn:"root"}),z})();var R,re,l=n(49204),p=n(28696),A=n(24418),O=n(52762),L=n(94371),k=n(27180),q=n(83889),B=n(91939),j=n(56081),V=n(59e3),M=n(27182),N=n(4475),W=n(87732),$=n(5690),ne=n(7213),Q=n(70737),le=n(71217),pe=n(51036),ie=n(37780),be=n(53236),w=n(11153),te=n(50262),D=function(Z,z,H,J){var se,Y=arguments.length,X=Y<3?z:null===J?J=Object.getOwnPropertyDescriptor(z,H):J;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)X=Reflect.decorate(Z,z,H,J);else for(var oe=Z.length-1;oe>=0;oe--)(se=Z[oe])&&(X=(Y<3?se(X):Y>3?se(z,H,X):se(z,H))||X);return Y>3&&X&&Object.defineProperty(z,H,X),X},T=function(Z,z){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(Z,z)};const K=A.c.application===k.c.Studio,ae={signed_in:!1},ce={loading:!1,requestingCode:!1,profileStatus:"ready",auth2:null,googleCredential:null,googlePromptResult:null,loggedIn:ae,userLocale:null,userRoles:[],contentViews:{limit_reached:!1,inapp_view_limit:0,inapp_view_count:0},developerReferral:!1};let U=(R=class{static getLoggedIn(z){return!0===z.loggedIn?.signed_in}static getLoggedInState(z){return z.loggedIn}static getEnvironmentSettings(z){return z.environmentSettings}static getProfile(z){const{userProfile:H,groupUserProfile:J}=z;return(0,l.isNil)(H)?(0,l.isNil)(J)?void 0:(0,pe.v)(le.P.Organization,J):(0,pe.v)(le.P.User,H)}static getUserProfile(z){return z.userProfile}static getGroupUserProfile(z){return z.groupUserProfile}static getUserRole(z){return(0,l.isNil)(z.userProfile)?(0,l.isNil)(z.groupUserProfile)?void 0:j.Oj:z.userProfile?.organizations[0]?.user_role??j.br}static getUserRoles(z){return z.userRoles}static getSystemDefaultRole(z){return(z.userRoles??[]).find(Y=>Y.role_name===j.br.role_name)??j.br}static getUserType(z){if(!(0,l.isNil)(z.userProfile)){const{premium_account:H,premium_account_type:J}=z.userProfile;if(H)return"group"===J?M.I.Team:M.I.Premium}return M.I.Free}static getUserSessionType(z){return z.loggedIn?.session_type}static canInviteUsers(z){if(!(0,l.isNil)(z.userProfile)){const H=re.getUserType(z),J=re.getUserRole(z);return(0,ne._m)(J,Q.y.InviteUsers)&&H===M.I.Team}return!1}static getUserAccountSettings(z){return z?.userProfile?.account_settings??[]}static getAuth2(z){return z.auth2}static getGooglePromptResult(z){return z.googlePromptResult}static getProfileCheck(z){return z.profileCheck}static getLoading(z){return z.loading}static getVerifyingProfile(z){return"verifying"===z.profileStatus}static getProfileUpdating(z){return"updating"===z.profileStatus}static getProfileDeleting(z){return"deleting"===z.profileStatus}static getUserLocale(z){return z.userLocale}static getUserLanguage(z){return z.userLocale?.lang||_.q.lang}static getUserApps(z){return z?.userApps??[]}static getSelectedUserApp(z){return(z.userApps||[]).find(J=>J.id===z.selectedAppId)}static getUserFullName(z){return(0,l.isNil)(z.userProfile)?null:(0,l.trim)([z.userProfile.first_name??"",z.userProfile.last_name??""].join(" "))}static getUserEmail(z){return(0,l.isNil)(z.userProfile)?null:z.userProfile.email}static isPrivateUser(z){return!(0,l.isNil)(z.userProfile)&&0===(z?.userProfile?.organizations??[]).length}static isPremiumUser(z){return!0===z?.userProfile?.premium_account_valid}static isAdmin(z){const H=this.getUserRole(z);return!!H&&H.role_name===W.x.Admin}static isDeveloperReferral(z){return z.developerReferral}static getContentViews(z){return z.contentViews}static getContentViewsReached(z){return!re.isPremiumUser(z)&&z.contentViews.limit_reached}static hasActiveDeveloperAccount(z){return!(0,l.isNil)(z.userProfile)&&z.userProfile.developer_account&&(z.userProfile.developer_account_active||z.userProfile.developer_account_verified)&&z.userProfile.developer_has_apps}static getUserNotices(z){return z.userNotices}static canStartFreeTrial(z){return z.userProfile?.premium_account_eligibility.group_free_trial??!1}initializeGoogleAuth(z){const H=navigator.userAgent.indexOf("Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:")>=0&&navigator.userAgent.indexOf("0) Gecko/20100101 Firefox")>=0,J={client_id:A.c.googleAuthKey,itp_support:!1};H?(J.ux_mode="redirect",J.login_uri="https://"+window.location.host+"/ws/google/to/auth"):(J.ux_mode="popup",J.callback=Y=>{z.patchState({googleCredential:Y.credential}),z.dispatch(new e.rK(Y.credential))}),google.accounts.id.initialize(J)}promptWithGoogle(z){google.accounts.id.prompt(H=>{const J={dismissedReason:H.getDismissedReason(),momentType:H.getMomentType(),notDisplayedReason:H.getNotDisplayedReason(),skippedReason:H.getSkippedReason()};z.dispatch(new e.hz(J))})}promptWithGoogleSuccess(z,H){z.patchState({googlePromptResult:H.promptResult})}isLoggedIn(z,H){z.patchState({loading:!0}),this.authService.isLoggedIn().pipe((0,C.j)(()=>z.patchState({loading:!1}))).subscribe(J=>{const{signed_in:Y,session_type:X}=J;z.dispatch(Y?new e.RL(X):new e.i1(X))})}isLoggedInSuccess(z,H){z.patchState({loggedIn:{signed_in:!0,session_type:H.sessionType}})}isLoggedInFailure(z,H){z.patchState({loggedIn:ae})}login(z,H){const{login:J,verification:Y}=H,{email:X}=J;z.patchState({loading:!0}),(Y?.isHuman?(0,m.of)(Y):this.authService.verifyIsHuman("studio_login",X)).pipe((0,E.Z)(({isHuman:oe,verification:me})=>{if(!oe)throw new te.s;return this.authService.loginWithBiodigital({...J,...me?{site_verify_response:me}:null})}),(0,C.j)(()=>z.patchState({loading:!1}))).subscribe({next:oe=>{z.dispatch(new e.b9("biodigital",oe))},error:oe=>{oe instanceof te.s&&z.dispatch(new e.sz(oe)),this.logFailure("LOGIN_FAILURE",oe),z.dispatch(new e.kb("biodigital",oe,J))}})}loginWithGoogle(z,H){z.patchState({loading:!0}),this.authService.loginWithGoogle(H.login).pipe((0,C.j)(()=>z.patchState({loading:!1}))).subscribe(J=>{z.dispatch(new e.b9("google",J))},J=>{(1===H.login.groupCodeMode||1===H.login.groupInviteMode)&&this.logFailure("GOOGLE_SIGNUP_FAILURE",J),z.dispatch(new e.kb("google",J,H.login))})}loginWithGroup(z,H){z.patchState({loading:!0}),this.authService.loginWithGroup(H.login).pipe((0,C.j)(()=>z.patchState({loading:!1}))).subscribe(J=>{z.dispatch(new e.b9("group",J))},J=>{z.dispatch(new e.kb("group",J,H.login))})}loginSuccess(z,H){K&&(this.linkedinInsights.track("Sign in"),"google"===H.loginType&&"signup"===H.response.authentication_type?this.vendorAnalyticsService.trackSignUp(H.loginType):this.vendorAnalyticsService.trackSignIn(H.loginType)),z.dispatch(new e.Qb),z.dispatch(new e.hg)}loginFailure(z,H){K&&this.vendorAnalyticsService.track("Sign In - Failure",{type:H.loginType,error:(0,be.u1)(H.error)||"There was an error logging in.",statusCode:H.error?.status})}logout(z,H){z.patchState({loading:!0}),("organization"===z.getState().loggedIn?.session_type?this.authService.logoutGroup():this.authService.logout()).pipe((0,C.j)(()=>z.patchState({loading:!1}))).subscribe(()=>z.dispatch(new e.cO),()=>z.dispatch(new e.je))}logoutSuccess(z,H){z.setState(ce),z.dispatch(new e.uj),z.dispatch(new L.W9),z.dispatch(new b.Ri),z.dispatch(new P.tV),z.dispatch(new s.lQ),z.dispatch(new g.$y),z.dispatch(new S.G.ResetLayout),z.dispatch(new o.QB),z.dispatch(new u.jj),z.dispatch(new h.FN),z.dispatch(new p.w.Reset),z.dispatch(new w.hw),this.storageService.clearSessionStorage()}checkProfile(z,H){return z.patchState({loading:!0}),this.authService.checkProfile(H.email).pipe((0,C.j)(()=>z.patchState({loading:!1}))).subscribe(J=>{z.dispatch(new e.vY(J))},J=>{z.dispatch(new e.YY(J))})}checkProfileSuccess(z,H){z.patchState({profileCheck:H.profile})}getGroupUserProfileAction(z,H){return z.patchState({loading:!0}),this.authService.getGroupUserProfile().pipe((0,C.j)(()=>z.patchState({loading:!1}))).subscribe(J=>{z.dispatch(new e.tk(J))},J=>{z.dispatch(new e.Sw(J))})}getGroupUserProfileSuccess(z,{groupUserProfile:H}){z.patchState({userProfile:null,groupUserProfile:H}),z.dispatch(new o.Fy(H.organizations)),z.dispatch(new e.hg)}getUserProfile(z,{hardCheck:H}){return z.patchState({loading:!0}),this.authService.getUserProfile(H).pipe((0,C.j)(()=>z.patchState({loading:!1}))).subscribe(J=>{z.dispatch(new e.Cy(J))},J=>{z.dispatch(new e.h8(J))})}getUserProfileSuccess(z,H){z.patchState({userProfile:H.userProfile,groupUserProfile:null}),z.dispatch(new o.Fy(H.userProfile.organizations)),z.dispatch(new e.o5),z.dispatch(new e.hg)}updateUserProfile(z,{userProfile:H}){z.patchState({profileStatus:"updating"}),this.authService.updaterUserProfile(H).pipe((0,C.j)(()=>z.patchState({profileStatus:"ready"}))).subscribe(()=>{z.dispatch(new e.ZD(H))},J=>{z.dispatch(new e._h(J))})}updateUserProfileSuccess(z,{userProfile:H}){this.vendorAnalyticsService.updateVisitorData(H)}deleteUserProfile(z,H){z.patchState({profileStatus:"deleting"}),this.authService.deleteUserProfile().pipe((0,C.j)(()=>z.patchState({profileStatus:"ready"}))).subscribe(J=>{z.dispatch(new e.nb(J))},J=>{z.dispatch(new e.cZ(J))})}getUserRoles(z,H){this.authService.getUserRoles().subscribe(J=>{z.patchState({userRoles:J})})}getUserApps(z,H){this.authService.getUserApps().subscribe(J=>{z.dispatch(new e.yO(J)),z.dispatch(new e._E)},J=>{})}setUserApps(z,{apps:H}){z.patchState({userApps:H})}setSelectedUserApp(z,{appId:H}){z.patchState({selectedAppId:H}),null!==H?this.storageService.setLocalItem(d.UT.UserAppId,H):this.storageService.removeLocalItem(d.UT.UserAppId)}checkSelectedUserApp(z,H){const J=z.getState().userApps,Y=this.storageService.getLocalItem(d.UT.UserAppId);if(Y){const X=parseInt(Y,10);z.dispatch(new e.A$(X))}else if(J&&J.length){const X=J.find(se=>se.app_platform.some(oe=>oe.type===O.MM.Web));z.dispatch(new e.A$(X?X.id:void 0))}}checkSession(z,H){z.patchState({loading:!0}),this.authService.isLoggedIn().pipe((0,C.j)(()=>z.patchState({loading:!1}))).subscribe(J=>{const{signed_in:Y,session_type:X}=J;Y?(z.dispatch(new e.RL(X)),"organization"===X?z.dispatch(new e.Cx):(z.dispatch(new e.hs),z.dispatch(new e.Xb))):z.dispatch(new e.i1(X))})}getEnvironmentSettings(z,H){return z.patchState({loading:!0}),this.authService.getEnvironmentSettings().pipe((0,C.j)(()=>z.patchState({loading:!1}))).subscribe(J=>{z.dispatch(new e.Ko(J))},J=>{z.dispatch(new e.Dv(J))})}GetEnvironmentSettingsSuccess(z,H){z.patchState({environmentSettings:H.environmentSettings})}resetPassword(z,H){z.patchState({loading:!0}),this.authService.resetPassword(H.email).pipe((0,C.j)(()=>z.patchState({loading:!1}))).subscribe(()=>{z.dispatch(new e.ct(H.email))},J=>{z.dispatch(new e.Fm(J))})}transferFacebookAccount(z,H){z.patchState({loading:!0}),this.authService.verifyIsHuman("deactivate_facebook",H.email).pipe((0,E.Z)(({isHuman:J,verification:Y})=>{if(!J)throw new te.s;return this.authService.deactivateFacebook({version:4,app_productkey:this.productService.productKey,app_producttype:this.productService.productType,...Y?{site_verify_response:Y}:null,user_email:H.email})}),(0,C.j)(()=>z.patchState({loading:!1}))).subscribe({next:J=>{z.dispatch(J.conversion_complete&&J.reset_password_email_sent?new e.o7(H.email):new e.z3(new Error("Facebook deactivation failed")))},error:J=>{J instanceof te.s&&z.dispatch(new e.sz(J)),z.dispatch(new e.z3(J))}})}updatePassword(z,H){const{currentPassword:J,newPassword:Y,confirmNewPassword:X}=H;this.authService.updatePassword(J,Y,X).subscribe(()=>{z.dispatch(new e.kP)},se=>{z.dispatch(new e.j3(se))})}signUp(z,H){const{value:J,verification:Y}=H,{email:X}=J;z.patchState({loading:!0}),(Y?.isHuman?(0,m.of)(Y):this.authService.verifyIsHuman("studio_signup",X)).pipe((0,E.Z)(({isHuman:oe,verification:me})=>{if(!oe)throw new te.s;return this.authService.signUp({...J,...me?{site_verify_response:me}:null})}),(0,C.j)(()=>z.patchState({loading:!1}))).subscribe({next:oe=>{z.dispatch(new e.mK(oe))},error:oe=>{oe instanceof te.s&&z.dispatch(new e.sz(oe)),z.dispatch(new e.HP(oe))}})}signUpSuccess(z,H){K&&this.vendorAnalyticsService.trackSignUp("biodigital")}signUpFailure(z,H){K&&this.vendorAnalyticsService.track("Sign Up - Failure",{error:(0,be.u1)(H?.error)||"There was an error signing up.",statusCode:H.error?.status}),this.logFailure("BIODIGITAL_SIGNUP_FAILURE",H)}setUserLocale(z,{locale:H,reload:J}){this.storageService.setLocalItem(d.UT.Locale,H.id),J?window.location.reload():(z.patchState({userLocale:H}),z.dispatch(new e.XH(H)))}setUserLocaleSuccess(z,{locale:H}){(0,v.vM)(this.httpClient,H.id)().subscribe(()=>{})}checkLocale(z,H){const J=(0,_.kF)(),Y=_.IB.find(X=>X.id===J)||_.q;z.dispatch(new e.aD(Y))}sendUserMessage(z,{message:H}){this.userMessageService.sendMessage(H).subscribe(()=>{z.dispatch(new e._L(H))},J=>{z.dispatch(new e.zc(J))})}getUserMessage(z,{type:H,mode:J}){this.userMessageService.getUserMessage(H,J).subscribe(Y=>{z.dispatch(new e.W3(Y))},()=>{z.dispatch(new e.NH(H))})}setUserMessageViewed(z,{messageSeenId:H}){this.userMessageService.setUserMessageViewed(H).subscribe(()=>z.dispatch(new e.Mg),()=>z.dispatch(new e.RR))}resetAuth(z,H){z.setState(ce)}requestVerificationCode(z,{email:H,token:J}){z.patchState({requestingCode:!0}),this.authService.requestVerificationCode({user_email:H,verification_jwt:J}).pipe((0,C.j)(()=>z.patchState({requestingCode:!1}))).subscribe(Y=>{z.dispatch(new e.bY(Y))},Y=>{z.dispatch(new e.Ml(Y))})}verifyProfile(z,{email:H,token:J,code:Y}){const X=Y.toUpperCase();z.patchState({profileStatus:"verifying"}),this.authService.verifyProfile({user_email:H,verification_code:X,verification_jwt:J}).pipe((0,C.j)(()=>z.patchState({profileStatus:"ready"}))).subscribe(se=>{z.dispatch(new e.iM(se)),z.dispatch(new e.lC)},se=>{z.dispatch(new e.RW(se))})}verifyProfileSuccess(z){this.vendorAnalyticsService.track("Email Verify - Success",{platform:this.productService.productType})}verifyProfileFail(z,H){this.vendorAnalyticsService.track("Email Verify - Failure",{error:(0,be.u1)(H?.error)||"There was an error with email verification.",statusCode:H.error?.status})}setContentView(z,{contentId:H,contentType:J}){this.contentViewService.trackContentView(H,J).subscribe(()=>{z.dispatch(new e.h5),z.dispatch(new e.OF)})}checkContentViews(z,H){this.contentViewService.checkContentView().subscribe(J=>{z.patchState({contentViews:J}),z.dispatch(new e.vL(J))})}setDeveloperReferral(z,H){z.patchState({developerReferral:H.isDeveloperReferral})}logFailure(z,H){const J=H?.message||"",Y=(0,be.u1)(H)||"";this.errorLoggingService.logError(new c(z,J,Y)).subscribe()}getUserNotices(z){this.authService.getUserNotices().subscribe({next:H=>{const J=H.notices;z.patchState({userNotices:J}),z.dispatch(new e.uG(J))},error:H=>z.dispatch(new e.Fw(H))})}markUserNoticeAsSeen(z,{noticeId:H}){this.authService.markUserNoticeAsSeen(H).subscribe({next:()=>{const J=z.getState().userNotices;if(J){const Y=J.findIndex(X=>X.notice_id===H);J.splice(Y,1),z.patchState({userNotices:[...J]}),z.dispatch(new e.R$(H))}},error:J=>z.dispatch(new e.CU(J))})}constructor(z,H,J,Y,X,se,oe,me,Se){this.authService=z,this.userMessageService=H,this.storageService=J,this.errorLoggingService=Y,this.linkedinInsights=X,this.vendorAnalyticsService=se,this.contentViewService=oe,this.productService=me,this.httpClient=Se}ngxsOnInit(z){z.dispatch(new e.lC),z.dispatch(new e.hg),z.dispatch(new e._E),z.dispatch(new e.ij)}},re=R,R.\u0275fac=function(z){return new(z||R)(i.KVO(r.u),i.KVO(f.K),i.KVO(d.n$),i.KVO(a),i.KVO(q.n),i.KVO(V.e),i.KVO(N.K),i.KVO($.b),i.KVO(y.Qq))},R.\u0275prov=i.jDH({token:R,factory:R.\u0275fac}),R);D([(0,t.rc)(e.ij),T("design:type",Function),T("design:paramtypes",[Object]),T("design:returntype",void 0)],U.prototype,"initializeGoogleAuth",null),D([(0,t.rc)(e.eu),T("design:type",Function),T("design:paramtypes",[Object]),T("design:returntype",void 0)],U.prototype,"promptWithGoogle",null),D([(0,t.rc)(e.hz),T("design:type",Function),T("design:paramtypes",[Object,e.hz]),T("design:returntype",void 0)],U.prototype,"promptWithGoogleSuccess",null),D([(0,t.rc)(e.Qb),T("design:type",Function),T("design:paramtypes",[Object,e.Qb]),T("design:returntype",void 0)],U.prototype,"isLoggedIn",null),D([(0,t.rc)(e.RL),T("design:type",Function),T("design:paramtypes",[Object,e.RL]),T("design:returntype",void 0)],U.prototype,"isLoggedInSuccess",null),D([(0,t.rc)(e.i1),T("design:type",Function),T("design:paramtypes",[Object,e.i1]),T("design:returntype",void 0)],U.prototype,"isLoggedInFailure",null),D([(0,t.rc)(e.Gu),T("design:type",Function),T("design:paramtypes",[Object,e.Gu]),T("design:returntype",void 0)],U.prototype,"login",null),D([(0,t.rc)(e.Zc),T("design:type",Function),T("design:paramtypes",[Object,e.Zc]),T("design:returntype",void 0)],U.prototype,"loginWithGoogle",null),D([(0,t.rc)(e.bl),T("design:type",Function),T("design:paramtypes",[Object,e.bl]),T("design:returntype",void 0)],U.prototype,"loginWithGroup",null),D([(0,t.rc)(e.b9),T("design:type",Function),T("design:paramtypes",[Object,e.b9]),T("design:returntype",void 0)],U.prototype,"loginSuccess",null),D([(0,t.rc)(e.kb),T("design:type",Function),T("design:paramtypes",[Object,e.kb]),T("design:returntype",void 0)],U.prototype,"loginFailure",null),D([(0,t.rc)(e.fQ),T("design:type",Function),T("design:paramtypes",[Object,e.fQ]),T("design:returntype",void 0)],U.prototype,"logout",null),D([(0,t.rc)(e.cO),T("design:type",Function),T("design:paramtypes",[Object,e.cO]),T("design:returntype",void 0)],U.prototype,"logoutSuccess",null),D([(0,t.rc)(e.YP),T("design:type",Function),T("design:paramtypes",[Object,e.YP]),T("design:returntype",void 0)],U.prototype,"checkProfile",null),D([(0,t.rc)(e.vY),T("design:type",Function),T("design:paramtypes",[Object,e.vY]),T("design:returntype",void 0)],U.prototype,"checkProfileSuccess",null),D([(0,t.rc)(e.Cx),T("design:type",Function),T("design:paramtypes",[Object,e.Cx]),T("design:returntype",void 0)],U.prototype,"getGroupUserProfileAction",null),D([(0,t.rc)(e.tk),T("design:type",Function),T("design:paramtypes",[Object,e.tk]),T("design:returntype",void 0)],U.prototype,"getGroupUserProfileSuccess",null),D([(0,t.rc)(e.hs),T("design:type",Function),T("design:paramtypes",[Object,e.hs]),T("design:returntype",void 0)],U.prototype,"getUserProfile",null),D([(0,t.rc)(e.Cy),T("design:type",Function),T("design:paramtypes",[Object,e.Cy]),T("design:returntype",void 0)],U.prototype,"getUserProfileSuccess",null),D([(0,t.rc)(e.Kg),T("design:type",Function),T("design:paramtypes",[Object,e.Kg]),T("design:returntype",void 0)],U.prototype,"updateUserProfile",null),D([(0,t.rc)(e.ZD),T("design:type",Function),T("design:paramtypes",[Object,e.Kg]),T("design:returntype",void 0)],U.prototype,"updateUserProfileSuccess",null),D([(0,t.rc)(e.sG),T("design:type",Function),T("design:paramtypes",[Object,e.sG]),T("design:returntype",void 0)],U.prototype,"deleteUserProfile",null),D([(0,t.rc)(e.Xb),T("design:type",Function),T("design:paramtypes",[Object,e.Xb]),T("design:returntype",void 0)],U.prototype,"getUserRoles",null),D([(0,t.rc)(e.o5),T("design:type",Function),T("design:paramtypes",[Object,e.o5]),T("design:returntype",void 0)],U.prototype,"getUserApps",null),D([(0,t.rc)(e.yO),T("design:type",Function),T("design:paramtypes",[Object,e.yO]),T("design:returntype",void 0)],U.prototype,"setUserApps",null),D([(0,t.rc)(e.A$),T("design:type",Function),T("design:paramtypes",[Object,e.A$]),T("design:returntype",void 0)],U.prototype,"setSelectedUserApp",null),D([(0,t.rc)(e._E),T("design:type",Function),T("design:paramtypes",[Object,e._E]),T("design:returntype",void 0)],U.prototype,"checkSelectedUserApp",null),D([(0,t.rc)(e.lC),T("design:type",Function),T("design:paramtypes",[Object,e.lC]),T("design:returntype",void 0)],U.prototype,"checkSession",null),D([(0,t.rc)(e.xG),T("design:type",Function),T("design:paramtypes",[Object,e.xG]),T("design:returntype",void 0)],U.prototype,"getEnvironmentSettings",null),D([(0,t.rc)(e.Ko),T("design:type",Function),T("design:paramtypes",[Object,e.Ko]),T("design:returntype",void 0)],U.prototype,"GetEnvironmentSettingsSuccess",null),D([(0,t.rc)(e.RO),T("design:type",Function),T("design:paramtypes",[Object,e.RO]),T("design:returntype",void 0)],U.prototype,"resetPassword",null),D([(0,t.rc)(e.JY),T("design:type",Function),T("design:paramtypes",[Object,e.JY]),T("design:returntype",void 0)],U.prototype,"transferFacebookAccount",null),D([(0,t.rc)(e.RE),T("design:type",Function),T("design:paramtypes",[Object,e.RE]),T("design:returntype",void 0)],U.prototype,"updatePassword",null),D([(0,t.rc)(e.Hx),T("design:type",Function),T("design:paramtypes",[Object,e.Hx]),T("design:returntype",void 0)],U.prototype,"signUp",null),D([(0,t.rc)(e.mK),T("design:type",Function),T("design:paramtypes",[Object,e.mK]),T("design:returntype",void 0)],U.prototype,"signUpSuccess",null),D([(0,t.rc)(e.HP),T("design:type",Function),T("design:paramtypes",[Object,e.HP]),T("design:returntype",void 0)],U.prototype,"signUpFailure",null),D([(0,t.rc)(e.aD),T("design:type",Function),T("design:paramtypes",[Object,e.aD]),T("design:returntype",void 0)],U.prototype,"setUserLocale",null),D([(0,t.rc)(e.XH),T("design:type",Function),T("design:paramtypes",[Object,e.XH]),T("design:returntype",void 0)],U.prototype,"setUserLocaleSuccess",null),D([(0,t.rc)(e.hg),T("design:type",Function),T("design:paramtypes",[Object,e.hg]),T("design:returntype",void 0)],U.prototype,"checkLocale",null),D([(0,t.rc)(e.r),T("design:type",Function),T("design:paramtypes",[Object,e.r]),T("design:returntype",void 0)],U.prototype,"sendUserMessage",null),D([(0,t.rc)(e.ru),T("design:type",Function),T("design:paramtypes",[Object,e.ru]),T("design:returntype",void 0)],U.prototype,"getUserMessage",null),D([(0,t.rc)(e.P),T("design:type",Function),T("design:paramtypes",[Object,e.P]),T("design:returntype",void 0)],U.prototype,"setUserMessageViewed",null),D([(0,t.rc)(e.uj),T("design:type",Function),T("design:paramtypes",[Object,e.uj]),T("design:returntype",void 0)],U.prototype,"resetAuth",null),D([(0,t.rc)(e.wj),T("design:type",Function),T("design:paramtypes",[Object,e.wj]),T("design:returntype",void 0)],U.prototype,"requestVerificationCode",null),D([(0,t.rc)(e.XZ),T("design:type",Function),T("design:paramtypes",[Object,e.XZ]),T("design:returntype",void 0)],U.prototype,"verifyProfile",null),D([(0,t.rc)(e.iM),T("design:type",Function),T("design:paramtypes",[Object]),T("design:returntype",void 0)],U.prototype,"verifyProfileSuccess",null),D([(0,t.rc)(e.RW),T("design:type",Function),T("design:paramtypes",[Object,e.RW]),T("design:returntype",void 0)],U.prototype,"verifyProfileFail",null),D([(0,t.rc)(e.e0),T("design:type",Function),T("design:paramtypes",[Object,e.e0]),T("design:returntype",void 0)],U.prototype,"setContentView",null),D([(0,t.rc)(e.OF),T("design:type",Function),T("design:paramtypes",[Object,e.OF]),T("design:returntype",void 0)],U.prototype,"checkContentViews",null),D([(0,t.rc)(e.kK),T("design:type",Function),T("design:paramtypes",[Object,e.kK]),T("design:returntype",void 0)],U.prototype,"setDeveloperReferral",null),D([(0,t.rc)(e.T9),T("design:type",Function),T("design:paramtypes",[Object]),T("design:returntype",void 0)],U.prototype,"getUserNotices",null),D([(0,t.rc)(e.EX),T("design:type",Function),T("design:paramtypes",[Object,e.EX]),T("design:returntype",void 0)],U.prototype,"markUserNoticeAsSeen",null),D([(0,t.MD)(),T("design:type",Function),T("design:paramtypes",[Object]),T("design:returntype",void 0)],U,"getLoggedIn",null),D([(0,t.MD)(),T("design:type",Function),T("design:paramtypes",[Object]),T("design:returntype",Object)],U,"getLoggedInState",null),D([(0,t.MD)(),T("design:type",Function),T("design:paramtypes",[Object]),T("design:returntype",void 0)],U,"getEnvironmentSettings",null),D([(0,t.MD)(),T("design:type",Function),T("design:paramtypes",[Object]),T("design:returntype",Object)],U,"getProfile",null),D([(0,t.MD)(),T("design:type",Function),T("design:paramtypes",[Object]),T("design:returntype",ie.s)],U,"getUserProfile",null),D([(0,t.MD)(),T("design:type",Function),T("design:paramtypes",[Object]),T("design:returntype",class de{})],U,"getGroupUserProfile",null),D([(0,t.MD)(),T("design:type",Function),T("design:paramtypes",[Object]),T("design:returntype",B.V)],U,"getUserRole",null),D([(0,t.MD)(),T("design:type",Function),T("design:paramtypes",[Object]),T("design:returntype",Array)],U,"getUserRoles",null),D([(0,t.MD)(),T("design:type",Function),T("design:paramtypes",[Object]),T("design:returntype",B.V)],U,"getSystemDefaultRole",null),D([(0,t.MD)(),T("design:type",Function),T("design:paramtypes",[Object]),T("design:returntype",String)],U,"getUserType",null),D([(0,t.MD)(),T("design:type",Function),T("design:paramtypes",[Object]),T("design:returntype",void 0)],U,"getUserSessionType",null),D([(0,t.MD)(),T("design:type",Function),T("design:paramtypes",[Object]),T("design:returntype",Boolean)],U,"canInviteUsers",null),D([(0,t.MD)(),T("design:type",Function),T("design:paramtypes",[Object]),T("design:returntype",Array)],U,"getUserAccountSettings",null),D([(0,t.MD)(),T("design:type",Function),T("design:paramtypes",[Object]),T("design:returntype",Object)],U,"getAuth2",null),D([(0,t.MD)(),T("design:type",Function),T("design:paramtypes",[Object]),T("design:returntype",Object)],U,"getGooglePromptResult",null),D([(0,t.MD)(),T("design:type",Function),T("design:paramtypes",[Object]),T("design:returntype",void 0)],U,"getProfileCheck",null),D([(0,t.MD)(),T("design:type",Function),T("design:paramtypes",[Object]),T("design:returntype",void 0)],U,"getLoading",null),D([(0,t.MD)(),T("design:type",Function),T("design:paramtypes",[Object]),T("design:returntype",void 0)],U,"getVerifyingProfile",null),D([(0,t.MD)(),T("design:type",Function),T("design:paramtypes",[Object]),T("design:returntype",void 0)],U,"getProfileUpdating",null),D([(0,t.MD)(),T("design:type",Function),T("design:paramtypes",[Object]),T("design:returntype",void 0)],U,"getProfileDeleting",null),D([(0,t.MD)(),T("design:type",Function),T("design:paramtypes",[Object]),T("design:returntype",void 0)],U,"getUserLocale",null),D([(0,t.MD)(),T("design:type",Function),T("design:paramtypes",[Object]),T("design:returntype",String)],U,"getUserLanguage",null),D([(0,t.MD)(),T("design:type",Function),T("design:paramtypes",[Object]),T("design:returntype",void 0)],U,"getUserApps",null),D([(0,t.MD)(),T("design:type",Function),T("design:paramtypes",[Object]),T("design:returntype",void 0)],U,"getSelectedUserApp",null),D([(0,t.MD)(),T("design:type",Function),T("design:paramtypes",[Object]),T("design:returntype",void 0)],U,"getUserFullName",null),D([(0,t.MD)(),T("design:type",Function),T("design:paramtypes",[Object]),T("design:returntype",void 0)],U,"getUserEmail",null),D([(0,t.MD)(),T("design:type",Function),T("design:paramtypes",[Object]),T("design:returntype",void 0)],U,"isPrivateUser",null),D([(0,t.MD)(),T("design:type",Function),T("design:paramtypes",[Object]),T("design:returntype",void 0)],U,"isPremiumUser",null),D([(0,t.MD)(),T("design:type",Function),T("design:paramtypes",[Object]),T("design:returntype",void 0)],U,"isAdmin",null),D([(0,t.MD)(),T("design:type",Function),T("design:paramtypes",[Object]),T("design:returntype",void 0)],U,"isDeveloperReferral",null),D([(0,t.MD)(),T("design:type",Function),T("design:paramtypes",[Object]),T("design:returntype",void 0)],U,"getContentViews",null),D([(0,t.MD)(),T("design:type",Function),T("design:paramtypes",[Object]),T("design:returntype",void 0)],U,"getContentViewsReached",null),D([(0,t.MD)(),T("design:type",Function),T("design:paramtypes",[Object]),T("design:returntype",void 0)],U,"hasActiveDeveloperAccount",null),D([(0,t.MD)(),T("design:type",Function),T("design:paramtypes",[Object]),T("design:returntype",void 0)],U,"getUserNotices",null),D([(0,t.MD)(),T("design:type",Function),T("design:paramtypes",[Object]),T("design:returntype",void 0)],U,"canStartFreeTrial",null),U=re=D([(0,t.Uw)({name:"auth",defaults:ce}),T("design:paramtypes",[r.u,f.K,d.n$,a,q.n,V.e,N.K,$.b,y.Qq])],U)},94371:(ge,F,n)=>{"use strict";n.d(F,{BO:()=>v,FT:()=>g,GY:()=>s,Jv:()=>r,K$:()=>o,KM:()=>e,OR:()=>C,P1:()=>d,Vz:()=>h,W9:()=>t,XF:()=>E,Yj:()=>_,dJ:()=>c,eI:()=>f,ee:()=>y,gq:()=>i,jL:()=>S,lG:()=>P,v_:()=>m,wE:()=>b,wq:()=>u});let t=(()=>{class l{}return l.type="[Subscription] Reset Subscription State",l})(),e=(()=>{class l{constructor(A,O){this.planId=A,this.discountcode=O}}return l.type="[Subscription] Request Braintree Payment",l})(),r=(()=>{class l{constructor(A){this.request=A}}return l.type="[Subscription] Request Braintree Payment Success",l})(),o=(()=>{class l{constructor(A,O){this.request=A,this.errorMessage=O}}return l.type="[Subscription] Request Braintree Payment Failure",l})(),C=(()=>{class l{constructor(A){this.request=A}}return l.type="[Subscription] Buy Subscription",l})(),E=(()=>{class l{constructor(A){this.request=A}}return l.type="[Subscription] Buy Subscription Success",l})(),y=(()=>{class l{constructor(A,O){this.error=A,this.request=O}}return l.type="[Subscription] Buy Subscription Failure",l})(),d=(()=>{class l{constructor(A){this.request=A}}return l.type="[Subscription] Update Subscription",l})(),_=(()=>{class l{constructor(A){this.request=A}}return l.type="[Subscription] Update Subscription Success",l})(),v=(()=>{class l{constructor(A,O){this.error=A,this.request=O}}return l.type="[Subscription] Update Subscription Failure",l})(),b=(()=>{class l{}return l.type="[Subscription] Cancel Subscription",l})(),P=(()=>{class l{}return l.type="[Subscription] Cancel Subscription Success",l})(),s=(()=>{class l{constructor(A){this.error=A}}return l.type="[Subscription] Cancel Subscription Failure",l})(),g=(()=>{class l{constructor(A,O){this.planId=A,this.code=O}}return l.type="[Subscription] Check Promo Code",l})(),u=(()=>{class l{constructor(A,O){this.code=A,this.plan=O}}return l.type="[Subscription] Check Promo Code Success",l})(),h=(()=>{class l{constructor(A){this.err=A}}return l.type="[Subscription] Check Promo Code Failure",l})(),S=(()=>{class l{}return l.type="[Subscription] Remove Promo Code",l})(),f=(()=>{class l{}return l.type="[Subscription] Get Premium Plans",l})(),m=(()=>{class l{constructor(A){this.plans=A}}return l.type="[Subscription] Get Premium Plans Success ",l})(),i=(()=>{class l{constructor(A){this.error=A}}return l.type="[Subscription] Get Premium Plans Failure",l})(),c=(()=>{class l{constructor(A){this.plan=A}}return l.type="[Subscription] Set Premium Plan",l})()},34440:(ge,F,n)=>{"use strict";n.d(F,{z:()=>a});var t=n(65763);class e{}var S,i,r=n(59771),o=n(94371),C=n(15152),E=n(11756),y=n(71263),d=n(24418),_=n(12215),v=n(38165),b=n(49204),P=n(16823),s=n(59e3),g=n(50262),u=n(53236),h=n(54438),f=function(l,p,A,O){var q,L=arguments.length,k=L<3?p:null===O?O=Object.getOwnPropertyDescriptor(p,A):O;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)k=Reflect.decorate(l,p,A,O);else for(var B=l.length-1;B>=0;B--)(q=l[B])&&(k=(L<3?q(k):L>3?q(p,A,k):q(p,A))||k);return L>3&&k&&Object.defineProperty(p,A,k),k},m=function(l,p){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(l,p)};const c={buying:!1,updating:!1,cancelling:!1,checkingCode:!1,plans:[],selectedPlan:void 0};let a=(i=S=class{static getBuying(p){return p.buying}static getUpdating(p){return p.updating}static getCancelling(p){return p.cancelling}static getSubscription(p,A){return(0,b.get)(A,"userProfile.subscription")}static getPlans(p){return p.plans}static getSelectedPlan(p){return p.selectedPlan}static getCheckingCode(p){return p.checkingCode}static isFreeTrial(p,A){return"Free Trial"===(0,b.get)(A,"userProfile.subscription.subscription_type")}static isCanceled(p,A){return"canceled"===(0,b.get)(A,"userProfile.subscription.subscription_status")}requestBraintreePayment(p,{planId:A,discountcode:O}){this.subscriptionService.requestBraintreePayment().subscribe({next:L=>{const k={...L,planId:A,discountcode:O};p.dispatch(new o.Jv(k))},error:L=>{p.dispatch(new o.K$({planId:A},L))}})}requestBraintreePaymentSuccess(p,{request:A}){this.recordSubscriptionAnalytic("Request Payment",A)}requestBraintreePaymentFailure(p,{request:A,errorMessage:O}){this.recordSubscriptionAnalytic("Request Payment Failure",A,O)}resetSubscriptionState(p,A){p.setState(c)}getPremiumPlans(p,A){this.subscriptionService.getBraintreePlans().subscribe(O=>{p.dispatch(new o.v_(O))},O=>{p.dispatch(new o.gq(O))})}getPremiumPlansSuccess(p,{plans:A}){p.patchState({plans:A})}setPremiumPlan(p,{plan:A}){p.patchState({selectedPlan:A})}buySubscription(p,{request:A}){p.patchState({buying:!0}),d.c.deploy===_.Z.Local?this.subscriptionService.buyProfessionalSubscription(A).pipe((0,C.j)(()=>p.patchState({buying:!1}))).subscribe(()=>{p.dispatch(new o.XF(A))},O=>{p.dispatch(new o.ee(O,A))}):this.authService.verifyIsHuman("subscription_checkout").pipe((0,E.Z)(({isHuman:O})=>{if(!O)throw new g.s;return this.subscriptionService.buyProfessionalSubscription(A)}),(0,C.j)(()=>p.patchState({buying:!1}))).subscribe({next:()=>{p.dispatch(new o.XF(A))},error:O=>{O instanceof g.s&&p.dispatch(new v.sz(O)),p.dispatch(new o.ee(O,A))}})}buySubscriptionSuccess(p,{request:A}){this.recordSubscriptionAnalytic("Account Upgrade",A)}buySubscriptionFailure(p,{request:A,error:O}){const L=`${O.message}: ${(0,u.u1)(O)}`;this.recordSubscriptionAnalytic("Account Upgrade Failure",A,L)}updateSubscription(p,{request:A}){p.patchState({updating:!0}),this.subscriptionService.updateProfessionalSubscription(A).pipe((0,C.j)(()=>p.patchState({updating:!1}))).subscribe(()=>{p.dispatch(new o.Yj(A))},O=>{p.dispatch(new o.BO(O,A))})}updateSubscriptionSuccess(p,{request:A}){this.recordSubscriptionAnalytic("Update Subscription",A)}updateSubscriptionFailure(p,{request:A,error:O}){const L=`${O.message}: ${(0,u.u1)(O)}`;this.recordSubscriptionAnalytic("Update Subscription Failure",A,L)}cancelSubscription(p,A){p.patchState({cancelling:!0}),this.subscriptionService.cancelSubscription().pipe((0,C.j)(()=>p.patchState({cancelling:!1}))).subscribe(()=>{p.dispatch(new o.lG)},O=>{p.dispatch(new o.GY(O))})}checkPromoCode(p,{planId:A,code:O}){p.patchState({checkingCode:!0}),this.subscriptionService.getBraintreePlan(A,O).pipe((0,C.j)(()=>p.patchState({checkingCode:!1}))).subscribe(L=>{p.dispatch(new o.wq(O,L))},L=>{p.dispatch(new o.Vz(L))})}checkPromoCodeSuccess(p,{plan:A}){p.patchState({selectedPlan:A})}removePromoCode(p,A){const{plans:O,selectedPlan:L}=p.getState();if(!(0,b.isNil)(L)){const k=L.plan_id;p.patchState({selectedPlan:O.find(q=>q.plan_id===k)})}}constructor(p,A,O,L){this.authService=p,this.subscriptionService=A,this.vendorAnalyticsService=O,this.store=L}recordSubscriptionAnalytic(p,A,O){this.store.selectSnapshot(i.getSubscription)||(p=`${p} - ${this.store.selectSnapshot(i.isFreeTrial)?"Free Trial to Premium Individual":"Free Individual to Premium Individual"}`);const L={planId:A.planId};A.type&&(L.paymentType=A.type),O&&(L.errorMessage=O),this.vendorAnalyticsService.track(p,L)}},S.\u0275fac=function(p){return new(p||S)(h.KVO(y.u),h.KVO(r.n),h.KVO(s.e),h.KVO(t.il))},S.\u0275prov=h.jDH({token:S,factory:S.\u0275fac}),S);f([(0,t.rc)(o.KM),m("design:type",Function),m("design:paramtypes",[Object,o.KM]),m("design:returntype",void 0)],a.prototype,"requestBraintreePayment",null),f([(0,t.rc)(o.Jv),m("design:type",Function),m("design:paramtypes",[Object,o.Jv]),m("design:returntype",void 0)],a.prototype,"requestBraintreePaymentSuccess",null),f([(0,t.rc)(o.K$),m("design:type",Function),m("design:paramtypes",[Object,o.K$]),m("design:returntype",void 0)],a.prototype,"requestBraintreePaymentFailure",null),f([(0,t.rc)(o.W9),m("design:type",Function),m("design:paramtypes",[Object,o.W9]),m("design:returntype",void 0)],a.prototype,"resetSubscriptionState",null),f([(0,t.rc)(o.eI),m("design:type",Function),m("design:paramtypes",[Object,o.eI]),m("design:returntype",void 0)],a.prototype,"getPremiumPlans",null),f([(0,t.rc)(o.v_),m("design:type",Function),m("design:paramtypes",[Object,o.v_]),m("design:returntype",void 0)],a.prototype,"getPremiumPlansSuccess",null),f([(0,t.rc)(o.dJ),m("design:type",Function),m("design:paramtypes",[Object,o.dJ]),m("design:returntype",void 0)],a.prototype,"setPremiumPlan",null),f([(0,t.rc)(o.OR),m("design:type",Function),m("design:paramtypes",[Object,o.OR]),m("design:returntype",void 0)],a.prototype,"buySubscription",null),f([(0,t.rc)(o.XF),m("design:type",Function),m("design:paramtypes",[Object,o.XF]),m("design:returntype",void 0)],a.prototype,"buySubscriptionSuccess",null),f([(0,t.rc)(o.ee),m("design:type",Function),m("design:paramtypes",[Object,o.ee]),m("design:returntype",void 0)],a.prototype,"buySubscriptionFailure",null),f([(0,t.rc)(o.P1),m("design:type",Function),m("design:paramtypes",[Object,o.P1]),m("design:returntype",void 0)],a.prototype,"updateSubscription",null),f([(0,t.rc)(o.Yj),m("design:type",Function),m("design:paramtypes",[Object,o.Yj]),m("design:returntype",void 0)],a.prototype,"updateSubscriptionSuccess",null),f([(0,t.rc)(o.BO),m("design:type",Function),m("design:paramtypes",[Object,o.BO]),m("design:returntype",void 0)],a.prototype,"updateSubscriptionFailure",null),f([(0,t.rc)(o.wE),m("design:type",Function),m("design:paramtypes",[Object,o.wE]),m("design:returntype",void 0)],a.prototype,"cancelSubscription",null),f([(0,t.rc)(o.FT),m("design:type",Function),m("design:paramtypes",[Object,o.FT]),m("design:returntype",void 0)],a.prototype,"checkPromoCode",null),f([(0,t.rc)(o.wq),m("design:type",Function),m("design:paramtypes",[Object,o.wq]),m("design:returntype",void 0)],a.prototype,"checkPromoCodeSuccess",null),f([(0,t.rc)(o.jL),m("design:type",Function),m("design:paramtypes",[Object,o.jL]),m("design:returntype",void 0)],a.prototype,"removePromoCode",null),f([(0,t.MD)(),m("design:type",Function),m("design:paramtypes",[e]),m("design:returntype",void 0)],a,"getBuying",null),f([(0,t.MD)(),m("design:type",Function),m("design:paramtypes",[e]),m("design:returntype",void 0)],a,"getUpdating",null),f([(0,t.MD)(),m("design:type",Function),m("design:paramtypes",[e]),m("design:returntype",void 0)],a,"getCancelling",null),f([(0,t.MD)([P.k]),m("design:type",Function),m("design:paramtypes",[e,Object]),m("design:returntype",void 0)],a,"getSubscription",null),f([(0,t.MD)(),m("design:type",Function),m("design:paramtypes",[e]),m("design:returntype",void 0)],a,"getPlans",null),f([(0,t.MD)(),m("design:type",Function),m("design:paramtypes",[e]),m("design:returntype",void 0)],a,"getSelectedPlan",null),f([(0,t.MD)(),m("design:type",Function),m("design:paramtypes",[e]),m("design:returntype",void 0)],a,"getCheckingCode",null),f([(0,t.MD)([P.k]),m("design:type",Function),m("design:paramtypes",[e,Object]),m("design:returntype",void 0)],a,"isFreeTrial",null),f([(0,t.MD)([P.k]),m("design:type",Function),m("design:paramtypes",[e,Object]),m("design:returntype",void 0)],a,"isCanceled",null),a=i=f([(0,t.Uw)({name:"subscription",defaults:c}),m("design:paramtypes",[y.u,r.n,s.e,t.il])],a)},59771:(ge,F,n)=>{"use strict";n.d(F,{n:()=>y});var t=n(2573),e=n(36110),r=n(49204),C=n(54438),E=n(21626);let y=(()=>{var d;class _{constructor(b){this.http=b}requestBraintreePayment(){return new t.c(b=>{(!this.braintreeDropin||!this.braintreeDataCollector)&&b.error(`The Braintree ${this.braintreeDropin?"DataCollector":"Dropin"} component is not instantiated.`),this.braintreeDropin.requestPaymentMethod((P,s)=>{if(P){const g=(0,r.get)(P,"_braintreeWebError.message",P.message);b.error(g)}else{const g=(0,r.get)(s,"nonce"),u=(0,r.get)(s,"type"),h=(0,r.get)(this.braintreeDataCollector,"deviceData");if(g&&h)b.next({nonce:g,deviceData:h,type:u}),b.complete();else{const S=[];!g&&S.push("'nonce'"),!h&&S.push("'deviceData'"),b.error(`Required ${S.length>1?"properties":"property"} missing: ${S.join(", ")}.`)}}})})}getBraintreePlans(){return this.http.get("/ws/professional/plan").pipe((0,e.T)(b=>b.plans))}getBraintreePlan(b,P){return this.http.get(`/ws/professional/plan?plan_id=${b}&discountcode=${P}`).pipe((0,e.T)(s=>s.plan))}getBraintreeClientToken(){return this.http.get("/ws/professional/customer").pipe((0,e.T)(b=>b.client_token))}buyProfessionalSubscription(b){return this.http.post("/ws/professional/subscribe",{payment_method_nonce:b.nonce,device_data:b.deviceData,plan_id:b.planId,discountcode:b.discountcode,subscription_intent:"buy"})}updateProfessionalSubscription(b){return this.http.post("/ws/professional/subscribe",{payment_method_nonce:b.nonce,device_data:b.deviceData,subscription_intent:"update"})}cancelSubscription(){return this.http.post("/ws/professional/cancel",{})}}return(d=_).\u0275fac=function(b){return new(b||d)(C.KVO(E.Qq))},d.\u0275prov=C.jDH({token:d,factory:d.\u0275fac,providedIn:"root"}),_})()},83513:(ge,F,n)=>{"use strict";n.d(F,{h:()=>sn});var t=n(65763),e=n(16058),r=n(66571),o=n(21424),C=n(56583),E=n(68132),y=n(16823),d=n(38399),_=n(17365),v=n(89417),b=n(34006),P=n(35379),s=n(54438),g=n(60177),u=n(21007),h=n(26779),S=n(49206);let f=(()=>{var Be;class Te{}return(Be=Te).\u0275fac=function(De){return new(De||Be)},Be.\u0275cmp=s.VBU({type:Be,selectors:[["app-toggle-group-item"]],inputs:{label:"label",tooltip:"tooltip",icon:"icon",value:"value"},decls:0,vars:0,template:function(De,Ne){},encapsulation:2,changeDetection:0}),Te})();var m=n(65571),i=n(14823);const c=(Be,Te,Me,De,Ne,He)=>({"toggle-group--theme-light":Be,"toggle-group--theme-dark":Te,"toggle-group--small":Me,"toggle-group--medium":De,"toggle-group--large":Ne,"toggle-group--block":He});function a(Be,Te){if(1&Be&&s.nrm(0,"app-icon",7),2&Be){const Me=s.XpG().$implicit;s.Y8G("icon",Me.icon)}}function l(Be,Te){if(1&Be&&(s.j41(0,"span"),s.EFF(1),s.k0s()),2&Be){const Me=s.XpG().$implicit;s.R7$(),s.JRh(Me.label)}}function p(Be,Te){if(1&Be&&(s.j41(0,"mat-button-toggle",3)(1,"div",4),s.DNE(2,a,1,1,"app-icon",5)(3,l,2,1,"span",6),s.k0s()()),2&Be){const Me=Te.$implicit;s.Y8G("value",Me.value)("matTooltip",Me.tooltip||""),s.BMQ("aria-label",Me.label||""),s.R7$(2),s.Y8G("ngIf",Me.icon),s.R7$(),s.Y8G("ngIf",Me.label)}}let A=(()=>{var Be;class Te extends S.Z{constructor(){super(...arguments),this.theme="light",this.display="inline",this.size="medium"}}return(Be=Te).\u0275fac=(()=>{let Me;return function(Ne){return(Me||(Me=s.xGo(Be)))(Ne||Be)}})(),Be.\u0275cmp=s.VBU({type:Be,selectors:[["app-toggle-group"]],contentQueries:function(De,Ne,He){if(1&De&&s.wni(He,f,5),2&De){let st;s.mGM(st=s.lsd())&&(Ne.items=st)}},inputs:{theme:"theme",display:"display",size:"size"},features:[s.Jv_([{provide:v.kq,useExisting:(0,s.Rfq)(()=>Be),multi:!0}]),s.Vt3],decls:3,vars:11,consts:[[1,"toggle-group",3,"ngClass"],[3,"formControl","hideSingleSelectionIndicator"],[3,"value","matTooltip",4,"ngFor","ngForOf"],[3,"value","matTooltip"],[1,"toggle-group__label"],[3,"icon",4,"ngIf"],[4,"ngIf"],[3,"icon"]],template:function(De,Ne){1&De&&(s.j41(0,"div",0)(1,"mat-button-toggle-group",1),s.DNE(2,p,4,5,"mat-button-toggle",2),s.k0s()()),2&De&&(s.Y8G("ngClass",s.l4e(4,c,"light"===Ne.theme,"dark"===Ne.theme,"small"===Ne.size,"medium"===Ne.size,"large"===Ne.size,"block"===Ne.display)),s.R7$(),s.Y8G("formControl",Ne.control)("hideSingleSelectionIndicator",!0),s.R7$(),s.Y8G("ngForOf",Ne.items))},dependencies:[g.YU,g.Sq,g.bT,m.ec,m.pc,i.oV,h.R,v.BC,v.l_],styles:[".toggle-group{--mat-toggle-border-color: #d7e0ea;--mat-toggle-background-color: #131c2a;--mat-toggle-selected-background-color: #374a68;--mat-toggle-selected-color: #f9fafd;--mat-toggle-color: #61779e;--mat-toggle-font-size: 14px;--mat-toggle-line-height: 20px;--mat-toggle-padding: 12px;--mat-toggle-min-width: 32px}.toggle-group .mat-button-toggle-group-appearance-standard{border:none}.toggle-group .mat-button-toggle-group-appearance-standard.mat-button-toggle-group .mat-button-toggle{background-color:#eaeff5;color:#374a68;border:none;border-radius:0!important;padding:0}.toggle-group .mat-button-toggle-group-appearance-standard.mat-button-toggle-group .mat-button-toggle-label-content{font-weight:500;font-size:var(--mat-toggle-font-size);line-height:var(--mat-toggle-line-height);padding:var(--mat-toggle-padding);min-width:var(--mat-toggle-min-width)}.toggle-group .mat-button-toggle-group-appearance-standard.mat-button-toggle-group .mat-button-toggle:hover:not(.toggle-group .mat-button-toggle-group-appearance-standard.mat-button-toggle-group .mat-button-toggle-checked){background-color:#d7e0ea;color:#1c2a3f}.toggle-group .mat-button-toggle-group-appearance-standard.mat-button-toggle-group .mat-button-toggle:first-child{border-radius:4px 0 0 4px!important}.toggle-group .mat-button-toggle-group-appearance-standard.mat-button-toggle-group .mat-button-toggle:last-child{border-radius:0 4px 4px 0!important}.toggle-group .mat-button-toggle-group-appearance-standard.mat-button-toggle-group .mat-button-toggle:last-child .mat-button-toggle-button{border-right:none}.toggle-group .mat-button-toggle-group-appearance-standard.mat-button-toggle-group .mat-button-toggle-checked{background-color:#283853;color:#fff}.toggle-group .mat-button-toggle-group-appearance-standard.mat-button-toggle-group .mat-button-toggle .mat-button-toggle-button{border-right:1px solid #d7e0ea}.toggle-group .mat-button-toggle-group-appearance-standard.mat-button-toggle-group .mat-button-toggle .mat-button-toggle-button:focus{outline:#2d72dc solid 2px!important;outline-offset:-2px}.toggle-group__label{display:flex;flex-direction:row;align-items:center;justify-content:center;gap:8px}.toggle-group--small{--mat-toggle-font-size: 12px;--mat-toggle-line-height: 16px;--mat-toggle-padding: 6px;--mat-toggle-min-width: 28px}.toggle-group--medium{--mat-toggle-font-size: 14px;--mat-toggle-line-height: 20px;--mat-toggle-padding: 8px;--mat-toggle-min-width: 44px}.toggle-group--large{--mat-toggle-font-size: 14px;--mat-toggle-line-height: 20px;--mat-toggle-padding: 12px;--mat-toggle-min-width: 48px}.toggle-group--block .mat-button-toggle-group-appearance-standard.mat-button-toggle-group{display:flex;flex-direction:row;justify-content:space-evenly}.toggle-group--block .mat-button-toggle-group-appearance-standard.mat-button-toggle-group .mat-button-toggle{flex:1}\n"],encapsulation:2,changeDetection:0}),Te})();n(45731);var L=n(94528),k=n(85052),q=n(15877),B=n(2573),j=n(37925),V=n(87996),M=n(21082),N=n(35160),W=n(17215),$=n(4951),ne=n(90265),Q=n(49204),pe=n(96557),ie=n(16606),be=n(47125),de=n(76774),w=n(13517),te=n(17766),R=n(21523),D=n(47632),T=n(9529),re=n(45024);const K=["*"];let ae=(()=>{var Be;class Te extends T.Ky{handleToggleClick(){this.toggle()}constructor(De,Ne,He){super(De,Ne,He)}}return(Be=Te).\u0275fac=function(De){return new(De||Be)(s.rXU(T.z8,12),s.rXU(s.gRc),s.rXU(re.zP))},Be.\u0275cmp=s.VBU({type:Be,selectors:[["app-accordion-item"]],inputs:{title:"title"},features:[s.Vt3],ngContentSelectors:K,decls:8,vars:9,consts:[[1,"accordion-item"],["tabindex","0",1,"accordion-item__header",3,"click"],[1,"accordion-item__title"],[1,"accordion-item__arrow",3,"icon"],[1,"accordion-item__body"]],template:function(De,Ne){1&De&&(s.NAR(),s.j41(0,"div",0)(1,"h3")(2,"button",1),s.bIt("click",function(){return Ne.handleToggleClick()}),s.j41(3,"span",2),s.EFF(4),s.k0s(),s.nrm(5,"app-icon",3),s.k0s()(),s.j41(6,"div",4),s.SdG(7),s.k0s()()),2&De&&(s.AVh("accordion-item--expanded",Ne.expanded),s.R7$(2),s.BMQ("id","accordion-header-"+Ne.id)("aria-expanded",Ne.expanded)("aria-controls","accordion-body-"+Ne.id),s.R7$(2),s.JRh(Ne.title),s.R7$(),s.Y8G("icon",Ne.expanded?"chevron-down":"chevron-right"),s.R7$(),s.BMQ("id","accordion-body-"+Ne.id)("aria-labelledby","accordion-header-"+Ne.id))},dependencies:[h.R],styles:["[_nghost-%COMP%]   .accordion-item[_ngcontent-%COMP%]{border-top:1px solid #d7e0ea}[_nghost-%COMP%]:last-child   .accordion-item[_ngcontent-%COMP%]{border-bottom:1px solid #d7e0ea}.accordion-item__header[_ngcontent-%COMP%]{cursor:pointer;border:none;display:flex;align-items:center;justify-content:space-between;background:none;width:100%;padding:12px 8px}.accordion-item__header[_ngcontent-%COMP%]:hover{background-color:#eaeff5}.accordion-item__title[_ngcontent-%COMP%]{color:#374a68;font-size:.875rem;line-height:1.25rem;font-weight:500}.accordion-item__arrow[_ngcontent-%COMP%]{width:16px}.accordion-item__body[_ngcontent-%COMP%]{padding:8px 8px 32px;display:none}.accordion-item--expanded[_ngcontent-%COMP%]   .accordion-item__body[_ngcontent-%COMP%]{display:block}"],changeDetection:0}),Te})();var Se,ce=n(28722),U=n(59115),Z=n(97443),z=n(74988),H=n(95416),J=n(82765),Y=n(5951),X=n(93547),se=n(37737),oe=n(87505),me=n(97352),Ue=function(Be,Te,Me,De){var st,Ne=arguments.length,He=Ne<3?Te:null===De?De=Object.getOwnPropertyDescriptor(Te,Me):De;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)He=Reflect.decorate(Be,Te,Me,De);else for(var it=Be.length-1;it>=0;it--)(st=Be[it])&&(He=(Ne<3?st(He):Ne>3?st(Te,Me,He):st(Te,Me))||He);return Ne>3&&He&&Object.defineProperty(Te,Me,He),He},je=function(Be,Te){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(Be,Te)};const Le=["publishOptionsEl"],Re=["embedAccordion"];function Ee(Be,Te){if(1&Be&&(s.j41(0,"option",46),s.EFF(1),s.k0s()),2&Be){const Me=Te.index;s.Y8G("value",Me+1),s.R7$(),s.SpI(" ",Me+1," ")}}function We(Be,Te){if(1&Be&&(s.j41(0,"div",72)(1,"mat-radio-group",73)(2,"mat-radio-button",74),s.EFF(3,"All questions"),s.k0s(),s.j41(4,"div",22)(5,"mat-radio-button",75),s.EFF(6,"Single question"),s.k0s(),s.j41(7,"select",76),s.DNE(8,Ee,2,2,"option",77),s.k0s()()()()),2&Be){const Me=s.XpG(2);s.R7$(7),s.BMQ("aria-label","Question Number"),s.R7$(),s.Y8G("ngForOf",Me.quizQuestions)}}function ze(Be,Te){if(1&Be&&(s.j41(0,"app-accordion-item",66)(1,"fieldset",67)(2,"mat-checkbox",68),s.EFF(3,"Assessment Mode"),s.k0s(),s.DNE(4,We,9,2,"div",69),s.k0s(),s.j41(5,"div",70)(6,"a",71),s.EFF(7," Learn more about quizzes in assessment mode "),s.k0s()()()),2&Be){const Me=s.XpG();s.Y8G("title","Quiz")("expanded",!0),s.R7$(),s.Y8G("formGroup",Me.formQuiz),s.R7$(3),s.Y8G("ngIf",Me.formQuiz.value.locked)}}function Ze(Be,Te){if(1&Be){const Me=s.RV6();s.j41(0,"button",87),s.bIt("click",function(){const Ne=s.eBV(Me).$implicit,He=s.XpG(2);return s.Njj(He.handleViewerSizeClick(Ne))}),s.EFF(1),s.k0s()}if(2&Be){const Me=Te.$implicit;s.R7$(),s.SpI(" ",Me.title," ")}}function et(Be,Te){1&Be&&(s.j41(0,"fieldset",88)(1,"legend",89),s.EFF(2,"Viewer Aspect Ratio"),s.k0s(),s.j41(3,"app-form-field",90),s.nrm(4,"input",91),s.j41(5,"div",92),s.EFF(6,"Width ratio"),s.k0s()(),s.j41(7,"span",93),s.EFF(8,":"),s.k0s(),s.j41(9,"app-form-field",90),s.nrm(10,"input",94),s.j41(11,"div",92),s.EFF(12,"Height ratio"),s.k0s()()()),2&Be&&(s.R7$(3),s.Y8G("isCompact",!0),s.R7$(),s.BMQ("aria-label","Width"),s.R7$(5),s.Y8G("isCompact",!0),s.R7$(),s.BMQ("aria-label","Height"))}function rt(Be,Te){if(1&Be){const Me=s.RV6();s.j41(0,"div")(1,"button",78,5),s.bIt("menuOpened",function(){s.eBV(Me);const Ne=s.sdS(2),He=s.XpG();return s.Njj(He.handleViewerSizeMenuOpened(Ne))}),s.j41(3,"div",79)(4,"span"),s.EFF(5),s.k0s(),s.nrm(6,"app-icon",80),s.k0s()(),s.j41(7,"mat-menu",null,6),s.DNE(9,Ze,2,1,"button",81),s.k0s(),s.DNE(10,et,13,4,"fieldset",82),s.j41(11,"app-alert",83)(12,"a",84),s.EFF(13,"Some websites may strip the style attributes"),s.k0s(),s.EFF(14," required for responsive Viewer sizing "),s.k0s(),s.j41(15,"div",85)(16,"a",86),s.EFF(17," Learn more about aspect ratio "),s.k0s()()()}if(2&Be){const Me=s.sdS(8),De=s.XpG();s.R7$(),s.Y8G("uppercase",!1)("matMenuTriggerFor",Me),s.R7$(4),s.JRh(De.selectedAspectRatio.title),s.R7$(4),s.Y8G("ngForOf",De.viewerFixedSizes),s.R7$(),s.Y8G("ngIf",De.isCustomAspectRatioSelected)}}function Ge(Be,Te){if(1&Be&&(s.j41(0,"fieldset",98)(1,"app-form-field",99),s.nrm(2,"input",100),s.j41(3,"div",92),s.EFF(4),s.k0s()(),s.j41(5,"span",93),s.EFF(6,"X"),s.k0s(),s.j41(7,"app-form-field",99),s.nrm(8,"input",101),s.j41(9,"div",92),s.EFF(10),s.k0s()()()),2&Be){const Me=Te.ngIf;s.R7$(),s.Y8G("isCompact",!0),s.R7$(),s.Y8G("min",Me.width),s.BMQ("aria-label","Width"),s.R7$(2),s.SpI("Width min. ",Me.width,"px"),s.R7$(3),s.Y8G("isCompact",!0),s.R7$(),s.Y8G("min",Me.height),s.BMQ("aria-label","Height"),s.R7$(2),s.SpI("Height min. ",Me.height,"px")}}function Ye(Be,Te){if(1&Be&&(s.j41(0,"div",96),s.DNE(1,Ge,11,8,"fieldset",97),s.nI1(2,"async"),s.k0s()),2&Be){const Me=s.XpG(2);s.R7$(),s.Y8G("ngIf",s.bMT(2,1,Me.minDimensions$))}}function Xe(Be,Te){if(1&Be&&(s.j41(0,"div"),s.DNE(1,Ye,3,3,"div",95),s.nI1(2,"async"),s.k0s()),2&Be){const Me=s.XpG();s.R7$(),s.Y8G("ngIf",s.bMT(2,1,Me.dimensions$))}}function ye(Be,Te){1&Be&&(s.j41(0,"div",102)(1,"app-form-field",103),s.nrm(2,"input",104),s.k0s()()),2&Be&&(s.R7$(),s.Y8G("isCompact",!0),s.R7$(),s.BMQ("aria-label","Degree of Rotation"))}function Ce(Be,Te){1&Be&&(s.j41(0,"div",105)(1,"mat-checkbox",106),s.EFF(2,' Show "info icon" for description '),s.k0s(),s.j41(3,"mat-checkbox",107),s.EFF(4,' Show "audio icon" for pronunciations '),s.k0s()())}function xe(Be,Te){1&Be&&(s.j41(0,"div",105)(1,"mat-checkbox",108),s.EFF(2,"Show label list in Information Panel"),s.k0s()())}function Je(Be,Te){1&Be&&(s.j41(0,"li")(1,"mat-checkbox",111),s.EFF(2,"Anatomy layers"),s.k0s()())}function ot(Be,Te){1&Be&&(s.j41(0,"li")(1,"mat-checkbox",112),s.EFF(2,"Skin selector"),s.k0s()())}function ct(Be,Te){if(1&Be&&(s.j41(0,"li")(1,"mat-checkbox",109),s.EFF(2,"Customize appearance"),s.k0s(),s.j41(3,"ul",110),s.DNE(4,Je,3,0,"li",51)(5,ot,3,0,"li",51),s.k0s()()),2&Be){const Me=s.XpG();s.R7$(),s.Y8G("formControl",Me.uiLayersEnabled)("indeterminate",Me.uiLayersIndeterminate),s.R7$(3),s.Y8G("ngIf",Me.hasVisibilityLayers()),s.R7$(),s.Y8G("ngIf",Me.hasSkinLayers())}}function dt(Be,Te){if(1&Be){const Me=s.RV6();s.j41(0,"button",113),s.bIt("click",function(){s.eBV(Me);const Ne=s.XpG();return s.Njj(Ne.handleEmbedClick())}),s.EFF(1," Reset to Default "),s.k0s()}}function ke(Be,Te){1&Be&&(s.j41(0,"p",118),s.EFF(1," Make this model available to anyone by publishing it to the web. "),s.k0s())}function Ae(Be,Te){1&Be&&(s.j41(0,"p",118),s.EFF(1," Your content has been saved to "),s.j41(2,"strong",119),s.EFF(3,"My Library > Private."),s.k0s(),s.nrm(4,"br"),s.EFF(5," Share a direct link or copy the embed code to use on your website. "),s.k0s())}function Fe(Be,Te){if(1&Be){const Me=s.RV6();s.j41(0,"div"),s.DNE(1,ke,2,0,"p",114)(2,Ae,6,0,"p",114),s.j41(3,"div",115)(4,"button",116),s.bIt("click",function(){s.eBV(Me);const Ne=s.XpG();return s.Njj(Ne.handleGenerateIFrame())}),s.EFF(5," Copy embed code "),s.k0s(),s.j41(6,"button",117),s.bIt("click",function(){s.eBV(Me);const Ne=s.XpG();return s.Njj(Ne.handleGenerateURL())}),s.EFF(7," Copy link "),s.k0s()()()}if(2&Be){const Me=s.XpG();s.R7$(),s.Y8G("ngIf",Me.model.id===Me.modelToPublish.id),s.R7$(),s.Y8G("ngIf",Me.model.id!==Me.modelToPublish.id),s.R7$(2),s.Y8G("disabled",!Me.formEmbed.valid),s.R7$(2),s.Y8G("disabled",!Me.formEmbed.valid)}}function he(Be,Te){1&Be&&(s.j41(0,"p",123),s.EFF(1," Save this model to "),s.j41(2,"strong",119),s.EFF(3,"My Library"),s.k0s(),s.EFF(4," to make it available for anyone, by publishing it to the web. "),s.k0s())}function _e(Be,Te){1&Be&&(s.j41(0,"p",123),s.EFF(1," You can manage this saved model at anytime in "),s.nrm(2,"br"),s.j41(3,"strong",119),s.EFF(4,"My Library > Private > All Models."),s.k0s()())}function Ie(Be,Te){1&Be&&s.nrm(0,"app-spinner",124)}function Oe(Be,Te){if(1&Be){const Me=s.RV6();s.DNE(0,he,5,0,"p",120),s.nI1(1,"async"),s.DNE(2,_e,5,0,"p",120),s.nI1(3,"async"),s.j41(4,"div",115)(5,"button",121),s.nI1(6,"async"),s.bIt("click",function(){s.eBV(Me);const Ne=s.XpG();return s.Njj(Ne.handleSaveClick())}),s.EFF(7),s.nI1(8,"async"),s.DNE(9,Ie,1,0,"app-spinner",122),s.nI1(10,"async"),s.k0s()()}if(2&Be){const Me=s.XpG();s.Y8G("ngIf",!1===s.bMT(1,5,Me.copying$)),s.R7$(2),s.Y8G("ngIf",!0===s.bMT(3,7,Me.copying$)),s.R7$(3),s.Y8G("disabled",s.bMT(6,9,Me.copying$)),s.R7$(2),s.SpI(" ",!0===s.bMT(8,11,Me.copying$)?"Saving to My Library":"Save & Publish"," "),s.R7$(2),s.Y8G("ngIf",s.bMT(10,13,Me.copying$))}}class tt{get accordionExpanded(){return!!this.accordionItems&&this.accordionItems.toArray().every(Te=>Te.expanded)}get rotateEnabled(){return this.formEmbed.get("rotate").value.enabled}get viewerSizeType(){return this.formEmbed.value.viewerSizeType}get widgetOptionsValues(){return this.widgetOptionsGroup.value}get isCustomAspectRatioSelected(){return this.selectedAspectRatio.title===z.Dx.title}constructor(Te,Me,De,Ne,He,st,it,ut,mt,St,ft){this.store=Te,this.actions=Me,this.publishService=De,this.storageService=Ne,this.clipboardService=He,this.dialogService=st,this.storyService=it,this.snackBar=ut,this.formBuilder=mt,this.changeDetectorRef=St,this.renderer2=ft,this.mediaEnum=ce.Y,this.viewerSizeTypeEnum=Z.M,this.viewerFixedSizes=[...z.Bg,z.Dx],this.selectedAspectRatio=z.Q2,this.quizQuestions=[],this.submit=new k.B,this.requiresSave=!1,this.defaultEmbedFormValues=this.getEmbedFormDefaults(),this.ngUnsubscribe=new k.B,this.defaultWidgetOptions={...new C.$,loadRotate:10},this.initEmbedForm()}ngOnInit(){this.model.type===te.c.Module&&(0,Q.isNil)(this.model.module_accessor_level)&&(this.requiresSave=!0),this.initQuizForm(),this.initQuizFormListeners(),this.initActionListeners(),this.setupEmbedForm(),this.initCopy(),this.store.dispatch(new L.id(!0))}ngOnDestroy(){this.store.dispatch(new L.id(!1)),this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}initCopy(){this.actions.pipe((0,t.xi)(D.lN),(0,j.Q)(this.ngUnsubscribe)).subscribe(Te=>this.handleCopySuccess(Te)),this.actions.pipe((0,t.xi)(D.Cr),(0,j.Q)(this.ngUnsubscribe)).subscribe(()=>this.handleCopyFailure()),this.submit.pipe((0,V.B)(100),(0,j.Q)(this.ngUnsubscribe)).subscribe(()=>this.onDebouncedSubmit()),this.modelToPublish=this.model}initEmbedForm(){const Te=this.getWidgetOptions(),Me=this.store.selectSnapshot(E.F.getDimensions),De=this.store.selectSnapshot(E.F.getAspectRatio),Ne=this.store.selectSnapshot(E.F.getMinDimensions),{button:He,handHint:st,play:it,summary:ut}=Te.initial,{alert:mt,overlay:St}=Te.disableScroll;this.formEmbed=this.formBuilder.group({viewerSizeType:this.formBuilder.control(Z.M.Responsive),dimensions:this.formBuilder.group({width:[Me.width,[v.k0.min(Ne.width)]],height:[Me.height,[v.k0.min(Ne.height)]]}),aspectRatio:this.formBuilder.group({width:[De.width,[v.k0.min(1)]],height:[De.height,[v.k0.min(1)]]}),options:this.formBuilder.group(Te),loader:this.formBuilder.group({enabled:Te.uiLoader!==pe.aD.None,mode:Te.uiLoader}),rotate:this.formBuilder.group({enabled:null!==Te.loadRotate,value:Te.loadRotate}),autoLoad:this.formBuilder.control(Te.autoLoad),playthrough:this.formBuilder.control(Te.playthrough),initial:this.formBuilder.group({enabled:Te.autoLoad&&(He||st||it||ut),mode:He?"button":st?"handHint":it?"play":ut?"summary":""}),disableScroll:this.formBuilder.group({enabled:mt||St,mode:mt?"alert":St?"overlay":""})}),this.uiLayersEnabled=new v.MJ(Te.uiSkinLayers||Te.uiVisibilityLayers),this.widgetOptionsGroup=this.formEmbed.get("options"),JSON.stringify(this.defaultEmbedFormValues)!==JSON.stringify(this.formEmbed.value)&&this.formEmbed.markAsDirty(),this.widgetEmbedSettings=this.getEmbedPublishOptions(),this.changeDetectorRef.markForCheck()}initQuizForm(){if(this.formQuiz=this.formBuilder.group({locked:[!1],options:this.formBuilder.group({mode:["all"],number:[1]})}),(this.model.tags||[]).includes(w.x.Quiz)){const{id:De,type:Ne}=this.model;this.storyService.getStory(De,Ne).pipe((0,j.Q)(this.ngUnsubscribe)).subscribe(He=>{this.quizQuestions=(0,de.En)(He.chapters),this.changeDetectorRef.markForCheck()})}}initQuizFormListeners(){const Te=this.formEmbed.get("options"),Me=this.formQuiz.get("locked"),De=this.formQuiz.get("options"),Ne=De.get("mode"),He=De.get("number");this.formQuiz.valueChanges.pipe((0,j.Q)(this.ngUnsubscribe)).subscribe(st=>{let it,ut;const{locked:mt,options:St}=st;if(mt){const{mode:ft,number:ht}=St;it=be.R.Locked,ut="single"===ft?ht:void 0}Te.patchValue({uiQuiz:{mode:it,number:ut}})}),Me.valueChanges.pipe((0,j.Q)(this.ngUnsubscribe)).subscribe(st=>{st?De.enable():De.disable()}),He.valueChanges.pipe((0,M.F)(),(0,j.Q)(this.ngUnsubscribe)).subscribe(()=>{!0===Me.value&&"single"!==Ne.value&&Ne.setValue("single")}),Me.setValue(!1)}initActionListeners(){this.actions.pipe((0,t.xi)(L.M),(0,d.q)(Te=>this.copyToClipboard(Te.url,"url")),(0,j.Q)(this.ngUnsubscribe)).subscribe(Te=>{this.snackBar.open(Te?"Successfully copied link to clipboard.":"Unable to copy link to clipboard.")}),this.actions.pipe((0,t.xi)(L.LD),(0,d.q)(Te=>this.copyToClipboard(Te.embed,"embed")),(0,j.Q)(this.ngUnsubscribe)).subscribe(Te=>{this.snackBar.open(Te?"Successfully copied embed code to clipboard.":"Unable to copy embed code to clipboard.")}),this.actions.pipe((0,t.xi)(L._T),(0,j.Q)(this.ngUnsubscribe)).subscribe(()=>{this.snackBar.open("Unable to generate embed code.")})}setupEmbedForm(){const Te=this.formEmbed.get("options"),Me=this.formEmbed.get("dimensions"),De=this.formEmbed.get("loader"),Ne=this.formEmbed.get("rotate"),He=this.formEmbed.get("initial"),st=this.formEmbed.get("disableScroll"),it=Te.get("uiMenu"),ut=this.formEmbed.get("autoLoad"),mt=this.formEmbed.get("playthrough"),St=De.get("enabled"),ft=De.get("mode");St.valueChanges.pipe((0,j.Q)(this.ngUnsubscribe)).subscribe(we=>{ft.patchValue(we?pe.ij:pe.aD.None)}),ft.valueChanges.pipe((0,j.Q)(this.ngUnsubscribe)).subscribe(we=>{Te.patchValue({uiLoader:we}),we!==pe.aD.None&&St.patchValue(!0,{emitEvent:!1})});const ht=Ne.get("enabled"),Lt=Ne.get("value");ht.valueChanges.pipe((0,j.Q)(this.ngUnsubscribe)).subscribe(we=>{we?Lt.patchValue("number"==typeof Lt.value?Lt.value:this.defaultWidgetOptions.loadRotate):Te.patchValue({loadRotate:null})}),Lt.valueChanges.pipe((0,j.Q)(this.ngUnsubscribe)).subscribe(we=>{Te.patchValue({loadRotate:we})}),ut.valueChanges.pipe((0,j.Q)(this.ngUnsubscribe)).subscribe(we=>{Te.patchValue({autoLoad:we})}),mt.valueChanges.pipe((0,j.Q)(this.ngUnsubscribe)).subscribe(we=>{Te.patchValue({playthrough:we})}),He.get("enabled").valueChanges.pipe((0,j.Q)(this.ngUnsubscribe)).subscribe(we=>{He.patchValue({mode:we?"button":""})}),He.get("mode").valueChanges.pipe((0,j.Q)(this.ngUnsubscribe)).subscribe(we=>{He.patchValue({enabled:!!we},{emitEvent:!1}),Te.patchValue({initial:{button:"button"===we,handHint:"handHint"===we,play:"play"===we,summary:"summary"===we}})}),st.get("enabled").valueChanges.pipe((0,j.Q)(this.ngUnsubscribe)).subscribe(we=>{st.patchValue({mode:we?"alert":""})}),st.get("mode").valueChanges.pipe((0,j.Q)(this.ngUnsubscribe)).subscribe(we=>{st.patchValue({enabled:!!we},{emitEvent:!1}),Te.patchValue({disableScroll:{alert:"alert"===we,overlay:"overlay"===we}})}),Me.valueChanges.pipe((0,V.B)(300),(0,j.Q)(this.ngUnsubscribe)).subscribe(we=>{this.setScreenDimensions(we)}),this.dimensions$.pipe((0,j.Q)(this.ngUnsubscribe)).subscribe(we=>{Me.setValue(we,{emitEvent:!1})}),Te.valueChanges.pipe((0,j.Q)(this.ngUnsubscribe)).subscribe(we=>{this.writeEmbedOptions(we)}),Te.valueChanges.pipe((0,N.Z)(Te.value),(0,M.F)((we,vt)=>(0,Q.isEqual)(we,vt)),(0,j.Q)(this.ngUnsubscribe)).subscribe(we=>{const{uiMenu:vt,uiTools:Ss,uiSearch:vs,uiVisibilityLayers:Cn,uiSkinLayers:On,uiWhiteboard:xn,uiHelp:un}=we,Wt=[Ss,vs,xn,un],Pn=[On,Cn];this.hasVisibilityLayers()&&Wt.push(Cn),this.hasSkinLayers()&&Wt.push(On);const Mn=Wt.length,Ut=Wt.filter(Zt=>Zt).length,Dn=Ut>0&&Ut!==Mn;0===Ut&&vt&&it.setValue(!1,{emitEvent:!1}),Dn&&!vt&&it.setValue(!0,{emitEvent:!1}),this.uiMenuIndeterminate=Dn;const In=Pn.some(Zt=>Zt),Gn=Pn.every(Zt=>Zt);this.uiLayersEnabled.setValue(In,{emitEvent:!1}),this.uiLayersIndeterminate=In&&!Gn,this.changeDetectorRef.markForCheck()}),this.uiLayersEnabled.valueChanges.pipe((0,j.Q)(this.ngUnsubscribe)).subscribe(we=>{Te.patchValue({uiVisibilityLayers:we,uiSkinLayers:we})}),it.valueChanges.pipe((0,j.Q)(this.ngUnsubscribe)).subscribe(we=>{Te.patchValue({uiTools:we,uiSearch:we,uiVisibilityLayers:we,uiSkinLayers:we,uiWhiteboard:we,uiHelp:we})}),this.formEmbed.valueChanges.pipe((0,V.B)(100),(0,M.F)((we,vt)=>(0,Q.isEqual)(we,vt)),(0,j.Q)(this.ngUnsubscribe)).subscribe(()=>{this.widgetEmbedSettings=this.getEmbedPublishOptions(),this.changeDetectorRef.markForCheck()})}handleGenerateIFrame(){this.generateIFrameCode()}handleGenerateURL(){this.generateURL()}handleEmbedClick(){this.setEmbedFormDefaults()}handleHideAllEmbedUIClick(){const Me={...this.formEmbed.value.options,uiAnatomyLabels:!1,uiInfo:!1,uiAudio:!1,uiMedia:ce.Y.None,uiNav:!1,uiTools:!1,uiUndo:!1,uiMenu:!1,uiSearch:!1,uiVisibilityLayers:!1,uiSkinLayers:!1,uiWhiteboard:!1,uiFullscreen:!1,uiHelp:!1};this.formEmbed.patchValue({options:Me}),this.formEmbed.markAsDirty()}handleViewerSizeMenuOpened(Te){const Me=this.publishOptionsEl.nativeElement,{offsetWidth:De,clientWidth:Ne}=Me,st=Ne-(De-Ne),it=document.querySelector(`#${Te.menu.panelId}`);this.renderer2.setStyle(it,"width",`${st}px`),this.renderer2.setStyle(it,"max-width","100vw")}handleToggleAccordionClick(){this.accordionExpanded?this.embedAccordion.closeAll():this.embedAccordion.openAll()}handleViewerSizeClick(Te){this.selectedAspectRatio={...Te},this.formEmbed.patchValue({aspectRatio:{width:Te.dimensions.width,height:Te.dimensions.height}})}handleSaveClick(){this.submit.next()}hasVisibilityLayers(){return this.publishWidget.allVisibilityLayers.some(Te=>Array.isArray(Te)&&Te.length>0)}hasSkinLayers(){return!(0,Q.isEmpty)(this.publishWidget.variantSchemas.skin)}setScreenDimensions(Te){this.store.dispatch(new L.LI(Te))}generateIFrameCode(){const{options:Te,dimensions:Me}=this.getEmbedPublishOptions();this.store.dispatch(new L.kS(this.modelToPublish,Te,null,Me))}generateURL(){this.store.dispatch(new L.D4(this.modelToPublish,this.formEmbed.value.options))}handleCopySuccess(Te){this.snackBar.open(`"${Te.newBookmark.title}" saved to your library.`),this.requiresSave=!1,this.modelToPublish=Te.newBookmark}handleCopyFailure(){this.snackBar.open("There was an error adding to your library")}copyToClipboard(Te,Me){return this.clipboardService.copyToClipboard(Te,Me).pipe((0,d.q)(De=>(0,q.of)(De)))}onDebouncedSubmit(){const Te=this.model,Me={isOwner:!0,id:Te?Te.id:null,title:Te.title},De=this.store.selectSnapshot(y.k.getUserLanguage);this.store.dispatch(new D.eW(Me.id,Me.title,Te.type,De))}setEmbedFormDefaults(){this.formEmbed.reset(this.defaultEmbedFormValues),this.formEmbed.markAsPristine(),this.changeDetectorRef.markForCheck()}getEmbedFormDefaults(){const Te=new C.$,{dimensions:Me,aspectRatio:De}=E.f,{button:Ne,handHint:He,play:st,summary:it}=Te.initial,{alert:ut,overlay:mt}=Te.disableScroll;return{viewerSizeType:Z.M.Responsive,dimensions:{width:Me.width,height:Me.height},aspectRatio:{width:De.width,height:De.height},options:Te,loader:{enabled:Te.uiLoader!==pe.aD.None,mode:Te.uiLoader},rotate:{enabled:null!==Te.loadRotate,value:Te.loadRotate},autoLoad:Te.autoLoad,playthrough:Te.playthrough,initial:{enabled:Te.autoLoad&&(Ne||He||st||it),mode:Ne?"button":He?"handHint":st?"play":it?"summary":""},disableScroll:{enabled:ut||mt,mode:ut?"alert":mt?"overlay":""}}}getWidgetOptions(){const Te=this.readEmbedOptions(),Me=this.store.selectSnapshot(o.q.getWidgetOptions);return Te?{...this.publishService.extendWidgetOptions(new C.$,Te),background:Me?Me.background:null,uiAudio:this.defaultWidgetOptions.uiAudio}:Me||new C.$}readEmbedOptions(){!function le(Be,Te){const Me=localStorage.getItem(W.UT.WidgetOptions);if(null===Me)return;const De=JSON.parse(Me);if(void 0!==De[Be]&&(De[Be].timestamp||0)<Te){delete De[Be];try{localStorage.setItem(W.UT.WidgetOptions,JSON.stringify(De))}catch{}}}(this.getStorageKey(),1573675067505);const De=this.storageService.getLocalJSON(W.UT.WidgetOptions);return De?De[this.getStorageKey()]:null}writeEmbedOptions(Te){const Me={...Te};delete Me.uiQuiz;const De={...Me,timestamp:Date.now()},Ne=this.storageService.getLocalJSON(W.UT.WidgetOptions)||{};Ne[this.getStorageKey()]=De,this.storageService.setLocalItem(W.UT.WidgetOptions,Ne)}getStorageKey(){return this.store.selectSnapshot(y.k.getUserProfile).eid}getEmbedPublishOptions(){let Te;const Me=this.formEmbed.get("viewerSizeType").value;Te=this.formEmbed.get(Me===Z.M.Fixed?"dimensions":"aspectRatio");const De=this.formEmbed.value.options||{};return{dimensions:{width:Te.get("width").value,height:Te.get("height").value,type:Me},labelsEnabled:!0,labelScale:1,scalable:!0,backgroundColor:null,options:De}}}function gt(Be,Te){if(1&Be&&s.nrm(0,"app-publish",12),2&Be){const Me=s.XpG();s.Y8G("model",Me.bookmark)("device",Me.device)}}(Se=tt).\u0275fac=function(Te){return new(Te||Se)(s.rXU(t.il),s.rXU(t.En),s.rXU(e.D),s.rXU(W.n$),s.rXU($.W),s.rXU(r.o),s.rXU(ie.J),s.rXU(H.UG),s.rXU(v.ze),s.rXU(s.gRc),s.rXU(s.sFG))},Se.\u0275cmp=s.VBU({type:Se,selectors:[["app-publish"]],viewQuery:function(Te,Me){if(1&Te&&(s.GBs(ne.B,7),s.GBs(Le,5),s.GBs(Re,5,T.z8),s.GBs(ae,5),s.GBs(U.kk,5)),2&Te){let De;s.mGM(De=s.lsd())&&(Me.publishWidget=De.first),s.mGM(De=s.lsd())&&(Me.publishOptionsEl=De.first),s.mGM(De=s.lsd())&&(Me.embedAccordion=De.first),s.mGM(De=s.lsd())&&(Me.accordionItems=De),s.mGM(De=s.lsd())&&(Me.items=De)}},inputs:{model:"model",device:"device"},decls:112,vars:42,consts:[["publishOptionsEl",""],["embedAccordion","cdkAccordion"],["rotate",""],["saveTemplate",""],["publishWidget",""],["trigger","matMenuTrigger"],["viewerSizes","matMenu"],[1,"publish","theme-light"],[1,"flex","justify-end","mb-3","publish__mode"],["type","button","app-button","","buttonSize","sm","buttonType","text","buttonTheme","light","buttonAlign","left","data-test","publishAccordionButton",1,"text-xs",3,"click","uppercase"],[1,"ml-2",3,"icon"],["data-test","publishOptions",1,"text-xs","publish__options",3,"formGroup"],[3,"multi"],[3,"title","expanded",4,"ngIf"],[3,"title"],[1,"publish__flex-group"],["formControlName","viewerSizeType",1,"flex","flex-row","w-full"],[1,"flex-auto",3,"value"],[1,"flex-auto","mr-2",3,"value"],[1,"mt-2",3,"ngSwitch"],[4,"ngSwitchCase"],[1,"publish__input-group"],[1,"flex","items-center"],["formControlName","autoLoad"],["icon","info-circle","matTooltip","If you uncheck this, your 3D model won't load automatically, but page load time will improve.",1,"ml-2","publish__info-icon"],["formGroupName","rotate",1,"publish__input-group"],["formControlName","enabled"],["class","mb-3 ml-6",4,"ngIf"],["formGroupName","options"],["formControlName","uiTutorial"],["formGroupName","initial",1,"mt-2"],["label","3d Interaction Prompt","theme","light","display","block",3,"isCompact"],["formControlName","mode",1,"input"],["value","button",1,"my-1"],["value","handHint",1,"my-1"],["value","play",1,"my-1"],["value","summary",1,"my-1"],["value","",1,"my-1"],["formGroupName","options",1,"publish__input-group"],["formControlName","uiAnatomyLabels"],["class","ml-6",4,"ngIf"],["formControlName","uiInfo"],["formControlName","uiAudio"],[1,"mt-2"],["label","ANIMATION CONTROLS","theme","light","display","block",3,"isCompact"],["formControlName","uiMedia",1,"mt-1","input"],[3,"value"],["formGroupName","options",1,"flex","flex-col","gap-5"],["label","Upper Left","theme","light","display","block",3,"uppercase","labelElement","isCompact"],["formControlName","uiTools"],["formControlName","uiSearch"],[4,"ngIf"],["formControlName","uiWhiteboard"],["formControlName","uiHelp"],["formControlName","uiUndo"],["label","Bottom right","theme","light","display","block",3,"uppercase","labelElement","isCompact"],["formControlName","uiNav"],["formControlName","uiFullscreen"],[1,"px-2","py-6"],["type","button","app-button","","buttonType","outline","buttonTheme","light",1,"w-full",3,"click"],["type","button","class","w-full mt-3","app-button","","buttonType","outline","buttonTheme","light","data-test","publishResetEmbed",3,"click",4,"ngIf"],["href","https://support.biodigital.com/hc/en-us/articles/225773768-Publish-a-3D-model","target","_blank",1,"underline","text-link"],["data-test","publishActions",1,"publish__actions"],[4,"ngIf","ngIfElse"],[1,"publish__embed"],["theme","light",3,"device","model","options"],[3,"title","expanded"],[3,"formGroup"],["formControlName","locked","data-test","quizLocked"],["class","mt-2 ml-6","formGroupName","options","data-test","quizOptions",4,"ngIf"],[1,"mt-5"],["href","https://support.biodigital.com/hc/en-us/articles/6204568025495-View-Modes-for-3D-quizzes#h_01FR8MPPCA3WTZRHVV17H5AYRF","target","_blank",1,"underline","text-link"],["formGroupName","options","data-test","quizOptions",1,"mt-2","ml-6"],["formControlName","mode",1,"flex","flex-col"],["value","all","data-test","quizOptionsAll"],["value","single","data-test","quizOptionsSingle"],["formControlName","number","data-test","quizOptionsNumber",1,"w-1/3","ml-3","input"],[3,"value",4,"ngFor","ngForOf"],["app-button","","buttonType","outline","buttonTheme","light","buttonAlign","left",1,"w-full","mt-1",3,"menuOpened","uppercase","matMenuTriggerFor"],[1,"flex","flex-row","justify-between"],["icon","caret-down",1,"ml-1"],["mat-menu-item","",3,"click",4,"ngFor","ngForOf"],["class","items-baseline justify-between mt-3 publish__flex-group","formGroupName","aspectRatio",4,"ngIf"],["type","info","theme","light",1,"flex","mt-4"],["href","https://support.biodigital.com/hc/en-us/articles/9838935675287#h_01GTZYQ3XJY31JH00F5A8C7H4K","target","_blank",1,"underline","text-link"],[1,"pt-4"],["href","https://support.biodigital.com/hc/en-us/articles/9838935675287","target","_blank",1,"underline","text-link"],["mat-menu-item","",3,"click"],["formGroupName","aspectRatio",1,"items-baseline","justify-between","mt-3","publish__flex-group"],[1,"sr-only"],["theme","light","display","block",1,"flex-auto",3,"isCompact"],["type","number","formControlName","width","min","1","appAutoFocus","",1,"w-full","publish__input","input"],["form-field-help",""],[1,"mx-4","text-sm"],["type","number","formControlName","height","min","1",1,"w-full","publish__input","input"],["formGroupName","dimensions","label","Size",4,"ngIf"],["formGroupName","dimensions","label","Size"],["class","items-baseline justify-between publish__flex-group",4,"ngIf"],[1,"items-baseline","justify-between","publish__flex-group"],["theme","light","display","block",1,"w-1/2",3,"isCompact"],["type","number","formControlName","width",1,"w-full","publish__input","input",3,"min"],["type","number","formControlName","height",1,"w-full","publish__input","input",3,"min"],[1,"mb-3","ml-6"],["label","Degree of Rotation","theme","light",3,"isCompact"],["type","number","formControlName","value",1,"w-1/2","publish__input","input"],[1,"ml-6"],["formControlName","uiAnatomyDescriptions"],["formControlName","uiAnatomyPronunciations"],["formControlName","uiLabelList"],[3,"formControl","indeterminate"],[1,"ml-6","publish__input-group"],["formControlName","uiVisibilityLayers"],["formControlName","uiSkinLayers"],["type","button","app-button","","buttonType","outline","buttonTheme","light","data-test","publishResetEmbed",1,"w-full","mt-3",3,"click"],["class","py-2 mt-2 mb-2 text-xs",4,"ngIf"],[1,"publish__actions-content"],["app-button","","buttonType","primary","buttonTheme","light","data-test","copyEmbed3D",1,"w-full",3,"click","disabled"],["app-button","","buttonType","outline","buttonTheme","light","data-test","copyURL3D",1,"w-full",3,"click","disabled"],[1,"py-2","mt-2","mb-2","text-xs"],[1,"font-semibold"],["class","p-2 mt-2 mb-2 text-xs font-light",4,"ngIf"],["app-button","","buttonType","primary","buttonTheme","light","data-test","saveToMyLibrary",1,"w-full",3,"click","disabled"],["size","medium","class","ml-2","render","inline",4,"ngIf"],[1,"p-2","mt-2","mb-2","text-xs","font-light"],["size","medium","render","inline",1,"ml-2"]],template:function(Te,Me){if(1&Te){const De=s.RV6();s.j41(0,"div",7)(1,"div",8)(2,"button",9),s.bIt("click",function(){return s.eBV(De),s.Njj(Me.handleToggleAccordionClick())}),s.EFF(3),s.nrm(4,"app-icon",10),s.k0s()(),s.j41(5,"div",11,0)(7,"cdk-accordion",12,1),s.DNE(9,ze,8,4,"app-accordion-item",13),s.j41(10,"app-accordion-item",14)(11,"div",15)(12,"mat-radio-group",16)(13,"mat-radio-button",17),s.EFF(14,"Responsive"),s.k0s(),s.j41(15,"mat-radio-button",18),s.EFF(16,"Fixed"),s.k0s()()(),s.j41(17,"div",19),s.DNE(18,rt,18,5,"div",20)(19,Xe,3,3,"div",20),s.k0s()(),s.j41(20,"app-accordion-item",14)(21,"fieldset",21)(22,"div",22)(23,"mat-checkbox",23),s.EFF(24,"Load 3D model automatically"),s.k0s(),s.nrm(25,"app-icon",24),s.k0s(),s.j41(26,"div",25)(27,"mat-checkbox",26,2),s.EFF(29,"Rotate 3D model on load"),s.k0s(),s.DNE(30,ye,3,2,"div",27),s.k0s(),s.j41(31,"div",28)(32,"mat-checkbox",29),s.EFF(33,"Launch tutorial on load"),s.k0s()(),s.j41(34,"div",30)(35,"app-form-field",31)(36,"select",32)(37,"option",33),s.EFF(38,"Show button"),s.k0s(),s.j41(39,"option",34),s.EFF(40,"Show animated hand"),s.k0s(),s.j41(41,"option",35),s.EFF(42,"Show play button"),s.k0s(),s.j41(43,"option",36),s.EFF(44,"Show summary"),s.k0s(),s.j41(45,"option",37),s.EFF(46,"Do not show prompt"),s.k0s()()()()()(),s.j41(47,"app-accordion-item",14)(48,"fieldset",38)(49,"mat-checkbox",39),s.EFF(50,"Show label when anatomy is selected"),s.k0s(),s.DNE(51,Ce,5,0,"div",40),s.k0s()(),s.j41(52,"app-accordion-item",14)(53,"fieldset",38)(54,"mat-checkbox",41),s.EFF(55,"Show Information Panel"),s.k0s(),s.DNE(56,xe,3,0,"div",40),s.k0s()(),s.j41(57,"app-accordion-item",14)(58,"fieldset",38)(59,"mat-checkbox",42),s.EFF(60,"Show audio controls when available"),s.k0s(),s.j41(61,"div",43)(62,"app-form-field",44)(63,"select",45)(64,"option",46),s.EFF(65,"Show all (play/pause button & scrubber)"),s.k0s(),s.j41(66,"option",46),s.EFF(67,"Only show play/pause button"),s.k0s(),s.j41(68,"option",46),s.EFF(69,"Do not show"),s.k0s()()()()()(),s.j41(70,"app-accordion-item",14)(71,"fieldset",47)(72,"app-form-field",48)(73,"ul",21)(74,"li")(75,"mat-checkbox",49),s.EFF(76,"Selection tools (select, hide, fade)"),s.k0s()(),s.j41(77,"li")(78,"mat-checkbox",50),s.EFF(79,"Anatomy search"),s.k0s()(),s.DNE(80,ct,6,4,"li",51),s.j41(81,"li")(82,"mat-checkbox",52),s.EFF(83,"Draw"),s.k0s()(),s.j41(84,"li")(85,"mat-checkbox",53),s.EFF(86,"Help"),s.k0s()(),s.j41(87,"li")(88,"mat-checkbox",54),s.EFF(89,"Undo, redo, reset"),s.k0s()()()(),s.j41(90,"app-form-field",55)(91,"ul",21)(92,"li")(93,"mat-checkbox",56),s.EFF(94,"3D navigation controls"),s.k0s()(),s.j41(95,"li")(96,"mat-checkbox",57),s.EFF(97,"Fullscreen"),s.k0s()()()()()()(),s.j41(98,"div",58)(99,"button",59),s.bIt("click",function(){return s.eBV(De),s.Njj(Me.handleHideAllEmbedUIClick())}),s.EFF(100," Hide All UI "),s.k0s(),s.DNE(101,dt,2,0,"button",60),s.k0s(),s.j41(102,"div",58)(103,"a",61),s.EFF(104," Learn about publishing 3D Embeds "),s.k0s()()(),s.j41(105,"div",62),s.DNE(106,Fe,8,4,"div",63)(107,Oe,11,15,"ng-template",null,3,s.C5r),s.k0s(),s.j41(109,"div",64),s.nrm(110,"app-embed-viewer",65,4),s.k0s()()}if(2&Te){const De=s.sdS(8),Ne=s.sdS(28),He=s.sdS(108);s.R7$(2),s.Y8G("uppercase",!1),s.BMQ("aria-controls",De.id)("aria-expanded",Me.accordionExpanded),s.R7$(),s.SpI(" ",Me.accordionExpanded?"Collapse all":"Expand all"," "),s.R7$(),s.Y8G("icon",Me.accordionExpanded?"minus-square":"plus-square"),s.R7$(),s.Y8G("formGroup",Me.formEmbed),s.R7$(2),s.Y8G("multi",!0),s.BMQ("id",De.id),s.R7$(2),s.Y8G("ngIf",Me.quizQuestions.length>0),s.R7$(),s.Y8G("title","Viewer Size"),s.R7$(2),s.BMQ("aria-label","Image Size"),s.R7$(),s.Y8G("value",Me.viewerSizeTypeEnum.Responsive),s.R7$(2),s.Y8G("value",Me.viewerSizeTypeEnum.Fixed),s.R7$(2),s.Y8G("ngSwitch",Me.viewerSizeType),s.R7$(),s.Y8G("ngSwitchCase",Me.viewerSizeTypeEnum.Responsive),s.R7$(),s.Y8G("ngSwitchCase",Me.viewerSizeTypeEnum.Fixed),s.R7$(),s.Y8G("title","Loading Experience"),s.R7$(10),s.Y8G("ngIf",Ne.checked),s.R7$(5),s.Y8G("isCompact",!0),s.R7$(12),s.Y8G("title","Anatomy Labels"),s.R7$(4),s.Y8G("ngIf",Me.widgetOptionsValues.uiAnatomyLabels),s.R7$(),s.Y8G("title","Information Panel"),s.R7$(4),s.Y8G("ngIf",Me.widgetOptionsValues.uiInfo),s.R7$(),s.Y8G("title","Media Controls"),s.R7$(5),s.Y8G("isCompact",!0),s.R7$(2),s.Y8G("value",Me.mediaEnum.Full),s.R7$(2),s.Y8G("value",Me.mediaEnum.Small),s.R7$(2),s.Y8G("value",Me.mediaEnum.None),s.R7$(2),s.Y8G("title","Tools"),s.R7$(2),s.Y8G("uppercase",!0)("labelElement",!1)("isCompact",!0),s.R7$(8),s.Y8G("ngIf",Me.hasVisibilityLayers()||Me.hasSkinLayers()),s.R7$(10),s.Y8G("uppercase",!0)("labelElement",!1)("isCompact",!0),s.R7$(11),s.Y8G("ngIf",Me.formEmbed.dirty),s.R7$(5),s.Y8G("ngIf",!Me.requiresSave)("ngIfElse",He),s.R7$(4),s.Y8G("device",Me.device)("model",Me.model)("options",Me.widgetEmbedSettings)}},dependencies:[g.Sq,g.bT,g.ux,g.e1,J.So,Y.VT,Y._g,U.kk,U.fb,U.Cp,i.oV,v.xH,v.y7,v.me,v.Q0,v.wz,v.BC,v.cb,v.VZ,v.l_,v.j4,v.JD,v.$R,X.C,u.Q,se.B,oe.K,h.R,me.tI,ae,ne.B,T.z8,g.Jj],styles:['.publish[_ngcontent-%COMP%]{display:grid;grid-template-columns:320px auto;grid-template-rows:auto 1fr;column-gap:40px;height:100%;grid-template-areas:"mode embed" "options embed" "actions embed"}.publish__mode[_ngcontent-%COMP%]{grid-area:mode}.publish__options[_ngcontent-%COMP%]{grid-area:options;overflow:auto}.publish__screens[_ngcontent-%COMP%]{grid-area:screens;text-align:center}.publish__embed[_ngcontent-%COMP%]{grid-area:embed;background-color:#fff;overflow:auto;margin-top:44px}.publish__actions[_ngcontent-%COMP%]{border-top:1px solid #d7e0ea;position:relative;grid-area:actions}.publish__actions-content[_ngcontent-%COMP%]{padding:0;display:flex;flex-direction:column;gap:12px}.publish__group[_ngcontent-%COMP%]{display:grid;grid-template-columns:auto auto;column-gap:8px;align-items:center}.publish__flex-group[_ngcontent-%COMP%]{display:flex}.publish__input[_ngcontent-%COMP%]{font-size:.875rem;line-height:1.25rem}.publish__picker-group[_ngcontent-%COMP%]{display:flex;flex-direction:row;gap:12px}.publish__input-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:4px}.publish__info-icon[_ngcontent-%COMP%]{color:#96a8c0;font-size:1rem;line-height:1.5rem}'],changeDetection:0}),Ue([(0,t.l6)(E.F.getDimensions),je("design:type",B.c)],tt.prototype,"dimensions$",void 0),Ue([(0,t.l6)(E.F.getMinDimensions),je("design:type",B.c)],tt.prototype,"minDimensions$",void 0),Ue([(0,t.l6)(R.J.getCopying),je("design:type",B.c)],tt.prototype,"copying$",void 0);let bt=(()=>{var Be;class Te{get device(){return this.form.value.device}constructor(De,Ne){this.dialogRef=De,this.deviceTypeEnum=P.k,this.form=new v.gE({device:new v.MJ(P.k.Desktop,[v.k0.required])}),this.bookmark=Ne.bookmark}closeDialog(){this.dialogRef.close()}}return(Be=Te).\u0275fac=function(De){return new(De||Be)(s.rXU(b.CP),s.rXU(b.Vh))},Be.\u0275cmp=s.VBU({type:Be,selectors:[["app-publish-dialog"]],decls:13,vars:7,consts:[["data-test","publishDialog","role","dialog","aria-modal","true",1,"publish",3,"formGroup"],[1,"publish__header"],[1,"publish__heading"],[1,"flex","justify-center","flex-auto"],["formControlName","device","display","inline","size","medium"],["tooltip","Desktop View","icon","desktop-alt",3,"value"],["tooltip","Tablet View","icon","tablet-alt",3,"value"],["tooltip","Phone View","icon","mobile-alt",3,"value"],[1,"publish__contents"],[3,"model","device",4,"ngIf"],["app-button","","buttonType","text","buttonTheme","light","type","button","title","Close",1,"publish__close",3,"click"],["icon","times","size","lg"],[3,"model","device"]],template:function(De,Ne){1&De&&(s.j41(0,"div",0)(1,"div",1)(2,"h2",2),s.EFF(3,"Publish"),s.k0s(),s.j41(4,"div",3)(5,"app-toggle-group",4),s.nrm(6,"app-toggle-group-item",5)(7,"app-toggle-group-item",6)(8,"app-toggle-group-item",7),s.k0s()()(),s.j41(9,"div",8),s.DNE(10,gt,1,2,"app-publish",9),s.k0s(),s.j41(11,"button",10),s.bIt("click",function(){return Ne.closeDialog()}),s.nrm(12,"app-icon",11),s.k0s()()),2&De&&(s.Y8G("formGroup",Ne.form),s.BMQ("aria-label","Publish"),s.R7$(6),s.Y8G("value",Ne.deviceTypeEnum.Desktop),s.R7$(),s.Y8G("value",Ne.deviceTypeEnum.Tablet),s.R7$(),s.Y8G("value",Ne.deviceTypeEnum.Mobile),s.R7$(2),s.Y8G("ngIf",Ne.bookmark),s.R7$(),s.BMQ("aria-label","Close"))},dependencies:[g.bT,v.BC,v.cb,v.j4,v.JD,u.Q,h.R,A,f,tt],styles:["a[_ngcontent-%COMP%]{color:#de3535}a[_ngcontent-%COMP%]:hover{color:#c11f1f}.publish[_ngcontent-%COMP%]{position:relative;padding:24px}.publish__header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;height:40px}.publish__heading[_ngcontent-%COMP%]{flex:0 1 320px;font-size:1.25rem;line-height:1.75rem;font-weight:600}.publish__contents[_ngcontent-%COMP%]{height:calc(100vh - 216px)}.publish__close[_ngcontent-%COMP%]{position:absolute;top:24px;right:24px;color:#283853}.publish__close[_ngcontent-%COMP%]:hover{color:#1c2a3f}"],changeDetection:0}),Te})();var qe=n(93844),Ot=n(40634),_t=n(24418),Ft=n(92811),Rt=n(27180),Pt=n(26629),jt=n(84370),yt=n(7213),Qt=n(39596),Gt=n(79898),wt=n(58832),Dt=n(59e3),zt=n(71120),Kt=n(30234),kt=n(63181),Jt=n(38645),Yt=n(99327);const tn=[qe.t9.View,qe.t9.Edit],nn=[qe.t9.Edit,qe.t9.Publish];let sn=(()=>{var Be;class Te{constructor(De,Ne,He,st,it,ut,mt,St,ft,ht,Lt,we,vt){this.store=De,this.publishService=Ne,this.dialogService=He,this.storageService=st,this.dialog=it,this.snackbar=ut,this.router=mt,this.bookmarksService=St,this.breakpointObserver=ft,this.clipboardService=ht,this.userAccessService=Lt,this.vendorAnalyticsService=we,this.shareService=vt}getBookmarkActions(De,Ne,He,st,it){if((0,Q.isNil)(Ne)||this.bookmarksService.isZSpaceModel(Ne)&&_t.c.application!==Rt.c.Loft)return[];const ut=Ne.tags||[],mt=yt.dE(De,Ne),St=ut.includes("public")&&!mt?te.c.Module:Ne.type,ft=this.getBookmarkShareActions(Ne,St);let ht=[];switch(St){case te.c.Module:ht=[qe.t9.AddToMyLibrary,qe.t9.Edit,...ft],yt.Cy(Ne)&&ht.push(qe.t9.Manage);break;case te.c.Bookmark:ht=[qe.t9.Edit,...ft,qe.t9.Manage,qe.t9.Duplicate,qe.t9.Delete]}ht=ht.filter(vt=>{if(_t.c.application===Rt.c.Loft&&!tn.includes(vt)||it&&it.excludeActions&&it.excludeActions.includes(vt)||it&&it.includeActions&&!it.includeActions.includes(vt))return!1;switch(vt){case qe.t9.View:return yt.$Z();case qe.t9.Edit:return yt.OS(De);case qe.t9.Delete:return yt.M8(De,Ne);case qe.t9.Duplicate:return yt.Ie(De,Ne);case qe.t9.AddToMyLibrary:return yt.c8(De,Ne);case qe.t9.Manage:return yt.WV(De,Ne);case qe.t9.CopyURL:return yt.XP(De,Ne,He,st);case qe.t9.Share:return(st?[te.c.Module]:[te.c.Module,te.c.Bookmark]).includes(Ne.type);case qe.t9.Publish:return yt.yq(De);default:return!0}});const Lt=this.breakpointObserver.isMatched("(max-width: 959px)"),we=[qe.t9.Edit,qe.t9.Publish,qe.t9.Manage];return(Lt||_t.c.platform!==Ft.N.Web)&&(ht=ht.filter(vt=>!we.includes(vt))),_t.c.native&&(ht=ht.filter(vt=>!nn.includes(vt))),ht}getBookmarkPrimaryActionLabel(De,Ne){let He="Select";if(Ne===Gt.g.Select)He="Select";else if(Ne===Gt.g.Import)He="Import";else{const st=De.viewMode??wt._.All;let it=De.tour?"View Tour":"View";this.bookmarksService.isZSpaceModel(De)&&this.storageService.getLocalItem(W.UT.ZSpaceDevice)&&(it=`${it} in XR`);let ut=De.quiz?"Take Quiz":"";switch(st){case wt._.Content:ut="";break;case wt._.Quiz:De.quiz&&(it="")}He=it||ut}return He}handleBookmarkAction(De){const Ne=De.bookmark;switch(De.name){case qe.t9.View:this.view(Ne);break;case qe.t9.Edit:this.edit(Ne);break;case qe.t9.Manage:this.manage(Ne);break;case qe.t9.Delete:this.delete(Ne);break;case qe.t9.CopyURL:{let He;this.generateBookmarkLink(Ne).pipe((0,d.q)(st=>(He=st,this.clipboardService.copyToClipboard(st,"url")))).subscribe(st=>{st&&this.snackbar.open("Successfully copied link to clipboard."),this.vendorAnalyticsService.track("Publish - Success",{type:"url",source:"bookmark-action"})});break}case qe.t9.Duplicate:this.duplicate(Ne);break;case qe.t9.AddToMyLibrary:this.addToMyLibrary(Ne);break;case qe.t9.Share:this.shareBookmark(Ne);break;case qe.t9.Publish:this.publish(Ne)}}edit(De){if(this.isPremiumRestrictedAction(qe.t9.Edit)){const He=this.store.selectSnapshot(y.k.getProfile);return void this.userAccessService.openEditPaywall(He).subscribe(()=>{})}const Ne=this.store.selectSnapshot(o.q.getOrganizationAddOns);yt.dl(Ne)?this.router.navigate(["/edit"],{queryParams:{id:De.id}}):this.userAccessService.openExternalAccountEditGate(Kt.a.WoltersKluwer).pipe((0,_.s)(1)).subscribe()}generateBookmarkLink(De){const Ne=this.store.selectSnapshot(o.q.getWidgetOptions)||new C.$,He=this.store.selectSnapshot(E.F.getWidgetURL),st=this.store.selectSnapshot(y.k.getUserLanguage),it=this.store.selectSnapshot(y.k.getSelectedUserApp),ut=this.store.selectSnapshot(o.q.getSelectedOrganizationProductAccountId);return this.publishService.generateWidgetURL(De,He,Ne,null,e.Q.Single,st,it,ut)}delete(De){return this.dialog.open(kt.Y,{id:jt.t.BulkDeleteModelDialog,data:{bookmarks:[De]}})}manage(De,Ne=Pt.V.Manage){const He={id:jt.t.SaveBookmarkDialog,data:{bookmark:De,mode:Ne}};return this.dialog.closeAll(),this.dialog.open(Pt.f,He)}view(De,Ne={}){const{id:He,title:st}=De,it=this.store.selectSnapshot(y.k.getUserLocale).lang,ut=this.publishService.isCustomWidget(De.embed_url_path),mt=this.bookmarksService.isZSpaceModel(De),St=this.storageService.getLocalItem(W.UT.ZSpaceDevice),ft={id:He,lang:it,...Ne};if(De.unavailable)this.snackbar.open(`Error opening "${st}", it is unavailable.`);else if(ut){const ht=this.publishService.getWidgetURL(De,De.embed_url,new C.$);window.open(ht)?this.snackbar.open(`"${st}" loaded in a new tab.`):this.snackbar.open(`Error launching "${st}" in a new tab.`)}else if(mt&&St){const ht=this.publishService.buildWidgetURL("zspace-viewer",ft);window.open(ht)}else this.router.navigate(["/view"],{queryParams:ft})}viewQuiz(De){this.view(De,{quiz:!0})}shareBookmark(De){const Ne=this.store.selectSnapshot(y.k.getUserLanguage),He=this.shareService.generateShareLink(De,Ne);return!0===_t.c.native||_t.c.platform===Ft.N.SDK?(this.clipboardService.nativeShareLink(He),(0,q.of)(null)):this.dialogService.openShareDialog(He,"Share","Anyone with the link can view this 3D model. They will need to create an account for full acccess.").afterClosed()}publish(De){if(this.isPremiumRestrictedAction(qe.t9.Publish)){const Ne=this.store.selectSnapshot(y.k.getProfile);this.userAccessService.openPublishPaywall(Ne).subscribe(()=>{})}else this.dialog.open(bt,{width:"90vw",height:"95vh",panelClass:"bd-publish-dialog-panel",data:{bookmark:De}})}isPremiumRestrictedAction(De){const Ne=this.store.selectSnapshot(y.k.getUserProfile),He=!(0,Q.isNil)(Ne),st=this.store.selectSnapshot(y.k.isPremiumUser),it=this.store.selectSnapshot(o.q.hasOrganization),ut=st&&it;switch(De){case qe.t9.Publish:return!He||!ut;case qe.t9.Edit:case qe.t9.AddToMyLibrary:return!He;default:return!1}}duplicate(De){this.checkBookmarkLimit().subscribe(Ne=>{Ne.limit_reached?this.userAccessService.openBookmarkSaveLimit():this.manage(De,Pt.V.Duplicate)})}addToMyLibrary(De){if(this.isPremiumRestrictedAction(qe.t9.AddToMyLibrary)){const Ne=this.store.selectSnapshot(y.k.getProfile);this.userAccessService.openAddModelPaywall(Ne).subscribe(()=>{})}else this.checkBookmarkLimit().subscribe(Ne=>{Ne.limit_reached?this.userAccessService.openBookmarkSaveLimit():this.manage(De,Pt.V.Copy)})}checkBookmarkLimit(){return this.store.selectSnapshot(y.k.isPremiumUser)?(0,q.of)({limit_reached:!1}):this.bookmarksService.atMaxFreeBookmarkCount()}getBookmarkShareActions(De,Ne){if(Ne===te.c.Module){const ft=!(0,Q.isNil)(De.module_accessor_level);if(ft)return[qe.t9.Publish];if(!ft&&!0!==De.collection_content)return[qe.t9.Publish,qe.t9.Share]}const He=this.store.selectSnapshot(y.k.getUserRole),st=this.store.selectSnapshot(y.k.isPremiumUser),it=this.store.selectSnapshot(o.q.hasOrganization),ut=[];return yt.yq(He)&&ut.push(qe.t9.Publish),yt.XP(He,De,st,it)&&ut.push(qe.t9.CopyURL),!it&&Ne===te.c.Bookmark&&ut.push(qe.t9.Share),ut.length>0?[...ut]:[]}getBookmarkActionsGrouping(De){return{mainActions:De.slice(0,2),moreActions:De.slice(2)}}}return(Be=Te).\u0275fac=function(De){return new(De||Be)(s.KVO(t.il),s.KVO(e.D),s.KVO(r.o),s.KVO(W.n$),s.KVO(b.bZ),s.KVO(H.UG),s.KVO(Jt.Ix),s.KVO(Ot.x),s.KVO(Yt.QP),s.KVO($.W),s.KVO(Qt.p),s.KVO(Dt.e),s.KVO(zt.D))},Be.\u0275prov=s.jDH({token:Be,factory:Be.\u0275fac,providedIn:"root"}),Te})()},76549:(ge,F,n)=>{"use strict";n.d(F,{k:()=>v});var t=n(60177),e=n(65763),r=n(21523),o=n(89417),C=n(21604),E=n(45189),y=n(38645),d=n(40430),_=n(54438);let v=(()=>{var b;class P{}return(b=P).\u0275fac=function(g){return new(g||b)},b.\u0275mod=_.$C({type:b}),b.\u0275inj=_.G2t({imports:[e.rK.forFeature([r.J]),t.MD,E.G,o.X1,C.G,y.iI,d.i]}),P})()},40634:(ge,F,n)=>{"use strict";n.d(F,{x:()=>be});var t=n(21626),e=n(64346),r=n(19833),o=n(17365),C=n(36110),E=n(38399),y=n(28577),d=n(40470),_=n(45731),v=n(46104),b=n(45326),P=n(15877);class s{}var g=n(84426),u=n(21894),h=n(17766),S=n(49204),f=n(65763),m=n(22679),i=n(94495),c=n(16606),a=n(13517),l=function(de){return de.Private="private",de.Group="enterprise",de.Public="public",de}(l||{}),p=n(58832),A=n(79440),O=n(5690),L=n(16823),k=n(7213),q=n(53236),B=n(30234),j=n(27153),V=n(21424),M=n(17215),N=n(24418),W=n(27180),$=n(66432),ne=n(71217),Q=n(54438);const le=1e4,pe="/ws/user/bookmark/v4",ie={headers:new t.Lr({"Content-Type":"application/json; charset=utf-8"})};let be=(()=>{var de;class w{constructor(R,D,T,re,K,ae){this.store=R,this.http=D,this.serializeModuleService=T,this.storyService=re,this.productService=K,this.storageService=ae}getBookmarkData(R){return this.http.get(`/search/bookmarks/data?be=${R}`).pipe((0,e.l)(D=>D.pipe((0,r.c)(1e3),(0,o.s)(3))),(0,C.T)(D=>((D=D.bookmark).moduleId=D.customData?D.customData.moduleId:D.modules.activeModules[0],(0,d.bj)(s,D))))}getBookmarkModel(R){return this.http.get(`/ws/search/bookmarks?eid=${R}`).pipe((0,e.l)(D=>D.pipe((0,r.c)(1e3),(0,o.s)(3))),(0,C.T)(D=>(0,d.bj)(_.S,D.bookmark_info)),(0,C.T)(D=>(0,A.H)(D)))}getUserBookmarks(R,D="",T=le,re,K){const ae={q:D,page_size:`${T}`,ol:re};return(0,S.isNil)(K)||(ae.is_owner=""+(K?1:0)),this.http.get(`/ws/search/bookmarks/${R}`,{params:ae}).pipe((0,e.l)(ce=>ce.pipe((0,r.c)(1e3),(0,o.s)(3))),(0,C.T)(ce=>ce.map(U=>(0,d.bj)(_.S,U)).map(U=>(0,A.H)(U))))}getUserConditions(R,D="",T,re,K=le){let ae="";switch(R){case l.Private:ae="user";break;case l.Group:ae="group"}return this.http.get(`/ws/search/conditions/private?q=${D}&page_size=${K}&ol=${T}`).pipe((0,C.T)(ce=>ce.filter(U=>U.module_accessor_level===ae&&(!re||U.module_accessor_id===re))),(0,C.T)(ce=>(0,d.bj)(_.S,ce)),(0,C.T)(ce=>ce.map(U=>(0,A.H)(U))))}getPrivateBookmarks(R="",D,T=le){return this.getUserBookmarks(l.Private,R,T,D,!0)}getPrivateConditions(R="",D){return this.getUserConditions(l.Private,R,D)}getOrganizationBookmarks(R,D="",T=le,re){return this.getUserBookmarks(l.Private,D,T,re).pipe((0,C.T)(K=>K.filter(ae=>ae.tags.includes("enterprise")).filter(ae=>ae.group_access.some(ce=>ce.group_id===R))))}getOrganizationConditions(R,D="",T){return this.getUserConditions(l.Group,D,T,R)}getOrganizationContent(R,D="",T){return(0,v.p)([this.getOrganizationBookmarks(R,D,le,T),this.getOrganizationConditions(R,D,T)]).pipe((0,C.T)(([re,K])=>[...re,...K]))}getPrivateContent(R="",D){return(0,v.p)([this.getPrivateBookmarks(R,D),this.getPrivateConditions(R,D)]).pipe((0,C.T)(([T,re])=>[...T,...re]))}createBookmarkStory(R,D){return this.serializeModuleService.serialize({},new u.F,!1,{...this.store.selectSnapshot(m.t.getStory),displayName:R},this.store.selectSnapshot(i.N.getStoryChapters),D)}getPublicBookmarks(R="",D){return this.getUserBookmarks(l.Public,R,le,D)}saveBookmark(R){const D=this.getNormalizedBookmarkEntry(R);let T;return T=this.http.post(R.id?`${pe}/update`:`${pe}/save`,D,ie),T.pipe((0,E.q)(re=>this.getBookmarkModel(re.id)))}bulkCopyBookmarks(R){const{productType:D,productKey:T}=this.productService;return this.http.post("/ws/user/bookmark/bulk/copy",{version:1,app_producttype:D,app_productkey:T,source_content:R},ie)}getBookmarkJobs(R={}){const{productType:D,productKey:T}=this.productService;return this.http.get("/ws/user/jobs",{params:{version:1,app_producttype:D,app_productkey:T,...R}}).pipe((0,C.T)(re=>re?.jobs??[]))}cancelBookmarkJob(R){const{productType:D,productKey:T}=this.productService;return this.http.post("/ws/user/jobs/cancel",{version:1,app_producttype:D,app_productkey:T,job_id:R},ie)}deleteBookmark(R){return this.http.delete(`${pe}/delete`,{params:{eid:R,app_producttype:this.productService.productType,app_productkey:this.productService.productKey}}).pipe((0,y.W)(re=>{const K=(0,q.u1)(re);return(0,b.$)(()=>K)}))}bulkDeleteBookmarks(R){const{productType:D,productKey:T}=this.productService;return this.http.post("/ws/user/bookmark/bulk/delete",{version:1,app_producttype:D,app_productkey:T,eids:R},ie)}atMaxFreeBookmarkCount(){return this.http.get("/ws/user/content/limit/check?version=2").pipe((0,y.W)(R=>(0,P.of)({limit_reached:!1})))}filterByTags(R,D,T=!1){return R.filter(re=>T?D.every(K=>re.tags.includes(K)):D.some(K=>re.tags.includes(K)))}getTags(R){if(R){const D=[],T=this.store.selectSnapshot(L.k.getUserRole),re=k.dE(T,R),K=R.type===h.c.Bookmark&&!re;return this.isZSpaceModel(R)&&D.push(j.n3[B.a.Zspace]),K&&D.push("View Only"),R.animated&&D.push("Animated"),R.tour&&D.push("Tour"),R.quiz&&D.push("Quiz"),D}return[]}getCategories(R,D="en",T){const re=null!=T?(0,S.flatten)(T.map(ae=>(0,$.e7)(ae,D))):(0,$.QU)(D),K=[];return R.type===h.c.Module?(R.tags.forEach(ae=>{const ce=re.find(U=>U.id===ae);ce&&K.push(ce)}),K):null}isZSpaceModel(R){return!!(0,S.isArray)(R.tags)&&R.tags.includes(B.a.Zspace)}getZSpaceRestriction(){return N.c.application===W.c.Loft?B.O.None:!this.store.selectSnapshot(V.q.hasOrganization)||this.store.selectSnapshot(V.q.isSubscriptionExpired)?B.O.Subscription:"true"!==this.storageService.getLocalItem(M.UT.ZSpaceDevice)?B.O.Device:B.O.None}getShowcase(R,D,T="en"){const re=[];if(!(0,S.isNil)(R)&&R.type===ne.P.User){const K=this.getUserShowcase(T);re.push(K)}if(!(0,S.isNil)(D)){const K=this.getOrganizationShowcase(D,T);re.push(K)}return re.length?(0,v.p)(re):(0,P.of)([])}getUserShowcase(R="en"){return this.getPrivateBookmarks("",R,10).pipe((0,C.T)(D=>this.createPrivateShowcase(D)))}getOrganizationShowcase(R,D="en"){return this.getOrganizationBookmarks(R.id,"",10,D).pipe((0,C.T)(T=>this.createOrganizationShowcase(T,R)))}createMockBookmark(R){return{author:"",author_first_name:"",author_last_name:"",cost:0,create_date_time:new Date,description:"",id:"",is_owner:!0,last_editor:"",last_editor_first_name:"",last_editor_last_name:"",tags:[],thumbnail_url:"",title:"",update_date_time:new Date,type:h.c.Bookmark,...R?{animated:!0,tour:!0}:{}}}createMockBookmarks(R=5){return[...Array(R).keys()].map(D=>this.createMockBookmark(D%2==0))}createPrivateShowcase(R){return{title:"Pick up where you left off",description:"",url:"/results/bookmarks?type=Private",bookmarks:R}}createOrganizationShowcase(R,D){return{title:`Recently added to ${D.name}`,description:"Recently added models to your Team library.",url:`/results/bookmarks?organizationId=${D.id}&type=Organization`,bookmarks:R}}translateBookmark(R,D,T,re){const K=T===h.c.Module||T===h.c.Internal?D.replace(".json",""):D;return(0,v.p)([this.storyService.getStory(R,h.c.Bookmark),this.storyService.getStoryTranslation(K,T,re)]).pipe((0,C.T)(([ae,ce])=>this.storyService.translateStory(ae,ce)),(0,E.q)(ae=>this.saveBookmark({isOwner:!0,title:ae.displayName.substr(0,60),id:R,index:ae})),(0,C.T)(ae=>ae.id),(0,y.W)(ae=>404===ae.status?(0,P.of)(R):(0,b.$)(ae)))}getNormalizedBookmarkEntry(R){let D,T,re,K;if(R.isOwner){if(D=R.add_group_access?this.getGroupAccess(R.add_group_access):[],R.remove_group_access&&R.remove_group_access.forEach(ae=>{const ce=this.getNormalizeGroupAccess({group_id:ae.group_id,remove:!0});D.push(ce)}),T=this.getNormalizedBool(R.public_access),R.index){re={},R.index.chapters&&(re[a.x.UserGeneratedTour]=this.getNormalizedBool(R.index.chapters.length>1));const ae=(R.index.tags||[]).includes("animated");re[a.x.Animated]=this.getNormalizedBool(ae),re[a.x.ModeQuiz]=this.getNormalizedBool(R.viewMode===p._.Quiz),re[a.x.ModeContent]=this.getNormalizedBool(R.viewMode===p._.Content),re[a.x.Quiz]=this.getNormalizedBool(R.index?.quizSettings?.enabled??!1)}K=this.getNormalizedBool(R.is_content_copy)}return{eid:R.id,name:R.title,description:R.description,index:R.index,group_access:D,public_access:T,flags:re,is_content_copy:K,app_producttype:this.productService.productType,app_productkey:this.productService.productKey}}getGroupAccess(R){return R.map(D=>this.getNormalizeGroupAccess(D))}getNormalizeGroupAccess(R){const{group_id:D,group_name:T,member_edit:re,visible:K,remove:ae}=R;return{group_id:D,group_name:T,member_edit:this.getNormalizedBool(re),visibility:this.getNormalizedBool(K),remove:this.getNormalizedBool(ae)}}getNormalizedBool(R){return!0===R?"1":!1===R?"0":""}}return(de=w).\u0275fac=function(R){return new(R||de)(Q.KVO(f.il),Q.KVO(t.Qq),Q.KVO(g.g),Q.KVO(c.J),Q.KVO(O.b),Q.KVO(M.n$))},de.\u0275prov=Q.jDH({token:de,factory:de.\u0275fac,providedIn:"root"}),w})()},96728:(ge,F,n)=>{"use strict";n.d(F,{F:()=>y,He:()=>C,Ir:()=>t,MQ:()=>r,ZZ:()=>E,_z:()=>e,iU:()=>o});const t={label:"Relevance",fields:[],ascending:!0},e={label:"Most Recent",fields:["collection_content_createdate","update_date_time","create_date_time"],ascending:!1},r={label:"Title (A-Z)",fields:["title"],ascending:!0},o={label:"Title (Z-A)",fields:["title"],ascending:!1},C={label:"Author (A-Z)",fields:["author"],ascending:!0},E={label:"Author (Z-A)",fields:["author"],ascending:!1},y=[t,e,r,o,C,E]},74394:(ge,F,n)=>{"use strict";n.d(F,{Ht:()=>_,IZ:()=>S,L7:()=>C,NB:()=>E,Pg:()=>f,Ub:()=>h,Ue:()=>o,VM:()=>g,a:()=>d,iE:()=>y,oM:()=>v});const e={title:"Status",tags:["Live","obsolete"]},r={title:"Platform",tags:["web platform","ios platform","android platform"]},o={title:"Tags",tags:["Animated","Tour","Quiz","featured","new",n(30234).a.Zspace]},C={title:"Gender",tags:["male","female"]},E={title:"Pregnancy",tags:["First Trimester","Second Trimester","Third Trimester"]},y={title:"Regions",tags:["Head and Neck","Thorax","Abdomen","Back","Upper Limb","Pelvis","Lower Limb"]},d={title:"Type (Deprecated)",tags:["Anatomy","Disease","Pharmacology","Physiology","Procedure"]},_={title:"Type",tags:["Healthy Anatomy and Physiology","Conditions","Procedures and Treatments"]},v={title:"Level of Detail",tags:["Gross Anatomy","Tissue","Cellular","Molecular"]},b={title:"Anatomy Categories",tags:["complete anatomy","system","regional","Bony Landmarks","Cross Section","Cross Section and Micro Anatomy","Guided Anatomy","Micro Anatomy","Origins and Insertions"]},P={title:"Clinical Specialty",tags:["Allergy and Immunology","Cardiology","Dentistry","Dermatology","Endocrinology","Gastroenterology and Hepatology","Gynecology","Hematology","Infectious Disease","Nephrology","Neurology and Psychiatry","Obstetrics","Oncology","Ophthalmology","Orthopedics","Otolaryngology","Pediatrics","Physical Therapy","Primary Care","Pulmonology and Respiratory","Rheumatology","Urology"]},g={title:"Downloaded",tags:["Downloaded"]},h={title:"Permissions",tags:["My Models","View & Edit","View Only"]},S=[e,r,o,C,_,v,b,P,y,E,{title:"expert collections",tags:["Anatomy for Physical Therapy Students","Anatomy for Medical Students"]}],f=[e,r,o,C,_,d,v,b,P,g,h,y,E]},79440:(ge,F,n)=>{"use strict";n.d(F,{H:()=>e});var t=n(58832);function e(o){const{id:C,type:E}=o;if("module"===E&&(o.id=function r(o){return o.replace("Condition.content.","").replace(".json","").split(".").join("/")}(C)),o.tour=o.tags.includes("tour"),o.animated=o.tags.includes("animated"),o.quiz=o.tags.includes("quiz"),o.lowDefinition=o.tags.includes("low definition"),!o.viewMode){const y=Object.values(t._).find(d=>o.tags.includes(d));o.viewMode=y??t._.All}return o}},93844:(ge,F,n)=>{"use strict";n.d(F,{PR:()=>t,Qi:()=>r,bf:()=>o,t9:()=>e});class t{}var e=function(C){return C.View="View",C.Edit="Customize",C.Duplicate="Duplicate",C.Manage="Manage",C.Publish="Publish",C.Delete="Delete",C.CopyURL="Copy URL",C.Share="Share",C.AddToMyLibrary="Add to My Library",C}(e||{});const r={[e.View]:"",[e.AddToMyLibrary]:"plus",[e.Edit]:"wand-magic-sparkles",[e.Share]:"share-alt",[e.Publish]:"code",[e.CopyURL]:"link",[e.Duplicate]:"",[e.Manage]:"",[e.Delete]:""};function o(C){const E=C.substring(0,1).toUpperCase()+C.substring(1);return Object.values(e).reduce((y,d)=>(y[d]=d===e.Edit?`Customize in ${E}`:d,y),{})}},52394:(ge,F,n)=>{"use strict";n.d(F,{c:()=>t});var t=function(e){return e.Private="Private",e.TeamView="Team - View Only",e.TeamEdit="Team - View & Edit",e}(t||{})},55361:(ge,F,n)=>{"use strict";n.d(F,{EL:()=>d,h5:()=>y});var t=n(97948),e=n(49204);function E(_,v,b){const P=v.map(s=>_[s]).filter(s=>!(0,e.isNil)(s));return b?P.sort().shift():P.sort().pop()}function y(_,v,b){if(0===v.length)return _;const P=new Intl.Collator("en-US",{sensitivity:"base"});return _.sort((s,g)=>{const u=E(s,v,b)||"",h=E(g,v,b)||"";return(b?1:-1)*P.compare(u.toString(),h.toString())})}function d(_,v,b){return 0===_.sortBy.fields.length&&""===v.query&&v.type===t.n.Category&&"regional"===v.categoryId?[...b.filter(s=>!s.tags.includes("Guided Anatomy")),...b.filter(s=>s.tags.includes("Guided Anatomy"))]:[...b]}},58832:(ge,F,n)=>{"use strict";n.d(F,{_:()=>t});var t=function(e){return e.All="",e.Quiz="mode-quiz",e.Content="mode-content",e}(t||{})},13517:(ge,F,n)=>{"use strict";n.d(F,{x:()=>t});var t=function(e){return e.UserGeneratedTour="user_generated_tour",e.Animated="animated",e.Quiz="quiz",e.ModeQuiz="mode_quiz",e.ModeContent="mode_content",e}(t||{})},45731:(ge,F,n)=>{"use strict";n.d(F,{S:()=>E});var t=n(16938);class e{}var r=n(17766);class E{constructor(){this.type=r.c.Bookmark,this.favorite=!1,this.unavailable=!1}}!function(y,d,_,v){var s,b=arguments.length,P=b<3?d:null===v?v=Object.getOwnPropertyDescriptor(d,_):v;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)P=Reflect.decorate(y,d,_,v);else for(var g=y.length-1;g>=0;g--)(s=y[g])&&(P=(b<3?s(P):b>3?s(d,_,P):s(d,_))||P);b>3&&P&&Object.defineProperty(d,_,P)}([(0,t.Z)(()=>e),function(y,d){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata("design:type",Array)}()],E.prototype,"group_access",void 0)},47632:(ge,F,n)=>{"use strict";n.d(F,{$H:()=>U,A:()=>u,B7:()=>l,B9:()=>f,C$:()=>Z,CF:()=>ae,CR:()=>d,Cr:()=>N,D3:()=>q,DN:()=>_,ET:()=>J,F_:()=>K,GZ:()=>D,Gr:()=>e,HN:()=>w,I0:()=>de,J9:()=>i,Kf:()=>o,Ln:()=>H,M:()=>W,Mo:()=>te,Mv:()=>k,Ny:()=>L,PS:()=>z,PU:()=>r,Pd:()=>A,Qw:()=>v,Ri:()=>S,U8:()=>re,Ur:()=>g,VN:()=>be,Xt:()=>C,ZA:()=>R,ZW:()=>T,Zp:()=>pe,a1:()=>Q,cK:()=>ie,dc:()=>Y,eW:()=>V,e_:()=>$,g:()=>p,iw:()=>j,iy:()=>P,j5:()=>c,lN:()=>M,ov:()=>a,pE:()=>ne,sN:()=>E,te:()=>ce,u:()=>O,x$:()=>s,yH:()=>m,zP:()=>B,zW:()=>le,zX:()=>y});var t=n(11040);let e=(()=>{class se{constructor(me,Se){this.query=me,this.lang=Se}}return se.type="[Bookmarks] Load",se})(),r=(()=>{class se{constructor(me,Se,Ue){this.organizationId=me,this.query=Se,this.lang=Ue}}return se.type="[Bookmarks] Load Organization Bookmarks",se})(),o=(()=>{class se{constructor(me,Se,Ue,je){this.organizationId=me,this.collectionId=Se,this.query=Ue,this.lang=je}}return se.type="[Bookmarks] Load Collection Bookmarks",se})(),C=(()=>{class se{constructor(me,Se,Ue=!1){this.id=me,this.type=Se,this.preview=Ue}}return se.type="[Bookmarks] Select Bookmark",se})(),E=(()=>{class se{constructor(me){this.bookmark=me}}return se.type="[Bookmarks] Select Bookmark Success",se})(),y=(()=>{class se{constructor(me){this.result=me}}return se.type="[Bookmarks] Load Success",se})(),d=(()=>{class se{constructor(me){this.bookmarkId=me}}return se.type="[Bookmarks] Delete Bookmark",se})(),_=(()=>{class se{constructor(me){this.bookmarkId=me}}return se.type="[Bookmarks] Bookmark Delete Success",se})(),v=(()=>{class se{constructor(me,Se){this.bookmarkId=me,this.error=Se}}return se.type="[Bookmarks] Bookmark Delete Fail",se})(),P=(()=>{class se{constructor(me,Se,Ue=!0){this.bookmarkEntry=me,this.inplace=Se,this.includeIndex=Ue}}return se.type="[Bookmarks] Save Bookmark",se})(),s=(()=>{class se{constructor(me,Se,Ue){this.bookmark=me,this.story=Se,this.method=Ue}}return se.type="[Bookmarks] Bookmark Saved",se})(),g=(()=>{class se{constructor(me,Se){this.bookmarkEntry=me,this.error=Se}}return se.type="[Bookmarks] Bookmark Save Failed",se})(),u=(()=>{class se{constructor(){}}return se.type="[Bookmarks] Cancel Save Bookmark",se})(),S=(()=>{class se{constructor(){}}return se.type="[Bookmarks] Reset",se})(),f=(()=>{class se{constructor(){}}return se.type="[Bookmarks] Clear Bookmarks",se})(),m=(()=>{class se{constructor(me){this.sort=me}}return se.type="[Bookmarks] Sort",se})(),i=(()=>{class se{constructor(me,Se){this.id=me,this.checked=Se}}return se.type="[Bookmarks] Check Bookmark",se})(),c=(()=>{class se{constructor(me){this.ids=me}}return se.type="[Bookmarks] Set Checked Bookmarks",se})(),a=(()=>{class se{constructor(me,Se,Ue,je,Le,Re,Ee,We,ze){this.bookmarks=me,this.organizationId=Se,this.collections=Ue,this.widgetURL=je,this.userLanguage=Le,this.userApp=Re,this.widgetOptions=Ee,this.offlineEnabled=We,this.productAccountId=ze}}return se.type="[Bookmarks] Export Bookmarks",se})(),l=(()=>{class se{constructor(me){this.bookmarks=me}}return se.type="[Bookmarks] Export Bookmarks Success",se})(),p=(()=>{class se{constructor(me){this.bookmarks=me}}return se.type="[Bookmarks] Export Bookmarks Error",se})(),A=(()=>{class se{constructor(me,Se=[],Ue=new Map){this.bookmark=me,this.addCollections=Se,this.removeCollections=Ue}}return se.type="[Bookmarks] Update Bookmark Collections",se})(),O=(()=>{class se{constructor(me,Se,Ue){this.bookmark=me,this.addCollections=Se,this.removeCollections=Ue}}return se.type="[Bookmarks] Update Bookmark Collections Success",se})(),L=(()=>{class se{constructor(me,Se,Ue){this.bookmark=me,this.addCollections=Se,this.removeCollections=Ue}}return se.type="[Bookmarks] Update Bookmark Collections Error",se})(),k=(()=>{class se{constructor(me,Se){this.bookmark=me,this.collections=Se}}return se.type="[Bookmarks] Add Bookmark Collections Success",se})(),q=(()=>{class se{constructor(me,Se){this.bookmark=me,this.collections=Se}}return se.type="[Bookmarks] Add Bookmark Collections Error",se})(),B=(()=>{class se{constructor(me,Se){this.bookmark=me,this.collections=Se}}return se.type="[Bookmarks] Remove Bookmark Collections Success",se})(),j=(()=>{class se{constructor(me,Se){this.bookmark=me,this.collections=Se}}return se.type="[Bookmarks] Remove Bookmark Collections Error",se})(),V=(()=>{class se{constructor(me,Se,Ue,je=t.q.lang,Le,Re){this.id=me,this.title=Se,this.type=Ue,this.lang=je,this.groupAccess=Le,this.collections=Re}}return se.type="[Bookmarks] Copy Bookmark",se})(),M=(()=>{class se{constructor(me){this.newBookmark=me}}return se.type="[Bookmarks] Copy Bookmark Success",se})(),N=(()=>{class se{constructor(me,Se){this.id=me,this.error=Se}}return se.type="[Bookmarks] Copy Bookmark Failure",se})(),W=(()=>{class se{constructor(){}}return se.type="[Bookmarks] Cancel Copy Bookmark",se})(),$=(()=>{class se{constructor(me){this.title=me}}return se.type="[Bookmarks] Set Bookmark Text",se})(),ne=(()=>{class se{constructor(me){this.viewMode=me}}return se.type="[Bookmarks] Set Bookmark View Mode",se})(),Q=(()=>{class se{constructor(me){this.category=me}}return se.type="[Bookmarks] Set Selected Category",se})(),le=(()=>{class se{constructor(){}}return se.type="[Bookmarks] Get Bookmark Jobs",se})(),pe=(()=>{class se{constructor(me){this.bookmarkJobs=me}}return se.type="[Bookmarks] Set Bookmark Jobs",se})(),ie=(()=>{class se{constructor(me){this.bookmarkJobs=me}}return se.type="[Bookmarks] Get Bookmark Jobs Success",se})(),be=(()=>{class se{constructor(me){this.error=me}}return se.type="[Bookmarks] Get Bookmark Jobs Failure",se})(),de=(()=>{class se{constructor(me,Se){this.jobId=me,this.jobType=Se}}return se.type="[Bookmarks] Cancel Bookmark Job",se})(),w=(()=>{class se{constructor(me,Se){this.jobId=me,this.jobType=Se}}return se.type="[Bookmarks] Cancel Bookmark Job Success",se})(),te=(()=>{class se{constructor(me,Se,Ue){this.jobId=me,this.jobType=Se,this.error=Ue}}return se.type="[Bookmarks] Cancel Bookmark Job Fail",se})(),R=(()=>{class se{constructor(me){this.copyBookmarkModels=me}}return se.type="[Bookmarks] Bulk Copy Bookmarks",se})(),D=(()=>{class se{constructor(me,Se){this.copyBookmarkModels=me,this.jobId=Se}}return se.type="[Bookmarks] Bulk Copy Bookmarks Processing",se})(),T=(()=>{class se{constructor(){}}return se.type="[Bookmarks] Bulk Copy Bookmarks Error",se})(),re=(()=>{class se{constructor(){}}return se.type="[Bookmarks] Bulk Copy Bookmarks Complete",se})(),K=(()=>{class se{constructor(me,Se){this.copyBookmarkModels=me,this.error=Se}}return se.type="[Bookmarks] Bulk Copy Bookmarks Failure",se})(),ae=(()=>{class se{constructor(me){this.bookmarkIds=me}}return se.type="[Bookmarks] Bulk Delete Bookmark",se})(),ce=(()=>{class se{constructor(me,Se){this.deleteBookmarkIds=me,this.jobId=Se}}return se.type="[Bookmarks] Bookmark Bulk Delete Processing",se})(),U=(()=>{class se{constructor(){}}return se.type="[Bookmarks] Bookmark Bulk Delete Complete",se})(),Z=(()=>{class se{constructor(me,Se){this.bookmarkIds=me,this.error=Se}}return se.type="[Bookmarks] Bookmark Bulk Delete Fail",se})(),z=(()=>{class se{constructor(){}}return se.type="[Bookmarks] Bulk Delete Bookmarks Error",se})(),H=(()=>{class se{constructor(me,Se){this.groupId=me,this.updates=Se}}return se.type="[Bookmarks] Bulk Update Bookmark Collections",se})(),J=(()=>{class se{constructor(me){this.updates=me}}return se.type="[Bookmarks] Bulk Update Bookmark Collections Success",se})(),Y=(()=>{class se{constructor(me,Se){this.updates=me,this.error=Se}}return se.type="[Bookmarks] Bulk Update Bookmark Collections Error",se})()},21523:(ge,F,n)=>{"use strict";n.d(F,{J:()=>K});var t=n(28407),e=n(65763);class r{}var o=n(47632),C=n(15152),E=n(11756),y=n(17365),d=n(36110),_=n(32914),v=n(39705),b=n(40634),P=n(94495),s=n(21472),g=n(46104),u=n(15877),h=n(96728),S=n(16058),f=n(56583),m=n(65459),i=n(66874),c=n(49204),a=n(55361),l=n(65881),p=n(95416),A=n(35939);class O{}var te,L=n(16606),k=n(59e3),q=n(57238),B=n(65650),j=n(82323),V=n(1580),M=n(11113),N=n(58832),W=n(79440),$=n(17215),ne=n(17766),Q=n(40215),le=n(53236),pe=n(24418),ie=n(38645),be=n(22679),de=n(2096),w=n(54438),R=function(ae,ce,U,Z){var J,z=arguments.length,H=z<3?ce:null===Z?Z=Object.getOwnPropertyDescriptor(ce,U):Z;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)H=Reflect.decorate(ae,ce,U,Z);else for(var Y=ae.length-1;Y>=0;Y--)(J=ae[Y])&&(H=(z<3?J(H):z>3?J(ce,U,H):J(ce,U))||H);return z>3&&H&&Object.defineProperty(ce,U,H),H},D=function(ae,ce){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(ae,ce)};function T(ae,ce,U,Z,z,H){return H?(0,s.H)(U.getDatabaseItem($.AJ.PreviewBookmark)):z===ne.c.Bookmark?ae.getBookmarkModel(Z):ce.getConditionModel(Z)}const re={loading:!0,exporting:!1,copying:!1,saving:!1,bookmarks:[],selectedBookmark:null,sort:h._z,checkedBookmarks:[],selectedCategory:null,bookmarkJobs:[]};let K=((te=class{static getBookmarks(ce){const{bookmarks:U,sort:Z}=ce,{ascending:z,fields:H}=Z;return(0,a.h5)(U,H,z)}static getCheckedBookmarks(ce){return ce.checkedBookmarks}static getSelectedBookmark(ce){return ce.selectedBookmark}static getSelectedBookmarkViewMode(ce){return ce.selectedBookmark.viewMode||N._.All}static getLoading(ce){return ce.loading}static getExporting(ce){return ce.exporting}static getSaving(ce){return ce.saving}static getCopying(ce){return ce.copying}static getSort(ce){return ce.sort}static getSelectedCategory(ce){return ce.selectedCategory}static getBookmarkJobs(ce){return ce.bookmarkJobs}static getActiveBookmarkJob(ce){const U=["aborted","complete","error"];return ce.bookmarkJobs.find(Z=>!U.includes(Z.job_status))}loadBookmarks(ce,U){ce.patchState({loading:!0,bookmarks:[],checkedBookmarks:[]}),(0,g.p)(this.bookmarksService.getPrivateBookmarks(U.query,U.lang),this.bookmarksService.getPrivateConditions(U.query,U.lang)).pipe((0,C.j)(()=>ce.patchState({loading:!1}))).subscribe(([Z,z])=>{ce.dispatch(new o.zX([...Z,...z]))})}loadOrganizationBookmarks(ce,{organizationId:U,query:Z,lang:z}){ce.patchState({loading:!0,bookmarks:[],checkedBookmarks:[]}),this.bookmarksService.getOrganizationContent(U,Z,z).pipe((0,C.j)(()=>ce.patchState({loading:!1}))).subscribe(H=>{ce.dispatch(new o.zX(H))})}loadCollectionBookmarks(ce,U){ce.patchState({loading:!0,bookmarks:[],checkedBookmarks:[]}),this.organizationsService.getCollectionContent(U.organizationId,U.collectionId,U.query,U.lang).pipe((0,C.j)(()=>ce.patchState({loading:!1}))).subscribe(Z=>{ce.dispatch(new o.zX(Z))})}loadSuccess({patchState:ce},U){ce({bookmarks:U.result})}selectBookmark(ce,U){const{id:Z,type:z,preview:H}=U;T(this.bookmarksService,this.exploreService,this.storageService,Z,z,H).subscribe(Y=>{ce.dispatch(new o.sN(Y))})}selectBookmarkSuccess(ce,U){let{bookmark:Z}=U;Z&&(Z=(0,W.H)(Z)),ce.patchState({selectedBookmark:Z})}saveBookmark(ce,U){var Z=this;return(0,t.A)(function*(){let z;ce.patchState({saving:!0});const H=U.bookmarkEntry,J=H.id?"update":"save",Y=Z.store.selectSnapshot(P.N.getStoryChapters),X=!1===U.inplace,se=(0,l.S)(Y,X);X&&(yield(0,Q._)(Z.store.dispatch(new A.u.UpdateTweenParticleLookupChapters(se)))),U.includeIndex&&(z=Z.bookmarksService.createBookmarkStory(H.title,se),"save"===J&&Z.storyService.addContentRecord(Z.store.selectSnapshot(be.t.getStoryId),z.story),H.index=z.story);let oe=(0,u.of)([]);if(U.includeIndex){const me=Z.store.selectSnapshot(B.K.getRegisteredThumbnails),Se=Z.imagesService.saveChapterThumbnails(H.index.chapters,me,(0,c.invert)(se));Se.length&&(oe=(0,g.p)(Se))}oe.pipe((0,E.Z)(me=>{const Se=Z.store.selectSnapshot(B.K.getRegisteredThumbnails);return me.forEach(Ue=>{const je=new q.R;je.storyId=H.id,je.chapterId=Ue.chapterId,je.urls={small:Ue.uris.small,large:Ue.uris.large},Se.set(Ue.chapterId,je);const Le=H.index.chapters.findIndex(Re=>Re.id===Ue.chapterId);Le>=0&&(H.index.chapters[Le].thumbnails={...Ue.uris})}),ce.dispatch(new j.W2(Se)),Z.bookmarksService.saveBookmark(H)}),(0,C.j)(()=>ce.patchState({saving:!1}))).subscribe({next:me=>{const Se=Array.isArray(H.addCollections)&&H.addCollections.length>0,Ue=H.removeCollections&&Array.from(H.removeCollections.keys()).length>0;Se||Ue?(Z.actions.pipe((0,e.xi)(o.u,o.Ny),(0,y.s)(1)).subscribe(()=>{ce.dispatch(new o.x$(me,H.index,J))}),ce.dispatch(new o.Pd(me,H.addCollections,H.removeCollections))):ce.dispatch(new o.x$(me,H.index,J))},error:me=>{ce.dispatch(new o.Ur(H,me))}}),Z.vendorAnalyticsService.track("Bookmark Save - Start")})()}saveBookmarkSuccess(ce,U){const Z=U.bookmark,z=ce.getState().bookmarks,H=z.findIndex(J=>J.id===Z.id);-1!==H&&(z[H]=Z,ce.patchState({bookmarks:[...z]})),"save"===U.method&&ce.patchState({selectedBookmark:U.bookmark}),this.vendorAnalyticsService.track("Bookmark Save - Success",{id:Z.id,chapters:U.story.chapters.length,tour:Z.tour,animated:Z.animated,quiz:Z.quiz,edit:this.router.url.startsWith("/edit")})}saveBookmarkFail(ce,U){const Z=U.bookmarkEntry?.id||"",z=Z.includes("/")?ne.c.Module:ne.c.Bookmark,H=(0,le.u1)(U.error),J=U.error?.status;this.vendorAnalyticsService.track("Bookmark Save - Failure",{contentId:Z,contentType:z,error:H,statusCode:J,application:pe.c.application})}deleteBookmark(ce,U){const Z=U.bookmarkId;this.bookmarksService.deleteBookmark(Z).subscribe(()=>{ce.dispatch(new o.DN(Z))},z=>{ce.dispatch(new o.Qw(Z,z))})}deleteBookmarkSuccess(ce,U){const Z=ce.getState().bookmarks.filter(z=>z.id!==U.bookmarkId);ce.patchState({bookmarks:[...Z]}),this.snackbar.open("Successfully deleted 3D model")}bulkDeleteBookmark(ce,{bookmarkIds:U}){this.vendorAnalyticsService.track("Bulk Delete - Start"),this.bookmarksService.bulkDeleteBookmarks(U).subscribe({next:Z=>{ce.dispatch(new o.te(U,Z.job_id)),ce.dispatch(new o.zW)},error:Z=>{this.vendorAnalyticsService.track("Bulk Delete - Error"),ce.dispatch(new o.C$(U,Z))}})}bulkDeleteBookmarkComplete(ce,U){this.vendorAnalyticsService.track("Bulk Delete - Complete")}bulkDeleteBookmarksError(ce,U){this.vendorAnalyticsService.track("Bulk Delete - Error")}sortBookmarks(ce,U){const Z=ce.getState().bookmarks;ce.patchState({sort:U.sort,bookmarks:[...Z]})}clearBookmarks(ce,U){ce.patchState({bookmarks:[],checkedBookmarks:[]})}resetBookmarks(ce,U){ce.setState(re)}checkBookmark(ce,U){let Z=ce.getState().checkedBookmarks;const z=Z.some(H=>H===U.id);U.checked&&!z?Z=[...Z,U.id]:U.checked||(Z=Z.filter(H=>H!==U.id)),ce.patchState({checkedBookmarks:Z})}setCheckedBookmarks(ce,U){ce.patchState({checkedBookmarks:U.ids})}exportBookmarks(ce,U){const{bookmarks:Z,organizationId:z,collections:H,widgetURL:J,widgetOptions:Y,offlineEnabled:X,productAccountId:se}=U,oe=Y||new f.$;ce.patchState({exporting:!0}),this.publishService.exportBookmarks(Z,z,H,J,oe,null,U.userLanguage,U.userApp,X,se).pipe((0,C.j)(()=>{ce.patchState({exporting:!1})})).subscribe(me=>{ce.dispatch(me?new o.B7(Z):new o.g(Z))})}postUpdateBookmarkCollections(ce,U){const Z=new Map,z=new Map;U.forEach(({bookmark:Y,addCollections:X,removeCollections:se})=>{X.forEach(oe=>{const me=oe.collection_id,Se={content_type:Y.type,content_id:Y.id},Ue=Z.get(me)??[];Ue.push(Se),Z.set(me,Ue)}),se.forEach((oe,me)=>{const Se=me.collection_id,Ue=z.get(Se)??[];Ue.push(oe),z.set(Se,Ue)})});const H=Array.from(Z).map(([Y,X])=>({collection_id:Y,content_list:X})),J=Array.from(z).map(([Y,X])=>({collection_id:Y,collection_content_id_list:X}));return this.organizationsService.updateCollectionContent(ce,H,J)}bulkUpdateBookmarkCollections(ce,{groupId:U,updates:Z}){this.vendorAnalyticsService.track("Bulk Move/Remove - Start"),this.postUpdateBookmarkCollections(U,Z).subscribe({next:()=>{this.vendorAnalyticsService.track("Bulk Move/Remove - Success"),ce.dispatch(new o.ET(Z))},error:z=>{this.vendorAnalyticsService.track("Bulk Move/Remove - Error"),ce.dispatch(new o.dc(Z,z))}})}updateBookmarkCollections(ce,U){const Z=U.addCollections,z=Z.map(X=>({collection_id:X.collection_id,content_list:[{content_type:U.bookmark.type,content_id:U.bookmark.id}]})),H=Array.from(U.removeCollections.keys()),J=H.map(X=>({collection_id:X.collection_id,collection_content_id_list:[U.removeCollections.get(X)]})),Y=Z.concat(H)[0].group_id;this.organizationsService.updateCollectionContent(Y,z,J).subscribe(()=>{Z.length>0&&ce.dispatch(new o.Mv(U.bookmark,Z)),H.length>0&&ce.dispatch(new o.zP(U.bookmark,H)),ce.dispatch(new o.u(U.bookmark,Z,H))},()=>{Z.length>0&&ce.dispatch(new o.D3(U.bookmark,Z)),H.length>0&&ce.dispatch(new o.iw(U.bookmark,H)),ce.dispatch(new o.Ny(U.bookmark,Z,H))})}removeBookmarkCollectionSuccess(ce,U){const{bookmarks:Z,selectedCategory:z}=ce.getState();if("collection"===z){const H=U.bookmark.id,J=Z.filter(Y=>Y.id!==H);ce.patchState({bookmarks:[...J]})}}copyBookmark(ce,U){this.vendorAnalyticsService.track("Bookmark Copy - Start");const{groupAccess:Z,collections:z}=U;let H,J,Y,X,se;ce.patchState({copying:!0,saving:!0});const oe=T(this.bookmarksService,this.exploreService,this.storageService,U.id,U.type,!1),me=this.storyService.getStory(U.id,U.type,U.lang);(0,g.p)([oe,me]).pipe((0,d.T)(([Se,Ue])=>{J=(0,c.cloneDeep)(Ue),Y=(0,c.cloneDeep)(Ue),this.storyService.addContentRecord(U.id,Y),X=(0,l.S)(J.chapters,!0),Y.chapters.forEach(je=>{je.id=X[je.id]}),U.type?delete Y.sourceInfo:Y.sourceInfo=(0,de.CE)(Y.sourceInfo),Y.tweenParticleLookup&&(Y.tweenParticleLookup=M.e.updateChapterIds(Y.tweenParticleLookup,X)),se=Se.viewMode}),(0,_.n)(()=>this.imagesService.generateFreshChapterImages(J.chapters,U.id)),(0,_.n)(Se=>{const Ue=Se.map(je=>this.imagesService.saveNewChapterImage(je.chapterId,je.snapshot));return Ue.length?(0,g.p)(Ue):(0,u.of)([])}),(0,d.T)(Se=>{Se.forEach(Ue=>{Ue.chapterId=X[Ue.chapterId]}),Y.chapters.forEach(Ue=>{const je=Se.find(Le=>Le.chapterId===Ue.id);je&&(Ue.thumbnails={...je.uris})})}),(0,_.n)(()=>{const Se=new O;return Se.title=U.title,Se.isOwner=!0,Se.index=Y,Se.viewMode=se,Se.is_content_copy=!0,Z&&(Se.add_group_access=[Z]),this.bookmarksService.saveBookmark(Se)}),(0,v.M)(Se=>{H=Se}),(0,_.n)(()=>{if(Z&&z&&z.length>0){const Se=z[0].group_id,Ue=z.map(je=>({collection_id:je.collection_id,content_list:[{content_type:H.type,content_id:H.id}]}));return this.organizationsService.updateCollectionContent(Se,Ue,[])}return(0,u.of)(!0)}),(0,C.j)(()=>{ce.patchState({copying:!1,saving:!1})})).subscribe(()=>{this.vendorAnalyticsService.track("Bookmark Copy - Success",{id:H.id,chapters:Y.chapters.length,tour:H.tour,animated:H.animated,quiz:H.quiz,edit:this.router.url.startsWith("/edit")}),ce.dispatch(new o.lN(H))},Se=>{this.vendorAnalyticsService.track("Bookmark Copy - Failure"),ce.dispatch(new o.Cr(U.id,Se))})}copyBookmarks(ce,{copyBookmarkModels:U}){this.vendorAnalyticsService.track("Bulk Add - Start"),ce.patchState({copying:!0}),this.bookmarksService.bulkCopyBookmarks(U).pipe((0,C.j)(()=>{ce.patchState({copying:!1})})).subscribe({next:Z=>{ce.dispatch(new o.GZ(U,Z.job_id)),ce.dispatch(new o.zW)},error:Z=>{this.vendorAnalyticsService.track("Bulk Add - Error"),ce.dispatch(new o.F_(U,Z))}})}bulkCopyBookmarksComplete(ce,U){this.vendorAnalyticsService.track("Bulk Add - Success")}BulkCopyBookmarksError(ce,U){this.vendorAnalyticsService.track("Bulk Add - Error")}getBookmarkJobs(ce,U){this.bookmarksService.getBookmarkJobs().subscribe({next:Z=>{ce.dispatch(new o.cK(Z))},error:Z=>{ce.dispatch(new o.VN(Z))}})}setBookmarkJobs(ce,{bookmarkJobs:U}){ce.patchState({bookmarkJobs:U})}getBookmarkJobsSuccess(ce,{bookmarkJobs:U}){ce.dispatch(new o.Zp(U))}cancelBookmarkJob(ce,{jobId:U,jobType:Z}){this.vendorAnalyticsService.track(("bookmark_copy"===Z?"Bulk Add":"Bulk Delete")+" - Stopped"),this.bookmarksService.cancelBookmarkJob(U).subscribe({next:()=>{ce.dispatch(new o.HN(U,Z)),ce.dispatch(new o.zW)},error:z=>{ce.dispatch(new o.Mo(U,Z,z))}})}setBookmarkText(ce,U){const Z=ce.getState().selectedBookmark;ce.patchState({selectedBookmark:{...Z,title:U.title}})}setBookmarkViewMode(ce,U){const Z=ce.getState().selectedBookmark;ce.patchState({selectedBookmark:{...Z,viewMode:U.viewMode}})}setSelectedCategory(ce,{category:U}){ce.patchState({selectedCategory:U||null})}cancelSaveBookmark(ce,U){ce.patchState({saving:!1})}cancelCopyBookmark(ce,U){ce.patchState({copying:!1})}constructor(ce,U,Z,z,H,J,Y,X,se,oe,me,Se){this.store=ce,this.actions=U,this.bookmarksService=Z,this.imagesService=z,this.storyService=H,this.exploreService=J,this.publishService=Y,this.organizationsService=X,this.snackbar=se,this.vendorAnalyticsService=oe,this.storageService=me,this.router=Se}}).\u0275fac=function(ce){return new(ce||te)(w.KVO(e.il),w.KVO(e.En),w.KVO(b.x),w.KVO(V.M),w.KVO(L.J),w.KVO(i.z),w.KVO(S.D),w.KVO(m.k),w.KVO(p.UG),w.KVO(k.e),w.KVO($.n$),w.KVO(ie.Ix))},te.\u0275prov=w.jDH({token:te,factory:te.\u0275fac}),te);R([(0,e.rc)(o.Gr),D("design:type",Function),D("design:paramtypes",[Object,o.Gr]),D("design:returntype",void 0)],K.prototype,"loadBookmarks",null),R([(0,e.rc)(o.PU),D("design:type",Function),D("design:paramtypes",[Object,o.PU]),D("design:returntype",void 0)],K.prototype,"loadOrganizationBookmarks",null),R([(0,e.rc)(o.Kf),D("design:type",Function),D("design:paramtypes",[Object,o.Kf]),D("design:returntype",void 0)],K.prototype,"loadCollectionBookmarks",null),R([(0,e.rc)(o.zX),D("design:type",Function),D("design:paramtypes",[Object,o.zX]),D("design:returntype",void 0)],K.prototype,"loadSuccess",null),R([(0,e.rc)(o.Xt),D("design:type",Function),D("design:paramtypes",[Object,o.Xt]),D("design:returntype",void 0)],K.prototype,"selectBookmark",null),R([(0,e.rc)(o.sN),D("design:type",Function),D("design:paramtypes",[Object,o.sN]),D("design:returntype",void 0)],K.prototype,"selectBookmarkSuccess",null),R([(0,e.rc)(o.iy),D("design:type",Function),D("design:paramtypes",[Object,o.iy]),D("design:returntype",Promise)],K.prototype,"saveBookmark",null),R([(0,e.rc)(o.x$),D("design:type",Function),D("design:paramtypes",[Object,o.x$]),D("design:returntype",void 0)],K.prototype,"saveBookmarkSuccess",null),R([(0,e.rc)(o.Ur),D("design:type",Function),D("design:paramtypes",[Object,o.Ur]),D("design:returntype",void 0)],K.prototype,"saveBookmarkFail",null),R([(0,e.rc)(o.CR),D("design:type",Function),D("design:paramtypes",[Object,o.CR]),D("design:returntype",void 0)],K.prototype,"deleteBookmark",null),R([(0,e.rc)(o.DN),D("design:type",Function),D("design:paramtypes",[Object,o.DN]),D("design:returntype",void 0)],K.prototype,"deleteBookmarkSuccess",null),R([(0,e.rc)(o.CF),D("design:type",Function),D("design:paramtypes",[Object,o.CF]),D("design:returntype",void 0)],K.prototype,"bulkDeleteBookmark",null),R([(0,e.rc)(o.$H),D("design:type",Function),D("design:paramtypes",[Object,o.$H]),D("design:returntype",void 0)],K.prototype,"bulkDeleteBookmarkComplete",null),R([(0,e.rc)(o.PS),D("design:type",Function),D("design:paramtypes",[Object,o.PS]),D("design:returntype",void 0)],K.prototype,"bulkDeleteBookmarksError",null),R([(0,e.rc)(o.yH),D("design:type",Function),D("design:paramtypes",[Object,o.yH]),D("design:returntype",void 0)],K.prototype,"sortBookmarks",null),R([(0,e.rc)(o.B9),D("design:type",Function),D("design:paramtypes",[Object,o.B9]),D("design:returntype",void 0)],K.prototype,"clearBookmarks",null),R([(0,e.rc)(o.Ri),D("design:type",Function),D("design:paramtypes",[Object,o.Ri]),D("design:returntype",void 0)],K.prototype,"resetBookmarks",null),R([(0,e.rc)(o.J9),D("design:type",Function),D("design:paramtypes",[Object,o.J9]),D("design:returntype",void 0)],K.prototype,"checkBookmark",null),R([(0,e.rc)(o.j5),D("design:type",Function),D("design:paramtypes",[Object,o.j5]),D("design:returntype",void 0)],K.prototype,"setCheckedBookmarks",null),R([(0,e.rc)(o.ov),D("design:type",Function),D("design:paramtypes",[Object,o.ov]),D("design:returntype",void 0)],K.prototype,"exportBookmarks",null),R([(0,e.rc)(o.Ln),D("design:type",Function),D("design:paramtypes",[Object,o.Ln]),D("design:returntype",void 0)],K.prototype,"bulkUpdateBookmarkCollections",null),R([(0,e.rc)(o.Pd),D("design:type",Function),D("design:paramtypes",[Object,o.Pd]),D("design:returntype",void 0)],K.prototype,"updateBookmarkCollections",null),R([(0,e.rc)(o.zP),D("design:type",Function),D("design:paramtypes",[Object,o.zP]),D("design:returntype",void 0)],K.prototype,"removeBookmarkCollectionSuccess",null),R([(0,e.rc)(o.eW),D("design:type",Function),D("design:paramtypes",[Object,o.eW]),D("design:returntype",void 0)],K.prototype,"copyBookmark",null),R([(0,e.rc)(o.ZA),D("design:type",Function),D("design:paramtypes",[Object,o.ZA]),D("design:returntype",void 0)],K.prototype,"copyBookmarks",null),R([(0,e.rc)(o.U8),D("design:type",Function),D("design:paramtypes",[Object,o.U8]),D("design:returntype",void 0)],K.prototype,"bulkCopyBookmarksComplete",null),R([(0,e.rc)(o.ZW),D("design:type",Function),D("design:paramtypes",[Object,o.ZW]),D("design:returntype",void 0)],K.prototype,"BulkCopyBookmarksError",null),R([(0,e.rc)(o.zW),D("design:type",Function),D("design:paramtypes",[Object,o.zW]),D("design:returntype",void 0)],K.prototype,"getBookmarkJobs",null),R([(0,e.rc)(o.Zp),D("design:type",Function),D("design:paramtypes",[Object,o.Zp]),D("design:returntype",void 0)],K.prototype,"setBookmarkJobs",null),R([(0,e.rc)(o.cK),D("design:type",Function),D("design:paramtypes",[Object,o.cK]),D("design:returntype",void 0)],K.prototype,"getBookmarkJobsSuccess",null),R([(0,e.rc)(o.I0),D("design:type",Function),D("design:paramtypes",[Object,o.I0]),D("design:returntype",void 0)],K.prototype,"cancelBookmarkJob",null),R([(0,e.rc)(o.e_),D("design:type",Function),D("design:paramtypes",[Object,o.e_]),D("design:returntype",void 0)],K.prototype,"setBookmarkText",null),R([(0,e.rc)(o.pE),D("design:type",Function),D("design:paramtypes",[Object,o.pE]),D("design:returntype",void 0)],K.prototype,"setBookmarkViewMode",null),R([(0,e.rc)(o.a1),D("design:type",Function),D("design:paramtypes",[Object,o.a1]),D("design:returntype",void 0)],K.prototype,"setSelectedCategory",null),R([(0,e.rc)(o.A),D("design:type",Function),D("design:paramtypes",[Object,o.A]),D("design:returntype",void 0)],K.prototype,"cancelSaveBookmark",null),R([(0,e.rc)(o.M),D("design:type",Function),D("design:paramtypes",[Object,o.M]),D("design:returntype",void 0)],K.prototype,"cancelCopyBookmark",null),R([(0,e.MD)(),D("design:type",Function),D("design:paramtypes",[r]),D("design:returntype",void 0)],K,"getBookmarks",null),R([(0,e.MD)(),D("design:type",Function),D("design:paramtypes",[r]),D("design:returntype",void 0)],K,"getCheckedBookmarks",null),R([(0,e.MD)(),D("design:type",Function),D("design:paramtypes",[r]),D("design:returntype",void 0)],K,"getSelectedBookmark",null),R([(0,e.MD)(),D("design:type",Function),D("design:paramtypes",[r]),D("design:returntype",void 0)],K,"getSelectedBookmarkViewMode",null),R([(0,e.MD)(),D("design:type",Function),D("design:paramtypes",[r]),D("design:returntype",void 0)],K,"getLoading",null),R([(0,e.MD)(),D("design:type",Function),D("design:paramtypes",[r]),D("design:returntype",void 0)],K,"getExporting",null),R([(0,e.MD)(),D("design:type",Function),D("design:paramtypes",[r]),D("design:returntype",void 0)],K,"getSaving",null),R([(0,e.MD)(),D("design:type",Function),D("design:paramtypes",[r]),D("design:returntype",void 0)],K,"getCopying",null),R([(0,e.MD)(),D("design:type",Function),D("design:paramtypes",[r]),D("design:returntype",void 0)],K,"getSort",null),R([(0,e.MD)(),D("design:type",Function),D("design:paramtypes",[r]),D("design:returntype",void 0)],K,"getSelectedCategory",null),R([(0,e.MD)(),D("design:type",Function),D("design:paramtypes",[r]),D("design:returntype",void 0)],K,"getBookmarkJobs",null),R([(0,e.MD)(),D("design:type",Function),D("design:paramtypes",[r]),D("design:returntype",void 0)],K,"getActiveBookmarkJob",null),K=R([(0,e.Uw)({name:"bookmarks",defaults:re}),D("design:paramtypes",[e.il,e.En,b.x,V.M,L.J,i.z,S.D,m.k,p.UG,k.e,$.n$,ie.Ix])],K)},15623:(ge,F,n)=>{"use strict";n.d(F,{m:()=>t,q:()=>e});var t=function(r){return r[r.XSmall=0]="XSmall",r[r.Small=1]="Small",r[r.Medium=2]="Medium",r[r.Large=3]="Large",r[r.XLarge=4]="XLarge",r}(t||{}),e=function(r){return r[r.Tiny=0]="Tiny",r[r.Small=1]="Small",r[r.Medium=2]="Medium",r}(e||{})},38104:(ge,F,n)=>{"use strict";n.d(F,{V:()=>g});var e,u,t=n(65763);(u=e||(e={})).SetHorizontalBreakpoint=(()=>{class m{constructor(c){this.breakpoint=c}}return m.type="[View] Set Horizontal Breakpoint",m})(),u.SetVerticalBreakpoint=(()=>{class m{constructor(c){this.breakpoint=c}}return m.type="[View] Set Vertical Breakpoint",m})();var v,r=n(15623),o=n(99327),C=n(82656),E=n(36110),y=n(21082),d=n(14264),_=n(54438),b=function(u,h,S,f){var c,m=arguments.length,i=m<3?h:null===f?f=Object.getOwnPropertyDescriptor(h,S):f;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(u,h,S,f);else for(var a=u.length-1;a>=0;a--)(c=u[a])&&(i=(m<3?c(i):m>3?c(h,S,i):c(h,S))||i);return m>3&&i&&Object.defineProperty(h,S,i),i},P=function(u,h){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(u,h)};class s{}let g=((v=class{static getHorizontalBreakpoint(h){return h.horizontalBreakpoint}static getHorizontalBreakpointLabel(h){return["(max-width: 374px)","(max-width: 599px)","(max-width: 959px)","(max-width: 1439px)","(min-width: 1440px)"][h.horizontalBreakpoint]}static getVerticalBreakpoint(h){return h.verticalBreakpoint}static getVerticalBreakpointLabel(h){return["(max-height: 479px)","(min-height: 480px)","(min-height: 375px)"][h.verticalBreakpoint]}setBreakpoint(h,S){h.patchState({horizontalBreakpoint:S.breakpoint})}setVerticalBreakpoint(h,S){h.patchState({verticalBreakpoint:S.breakpoint})}constructor(h,S){this.breakpointObserver=h,this.store=S}ngxsOnInit(h){this.initHorizontalBreakpointObserver(h),this.initVerticalBreakpointObserver(h)}initHorizontalBreakpointObserver(h){const S=this.breakpointObserver.observe(["(max-width: 374px)"]),f=this.breakpointObserver.observe(["(max-width: 599px)"]),m=this.breakpointObserver.observe(["(max-width: 959px)"]),i=this.breakpointObserver.observe(["(max-width: 1439px)"]),c=this.breakpointObserver.observe(["(min-width: 1440px)"]);(0,C.z)([S,f,m,i,c]).pipe((0,E.T)(([a,l,p,A,O])=>a.matches?r.m.XSmall:l.matches?r.m.Small:p.matches?r.m.Medium:A.matches?r.m.Large:O.matches?r.m.XLarge:null),(0,y.F)(),(0,d.p)(a=>null!=a)).subscribe(a=>{h.dispatch(new e.SetHorizontalBreakpoint(a))})}initVerticalBreakpointObserver(h){const S=this.breakpointObserver.observe(["(max-height: 374px)"]),f=this.breakpointObserver.observe(["(max-height: 479px)"]),m=this.breakpointObserver.observe(["(min-height: 480px)"]);(0,C.z)([S,f,m]).pipe((0,E.T)(([i,c,a])=>i.matches?r.q.Tiny:c.matches?r.q.Small:a.matches?r.q.Medium:null),(0,y.F)(),(0,d.p)(i=>null!=i)).subscribe(i=>{h.dispatch(new e.SetVerticalBreakpoint(i))})}}).\u0275fac=function(h){return new(h||v)(_.KVO(o.QP),_.KVO(t.il))},v.\u0275prov=_.jDH({token:v,factory:v.\u0275fac}),v);b([(0,t.rc)(e.SetHorizontalBreakpoint),P("design:type",Function),P("design:paramtypes",[Object,e.SetHorizontalBreakpoint]),P("design:returntype",void 0)],g.prototype,"setBreakpoint",null),b([(0,t.rc)(e.SetVerticalBreakpoint),P("design:type",Function),P("design:paramtypes",[Object,e.SetVerticalBreakpoint]),P("design:returntype",void 0)],g.prototype,"setVerticalBreakpoint",null),b([(0,t.MD)(),P("design:type",Function),P("design:paramtypes",[s]),P("design:returntype",void 0)],g,"getHorizontalBreakpoint",null),b([(0,t.MD)(),P("design:type",Function),P("design:paramtypes",[s]),P("design:returntype",void 0)],g,"getHorizontalBreakpointLabel",null),b([(0,t.MD)(),P("design:type",Function),P("design:paramtypes",[s]),P("design:returntype",void 0)],g,"getVerticalBreakpoint",null),b([(0,t.MD)(),P("design:type",Function),P("design:paramtypes",[s]),P("design:returntype",void 0)],g,"getVerticalBreakpointLabel",null),g=b([(0,t.Uw)({name:"breakpoint",defaults:{horizontalBreakpoint:null,verticalBreakpoint:null}}),P("design:paramtypes",[o.QP,t.il])],g)},22346:(ge,F,n)=>{"use strict";n.d(F,{K:()=>_});var t=n(60177),e=n(54438),r=n(38645),o=n(73845);const C=["featuredCard"];function E(v,b){if(1&v&&(e.j41(0,"div",8),e.EFF(1),e.k0s()),2&v){const P=e.XpG();e.R7$(),e.JRh(P.subtitle())}}function y(v,b){if(1&v&&(e.j41(0,"div",9),e.EFF(1),e.k0s()),2&v){const P=e.XpG();e.R7$(),e.JRh(P.metadata())}}function d(v,b){if(1&v&&(e.j41(0,"figure",10),e.nrm(1,"img",11),e.k0s()),2&v){const P=e.XpG();e.R7$(),e.Y8G("lazyLoad",P.featuredIcon())}}let _=(()=>{var v;class b{constructor(){this.defaultImage="/assets/images/card-thumbnail-placeholder.png",this.title=e.hFB.required(),this.subtitle=(0,e.hFB)(),this.metadata=(0,e.hFB)(),this.image=(0,e.hFB)(),this.featuredIcon=(0,e.hFB)(),this.colorOnHover=(0,e.hFB)(!1),this.routerLink=(0,e.hFB)(),this.queryParams=(0,e.hFB)(),this.innerColor=(0,e.hFB)(),this.outerColor=(0,e.hFB)(),this.foreground=(0,e.hFB)("white"),this.gradientColor=(0,e.EWP)(()=>`radial-gradient(${this.innerColor()}, ${this.outerColor()})`),(0,e.QZP)(()=>{this.colorOnHover()?this.removeColorFromCard():this.applyColorToCard()})}onMouseEnter(){this.colorOnHover()&&this.applyColorToCard()}onMouseLeave(){this.colorOnHover()&&this.removeColorFromCard()}applyColorToCard(){this.featuredCardElement.nativeElement.style.setProperty("--background",this.gradientColor()),this.featuredCardElement.nativeElement.style.setProperty("--foreground",this.foreground()),this.colorOnHover()&&this.featuredCardElement.nativeElement.style.setProperty("--border",this.outerColor())}removeColorFromCard(){this.featuredCardElement.nativeElement.style.setProperty("--background","white"),this.featuredCardElement.nativeElement.style.setProperty("--foreground","#1c2a3f"),this.colorOnHover()&&this.featuredCardElement.nativeElement.style.setProperty("--border","#d7e0ea")}}return(v=b).\u0275fac=function(s){return new(s||v)},v.\u0275cmp=e.VBU({type:v,selectors:[["app-featured-card"]],viewQuery:function(s,g){if(1&s&&e.GBs(C,7),2&s){let u;e.mGM(u=e.lsd())&&(g.featuredCardElement=u.first)}},inputs:{title:[e.Mj6.SignalBased,"title"],subtitle:[e.Mj6.SignalBased,"subtitle"],metadata:[e.Mj6.SignalBased,"metadata"],image:[e.Mj6.SignalBased,"image"],featuredIcon:[e.Mj6.SignalBased,"featuredIcon"],colorOnHover:[e.Mj6.SignalBased,"colorOnHover"],routerLink:[e.Mj6.SignalBased,"routerLink"],queryParams:[e.Mj6.SignalBased,"queryParams"],innerColor:[e.Mj6.SignalBased,"innerColor"],outerColor:[e.Mj6.SignalBased,"outerColor"],foreground:[e.Mj6.SignalBased,"foreground"]},standalone:!0,features:[e.aNF],decls:12,vars:8,consts:[["featuredCard",""],[1,"@container","featured-card"],[1,"flex","w-full","rounded-lg","cursor-pointer","h-24","@xs:h-48",3,"mouseenter","mouseleave","routerLink","queryParams"],[1,"rounded-l-lg","hidden","@lg:block","h-48","w-48",3,"defaultImage","lazyLoad"],[1,"flex","flex-col","justify-between","h-full","w-full","p-4","@xs:p-8"],[1,"text-xs","@xs:text-lg","font-semibold"],[1,"flex","gap-3"],[1,"flex","flex-col","flex-grow","gap-2"],[1,"text-2xs","@xs:text-sm","font-normal","@xs:font-semibold"],[1,"hidden","@xs:block","text-2xs","@xs:text-sm","font-normal"],[1,"rounded","bg-white","min-w-8","min-h-8","w-8","h-8","items-center","justify-center","justify-self-end","self-end","hidden","@xs:flex"],[3,"lazyLoad"]],template:function(s,g){if(1&s){const u=e.RV6();e.j41(0,"div",1,0)(2,"a",2),e.bIt("mouseenter",function(){return e.eBV(u),e.Njj(g.onMouseEnter())})("mouseleave",function(){return e.eBV(u),e.Njj(g.onMouseLeave())}),e.nrm(3,"img",3),e.j41(4,"div",4)(5,"h1",5),e.EFF(6),e.k0s(),e.j41(7,"div",6)(8,"div",7),e.DNE(9,E,2,1,"div",8)(10,y,2,1,"div",9),e.k0s(),e.DNE(11,d,2,1,"figure",10),e.k0s()()()()}2&s&&(e.R7$(2),e.Y8G("routerLink",g.routerLink())("queryParams",g.queryParams()),e.R7$(),e.Y8G("defaultImage",g.defaultImage)("lazyLoad",g.image()),e.R7$(3),e.SpI(" ",g.title()," "),e.R7$(3),e.vxM(9,g.subtitle()?9:-1),e.R7$(),e.vxM(10,g.metadata()?10:-1),e.R7$(),e.vxM(11,g.featuredIcon()?11:-1))},dependencies:[t.MD,r.iI,r.Wk,o.Un,o.Je],styles:[".featured-card[_ngcontent-%COMP%]{--background: white;--foreground: #1c2a3f;--border: transparent}.featured-card[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]{background:var(--background);color:var(--foreground);outline:1px solid var(--border)!important}"],changeDetection:0}),b})()},46075:(ge,F,n)=>{"use strict";n.d(F,{CC:()=>y,Sq:()=>r,U6:()=>C,rh:()=>v,tR:()=>P,vb:()=>E,zV:()=>_});var t=n(49204),r=function(s){return s.Audio="audio",s.Image="image",s.Video="video",s}(r||{});const o={[r.Image]:15*Math.pow(1024,2),[r.Audio]:50*Math.pow(1024,2),[r.Video]:2*Math.pow(1024,3)};function C(s){if(0===s)return"0 Byte";const u=Math.floor(Math.log(s)/Math.log(1024));return Math.round(s/Math.pow(1024,u))+" "+["Bytes","KB","MB","GB","TB"][u]}const E={[r.Audio]:"/ws/media/audio/upload",[r.Image]:"/ws/media/images/upload",[r.Video]:""},y={".svg":["image/svg+xml"],".jpg":["image/jpeg"],".jpeg":["image/jpeg"],".png":["image/png"],".aac":["audio/aac"],".m4a":["audio/mp4","audio/x-m4a"],".mp3":["audio/mpeg"],".webm":["video/webm"],".mpg":["video/mpeg"],".mp2":["video/mpeg"],".mpeg":["video/mpeg"],".mpe":["video/mpeg"],".mpv":["video/x-mpv"],".ogg":["video/ogg"],".mp4":["video/mp4"],".m4p":["video/mp4","video/x-m4p"],".m4v":["video/mp4","video/x-m4v"],".avi":["video/x-msvideo"],".wmv":["video/x-ms-wmv"],".mov":["video/quicktime"],".qt":["video/quicktime"],".flv":["video/x-flv"],".swf":["application/x-shockwave-flash"],".mpd":["application/dash+xml"],".m3u8":["application/x-mpegURL"]},d={[r.Audio]:[".aac",".m4a",".mp3"],[r.Image]:[".png",".jpg",".jpeg",".svg"],[r.Video]:[".webm",".mpg",".mp2",".mpeg",".mpe",".mpv",".ogg",".mp4",".m4p",".m4v",".avi",".wmv",".mov",".qt",".flv",".swf"]};function _(s){return[...d[s]||[]]}function v(s){const u=_(s).map(h=>function b(s){return[...y[s]||[]]}(h));return[].concat(...u)}function P(s){const g=v(s),u=o[s];return{concurrency:1,allowedContentTypes:g,...(0,t.isNil)(u)?{}:{maxFileSize:u}}}},13403:(ge,F,n)=>{"use strict";n.d(F,{j:()=>d});var t=n(60177),e=n(27878),r=n(21604),o=n(39685),C=n(45189),E=n(67575),y=n(54438);let d=(()=>{var _;class v{}return(_=v).\u0275fac=function(P){return new(P||_)},_.\u0275mod=y.$C({type:_}),_.\u0275inj=y.G2t({imports:[t.MD,r.G,C.G,E.PO,o.y,e.wR]}),v})()},39685:(ge,F,n)=>{"use strict";n.d(F,{y:()=>y});var t=n(60177),e=n(21604),r=n(45189),o=n(35286),C=n(54438);let E=(()=>{var d;class _{}return(d=_).\u0275fac=function(b){return new(b||d)},d.\u0275mod=C.$C({type:d}),d.\u0275inj=C.G2t({imports:[t.MD,e.G,o.y2.forChild()]}),_})(),y=(()=>{var d;class _{}return(d=_).\u0275fac=function(b){return new(b||d)},d.\u0275mod=C.$C({type:d}),d.\u0275inj=C.G2t({imports:[t.MD,e.G,r.G,E]}),_})()},13976:(ge,F,n)=>{"use strict";n.d(F,{V:()=>r});var t=n(65776),e=n(54438);let r=(()=>{var o;class C{isTickerBlock(y){return y.type===t.m.Ticker}isEmptyBlock(y){switch(y.type){case t.m.Markdown:return 0===y.markdown.length;case t.m.Images:case t.m.Ticker:return 0===y.images.length;case t.m.Videos:return 0===y.videos.length;case t.m.Positions:return 0===y.positions.length}}filterEmptyBlocks(y){return y.filter(d=>!this.isEmptyBlock(d))}filterContentBlocksByType(y,d=[],_=[]){return y.filter(v=>!d.length||d.includes(v.type)).filter(v=>!_.length||!_.includes(v.type))}findContentBlockByType(y,d){return this.filterContentBlocksByType(y,[d])[0]}extractContentBlockText(y,d=""){return y?y.filter(_=>_.type===t.m.Markdown).map(_=>_.markdown).join(d):""}hasContentBlockText(y){return""!==this.extractContentBlockText(y)}}return(o=C).\u0275fac=function(y){return new(y||o)},o.\u0275prov=e.jDH({token:o,factory:o.\u0275fac,providedIn:"root"}),C})()},65776:(ge,F,n)=>{"use strict";n.d(F,{m:()=>t});var t=function(e){return e.Markdown="markdown",e.Images="images",e.Ticker="ticker",e.Videos="videos",e.Positions="positions",e}(t||{})},11153:(ge,F,n)=>{"use strict";n.d(F,{hw:()=>r,v9:()=>t,vf:()=>e});let t=(()=>{class C{constructor(y){this.logoConfig=y}}return C.type="[AppConfig] Set View Logos",C})(),e=(()=>{class C{constructor(y){this.logoConfig=y}}return C.type="[AppConfig] Set Header Logos",C})(),r=(()=>{class C{constructor(){}}return C.type="[AppConfig] Reset",C})()},9632:(ge,F,n)=>{"use strict";n.d(F,{Gt:()=>b,ar:()=>y,jw:()=>d});var t=n(54438),e=n(60177),r=n(24418),o=n(12215),C=n(65763),E=n(98020);const y=new t.nKC(""),d=new t.nKC(""),_=r.c.deploy===o.Z.Production?"https://human.biodigital.com":window.location.origin,v=r.c.deploy===o.Z.Local?"https://localhost:4202":`${_}/viewer`;let b=(()=>{var P;class s{}return(P=s).\u0275fac=function(u){return new(u||P)},P.\u0275mod=t.$C({type:P}),P.\u0275inj=t.G2t({providers:[{provide:y,useValue:_},{provide:d,useValue:v}],imports:[C.rK.forFeature([E.X]),e.MD]}),s})()},98020:(ge,F,n)=>{"use strict";n.d(F,{X:()=>v});var t=n(65763);class e{}var E,r=n(20342),o=n(11153),C=n(54438),y=function(b,P,s,g){var S,u=arguments.length,h=u<3?P:null===g?g=Object.getOwnPropertyDescriptor(P,s):g;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)h=Reflect.decorate(b,P,s,g);else for(var f=b.length-1;f>=0;f--)(S=b[f])&&(h=(u<3?S(h):u>3?S(P,s,h):S(P,s))||h);return u>3&&h&&Object.defineProperty(P,s,h),h},d=function(b,P){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(b,P)};const _={viewLogoConfig:r.O,headerLogoConfig:r.O};let v=((E=class{static getViewLogoConfig(P){return P.viewLogoConfig}static getHeaderLogoConfig(P){return P.headerLogoConfig}setLogos(P,{logoConfig:s}){P.patchState({viewLogoConfig:s})}setAppHeaderLogos(P,{logoConfig:s}){P.patchState({headerLogoConfig:s})}resetAppConfig(P){P.setState({..._})}}).\u0275fac=function(P){return new(P||E)},E.\u0275prov=C.jDH({token:E,factory:E.\u0275fac}),E);y([(0,t.rc)(o.v9),d("design:type",Function),d("design:paramtypes",[Object,o.v9]),d("design:returntype",void 0)],v.prototype,"setLogos",null),y([(0,t.rc)(o.vf),d("design:type",Function),d("design:paramtypes",[Object,o.v9]),d("design:returntype",void 0)],v.prototype,"setAppHeaderLogos",null),y([(0,t.rc)(o.hw),d("design:type",Function),d("design:paramtypes",[Object]),d("design:returntype",void 0)],v.prototype,"resetAppConfig",null),y([(0,t.MD)(),d("design:type",Function),d("design:paramtypes",[e]),d("design:returntype",void 0)],v,"getViewLogoConfig",null),y([(0,t.MD)(),d("design:type",Function),d("design:paramtypes",[e]),d("design:returntype",void 0)],v,"getHeaderLogoConfig",null),v=y([(0,t.Uw)({name:"appConfig",defaults:{..._}})],v)},4845:(ge,F,n)=>{"use strict";n.d(F,{g8:()=>d,ht:()=>_});var t=n(54438),e=n(77015),o=n(26655),C=n(90908),E=n(24418);const y={accessToken:E.c.rollbarToken,captureUncaught:!1,captureUnhandledRejections:!1,autoInstrument:{log:!1},payload:{environment:E.c.deploy.toLowerCase(),application:E.c.application,engineVersion:o.A,webGLEnabled:(0,C.MN)()}},d=new t.nKC("rollbar");function _(){return new e(y)}},65294:(ge,F,n)=>{"use strict";n.d(F,{F:()=>t});var t=function(e){return e.AnnotationsCreated="annotations.created",e.AnnotationsDestroyed="annotations.destroyed",e.AnnotationsHidden="annotations.hidden",e.AnnotationsShown="annotations.shown",e.QuizEntered="quiz.entered",e.QuizExited="quiz.exited",e.QuizQuestionLoaded="quiz.questionLoaded",e.QuizAnswerSelected="quiz.answerSelected",e.QuizAnswerSubmitted="quiz.answerSubmitted",e.QuizCompleted="quiz.completed",e.LabelsCreated="labels.created",e.LabelsUpdated="labels.updated",e.LabelsMoved="labels.moved",e.LabelsDestroyed="labels.destroyed",e.LabelsChapterInfo="labels.chapterInfo",e.LabelsShown="labels.shown",e.LabelsHidden="labels.hidden",e.LabelsEnabled="labels.enabled",e.LabelsDisabled="labels.disabled",e.LabelsEntered="labels.entered",e.LabelsLeft="labels.left",e.LabelsPicked="labels.picked",e.HotspotsDisplayUpdated="hotspots.displayUpdated",e.HotspotsEntered="hotspots.entered",e.HotspotsLeft="hotspots.left",e.HotspotsPicked="hotspots.picked",e.HotspotsPositionUpdated="hotspots.positionUpdated",e.NativeDeleteData="native.deleteData",e.NativeUpgrade="native.upgrade",e.NativeRestore="native.restore",e.NativeShare="native.share",e.NativeGoogleSignUp="native.googleSignUp",e.NativeDebugMessage="native.debugMessage",e.NativeSetSdkOffline="native.setSdkOffline",e.NativeSetBaseDirectory="native.setBaseDirectory",e.WhiteboardDrawingStarted="whiteboard.drawingStarted",e.WhiteboardDrawingFinished="whiteboard.drawingFinished",e.WhiteboardModeUpdated="whiteboard.modeUpdated",e.UIUpdated="ui.updated",e.UIWindowUpdated="ui.windowUpdated",e}(t||{})},83621:(ge,F,n)=>{"use strict";n.d(F,{S:()=>r});var t=n(26982),e=n(54438);let r=(()=>{var o;class C extends t.U{}return(o=C).\u0275fac=(()=>{let E;return function(d){return(E||(E=e.xGo(o)))(d||o)}})(),o.\u0275prov=e.jDH({token:o,factory:o.\u0275fac,providedIn:"root"}),C})()},26982:(ge,F,n)=>{"use strict";n.d(F,{U:()=>e});var t=n(85052);class e{constructor(){this._subjects={}}getEvent(o){return(this._subjects[o]=this._subjects[o]??new t.B).asObservable()}fireEvent(o,C){const E=this._subjects[o];E&&E.next(C)}}},10352:(ge,F,n)=>{"use strict";n.d(F,{RK:()=>t,Vw:()=>e,aN:()=>o,vk:()=>r});const t={colors:[245,245,245,1,245,245,245,1],gradientType:"radial",colorStops:[0,100]},e={colors:[255,255,255,0,255,255,255,0],gradientType:"linear",colorStops:[0,100]},r=[{colors:[0,0,0,1,0,0,0,1],gradientType:"linear",colorStops:[0,100]},{colors:[38,38,38,1,38,38,38,1],gradientType:"linear",colorStops:[0,100]},{colors:[77,77,77,1,77,77,77,1],gradientType:"linear",colorStops:[0,100]},{colors:[115,115,115,1,115,115,115,1],gradientType:"linear",colorStops:[0,100]},{colors:[153,153,153,1,153,153,153,1],gradientType:"linear",colorStops:[0,100]},{colors:[191,191,191,1,191,191,191,1],gradientType:"linear",colorStops:[0,100]},{colors:[230,230,230,1,230,230,230,1],gradientType:"linear",colorStops:[0,100]},{colors:[255,255,255,1,255,255,255,1],gradientType:"linear",colorStops:[0,100]},{colors:[128,128,128,1,0,0,0,1],gradientType:"radial",colorStops:[0,100]},{colors:[128,128,128,1,38,38,38,1],gradientType:"radial",colorStops:[0,100]},{colors:[128,128,128,1,77,77,77,1],gradientType:"radial",colorStops:[0,100]},{colors:[128,128,128,1,115,115,115,1],gradientType:"radial",colorStops:[0,100]},{colors:[128,128,128,1,153,153,153,1],gradientType:"radial",colorStops:[0,100]},{colors:[128,128,128,1,191,191,191,1],gradientType:"radial",colorStops:[0,100]},{colors:[128,128,128,1,230,230,230,1],gradientType:"radial",colorStops:[0,100]},{colors:[128,128,128,1,255,255,255,1],gradientType:"radial",colorStops:[0,100]},{colors:[245,208,208,1,245,208,208,1],gradientType:"linear",colorStops:[0,100]},{colors:[253,236,219,1,253,236,219,1],gradientType:"linear",colorStops:[0,100]},{colors:[255,246,219,1,255,246,219,1],gradientType:"linear",colorStops:[0,100]},{colors:[220,236,213,1,220,236,213,1],gradientType:"linear",colorStops:[0,100]},{colors:[212,229,245,1,212,229,245,1],gradientType:"linear",colorStops:[0,100]},{colors:[219,212,235,1,219,212,235,1],gradientType:"linear",colorStops:[0,100]},{colors:[164,194,244,1,164,194,244,1],gradientType:"linear",colorStops:[0,100]},{colors:[118,165,175,1,118,165,175,1],gradientType:"linear",colorStops:[0,100]},{colors:[245,208,208,1,245,208,208,1],gradientType:"radial",colorStops:[0,100]},{colors:[253,236,219,1,240,169,99,1],gradientType:"radial",colorStops:[0,100]},{colors:[255,246,219,1,250,210,92,1],gradientType:"radial",colorStops:[0,100]},{colors:[220,236,213,1,147,188,129,1],gradientType:"radial",colorStops:[0,100]},{colors:[212,229,245,1,112,164,213,1],gradientType:"radial",colorStops:[0,100]},{colors:[219,212,235,1,145,128,187,1],gradientType:"radial",colorStops:[0,100]},{colors:[164,194,244,1,112,164,213,1],gradientType:"radial",colorStops:[0,100]},{colors:[211,211,211,1,118,165,175,1],gradientType:"radial",colorStops:[0,100]}],o=[...r,{colors:[10,132,130,255,5,43,51,255],gradientType:"radial",colorStops:[0,68]},{colors:[0,28,84,1,0,0,0,1],gradientType:"radial",colorStops:[12,100]}]},93253:(ge,F,n)=>{"use strict";n.d(F,{w:()=>d});var t=n(34006),e=n(54438),r=n(60177),o=n(21007);function C(_,v){if(1&_&&(e.j41(0,"button",7),e.EFF(1),e.k0s()),2&_){const b=e.XpG();e.R7$(),e.SpI(" ",b.settings.miscText," ")}}function E(_,v){if(1&_&&(e.j41(0,"button",8),e.EFF(1),e.k0s()),2&_){const b=e.XpG();e.Y8G("mat-dialog-close",!1),e.R7$(),e.SpI(" ",b.settings.cancelText," ")}}function y(_,v){if(1&_&&(e.j41(0,"button",9),e.EFF(1),e.k0s()),2&_){const b=e.XpG();e.Y8G("mat-dialog-close",!0),e.R7$(),e.SpI(" ",b.settings.confirmText," ")}}let d=(()=>{var _;class v{constructor(P,s){this.dialogRef=P,this.data=s,this.settings={titleText:"Confirm Action",bodyText:"",confirmText:"Confirm",confirmColor:"primary",cancelText:"Cancel",confirmEnabled:!0,cancelEnabled:!0,miscText:""},s&&(this.settings={...this.settings,...s})}ngOnInit(){}}return(_=v).\u0275fac=function(P){return new(P||_)(e.rXU(t.CP),e.rXU(t.Vh))},_.\u0275cmp=e.VBU({type:_,selectors:[["app-confirm-dialog"]],decls:9,vars:5,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[1,"text-sm"],["mat-dialog-actions",""],["app-button","","buttonTheme","light",3,"mat-dialog-close",4,"ngIf"],["type","button","app-button","","buttonTheme","light","data-test","confirmDialogCancelButton",3,"mat-dialog-close",4,"ngIf"],["type","button","app-button","","buttonType","primary","data-test","confirmDialogConfirmButton","cdkFocusInitial","",3,"mat-dialog-close",4,"ngIf"],["app-button","","buttonTheme","light",3,"mat-dialog-close"],["type","button","app-button","","buttonTheme","light","data-test","confirmDialogCancelButton",3,"mat-dialog-close"],["type","button","app-button","","buttonType","primary","data-test","confirmDialogConfirmButton","cdkFocusInitial","",3,"mat-dialog-close"]],template:function(P,s){1&P&&(e.j41(0,"h1",0),e.EFF(1),e.k0s(),e.j41(2,"div",1)(3,"div",2),e.EFF(4),e.k0s()(),e.j41(5,"div",3),e.DNE(6,C,2,1,"button",4)(7,E,2,2,"button",5)(8,y,2,2,"button",6),e.k0s()),2&P&&(e.R7$(),e.JRh(s.settings.titleText),e.R7$(3),e.JRh(s.settings.bodyText),e.R7$(2),e.Y8G("ngIf",s.settings.miscText),e.R7$(),e.Y8G("ngIf",s.settings.cancelEnabled),e.R7$(),e.Y8G("ngIf",s.settings.confirmEnabled))},dependencies:[r.bT,t.tx,t.BI,t.E7,t.Yi,o.Q],styles:["[_nghost-%COMP%]{display:block}.dialog__actions[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between;align-items:center;width:100%}.dialog__actions--compact[_ngcontent-%COMP%]{justify-content:flex-end}@media (min-width: 480px){[_nghost-%COMP%]{min-width:320px}}"],changeDetection:0}),v})()},63181:(ge,F,n)=>{"use strict";n.d(F,{Y:()=>h});var t=n(54438),e=n(89417),r=n(34006),o=n(65763),C=n(29160),E=n(85052),y=n(37925),d=n(47632),_=n(95416),v=n(60177),b=n(82765),P=n(21007),s=n(97352);function g(S,f){1&S&&(t.qex(0),t.nrm(1,"app-spinner",15),t.EFF(2," Deleting "),t.bVm())}function u(S,f){1&S&&t.EFF(0,"Delete")}let h=(()=>{var S;class f{constructor(i,c,a,l,p,A){this.store=i,this.actions=c,this.snackBar=a,this.formBuilder=l,this.dialogRef=p,this.data=A,this.settings=(0,t.vPA)({bookmarks:[]}),this.deleting$=new C.t(!1),this.ngUnsubscribe=new E.B,this.noun=(0,t.EWP)(()=>1===this.settings().bookmarks.length?"model":"models"),this.countedNoun=(0,t.EWP)(()=>`${1===this.settings().bookmarks.length?"":`${this.settings().bookmarks.length} `}${this.noun()}`),this.adjective=(0,t.EWP)(()=>1===this.settings().bookmarks.length?"this":"these"),this.settings.set({...this.settings(),...A})}ngOnInit(){this.initStateListeners(),this.initForm()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}initStateListeners(){this.actions.pipe((0,o.xi)(d.CF,d.CR),(0,y.Q)(this.ngUnsubscribe)).subscribe(()=>{this.deleting$.next(!0)}),this.actions.pipe((0,o.xi)(d.te,d.DN),(0,y.Q)(this.ngUnsubscribe)).subscribe(i=>{this.deleting$.next(!1),this.handleDeleteSuccess(i)}),this.actions.pipe((0,o.xi)(d.C$,d.Qw),(0,y.Q)(this.ngUnsubscribe)).subscribe(i=>{this.deleting$.next(!1),this.handleDeleteFailure(i)})}initForm(){this.form=this.formBuilder.group({confirm:[!1,e.k0.requiredTrue]})}handleDeleteSuccess(i){this.dialogRef.close(!0)}handleDeleteFailure(i){this.snackBar.open(`There was an error deleting the ${i.bookmarkIds.length} requested ${this.noun}.`)}handleCancelClick(){this.dialogRef.close(!1)}handleDeleteClick(){const i=this.settings().bookmarks.map(c=>c.id);this.store.dispatch(1===i.length?new d.CR(i[0]):new d.CF(i))}}return(S=f).\u0275fac=function(i){return new(i||S)(t.rXU(o.il),t.rXU(o.En),t.rXU(_.UG),t.rXU(e.ze),t.rXU(r.CP),t.rXU(r.Vh))},S.\u0275cmp=t.VBU({type:S,selectors:[["app-delete-bookmarks-dialog"]],decls:39,vars:20,consts:[["defaultTmp",""],["mat-dialog-title",""],["mat-dialog-content",""],[1,"dialog",3,"formGroup"],[1,"text-sm","theme-light"],[1,"font-bold"],[1,"ml-4","list-disc"],[1,"mt-2"],[1,"mt-6"],["formControlName","confirm"],[2,"white-space","normal"],["mat-dialog-actions",""],["app-button","","buttonTheme","light","buttonType","default",3,"click","disabled"],["app-button","","buttonType","primary",3,"click","disabled"],[4,"ngIf","ngIfElse"],["size","small","render","inline",1,"mr-1"]],template:function(i,c){if(1&i){const a=t.RV6();t.j41(0,"h1",1),t.EFF(1),t.nI1(2,"titlecase"),t.k0s(),t.j41(3,"div",2)(4,"div",3)(5,"div",4)(6,"div"),t.EFF(7," Are you sure you want to "),t.j41(8,"em",5),t.EFF(9),t.k0s(),t.EFF(10," from My Library? "),t.j41(11,"ul",6)(12,"li",7),t.EFF(13),t.j41(14,"em",5),t.EFF(15,"Private"),t.k0s(),t.EFF(16," or "),t.j41(17,"em",5),t.EFF(18,"Team"),t.k0s(),t.EFF(19," collections. "),t.k0s(),t.j41(20,"li",7),t.EFF(21," This action "),t.j41(22,"em",5),t.EFF(23,"cannot be undone"),t.k0s(),t.EFF(24),t.k0s()()(),t.j41(25,"div",8)(26,"mat-checkbox",9)(27,"span",10),t.EFF(28),t.k0s()()()()()(),t.j41(29,"div",11)(30,"button",12),t.nI1(31,"async"),t.bIt("click",function(){return t.eBV(a),t.Njj(c.handleCancelClick())}),t.EFF(32," Cancel "),t.k0s(),t.j41(33,"button",13),t.nI1(34,"async"),t.bIt("click",function(){return t.eBV(a),t.Njj(c.handleDeleteClick())}),t.DNE(35,g,3,0,"ng-container",14),t.nI1(36,"async"),t.DNE(37,u,1,0,"ng-template",null,0,t.C5r),t.k0s()()}if(2&i){const a=t.sdS(38);t.R7$(),t.SpI("Delete ",t.bMT(2,12,c.countedNoun()),""),t.R7$(3),t.Y8G("formGroup",c.form),t.R7$(5),t.Lme("permanently delete ",c.adjective()," ",c.countedNoun(),""),t.R7$(4),t.SpI(" The ",c.noun()," will be no longer be available in your "),t.R7$(11),t.SpI(", and the ",c.noun()," cannot be recovered. "),t.R7$(4),t.Lme("I confirm that I want to permanently delete ",c.adjective()," ",c.countedNoun(),"."),t.R7$(2),t.Y8G("disabled",t.bMT(31,14,c.deleting$)),t.R7$(3),t.Y8G("disabled",c.form.invalid||t.bMT(34,16,c.deleting$)),t.R7$(2),t.Y8G("ngIf",t.bMT(36,18,c.deleting$))("ngIfElse",a)}},dependencies:[v.bT,b.So,r.BI,r.E7,r.Yi,P.Q,s.tI,e.BC,e.cb,e.j4,e.JD,v.Jj,v.PV],styles:[".dialog[_ngcontent-%COMP%]{max-width:520px}.dialog__list[_ngcontent-%COMP%]{list-style-type:disc;margin:0;padding-left:40px}"],changeDetection:0}),f})()},26629:(ge,F,n)=>{"use strict";n.d(F,{V:()=>te,f:()=>R});var N,t=n(34006),e=n(65763),r=n(21424),o=n(85052),C=n(15877),E=n(82656),y=n(2573),d=n(89417),_=n(47632),v=n(65459),b=n(87996),P=n(14264),s=n(17365),g=n(37925),u=n(18152),h=n(21523),S=n(16606),f=n(49204),i=n(16823),c=n(7213),a=n(70737),l=n(28696),p=n(54438),A=n(95416),O=n(60177),L=n(82765),k=n(5951),q=n(53719),B=n(21007),j=n(87505),V=n(98101),M=n(97352),W=function(D,T,re,K){var U,ae=arguments.length,ce=ae<3?T:null===K?K=Object.getOwnPropertyDescriptor(T,re):K;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)ce=Reflect.decorate(D,T,re,K);else for(var Z=D.length-1;Z>=0;Z--)(U=D[Z])&&(ce=(ae<3?U(ce):ae>3?U(T,re,ce):U(T,re))||ce);return ae>3&&ce&&Object.defineProperty(T,re,ce),ce},$=function(D,T){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(D,T)};function ne(D,T){if(1&D&&(p.j41(0,"p",15),p.EFF(1),p.k0s()),2&D){const re=p.XpG();p.R7$(),p.SpI(" ",re.settings.message," ")}}function Q(D,T){1&D&&(p.j41(0,"mat-error"),p.EFF(1,"Please enter a valid title."),p.k0s())}function le(D,T){1&D&&(p.j41(0,"app-form-field",18)(1,"mat-radio-group",19)(2,"mat-radio-button",20),p.EFF(3,"Private "),p.k0s(),p.j41(4,"mat-radio-button",21),p.EFF(5,"Team - View Only "),p.k0s(),p.j41(6,"mat-radio-button",22),p.EFF(7,"Team - View & Edit "),p.k0s()()())}function pe(D,T){if(1&D&&(p.j41(0,"div",25)(1,"mat-checkbox",26),p.EFF(2),p.k0s()()),2&D){const re=T.$implicit;p.Y8G("formGroupName",T.index),p.R7$(2),p.SpI(" ",re.get("title").value," ")}}function ie(D,T){if(1&D&&(p.j41(0,"app-form-field",23),p.DNE(1,pe,3,2,"div",24),p.k0s()),2&D){const re=p.XpG(2);p.R7$(),p.Y8G("ngForOf",re.collectionsArray.controls)}}function be(D,T){if(1&D&&(p.j41(0,"div"),p.DNE(1,le,8,0,"app-form-field",16)(2,ie,2,1,"app-form-field",17),p.nI1(3,"async"),p.k0s()),2&D){let re;const K=p.XpG();p.R7$(),p.Y8G("ngIf",K.isNew||K.isOwner),p.R7$(),p.Y8G("ngIf",(null==(re=p.bMT(3,2,K.collections$))?null:re.length)>0)}}function de(D,T){1&D&&(p.j41(0,"div")(1,"app-form-field",27)(2,"mat-checkbox",28)(3,"span",29),p.EFF(4,"With the BioDigital Community"),p.k0s()()()())}function w(D,T){1&D&&p.nrm(0,"app-spinner",30)}var te=function(D){return D[D.SaveStory=0]="SaveStory",D[D.Manage=1]="Manage",D[D.Copy=2]="Copy",D[D.Duplicate=3]="Duplicate",D}(te||{});class R{get saving$(){return this.settings.mode===te.Copy?this.bookmarkCopying$:this.bookmarkSaving$}get dialogTitle(){if(this.settings.title)return this.settings.title;switch(this.settings.mode){case te.Manage:return"Manage";case te.SaveStory:return"Save";case te.Copy:return"Add to My Library";case te.Duplicate:return"Duplicate"}}constructor(T,re,K,ae,ce,U,Z,z,H){this.store=T,this.fb=re,this.dialogRef=K,this.data=ae,this.snackbar=ce,this.actions=U,this.organizationsService=Z,this.storyService=z,this.changeRef=H,this.disablePristine=!1,this.collectionsDirty=!1,this.nameAccessDirty=!1,this.collectionsLoading=!1,this.collectionsEnabled=!1,this.collectionsMap=new Map,this.contentCollections=new Map,this.submit=new o.B,this.settings={mode:te.SaveStory},this.saveBookmarkDialogMode=te,this.canAddTeamBookmarks=!1,this.ngUnsubscribe=new o.B,this.settings={...this.settings,...ae};const{bookmark:J}=this.settings;this.groupModule=!!J&&c.Cy(J),this.form=this.fb.group({title:[{value:"",disabled:this.groupModule},[d.k0.required,d.k0.maxLength(60)]],collections:new d.Bm([]),groupAccess:[{value:null,disabled:this.groupModule}],publicAccess:[!1]}),this.collectionsArray=this.form.get("collections"),this.actions.pipe((0,e.xi)(_.x$),(0,g.Q)(this.ngUnsubscribe)).subscribe(Y=>this.handleSaveSuccess(Y)),this.actions.pipe((0,e.xi)(_.Ur),(0,g.Q)(this.ngUnsubscribe)).subscribe(Y=>this.handleSaveFailure(Y.bookmarkEntry.title)),this.actions.pipe((0,e.xi)(_.lN),(0,g.Q)(this.ngUnsubscribe)).subscribe(Y=>this.handleCopySuccess(Y)),this.actions.pipe((0,e.xi)(_.Cr),(0,g.Q)(this.ngUnsubscribe)).subscribe(()=>this.handleCopyFailure()),this.groupModule&&(this.actions.pipe((0,e.xi)(_.u),(0,g.Q)(this.ngUnsubscribe)).subscribe(Y=>{this.handleSaveSuccess(Y),this.store.dispatch(new l.w.SearchStudio)}),this.actions.pipe((0,e.xi)(_.Ny),(0,g.Q)(this.ngUnsubscribe)).subscribe(Y=>this.handleSaveFailure(Y.bookmark.title))),this.submit.pipe((0,b.B)(100),(0,g.Q)(this.ngUnsubscribe)).subscribe(()=>this.onDebouncedSubmit())}ngOnInit(){const T=this.store.selectSnapshot(r.q.getOrganization);T&&!this.store.selectSnapshot(r.q.getCollections)&&this.store.dispatch(new u._q(T.id));const re=this.settings.bookmark;let K=re?re.title:this.settings.bookmarkTitle?this.settings.bookmarkTitle:"";this.settings.mode===te.Duplicate&&(K=("Copy of "+K).slice(0,60));let ae=!1,ce=!1;const U=re?this.getGroupAccess(re):null;this.groupModule?(ae=!1,ce=!0):U?(ae=U.member_edit,ce=!ae&&U.visible):!re&&T&&(ae=!1,ce=!0);const Z=!this.isGroupUser()&&re&&re.tags.includes("public");if(this.form.patchValue({title:K,groupAccess:ae?"edit":ce?"view":"",publicAccess:Z}),this.trackNameAccessDirty(),this.isNew=!0,this.isOwner=!0,re){const z=this.store.selectSnapshot(i.k.getUserRole);c.dE(z,re)?(this.isNew=!1,this.isOwner=!0):(this.isNew=!0,this.isOwner=this.isNew)}this.initGroupAccess(),this.initCollections(),this.toggleGroupAccess(ce,ae),this.initPermissions(),this.dialogRef.beforeClosed().pipe((0,g.Q)(this.ngUnsubscribe)).subscribe(()=>{this.checkCancelSave()})}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}initGroupAccess(){this.form.get("groupAccess").valueChanges.pipe((0,g.Q)(this.ngUnsubscribe)).subscribe(re=>{this.toggleGroupAccess("view"===re,"edit"===re)})}initCollections(){const T=this.settings.bookmark,re=this.store.selectSnapshot(r.q.getOrganization);let K=(0,C.of)([]);re&&T&&(this.collectionsLoading=!0,K=this.organizationsService.getCollections({group_id:re.id,content_type:T.type,content_id:T.id,include_content:1})),(0,E.z)([this.collections$,K]).pipe((0,P.p)(([ae])=>!(0,f.isNil)(ae)),(0,g.Q)(this.ngUnsubscribe)).subscribe(([ae,ce])=>{ce.forEach(U=>{this.contentCollections.set(U.collection_id,(0,f.get)(U,"collection_content[0].collection_content_id",null))}),this.collectionsArray.clear(),ae.forEach(U=>{this.collectionsMap.set(U.collection_id,U);const Z=this.contentCollections.get(U.collection_id);this.collectionsArray.push(this.fb.group({title:U.collection_name,id:U.collection_id,checked:[{value:!(0,f.isNil)(Z),disabled:!this.collectionsEnabled}]}))}),this.trackCollectionsDirty(),this.collectionsLoading=!1,this.changeRef.markForCheck()})}trackNameAccessDirty(){const T={title:this.form.value.title,groupAccess:this.form.value.groupAccess,publicAccess:this.form.value.publicAccess};this.form.valueChanges.pipe((0,g.Q)(this.ngUnsubscribe)).subscribe(re=>{this.nameAccessDirty=!(0,f.isEqual)(T,{title:re.title,groupAccess:re.groupAccess,publicAccess:re.publicAccess}),this.setDisablePristine()})}trackCollectionsDirty(){const T=this.collectionsArray.value;this.collectionsArray.valueChanges.pipe((0,g.Q)(this.ngUnsubscribe)).subscribe(re=>{this.collectionsDirty=!(0,f.isEqual)(T,re),this.setDisablePristine()})}initPermissions(){(0,E.z)([this.userRole$,this.organization$]).pipe((0,g.Q)(this.ngUnsubscribe)).subscribe(([T,re])=>{this.canAddTeamBookmarks=!(0,f.isNil)(re)&&c._m(T,a.y.AddTeamBookmarks),this.changeRef.markForCheck()})}toggleGroupAccess(T,re){this.setCollectionsEnabled((this.isOwner||this.isNew)&&(T||re))}handleSubmit(){this.form.valid&&this.submit.next()}onDebouncedSubmit(){const T=this.settings.bookmark,re=this.getBookmarkEntry();switch(this.settings.mode){case te.Duplicate:case te.Copy:{const K=this.store.selectSnapshot(i.k.getUserLanguage),ae=this.canAddTeamBookmarks?(0,f.get)(re,"add_group_access[0]"):void 0;this.store.dispatch(new _.eW(re.id,re.title,T.type,K,ae,this.canAddTeamBookmarks?re.addCollections:void 0));break}case te.SaveStory:case te.Manage:this.groupModule?this.store.dispatch(new _.Pd(T,re.addCollections,re.removeCollections)):this.saveBookmark(T,re)}}saveBookmark(T,re){const K=this.settings.mode===te.SaveStory;(T&&T.id&&this.settings.mode===te.Manage?this.storyService.getStory(T.id,T.type):(0,C.of)(void 0)).pipe((0,s.s)(1),(0,g.Q)(this.ngUnsubscribe)).subscribe(ce=>{ce&&ce.displayName!==re.title&&(re.index={...ce,displayName:re.title}),this.store.dispatch(new _.iy(re,!1,K))})}handleCancelClick(){this.dialogRef.close()}handleSaveSuccess(T){const re=T.bookmark;this.snackbar.open(this.settings.mode===te.Manage?`Your updates to "${re.title}" have been saved to your library.`:`"${re.title}" saved to your library.`),this.dialogRef.close(re)}handleSaveFailure(T){this.snackbar.open(`Unable to save bookmark "${T}". Please try again.`)}handleCopySuccess(T){this.snackbar.open(`"${T.newBookmark.title}" saved to your library.`),this.dialogRef.close(T.newBookmark)}handleCopyFailure(){this.snackbar.open("There was an error adding to your library")}getBookmarkEntry(){const T=this.settings.bookmark,re=this.settings.viewMode??T.viewMode,{title:K,groupAccess:ae,publicAccess:ce}=this.form.value,U="view"===ae,Z="edit"===ae,z=this.isGroupUser()?null:ce;let H=[],J=[];const Y=[],X=new Map;if(this.isOwner){const se=this.createGroupAccess(U,Z);se?H=[se]:J=T?T.group_access:[],this.collectionsArray.value.forEach(oe=>{const me=this.collectionsMap.get(oe.id),Se=this.contentCollections.get(oe.id);this.collectionsEnabled?((0,f.isNil)(Se)||this.settings.mode===te.Duplicate)&&oe.checked?Y.push(me):!(0,f.isNil)(Se)&&!oe.checked&&X.set(me,Se):(0,f.isNil)(Se)||X.set(me,Se)})}return{isOwner:!T||this.isOwner,id:T?T.id:null,title:K,viewMode:re,add_group_access:H,remove_group_access:J,addCollections:Y,removeCollections:X,public_access:z}}getBookmarkCopyEntryModel(T,re){const{title:K,groupAccess:ae}=this.form.value,ce="view"===ae,U="edit"===ae,Z=[];return this.isOwner&&this.collectionsArray.value.forEach(({id:z,checked:H})=>{this.collectionsEnabled&&H&&Z.push(z)}),{content_type:"bookmark"===T.type?"bookmark":"module",content_id:T.id,lang_code:re,bk_name:K,group_access:{add_to_group:ce||U?1:0,visibility:ce?1:0,member_edit:U?1:0,add_to_collections:Z}}}getGroupAccess(T){const re=this.store.selectSnapshot(r.q.getOrganization);let K=null;if(re&&T.group_access){const ae=re.id;K=T.group_access.find(ce=>ce.group_id===ae)}return K}createGroupAccess(T,re){const K=this.store.selectSnapshot(r.q.getOrganization);return K&&(T||re)?{group_id:K.id,member_edit:re,visible:T||re}:null}isGroupUser(){return!!this.store.selectSnapshot(r.q.getOrganization)}checkCancelSave(){this.store.selectSnapshot(this.settings.mode===te.Copy?h.J.getCopying:h.J.getSaving)&&this.store.dispatch(this.settings.mode===te.Copy?new _.M:new _.A)}setCollectionsEnabled(T){this.collectionsEnabled=T,this.collectionsArray.controls.forEach(re=>{T?re.enable():re.disable()})}setDisablePristine(){this.disablePristine=this.settings.mode===te.Manage&&!this.collectionsDirty&&!this.nameAccessDirty,this.changeRef.markForCheck()}}(N=R).\u0275fac=function(T){return new(T||N)(p.rXU(e.il),p.rXU(d.ze),p.rXU(t.CP),p.rXU(t.Vh),p.rXU(A.UG),p.rXU(e.En),p.rXU(v.k),p.rXU(S.J),p.rXU(p.gRc))},N.\u0275cmp=p.VBU({type:N,selectors:[["app-save-bookmark-dialog"]],decls:24,vars:18,consts:[["title",""],["mat-dialog-title",""],["mat-dialog-content",""],[1,"save"],[3,"submit","formGroup"],["class","save__message",4,"ngIf"],[1,"theme-light"],["theme","light","label","Title"],["type","text","name","title","maxlength","60","autocomplete","off","formControlName","title","required","","aria-label","Title","data-test","bookmarkTitleInput",1,"input"],[3,"field"],[4,"ngIf"],["mat-dialog-actions",""],["type","button","app-button","","buttonTheme","light",3,"click"],["type","submit","app-button","","buttonType","primary","data-test","saveButton",3,"click","disabled"],["size","medium","class","ml-2","render","inline",4,"ngIf"],[1,"save__message"],["theme","light","label","Permissions",4,"ngIf"],["theme","light","label","Collection (Optional)","aria-label","Collection (Optional)","data-test","saveCollection","formArrayName","collections",4,"ngIf"],["theme","light","label","Permissions"],["formControlName","groupAccess","aria-label","Permission",1,"save__radio-group","text-xs","mt-2"],["value","","data-test","groupAccessPrivateButton"],["value","view","data-test","groupAccessViewButton"],["value","edit","data-test","groupAccessEditButton"],["theme","light","label","Collection (Optional)","aria-label","Collection (Optional)","data-test","saveCollection","formArrayName","collections"],[3,"formGroupName",4,"ngFor","ngForOf"],[3,"formGroupName"],["data-test","saveCollectionCheckbox","formControlName","checked",1,"save__collection","text-xs"],["theme","light","label","Share"],["formControlName","publicAccess",1,"save__permission"],[1,"text-xs"],["size","medium","render","inline",1,"ml-2"]],template:function(T,re){if(1&T){const K=p.RV6();p.j41(0,"h1",1),p.EFF(1),p.k0s(),p.j41(2,"div",2)(3,"div",3)(4,"form",4),p.bIt("submit",function(){return p.eBV(K),p.Njj(re.handleSubmit())}),p.DNE(5,ne,2,1,"p",5),p.j41(6,"div",6)(7,"app-form-field",7),p.nrm(8,"input",8,0)(10,"app-character-counter",9),p.DNE(11,Q,2,0,"mat-error",10),p.k0s(),p.DNE(12,be,4,4,"div",10)(13,de,5,0,"div",10),p.nI1(14,"async"),p.k0s()()()(),p.j41(15,"div",11)(16,"button",12),p.bIt("click",function(){return p.eBV(K),p.Njj(re.handleCancelClick())}),p.EFF(17,"Cancel"),p.k0s(),p.j41(18,"button",13),p.nI1(19,"async"),p.bIt("click",function(){return p.eBV(K),p.Njj(re.handleSubmit())}),p.EFF(20),p.nI1(21,"async"),p.DNE(22,w,1,0,"app-spinner",14),p.nI1(23,"async"),p.k0s()()}if(2&T){const K=p.sdS(9);p.R7$(),p.JRh(re.dialogTitle),p.R7$(3),p.Y8G("formGroup",re.form),p.R7$(),p.Y8G("ngIf",re.settings.message),p.R7$(5),p.Y8G("field",K),p.R7$(),p.Y8G("ngIf",re.form.get("title").invalid),p.R7$(),p.Y8G("ngIf",re.canAddTeamBookmarks),p.R7$(),p.Y8G("ngIf",!p.bMT(14,10,re.organization$)&&re.settings.mode!==re.saveBookmarkDialogMode.Copy),p.R7$(5),p.Y8G("disabled",re.disablePristine||re.collectionsLoading||p.bMT(19,12,re.saving$)),p.R7$(2),p.SpI(" ",p.bMT(21,14,re.saving$)?"Saving":"Save"," "),p.R7$(2),p.Y8G("ngIf",p.bMT(23,16,re.saving$))}},dependencies:[O.Sq,O.bT,L.So,k.VT,k._g,q.TL,t.BI,t.E7,t.Yi,B.Q,j.K,V.P,M.tI,d.qT,d.me,d.BC,d.cb,d.YS,d.tU,d.j4,d.JD,d.$R,d.v8,O.Jj],styles:[".save__message[_ngcontent-%COMP%]{color:#61779e;margin:12px auto;font-size:12px}.save__radio-group[_ngcontent-%COMP%]{display:flex;flex-direction:column}.save__permission[_ngcontent-%COMP%]{display:block;margin:4px auto}@media (min-width: 768px){.save[_ngcontent-%COMP%]{min-width:380px}}@media (max-width: 767px){.save[_ngcontent-%COMP%]{min-width:65vw}}"],changeDetection:0}),W([(0,e.l6)(i.k.getUserRole),$("design:type",y.c)],R.prototype,"userRole$",void 0),W([(0,e.l6)(r.q.getOrganization),$("design:type",y.c)],R.prototype,"organization$",void 0),W([(0,e.l6)(r.q.getCollections),$("design:type",y.c)],R.prototype,"collections$",void 0),W([(0,e.l6)(h.J.getSaving),$("design:type",y.c)],R.prototype,"bookmarkSaving$",void 0),W([(0,e.l6)(h.J.getCopying),$("design:type",y.c)],R.prototype,"bookmarkCopying$",void 0)},27800:(ge,F,n)=>{"use strict";n.d(F,{I:()=>E});var t=n(60177),e=n(45189),r=n(21604),o=n(89417),C=n(54438);let E=(()=>{var y;class d{}return(y=d).\u0275fac=function(v){return new(v||y)},y.\u0275mod=C.$C({type:y}),y.\u0275inj=C.G2t({imports:[t.MD,e.G,r.G,o.X1]}),d})()},84178:(ge,F,n)=>{"use strict";n.d(F,{i:()=>u});var t=n(24418),e=n(54438),r=n(38645),o=n(60177),C=n(21007),E=n(26779),y=n(77242),d=n(41640);const _=h=>({"signup-messaging--compact":h});function v(h,S){if(1&h&&(e.j41(0,"app-list-item")(1,"div",11),e.nrm(2,"app-icon",12),e.j41(3,"div"),e.EFF(4),e.k0s()()()),2&h){const f=S.$implicit;e.R7$(4),e.JRh(f)}}function b(h,S){if(1&h&&(e.qex(0),e.EFF(1," Unlock full access to the BioDigital library: "),e.j41(2,"div",8)(3,"app-list",9),e.DNE(4,v,5,1,"app-list-item",10),e.k0s()(),e.bVm()),2&h){const f=e.XpG();e.R7$(4),e.Y8G("ngForOf",f.features)}}function P(h,S){1&h&&(e.qex(0),e.EFF(1," Create a free account to explore 1000+ anatomy, physiology, and treatment models in interactive 3D. "),e.bVm())}function s(h,S){if(1&h){const f=e.RV6();e.j41(0,"button",13),e.bIt("click",function(){e.eBV(f);const i=e.XpG();return e.Njj(i.handleLearnMoreClick())}),e.EFF(1," Learn More "),e.k0s()}if(2&h){const f=e.XpG();e.Y8G("buttonSize",f.compact?"md":"lg"),e.BMQ("aria-label","Learn More")}}function g(h,S){if(1&h&&(e.j41(0,"p",14)(1,"a",15),e.EFF(2,"Already have an account? Sign in"),e.k0s()()),2&h){const f=e.XpG();e.R7$(),e.Y8G("queryParams",f.loginUrlParams)}}let u=(()=>{var h;class S{constructor(m,i){this.activatedRoute=m,this.router=i,this.features=["Complete male and female anatomy","600+ health condition and treatment 3D models","200+ 3D anatomy quizzes","Animated 3D models and virtual 3D tours"],this.compact=!1,this.loginUrlParams={}}ngOnInit(){this.loginUrlParams={returnUrl:this.router.url}}handleSignUpClick(m){this.router.navigate(["/login/create"],{queryParams:{returnUrl:this.router.url,ref:this.activatedRoute.snapshot.queryParams.ref||"share",utm_source:t.c.native?"human_mobile":"human_web",utm_campaign:"share",utm_medium:"PLG"}}),m.stopImmediatePropagation()}handleLearnMoreClick(){window.open(`https://www.biodigital.com?utm_source=${t.c.native?"human_mobile":"human_web"}&utm_medium=PLG&utm_campaign=share&ref=share`)}}return(h=S).\u0275fac=function(m){return new(m||h)(e.rXU(r.nX),e.rXU(r.Ix))},h.\u0275cmp=e.VBU({type:h,selectors:[["app-signup-messaging"]],inputs:{compact:"compact"},decls:9,vars:9,consts:[[1,"flex","flex-col","items-center","signup-messaging",3,"ngClass"],[1,"signup-messaging__content",3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[1,"signup-messaging__actions"],["type","button","app-button","","buttonType","primary","buttonTheme","light","title","Sign Up For Free","data-test","signupMessageButton",3,"click","buttonSize"],["type","button","app-button","","buttonType","outline","buttonTheme","light","title","Learn More",3,"buttonSize","click",4,"ngIf"],["class","signup-messaging__footer",4,"ngIf"],[1,"mt-7"],["listType","flat",1,"mt-2"],[4,"ngFor","ngForOf"],[1,"flex","flex-row","my-1","signup-messaging__list-item"],["icon","check",1,"mr-2"],["type","button","app-button","","buttonType","outline","buttonTheme","light","title","Learn More",3,"click","buttonSize"],[1,"signup-messaging__footer"],["routerLink","/login",1,"signup-messaging__link","link",3,"queryParams"]],template:function(m,i){1&m&&(e.j41(0,"div",0)(1,"p",1),e.DNE(2,b,5,1,"ng-container",2)(3,P,2,0,"ng-container",3),e.k0s(),e.j41(4,"div",4)(5,"button",5),e.bIt("click",function(a){return i.handleSignUpClick(a)}),e.EFF(6," Sign Up For Free "),e.k0s(),e.DNE(7,s,2,2,"button",6),e.k0s(),e.DNE(8,g,3,1,"p",7),e.k0s()),2&m&&(e.Y8G("ngClass",e.eq3(7,_,i.compact)),e.R7$(),e.Y8G("ngSwitch",i.compact),e.R7$(),e.Y8G("ngSwitchCase",!0),e.R7$(3),e.Y8G("buttonSize",i.compact?"md":"lg"),e.BMQ("aria-label","Sign Up For Free"),e.R7$(2),e.Y8G("ngIf",!i.compact),e.R7$(),e.Y8G("ngIf",!i.compact))},dependencies:[o.YU,o.Sq,o.bT,o.ux,o.e1,o.fG,r.Wk,C.Q,E.R,y.s,d.P],styles:[".signup-messaging[_ngcontent-%COMP%]{background-color:#fff}.signup-messaging__content[_ngcontent-%COMP%]{color:#101823;font-size:1.25rem;line-height:1.75rem;font-weight:600;max-width:632px;text-align:center}.signup-messaging__list-item[_ngcontent-%COMP%]{font-size:.875rem;line-height:1.25rem;font-weight:400;color:#283853}.signup-messaging__actions[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;gap:32px;margin-top:40px}.signup-messaging__footer[_ngcontent-%COMP%]{color:#283853;font-size:.875rem;line-height:1.25rem;margin-top:28px}.signup-messaging__link[_ngcontent-%COMP%]{text-decoration:underline;color:#283853}.signup-messaging--compact[_ngcontent-%COMP%]{padding:40px 60px;border-radius:8px}.signup-messaging--compact[_ngcontent-%COMP%]   .signup-messaging__content[_ngcontent-%COMP%]{font-size:1.25rem;line-height:1.75rem;text-align:left}.signup-messaging--compact[_ngcontent-%COMP%]   .signup-messaging__actions[_ngcontent-%COMP%]{margin-top:28px}.signup-messaging--compact[_ngcontent-%COMP%]   .signup-messaging__footer[_ngcontent-%COMP%]{font-size:.75rem;line-height:1rem}@media (max-width: 959px){.signup-messaging--compact[_ngcontent-%COMP%]{padding:24px}.signup-messaging--compact[_ngcontent-%COMP%]   .signup-messaging__content[_ngcontent-%COMP%]{font-size:.875rem;line-height:1.25rem}.signup-messaging--compact[_ngcontent-%COMP%]   .signup-messaging__list-item[_ngcontent-%COMP%]{font-size:.75rem;line-height:1rem}.signup-messaging--compact[_ngcontent-%COMP%]   .signup-messaging__actions[_ngcontent-%COMP%]{margin-top:20px}}@media (max-width: 480px){.signup-messaging__content[_ngcontent-%COMP%]{font-size:1rem;line-height:1.5rem}.signup-messaging__actions[_ngcontent-%COMP%]{width:80%;flex-direction:column;align-items:stretch;gap:16px;margin-top:28px}}"],changeDetection:0}),S})()},91060:(ge,F,n)=>{"use strict";n.d(F,{w:()=>E});var t=n(60177),e=n(45189),r=n(21604),o=n(38645),C=n(54438);let E=(()=>{var y;class d{}return(y=d).\u0275fac=function(v){return new(v||y)},y.\u0275mod=C.$C({type:y}),y.\u0275inj=C.G2t({imports:[t.MD,e.G,o.iI,r.G]}),d})()},82633:(ge,F,n)=>{"use strict";n.d(F,{A:()=>m,G:()=>g});var t=n(34006),e=n(85052),r=n(65763),o=n(54438),C=n(60177),E=n(21007),y=n(26779);function d(i,c){if(1&i&&o.nrm(0,"img",17),2&i){const a=o.XpG().$implicit;o.Y8G("src",a.logo,o.B4B)}}function _(i,c){if(1&i&&(o.j41(0,"h2",18),o.EFF(1),o.k0s()),2&i){const a=o.XpG().$implicit;o.R7$(),o.SpI(" ",a.title," ")}}function v(i,c){if(1&i&&o.nrm(0,"p",19),2&i){const a=o.XpG().$implicit;o.AVh("text-xl",a.logo)("font-medium",a.logo),o.Y8G("innerHTML",a.text,o.npT)}}function b(i,c){if(1&i&&o.nrm(0,"img",20),2&i){const a=o.XpG().$implicit;o.Y8G("src",a.image,o.B4B)}}function P(i,c){if(1&i&&(o.j41(0,"div",12),o.DNE(1,d,1,1,"img",13)(2,_,2,1,"h2",14)(3,v,1,5,"p",15)(4,b,1,1,"img",16),o.k0s()),2&i){const a=c.$implicit,l=c.index,p=o.XpG();o.AVh("slide__item--hidden",p.selectedIndex!==l),o.R7$(),o.Y8G("ngIf",a.logo),o.R7$(),o.Y8G("ngIf",a.title),o.R7$(),o.Y8G("ngIf",a.text),o.R7$(),o.Y8G("ngIf",a.image)}}function s(i,c){if(1&i){const a=o.RV6();o.j41(0,"button",21),o.bIt("click",function(){const p=o.eBV(a).index,A=o.XpG();return o.Njj(A.handleSelectSlideClick(p))}),o.k0s()}if(2&i){const a=c.$implicit,l=c.index,p=o.XpG();o.AVh("slide__nav-dot--active",p.selectedIndex===l),o.BMQ("title",a.title)("aria-label",a.title)}}var g=function(i){return i[i.NewUser=0]="NewUser",i[i.ExistingUser=1]="ExistingUser",i[i.Group=2]="Group",i}(g||{});const S=[{text:"We make it easy to visualize the human body<br/> for your educational needs - all in interactive 3D.",logo:"/assets/images/biodigital-logo.svg"},{title:"Explore",text:"Browse our digital library for 3D models to complement your curriculum.",image:"/assets/images/welcome-tour-explore.jpg"},{title:"Customize",text:"Use our authoring tools to create 3D views tailored to your educational goals.",image:"/assets/images/welcome-tour-customize.jpg"},{title:"Collaborate",text:"Share your saved 3D views with your team from a central Library.",image:"/assets/images/welcome-tour-collaborate.jpg"},{title:"Integrate",text:"Publish your interactive 3D model and drop into your digital content.",image:"/assets/images/welcome-tour-integrate.jpg"}],f=[{title:"Introducing Human Studio",text:"The first product for authoring custom interactive 3D models of anatomy, disease and treatments.",image:"/assets/images/studio-tour-studio.jpg"},{title:"Interactive Labels",text:"Quickly add anatomical labels to call out key learning objectives.",image:"/assets/images/studio-tour-labels.jpg"},{title:"Paint",text:"Customize the look and feel of your 3D model by applying different paint effects to anatomical structures.",image:"/assets/images/studio-tour-paint.jpg"},{title:"Tour Builder",text:"Tell an interactive story by stringing together different views of your 3D model.",image:"/assets/images/studio-tour-tour.jpg"},{title:"Text Manager",text:"Add or modify text from one dedicated place.",image:"/assets/images/studio-tour-text.jpg"}];let m=(()=>{var i;class c{get isFirstSlide(){return 0===this.selectedIndex}get isLastSlide(){return this.selectedIndex===this.slides.length-1}constructor(l,p,A){switch(this.store=l,this.dialogRef=p,this.data=A,this.ngUnsubscribe=new e.B,this.settings={userType:g.NewUser},this.slides=[],this.selectedIndex=0,this.settings={...this.settings,...A},this.settings.userType){case g.NewUser:this.slides=S;break;case g.ExistingUser:this.slides=f}}ngOnInit(){}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}handleCloseTour(){this.close()}close(){this.dialogRef.close()}handleSelectSlideClick(l){this.selectedIndex=l}handleNextClick(){this.incrementSelectedIndex(1)}handlePrevClick(){this.incrementSelectedIndex(-1)}incrementSelectedIndex(l){this.selectedIndex=Math.max(0,this.selectedIndex+l)%this.slides.length}}return(i=c).\u0275fac=function(l){return new(l||i)(o.rXU(r.il),o.rXU(t.CP),o.rXU(t.Vh))},i.\u0275cmp=o.VBU({type:i,selectors:[["app-welcome-tour-dialog"]],decls:12,vars:8,consts:[["role","dialog","aria-modal","true","data-test","welcomeTour",1,"welcome"],[1,"slide"],["class","slide__item",3,"slide__item--hidden",4,"ngFor","ngForOf"],[1,"slide__nav"],["app-button","","buttonType","text","buttonTheme","light","type","button","title","Previous Slide",1,"slide__nav-arrow",3,"click","disabled"],["icon","chevron-left","size","md"],[1,"slide__nav-dots"],["type","button","class","slide__nav-dot",3,"slide__nav-dot--active","click",4,"ngFor","ngForOf"],["app-button","","buttonType","text","buttonTheme","light","type","button","title","Next Slide",1,"slide__nav-arrow",3,"click","disabled"],["icon","chevron-right","size","md"],["app-button","","buttonType","text","buttonTheme","light","type","button","title","Close","data-test","welcomeTourClose",1,"welcome__close",3,"click"],["icon","times","size","lg"],[1,"slide__item"],["class","slide__logo",3,"src",4,"ngIf"],["class","text-2xl uppercase mt-4",4,"ngIf"],["class","text-lg mt-4 mb-4",3,"text-xl","font-medium","innerHTML",4,"ngIf"],["class","slide__image",3,"src",4,"ngIf"],[1,"slide__logo",3,"src"],[1,"text-2xl","uppercase","mt-4"],[1,"text-lg","mt-4","mb-4",3,"innerHTML"],[1,"slide__image",3,"src"],["type","button",1,"slide__nav-dot",3,"click"]],template:function(l,p){1&l&&(o.j41(0,"div",0)(1,"div",1),o.DNE(2,P,5,6,"div",2),o.j41(3,"div",3)(4,"button",4),o.bIt("click",function(){return p.handlePrevClick()}),o.nrm(5,"app-icon",5),o.k0s(),o.j41(6,"div",6),o.DNE(7,s,1,4,"button",7),o.k0s(),o.j41(8,"button",8),o.bIt("click",function(){return p.handleNextClick()}),o.nrm(9,"app-icon",9),o.k0s()()(),o.j41(10,"button",10),o.bIt("click",function(){return p.handleCloseTour()}),o.nrm(11,"app-icon",11),o.k0s()()),2&l&&(o.BMQ("aria-label","Welcome Tour"),o.R7$(2),o.Y8G("ngForOf",p.slides),o.R7$(2),o.Y8G("disabled",p.isFirstSlide),o.BMQ("aria-label","Previous Slide"),o.R7$(3),o.Y8G("ngForOf",p.slides),o.R7$(),o.Y8G("disabled",p.isLastSlide),o.BMQ("aria-label","Next Slide"),o.R7$(2),o.BMQ("aria-label","Close"))},dependencies:[C.Sq,C.bT,E.Q,y.R],styles:[".welcome[_ngcontent-%COMP%]{position:relative;display:flex;align-items:flex-end;flex-direction:column;padding:24px}.welcome__close[_ngcontent-%COMP%]{position:absolute;top:24px;right:24px}.slide[_ngcontent-%COMP%]{width:800px;height:600px;position:relative;margin:auto;display:flex;flex-direction:column;justify-content:space-between}.slide__item[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;text-align:center}.slide__item--hidden[_ngcontent-%COMP%]{display:none}.slide__logo[_ngcontent-%COMP%]{width:300px;margin:160px 0 40px}.slide__image[_ngcontent-%COMP%]{flex:2;overflow:auto;width:100%}.slide__nav[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;justify-content:center;font-size:16px;margin:12px 0}.slide__nav-arrow[_ngcontent-%COMP%]{cursor:pointer;margin:auto 12px;opacity:.8}.slide__nav-arrow[_ngcontent-%COMP%]:hover:not([disabled]){opacity:1}.slide__nav-dots[_ngcontent-%COMP%]{display:flex}.slide__nav-dot[_ngcontent-%COMP%]{margin:auto 4px;cursor:pointer;display:flex;background-color:#1c2a3f66;border-radius:50%;border:none;width:14px;height:14px;line-height:17px}.slide__nav-dot[_ngcontent-%COMP%]:hover{background-color:#1c2a3f99}.slide__nav-dot--active[_ngcontent-%COMP%]{background-color:#2d72dc}@media (max-width: 1024px){.slide[_ngcontent-%COMP%]{width:100%;height:80vh}}"],changeDetection:0}),c})()},45367:(ge,F,n)=>{"use strict";n.d(F,{P:()=>ce});var t=n(60177),e=n(45189),r=n(21604),o=n(54438);let C=(()=>{var U;class Z{}return(U=Z).\u0275fac=function(H){return new(H||U)},U.\u0275mod=o.$C({type:U}),U.\u0275inj=o.G2t({imports:[t.MD,e.G,r.G]}),Z})();var E=n(89417),y=n(3272);let d=(()=>{var U;class Z{}return(U=Z).\u0275fac=function(H){return new(H||U)},U.\u0275mod=o.$C({type:U}),U.\u0275inj=o.G2t({imports:[t.MD,e.G,E.YN,E.X1,y.D]}),Z})(),_=(()=>{var U;class Z{}return(U=Z).\u0275fac=function(H){return new(H||U)},U.\u0275mod=o.$C({type:U}),U.\u0275inj=o.G2t({imports:[t.MD,e.G,r.G,E.X1,d]}),Z})(),v=(()=>{var U;class Z{}return(U=Z).\u0275fac=function(H){return new(H||U)},U.\u0275mod=o.$C({type:U}),U.\u0275inj=o.G2t({imports:[t.MD,e.G,r.G]}),Z})(),b=(()=>{var U;class Z{}return(U=Z).\u0275fac=function(H){return new(H||U)},U.\u0275mod=o.$C({type:U}),U.\u0275inj=o.G2t({imports:[t.MD,e.G,r.G]}),Z})(),P=(()=>{var U;class Z{}return(U=Z).\u0275fac=function(H){return new(H||U)},U.\u0275mod=o.$C({type:U}),U.\u0275inj=o.G2t({imports:[t.MD,e.G,r.G]}),Z})(),s=(()=>{var U;class Z{}return(U=Z).\u0275fac=function(H){return new(H||U)},U.\u0275mod=o.$C({type:U}),U.\u0275inj=o.G2t({imports:[t.MD,e.G,r.G,E.X1]}),Z})();var g=n(27800);let u=(()=>{var U;class Z{}return(U=Z).\u0275fac=function(H){return new(H||U)},U.\u0275mod=o.$C({type:U}),U.\u0275inj=o.G2t({imports:[t.MD,e.G,r.G]}),Z})();var f,U,h=n(65763);(U=f||(f={})).OpenLimit=(()=>{class oe{constructor(){}}return oe.type="[Dialog] Open Limit",oe})(),U.CloseLimit=(()=>{class oe{constructor(Se){this.upgrade=Se}}return oe.type="[Dialog] Close Limit",oe})(),U.OpenPremiumContent=(()=>{class oe{constructor(){}}return oe.type="[Dialog] Open Premium Content",oe})(),U.ClosePremiumContent=(()=>{class oe{constructor(Se){this.confirmed=Se}}return oe.type="[Dialog] Close Premium Content",oe})(),U.OpenUpgrade=(()=>{class oe{constructor(){}}return oe.type="[Dialog] Open Upgrade",oe})(),U.CloseUpgrade=(()=>{class oe{constructor(){}}return oe.type="[Dialog] Close Upgrade",oe})();var i,m=n(66571),c=function(U,Z,z,H){var X,J=arguments.length,Y=J<3?Z:null===H?H=Object.getOwnPropertyDescriptor(Z,z):H;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)Y=Reflect.decorate(U,Z,z,H);else for(var se=U.length-1;se>=0;se--)(X=U[se])&&(Y=(J<3?X(Y):J>3?X(Z,z,Y):X(Z,z))||Y);return J>3&&Y&&Object.defineProperty(Z,z,Y),Y},a=function(U,Z){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(U,Z)};let l=((i=class{static getOpenDialog(Z){return Z.openDialog}openPremiumContent(Z,z){this.dialogService.openPremiumContentDialog().afterClosed().subscribe(J=>{Z.dispatch(new f.ClosePremiumContent(J))})}closePremiumContent(Z,z){z.confirmed&&Z.dispatch(new f.OpenUpgrade)}openUpgrade(Z,z){this.dialogService.openUpgradeDialog()}constructor(Z){this.dialogService=Z}}).\u0275fac=function(Z){return new(Z||i)(o.KVO(m.o))},i.\u0275prov=o.jDH({token:i,factory:i.\u0275fac}),i);c([(0,h.rc)(f.OpenPremiumContent),a("design:type",Function),a("design:paramtypes",[Object,f.OpenPremiumContent]),a("design:returntype",void 0)],l.prototype,"openPremiumContent",null),c([(0,h.rc)(f.ClosePremiumContent),a("design:type",Function),a("design:paramtypes",[Object,f.ClosePremiumContent]),a("design:returntype",void 0)],l.prototype,"closePremiumContent",null),c([(0,h.rc)(f.OpenUpgrade),a("design:type",Function),a("design:paramtypes",[Object,f.OpenUpgrade]),a("design:returntype",void 0)],l.prototype,"openUpgrade",null),c([(0,h.MD)(),a("design:type",Function),a("design:paramtypes",[class S{}]),a("design:returntype",void 0)],l,"getOpenDialog",null),l=c([(0,h.Uw)({name:"dialog",defaults:{openDialog:null}}),a("design:paramtypes",[m.o])],l);let p=(()=>{var U;class Z{}return(U=Z).\u0275fac=function(H){return new(H||U)},U.\u0275mod=o.$C({type:U}),U.\u0275inj=o.G2t({imports:[t.MD,e.G,r.G,E.X1]}),Z})(),A=(()=>{var U;class Z{}return(U=Z).\u0275fac=function(H){return new(H||U)},U.\u0275mod=o.$C({type:U}),U.\u0275inj=o.G2t({imports:[t.MD,e.G,r.G,E.X1]}),Z})(),O=(()=>{var U;class Z{}return(U=Z).\u0275fac=function(H){return new(H||U)},U.\u0275mod=o.$C({type:U}),U.\u0275inj=o.G2t({imports:[t.MD,e.G,r.G,E.X1]}),Z})(),L=(()=>{var U;class Z{}return(U=Z).\u0275fac=function(H){return new(H||U)},U.\u0275mod=o.$C({type:U}),U.\u0275inj=o.G2t({imports:[t.MD,e.G,r.G]}),Z})(),k=(()=>{var U;class Z{}return(U=Z).\u0275fac=function(H){return new(H||U)},U.\u0275mod=o.$C({type:U}),U.\u0275inj=o.G2t({imports:[t.MD,e.G,E.YN,E.X1,r.G]}),Z})();var q=n(59464);let B=(()=>{var U;class Z{}return(U=Z).\u0275fac=function(H){return new(H||U)},U.\u0275mod=o.$C({type:U}),U.\u0275inj=o.G2t({imports:[t.MD,e.G,r.G,E.X1]}),Z})(),j=(()=>{var U;class Z{}return(U=Z).\u0275fac=function(H){return new(H||U)},U.\u0275mod=o.$C({type:U}),U.\u0275inj=o.G2t({imports:[t.MD,e.G,r.G,E.X1]}),Z})();var V=n(72026),M=n(11818);let N=(()=>{var U;class Z{}return(U=Z).\u0275fac=function(H){return new(H||U)},U.\u0275mod=o.$C({type:U}),U.\u0275inj=o.G2t({imports:[t.MD,e.G,V.o,M.C]}),Z})();var W=n(36918);let $=(()=>{var U;class Z{}return(U=Z).\u0275fac=function(H){return new(H||U)},U.\u0275mod=o.$C({type:U}),U.\u0275inj=o.G2t({imports:[t.MD,e.G,r.G,E.X1,W.e,d]}),Z})(),ne=(()=>{var U;class Z{}return(U=Z).\u0275fac=function(H){return new(H||U)},U.\u0275mod=o.$C({type:U}),U.\u0275inj=o.G2t({imports:[t.MD,e.G,r.G,E.X1]}),Z})(),Q=(()=>{var U;class Z{}return(U=Z).\u0275fac=function(H){return new(H||U)},U.\u0275mod=o.$C({type:U}),U.\u0275inj=o.G2t({imports:[t.MD,e.G,r.G,E.X1]}),Z})(),le=(()=>{var U;class Z{}return(U=Z).\u0275fac=function(H){return new(H||U)},U.\u0275mod=o.$C({type:U}),U.\u0275inj=o.G2t({imports:[t.MD,e.G,r.G,E.X1]}),Z})(),pe=(()=>{var U;class Z{}return(U=Z).\u0275fac=function(H){return new(H||U)},U.\u0275mod=o.$C({type:U}),U.\u0275inj=o.G2t({imports:[t.MD,e.G,r.G,E.X1]}),Z})(),ie=(()=>{var U;class Z{}return(U=Z).\u0275fac=function(H){return new(H||U)},U.\u0275mod=o.$C({type:U}),U.\u0275inj=o.G2t({imports:[t.MD,e.G,r.G,E.X1]}),Z})();var be=n(91060);let de=(()=>{var U;class Z{}return(U=Z).\u0275fac=function(H){return new(H||U)},U.\u0275mod=o.$C({type:U}),U.\u0275inj=o.G2t({imports:[t.MD,e.G,r.G,E.YN,E.X1]}),Z})();var w=n(35286);let te=(()=>{var U;class Z{}return(U=Z).\u0275fac=function(H){return new(H||U)},U.\u0275mod=o.$C({type:U}),U.\u0275inj=o.G2t({imports:[t.MD,e.G,r.G,w.y2.forChild()]}),Z})(),R=(()=>{var U;class Z{}return(U=Z).\u0275fac=function(H){return new(H||U)},U.\u0275mod=o.$C({type:U}),U.\u0275inj=o.G2t({imports:[t.MD,e.G,r.G,E.X1,d]}),Z})(),D=(()=>{var U;class Z{}return(U=Z).\u0275fac=function(H){return new(H||U)},U.\u0275mod=o.$C({type:U}),U.\u0275inj=o.G2t({imports:[t.MD,e.G,r.G]}),Z})(),T=(()=>{var U;class Z{}return(U=Z).\u0275fac=function(H){return new(H||U)},U.\u0275mod=o.$C({type:U}),U.\u0275inj=o.G2t({imports:[t.MD,e.G,r.G,E.X1]}),Z})(),re=(()=>{var U;class Z{}return(U=Z).\u0275fac=function(H){return new(H||U)},U.\u0275mod=o.$C({type:U}),U.\u0275inj=o.G2t({imports:[t.MD,e.G,r.G,E.X1]}),Z})(),K=(()=>{var U;class Z{}return(U=Z).\u0275fac=function(H){return new(H||U)},U.\u0275mod=o.$C({type:U}),U.\u0275inj=o.G2t({imports:[t.MD,e.G,r.G]}),Z})(),ae=(()=>{var U;class Z{}return(U=Z).\u0275fac=function(H){return new(H||U)},U.\u0275mod=o.$C({type:U}),U.\u0275inj=o.G2t({imports:[t.MD,e.G,r.G,E.X1]}),Z})(),ce=(()=>{var U;class Z{}return(U=Z).\u0275fac=function(H){return new(H||U)},U.\u0275mod=o.$C({type:U}),U.\u0275inj=o.G2t({imports:[h.rK.forFeature([l]),C,_,R,v,ie,b,P,N,s,g.I,u,p,A,O,L,k,B,j,$,le,pe,ae,q.j,y.D,r.G,te,D,T,re,K,C,_,R,v,ie,b,P,N,s,g.I,u,p,$,A,O,L,k,B,j,ne,Q,le,pe,ae,be.w,de,te,D,T,re,K]}),Z})()},66571:(ge,F,n)=>{"use strict";n.d(F,{o:()=>dt});var t=n(93253),e=n(84370),r=n(65294),o=n(24418),C=n(34006),E=n(59e3),y=n(5690),d=n(54438),_=n(345),v=n(26779),b=n(21007);const P=["modalContents"];let s=(()=>{var ke;class Ae{constructor(he,_e,Ie,Oe,tt,gt){this.dialogRef=he,this.data=_e,this.sanitizer=Ie,this.renderer=Oe,this.vendorAnalyticsService=tt,this.productService=gt}onMessage(he){switch(he.data.action){case"close":this.dialogRef.close(he.data);break;case"track":this.vendorAnalyticsService.track(he.data.label,{...he.data.metadata,platform:this.productService.productType})}}ngOnInit(){this.title=this.data.title,this.url=this.data.url?this.sanitizer.bypassSecurityTrustResourceUrl(this.data.url):"",this.renderer.setStyle(this.modalContents.nativeElement,"background-color",this.data.backgroundColor||"#ffffff")}closeDialog(){this.dialogRef.close()}}return(ke=Ae).\u0275fac=function(he){return new(he||ke)(d.rXU(C.CP),d.rXU(C.Vh),d.rXU(_.up),d.rXU(d.sFG),d.rXU(E.e),d.rXU(y.b))},ke.\u0275cmp=d.VBU({type:ke,selectors:[["app-iframe-dialog"]],viewQuery:function(he,_e){if(1&he&&d.GBs(P,7),2&he){let Ie;d.mGM(Ie=d.lsd())&&(_e.modalContents=Ie.first)}},hostBindings:function(he,_e){1&he&&d.bIt("message",function(Oe){return _e.onMessage(Oe)},!1,d.tSv)},decls:6,vars:3,consts:[["modalContents",""],["role","dialog","aria-modal","true",1,"modal"],[1,"modal__contents"],["cdkFocusInitial","",1,"modal__frame",3,"src"],["app-button","","buttonTheme","dark","buttonType","white","buttonShape","circle","type","button","title","Close",1,"modal__close",3,"click"],["icon","times","size","lg"]],template:function(he,_e){if(1&he){const Ie=d.RV6();d.j41(0,"div",1)(1,"div",2,0),d.nrm(3,"iframe",3),d.k0s(),d.j41(4,"button",4),d.bIt("click",function(){return d.eBV(Ie),d.Njj(_e.closeDialog())}),d.nrm(5,"app-icon",5),d.k0s()()}2&he&&(d.BMQ("aria-label",_e.title),d.R7$(3),d.Y8G("src",_e.url,d.f$h),d.R7$(),d.BMQ("aria-label","Close"))},dependencies:[v.R,b.Q],styles:[".modal[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%;position:relative}.modal__close[_ngcontent-%COMP%]{margin-bottom:4px;align-self:flex-end;cursor:pointer;position:absolute;right:12px;top:12px}.modal__contents[_ngcontent-%COMP%]{flex-grow:1}.modal__frame[_ngcontent-%COMP%]{width:100%;height:100%}"],changeDetection:0}),Ae})();var B,g=n(49204),u=n(65763),h=n(16823),S=n(21424),f=n(63308),m=n(15828),i=n(12215),c=n(65459),a=n(85052),l=n(2573),p=n(99504),A=n(60177),O=n(87424),L=n(57018),k=n(21091),q=n(65115);function M(ke,Ae){1&ke&&d.eu8(0)}function N(ke,Ae){1&ke&&d.eu8(0)}function W(ke,Ae){if(1&ke){const Fe=d.RV6();d.j41(0,"div",11)(1,"app-team-invite",12),d.bIt("inviteSent",function(_e){d.eBV(Fe);const Ie=d.XpG();return d.Njj(Ie.handleInviteSent(_e))})("inviteCancelled",function(){d.eBV(Fe);const _e=d.XpG();return d.Njj(_e.handleInviteCancelled())}),d.k0s()()}if(2&ke){const Fe=d.XpG();d.R7$(),d.Y8G("organization",Fe.organization)("layout","inline")}}function $(ke,Ae){1&ke&&(d.j41(0,"div",13),d.nrm(1,"app-team-group-code"),d.k0s())}class ne{constructor(Ae,Fe){this.dialogRef=Ae,this.data=Fe,this.sent=!1,this.sentResponses=[],this.errorResponses=[],this.ngUnsubscribe=new a.B,this.organization=Fe.organization}ngOnInit(){}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}handleInviteSent(Ae){setTimeout(()=>{this.inviteComplete()},5e3)}handleInviteCancelled(){this.inviteComplete()}inviteComplete(){this.dialogRef.close()}}(B=ne).\u0275fac=function(Ae){return new(Ae||B)(d.rXU(C.CP),d.rXU(C.Vh))},B.\u0275cmp=d.VBU({type:B,selectors:[["app-team-invite-dialog"]],decls:15,vars:4,consts:[["inviteTmpl",""],["groupCodeTmpl",""],["mat-dialog-title",""],["mat-dialog-content",""],[1,"dialog"],["app-button","","buttonType","text","buttonTheme","light","type","button","title","Close",1,"dialog__close",3,"click"],["icon","times","size","lg"],["tabSize","medium","tabTheme","light","tabColor","red",3,"tabUnderline"],["label","Invite By Email"],[4,"ngTemplateOutlet"],["label","Share Code or Link"],[1,"theme-light","pt-6"],["sentText","Send invites","cancelText","Cancel",3,"inviteSent","inviteCancelled","organization","layout"],[1,"theme-light","py-6"]],template:function(Ae,Fe){if(1&Ae){const he=d.RV6();d.j41(0,"h1",2),d.EFF(1,"Invite Members"),d.k0s(),d.j41(2,"div",3)(3,"div",4)(4,"button",5),d.bIt("click",function(){return d.eBV(he),d.Njj(Fe.handleInviteCancelled())}),d.nrm(5,"app-icon",6),d.k0s(),d.j41(6,"app-tabs",7)(7,"app-tab",8),d.DNE(8,M,1,0,"ng-container",9),d.k0s(),d.j41(9,"app-tab",10),d.DNE(10,N,1,0,"ng-container",9),d.k0s()(),d.DNE(11,W,2,2,"ng-template",null,0,d.C5r)(13,$,2,0,"ng-template",null,1,d.C5r),d.k0s()()}if(2&Ae){const he=d.sdS(12),_e=d.sdS(14);d.R7$(4),d.BMQ("aria-label","Close"),d.R7$(2),d.Y8G("tabUnderline",!0),d.R7$(2),d.Y8G("ngTemplateOutlet",he),d.R7$(2),d.Y8G("ngTemplateOutlet",_e)}},dependencies:[A.T3,C.BI,C.Yi,b.Q,v.R,O.j,L.O,k.G,q.H],styles:[".dialog[_ngcontent-%COMP%]{width:480px}.dialog__input[_ngcontent-%COMP%]{resize:vertical}.dialog__actions[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between;align-items:center}.dialog__actions--compact[_ngcontent-%COMP%]{justify-content:flex-end}.dialog__close[_ngcontent-%COMP%]{position:absolute;right:24px;top:24px}@media (max-width: 480px){.dialog[_ngcontent-%COMP%]{width:100%}}"],changeDetection:0}),function(ke,Ae,Fe,he){var Oe,_e=arguments.length,Ie=_e<3?Ae:null===he?he=Object.getOwnPropertyDescriptor(Ae,Fe):he;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)Ie=Reflect.decorate(ke,Ae,Fe,he);else for(var tt=ke.length-1;tt>=0;tt--)(Oe=ke[tt])&&(Ie=(_e<3?Oe(Ie):_e>3?Oe(Ae,Fe,Ie):Oe(Ae,Fe))||Ie);_e>3&&Ie&&Object.defineProperty(Ae,Fe,Ie)}([(0,u.l6)(p.e.getInviting),function(ke,Ae){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata("design:type",Ae)}(0,l.c)],ne.prototype,"inviting$",void 0);var ae,Q=n(89417),le=n(37925),pe=n(4951),ie=n(76115),be=n(53236),de=n(68947),w=n(17192),te=n(9940),R=n(95416),D=n(53719),T=n(14823),re=n(97352),K=n(8961),ce=function(ke,Ae,Fe,he){var Oe,_e=arguments.length,Ie=_e<3?Ae:null===he?he=Object.getOwnPropertyDescriptor(Ae,Fe):he;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)Ie=Reflect.decorate(ke,Ae,Fe,he);else for(var tt=ke.length-1;tt>=0;tt--)(Oe=ke[tt])&&(Ie=(_e<3?Oe(Ie):_e>3?Oe(Ae,Fe,Ie):Oe(Ae,Fe))||Ie);return _e>3&&Ie&&Object.defineProperty(Ae,Fe,Ie),Ie},U=function(ke,Ae){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(ke,Ae)};const Z=["emailField"];function z(ke,Ae){1&ke&&(d.qex(0),d.j41(1,"div",15)(2,"app-message-toggle",16),d.EFF(3," Your email was successfully sent. "),d.k0s()(),d.bVm())}function H(ke,Ae){if(1&ke&&(d.j41(0,"div",15)(1,"app-message-toggle",22),d.EFF(2),d.k0s()()),2&ke){const Fe=d.XpG(3);d.R7$(2),d.SpI(" ",Fe.errorMessage," ")}}function J(ke,Ae){1&ke&&d.nrm(0,"app-spinner",23)}function Y(ke,Ae){1&ke&&(d.j41(0,"div",25)(1,"mat-error"),d.EFF(2,"Please enter a valid email address."),d.k0s()())}function X(ke,Ae){if(1&ke&&(d.j41(0,"div",27)(1,"mat-error"),d.EFF(2),d.k0s()()),2&ke){const Fe=d.XpG(2).$implicit,he=d.XpG(3);d.R7$(2),d.Lme(" Maximum email addresses excceeded, ",Fe.currentEmailCount," of ",he.maxEmailCount," max. ")}}function se(ke,Ae){if(1&ke&&d.DNE(0,X,3,2,"div",26),2&ke){const Fe=d.XpG().$implicit;d.Y8G("ngIf",Fe.maxEmailsExceeded)}}function oe(ke,Ae){if(1&ke&&(d.qex(0),d.DNE(1,Y,3,0,"div",24)(2,se,1,1,"ng-template",null,2,d.C5r),d.bVm()),2&ke){const Fe=Ae.$implicit,he=d.sdS(3);d.R7$(),d.Y8G("ngIf",Fe.invalidEmails)("ngIfElse",he)}}function me(ke,Ae){if(1&ke){const Fe=d.RV6();d.DNE(0,H,3,1,"div",17),d.j41(1,"form",18),d.bIt("submit",function(){d.eBV(Fe);const _e=d.XpG(2);return d.Njj(_e.submitForm(_e.config.shareLink))}),d.j41(2,"textarea",19,1),d.EFF(4,"          "),d.k0s(),d.j41(5,"button",20),d.nI1(6,"async"),d.DNE(7,J,1,0,"app-spinner",21),d.nI1(8,"async"),d.EFF(9),d.nI1(10,"async"),d.k0s()(),d.DNE(11,oe,4,2,"ng-container",6)}if(2&ke){const Fe=d.XpG(2);d.Y8G("ngIf",Fe.errorMessage),d.R7$(),d.Y8G("formGroup",Fe.form),d.R7$(4),d.Y8G("disabled",!Fe.form.valid||d.bMT(6,7,Fe.sharing$)),d.BMQ("aria-label","Send Email"),d.R7$(2),d.Y8G("ngIf",d.bMT(8,9,Fe.sharing$)),d.R7$(2),d.SpI(" ",d.bMT(10,11,Fe.sharing$)?"Sending":"Send Email"," "),d.R7$(2),d.Y8G("ngIf",Fe.form.get("emails").errors)}}function Se(ke,Ae){if(1&ke&&(d.qex(0),d.DNE(1,z,4,0,"ng-container",14)(2,me,12,13,"ng-template",null,0,d.C5r),d.bVm()),2&ke){const Fe=d.sdS(3),he=d.XpG();d.R7$(),d.Y8G("ngIf",he.emailSent)("ngIfElse",Fe)}}function Ue(ke,Ae){if(1&ke&&(d.j41(0,"a",28),d.nI1(1,"titlecase"),d.nI1(2,"titlecase"),d.nrm(3,"img",9),d.k0s()),2&ke){const Fe=Ae.$implicit;d.Y8G("href",Fe.url,d.B4B)("matTooltip","Share via "+d.bMT(1,5,Fe.type)),d.BMQ("aria-label","Share via "+d.bMT(2,7,Fe.type))("data-test",Fe.type+"LinkButton"),d.R7$(3),d.Y8G("src","/assets/images/social/"+Fe.type+"-share.svg",d.B4B)}}function je(ke,Ae){if(1&ke&&(d.j41(0,"p",29),d.EFF(1),d.k0s()),2&ke){const Fe=d.XpG();d.R7$(),d.SpI(" ",Fe.config.description," ")}}class Le{constructor(Ae,Fe,he,_e,Ie,Oe,tt,gt){this.store=Ae,this.actions=Fe,this.dialogRef=he,this.data=_e,this.clipboardService=Ie,this.snackBar=Oe,this.formBuilder=tt,this.changeRef=gt,this.maxEmailCount=50,this.config={title:"Share"},this.emailSent=!1,this.errorMessage="",this.formError="",this.ngUnsubscribe=new a.B,this.config={...this.config,..._e},this.initForm()}ngOnInit(){this.initEmailListeners()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}initForm(){this.form=this.formBuilder.group({emails:["",Q.k0.required,(0,ie.H)(this.maxEmailCount).bind(this)]})}initEmailListeners(){this.actions.pipe((0,u.xi)(w.Cg),(0,le.Q)(this.ngUnsubscribe)).subscribe(()=>{this.emailSent=!1,this.errorMessage="",this.changeRef.markForCheck()}),this.actions.pipe((0,u.xi)(w.zq),(0,le.Q)(this.ngUnsubscribe)).subscribe(()=>{this.emailSent=!0,this.errorMessage="",setTimeout(()=>{this.emailSent=!1,this.form.setValue({emails:""}),this.changeRef.markForCheck(),setTimeout(()=>this.focus())},5e3),this.changeRef.markForCheck()}),this.actions.pipe((0,u.xi)(w.Km),(0,le.Q)(this.ngUnsubscribe)).subscribe(Ae=>{this.emailSent=!1,this.errorMessage=(0,be.u1)(Ae.error)||"There was an error sending the email.",setTimeout(()=>this.focus()),this.changeRef.markForCheck()})}focus(){const Ae=this.emailField?.nativeElement;Ae&&Ae.focus()}submitForm(Ae){const{type:Fe,title:he,relativeUrl:_e,thumbUrl:Ie}=Ae,Oe=de.l.parseEmails(this.form.value.emails);this.store.dispatch(new w.Cg({share_type:Fe,share_title:he,share_thumbnail_path:Ie,share_link_path:_e,share_emails:Oe}))}handleCopyClick(Ae,Fe){this.clipboardService.copyToClipboard(Ae,"url").pipe((0,le.Q)(this.ngUnsubscribe)).subscribe(he=>{this.snackBar.open(`Link ${he?"copied":"not copied"}.`)}),Fe.preventDefault()}handleCloseClick(){this.dialogRef.close()}}(ae=Le).\u0275fac=function(Ae){return new(Ae||ae)(d.rXU(u.il),d.rXU(u.En),d.rXU(C.CP),d.rXU(C.Vh),d.rXU(pe.W),d.rXU(R.UG),d.rXU(Q.ok),d.rXU(d.gRc))},ae.\u0275cmp=d.VBU({type:ae,selectors:[["app-share-url-dialog"]],viewQuery:function(Ae,Fe){if(1&Ae&&d.GBs(Z,5),2&Ae){let he;d.mGM(he=d.lsd())&&(Fe.emailField=he.first)}},decls:14,vars:9,consts:[["emailFormTmp",""],["emailField",""],["maxEmailErrorTmp",""],["mat-dialog-title",""],["mat-dialog-content",""],[1,"share-url-dialog"],[4,"ngIf"],[1,"share-url-dialog__social"],["target","_blank","aria-label","Copy Link","matTooltip","Copy Link","matTooltipPosition","below","data-test","copyLinkButton",1,"share-url-dialog__social-link",3,"click","href"],[3,"src"],["class","share-url-dialog__social-link","target","_blank","matTooltipPosition","below",3,"href","matTooltip",4,"ngFor","ngForOf"],["class","share-url-dialog__description my-3",4,"ngIf"],["mat-dialog-actions",""],["app-button","","buttonType","flat","buttonTheme","light","type","button","title","Close",1,"share-url-dialog__close",3,"click"],[4,"ngIf","ngIfElse"],[1,"my-2"],["type","message"],["class","my-2",4,"ngIf"],[1,"share-url-dialog__form",3,"submit","formGroup"],["rows","1","formControlName","emails","placeholder","Email, comma separated","data-test","emailEntryField",1,"share-url-dialog__input","input","theme-light"],["type","submit","app-button","","buttonType","primary","title","'Send Email'","data-test","emailLinkButton",1,"share-url-dialog__submit",3,"disabled"],["size","small","class","mr-2","render","inline",4,"ngIf"],["type","error"],["size","small","render","inline",1,"mr-2"],["class","my-1",4,"ngIf","ngIfElse"],[1,"my-1"],["class","flex flex-col my-1",4,"ngIf"],[1,"flex","flex-col","my-1"],["target","_blank","matTooltipPosition","below",1,"share-url-dialog__social-link",3,"href","matTooltip"],[1,"share-url-dialog__description","my-3"]],template:function(Ae,Fe){1&Ae&&(d.j41(0,"h1",3),d.EFF(1),d.k0s(),d.j41(2,"div",4)(3,"div",5),d.DNE(4,Se,4,2,"ng-container",6),d.nI1(5,"async"),d.j41(6,"div",7)(7,"a",8),d.bIt("click",function(_e){return Fe.handleCopyClick(null==Fe.config.shareLink?null:Fe.config.shareLink.fullUrl,_e)}),d.nrm(8,"img",9),d.k0s(),d.DNE(9,Ue,4,9,"a",10),d.k0s(),d.DNE(10,je,2,1,"p",11),d.k0s()(),d.j41(11,"div",12)(12,"button",13),d.bIt("click",function(){return Fe.handleCloseClick()}),d.EFF(13," Close "),d.k0s()()),2&Ae&&(d.R7$(),d.JRh(Fe.config.title),d.R7$(3),d.Y8G("ngIf",d.bMT(5,7,Fe.userProfile$)),d.R7$(3),d.Y8G("href",null==Fe.config.shareLink?null:Fe.config.shareLink.fullUrl,d.B4B),d.R7$(),d.Y8G("src","/assets/images/social/link-share.svg",d.B4B),d.R7$(),d.Y8G("ngForOf",null==Fe.config.shareLink?null:Fe.config.shareLink.social),d.R7$(),d.Y8G("ngIf",Fe.config.description),d.R7$(2),d.BMQ("aria-label","Close"))},dependencies:[A.Sq,A.bT,D.TL,C.BI,C.E7,C.Yi,T.oV,b.Q,re.tI,K.X,Q.qT,Q.me,Q.BC,Q.cb,Q.j4,Q.JD,A.Jj,A.PV],styles:[".share-url-dialog__description[_ngcontent-%COMP%]{color:#61779e;font-size:.75rem;line-height:1rem}.share-url-dialog__form[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between;gap:12px}.share-url-dialog__submit[_ngcontent-%COMP%]{flex:1 0 120px}.share-url-dialog__social[_ngcontent-%COMP%]{display:flex;flex-direction:row;gap:24px;margin-top:32px;margin-bottom:20px}.share-url-dialog__social-link[_ngcontent-%COMP%]{width:36px;height:36px;border-radius:100%;cursor:pointer}.share-url-dialog__social-link[_ngcontent-%COMP%]:focus{outline:#2d72dc solid 2px!important}.share-url-dialog__social-link[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%}.share-url-dialog__input[_ngcontent-%COMP%], .share-url-dialog__input[_ngcontent-%COMP%]:disabled{background-color:#f9fafd;color:#61779e;font-size:.75rem;line-height:1rem;opacity:1;resize:vertical;max-height:240px}@media (max-width: 480px){.share-url-dialog__form[_ngcontent-%COMP%]{flex-wrap:wrap}}"],changeDetection:0}),ce([(0,u.l6)(h.k.getUserProfile),U("design:type",l.c)],Le.prototype,"userProfile$",void 0),ce([(0,u.l6)(te.D.getSharing),U("design:type",l.c)],Le.prototype,"sharing$",void 0);var Re=n(82633),Ee=n(17215),We=n(38645),ze=n(21827);let Ze=(()=>{var ke;class Ae{constructor(he,_e,Ie,Oe){this.dialogRef=he,this.router=_e,this.storageService=Ie,this.data=Oe,this.requestOrganizationsText="",this.organizations=[]}ngOnInit(){this.organizations=this.data.organizations,this.storageService.setLocalItem(Ee.UT.UserJoinPromptSeen,!0),this.dialogRef.afterClosed().subscribe(he=>{he&&this.router.navigateByUrl("/account/team")})}handleViewTeamsCancel(){this.dialogRef.close(!1)}handleViewTeamsClick(){this.dialogRef.close(!0)}}return(ke=Ae).\u0275fac=function(he){return new(he||ke)(d.rXU(C.CP),d.rXU(We.Ix),d.rXU(Ee.n$),d.rXU(C.Vh))},ke.\u0275cmp=d.VBU({type:ke,selectors:[["app-user-join-dialog"]],decls:7,vars:2,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[3,"readonly","organizations"],["mat-dialog-actions",""],["app-button","","buttonType","primary",3,"click"]],template:function(he,_e){1&he&&(d.j41(0,"h1",0),d.EFF(1,"We found your team"),d.k0s(),d.j41(2,"div",1),d.nrm(3,"app-team-join",2),d.k0s(),d.j41(4,"div",3)(5,"button",4),d.bIt("click",function(){return _e.handleViewTeamsClick()}),d.EFF(6,"View Teams"),d.k0s()()),2&he&&(d.R7$(3),d.Y8G("readonly",!0)("organizations",_e.organizations))},dependencies:[C.BI,C.E7,C.Yi,b.Q,ze.H],changeDetection:0}),Ae})();var rt,et=n(45438);function Xe(ke,Ae){if(1&ke&&(d.j41(0,"option",14),d.EFF(1),d.k0s()),2&ke){const Fe=Ae.$implicit;d.Y8G("value",Fe.role_id),d.R7$(),d.SpI(" ",Fe.role_display_name," ")}}function ye(ke,Ae){if(1&ke&&(d.j41(0,"select",12),d.DNE(1,Xe,2,2,"option",13),d.nI1(2,"async"),d.k0s()),2&ke){const Fe=d.XpG(2);d.R7$(),d.Y8G("ngForOf",d.bMT(2,1,Fe.userRoles$))}}function Ce(ke,Ae){if(1&ke&&(d.j41(0,"div",9),d.nrm(1,"app-team-user",10),d.DNE(2,ye,3,3,"select",11),d.k0s()),2&ke){const Fe=Ae.$implicit,he=Ae.index,_e=d.XpG();d.Y8G("formGroupName",he),d.R7$(),d.Y8G("user",Fe)("showEmail",!0)("showNameUnknown",!0)("showRole",!1),d.R7$(),d.Y8G("ngIf",_e.data.accept)}}class xe{constructor(Ae,Fe,he){this.dialogRef=Ae,this.formBuilder=Fe,this.data=he}ngOnInit(){this.action=this.data.accept?"approve":"deny";const Ae="request"+(this.data.users.length>1?"s":"");this.title=`${(0,g.capitalize)(this.action)} ${(0,g.capitalize)(Ae)}?`,this.text=`Are you sure you want to ${this.action} the following ${Ae} to join your team?`,this.initForm()}initForm(){const Ae=this.data.users.map(Fe=>this.formBuilder.group({joinRequestKey:Fe.joinRequestKey,roleId:Fe.role.role_id}));this.form=this.formBuilder.group({joinRequests:new Q.Bm(Ae)})}createPayload(){const{joinRequests:Ae}=this.form.value;return Ae.map(this.data.accept?Fe=>({join_request_key:Fe.joinRequestKey,user_role_id:parseInt(Fe.roleId)}):Fe=>Fe.joinRequestKey)}handleConfirmClick(){this.dialogRef.close(this.createPayload())}}(rt=xe).\u0275fac=function(Ae){return new(Ae||rt)(d.rXU(C.CP),d.rXU(Q.ze),d.rXU(C.Vh))},rt.\u0275cmp=d.VBU({type:rt,selectors:[["app-team-join-dialog"]],decls:13,vars:5,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[1,"dialog",3,"formGroup"],["formArrayName","joinRequests"],[1,"my-3","text-sm"],["class","flex space-between align-center my-2 py-2",3,"formGroupName",4,"ngFor","ngForOf"],["mat-dialog-actions",""],["app-button","","buttonTheme","light","mat-dialog-close",""],["app-button","","buttonType","primary",3,"click"],[1,"flex","space-between","align-center","my-2","py-2",3,"formGroupName"],[1,"flex","grow",3,"user","showEmail","showNameUnknown","showRole"],["class","input w-auto","formControlName","roleId",4,"ngIf"],["formControlName","roleId",1,"input","w-auto"],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(Ae,Fe){1&Ae&&(d.j41(0,"h1",0),d.EFF(1),d.k0s(),d.j41(2,"div",1)(3,"div",2)(4,"div",3)(5,"div",4),d.EFF(6),d.k0s(),d.DNE(7,Ce,3,6,"div",5),d.k0s()()(),d.j41(8,"div",6)(9,"button",7),d.EFF(10,"Cancel"),d.k0s(),d.j41(11,"button",8),d.bIt("click",function(){return Fe.handleConfirmClick()}),d.EFF(12),d.k0s()()),2&Ae&&(d.R7$(),d.JRh(Fe.title),d.R7$(2),d.Y8G("formGroup",Fe.form),d.R7$(3),d.JRh(Fe.text),d.R7$(),d.Y8G("ngForOf",Fe.data.users),d.R7$(5),d.SpI(" ",Fe.action," "))},dependencies:[A.Sq,A.bT,C.tx,C.BI,C.E7,C.Yi,b.Q,et.o,Q.xH,Q.y7,Q.wz,Q.BC,Q.cb,Q.j4,Q.JD,Q.$R,Q.v8,A.Jj],changeDetection:0}),function(ke,Ae,Fe,he){var Oe,_e=arguments.length,Ie=_e<3?Ae:null===he?he=Object.getOwnPropertyDescriptor(Ae,Fe):he;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)Ie=Reflect.decorate(ke,Ae,Fe,he);else for(var tt=ke.length-1;tt>=0;tt--)(Oe=ke[tt])&&(Ie=(_e<3?Oe(Ie):_e>3?Oe(Ae,Fe,Ie):Oe(Ae,Fe))||Ie);_e>3&&Ie&&Object.defineProperty(Ae,Fe,Ie)}([(0,u.l6)(h.k.getUserRoles),function(ke,Ae){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata("design:type",Ae)}(0,l.c)],xe.prototype,"userRoles$",void 0);var Je=n(83621);const ct={maxWidth:"100vw",width:"100vw",height:"100vh",panelClass:"full-modal"};let dt=(()=>{var ke;class Ae{get isMobile(){return window.innerWidth<=959}constructor(he,_e,Ie,Oe,tt,gt,bt){this.dialog=he,this.applicationEventService=_e,this.router=Ie,this.store=Oe,this.vendorAnalyticsService=tt,this.productService=gt,this.organizationsService=bt}openShareDialog(he,_e,Ie){return this.dialog.open(Le,{id:e.t.ShareUrlDialog,data:{title:_e,description:Ie,shareLink:he},width:"480px",maxWidth:"90vw"})}openConfirmDialog(he){const _e={id:e.t.ConfirmDialog,...he};return this.dialog.open(t.w,_e)}openUpgradeDialog(he=!0){he&&this.closeAllDialogs();const _e=this.store.selectSnapshot(h.k.getUserProfile),Ie=this.getContactProfileParams(_e),Oe=_e.premium_account_valid?_e.premium_account_type:"free",tt=(0,g.get)(_e,"organizations[0].subscription.type","").toLowerCase(),gt=this.store.selectSnapshot(S.q.isSubscriptionExpired),bt=_e.premium_account_eligibility.group_free_trial,qe=(0,f.j)(_e.account_settings),Ot=(0,g.get)(qe,"account_purpose.value","");let _t;if(o.c.native)_t="mobile.html";else switch(Ot){case m.j.Business:_t="business.html";break;case m.j.Education:_t="school.html";break;default:_t="individual.html"}const Ft={...Ie,accountType:Oe,subscription:tt,expired:gt,groupFreeTrial:bt},yt=`${o.c.native?"":{[i.Z.Local]:"https://localhost:1234",[i.Z.QA]:"https://pricing-qa.biodigital.com",[i.Z.Staging]:"https://pricing.biodigital.com",[i.Z.Production]:"https://pricing.biodigital.com"}[o.c.deploy]}/${_t}?${this.serializeQueryParams(Ft)}`,Qt={id:e.t.PricingDialog,...ct,data:{title:"Upgrade",url:yt,backgroundColor:"#0B1220"}},Gt=encodeURIComponent(this.router.url);return this.dialog.open(s,Qt).afterClosed().subscribe(wt=>{if(wt){const Dt={action:"",plan:"",...wt.metadata},zt={business:["starter","premium","enterprise"],education:["class","institution"]};let Kt="Individual";Object.entries(zt).forEach(([Jt,Yt])=>{Yt.indexOf(Dt.plan)&&(Kt=Jt)}),Dt.action&&this.vendorAnalyticsService.track(`Pricing - ${(0,g.capitalize)(Dt.action)} - ${(0,g.capitalize)(Dt.plan)}`,{platform:this.productService.productType,page:Kt});let kt="";switch(Dt.action){case"buy":if(o.c.native)return void this.applicationEventService.fireEvent(r.F.NativeUpgrade);this.router.navigate(["/account/profile"],{queryParams:{section:"subscription",mode:"edit"}});break;case"contact":this.openContactDialog("pricing page");break;case"try":switch(!0){case zt.business.includes(Dt.plan):kt=`/account/workflow/team/create?purpose=Business&returnTo=${Gt}`;break;case zt.education.includes(Dt.plan):kt=`/account/workflow/team/create?purpose=Education&returnTo=${Gt}`;break;default:kt="account/workflow"}this.router.navigateByUrl(kt)}}else this.vendorAnalyticsService.track("Pricing - Exit")})}openContactDialog(he=""){const _e=this.store.selectSnapshot(S.q.getOrganization),Ie=(0,g.isNil)(_e)?"":`${_e.id}`,Oe=this.store.selectSnapshot(h.k.getUserProfile),tt=this.getContactProfileParams(Oe),gt={[i.Z.Local]:"http://craft-sandbox.biodigital.local",[i.Z.QA]:"http://craft-sandbox.biodigital.local",[i.Z.Staging]:"https://www.biodigital.com",[i.Z.Production]:"https://www.biodigital.com"},bt=o.c.native?gt[i.Z.Production]:gt[o.c.deploy];if(o.c.native){const qe=this.serializeQueryParams({...tt,organizationId:Ie,utm_source:"human-mobile",utm_campaign:he});return window.open(`${bt}/contact?${qe}`,"_blank")}{const Ot=`${bt}/headless/contact-us?${this.serializeQueryParams({...tt,organizationId:Ie,utm_source:"human-web",utm_campaign:he})}`,_t={id:e.t.ContactDialog,...ct,data:{title:"Contact Us",url:Ot}};return this.dialog.open(s,_t)}}openPremiumContentDialog(){const he=o.c.native||!this.isMobile;return this.openConfirmDialog({id:e.t.PremiumContentDialog,data:{titleText:"Premium Content",bodyText:he?"This is premium content. Upgrade to a Premium Plan for unlimited access.":"This is premium content. Visit us on desktop to upgrade to a premium plan.",confirmText:"Upgrade Now",confirmEnabled:he,cancelText:"OK",confirmColor:"warn"}})}openAddUserDialog(){const he=this.store.selectSnapshot(S.q.getOrganization);this.dialog.open(ne,{id:e.t.AddTeamModelDialog,disableClose:!1,data:{organization:he}})}openWelcomeTourDialog(he,_e){const Ie={id:e.t.WelcomeTourDialog,disableClose:!1,data:{userType:he},..._e};return this.dialog.open(Re.A,Ie)}openUserJoinDialog(he,_e){return this.dialog.open(Ze,{width:"480px",data:{userEmail:he,organizations:_e}})}openTeamJoinDialog(he,_e){return this.dialog.open(xe,{width:"480px",disableClose:!1,data:{users:he,accept:_e}})}closeAllDialogs(){this.dialog.closeAll()}getContactProfileParams(he){const{first_name:_e,last_name:Ie,email:Oe}=he,tt=(0,g.get)(he,"organizations[0].name",""),gt=(0,g.get)(he,"organizations[0].group_attributes",[]),bt=(0,f.j)(he.account_settings),qe=(0,g.get)(bt,"account_purpose.value",""),Ot=(0,g.get)(bt,"account_field.value",""),_t=(0,g.get)(bt,"account_field.value",""),Ft=(0,g.get)(bt,"account_role.value",""),Rt=this.organizationsService.getOrganizationAttribute(gt,"account_settings","account_company_size"),Pt=this.organizationsService.getOrganizationAttribute(gt,"account_settings","account_company_website");return{first_name:_e,last_name:Ie,email:Oe,company:tt,website:Pt?Pt.value:"",purpose:qe,role:Ft,program_type:_t,program_size:Rt?Rt.value:"",industry:qe===m.j.Education?"Academia":Ot}}serializeQueryParams(he){return Object.entries(he).map(([_e,Ie])=>{const Oe="string"!=typeof Ie?JSON.stringify(Ie):Ie;return`${_e}=${encodeURIComponent(Oe)}`}).join("&")}}return(ke=Ae).\u0275fac=function(he){return new(he||ke)(d.KVO(C.bZ),d.KVO(Je.S),d.KVO(We.Ix),d.KVO(u.il),d.KVO(E.e),d.KVO(y.b),d.KVO(c.k))},ke.\u0275prov=d.jDH({token:ke,factory:ke.\u0275fac,providedIn:"root"}),Ae})()},84370:(ge,F,n)=>{"use strict";n.d(F,{t:()=>t});var t=function(e){return e.AboutDialog="AboutDialog",e.AddTeamModelDialog="AddTeamModelDialog",e.AssignUserRoleDialog="AssignUserRoleDialog",e.BulkUpdateDialog="BulkUpdateDialog",e.BookmarkAccessDialog="BookmarkAccessDialog",e.ShareUrlDialog="ShareUrlDialog",e.ConfirmDialog="ConfirmDialog",e.ContactDialog="ContactDialog",e.GroupRestrictionDialog="GroupRestrictionDialog",e.ImageDialog="ImageDialog",e.VideoDialog="VideoDialog",e.ImportDialog="ImportDialog",e.JoinDomainDialog="JoinDomainDialog",e.LimitDialog="LimitDialog",e.ManageDialog="ManageDialog",e.PremiumContentDialog="PremiumContentDialog",e.PricingDialog="PricingDialog",e.ProfileDialog="ProfileDialog",e.QuizSettingsDialog="QuizSettingsDialog",e.SaveAsBookmarkDialog="SaveAsBookmarkDialog",e.SaveBookmarkDialog="SaveBookmarkDialog",e.SaveModuleDialog="SaveModuleDialog",e.TransferUserContentDialog="TransferUserContentDialog",e.RemoveUserDialog="RemoveUserDialog",e.MergeModuleDialog="MergeModuleDialog",e.MergeConflictDialog="MergeConflictDialog",e.WelcomeTourDialog="WelcomeTourDialog",e.TrialExpiredDialog="TrialExpiredDialog",e.PremiumAccessDialog="PremiumAccessDialog",e.ConfirmRoleDialog="ConfirmRoleDialog",e.CollectionNameDialog="CollectionNameDialog",e.PublicViewGateDialog="PublicViewGateDialog",e.BookmarkJobsDialog="BookmarkJobsDialog",e.BulkAddModelDialog="BulkAddModelDialog",e.BulkDeleteModelDialog="BulkDeleteModelDialog",e}(t||{})},45434:(ge,F,n)=>{"use strict";n.d(F,{m:()=>t});class t{constructor(r={center:[0,0,0],edge:[1,1,1],centerBias:1,edgeBias:0,power:1}){const{edge:o,center:C,centerBias:E,edgeBias:y,power:d}=r;this.edge=o,this.center=C,this.centerBias=E,this.edgeBias=y,this.power=d}static toEngine(r){const{center:o,edge:C,centerBias:E,edgeBias:y,power:d}=r;return[[...o],[...C],E,y,d]}}},63365:(ge,F,n)=>{"use strict";n.d(F,{H:()=>_,Sf:()=>v,_M:()=>u,_U:()=>y,_o:()=>d,ql:()=>b});var t=n(45434),e=n(1367),r=n(49204);function C(h,S){switch(!0){case void 0===h[S]:return;case!1===h[S]:return!1;case"number"==typeof h[S]:return 100*h[S];default:return new e.R({center:h[S][0],edge:h[S][1],centerBias:h[S][2],edgeBias:h[S][3],power:h[S][4]})}}function y(h){return!(0,r.isNil)(h)&&Object.prototype.hasOwnProperty.call(h,"edge")&&Object.prototype.hasOwnProperty.call(h,"edgeBias")&&Object.prototype.hasOwnProperty.call(h,"center")&&Object.prototype.hasOwnProperty.call(h,"centerBias")&&Object.prototype.hasOwnProperty.call(h,"power")}function d(h){return Array.isArray(h)&&3===h.length}function _(h){return{tintColor:(()=>{switch(!0){case void 0===h.tintColor:return;case!1===h.tintColor:return!1;case Array.isArray(h.tintColor):return 3===h.tintColor.length?[...h.tintColor]:new t.m({center:h.tintColor[0],edge:h.tintColor[1],centerBias:h.tintColor[2],edgeBias:h.tintColor[3],power:h.tintColor[4]})}})(),saturation:C(h,"saturation"),brightness:C(h,"brightness"),contrast:C(h,"contrast"),opacity:C(h,"opacity")}}function v(h){let S=!1!==h.tintColor&&void 0,f=!1!==h.saturation&&void 0,m=!1!==h.brightness&&void 0,i=!1!==h.contrast&&void 0,c=!1!==h.opacity&&void 0;return Array.isArray(h.tintColor)?S=[...h.tintColor]:y(h.tintColor)&&(S=t.m.toEngine(h.tintColor)),"number"==typeof h.saturation?f=h.saturation/100:y(h.saturation)&&(f=e.R.toEngine(h.saturation)),"number"==typeof h.brightness?m=h.brightness/100:y(h.brightness)&&(m=e.R.toEngine(h.brightness)),"number"==typeof h.contrast?i=h.contrast/100:y(h.contrast)&&(i=e.R.toEngine(h.contrast)),"number"==typeof h.opacity?c=h.opacity/100:y(h.opacity)&&(c=e.R.toEngine(h.opacity)),{tintColor:S,saturation:f,brightness:m,contrast:i,opacity:c}}function b(h,S){const f=Object.assign({},h);for(const[m,i]of Object.entries(S))typeof i<"u"&&(f[m]=i);return f}function u(h){return"number"==typeof h.opacity||y(h.opacity)}},45415:(ge,F,n)=>{"use strict";n.d(F,{x:()=>t});var t=function(e){return e.Chapter="chapter",e.Label="label",e.Paint="paint",e.Positions="positions",e.Quiz="quiz",e.Image="image",e}(t||{})},58398:(ge,F,n)=>{"use strict";n.d(F,{Jl:()=>C,UD:()=>E,c7:()=>d,n4:()=>o});var t=n(49204);function o(_,v){return!(!_||!v)&&JSON.stringify(_,Object.keys(_).sort())===JSON.stringify(v,Object.keys(v).sort())}function C(_){return!(0,t.isNil)(_)&&(!(0,t.isNil)(_.brightness)&&!1!==_.brightness||!(0,t.isNil)(_.contrast)&&!1!==_.contrast||!(0,t.isNil)(_.opacity)&&!1!==_.opacity||!(0,t.isNil)(_.saturation)&&!1!==_.saturation||!(0,t.isNil)(_.tintColor)&&!1!==_.tintColor)}function E(_,v){try{const b=y(_),P=y(v),s=!1===_.opacity?1:_.opacity,g=!1===v.opacity?1:v.opacity;return b===P?s===g?_.saturation===v.saturation?_.brightness===v.brightness?_.contrast>v.contrast?b+4:b-4:_.brightness>v.brightness?b+3:b-3:_.saturation>v.saturation?b+2:b-2:s>g?b+1:b-1:b-P}catch{return 0}}function y(_){if(!_.tintColor)return-10;const v=_.tintColor[0],b=_.tintColor[1],P=_.tintColor[2],s=Math.max(v,b,P),u=s-Math.min(v,b,P);let h=0;return h=s===v?(b-P)/u:s===b?2+(P-v)/u:4+(v-b)/u,h*=60,h<0&&(h+=360),h}function d(_){const v=new Map;return _.filter(P=>{const s=JSON.stringify(P,Object.keys(P));return!v.has(s)&&(v.set(s,!0),!0)})}},68114:(ge,F,n)=>{"use strict";n.d(F,{u:()=>t});var t=function(e){return e[e.Modify=0]="Modify",e[e.Replace=1]="Replace",e}(t||{})},1367:(ge,F,n)=>{"use strict";n.d(F,{R:()=>t});class t{constructor(r={center:0,edge:1,centerBias:1,edgeBias:0,power:1}){const{edge:o,center:C,centerBias:E,edgeBias:y,power:d}=r;this.edge=o,this.center=C,this.centerBias=E,this.edgeBias=y,this.power=d}static toEngine(r){const{center:o,edge:C,centerBias:E,edgeBias:y,power:d}=r;return[o,C,E,y,d]}static isFresnelObject(r){let o=!1;return r&&(o="center,centerBias,edge,edgeBias,power"==Object.keys(r).sort().toString()),o}}},21894:(ge,F,n)=>{"use strict";n.d(F,{F:()=>t,i:()=>e});class t{constructor(){this.graph={unavailable:!1,hidden:!1,clipped:!1}}}const e={unavailable:"Trim objects that are un-available in ALL chapters",hidden:"Trim objects that are hidden in ALL chapters.",clipped:"Trim FULLY clipped objects in the CURRENT chapter."}},84426:(ge,F,n)=>{"use strict";n.d(F,{g:()=>w});var y,t=n(65763),e=n(21164),r=n(49204),o=n(79805),C=n(23881),E=n(12347);!function(te){function R(K,ae){const ce=Object.entries(ae);return ce.sort((U,Z)=>U[0].length===Z[0].length?0:U[0].length<Z[0].length?1:-1),ce.reduce((U,[Z,z])=>{if(U.startsWith(Z)){const H=new RegExp(`^${Z}`);U=U.replace(H,z)}return U},K||"")}te.renamespaceValue=R,te.renamespaceKeys=function D(K,ae){return Object.entries(K).reduce((ce,[U,Z])=>(ce[R(U,ae)]=Z,ce),{})},te.renamespaceAssetLibrary=function T(K,ae,ce){if(!ce)return K;const U=K.tweens.map(z=>R(z,ae)),Z=K.reflections.map(z=>R(z,ae));return{...K,tweens:U,reflections:Z}},te.renamespaceReflections=function re(K,ae,ce){return ce?(0,r.mapValues)(K,U=>R(U,ae)):K}}(y||(y={}));var d=n(38157),_=n(38970);const v=["objectId","displayName","geometryId","morphId","materialId","transformId"],b=["geometryId","materialId","morphId"];function P(te,R){return{availableObjects:(0,r.mapKeys)(te.availableObjects,(ce,U)=>y.renamespaceValue(U,R)),showObjects:(0,r.mapKeys)(te.showObjects,(ce,U)=>y.renamespaceValue(U,R)),selectObjects:(0,r.mapKeys)(te.selectObjects,(ce,U)=>y.renamespaceValue(U,R)),pickThroughObjects:(0,r.mapKeys)(te.pickThroughObjects,(ce,U)=>y.renamespaceValue(U,R)),synchronization:(0,r.mapKeys)(te.synchronization,(ce,U)=>y.renamespaceValue(U,R))}}function s(te,R){const D=T=>T.map(re=>re.type===d.X.flyToChapter||re.type===d.X.flyToObject?{...re,value:y.renamespaceValue(re.value,R)}:re);return(te||[]).map(T=>({...T,objectId:y.renamespaceValue(T.objectId,R),states:T.states.map(re=>({...re,errands:D(re.errands)}))}))}function g(te,R){return(te||[]).map(D=>(D.data.timeline=R[D.data.timeline]||D.data.timeline,D))}function u(te,R){return(te||[]).map(D=>(D.objectId&&(D.objectId=y.renamespaceValue(D.objectId,R)),D))}function h(te,R){return te?{xray:(0,r.mapKeys)(te.xray,(D,T)=>y.renamespaceValue(T,R)),highlight:(0,r.mapKeys)(te.highlight,(D,T)=>y.renamespaceValue(T,R))}:{}}function S(te,R){const T={...te};return Array.isArray(te?.layers)&&(T.layers=te.layers.map(re=>({...re,objectIds:re.objectIds.map(K=>y.renamespaceValue(K,R))}))),T}function i(te,R){return te.forEach(D=>{v.forEach(T=>{const re=D[T];re&&"string"==typeof re&&(D[T]=y.renamespaceValue(re,R))}),D.renderables?.forEach(T=>{b.forEach(re=>{const K=T[re];K&&"string"==typeof K&&(T[re]=y.renamespaceValue(K,R))})}),D.objects&&i(D.objects,R)}),te}function c(te,R){function D(K=[]){return K.map(ae=>({...ae,src:y.renamespaceValue(ae.src,R)}))}let re=[];return te&&Array.isArray(te.particleSystems)&&(re=te.particleSystems.map(function T(K){return(0,_.bF)(K)?{...K,textures:D(K.textures)}:{...K}})),re}function a(te,R){const D=function m(te,R){return"string"==typeof te?[R[te]||te]:te.map(D=>R[D]||D)}(te.stateId,R),T=te.assetLibraries.tweens.map(Z=>y.renamespaceValue(Z,R)),re=te.assetLibraries.reflections.map(Z=>y.renamespaceValue(Z,R)),K=(0,r.mapValues)(te.reflections,(Z,z)=>y.renamespaceValue(Z,R)),ae=function f(te,R){return te.map(D=>({...D,...P(D,R),colorRecipeObjects:h(D.colorRecipeObjects,R),timelineMap:g(D.timelineMap,R),labels:s(D.labels,R),hotspots:u(D.hotspots,R),visibilityLayers:S(D.visibilityLayers,R)}))}(te.chapters,R),ce=i(te.sceneGraph,R),U={...te.customData,particleSystems:c(te.customData,R)};return{...te,stateId:D,...P(te,R),assetLibraries:{...te.assetLibraries,tweens:T,reflections:re},reflections:K,chapters:ae,sceneGraph:ce,customData:U}}var l=n(38753),p=n(12921),A=n(87710),O=n(44867),L=n(18171),k=n(13409),q=n(60286),B=n(76724),j=n(35650),V=n(11724),M=n(38472);const N=1e-4;function W(te,R){const D={};return Math.abs(te[0]-R)>=N&&(D.x=te[0]),Math.abs(te[1]-R)>=N&&(D.y=te[1]),Math.abs(te[2]-R)>=N&&(D.z=te[2]),D.x||D.y||D.z?D:null}function Q(te,R){if(R[te.objectId])return null;let D={objectId:te.objectId,displayName:te.displayName,layer:te.layer};return te.transformId?D.transformId=te.transformId:D=function $(te,R){const D=V.vec3Pool.get();M.scale(D,te.sceneNode.rotation,180/Math.PI);const T={translate:W(te.sceneNode.position,0),rotate:W(D,0),scale:W(te.sceneNode.scale,1),pivot:W(te.sceneNode.origin,0)};return V.vec3Pool.release(D),(0,r.isNull)(T.translate)||(R.translate=T.translate),(0,r.isNull)(T.rotate)||(R.rotate=T.rotate),(0,r.isNull)(T.scale)||(R.scale=T.scale),(0,r.isNull)(T.pivot)||(R.pivot=T.pivot),R.transformId&&(console.error("There should not be a transform"),delete R.transformId),R}(te,D),D=function ne(te,R){const T=le(te.renderables??[]);return 1===T.length?(0,r.merge)(R,T[0]):T.length>1&&(R.renderables=T),R}(te,D),te.children&&te.children.length&&(D.objects=[]),te.children.forEach(T=>{const re=Q(T,R);null!==re&&D.objects.push(re)},this),te.variants?.length>1&&(D.variants=te.variants.map(T=>le(T))),D}function le(te){return te.map(R=>{const{geometryId:D,morphId:T,materialId:re,layer:K}=R;return{geometryId:D,morphId:T,materialId:re,layer:K}})}var ie=n(94495),be=n(2096),de=n(54438);let w=(()=>{var te;class R{constructor(T,re,K,ae,ce,U,Z,z){this.store=T,this.engineService=re,this.chapterSerializer=K,this.animationService=ae,this.chapterService=ce,this.paintService=U,this.clippingPlanesService=Z,this.sceneService=z}serializeUI(T){const re={...T.ui};return T.chapters.length>1&&(re.scrubber=!1,re.playPause=!1,re.tour={chapters:!0}),re}serializeAnimation(T){return this.animationService.isChapterAnimated(T)?{play:{startTime:T.timelineMap[0].start,loop:!1!==T.loop,numChapters:1}}:{}}getClippedObjects(){const T=this.store.selectSnapshot(ie.N.getSelectedChapterClippingPlanes),re=this.clippingPlanesService.createEngineClippingPlanes(T);return 0===re.length?{}:this.sceneService.getLeafIds().reduce((K,ae)=>{const ce=this.sceneService.getObjectById(ae);return this.sceneService.isObjectCulledByClip(ce,re)&&(K[ae]=!0),K},{})}generateTrimObjectMap(T){const re={};if(T.graph.unavailable){const ae=this.store.selectSnapshot(k.z.getAllNodeState);Object.values(ae).forEach(ce=>{Object.entries(ce).forEach(([U,Z])=>{!1!==re[U]&&(re[U]=!Z.available)})})}if(T.graph.hidden){const ae=this.store.selectSnapshot(k.z.getAllNodeState);Object.values(ae).forEach(ce=>{Object.entries(ce).forEach(([U,Z])=>{!1!==re[U]&&(re[U]=!(Z.shown||Z.shownSetByTween))})})}const K=T.graph.clipped?this.getClippedObjects():{};return{...re,...K}}trimObjects(T,re){if(re[T.objectId])return null;const K=[];return T.children.forEach(ae=>{const ce=this.trimObjects(ae,re);(0,r.isNil)(ce)||K.push(ce)}),T.children=K,T}serialize(T,re,K=!1,ae,ce,U){const Z=(0,r.cloneDeep)(ae),z=this.generateTrimObjectMap(re),H=this.sceneService.getRootObjects();Z.sceneGraph=function pe(te,R){const D=[];return Object.entries(te).forEach(([T,re])=>{const K=Q(re,R);null!==K&&D.push(K)},this),D}(H,z);const J=[];Object.values(H).forEach(We=>{const ze=this.trimObjects(We,z);null!==ze&&J.push(ze)},this);const Y=(0,C.ow)(this.paintService.getColorRecipes()),X=(0,O.fm)(J,Y),se=this.store.selectSnapshot(l.y.getLabels);Z.chapters=ce.map(We=>this.chapterSerializer.serializeChapter(X,We,T,se,U)),Z.ui=this.serializeUI(Z),Z.animation=this.serializeAnimation(ce[0]),Z.customData={...Z.customData,particleSystems:this.store.selectSnapshot(p.B.getParticleSystemsList)},Z.sourceInfo=(0,be.CE)(Z.sourceInfo);const oe=this.store.selectSnapshot(A.j.getAllQuestions),me=this.store.selectSnapshot(A.j.getQuizSettings);me&&oe.length>0?Z.quizSettings=me:delete Z.quizSettings,Z.playthroughSettings=ae.playthroughSettings,Z.tweenParticleLookup=this.store.selectSnapshot(p.B.getTweenParticleLookup);const Se=ce.reduce((We,ze)=>We.concat(this.chapterService.getChapterLightLibraries(ze)),[]),Ue=Array.from(new Set(Se));Z.assetLibraries.lights.forEach(We=>{Ue.includes(We)||Ue.push(We)}),Z.assetLibraries.lights=Ue;const je=this.getReflectionLibraries(Z.reflections),Le=ce.reduce((We,ze)=>We.concat(this.chapterService.getChapterReflectionLibraries(ze)),[]);Z.assetLibraries.reflections=Array.from(new Set(je.concat(Le)));const Re=[...Object.values(Z.assetLibraries)].flat(),Ee=this.getSceneGraphStateIds(Z.sceneGraph);return Z.stateId=Array.from(new Set(Re.map(this.getStateId).concat(Ee))),(0,r.isEmpty)(ae.variantSchemas)?delete Z.variantSchemas:Z.variantSchemas=ae.variantSchemas,{story:K?a(Z,T):Z}}getReflectionLibraries(T){return T=T||{},Object.values(T).map(K=>{const ae=K.split(".");return[ae[0],ae[1]].join("/")})}getSceneGraphStateIds(T){return T.map(re=>re.objectId.split("-")[0])}getStateId(T){return T.split("/")[0]}}return(te=R).\u0275fac=function(T){return new(T||te)(de.KVO(t.il),de.KVO(o.y),de.KVO(e.p),de.KVO(E.O),de.KVO(L.j),de.KVO(q.s),de.KVO(B.h),de.KVO(j.w))},te.\u0275prov=de.jDH({token:te,factory:te.\u0275fac,providedIn:"root"}),R})()},21164:(ge,F,n)=>{"use strict";n.d(F,{p:()=>A});var t=n(23881),e=n(49204),r=n(8358),o=n(44867),E=n(287);var b=n(65763),P=n(13409),s=n(63365),g=n(29284),u=n(12921),h=n(87710),S=n(65650),f=n(60286),m=n(63508),i=n(92333),c=n(56343),a=n(54438);const p={play:{count:1}};let A=(()=>{var O;class L{constructor(q,B,j){this.store=q,this.labelService=B,this.paintService=j}getMinimumGraphSync(q,B,j){const V=this.paintService.getColorRecipes(),M=Object.keys((0,t.ow)(V)),N=function C(O,L,k){const q={},B={};return(0,o.Wy)(O,V=>{B[V]=(0,o.jX)(O,V)?{...(0,o._D)(O,V,k),...L[V]||{}}:{...B[O.predecessors[V]],...L[V]||{}},(0,o.xe)(O,V)&&(q[V]=B[V])}),q}(q,B,M),W=function l(O){return O.reduce((L,k)=>(L[k]=c.t.MajorityWins,L),{available:c.t.MajorityWins,shown:c.t.MajorityWins,selected:c.t.MajorityWins,pickable:c.t.MajorityWins})}(V),$=function v(O,L,k){const q=Object.keys(L),B=Object.keys(k),j=(0,E.sO)(k,q),V=(0,E.FV)(B,O),M=(0,e.range)(V,-1).reduce(($,ne)=>{const Q=(0,E.AY)(O,Object.keys($.remainingVoters),ne),le=(0,E.kK)(O,$.remainingVoters,Q,L),pe=function d(O){return O.reduce((L,k)=>{const j=Object.keys(k).map(V=>function y(O,L,k,q){const B=q.reduce((j,V)=>(j[V]={[O]:!k},j),{});return B[L]={[O]:k},B}(V,k[V].id,k[V].result,k[V].dissenters)).reduce((V,M)=>(0,e.merge)(V,M),{});return Object.keys(j).forEach(V=>{L[V]=j[V]}),L},{})}(le.results);return Object.keys(pe).forEach(ie=>{$.syncGraph[ie]=pe[ie]}),$.remainingVoters=le.remainingVoters,$},{syncGraph:{},remainingVoters:j}).syncGraph;return function _(O,L,k,q){const B=L.reduce((j,V)=>{const N=O[V],W=O[q.predecessors[V]];for(const $ of k)N[$]===W[$]&&j.push({successorId:V,prop:$});return j},[]);for(const j of B)delete O[j.successorId][j.prop],0===Object.keys(O[j.successorId]).length&&delete O[j.successorId];return O}(M,Object.keys(M).filter($=>!O.roots[$]&&!!O.successors[$]),q,O)}(q,W,N);Object.entries(B).forEach(([Q,le])=>{const pe=(0,e.omit)(le,M);(0,e.isEmpty)(pe)||($[Q]={...$[Q]||{},...pe})});const ne=new t.YR;return Object.entries($).forEach(([Q,le])=>{ne[this.switchNamespace(Q,j)]=le},this),ne}convertGraphSync(q){const B={},j={},V={},M={},N={};return Object.entries(q).forEach(([W,$])=>{Object.entries($).forEach(([ne,Q])=>{"available"===ne?B[W]=Q:"shown"===ne?j[W]=Q:"selected"===ne?V[W]=Q:"pickable"===ne?M[W]=!Q:N[W]={...N[W]||{},[ne]:Q}},this)},this),{availableObjects:B,showObjects:j,selectObjects:V,pickThroughObjects:M,synchronization:N}}switchNamespace(q,B){return B[q]||q}serializeHotspots(q,B){let j=[...q.hotspots],V={};return B.filter(N=>N.chapterId===q.id).forEach(N=>{const W=this.labelService.serializeLabel(N,j.length);j=[...j,...W.hotspots],V={...V,...W.data}}),{customData:V,hotspots:j}}calcMinimumPaintState(q,B){function j(V,M=!0){const W=(q.successors[V]||[]).reduce(($,ne)=>({...$,...j(ne,!(0,e.isEqual)(B[V],B[ne]))}),{});return M?{[V]:B[V],...W}:W}return Object.keys(q.roots).reduce((V,M)=>({...V,...j(M)}),{})}serializeVisibilityLayers(q,B){const V={...q};return Array.isArray(q?.layers)&&(V.layers=q.layers.map(M=>({...M,objectIds:M.objectIds.filter(N=>Object.prototype.hasOwnProperty.call(B.nodes,N))})).filter(M=>M.objectIds.length>0)),V}serializeCamera(q){return{[q.action]:{...q.location,title:q.title===i.y?void 0:q.title},cameraRotationCenter:q.rotationCenter}}duplicateTimelineMap(q){return q?q.map(B=>{const j=(0,e.cloneDeep)(B);return delete j.id,j}):[]}duplicateQuizQuestions(q){return this.store.selectSnapshot(h.j.getQuizQuestionsByChapter(q)).map(B=>{const j=(0,e.cloneDeep)(B);return delete j.chapterId,j})}serializeChapter(q,B,j,V,M){const N=this.serializeHotspots(B,V),W=this.store.selectSnapshot(u.B.particleSystemsForChapter(B.id)),ne={...(0,e.pickBy)(B.customData,(R,D)=>!D.startsWith("errand")),...N.customData,particleSystems:W.map(R=>R.id)},Q=M[B.id],le=this.store.selectSnapshot(S.K.getRegisteredThumbnails),pe=le.get(Q)?.urls||le.get(B.id)?.urls||null,ie={id:Q,createdFrom:B.createdFrom,displayName:B.displayName,description:B.description,...this.serializeCamera(B.camera),background:B.background??{},hotspots:N.hotspots,clippingPlanes:{clips:B.clippingPlanes.clips,boundary:B.clippingPlanes.boundary},ui:(0,e.isEmpty)(B.ui)?p:B.ui,media:B.media,timelineMap:this.duplicateTimelineMap(B.timelineMap),customData:ne,transparencyMode:B.transparencyMode||null,fallbackTransparency:B.fallbackTransparency,properties:B.properties,transitions:B.transitions,legend:B.legend||[],visibilityLayers:this.serializeVisibilityLayers(B.sliderLayers.src,q),contentBlocks:B.contentBlocks||[],thumbnails:{default:"",...pe},quizQuestions:this.duplicateQuizQuestions(B.id),synchronization:void 0};if((0,m.Mi)(B))ie.lightLibraryId=B.lightLibraryId;else if((0,m.Uv)(B)){const R=ie;R.lights=B.lights,R.environment=B.environment}const de=this.store.selectSnapshot(P.z.getAllNodeState)[B.id],w=Object.entries(de).reduce((R,[D,T])=>{const re=T.shownSetByTween?(0,g.BK)(q,D,B.showObjects)||(0,g._x)(q,D,B.showObjects):T.shown;return R.boolState[D]={shown:re,pickable:T.pickable,available:T.available},R.paintState[D]=(0,s.Sf)(T.paint),R},{boolState:{},paintState:{}}),te=this.getMinimumGraphSync(q,w.boolState,j);return Object.entries(this.convertGraphSync(te)).forEach(([R,D])=>{ie[R]=D}),ie.synchronization=this.calcMinimumPaintState(q,w.paintState),ie}}return(O=L).\u0275fac=function(q){return new(q||O)(a.KVO(b.il),a.KVO(r.x),a.KVO(f.s))},O.\u0275prov=a.jDH({token:O,factory:O.\u0275fac,providedIn:"root"}),L})()},41862:(ge,F,n)=>{"use strict";n.d(F,{$j:()=>e,HZ:()=>C,IW:()=>b,N6:()=>v,hE:()=>o,lN:()=>r,m3:()=>_,tV:()=>y,ud:()=>E,yF:()=>t,zA:()=>d});let t=(()=>{class s{constructor(u){this.view=u}}return s.type="[Edit] Set view",s})(),e=(()=>{class s{constructor(){}}return s.type="[Edit] Next view",s})(),r=(()=>{class s{constructor(u=!1,h){this.quizLocked=u,this.quizQuestion=h}}return s.type="[Edit] Preview",s})(),o=(()=>{class s{constructor(){}}return s.type="[Edit] Previous view",s})(),C=(()=>{class s{constructor(u){this.collapsed=u}}return s.type="[Edit] Set Left Column Collapsed",s})(),E=(()=>{class s{constructor(u){this.show=u}}return s.type="[Edit] Show Timeline Editor",s})(),y=(()=>{class s{constructor(){}}return s.type="[Edit] Reset",s})(),d=(()=>{class s{constructor(u){this.layerOrderMode=u}}return s.type="[Edit] Set Layer Order Mode",s})(),_=(()=>{class s{constructor(u){this.show=u}}return s.type="[Edit] Show Tree Node Ids",s})(),v=(()=>{class s{constructor(u){this.show=u}}return s.type="[Edit] Show Root Nodes",s})(),b=(()=>{class s{constructor(u){this.size=u}}return s.type="[Edit] Set Canvas Size",s})()},81881:(ge,F,n)=>{"use strict";n.d(F,{Df:()=>C,GG:()=>e,Hr:()=>r,Nf:()=>E,T2:()=>P,WD:()=>t,b8:()=>d,hd:()=>_,ut:()=>b,wx:()=>g,yE:()=>y,yG:()=>v,yJ:()=>s,yk:()=>o});let t=(()=>{class h{constructor(f){this.colorRecipe=f}}return h.type="[Edit Paint] Set Color Recipe",h})(),e=(()=>{class h{constructor(f){this.brushMode=f}}return h.type="[Edit Paint] Set Paint Brush Mode",h})(),r=(()=>{class h{constructor(){}}return h.type="[Edit Paint] Clear Current Recipe",h})(),o=(()=>{class h{constructor(){}}return h.type="[Edit Paint] Reset Paint",h})(),C=(()=>{class h{constructor(f){this.recipe=f}}return h.type="[Edit Paint] Add Recent Recipe",h})(),E=(()=>{class h{constructor(f){this.recipes=f}}return h.type="[Edit Paint] Set Recent Recipes",h})(),y=(()=>{class h{constructor(){}}return h.type="[Edit Paint] Reset Story Recipes",h})(),d=(()=>{class h{constructor(f,m){this.chapterId=f,this.recipes=m}}return h.type="[Edit Paint] Set Story Recipes For Chapter",h})(),_=(()=>{class h{constructor(f){this.palette=f}}return h.type="[Edit Paint] Add Palette",h})(),v=(()=>{class h{constructor(f){this.paletteId=f}}return h.type="[Edit Paint] Remove Palette",h})(),b=(()=>{class h{constructor(f){this.palette=f}}return h.type="[Edit Paint] Update Palette",h})(),P=(()=>{class h{constructor(f){this.palettes=f}}return h.type="[Edit Paint] Set Palettes",h})(),s=(()=>{class h{constructor(f,m){this.recipe=f,this.paletteId=m}}return h.type="[Edit Paint] Add Recipe to Palette",h})(),g=(()=>{class h{constructor(f,m){this.paletteId=f,this.open=m}}return h.type="[Edit Paint] Toggle Palette",h})()},92676:(ge,F,n)=>{"use strict";n.d(F,{i:()=>m});var t=n(65763);class e{}var g,S,r=n(81881),o=n(20458),C=n(68114),E=n(58398),y=n(17215),d=n(49204),_=n(63365),v=n(94495),b=n(59676),P=n(59429),s=n(54438),u=function(i,c,a,l){var O,p=arguments.length,A=p<3?c:null===l?l=Object.getOwnPropertyDescriptor(c,a):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)A=Reflect.decorate(i,c,a,l);else for(var L=i.length-1;L>=0;L--)(O=i[L])&&(A=(p<3?O(A):p>3?O(c,a,A):O(c,a))||A);return p>3&&A&&Object.defineProperty(c,a,A),A},h=function(i,c){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(i,c)};const f={currentRecipe:o.Rn,brushMode:C.u.Replace,storyRecipes:{},recentRecipes:[],uniqueStoryRecipes:[],palettes:[]};let m=(S=g=class{static getCurrentRecipe(c){return c.currentRecipe}static getCurrentRecipeForEngine(c){return(0,_.Sf)(c.currentRecipe)}static getPaintBrushMode(c){return c.brushMode}static getRecentRecipes(c){return c.recentRecipes}static getStoryRecipes(c){return c.storyRecipes}static getUniqueStoryRecipes(c){return c.uniqueStoryRecipes}static getPalettes(c){return c.palettes}static getCurrentChapterRecipes(c,a){return c.storyRecipes[a.selectedChapter]}static getChapterRecipes(c){return(0,t.Mz)([S],a=>a.storyRecipes[c])}setCurrentRecipe(c,{colorRecipe:a}){c.patchState({currentRecipe:a})}setBrushMode(c,a){c.patchState({brushMode:a.brushMode})}clearCurrentRecipe(c,a){c.patchState({currentRecipe:null})}resetPaint(c,a){c.setState(f)}addRecentRecipe(c,a){let l=c.getState().recentRecipes;l.some(A=>(0,E.n4)(A,a.recipe))||(l.splice(0,0,a.recipe),l.length>14&&(l=l.slice(0,14)),this.storageService.setLocalItem(y.UT.RecentRecipes,l),c.patchState({recentRecipes:[...l]}))}setRecentRecipes(c,a){const l=(0,d.isNil)(a.recipes)?[]:[...a.recipes];c.patchState({recentRecipes:l}),this.storageService.setLocalItem(y.UT.RecentRecipes,l)}setStoryRecipesForChapter(c,a){const l=(0,E.c7)(a.recipes),p=c.getState().storyRecipes;p[a.chapterId]=[...l],c.patchState({storyRecipes:p});const A=Object.values(p).reduce((L,k)=>[...L,...k],[]),O=(0,E.c7)(A).sort(E.UD);c.patchState({uniqueStoryRecipes:O})}resetStoryRecipes(c,a){c.patchState({storyRecipes:{}})}addPalette(c,a){a.palette.id=P.u.idWithPrefix("palette");const l=[...c.getState().palettes,a.palette];c.dispatch(new r.T2(l))}updatePalette(c,a){const l=c.getState().palettes,p=l.findIndex(A=>A.id===a.palette.id);p>=0&&(l[p]={...a.palette}),c.dispatch(new r.T2(l))}removePalette(c,a){const l=[...c.getState().palettes.filter(p=>p.id!==a.paletteId)];c.dispatch(new r.T2(l))}setPalettes(c,a){const l=(0,d.cloneDeep)(a.palettes?[...a.palettes]:[]);c.patchState({palettes:l}),localStorage.setItem(y.UT.PaintPalettes,JSON.stringify(l))}addRecipeToPalette(c,a){const l=c.getState().palettes,p=l.findIndex(A=>A.id===a.paletteId);p>=0&&l[p].recipes.push(a.recipe),c.dispatch(new r.T2(l))}togglePalette(c,a){const l=c.getState().palettes,p=l.findIndex(A=>A.id===a.paletteId);p>=0&&(l[p].open=(0,d.isNil)(a.open)?!l[p].open:a.open,c.dispatch(new r.T2(l)))}ngxsOnInit(c){}constructor(c){this.storageService=c}},g.\u0275fac=function(c){return new(c||g)(s.KVO(y.n$))},g.\u0275prov=s.jDH({token:g,factory:g.\u0275fac}),g);u([(0,t.rc)(r.WD),h("design:type",Function),h("design:paramtypes",[Object,r.WD]),h("design:returntype",void 0)],m.prototype,"setCurrentRecipe",null),u([(0,t.rc)(r.GG),h("design:type",Function),h("design:paramtypes",[Object,r.GG]),h("design:returntype",void 0)],m.prototype,"setBrushMode",null),u([(0,t.rc)(r.Hr),h("design:type",Function),h("design:paramtypes",[Object,r.Hr]),h("design:returntype",void 0)],m.prototype,"clearCurrentRecipe",null),u([(0,t.rc)(r.yk),h("design:type",Function),h("design:paramtypes",[Object,r.yk]),h("design:returntype",void 0)],m.prototype,"resetPaint",null),u([(0,t.rc)(r.Df),h("design:type",Function),h("design:paramtypes",[Object,r.Df]),h("design:returntype",void 0)],m.prototype,"addRecentRecipe",null),u([(0,t.rc)(r.Nf),h("design:type",Function),h("design:paramtypes",[Object,r.Nf]),h("design:returntype",void 0)],m.prototype,"setRecentRecipes",null),u([(0,t.rc)(r.b8),h("design:type",Function),h("design:paramtypes",[Object,r.b8]),h("design:returntype",void 0)],m.prototype,"setStoryRecipesForChapter",null),u([(0,t.rc)(r.yE),h("design:type",Function),h("design:paramtypes",[Object,r.yE]),h("design:returntype",void 0)],m.prototype,"resetStoryRecipes",null),u([(0,t.rc)(r.hd),h("design:type",Function),h("design:paramtypes",[Object,r.hd]),h("design:returntype",void 0)],m.prototype,"addPalette",null),u([(0,t.rc)(r.ut),h("design:type",Function),h("design:paramtypes",[Object,r.ut]),h("design:returntype",void 0)],m.prototype,"updatePalette",null),u([(0,t.rc)(r.yG),h("design:type",Function),h("design:paramtypes",[Object,r.yG]),h("design:returntype",void 0)],m.prototype,"removePalette",null),u([(0,t.rc)(r.T2),h("design:type",Function),h("design:paramtypes",[Object,r.T2]),h("design:returntype",void 0)],m.prototype,"setPalettes",null),u([(0,t.rc)(r.yJ),h("design:type",Function),h("design:paramtypes",[Object,r.yJ]),h("design:returntype",void 0)],m.prototype,"addRecipeToPalette",null),u([(0,t.rc)(r.wx),h("design:type",Function),h("design:paramtypes",[Object,r.wx]),h("design:returntype",void 0)],m.prototype,"togglePalette",null),u([(0,t.MD)(),h("design:type",Function),h("design:paramtypes",[e]),h("design:returntype",void 0)],m,"getCurrentRecipe",null),u([(0,t.MD)(),h("design:type",Function),h("design:paramtypes",[e]),h("design:returntype",void 0)],m,"getCurrentRecipeForEngine",null),u([(0,t.MD)(),h("design:type",Function),h("design:paramtypes",[e]),h("design:returntype",void 0)],m,"getPaintBrushMode",null),u([(0,t.MD)(),h("design:type",Function),h("design:paramtypes",[e]),h("design:returntype",void 0)],m,"getRecentRecipes",null),u([(0,t.MD)(),h("design:type",Function),h("design:paramtypes",[e]),h("design:returntype",void 0)],m,"getStoryRecipes",null),u([(0,t.MD)(),h("design:type",Function),h("design:paramtypes",[e]),h("design:returntype",void 0)],m,"getUniqueStoryRecipes",null),u([(0,t.MD)(),h("design:type",Function),h("design:paramtypes",[e]),h("design:returntype",void 0)],m,"getPalettes",null),u([(0,t.MD)([v.N]),h("design:type",Function),h("design:paramtypes",[e,b.G]),h("design:returntype",void 0)],m,"getCurrentChapterRecipes",null),m=S=u([(0,t.Uw)({name:"editPaint",defaults:f}),h("design:paramtypes",[y.n$])],m)},12347:(ge,F,n)=>{"use strict";n.d(F,{O:()=>s});var t=n(28407),e=n(49204),r=n(79805),o=n(11724),C=n(515),E=n(65763),y=n(33013),d=n(94495),_=n(47610),v=n(55494),P=n(54438);let s=(()=>{var g;class u{constructor(S,f){this.engineService=S,this.store=f,this.fps=30}setChapter(S,f=!1){var m=this;return(0,t.A)(function*(){const{story:i}=m.engineService.engine,{chapters:c,activeChapter:a}=i;if(S&&(S!==a?.id||f)){const p=c.findIndex(A=>A.id===S);return i.activateChapter(p).then(A=>(m.initPlayer(A),A.id))}return S})()}initPlayer(S){this.destroyPlayer();const{animationSystem:f}=S;this._animationPlayer=new o.BioDigitalAnimationPlayer(f),this.engineService.engine.renderer.on("animate",()=>{this.engineService.fireEvent(C.X.TimelineAnimatingStart),this._animationPlayer.update(),this.engineService.fireEvent(C.X.TimelineAnimatingEnd)}),this._animationPlayer.on("timeupdate",()=>{this.engineService.fireEvent(C.X.TimelinePlaying,{time:this._animationPlayer.currentTime})}),this._animationPlayer.on("play",()=>{this.engineService.fireEvent(C.X.TimelinePlayed,{time:this._animationPlayer.currentTime})}),this._animationPlayer.on("pause",()=>{this.engineService.fireEvent(C.X.TimelinePaused,{time:this._animationPlayer.currentTime})}),this._animationPlayer.on("ended",()=>{this.engineService.fireEvent(C.X.TimelineCompleted)}),this._animationPlayer.on("ratechange",({playBackRate:q})=>{const B=this.engineService.engine?.story;B&&(B.playBackRate=q)});const m=this.store.selectSnapshot(v.S.getPlaybackSpeed);this.setPlaybackRate(m);const i=[];S.timelineMap.forEach((q,B)=>{const j={id:B,...q};j.name=j.name??"",i.push(j)}),this.store.dispatch(new y.bg(i)),S.timelineMap.on("change",()=>{this.engineService.fireEvent(C.X.TimelineTimeFrameUpdated)}),this.store.dispatch(new y.M5(S.id,{model:!0,animation:!0}));const c=this.store.selectSnapshot(v.S.getChapter),a=this.store.selectSnapshot(d.N.getStoryChapters),l=a.findIndex(q=>q.id===c),p=a.findIndex(q=>q.id===S.id),L=-1===(this.store.selectSnapshot(d.N.getChapter(S.id))?.ui?.play?.count??0);this.setAnimationLoop(L),l!==p&&this.engineService.fireEvent(C.X.TimelineChapterTransition,{oldChapterIndex:l,newChapterIndex:p,time:0}),this.store.dispatch(new _.u3(S.id))}destroyPlayer(){this._animationPlayer?.pause(),this._animationPlayer?.destroy(),this._animationPlayer=null}isChapterAnimated(S){return!!S?.timelineMap&&function b(g){return g.some(u=>"dummy"!==u?.data?.timeline&&"dummy"!==u?.name)}(S.timelineMap)}isChapterLooped(S){return!0===(0,e.get)(S,"loop")||-1===(0,e.get)(S,"ui.play.count")}restart(){if((0,e.isNil)(this._animationPlayer))return;const S=this.isPlaying();S&&this.pause(),this._animationPlayer.currentTime=0,S&&this.play()}play(){this._animationPlayer?.play(),this.playParticles()}pause(){this._animationPlayer?.pause(),this.pauseParticles()}unpause(){this._animationPlayer&&(this.hasChapterFinished()&&this.scrub(0),this.play())}scrub(S){this._animationPlayer&&(this._animationPlayer.currentTime=(0,e.clamp)(S,0,this._animationPlayer.duration),this.engineService.fireEvent(C.X.TimelineScrubbed,{time:this._animationPlayer.currentTime}))}scrubRelative(S,f){this._animationPlayer&&(f&&this.isPlaying()?(this.pause(),this.scrub(this.getTime()+S),setTimeout(()=>this.unpause())):this.scrub(this.getTime()+S))}scrubFrame(S){const f="next"===S?1:-1,m=this.getTime(),c=this.secondsToFrames(m)+f,a=this.framesToSeconds(c);this.scrub(a)}secondsToFrames(S){return Math.round(S*this.fps)}framesToSeconds(S){return S/this.fps}getNearestFrameTime(S){return this.framesToSeconds(this.secondsToFrames(S))}formatTime(S){const f=p=>{const A=S<0?Math.ceil:Math.floor;return Math.abs(A(p)).toString().padStart(2,"0")},i=f(S/60),c=f(S%60),a=(p=>Math.abs(this.secondsToFrames(p%1)).toString().padStart(2,"0"))(S%1);return`${S<0?"-":""}${i}:${c}:${a}`}parseFormattedTime(S){const f=/^-/,m=f.test(S)?-1:1;-1===m&&(S=S.replace(f,""));const i=S.split(":").reverse();let c=parseInt(i[0],10),a=parseInt(i[1],10),l=parseInt(i[2],10);return isNaN(c)&&(c=0),isNaN(a)&&(a=0),isNaN(l)&&(l=0),(60*l+a+this.framesToSeconds(c))*m}updateTimelineClips(S){const f=this.engineService.engine.story.activeChapter;S.forEach(m=>{f.timelineMap.set(m.id,m)})}deleteTimelineClips(S){const f=this.engineService.engine.story.activeChapter;S.forEach(m=>{f.timelineMap.delete(m)})}setPlaybackRate(S){this._animationPlayer.playBackRate=S}getStoryAnimationNames(){const S=this.store.selectSnapshot(d.N.getStoryChapters),f=[];return S.forEach(m=>{m.timelineMap.forEach(i=>{const c=i.data.timeline;f.includes(c)||f.push(c)})}),f}getChapterTimeFrame(S){return{firstTime:0,lastTime:this.getChapterDuration(S)}}getChapterDuration(S){return(0,e.isNil)(S)?(0,e.isNil)(this._animationPlayer)?0:this._animationPlayer.duration:this.engineService.engine.story.chapters.find(c=>c.id===S)?.animationSystem?.duration??0}getTime(){return(0,e.isNil)(this._animationPlayer)?0:this._animationPlayer.currentTime}isPlaying(){return!(0,e.isNil)(this._animationPlayer)&&!this._animationPlayer.paused}hasChapterFinished(){return!(0,e.isNil)(this._animationPlayer)&&this._animationPlayer.currentTime===this._animationPlayer.duration}setAnimationLoop(S){if(!this._animationPlayer)throw new Error("Animation player is not initialized");this._animationPlayer.loop=S}mapChapterGlobalTime(S,f){let m=f;if((0,e.isNil)(m))return 0;const i=this.store.selectSnapshot(d.N.getStoryChapters),c=i.findIndex(a=>a.id===S);for(let a=0;a<c;a++){let p=0;i[a].timelineMap.forEach(A=>{A.end>p&&(p=A.end)}),m-=p}return m}mapGlobalTimeToChapterId(S){let f=0;const m=this.store.selectSnapshot(d.N.getStoryChapters);let i;for(let c=0;c<m.length;c++){const a=m[c],l=this.getChapterDuration(a.id);if(S>=f&&S<f+l){i=a.id;break}f+=l}return S===f&&!i&&(i=m[m.length-1].id),i}getGlobalTime(){const S=this.store.selectSnapshot(d.N.getSelectedChapterIndex),f=this.store.selectSnapshot(d.N.getStoryChapters);let m=this._animationPlayer.currentTime;for(let i=0;i<S;i++){let a=0;f[i].timelineMap.forEach(l=>{l.end>a&&(a=l.end)}),m+=a}return m}playParticles(){this.engineService.engine?.story?.activeChapter?.start()}pauseParticles(){this.engineService.engine?.story?.activeChapter?.stop()}}return(g=u).\u0275fac=function(S){return new(S||g)(P.KVO(r.y),P.KVO(E.il))},g.\u0275prov=P.jDH({token:g,factory:g.\u0275fac,providedIn:"root"}),u})()},13955:(ge,F,n)=>{"use strict";n.d(F,{I:()=>y});var t=n(28407),e=n(65763),r=n(94495),o=n(79805),C=n(63508),E=n(54438);let y=(()=>{var d;class _{constructor(b,P){this.engineService=b,this.store=P}getGeometries(){return{}}getGeometryCompressionSupported(){return!0}getLoadedAssets(){return{}}getLights(){return{}}getMaterials(){return{}}getTextureCompressionSupported(){return!0}getMorphs(){return{}}getAssetLibrary(b,P,s){const{server:g,serverBaseDirectory:u}=this.engineService;return g.getAssetLibrary(u,b,P,s)}getAssetNamespaces(){const b={},P=this.getLoadedAssets();return Object.keys(P).map(s=>s.split("/")[0]).forEach(s=>{b[s]=!0}),Object.keys(b)}enableLightLib(b){const s=this.getLights()[b];if(Array.isArray(s)){const g={};s.forEach(u=>{g[u]=!0}),console.warn("Enabling of lights in real-time not yet implemented.")}}setBranchLights(b,P){const s=this.store.selectSnapshot(r.N.getSelectedChapter);(0,C.Uv)(s)&&s.lights.libraries[0]!==P&&(s.lights.libraries[0]=P,this.enableLightLib(P))}loadLightLib(b){var P=this;return(0,t.A)(function*(){return P.getAssetLibrary("lights",b,"outline").then(s=>({type:"physicalImageLight"in s?"physical":"legacy",libId:b,asset:s}))})()}getLightingLibs(b){var P=this;return(0,t.A)(function*(){return Promise.all(b.map(s=>P.loadLightLib(s)))})()}}return(d=_).\u0275fac=function(b){return new(b||d)(E.KVO(o.y),E.KVO(e.il))},d.\u0275prov=E.jDH({token:d,factory:d.\u0275fac,providedIn:"root"}),_})()},3266:(ge,F,n)=>{"use strict";n.d(F,{j:()=>O});var t=n(13491),e=n(85052),r=n(66017),o=n(15913),C=n(2353),E=n(38472),y=n(79805),d=n(11724),_=n(515),v=n(35650),b=n(46889),P=n(49204);const u={backOff:0,stopFOV:55,dist:2.5};function h(L,k,q,B=u){const j={...u,...B},V=j.dist,M=j.stopFOV,N=1-(0,P.clamp)(j.backOff,0,1),W=(0,b.E8)(L,k);return Math.abs(W/(1+.8*N)/Math.tan(M/2))/q*V}function S(L,k,q){const B=t.n.toArray(L.look),j=t.n.toArray(L.eye),V=E.create();E.subtract(V,j,B);const M=E.create();E.normalize(M,V);const N=Math.abs(E.length(M)),{min:W,max:$}=(0,C.n)(k),ne=h(W,$,N,q),Q=(0,b.A1)(W,$);E.scale(V,M,ne);const le=E.add(E.create(),Q,V);return{eye:t.n.fromArray(le),look:t.n.fromArray(Q),up:t.n.fromArray([0,1,0])}}class f{constructor(k,q){this.tempVec=E.create(),this.eyeVec=E.create(),this.lookVec=E.create(),this.cameraService=k;const{targetCamera:B,targetBoundary:j}=q,V=k.getCamera();if(this.initialLook=t.n.toArray(V.look),this.initialEye=t.n.toArray(V.eye),this.initialUp=t.n.toArray(V.up),j){E.subtract(this.tempVec,this.initialEye,this.initialLook);const $=E.create();E.normalize($,this.tempVec);const ne=Math.abs(E.length($)),{min:Q,max:le}=(0,C.n)(j),pe=h(Q,le,ne,q);E.scale(this.tempVec,$,pe),this.targetLook=(0,b.A1)(Q,le),this.targetEye=E.add(E.create(),this.targetLook,this.tempVec),this.targetUp=E.fromValues(0,1,0)}B&&(this.targetLook=t.n.toArray(B.look),this.targetEye=t.n.toArray(B.eye),this.targetUp=t.n.toArray(B.up)),E.subtract(this.tempVec,this.targetLook,this.initialLook);const M=Math.abs(E.length(this.tempVec));E.subtract(this.tempVec,this.targetEye,this.initialEye);const N=Math.abs(E.length(this.tempVec));this.animationDuration=q.animationDuration?1e3*q.animationDuration:1e3*((M>N?M:N)/(200*(q.velocity||1))+1),this.onComplete=q.onComplete}update(k){if(void 0===this.startTime&&(this.startTime=k,this.endTime=this.startTime+this.animationDuration),this.animationDone||k>this.endTime)return this.animationDone||this.cameraService.setCamera({eye:t.n.fromArray(this.targetEye),look:t.n.fromArray(this.targetLook),up:t.n.fromArray(this.targetUp)}),this.animationDone=!0,void this.onComplete(this);const B=(0,b.vT)((k-this.startTime)/this.animationDuration,0,1);(0,b.dL)(B,0,1,this.initialLook,this.targetLook,this.lookVec),(0,b.dL)(B,0,1,this.initialEye,this.targetEye,this.eyeVec),(0,b.dL)(B,0,1,this.initialUp,this.targetUp),this.cameraService.setCamera({eye:t.n.fromArray(this.eyeVec),look:t.n.fromArray(this.lookVec),up:t.n.fromArray(this.targetUp)})}stop(){}}var m=n(54438),i=n(81642);const l=180/Math.PI,p=1/d.BIODIGITAL_SCENE_SCALE,A=d.BIODIGITAL_SCENE_SCALE;let O=(()=>{var L;class k{get cameraController(){const B=this.engineService.engine?.story?.cameraController;if(!B)throw new Error("Story not instantiated, cannot get camera controller");return B}constructor(B,j,V){this.engineService=B,this.numberService=j,this.sceneService=V,this.rotation={vx:0,vy:0},this.pan={x:0,y:0,z:0},this.zoom=0,this.animationCallbacks=[],this.initCameraEvents()}tickCamera(B){this.animation&&this.animation.update(performance.now())}getCamera(){const{up:B,target:j,position:V}=this.cameraController,M=d.vec3Pool.get(),N=d.vec3Pool.get();E.scale(M,V,p),E.scale(N,j,p);const W={eye:t.n.fromArray(M),look:t.n.fromArray(N),up:t.n.fromArray(B)};return d.vec3Pool.release(M),d.vec3Pool.release(N),W}setCamera(B,j=!1){const{cameraController:V}=this,{eye:M,look:N,up:W}=B;let $,ne,Q;M&&($=d.vec3Pool.get(),E.scale($,t.n.toArray(M),A)),N&&(ne=d.vec3Pool.get(),E.scale(ne,t.n.toArray(N),A)),W&&(Q=t.n.toArray(W)),V.setCamera($??V.position,ne??V.target,Q),$&&d.vec3Pool.release($),ne&&d.vec3Pool.release(ne),N&&!j&&this.setCameraRotationCenter(N)}getLookDirection(){const{target:B,position:j}=this.cameraController,V=E.create();return E.sub(V,B,j),E.normalize(V,V),V}getLookDistance(){return this.cameraController.distance*p}getCameraZoom(){return this.cameraController.zoom}captureCamera(){return{lookAt:this.getCamera(),zoom:this.getCameraZoom()}}getDirection(B){const{position:j}=this.cameraController,V=E.create();return E.sub(V,j,B.worldPos),E.normalize(V,V),[V[0],V[1],V[2]]}rotateCameraStatic(B,j){this.cameraController.orbit(B/l,j/l)}panCameraStatic(B,j,V){this.cameraController.pan(B*A,j*A,V*A)}setRelativeZoom(B){this.cameraController.dolly(B)}setAbsoluteZoom(B){this.cameraController.zoom=B}getCameraRotationCenter(){const B=d.vec3Pool.get();E.scale(B,this.cameraController.center,p);const j=t.n.fromArray(B);return d.vec3Pool.release(B),j}setCameraRotationCenter(B){const j=d.vec3Pool.get(),V=Array.isArray(B)?B:t.n.toArray(B);E.scale(j,V,A),E.copy(this.cameraController.center,j),d.vec3Pool.release(j)}setCameraRotation(B,j){this.rotation.vx=j,this.rotation.vy=-B}setCameraPan(B,j){this.pan.x=B,this.pan.y=j}setCameraZoom(B){this.zoom=.03*B}setCameraZoomWithVelocity(B){this.setCameraZoom(B),requestAnimationFrame(()=>{B*=.85,Math.abs(B)>1&&this.setCameraZoomWithVelocity(B)})}tickCameraRotation(){return this.rotation.vx=this.checkEpsilon(this.rotation.vx),this.rotation.vy=this.checkEpsilon(this.rotation.vy),this.rotation}tickCameraPan(){return this.pan.x=this.checkEpsilon(this.pan.x),this.pan.y=this.checkEpsilon(this.pan.y),this.pan.z=this.checkEpsilon(this.pan.z),this.pan}tickCameraZoom(){return this.zoom=this.checkEpsilon(this.zoom),this.zoom}areCamerasEqual(B,j){return this.compareXYZ(B.eye,j.eye)&&this.compareXYZ(B.look,j.look)&&this.compareXYZ(B.up,j.up)}compareXYZ(B,j){return B.x===j.x&&B.y===j.y&&B.z===j.z}roundCamera(B,j){const{eye:V,look:M,up:N}=B;return{eye:this.numberService.roundModel(V,j),look:this.numberService.roundModel(M,j),up:this.numberService.roundModel(N,j)}}flyToObject(B,j){return new Promise(V=>{const M=this.sceneService.getObjectBoundary([B]);(0,C.L)(M)?(this.animationCallbacks.push(V),this.animation=new f(this,{targetBoundary:M,animationDuration:j,onComplete:()=>{this.finishAnimation()}}),this.animation.update(performance.now())):V(void 0)})}flyToCamera(B,j){return new Promise(V=>{this.animationCallbacks.push(V),this.animation=new f(this,{targetCamera:B,animationDuration:j,onComplete:()=>{this.finishAnimation()}}),this.animation.update(performance.now())})}jumpToObject(B){const j=this.sceneService.getObjectBoundary([B]);if((0,C.L)(j)){const M=S(this.getCamera(),j);return this.jumpToCamera(M)}return new Promise(V=>V(void 0))}jumpToCamera(B){return new Promise(j=>{this.finishAnimation(),this.setCamera(B),j(void 0)})}getCameraAfterFlyTo(B){return S(this.getCamera(),B)}checkEpsilon(B){return Math.abs(B)<.001?0:B}initCameraEvents(){const B=new e.B,j=B.asObservable();j.subscribe(N=>{this.engineService.fireEvent(_.X.CameraUpdated,N)});const M=this.engineService.getEvent(_.X.Tick).pipe((0,r.S)(2));j.pipe((0,o.s)(()=>M)).subscribe(N=>{this.engineService.fireEvent(_.X.CameraRested,N)}),this.engineService.engineCreated$.subscribe(N=>{N.camera.on("updateWorldMatrix",W=>{if(!N?.story)return;const Q={...this.getCamera(),dist:this.getLookDistance()};B.next(Q)})})}finishAnimation(){for(this.animation&&(this.animation.stop(),this.animation=null);this.animationCallbacks.length>0;)this.animationCallbacks.pop()()}}return(L=k).\u0275fac=function(B){return new(B||L)(m.KVO(y.y),m.KVO(i.D),m.KVO(v.w))},L.\u0275prov=m.jDH({token:L,factory:L.\u0275fac,providedIn:"root"}),k})()},76724:(ge,F,n)=>{"use strict";n.d(F,{h:()=>y});var t=n(79805),e=n(11724),o=n(49204),E=n(54438);let y=(()=>{var d;class _{constructor(b){this.engineService=b}createEngineClippingPlanes(b){return(0,e.makeClippingPlanes)(b)}setClippingPlanes(b){const{story:P}=this.engineService.engine,{activeChapter:s}=P;if((0,o.isNil)(s))return;const g=this.createEngineClippingPlanes(b);s.clippingPlanes.length=0,s.clippingPlanes.push(...g)}}return(d=_).\u0275fac=function(b){return new(b||d)(E.KVO(t.y))},d.\u0275prov=E.jDH({token:d,factory:d.\u0275fac,providedIn:"root"}),_})()},26655:(ge,F,n)=>{"use strict";n.d(F,{A:()=>r,m:()=>o});const r=n(11724).VERSION,o="2.0.1"},46799:(ge,F,n)=>{"use strict";n.d(F,{z:()=>v});var t=n(65133),e=n(38472),r=n(11724);const o={stats:{textures:{baseColor:{"1024x1024":1,memory:1e6,"512x512":1,"2048x2048":1},alpha:{"1024x1024":1,memory:1e6,"512x512":1},normals:{"1024x1024":1,memory:1e6,"512x512":1,"2048x2048":1},emit:{"1024x1024":1,memory:1e6,"512x512":1,"256x256":1},roughness:{"512x512":1,memory:1e6,"1024x1024":1}}}};var C=n(79805),E=n(515),y=n(54438);const d=t.create(),_=t.create();let v=(()=>{var b;class P{get canvas(){if(!this.engineService.engine)throw new Error("Engine not defined, cannot use canvas");return this.engineService.engine.renderer.canvas}constructor(g){this.engineService=g}forceRenderFrame(){this.engineService.engine.renderer.render()}getCanvas(){return this.canvas}getScene(){return o}getViewMat(){return this.scaleAndNormalizeMatrix(this.engineService.engine.story.camera.worldMatrixInverse)}getProjMat(){return this.scaleAndNormalizeMatrix(this.engineService.engine.story.camera.projectionMatrix)}pick(g,u,h=!0){const S=this.engineService.engine,f=S.story?.anatomySceneGraph,m=S.rayCastCamera(g,u,{filter:i=>f?.findAnatomyObject(i)?.pickable});if(m){const i=this.generateHitModel(f,g,u,m,h);return this.engineService.fireEvent(E.X.PickPicked,i),i}return{canvasPos:{x:g,y:u}}}setTransparencyMode(g){this.engineService.engine.renderer.transparencyMode=g}scaleAndNormalizeMatrix(g){return t.copy(_,g),_[12]*=r.BIODIGITAL_SCENE_SCALE,_[13]*=r.BIODIGITAL_SCENE_SCALE,_[14]*=r.BIODIGITAL_SCENE_SCALE,_}generateHitModel(g,u,h,S,f){const{triIndex:m,intersection:i,object:c}=S,a=g.findAnatomyObject(c),{objectId:l,renderables:p}=a,A=p.findIndex(q=>q.meshNode===c),O=p[A]?.meshNode,k={canvasPos:{x:u,y:h},objectId:l,renderableIndex:A,triIndex:m};if(f){const q=this.getBarycentricCoordinate(O,i,m),B=this.getTriangleNormal(O,m);return e.scale(i,i,1/r.BIODIGITAL_SCENE_SCALE),{...k,barycentric:q,worldPos:i,normal:B}}return k}getBarycentricCoordinate(g,u,h){const S=e.create(),f=r.vec3Pool.get(),m=r.vec3Pool.get(),i=r.vec3Pool.get(),c=r.vec3Pool.get();return t.invert(d,g.worldMatrix),e.transformMat4(f,u,d),(0,r.getTrianglePositions)(g,h,m,i,c),(0,r.barycentricCoord)(S,f,m,i,c),e.transformMat4(m,m,g.worldMatrix),e.transformMat4(i,i,g.worldMatrix),e.transformMat4(c,c,g.worldMatrix),r.vec3Pool.release(f),r.vec3Pool.release(m),r.vec3Pool.release(i),r.vec3Pool.release(c),S}getTriangleNormal(g,u){const h=e.create(),S=r.vec3Pool.get(),f=r.vec3Pool.get(),m=r.vec3Pool.get();return(0,r.getTrianglePositions)(g,u,S,f,m),e.transformMat4(S,S,g.worldMatrix),e.transformMat4(f,f,g.worldMatrix),e.transformMat4(m,m,g.worldMatrix),(0,r.triangleNormal)(h,S,f,m),r.vec3Pool.release(S),r.vec3Pool.release(f),r.vec3Pool.release(m),h}}return(b=P).\u0275fac=function(g){return new(g||b)(y.KVO(C.y))},b.\u0275prov=y.jDH({token:b,factory:b.\u0275fac,providedIn:"root"}),P})()},16515:(ge,F,n)=>{"use strict";n.d(F,{x:()=>f});var t=n(60177),e=n(65763),r=n(55494),o=n(10381),C=n(3829),E=n(21604),y=n(45189),d=n(89417),_=n(13409),v=n(82192),b=n(82109),P=n(89511),s=n(12921),g=n(76037),u=n(66915),h=n(43631),S=n(54438);let f=(()=>{var m;class i{}return(m=i).\u0275fac=function(a){return new(a||m)},m.\u0275mod=S.$C({type:m}),m.\u0275inj=S.G2t({imports:[e.rK.forFeature([h._,r.S,C.x,_.z,b.N,s.B]),t.MD,P.h,y.G,d.YN,d.X1,o.k,E.G,v.G,u.z,g.J]}),i})()},79805:(ge,F,n)=>{"use strict";n.d(F,{y:()=>w});var t=n(28407),e=n(29160),r=n(85052),o=n(14264),C=n(11756),E=n(40215),y=n(37925),d=n(515),_=n(24418),v=n(17215),b=n(85884),P=n(27180),s=n(54438),g=n(38645);let u=(()=>{var te;class R{constructor(T){this.router=T}redirectToErrorPage(T,re,K){(this.router.url||"").match("/error")||this.router.navigateByUrl(_.c.application===P.c.Viewer?"/error":"/view/error",{skipLocationChange:!0,state:{errorType:T,errorCode:re,error:K,errorUrl:this.router.url}})}}return(te=R).\u0275fac=function(T){return new(T||te)(s.KVO(g.Ix))},te.\u0275prov=s.jDH({token:te,factory:te.\u0275fac,providedIn:"root"}),R})();var h=n(11724),S=n(49204);const f={[h.FogModeNumericEnum.Linear]:"linear",[h.FogModeNumericEnum.Exponential]:"exp",[h.FogModeNumericEnum.ExponentialSquared]:"exp2"};n(77015);var i=n(4845),c=n(70432),a=n(93163);const l=(te,R)=>(0,h.joinPath)(te,"assets",R),A=5,O=new a.A({concurrency:900});function k(){return(k=(0,t.A)(function*(te,R,D){const T=yield fetch(te,{signal:R});return T.ok?D(T):null})).apply(this,arguments)}function q(te,R,D,T){return B.apply(this,arguments)}function B(){return B=(0,t.A)(function*(te,R,D,T){const re=l(R,D);return O.add(()=>(0,c.A)(()=>function L(te,R,D){return k.apply(this,arguments)}(re,te,T),{retries:A}))}),B.apply(this,arguments)}function j(te,R,D){return q(te,R,D,function(){var T=(0,t.A)(function*(re){return re.json()});return function(re){return T.apply(this,arguments)}}())}function V(te,R,D){return q(te,R,D,function(){var T=(0,t.A)(function*(re){return re.arrayBuffer()});return function(re){return T.apply(this,arguments)}}())}function N(){return(N=(0,t.A)(function*(te){return(yield fetch(te)).json()})).apply(this,arguments)}function $(){return($=(0,t.A)(function*(te,R){return O.add(()=>(0,c.A)(()=>fetch("/assets/"+te,R),{retries:A}))})).apply(this,arguments)}const ne={material:j,morph:V,geometry:V,transform:j};class Q{fetch(R,D){return(0,t.A)(function*(){const T=O.add(()=>(0,c.A)(()=>fetch(R),{retries:A}));return void 0!==T?T:null})()}constructor(R,D,T={}){let re=new h.BioDigitalWebSocketServer(D,T);const K=typeof AbortController>"u"?null:new h.MultiKeyMap;function U(){return U=(0,t.A)(function*(Z,z,H,J){const Y=H.split("/"),X=(0,h.joinPath)(Z,"content/states",Y[0],z,Y[1],J);return O.add(()=>(0,c.A)(()=>function M(te){return N.apply(this,arguments)}(X),{retries:A}))}),U.apply(this,arguments)}this.getAsset=function(){var Z=(0,t.A)(function*(z,H){const J=ne[z];if(!J)throw new Error("BioDigitalHybridServer: Unsupported type '$type'");let Y=null;K&&(Y=new AbortController,K.set(z,H,Y));let X=yield J(Y?.signal,R,H);return null===X&&(X=yield function ae(){return re||(re=new h.BioDigitalWebSocketServer(D,T)),re}().getAsset(z,H),function W(te,R){$.apply(this,arguments)}(H,{method:"PUT",body:"morph"===z||"geometry"===z?X:JSON.stringify(X)})),K&&K?.delete(z,H),X});return function(z,H){return Z.apply(this,arguments)}}(),this.getAssetLibrary=function ce(Z,z,H,J){return U.apply(this,arguments)},this.destroy=()=>{K&&(K.forEach(Z=>Z.abort()),K.clear()),re&&re.destroy()}}}var le=n(26982);let pe=(()=>{var te;class R extends le.U{}return(te=R).\u0275fac=(()=>{let D;return function(re){return(D||(D=s.xGo(te)))(re||te)}})(),te.\u0275prov=s.jDH({token:te,factory:te.\u0275fac,providedIn:"root"}),R})();var ie=n(21626);let w=(()=>{var te;class R{get engine(){return this._engine}get server(){return this._server}get serverBaseDirectory(){return typeof localBaseDirectory>"u"?"/":localBaseDirectory}constructor(T,re,K,ae,ce){this.errorService=T,this.storageService=re,this.engineEventService=K,this.http=ae,this.rollbar=ce,this.events={},this.errorLogged=!1,this._engineCreated=new e.t(void 0),this._engineDestroyed=new r.B,this.registerEngineWorkers(),this.events=Object.values(d.X).reduce((U,Z)=>(U[Z]=this.engineEventService.getEvent(Z),U),{}),this.engineCreated$=this._engineCreated.asObservable().pipe((0,o.p)(U=>!(0,S.isNil)(U))),this.engineDestroyed$=this._engineDestroyed.asObservable(),this.engineCreated$.pipe((0,C.Z)(U=>this.getGPUCapabilities(U))).subscribe(U=>{this.gpuCapabilities=U}),this.initEngineErrorHandling()}getEvent(T){return this.events[T]}fireEvent(T,re){this.engineEventService.fireEvent(T,re)}initEngine(T){return this.createServerInstance(),this.createEngineInstance(T),this.fireEvent(d.X.Loaded),this.engine}destroyEngine(){this._engine&&(this._engineCreated.next(void 0),this._engineDestroyed.next(),this._engine.destroy(),this._engine=null),this._server&&(this._server.destroy(),this._server=null)}setStory(T){this.engine.setStory(T),_.c.offline&&(this._server.moduleId=T.moduleId,typeof requiresFileExtensions<"u"&&(this._server.requiresFileExtensions=requiresFileExtensions)),this.engine.story.chapters.forEach(re=>{re.on("progress",()=>{const{id:K,loadProgress:ae}=re;this.fireEvent(d.X.AssetsLoadProgress,{chapterId:K,chapterProgress:ae})})})}getWEBGLInfo(){return this.gpuCapabilities?.webgl?.params}setProperties(T){const{story:re,renderer:K}=this.engine,ae=re?.activeChapter,ce=re?.cameraController;(0,S.isNil)(ae)||(this.setFogProperties(K,ae,T),this.setCameraProperties(K,ae,ce,T))}setFogProperties(T,re,K){Object.entries(K).forEach(([ce,U])=>{if(ce.startsWith("fog.")&&((0,S.has)(T.environment,ce)&&(0,S.set)(re.properties,ce,U),(0,S.has)(T.environment,ce)))switch(ce){case"fog.density":T.environment.fog.density=U/h.BIODIGITAL_SCENE_SCALE;break;case"fog.mode":T.environment.fog.mode=f[U];break;case"fog.start":T.environment.fog.start=U*h.BIODIGITAL_SCENE_SCALE;break;case"fog.end":T.environment.fog.end=U*h.BIODIGITAL_SCENE_SCALE;break;default:(0,S.set)(T.environment,ce,U)}}),!1===K["fog.enabled"]&&(T.environment.fog.mode="")}setCameraProperties(T,re,K,ae){Object.entries(ae).forEach(([Z,z])=>{if(Z.startsWith("camera."))switch(Z){case"camera.optics.near":re.properties.camera.optics.near=z;break;case"camera.optics.far":re.properties.camera.optics.far=z;break;case"camera.optics.fov":re.properties.camera.optics.fov=z;break;case"camera.zoomLimits":re.properties.camera.zoomLimits=z}});const{optics:ce,zoomLimits:U}=re.properties.camera;T.camera.fov=ce.fov*Math.PI/180,T.camera.far=ce.far*h.BIODIGITAL_SCENE_SCALE,T.camera.near=ce.near*h.BIODIGITAL_SCENE_SCALE,T.camera.dirtyProjection(),K.minDistance=U.min*h.BIODIGITAL_SCENE_SCALE,K.maxDistance=U.max*h.BIODIGITAL_SCENE_SCALE}getGPUCapabilities(T){var re=this;return(0,t.A)(function*(){return re.gpuCapabilities=re.gpuCapabilities??(yield T.renderer.getGPUCapabilities()),re.gpuCapabilities})()}initAnalytics(T,re,K,ae){var ce=this;return(0,t.A)(function*(){ce.gpuAnalytic={version:4,app_producttype:T,app_productkey:re,gpu_data:{},acct_cred_type:K,acct_cred_id:ae,offline_event:_.c.offline?1:0};const U=yield(0,E._)(ce.engineCreated$),Z=yield ce.getGPUCapabilities(U);if(ce.gpuAnalytic={...ce.gpuAnalytic,gpu_data:{...Z}},!ce.storageService.getSessionItem(v.d0.GPUAnalyticsStored)){const H=_.c.offline?{...ce.gpuAnalytic,event_timestamp:(new Date).toISOString().substring(0,19)}:ce.gpuAnalytic;_.c.offline?fetch("https://human.biodigital.com/ws/product/analytic/gpu-event",{method:"POST",body:JSON.stringify(H),headers:new Headers({"Content-Type":"application/json; charset=utf-8"}),mode:"no-cors"}).then(()=>{ce.storageService.setSessionItem(v.d0.GPUAnalyticsStored,Date.now())}):ce.http.post("/ws/product/analytic/gpu-event",H,{headers:{"Content-Type":"application/json; charset=utf-8"}}).subscribe(()=>{ce.storageService.setSessionItem(v.d0.GPUAnalyticsStored,Date.now())})}})()}createServerInstance(){if(this._server)throw new Error("Websocket server already exists");this._server=_.c.offline?new h.BioDigitalFileServer(this.serverBaseDirectory):_.c.native?new Q(this.serverBaseDirectory,_.c.assetDomain,{timeout:6e5,socketProtocol:"wss"}):new h.BioDigitalWebSocketServer(_.c.assetDomain,{timeout:6e5})}createEngineInstance(T){if(this._engine)throw new Error("Engine is already instantiated");try{const re=typeof localBaseDirectory>"u"?"/":localBaseDirectory;this._engine=new h.BioDigitalEngine(this._server,{...T,baseUrl:re}),this.initEngineTickEvent(this._engine),this.initTweenVisibilityEvent(this._engine),this._engineCreated.next(this._engine)}catch(re){const K=re??new Error("There was an error creating the engine");this.fireEvent(d.X.HumanError,K)}}initEngineErrorHandling(){this.getEvent(d.X.HumanError).pipe((0,o.p)(T=>!(0,S.isNil)(T))).subscribe(T=>{this.handleFatalEngineErrors(T)})}initEngineTickEvent(T){const re=K=>{this.fireEvent(d.X.Tick,K)};T.renderer.on("animate",re),T.on("destroy",()=>{T.renderer.off("animate",re)})}initTweenVisibilityEvent(T){let re={shown:{},shownSetByTween:{},variant:{}},K=!1;this.getEvent(d.X.TimelineAnimatingStart).pipe((0,y.Q)(this._engineDestroyed)).subscribe(()=>{K=!0,re={shown:{},shownSetByTween:{},variant:{}}}),this.getEvent(d.X.TimelinePlaying).pipe((0,y.Q)(this._engineDestroyed)).subscribe(()=>{const{shownSetByTween:ae,variant:ce}=re;Object.keys(ae).length>0&&this.fireEvent(d.X.TweenVisibilityUpdate,ae),Object.keys(ce).length>0&&this.fireEvent(d.X.VariantsUpdate,ce),K=!1,re={shown:{},shownSetByTween:{},variant:{}}}),T.on("changestory",()=>{const ae=U=>{const Z=U?.property,z=U?.object,H=z?.objectId;if(Z in re&&(re[Z][H]=z[Z],"shown"===Z&&K)){const{shown:Y}=z;re.shownSetByTween[H]=Y}},{anatomyObjects:ce}=T.story.anatomySceneGraph;ce.forEach(U=>{U.on("change",ae)})}),T.on("changechapter",()=>{const{anatomyObjects:ae}=T.story.anatomySceneGraph,ce={shown:{},shownSetByTween:{},variant:{}};ae.forEach(Z=>function de(te,R){for(const D in te)D in R&&(te[D][R.objectId]=R[D])}(ce,Z));const{variant:U}=ce;this.fireEvent(d.X.VariantsUpdate,U)})}registerEngineWorkers(){new Worker(n.tu(new URL(n.p+n.u(401),n.b))),(0,h.registerWorker)("geometry",()=>new Worker(n.tu(new URL(n.p+n.u(762),n.b)))),(0,h.registerWorker)("texture",()=>new Worker(n.tu(new URL(n.p+n.u(235),n.b)))),(0,h.registerWorker)("simulation",()=>new Worker(n.tu(new URL(n.p+n.u(513),n.b))))}handleFatalEngineErrors(T){const{message:re,name:K,stack:ae}=T,ce={name:K,message:re,stack:ae},U={...this.gpuAnalytic,error_category:K,error_message:JSON.stringify({message:re,stack:ae})};_.c.offline&&(U.event_timestamp=(new Date).toISOString().substring(0,19)),this.errorLogged||(this.rollbar.error(T),this.http.post("/ws/product/error/gpu-event",U,{headers:{"Content-Type":"application/json; charset=utf-8"}}).subscribe(),this.errorLogged=!0),this.errorService.redirectToErrorPage(b.Y.Engine,void 0,ce)}}return(te=R).\u0275fac=function(T){return new(T||te)(s.KVO(u),s.KVO(v.n$),s.KVO(pe),s.KVO(ie.Qq),s.KVO(i.g8))},te.\u0275prov=s.jDH({token:te,factory:te.\u0275fac,providedIn:"root"}),R})()},62943:(ge,F,n)=>{"use strict";n.d(F,{T4:()=>d,iu:()=>o,tH:()=>C,ty:()=>y});var t=n(11789);function o(_){if(!Object.keys(_).length)return null;const v=[..._.colors];v.forEach((g,u)=>{v[u]=(u+1)%4&&g<=1?Math.round(255*g):g});const b=/radial|linear/.test(_.gradientType)?_.gradientType:"radial",P=_.colorStops,s=Array.isArray(P)&&2===P.length?[P[0],P[1]]:[0,100];return{colors:v,gradientType:b,colorStops:s}}function C(_){const v=_.colors,b=`rgba(${v[0]},${v[1]}, ${v[2]}, ${v[3]}) ${_.colorStops[0]}%`,P=`rgba(${v[4]},${v[5]}, ${v[6]}, ${v[7]}) ${_.colorStops[1]}%`;return"radial"===_.gradientType?`radial-gradient(circle, ${b}, ${P})`:`linear-gradient(180deg, ${b}, ${P})`}function y(_){if(!_||!_.colors)return!1;const v=_.colors,b=v[3];return v.length<=4?0===b:0===b&&0===v[7]}function d(_){const v=_?.colors;if(Array.isArray(v)){const b=v.slice(0,3);return t.T.isLight(b)}return!1}},2353:(ge,F,n)=>{"use strict";n.d(F,{L:()=>o,n:()=>r});var t=n(49204);function r(C){const{xmin:E,ymin:y,zmin:d,xmax:_,ymax:v,zmax:b}=C;return{min:[E,y,d],max:[_,v,b]}}function o(C){if((0,t.isNil)(C))return!1;{const E=Object.values(C);return 6===E.length&&E.every(y=>Number.isFinite(y))}}},57021:(ge,F,n)=>{"use strict";n.d(F,{x:()=>t});class t{constructor(r=0,o=0,C=0,E=0,y=0,d=!1){this.zoom=r,this.panX=o,this.panY=C,this.rotateX=E,this.rotateY=y,this.applyFriction=d}}},73987:(ge,F,n)=>{"use strict";n.d(F,{h:()=>t});var t=function(e){return e[e.Tiny=0]="Tiny",e[e.Small=1]="Small",e[e.Standard=2]="Standard",e}(t||{})},515:(ge,F,n)=>{"use strict";n.d(F,{X:()=>t});var t=function(e){return e.Started="started",e.Loaded="loaded",e.Tick="tick",e.HumanReady="human.ready",e.HumanStarted="started",e.Error="error",e.HumanError="human.error",e.CanvasResized="canvas.resized",e.HumanCanvasResized="human.canvasResized",e.LogDebug="_log.debug",e.LogError="_log.error",e.LogInfo="_log.info",e.LogWarn="_log.warn",e.SceneLoaded="scene.loaded",e.HumanProgress="human.progress",e.AssetsLoadFinish="assets.load.finish",e.AssetsLoadProgress="assets.load.progress",e.AssetsLoadStart="assets.load.start",e.CameraRested="camera.rested",e.CameraUpdated="camera.updated",e.ModuleInteractive="module.interactive",e.ModulesActivateFinish="modules.activate.finish",e.ModulesCreateFinish="modules.create.finish",e.ModulesDestroyFinish="modules.destroy.finish",e.ModulesFetchStart="modules.fetch.start",e.PickPicked="pick.picked",e.SceneMarkersUpdated="scene.markers.updated",e.SceneObjectRenderable="scene.objectRenderable",e.SceneObjectsSelected="scene.objectsSelected",e.SceneObjectsShown="scene.objectsShown",e.ScenePicked="scene.picked",e.SceneRestored="scene.restored",e.SceneXrayEnabled="scene.xrayEnabled",e.SceneXrayDisabled="scene.xrayDisabled",e.SceneReady="scene.ready",e.TimelineChapterTransition="timeline.chapterTransition",e.TimelinePlaying="timeline.playing",e.TimelineScrubbed="timeline.scrubbed",e.TimelinePlayed="timeline.played",e.TimelinePaused="timeline.paused",e.TimelineCompleted="timeline.completed",e.TimelineTimeFrameUpdated="timeline.timeFrame.updated",e.TimelineAnimatingStart="timeline.animating.start",e.TimelineAnimatingEnd="timeline.animating.end",e.GraphAssetAttachFinish="graph.assetAttach.finish",e.TweenVisibilityUpdate="TweenVisibilityUpdate",e.VariantsUpdate="VariantsUpdate",e}(t||{})},24911:(ge,F,n)=>{"use strict";n.d(F,{j:()=>t});class t{constructor(r,o,C,E,y,d,_,v){this.viewportWidth=r,this.viewportHeight=o,this.left=C,this.top=E,this.width=y,this.height=d,this.visibility=_,this.scale=v}}},4664:(ge,F,n)=>{"use strict";n.d(F,{g:()=>t});var t=function(e){return e[e.Hidden=-1]="Hidden",e[e.Shown=1]="Shown",e}(t||{})},20458:(ge,F,n)=>{"use strict";n.d(F,{EC:()=>P,Me:()=>s,NR:()=>e,Rn:()=>o,_d:()=>g});var t=n(1367);const e={label:"Original",tintColor:!1,saturation:!1,contrast:!1,brightness:!1,opacity:!1},o={tintColor:[1,0,0],saturation:!1,contrast:!1,brightness:!1,opacity:!1},P={label:"Fade",tintColor:[0,0,0],contrast:!1,brightness:55,saturation:-100,opacity:new t.R({edge:1,center:0,edgeBias:0,centerBias:1,power:1})},s=[e,{tintColor:[0,0,0],saturation:!1,contrast:!1,brightness:!1,opacity:!1},o,{tintColor:[1,1,0],saturation:!1,contrast:!1,brightness:!1,opacity:!1},{tintColor:[0,1,0],saturation:!1,contrast:!1,brightness:!1,opacity:!1},{tintColor:[0,1,1],saturation:!1,contrast:!1,brightness:!1,opacity:!1},{tintColor:[0,0,1],saturation:!1,contrast:!1,brightness:!1,opacity:!1},{tintColor:[1,0,1],saturation:!1,contrast:!1,brightness:!1,opacity:!1}],g=[{label:"Grayscale",tintColor:!1,saturation:-100,contrast:!1,brightness:!1,opacity:!1},{label:"Desaturated",tintColor:!1,saturation:-50,contrast:!1,brightness:!1,opacity:!1},P]},38970:(ge,F,n)=>{"use strict";n.d(F,{$t:()=>e,Po:()=>o,Uy:()=>t,Xr:()=>E,bF:()=>y,kC:()=>d,lc:()=>r,zu:()=>C});var t=function(_){return _.DirectionalVelocity="DirectionalVelocity",_.Lifetime="Lifetime",_.PointPosition="PointPosition",_.RandomVelocity="RandomVelocity",_.SpherePosition="SpherePosition",_.CylinderPosition="CylinderPosition",_.CubePosition="CubePosition",_.RandomRotation="RandomRotation",_.RandomRotationSpeed="RandomRotationSpeed",_.RandomScale="RandomScale",_.SpriteAnimationDuration="SpriteAnimationDuration",_}(t||{}),e=function(_){return _.AgeColorBlend="AgeColorBlend",_.BrownianMotion="BrownianMotion",_.UniformForce="UniformForce",_.RadialForce="RadialForce",_.Friction="Friction",_.Gravity="Gravity",_.Path="Path",_.AxisForce="AxisForce",_.SpriteAnimation="SpriteAnimation",_}(e||{}),r=function(_){return _.LifetimeKill="LifetimeKill",_.LifetimeStop="LifetimeStop",_.PathKill="PathKill",_.PathStop="PathStop",_.PathRadius="PathRadius",_.ShapeBounce="ShapeBounce",_.ShapeKill="ShapeKill",_.ShapeStop="ShapeStop",_}(r||{}),o=function(_){return _.Sphere="Sphere",_.Plane="Plane",_.Cube="Cube",_.Cylinder="Cylinder",_}(o||{}),C=function(_){return _.In="in",_.Out="out",_}(C||{});function E(_){return"materialId"in _}function y(_){return"material"in _&&!("workflow"in _.material)}function d(_){return"material"in _&&"workflow"in _.material}},13878:(ge,F,n)=>{"use strict";n.d(F,{M:()=>t});var t=function(e){return e.Capture="capture",e.DoNotCaptureShowMessage="do_not_capture_show_message",e.DoNotCapture="do_not_capture",e}(t||{})},1308:(ge,F,n)=>{"use strict";n.d(F,{F$:()=>y,_:()=>E});var t=n(20342),e=n(10352),r=n(9592),o=n(62943);const E={imageType:r.H.JPEG,crop:"original",copyrightEnabled:!1,copyrightImagePath:t.O.viewer.full_dark.logo_url,copyrightPosition:{x:"left",y:"bottom"},copyrightOffset:{x:12,y:-12},imageQuality:1};function y(d,_){return d===r.H.PNG?_||e.RK:_&&!(0,o.ty)(_)?_:e.RK}},47555:(ge,F,n)=>{"use strict";n.d(F,{s:()=>t});var t=function(e){return e.Select="Select",e.Hide="Hide",e.Paint="Paint",e.Eyedropper="Eyedropper",e.Label="Label",e.Isolate="Isolate",e.Fade="Fade",e.Positions="Positions",e.Quiz="Quiz",e.Image="Image",e.Dimensions="Dimensions",e.Background="Background",e}(t||{})},46107:(ge,F,n)=>{"use strict";n.d(F,{H6:()=>b,Om:()=>P,TH:()=>o,WC:()=>C,_T:()=>v,dS:()=>g,fY:()=>s,iw:()=>_,ky:()=>d,nt:()=>E,u5:()=>y});const t=[4,8,12,16,24,32],r=u=>u.slice(0).reverse().map(h=>({label:`${h}`,size:h})),o=r(t),C=r([8,12,16,20,24,32]),E=r(t),y={color:"#000000"},d={color:"#ffffff"},_=o[4],v=y,b=C[3],P=E[4],s=y,g=d},94604:(ge,F,n)=>{"use strict";n.d(F,{w:()=>f});var t=n(65763),e=n(78109),r=n(75069),o=n(3266),C=n(20458),E=n(35650),y=n(81025),_=n(7431),v=n(3829),b=n(55494),P=n(61295),s=n(13409),g=n(12865),u=n(92676),h=n(54438),S=n(18617);let f=(()=>{var m;class i{constructor(a,l,p,A,O){this.store=a,this.graphService=l,this.cameraService=p,this.sceneService=A,this.liveAnnouncer=O}applyCurrentRecipe(a){const l=this.store.selectSnapshot(u.i.getCurrentRecipe);if(!l)return;Object.entries(l).forEach(([A,O])=>{typeof O>"u"&&(l[A]=!1)}),this.store.dispatch(new P.Jp(l,a));const p=a.reduce((A,O)=>(A[O]=!1,A),{});this.sceneService.setNodesProperty(p,"selected")}fadeInverse(a){const l=this.store.selectSnapshot(b.S.getViewGraph),p=this.graphService.getInverseSelection(l,a),A=this.graphService.getNodes(l,p);this.store.dispatch(new P.Jp(C.EC,A.map(O=>O.id))).subscribe(()=>{this.liveAnnouncer.announce("Fade complete")})}fade(a){this.store.dispatch(new P.Jp(C.EC,a)).subscribe(()=>{this.liveAnnouncer.announce("Fade complete")})}hideInverse(a){const l=this.store.selectSnapshot(b.S.getViewGraph),p=this.graphService.getAllLeafDescendants(l,a),A=this.graphService.getInverseSelection(l,a),O={};p.forEach(M=>{O[M]=!0}),A.forEach(M=>{O[M]=!1});const L=new P.yr(void 0,void 0,O),k=(0,g.r)(this.store.selectSnapshot(s.z),L,this.sceneService);this.store.dispatch(new P.NP(k.patches));const q=this.sceneService.getObjectBoundary(a),B=this.cameraService.getCameraAfterFlyTo(q),j=new _.Yp(B),V=function d(m,i){const[c,a,l]=y.vI(m,p=>{p.cameraFlyTo=i.camera});return{nextState:c,patches:a,inversePatches:l}}(this.store.selectSnapshot(v.x),j);this.store.dispatch(new _.sQ(V.patches)).subscribe(()=>{this.liveAnnouncer.announce("Isolate complete")}),this.store.dispatch(new P.hg),this.store.dispatch(new P.q9(!1)),this.store.dispatch(new r.a.SavePatches([{forward:k.patches,inverse:k.inversePatches,patchAction:P.NP},{forward:V.patches,inverse:V.inversePatches,patchAction:_.sQ}]))}}return(m=i).\u0275fac=function(a){return new(a||m)(h.KVO(t.il),h.KVO(e.w),h.KVO(o.j),h.KVO(E.w),h.KVO(S.Ai))},m.\u0275prov=h.jDH({token:m,factory:m.\u0275fac,providedIn:"root"}),i})()},60286:(ge,F,n)=>{"use strict";n.d(F,{s:()=>E});var t=n(78109),e=n(63365),r=n(35650),C=n(54438);let E=(()=>{var y;class d{constructor(v,b){this.graphService=v,this.sceneService=b,this.highlightDisabled=!1}colorObject(v,b){const P=this.sceneService.getObjectById(v);if(this.sceneService.isLeaf(P)){const s=P.modifiers;Object.keys(b).forEach(g=>{const u=b[g];if(!1===u)s.delete(g);else if(Array.isArray(u)&&5===u.length){const[h,S,f,m,i]=u;s.set(g,{applyTo:g,fresnel:{center:h,edge:S,centerBias:f,edgeBias:m,power:i}})}else s.set(g,{applyTo:g,value:u})})}}getColor(v){return function o(y,d){const _=y.getObjectById(d);if(y.isLeaf(_)){const b={};return _.modifiers.forEach(P=>{b[P.applyTo]=P.fresnel??P.value}),b}return null}(this.sceneService,v)}uncolorObject(v){const b=this.sceneService.getObjectById(v);this.sceneService.isLeaf(b)&&b.modifiers.clear()}unpaint(v,b){this.graphService.getLeafDescendants(v,b.id).forEach(P=>{const s=this.sceneService.getObjectById(P);this.sceneService.isLeaf(s)&&s.modifiers.clear()})}paint(v,b,P){const s=(0,e.Sf)(P);this.graphService.getLeafDescendants(v,b).forEach(g=>{this.colorObject(g,s)})}highlight(v,b,P){(!1===this.highlightDisabled||!1===P)&&this.graphService.getLeafDescendants(v,b).forEach(s=>{const g=this.sceneService.getObjectById(s);this.sceneService.isLeaf(g)&&(g.selected=P)})}paintAll(v,b,P){b.forEach(s=>this.paint(v,s,P))}unpaintAll(v,b){b.forEach(P=>{this.unpaint(v,P)})}highlightAll(v,b,P){b.forEach(s=>this.highlight(v,s,P))}disableHighlight(){this.highlightDisabled=!0}enableHighlight(){this.highlightDisabled=!1}setHighlightColor(v){}getColorRecipes(){return[]}}return(y=d).\u0275fac=function(v){return new(v||y)(C.KVO(t.w),C.KVO(r.w))},y.\u0275prov=C.jDH({token:y,factory:y.\u0275fac,providedIn:"root"}),d})()},5188:(ge,F,n)=>{"use strict";n.d(F,{j:()=>r});var t=n(79805),e=n(54438);let r=(()=>{var o;class C{constructor(y){this.engineService=y}setPostProcessingFeatures(y){const{renderer:d,story:_}=this.engineService.engine;_?.activeChapter&&(_.activeChapter.postProcess.length=0,_.activeChapter.postProcess.push(...y)),d.setPostProcessingPipeline(y)}}return(o=C).\u0275fac=function(y){return new(y||o)(e.KVO(t.y))},o.\u0275prov=e.jDH({token:o,factory:o.\u0275fac,providedIn:"root"}),C})()},35650:(ge,F,n)=>{"use strict";n.d(F,{w:()=>S});var t=n(2353),e=n(38472),r=n(44867),o=n(23881),C=n(78109),E=n(79805),y=n(11724),_=n(46889),v=n(49204),P=n(56343),s=n(54438);const g=1/y.BIODIGITAL_SCENE_SCALE,u=new y.AABB,h={shown:P.t.TrueWins,renderable:P.t.FalseWins,pickable:P.t.TrueWins};let S=(()=>{var f;class m{constructor(c,a){this.engineService=c,this.graphService=a}getObjects(){const c={};return this.getAnatomySceneGraph()?.anatomyObjects.forEach((l,p)=>c[p]=l),c}getObjectById(c){return this.getAnatomySceneGraph()?.anatomyObjects?.get(c)}getObjectsById(c){const l=this.getAnatomySceneGraph()?.anatomyObjects;return c.reduce((p,A)=>{const O=l?.get(A);return O&&(p[O.objectId]=O),p},{})}isObjectLoaded(c){return!0===this.getObjectById(c)?.loaded}isObjectCulledByClip(c,a){if(0===a.length)return!1;const l=a.map(p=>p.plane);return c.renderables.some(p=>(0,y.boxIntersectsPlaneBounds)(l,p.meshNode.worldBounds))}getRootObjects(){return this.getAnatomySceneGraph()?.anatomyRoots??[]}getSceneBoundary(){const{rootNode:c}=this.engineService.engine;return this.getSceneNodeBoundaryModel([c],u)}getObjectBoundary(c){const a=c.map(l=>this.getObjectById(l).sceneNode);return this.getSceneNodeBoundaryModel(a,u)}getObjectBoundaryCenter(c){const a=this.getObjectBoundary([c]),{min:l,max:p}=(0,t.n)(a);return(0,_.A1)(l,p)}setShownObjects(c){const{replace:a,showObjects:l}=c,p=this.getRootObjects();this.setObjectsShown(p,l,!a&&void 0)}getLeavesByObject(c){const a=c.children??[];return 0===a.length?[c]:a.map(l=>this.getLeavesByObject(l)).flat()}getLeaves(c){if(c){const a=this.getObjectById(c);return a?this.getLeavesByObject(a):[]}return this.getRootObjects().map(l=>this.getLeavesByObject(l)).flat()}getLeafIds(c){return this.getLeaves(c).map(a=>a.objectId)}getEnabledLeafIds(){return this.getLeaves().filter(c=>!0===c?.shown).map(c=>c.objectId)}isLeaf(c){return 0===c.children.length}transformObject(c,a){const l=this.getObjectById(c)?.sceneNode;l?(0,y.applyTransform)(l,a):console.error(`Scene node not found: '${c}'`)}setNodesVisible(c,a=!1){const l={replace:a,showObjects:{...c}};this.setShownObjects(l)}setNodesProperty(c,a){Object.keys(c).forEach(l=>{const p=this.getObjectById(l);(this.isLeaf(p)?[l]:this.getLeafIds(l)).forEach(O=>{this.getObjectById(O)[a]=c[l]})})}setObjectLayer(c,a,l){c.get(a).layer=l}setObjectVariant(c,a,l){c.get(a).variant=l}getObjectLayerValues(c){const a={},l=this.getSceneBoundary();return c.forEach(p=>{const A=this.getObjectById(p),O=this.getObjectBoundary([p]),L=Math.min(O.xmin-l.xmin,l.xmax-O.xmax),k=2*Math.min(O.ymin-l.ymin,l.ymax-O.ymax),q=Math.min(O.zmin-l.zmin,l.zmax-O.zmax),B=A.layer;a[B]=a[B]??[],a[B].push({nodeId:p,value:Math.min(L,k,q)})}),a}getWorldPosition(c,a,l,p=0){const O=this.getObjectById(c)?.renderables[p]?.meshNode;if((0,v.isNil)(O))return;const L=O.worldMatrix,k=e.create(),q=y.vec3Pool.get(),B=y.vec3Pool.get(),j=y.vec3Pool.get();return(0,y.getTrianglePositions)(O,a,q,B,j),(0,y.cartesianCoord)(k,l,q,B,j),e.transformMat4(k,k,L),e.scale(k,k,1/y.BIODIGITAL_SCENE_SCALE),y.vec3Pool.release(q),y.vec3Pool.release(B),y.vec3Pool.release(j),k}getSceneGraph(c){const{anatomyObjects:a}=this.getAnatomySceneGraph(),l={...(0,o.ow)(),shown:A=>!0===a.get(A)?.shown,pickable:A=>!0===a.get(A)?.pickable,label:A=>a.get(A)?.displayName??"",layer:A=>a.get(A)?.layer??0},p=(0,r.fm)(c,l);return this.graphService.synchronize(p,h),p}createViewGraph({availableObjects:c,showObjects:a,includeRoot:l=!1,viewGraphMetadata:p}){const A=this.getRootObjects(),O=a?(0,r.TJ)(A,a):A,L=O.reduce((q,B)=>{const j=!l&&B.objectId.includes("-root");return q[B.objectId]=!j,j&&B.children.forEach(V=>{q[V.objectId]=!0}),q},{}),k=this.getSceneGraph((0,r.TJ)(O,L));return this.graphService.resetDepth(k),(0,v.isEmpty)(c)||this.computeObjectAvailable(k,c),(0,v.isEmpty)(p)||this.computeNodesMetadata(k,p),k}computeObjectAvailable(c,a){const{anatomyObjects:l}=this.getAnatomySceneGraph(),p=O=>l.get(O).parent?.objectId,A=O=>{const L=l.get(O);return L?L.children.map(k=>k.objectId):[]};Object.entries(c.nodes).forEach(([O,L])=>{L.boolState.available=(0,r.If)(O,a,p,A)})}computeNodesMetadata(c,a){(0,r.u7)(c,a)}getViewNode(c,a){return this.graphService.nodeExists(c,a)?(0,r.dV)(c,a):null}setObjectsShown(c,a,l){c.forEach(p=>{const O=a[p.objectId]??l;"boolean"==typeof O&&p.shown!==O&&(p.shown=O),this.setObjectsShown(p.children,a,l)})}getSceneNodeBoundaryModel(c,a){const{min:l,max:p}=this.getSceneNodeBounds(c,a);return e.scale(l,l,g),e.scale(p,p,g),{xmin:l[0],ymin:l[1],zmin:l[2],xmax:p[0],ymax:p[1],zmax:p[2]}}getSceneNodeBounds(c,a){return a.clear(),c.forEach(l=>{(0,y.traverseSceneNodes)(l,p=>{p instanceof y.MeshNode&&a.expand(p.worldBounds)})}),a}getChapterIndex(c){return this.engineService.engine.story?.chapters?.findIndex(p=>p.id===c)}getChapter(c){const a=this.engineService.engine?.story,l=a?.chapters,p=a?.activeChapterIndex;return l?.[c??p]}getAnatomySceneGraph(){return this.engineService.engine?.story?.anatomySceneGraph}}return(f=m).\u0275fac=function(c){return new(c||f)(s.KVO(E.y),s.KVO(C.w))},f.\u0275prov=s.jDH({token:f,factory:f.\u0275fac,providedIn:"root"}),m})()},30582:(ge,F,n)=>{"use strict";n.d(F,{M:()=>S});var t=n(28407),e=n(21472),r=n(15877),o=n(35892),C=n(2573),E=n(65763),y=n(36110),d=n(65533),_=n(11756),v=n(28577),b=n(8358),P=n(42482),s=n(5188),g=n(46799),u=n(3266),h=n(54438);let S=(()=>{var f;class m{constructor(c,a,l,p,A){this.labelsService=c,this.postProcessingService=a,this.engineRendererService=l,this.cameraService=p,this.store=A}localResize(c,a){const l=this.engineRendererService.getCanvas(),p=l.parentNode,A=p.clientWidth,O=p.clientHeight;return l.width=c,l.height=a,p.style.width=`${c}px`,p.style.height=`${a}px`,[A,O]}canvasToImage(c,a="original",l){var p=this;return(0,t.A)(function*(){const{width:A,height:O}=c,L=c.getContext("2d"),k=p.labelsService.getLabelContainer().nativeElement,q=c.width/c.height,B=p.engineRendererService.getCanvas();let{width:j,height:V}=B,M=.5*(B.width-j),N=0;switch(a){case"square":V>j?V=j:j=V,M=.5*(B.width-j),N=.5*(B.height-V);break;case"original":j=q*V}return p.engineRendererService.forceRenderFrame(),L.drawImage(B,M,N,j,V,0,0,A,O),l&&k?new Promise(requestAnimationFrame).then((0,t.A)(function*(){const W=yield P.X.elementToCanvas(k,!0);return L.drawImage(W,M,N,j,V,0,0,A,O),c})):c})()}canvasToImageWithResize(c,a){var l=this;return(0,t.A)(function*(){const{width:p,height:A}=c,O=l.engineRendererService.getCanvas(),L=c.getContext("2d"),k=l.labelsService.getLabelContainer().nativeElement,[q,B]=l.localResize(p,A);return l.engineRendererService.forceRenderFrame(),L.drawImage(O,0,0,p,A),a&&k?new Promise(requestAnimationFrame).then((0,t.A)(function*(){const j=yield P.X.elementToCanvas(k,!0);return L.drawImage(j,0,0,p,A),l.localResize(q,B),c})):(l.localResize(q,B),c)})()}drawRadialGradient(c,a){const l=a.colors,[A,O]=a.colorStops.map(j=>((j,V,M)=>{const[N,W]=[Math.pow(V/2,2),Math.pow(M/2,2)];return j/100*Math.pow(N+W,.5)})(j,c.width,c.height)),L=c.getContext("2d"),[k,q]=[c.width/2,c.height/2],B=L.createRadialGradient(k,q,A,k,q,O);B.addColorStop(a.colorStops[0]/100,`rgba(${l.slice(0,4).join(",")})`),B.addColorStop(a.colorStops[1]/100,`rgba(${l.slice(4,8).join(",")})`),L.fillStyle=B,L.fillRect(0,0,c.width,c.height)}drawLinearGradient(c,a){const l=a.colors,p=c.getContext("2d"),[A,O]=[c.width/2,c.height/2],L=p.createLinearGradient(A,O,A,c.height);L.addColorStop(a.colorStops[0]/100,`rgba(${l.slice(0,4).join(",")})`),L.addColorStop(a.colorStops[1]/100,`rgba(${l.slice(4,8).join(",")})`),p.fillStyle=L,p.fillRect(0,0,c.width,c.height)}takeSnapshot(c,a,l,p,A,O,L=1){const{imageType:k,imageQuality:q,copyrightEnabled:B,crop:j}=O,V=document.createElement("canvas");V.width=c,V.height=a,"radial"===l.gradientType?this.drawRadialGradient(V,l):"linear"===l.gradientType&&this.drawLinearGradient(V,l);const M=this.engineRendererService.getCanvas(),W=[],$=1!==L||V.height>M.height||V.width>M.width?this.canvasToImageWithResize(V,A):this.canvasToImage(V,j,A),ne=(0,e.H)($);W.push(ne);const Q=[...p];return W.push(...Q.map(le=>(le instanceof HTMLCanvasElement?(0,r.of)(le):(0,e.H)(P.X.elementToCanvas(le,!0))).pipe((0,y.T)(ie=>P.X.fitCanvas(ie,c,a))))),this.engineRendererService.forceRenderFrame(),(0,o.x)(W).pipe((0,d.p)(),(0,y.T)(le=>P.X.combineCanvasElements(le)),(0,_.Z)(le=>B?this.writeLogoToCanvas(le,O):(0,r.of)(le)),(0,_.Z)(le=>P.X.canvasToBlob(le,k,q)))}writeLogoToCanvas(c,a){return this.getLogoImage(a.copyrightImagePath).pipe((0,y.T)(l=>{let{width:p,height:A}=l;const{width:O,height:L}=c;if(.1*O>p){const j=A/p;p=.1*O,A=j*p}const{xOffset:k,yOffset:q}=this.getLogoPosition(O,L,p,A,a);return c.getContext("2d").drawImage(l,k,q,p,A),c}),(0,v.W)(()=>(0,r.of)(c)))}getLogoImage(c){return new C.c(a=>{const l=new Image;l.onload=()=>{a.next(l),a.complete()},l.onerror=()=>a.error(),l.src=c})}getLogoPosition(c,a,l,p,A){const{copyrightPosition:O,copyrightOffset:L}=A;let k,q;switch(O.x){case"right":k=c-l;break;case"center":k=c/2-l/2;break;default:k=0}switch(O.y){case"bottom":q=a-p;break;case"center":q=a/2-p/2;break;default:q=0}return{xOffset:k+L.x,yOffset:q+L.y}}}return(f=m).\u0275fac=function(c){return new(c||f)(h.KVO(b.x),h.KVO(s.j),h.KVO(g.z),h.KVO(u.j),h.KVO(E.il))},f.\u0275prov=h.jDH({token:f,factory:f.\u0275fac,providedIn:"root"}),m})()},7431:(ge,F,n)=>{"use strict";n.d(F,{F5:()=>_,Ih:()=>r,Nz:()=>o,P4:()=>E,Qn:()=>C,RG:()=>v,RJ:()=>u,Xz:()=>S,Yi:()=>b,Yp:()=>m,bB:()=>P,bJ:()=>t,d_:()=>e,j4:()=>s,nW:()=>y,pU:()=>f,pg:()=>d,qG:()=>g,sQ:()=>i,vq:()=>h});let t=(()=>{class a{constructor(p){this.id=p}}return a.type="[Engine Camera] Clear Camera",a})(),e=(()=>{class a{constructor(p,A){this.id=p,this.camera=A}}return a.type="[Engine Camera] Store Camera",a})(),r=(()=>{class a{constructor(p,A=!0,O,L){this.camera=p,this.animate=A,this.animationDuration=O,this.rotationCenter=L}}return a.type="[Engine Camera] Set Camera",a})(),o=(()=>{class a{constructor(){}}return a.type="[Engine Camera] Set Camera Success",a})(),C=(()=>{class a{constructor(p){this.enabled=p}}return a.type="[Engine Camera] Set Chapter Camera Enabled",a})(),E=(()=>{class a{constructor(p){this.cameraMotion=p}}return a.type="[Engine Camera] Move Camera",a})(),y=(()=>{class a{constructor(){}}return a.type="[Engine Camera] Reset Camera",a})(),d=(()=>{class a{constructor(p){this.value=p}}return a.type="[Engine Camera] Zoom Camera",a})(),_=(()=>{class a{constructor(p){this.value=p}}return a.type="[Engine Camera] Zoom Camera Static",a})(),v=(()=>{class a{constructor(p){this.value=p}}return a.type="[Engine Camera] Pan Camera X",a})(),b=(()=>{class a{constructor(p){this.value=p}}return a.type="[Engine Camera] Pan Camera Y",a})(),P=(()=>{class a{constructor(p,A,O){this.x=p,this.y=A,this.z=O}}return a.type="[Engine Camera] Pan Camera Static",a})(),s=(()=>{class a{constructor(p){this.value=p}}return a.type="[Engine Camera] Rotate Camera X",a})(),g=(()=>{class a{constructor(p){this.value=p}}return a.type="[Engine Camera] Rotate Camera Y",a})(),u=(()=>{class a{constructor(p,A){this.x=p,this.y=A}}return a.type="[Engine Camera] Rotate Camera Static",a})(),h=(()=>{class a{constructor(p){this.mode=p}}return a.type="[Engine Camera] Set Camera Mode",a})(),S=(()=>{class a{constructor(p){this.zoomed=p}}return a.type="[Engine Camera] Set Zoomed",a})(),f=(()=>{class a{constructor(p){this.lock=p}}return a.type="[Engine Camera] Lock camera",a})(),m=(()=>{class a{constructor(p){this.camera=p}}return a.type="[Engine Camera] Set Camera Fly To",a})(),i=(()=>{class a{constructor(p){this.patches=p}}return a.type="[Engine Camera] Patch Camera State",a})()},3829:(ge,F,n)=>{"use strict";n.d(F,{x:()=>f});var t=n(28407),e=n(65763);class r{}var s,h,o=n(7431),C=n(3266),E=n(57021),y=n(94495),d=n(81025),_=n(18617),v=n(79805),b=n(49204),P=n(54438),g=function(m,i,c,a){var A,l=arguments.length,p=l<3?i:null===a?a=Object.getOwnPropertyDescriptor(i,c):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)p=Reflect.decorate(m,i,c,a);else for(var O=m.length-1;O>=0;O--)(A=m[O])&&(p=(l<3?A(p):l>3?A(i,c,p):A(i,c))||p);return l>3&&p&&Object.defineProperty(i,c,p),p},u=function(m,i){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(m,i)};const S={storedCameras:{},cameraMotion:new E.x,panMode:"rotate",zoomed:!1,lockCamera:!1,cameraFlyTo:void 0,chapterCameraEnabled:!0};let f=(h=s=class{static getStoredCamera(i){return(0,e.Mz)([h],c=>c.storedCameras[i]||null)}static getCameraMotion(i){return i.cameraMotion}static getPanMode(i){return i.panMode}static getZoomed(i){return i.zoomed}static getLockCamera(i){return i.lockCamera}static getChapterCameraEnabled(i){return i.chapterCameraEnabled}storeCamera(i,c){const a=c.camera||this.cameraService.getCamera(),l=i.getState().storedCameras;l[c.id]={...a},i.patchState({storedCameras:{...l}})}clearCamera(i,c){const a=i.getState().storedCameras;delete a[c.id],i.patchState({storedCameras:{...a}})}setCameraFlyTo(i,c){i.patchState(d.jM(i.getState(),a=>{a.cameraFlyTo=c.camera}))}applyCameraPatch(i,c){const a=d.$i(i.getState(),c.patches);i.patchState(a);const l=void 0===a.cameraFlyTo?this.store.selectSnapshot(y.N.getChapterCamera):a.cameraFlyTo;i.dispatch(new o.Ih(l,!0,1))}moveCamera(i,c){i.patchState({cameraMotion:{...c.cameraMotion}})}resetCamera(i,c){var a=this;return(0,t.A)(function*(){const l=a.store.selectSnapshot(y.N.getSelectedChapter);return((0,b.isNil)(a.engineService.engine?.story?.activeChapter)?Promise.resolve():a.cameraService.flyToCamera(l.camera.location)).then(()=>{i.patchState({cameraMotion:new E.x})})})()}zoomCamera(i,c){const{cameraMotion:a}=i.getState();a.zoom=c.value,i.patchState({cameraMotion:{...a}})}panCameraX(i,c){const{cameraMotion:a}=i.getState();a.panX=c.value,i.patchState({cameraMotion:{...a}})}panCameraY(i,c){const{cameraMotion:a}=i.getState();a.panY=c.value,i.patchState({cameraMotion:{...a}})}rotateCameraX(i,c){const{cameraMotion:a}=i.getState();i.patchState({cameraMotion:{...a,rotateX:c.value}})}rotateCameraY(i,c){const{cameraMotion:a}=i.getState();a.rotateY=c.value,i.patchState({cameraMotion:{...a}})}SetCameraMode(i,c){i.patchState({panMode:c.mode}),this.liveAnnouncer.announce(`Switched to ${c.mode} mode`)}setZoomed(i,c){i.patchState({zoomed:c.zoomed})}lockCamera(i,c){i.patchState({lockCamera:c.lock})}setChapterCameraEnabled(i,c){i.patchState({chapterCameraEnabled:c.enabled})}constructor(i,c,a,l){this.cameraService=i,this.liveAnnouncer=c,this.store=a,this.engineService=l}},s.\u0275fac=function(i){return new(i||s)(P.KVO(C.j),P.KVO(_.Ai),P.KVO(e.il),P.KVO(v.y))},s.\u0275prov=P.jDH({token:s,factory:s.\u0275fac}),s);g([(0,e.rc)(o.d_),u("design:type",Function),u("design:paramtypes",[Object,o.d_]),u("design:returntype",void 0)],f.prototype,"storeCamera",null),g([(0,e.rc)(o.bJ),u("design:type",Function),u("design:paramtypes",[Object,o.bJ]),u("design:returntype",void 0)],f.prototype,"clearCamera",null),g([(0,e.rc)(o.Yp),u("design:type",Function),u("design:paramtypes",[Object,o.Yp]),u("design:returntype",void 0)],f.prototype,"setCameraFlyTo",null),g([(0,e.rc)(o.sQ),u("design:type",Function),u("design:paramtypes",[Object,o.sQ]),u("design:returntype",void 0)],f.prototype,"applyCameraPatch",null),g([(0,e.rc)(o.P4),u("design:type",Function),u("design:paramtypes",[Object,o.P4]),u("design:returntype",void 0)],f.prototype,"moveCamera",null),g([(0,e.rc)(o.nW),u("design:type",Function),u("design:paramtypes",[Object,o.nW]),u("design:returntype",Promise)],f.prototype,"resetCamera",null),g([(0,e.rc)(o.pg),u("design:type",Function),u("design:paramtypes",[Object,o.pg]),u("design:returntype",void 0)],f.prototype,"zoomCamera",null),g([(0,e.rc)(o.RG),u("design:type",Function),u("design:paramtypes",[Object,o.RG]),u("design:returntype",void 0)],f.prototype,"panCameraX",null),g([(0,e.rc)(o.Yi),u("design:type",Function),u("design:paramtypes",[Object,o.Yi]),u("design:returntype",void 0)],f.prototype,"panCameraY",null),g([(0,e.rc)(o.j4),u("design:type",Function),u("design:paramtypes",[Object,o.j4]),u("design:returntype",void 0)],f.prototype,"rotateCameraX",null),g([(0,e.rc)(o.qG),u("design:type",Function),u("design:paramtypes",[Object,o.qG]),u("design:returntype",void 0)],f.prototype,"rotateCameraY",null),g([(0,e.rc)(o.vq),u("design:type",Function),u("design:paramtypes",[Object,o.vq]),u("design:returntype",void 0)],f.prototype,"SetCameraMode",null),g([(0,e.rc)(o.Xz),u("design:type",Function),u("design:paramtypes",[Object,o.Xz]),u("design:returntype",void 0)],f.prototype,"setZoomed",null),g([(0,e.rc)(o.pU),u("design:type",Function),u("design:paramtypes",[Object,o.pU]),u("design:returntype",void 0)],f.prototype,"lockCamera",null),g([(0,e.rc)(o.Qn),u("design:type",Function),u("design:paramtypes",[Object,o.Qn]),u("design:returntype",void 0)],f.prototype,"setChapterCameraEnabled",null),g([(0,e.MD)(),u("design:type",Function),u("design:paramtypes",[r]),u("design:returntype",void 0)],f,"getCameraMotion",null),g([(0,e.MD)(),u("design:type",Function),u("design:paramtypes",[r]),u("design:returntype",void 0)],f,"getPanMode",null),g([(0,e.MD)(),u("design:type",Function),u("design:paramtypes",[r]),u("design:returntype",void 0)],f,"getZoomed",null),g([(0,e.MD)(),u("design:type",Function),u("design:paramtypes",[r]),u("design:returntype",void 0)],f,"getLockCamera",null),g([(0,e.MD)(),u("design:type",Function),u("design:paramtypes",[r]),u("design:returntype",void 0)],f,"getChapterCameraEnabled",null),f=h=g([(0,e.Uw)({name:"engineCamera",defaults:S}),u("design:paramtypes",[C.j,_.Ai,e.il,v.y])],f)},20339:(ge,F,n)=>{"use strict";n.d(F,{Z:()=>t});let t=(()=>{class r{constructor(C){this.showUnavailableNodes=C}}return r.type="[Engine Config] Set Show Unavailable Nodes",r})()},43631:(ge,F,n)=>{"use strict";n.d(F,{_:()=>d});var t=n(65763);class e{}var C,r=n(20339),o=n(54438),E=function(_,v,b,P){var u,s=arguments.length,g=s<3?v:null===P?P=Object.getOwnPropertyDescriptor(v,b):P;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)g=Reflect.decorate(_,v,b,P);else for(var h=_.length-1;h>=0;h--)(u=_[h])&&(g=(s<3?u(g):s>3?u(v,b,g):u(v,b))||g);return s>3&&g&&Object.defineProperty(v,b,g),g},y=function(_,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(_,v)};let d=((C=class{static getPerChapterTreeEnabled(v){return v.perChapterTreeEnabled}static getShowUnavailableNodes(v){return v.showUnavailableNodes}setShowUnavailableNodes(v,{showUnavailableNodes:b}){v.patchState({showUnavailableNodes:b})}}).\u0275fac=function(v){return new(v||C)},C.\u0275prov=o.jDH({token:C,factory:C.\u0275fac}),C);E([(0,t.rc)(r.Z),y("design:type",Function),y("design:paramtypes",[Object,r.Z]),y("design:returntype",void 0)],d.prototype,"setShowUnavailableNodes",null),E([(0,t.MD)(),y("design:type",Function),y("design:paramtypes",[e]),y("design:returntype",void 0)],d,"getPerChapterTreeEnabled",null),E([(0,t.MD)(),y("design:type",Function),y("design:paramtypes",[e]),y("design:returntype",void 0)],d,"getShowUnavailableNodes",null),d=E([(0,t.Uw)({name:"engineConfig",defaults:{showUnavailableNodes:!1,perChapterTreeEnabled:!0}})],d)},47610:(ge,F,n)=>{"use strict";n.d(F,{$V:()=>a,$h:()=>$,A0:()=>i,A6:()=>q,AU:()=>r,B9:()=>ie,BM:()=>H,DZ:()=>T,E7:()=>Z,GT:()=>c,Gv:()=>L,In:()=>_,JK:()=>E,K6:()=>M,LL:()=>b,P6:()=>A,PF:()=>Q,Pk:()=>J,RR:()=>U,RV:()=>K,RZ:()=>ne,Rc:()=>l,Sh:()=>le,Tf:()=>t,Ti:()=>O,Vs:()=>V,W6:()=>m,YI:()=>de,_h:()=>w,_o:()=>te,_y:()=>g,bo:()=>ae,dB:()=>y,dE:()=>B,fZ:()=>f,hk:()=>C,iQ:()=>e,jM:()=>j,kE:()=>N,lQ:()=>pe,pL:()=>k,q:()=>P,qL:()=>ce,ro:()=>re,t5:()=>o,u3:()=>u,uM:()=>be,v$:()=>D,vA:()=>z,w8:()=>s,z:()=>R,zE:()=>h,zW:()=>d,zw:()=>W});let t=(()=>{class X{constructor(){}}return X.type="[Engine] Load",X})(),e=(()=>{class X{constructor(oe){this.result=oe}}return X.type="[Engine] Load Success",X})(),r=(()=>{class X{constructor(oe){this.ready=oe}}return X.type="[Engine] Set Ready",X})(),o=(()=>{class X{constructor(oe){this.display=oe}}return X.type="[Engine] Set Display of 3D Scene",X})(),C=(()=>{class X{constructor(oe){this.scrollMode=oe}}return X.type="[Engine] Set Zoom via scroll Allowed",X})(),E=(()=>{class X{constructor(oe){this.shown=oe}}return X.type="[Engine] Set Scroll Alert Shwon",X})(),y=(()=>{class X{constructor(oe){this.visible=oe}}return X.type="[Engine] Set Visibility of 3D Scene",X})(),d=(()=>{class X{constructor(oe,me){this.color=oe,this.duration=me}}return X.type="[Engine] Fade",X})(),_=(()=>{class X{constructor(){}}return X.type="[Engine] Fade Complete",X})(),b=(()=>{class X{constructor(oe){this.graph=oe}}return X.type="[Engine] Set Graph",X})(),P=(()=>{class X{constructor(){}}return X.type="[Engine] Get Graph Metadata",X})(),s=(()=>{class X{constructor(){}}return X.type="[Engine] Clear Graph",X})(),g=(()=>{class X{constructor(oe){this.enabled=oe}}return X.type="[Engine] Set Xray Mode",X})(),u=(()=>{class X{constructor(oe){this.chapterId=oe}}return X.type="[Engine] Set Engine Chapter",X})(),h=(()=>{class X{constructor(oe,me,Se){this.node=oe,this.event=me,this.hit=Se}}return X.type="[Engine] Click Node",X})(),f=(()=>{class X{constructor(oe,me){this.node=oe,this.hit=me}}return X.type="[Engine] Set Contextmenu",X})(),m=(()=>{class X{constructor(oe,me=!0,Se){this.objectId=oe,this.animate=me,this.animationDuration=Se}}return X.type="[Engine] Fly To Object",X})(),i=(()=>{class X{constructor(oe,me){this.leafVisibilityState=oe,this.nodes=me}}return X.type="[Engine] Synchronize Visible Nodes On Tree",X})(),c=(()=>{class X{constructor(oe){this.leafRenderableState=oe}}return X.type="[Engine] Synchronize Renderable State of Nodes On Tree",X})(),a=(()=>{class X{constructor(oe,me){this.leafPickableState=oe,this.nodes=me}}return X.type="[Engine] Synchronize Pickable State of Nodes On Tree",X})(),l=(()=>{class X{constructor(oe,me){this.leafAvailableState=oe,this.nodes=me}}return X.type="[Engine] Synchronize Available State of Nodes On Tree",X})(),A=(()=>{class X{constructor(oe){this.show=oe}}return X.type="[Engine] Toggle Camera Bar",X})(),O=(()=>{class X{constructor(oe){this.show=oe}}return X.type="[Engine] Toggle Progress Bar",X})(),L=(()=>{class X{constructor(oe){this.show=oe}}return X.type="[Engine] Toggle Labels",X})(),k=(()=>{class X{constructor(oe){this.tool=oe}}return X.type="[Engine] Set active tool",X})(),q=(()=>{class X{constructor(){}}return X.type="[Engine] Play chapter animation",X})(),B=(()=>{class X{constructor(oe=!0){this.play=oe}}return X.type="[Engine] Play animation",X})(),j=(()=>{class X{constructor(oe){this.playing=oe}}return X.type="[Engine] Set animation playing",X})(),V=(()=>{class X{constructor(oe){this.speed=oe}}return X.type="[Engine] Set playback speed",X})(),M=(()=>{class X{constructor(){}}return X.type="[Engine] Play chapter from start",X})(),N=(()=>{class X{constructor(oe){this.enable=oe}}return X.type="[Engine] Set autoplay",X})(),W=(()=>{class X{constructor(oe,me){this.nodes=oe,this.layer=me}}return X.type="[Engine] Set object layer order",X})(),$=(()=>{class X{constructor(oe,me){this.nodeId=oe,this.displayName=me}}return X.type="[Engine] Set object display name",X})(),ne=(()=>{class X{constructor(){}}return X.type="[Engine] Auto Sort object layer orders",X})(),Q=(()=>{class X{constructor(){}}return X.type="[Engine] Reset object layer orders",X})(),le=(()=>{class X{constructor(oe){this.position=oe}}return X.type="[Engine] Set Engine Position",X})(),pe=(()=>{class X{constructor(){}}return X.type="[Engine] Reset Engine Position",X})(),ie=(()=>{class X{constructor(){}}return X.type="[Engine] Reset Interactions",X})(),be=(()=>{class X{constructor(oe){this.effects=oe}}return X.type="[Engine] Set Post Processing Effects",X})(),de=(()=>{class X{constructor(oe){this.properties=oe}}return X.type="[Engine] Set Properties",X})(),w=(()=>{class X{constructor(oe){this.mode=oe}}return X.type="[Engine] Set Transparency Mode",X})(),te=(()=>{class X{constructor(oe){this.node=oe}}return X.type="[Engine] Expand ViewTree Node",X})(),R=(()=>{class X{constructor(oe){this.node=oe}}return X.type="[Engine] Collapse ViewTree Node",X})(),D=(()=>{class X{constructor(){}}return X.type="[Engine] Collapse All ViewTree Nodes",X})(),T=(()=>{class X{constructor(oe,me){this.node=oe,this.hit=me}}return X.type="[Engine] Hover Node",X})(),re=(()=>{class X{constructor(oe){this.node=oe}}return X.type="[Engine] Set Label Edit Node",X})(),K=(()=>{class X{constructor(oe,me){this.node=oe,this.info=me}}return X.type="[Engine] Set Node Info",X})(),ae=(()=>{class X{constructor(oe,me,Se){this.node=oe,this.fallback=me,this.lang=Se}}return X.type="[Engine] Query Node Info",X})(),ce=(()=>{class X{constructor(oe,me){this.node=oe,this.info=me}}return X.type="[Engine] Query Node Info Success",X})(),U=(()=>{class X{constructor(oe){this.node=oe}}return X.type="[Engine Nodes] Query Node Info Failure",X})(),Z=(()=>{class X{constructor(oe){this.enabled=oe}}return X.type="[Engine] Set Watermark Enabled",X})(),z=(()=>{class X{constructor(oe){this.context=oe}}return X.type="[Engine] Set Engine WebGL Context",X})(),H=(()=>{class X{constructor(oe,me){this.enabled=oe,this.showAdvancedTools=me}}return X.type="[Engine] Set Engine Stats Enabled",X})(),J=(()=>{class X{constructor(oe){this.pickState=oe}}return X.type="[Engine] Set Pick State",X})()},55494:(ge,F,n)=>{"use strict";n.d(F,{S:()=>w});var t=n(65763);class e{}var r=n(47610),o=n(78109),C=n(79805),E=n(23881),y=n(24911),d=n(4664),_=n(3829),v=n(47555),b=n(13878),P=n(14264),s=n(17365),g=n(15152),u=n(79435),h=n(44867),S=n(12347),f=n(5188),m=n(46799),i=n(35650),c=n(73987),a=n(56343),l=n(43631),p=n(28407);const A={};var O=function(te){return te.Binary="application/octet-stream",te.JSON="application/json;charset=UTF-8",te}(O||{});const L="assetCache";class k{addToCache(R,D){return(0,p.A)(function*(){const T=D instanceof ArrayBuffer?D:JSON.stringify(D),re=T instanceof ArrayBuffer?O.Binary:O.JSON,K=T instanceof ArrayBuffer?T.byteLength:T.length,ae=new Response(T,{headers:{...A,"Content-Type":re,"Content-Length":`${K}`}});return(yield caches.open(L)).put(R,ae)})()}removeFromCache(R){return(0,p.A)(function*(){return(yield caches.open(L)).delete(R)})()}getFromCache(R){return(0,p.A)(function*(){const T=yield(yield caches.open(L)).match(R),re=T?.headers?.get("Content-Type");if(re)return"application/octet-stream"===re?T.arrayBuffer():T.json()})()}closeCache(){return(0,p.A)(function*(){})()}}var q=n(29160);const B="/assets/latin/l2bi.json";function j(te){return{titlesToLatin:N(te)}}function M(){return(M=(0,p.A)(function*(){return yield(yield fetch(B)).json()})).apply(this,arguments)}function N(te){return Object.entries(te).reduce((R,[D,T])=>(T.forEach(re=>{R[re]=D}),R),{})}var W=n(49204),$=n(54438);let ne=(()=>{var te;class R{constructor(){this.graphMetadata=new q.t(void 0)}getGraphMetadata(){return(0,W.isNil)(this.graphMetadata.value)&&this.fetchGraphMetadata().then(T=>{this.graphMetadata.next(T)}),this.graphMetadata.asObservable()}destroy(){this.cacheDatabase?.closeCache(),this.cacheDatabase=null}fetchGraphMetadata(){var T=this;return(0,p.A)(function*(){T.destroy(),T.cacheDatabase=new k;const re=yield T.cacheDatabase.getFromCache(B);if(re){const K=j(re);return T.graphMetadata.next(K),K}{const K=yield function V(){return M.apply(this,arguments)}();T.cacheDatabase.addToCache(B,K);const ae=j(K);return T.graphMetadata.next(ae),ae}})()}}return(te=R).\u0275fac=function(T){return new(T||te)},te.\u0275prov=$.jDH({token:te,factory:te.\u0275fac,providedIn:"root"}),R})();var le,be,Q=n(90917),pe=function(te,R,D,T){var ae,re=arguments.length,K=re<3?R:null===T?T=Object.getOwnPropertyDescriptor(R,D):T;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)K=Reflect.decorate(te,R,D,T);else for(var ce=te.length-1;ce>=0;ce--)(ae=te[ce])&&(K=(re<3?ae(K):re>3?ae(R,D,K):ae(R,D))||K);return re>3&&K&&Object.defineProperty(R,D,K),K},ie=function(te,R){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(te,R)};const de=new y.j(0,0,0,0,0,0,d.g.Hidden,1);let w=(be=le=class{static getEngine(R){return R.engine}static getReady(R){return R.ready}static getDisplay(R){return R.display}static getScrollMode(R){return R.scrollMode}static getVisible(R){return R.visible}static getViewGraph(R){return R.viewGraph}static getViewGraphMetadata(R){return R.viewGraphMetadata}static getTreeGraph(R,D){return D?R:(0,h.vU)(R)}static getViewGraphNode(R){return D=>R.viewGraph.nodes[D]}static getEnginePosition(R){return R.enginePosition}static getCanvasHeightBreakpoint(R){return R?.height<375?c.h.Tiny:R?.height<480?c.h.Small:c.h.Standard}static getChapter(R){return R.chapter}static getActiveTool(R){return R.activeTool}static getShowCameraBar(R){return R.showCameraBar}static getShowProgressBar(R){return R.showProgressBar}static getShowLabels(R){return R.showLabels}static getAnimationPlaying(R){return R.animationPlaying}static getAutoplay(R){return R.autoplay}static getXrayModeEnabled(R){return R.xrayModeEnabled}static getHoveredNode(R){return R.hoveredNode}static getLabelEditNode(R){return R.labelEditNode}static getQuerying(R){return R.queryingAnatomy}static getContextMenu(R){return R.contextMenu}static getPlaybackSpeed(R){return R.playbackSpeed}static getWatermarkEnabled(R){return R.watermarkEnabled}static getWebGLContextName(R){return R.webGLContextName}static getStatsEnabled(R){return R.stats.enabled}static getShowAdvancedStatsTools(R){return R.stats.showAdvancedTools}static getClickPickEnabled(R){return R.pickState.clickEnabled}static getHoverPickEnabled(R){return R.pickState.hoverEnabled}static getViewGraphRank(R){return R.viewGraphRank}load(R,D){R.dispatch(new r.iQ("engine"))}loadSuccess({patchState:R},D){R({engine:D.result})}setReady(R,D){R.patchState({ready:D.ready})}setDisplay(R,D){R.patchState({display:D.display})}setZoomViaScrollAllowed(R,D){R.patchState({scrollMode:D.scrollMode})}setVisible(R,D){R.patchState({visible:D.visible})}setEnginePosition(R,D){R.patchState({enginePosition:{...D.position,right:D.position.left+D.position.width,bottom:D.position.top+D.position.height}})}resetEnginePosition(R,D){R.patchState({enginePosition:de})}setChapter(R,D){R.patchState({chapter:D.chapterId})}setActiveTool(R,D){R.patchState({activeTool:D.tool})}setGraph(R,{graph:D}){const T=(0,Q.D$)(Object.values(D.nodes),[{field:"shown",dir:"asc"},{field:"label",dir:"asc"}]).reduce((re,K,ae)=>(re[K.id]=ae,re),{});R.patchState({viewGraph:{...D},viewGraphRank:{initiallyShownRank:T}})}getGraphMetadata(R){const{viewGraphMetadata:D}=R.getState();(0,W.isEmpty)(D)&&this.nodeSearchService.getGraphMetadata().pipe((0,P.p)(T=>!(0,W.isEmpty)(T)),(0,s.s)(1)).subscribe(T=>{const{viewGraph:re}=R.getState();R.patchState({viewGraphMetadata:T,viewGraph:{...(0,h.u7)(re,T)}})})}clearGraph(R){R.patchState({viewGraph:(0,E.q3)(),viewGraphRank:{initiallyShownRank:{}}})}setXrayMode(R,D){R.patchState({xrayModeEnabled:D.enabled})}toggleProgressBar(R,D){R.patchState({showProgressBar:D.show})}toggleCameraBar(R,D){R.patchState({showCameraBar:D.show})}toggleLabels(R,D){const T=null!=D.show?D.show:!R.getState().showLabels;R.patchState({showLabels:T})}synchronizeVisibleNodes(R,D){const T=R.getState().viewGraph,re=this.stateMapToNodeIds(T,D.leafVisibilityState),K={};re.forEach(ae=>{const U=this.sceneService.getLeafIds(ae).reduce((Z,z)=>Z||D.nodes[z].shown,!1);K[ae]={shown:U}}),this.graphService.synchronize({...T},{shown:a.t.TrueWins},K),R.patchState({viewGraph:{...T}})}synchronizeRenderableNodes(R,D){const T=R.getState().viewGraph,re=this.stateMapToNodeIds(T,D.leafRenderableState),K={};re.forEach(ae=>{K[ae]={renderable:!0}}),this.graphService.synchronize(T,{renderable:a.t.FalseWins},K)}synchronizePickableNodes(R,D){const T=R.getState().viewGraph,re=this.stateMapToNodeIds(T,D.leafPickableState),K={};re.forEach(ae=>{const U=this.sceneService.getLeafIds(ae).reduce((Z,z)=>Z||this.sceneService.getObjectById(z).pickable,!1);K[ae]={pickable:U}}),this.graphService.synchronize(T,{pickable:a.t.TrueWins},K),R.patchState({viewGraph:{...T}})}synchronizeAvailableNodes(R,D){const T=R.getState().viewGraph,re=this.stateMapToNodeIds(T,D.leafAvailableState),K={};re.forEach(ae=>{const U=this.sceneService.getLeafIds(ae).reduce((Z,z)=>Z||D.nodes[z].available,!1);K[ae]={available:U}}),this.graphService.synchronize(T,{available:a.t.TrueWins},K),R.patchState({viewGraph:{...T}})}playChapterAnimation(R,D){this.animationService.restart(),R.getState().animationPlaying||this.animationService.pause()}toggleAnimation(R,D){D.play?this.animationService.unpause():this.animationService.pause()}setAnimationPlaying(R,D){R.patchState({animationPlaying:D.playing})}setPlaybackSpeed(R,D){R.patchState({playbackSpeed:D.speed})}setAutoplay(R,D){R.patchState({autoplay:D.enable})}setObjectLayerOrder(R,D){const T=R.getState().viewGraph,re=isNaN(D.layer)?0:D.layer,{anatomyObjects:K}=this.sceneService.getAnatomySceneGraph();let ae=[];D.nodes.forEach(ce=>{const U=this.graphService.getDescendants(T,ce.id,!0);ae=ae.concat(U)}),ae.forEach(ce=>{this.sceneService.setObjectLayer(K,ce,re),this.graphService.setState(T,ce,{layer:re})}),R.patchState({viewGraph:{...T}})}setObjectDisplayName(R,D){const{nodeId:T,displayName:re}=D,K=R.getState().viewGraph,ae=K.nodes[T],ce=this.sceneService.getObjectById(T);ce&&(ce.displayName=re),ae&&(ae.label=re,R.patchState({viewGraph:{...K}}))}autoSortObjectLayers(R,D){const T=R.getState().viewGraph;let K=0;const ae=this.sceneService.getEnabledLeafIds(),ce=this.sceneService.getObjectLayerValues(ae),{anatomyObjects:U}=this.sceneService.getAnatomySceneGraph();Object.keys(ce).map(Z=>parseInt(Z,10)).sort((Z,z)=>Z-z).forEach(Z=>{ce[Z].sort((z,H)=>H.value-z.value).forEach(z=>{const H=20*K;this.sceneService.setObjectLayer(U,z.nodeId,H),this.graphService.setState(T,z.nodeId,{layer:H}),K++})}),R.patchState({viewGraph:{...T}})}resetObjectLayers(R,D){const T=R.getState().viewGraph,re=this.sceneService.getEnabledLeafIds(),{anatomyObjects:K}=this.sceneService.getAnatomySceneGraph();re.forEach(ae=>{this.sceneService.setObjectLayer(K,ae,0),this.graphService.setState(T,ae,{layer:0})}),R.patchState({viewGraph:{...T}})}setPostProcessingEffects(R,{effects:D}){this.postProcessingService.setPostProcessingFeatures(D)}setProperties(R,{properties:D}){this.engineService.setProperties({...D})}setTransparencyMode(R,{mode:D}){this.engineRendererService.setTransparencyMode(D)}expandNode(R,D){const T=this.store.selectSnapshot(be.getViewGraph);(0,h.DS)(T,D.node.id,!0).forEach(K=>{T.nodes[K].boolState.expanded=!0}),R.patchState({viewGraph:{...T}})}collapseNode(R,D){const T=this.store.selectSnapshot(be.getViewGraph);T.nodes[D.node.id].boolState.expanded=!1,R.patchState({viewGraph:{...T}})}collapseAllViewTreeNodes(R,D){const T=this.store.selectSnapshot(be.getViewGraph);Object.values(T.nodes).forEach(re=>{re.boolState.expanded=!1}),R.patchState({viewGraph:{...T}})}hoverNode(R,D){R.patchState({hoveredNode:D.node})}setLabelEditNode(R,D){R.patchState({labelEditNode:D.node})}queryNodeInfo(R,{node:D,fallback:T,lang:re}){R.patchState({queryingAnatomy:!0}),this.contentInfoService.queryNodeInfo(D.label,T,re).pipe((0,g.j)(()=>R.patchState({queryingAnatomy:!1}))).subscribe(K=>R.dispatch(new r.qL(D,K)),()=>R.dispatch(new r.RR(D)))}queryNodeInfoSuccess(R,{node:D,info:T}){R.dispatch(new r.RV(D,T))}setNodeInfo(R,{node:D,info:T}){const re=this.store.selectSnapshot(be.getViewGraph),K=re.nodes[D.id];K&&T&&(K.description=T.description,K.info=T,R.patchState({viewGraph:{...re}}))}setContextMenu(R,{node:D,hit:T}){R.patchState({contextMenu:{node:D,hit:T}})}setWatermarkEnabled(R,{enabled:D}){R.patchState({watermarkEnabled:D})}setWebGLContext(R,D){R.patchState({webGLContextName:D.context})}setEngineStatsEnabled(R,{enabled:D,showAdvancedTools:T}){R.patchState({stats:{enabled:D,showAdvancedTools:T}})}setHoverPick(R,D){R.patchState({pickState:{...R.getState().pickState,...D.pickState}})}stateMapToNodeIds(R,D){const T=Object.keys(D).map(re=>this.sceneService.getViewNode(R,re)).filter(re=>!!re).map(re=>re.id);return new Set(T)}constructor(R,D,T,re,K,ae,ce,U,Z){this.store=R,this.graphService=D,this.engineService=T,this.contentInfoService=re,this.animationService=K,this.postProcessingService=ae,this.engineRendererService=ce,this.sceneService=U,this.nodeSearchService=Z}},le.\u0275fac=function(R){return new(R||le)($.KVO(t.il),$.KVO(o.w),$.KVO(C.y),$.KVO(u.T),$.KVO(S.O),$.KVO(f.j),$.KVO(m.z),$.KVO(i.w),$.KVO(ne))},le.\u0275prov=$.jDH({token:le,factory:le.\u0275fac}),le);pe([(0,t.rc)(r.Tf),ie("design:type",Function),ie("design:paramtypes",[Object,r.Tf]),ie("design:returntype",void 0)],w.prototype,"load",null),pe([(0,t.rc)(r.iQ),ie("design:type",Function),ie("design:paramtypes",[Object,r.iQ]),ie("design:returntype",void 0)],w.prototype,"loadSuccess",null),pe([(0,t.rc)(r.AU),ie("design:type",Function),ie("design:paramtypes",[Object,r.AU]),ie("design:returntype",void 0)],w.prototype,"setReady",null),pe([(0,t.rc)(r.t5),ie("design:type",Function),ie("design:paramtypes",[Object,r.t5]),ie("design:returntype",void 0)],w.prototype,"setDisplay",null),pe([(0,t.rc)(r.hk),ie("design:type",Function),ie("design:paramtypes",[Object,r.hk]),ie("design:returntype",void 0)],w.prototype,"setZoomViaScrollAllowed",null),pe([(0,t.rc)(r.dB),ie("design:type",Function),ie("design:paramtypes",[Object,r.dB]),ie("design:returntype",void 0)],w.prototype,"setVisible",null),pe([(0,t.rc)(r.Sh),ie("design:type",Function),ie("design:paramtypes",[Object,r.Sh]),ie("design:returntype",void 0)],w.prototype,"setEnginePosition",null),pe([(0,t.rc)(r.lQ),ie("design:type",Function),ie("design:paramtypes",[Object,r.lQ]),ie("design:returntype",void 0)],w.prototype,"resetEnginePosition",null),pe([(0,t.rc)(r.u3),ie("design:type",Function),ie("design:paramtypes",[Object,r.u3]),ie("design:returntype",void 0)],w.prototype,"setChapter",null),pe([(0,t.rc)(r.pL),ie("design:type",Function),ie("design:paramtypes",[Object,r.pL]),ie("design:returntype",void 0)],w.prototype,"setActiveTool",null),pe([(0,t.rc)(r.LL),ie("design:type",Function),ie("design:paramtypes",[Object,r.LL]),ie("design:returntype",void 0)],w.prototype,"setGraph",null),pe([(0,t.rc)(r.q),ie("design:type",Function),ie("design:paramtypes",[Object]),ie("design:returntype",void 0)],w.prototype,"getGraphMetadata",null),pe([(0,t.rc)(r.w8),ie("design:type",Function),ie("design:paramtypes",[Object]),ie("design:returntype",void 0)],w.prototype,"clearGraph",null),pe([(0,t.rc)(r._y),ie("design:type",Function),ie("design:paramtypes",[Object,r._y]),ie("design:returntype",void 0)],w.prototype,"setXrayMode",null),pe([(0,t.rc)(r.Ti),ie("design:type",Function),ie("design:paramtypes",[Object,r.Ti]),ie("design:returntype",void 0)],w.prototype,"toggleProgressBar",null),pe([(0,t.rc)(r.P6),ie("design:type",Function),ie("design:paramtypes",[Object,r.P6]),ie("design:returntype",void 0)],w.prototype,"toggleCameraBar",null),pe([(0,t.rc)(r.Gv),ie("design:type",Function),ie("design:paramtypes",[Object,r.Gv]),ie("design:returntype",void 0)],w.prototype,"toggleLabels",null),pe([(0,t.rc)(r.A0),ie("design:type",Function),ie("design:paramtypes",[Object,r.A0]),ie("design:returntype",void 0)],w.prototype,"synchronizeVisibleNodes",null),pe([(0,t.rc)(r.GT),ie("design:type",Function),ie("design:paramtypes",[Object,r.GT]),ie("design:returntype",void 0)],w.prototype,"synchronizeRenderableNodes",null),pe([(0,t.rc)(r.$V),ie("design:type",Function),ie("design:paramtypes",[Object,r.$V]),ie("design:returntype",void 0)],w.prototype,"synchronizePickableNodes",null),pe([(0,t.rc)(r.Rc),ie("design:type",Function),ie("design:paramtypes",[Object,r.Rc]),ie("design:returntype",void 0)],w.prototype,"synchronizeAvailableNodes",null),pe([(0,t.rc)(r.A6),ie("design:type",Function),ie("design:paramtypes",[Object,r.A6]),ie("design:returntype",void 0)],w.prototype,"playChapterAnimation",null),pe([(0,t.rc)(r.dE),ie("design:type",Function),ie("design:paramtypes",[Object,r.dE]),ie("design:returntype",void 0)],w.prototype,"toggleAnimation",null),pe([(0,t.rc)(r.jM),ie("design:type",Function),ie("design:paramtypes",[Object,r.jM]),ie("design:returntype",void 0)],w.prototype,"setAnimationPlaying",null),pe([(0,t.rc)(r.Vs),ie("design:type",Function),ie("design:paramtypes",[Object,r.Vs]),ie("design:returntype",void 0)],w.prototype,"setPlaybackSpeed",null),pe([(0,t.rc)(r.kE),ie("design:type",Function),ie("design:paramtypes",[Object,r.kE]),ie("design:returntype",void 0)],w.prototype,"setAutoplay",null),pe([(0,t.rc)(r.zw),ie("design:type",Function),ie("design:paramtypes",[Object,r.zw]),ie("design:returntype",void 0)],w.prototype,"setObjectLayerOrder",null),pe([(0,t.rc)(r.$h),ie("design:type",Function),ie("design:paramtypes",[Object,r.$h]),ie("design:returntype",void 0)],w.prototype,"setObjectDisplayName",null),pe([(0,t.rc)(r.RZ),ie("design:type",Function),ie("design:paramtypes",[Object,r.RZ]),ie("design:returntype",void 0)],w.prototype,"autoSortObjectLayers",null),pe([(0,t.rc)(r.PF),ie("design:type",Function),ie("design:paramtypes",[Object,r.PF]),ie("design:returntype",void 0)],w.prototype,"resetObjectLayers",null),pe([(0,t.rc)(r.uM),ie("design:type",Function),ie("design:paramtypes",[Object,r.uM]),ie("design:returntype",void 0)],w.prototype,"setPostProcessingEffects",null),pe([(0,t.rc)(r.YI),ie("design:type",Function),ie("design:paramtypes",[Object,r.YI]),ie("design:returntype",void 0)],w.prototype,"setProperties",null),pe([(0,t.rc)(r._h),ie("design:type",Function),ie("design:paramtypes",[Object,r._h]),ie("design:returntype",void 0)],w.prototype,"setTransparencyMode",null),pe([(0,t.rc)(r._o),ie("design:type",Function),ie("design:paramtypes",[Object,r._o]),ie("design:returntype",void 0)],w.prototype,"expandNode",null),pe([(0,t.rc)(r.z),ie("design:type",Function),ie("design:paramtypes",[Object,r.z]),ie("design:returntype",void 0)],w.prototype,"collapseNode",null),pe([(0,t.rc)(r.v$),ie("design:type",Function),ie("design:paramtypes",[Object,r.v$]),ie("design:returntype",void 0)],w.prototype,"collapseAllViewTreeNodes",null),pe([(0,t.rc)(r.DZ),ie("design:type",Function),ie("design:paramtypes",[Object,r.DZ]),ie("design:returntype",void 0)],w.prototype,"hoverNode",null),pe([(0,t.rc)(r.ro),ie("design:type",Function),ie("design:paramtypes",[Object,r.ro]),ie("design:returntype",void 0)],w.prototype,"setLabelEditNode",null),pe([(0,t.rc)(r.bo),ie("design:type",Function),ie("design:paramtypes",[Object,r.bo]),ie("design:returntype",void 0)],w.prototype,"queryNodeInfo",null),pe([(0,t.rc)(r.qL),ie("design:type",Function),ie("design:paramtypes",[Object,r.qL]),ie("design:returntype",void 0)],w.prototype,"queryNodeInfoSuccess",null),pe([(0,t.rc)(r.RV),ie("design:type",Function),ie("design:paramtypes",[Object,r.RV]),ie("design:returntype",void 0)],w.prototype,"setNodeInfo",null),pe([(0,t.rc)(r.fZ),ie("design:type",Function),ie("design:paramtypes",[Object,r.fZ]),ie("design:returntype",void 0)],w.prototype,"setContextMenu",null),pe([(0,t.rc)(r.E7),ie("design:type",Function),ie("design:paramtypes",[Object,r.E7]),ie("design:returntype",void 0)],w.prototype,"setWatermarkEnabled",null),pe([(0,t.rc)(r.vA),ie("design:type",Function),ie("design:paramtypes",[Object,r.vA]),ie("design:returntype",void 0)],w.prototype,"setWebGLContext",null),pe([(0,t.rc)(r.BM),ie("design:type",Function),ie("design:paramtypes",[Object,r.BM]),ie("design:returntype",void 0)],w.prototype,"setEngineStatsEnabled",null),pe([(0,t.rc)(r.Pk),ie("design:type",Function),ie("design:paramtypes",[Object,r.Pk]),ie("design:returntype",void 0)],w.prototype,"setHoverPick",null),pe([(0,t.MD)(),ie("design:type",Function),ie("design:paramtypes",[e]),ie("design:returntype",void 0)],w,"getEngine",null),pe([(0,t.MD)(),ie("design:type",Function),ie("design:paramtypes",[e]),ie("design:returntype",void 0)],w,"getReady",null),pe([(0,t.MD)(),ie("design:type",Function),ie("design:paramtypes",[e]),ie("design:returntype",void 0)],w,"getDisplay",null),pe([(0,t.MD)(),ie("design:type",Function),ie("design:paramtypes",[e]),ie("design:returntype",void 0)],w,"getScrollMode",null),pe([(0,t.MD)(),ie("design:type",Function),ie("design:paramtypes",[e]),ie("design:returntype",void 0)],w,"getVisible",null),pe([(0,t.MD)(),ie("design:type",Function),ie("design:paramtypes",[e]),ie("design:returntype",void 0)],w,"getViewGraph",null),pe([(0,t.MD)(),ie("design:type",Function),ie("design:paramtypes",[e]),ie("design:returntype",void 0)],w,"getViewGraphMetadata",null),pe([(0,t.Um)({injectContainerState:!1}),(0,t.MD)([w.getViewGraph,l._.getShowUnavailableNodes]),ie("design:type",Function),ie("design:paramtypes",[Object,Boolean]),ie("design:returntype",Object)],w,"getTreeGraph",null),pe([(0,t.MD)(),ie("design:type",Function),ie("design:paramtypes",[e]),ie("design:returntype",void 0)],w,"getViewGraphNode",null),pe([(0,t.MD)(),ie("design:type",Function),ie("design:paramtypes",[e]),ie("design:returntype",void 0)],w,"getEnginePosition",null),pe([(0,t.Um)({injectContainerState:!1}),(0,t.MD)([w.getEnginePosition]),ie("design:type",Function),ie("design:paramtypes",[y.j]),ie("design:returntype",Number)],w,"getCanvasHeightBreakpoint",null),pe([(0,t.MD)(),ie("design:type",Function),ie("design:paramtypes",[e]),ie("design:returntype",void 0)],w,"getChapter",null),pe([(0,t.MD)(),ie("design:type",Function),ie("design:paramtypes",[e]),ie("design:returntype",void 0)],w,"getActiveTool",null),pe([(0,t.MD)(),ie("design:type",Function),ie("design:paramtypes",[e]),ie("design:returntype",void 0)],w,"getShowCameraBar",null),pe([(0,t.MD)(),ie("design:type",Function),ie("design:paramtypes",[e]),ie("design:returntype",void 0)],w,"getShowProgressBar",null),pe([(0,t.MD)(),ie("design:type",Function),ie("design:paramtypes",[e]),ie("design:returntype",void 0)],w,"getShowLabels",null),pe([(0,t.MD)(),ie("design:type",Function),ie("design:paramtypes",[e]),ie("design:returntype",void 0)],w,"getAnimationPlaying",null),pe([(0,t.MD)(),ie("design:type",Function),ie("design:paramtypes",[e]),ie("design:returntype",void 0)],w,"getAutoplay",null),pe([(0,t.MD)(),ie("design:type",Function),ie("design:paramtypes",[e]),ie("design:returntype",void 0)],w,"getXrayModeEnabled",null),pe([(0,t.MD)(),ie("design:type",Function),ie("design:paramtypes",[e]),ie("design:returntype",void 0)],w,"getHoveredNode",null),pe([(0,t.MD)(),ie("design:type",Function),ie("design:paramtypes",[e]),ie("design:returntype",void 0)],w,"getLabelEditNode",null),pe([(0,t.MD)(),ie("design:type",Function),ie("design:paramtypes",[e]),ie("design:returntype",void 0)],w,"getQuerying",null),pe([(0,t.MD)(),ie("design:type",Function),ie("design:paramtypes",[e]),ie("design:returntype",void 0)],w,"getContextMenu",null),pe([(0,t.MD)(),ie("design:type",Function),ie("design:paramtypes",[e]),ie("design:returntype",void 0)],w,"getPlaybackSpeed",null),pe([(0,t.MD)(),ie("design:type",Function),ie("design:paramtypes",[e]),ie("design:returntype",void 0)],w,"getWatermarkEnabled",null),pe([(0,t.MD)(),ie("design:type",Function),ie("design:paramtypes",[e]),ie("design:returntype",void 0)],w,"getWebGLContextName",null),pe([(0,t.MD)(),ie("design:type",Function),ie("design:paramtypes",[e]),ie("design:returntype",void 0)],w,"getStatsEnabled",null),pe([(0,t.MD)(),ie("design:type",Function),ie("design:paramtypes",[e]),ie("design:returntype",void 0)],w,"getShowAdvancedStatsTools",null),pe([(0,t.MD)(),ie("design:type",Function),ie("design:paramtypes",[e]),ie("design:returntype",void 0)],w,"getClickPickEnabled",null),pe([(0,t.MD)(),ie("design:type",Function),ie("design:paramtypes",[e]),ie("design:returntype",void 0)],w,"getHoverPickEnabled",null),pe([(0,t.MD)(),ie("design:type",Function),ie("design:paramtypes",[e]),ie("design:returntype",void 0)],w,"getViewGraphRank",null),w=be=pe([(0,t.Uw)({name:"engine",defaults:{loading:!1,ready:!1,viewGraph:(0,E.q3)(),viewGraphMetadata:void 0,viewGraphRank:{initiallyShownRank:{}},hoveredNode:void 0,labelEditNode:void 0,queryingAnatomy:!1,engine:"",chapter:"",showProgressBar:!0,showCameraBar:!0,showLabels:!0,activeTool:v.s.Select,animationPlaying:!1,autoplay:!0,display:!0,visible:!0,scrollMode:b.M.Capture,playbackSpeed:1,xrayModeEnabled:!1,contextMenu:{node:null,hit:null},watermarkEnabled:!1,stats:{enabled:!1,showAdvancedTools:!1},webGLContextName:void 0,pickState:{clickEnabled:!0,hoverEnabled:!0},xrRequesting:!1},children:[_.x]}),ie("design:paramtypes",[t.il,o.w,C.y,u.T,S.O,f.j,m.z,i.w,ne])],w)},29284:(ge,F,n)=>{"use strict";n.d(F,{BK:()=>y,_x:()=>E,iE:()=>s});var t=n(20458),e=n(63365),r=n(44867),o=n(49204);function E(g,u,h){const S=(0,r.IA)(g,u);if(0===S.length)return!1;for(const f of S)if(!0===h[f])return!0;return S.some(f=>E(g,f,h))}function y(g,u,h){switch(h[u]){case!0:return!0;case!1:return!1;case void 0:{const S=(0,r.ir)(g,u);return!!S&&y(g,S,h)}}}function d(g,u,h){if((0,o.isNil)(h))return!0;switch(h[u]){case!0:return!1;case!1:return!0;case void 0:{const S=(0,r.ir)(g,u);return!S||d(g,S,h)}}}function P(g,u,h){if(h&&h[u]&&function b(g){return"tintColor"in g||"opacity"in g||"brightness"in g||"saturation"in g||"contrast"in g}(h[u]))return(0,e.H)(h[u]);const S=(0,r.ir)(g,u);return S?P(g,S,h):t.NR}function s(g,u,h,S,f){function m(c){const a=function v(g,u,h){return(0,r.If)(u,h,S=>(0,r.ir)(g,S),S=>(0,r.IA)(g,S))}(g,c,h),l=function _(g,u,h){return y(g,u,h)||E(g,u,h)}(g,c,u),p=d(g,c,S);return{objectId:c,checked:!1,selected:!1,paint:P(g,c,f),pickable:p,shown:l,shownSetByTween:!1,available:a,variant:0}}return Object.keys(g.nodes).reduce((c,a)=>(c[a]=m(a),c),{})}},61295:(ge,F,n)=>{"use strict";n.d(F,{IA:()=>o,Jp:()=>b,K8:()=>e,Ke:()=>v,LV:()=>E,NP:()=>r,Ws:()=>P,Yn:()=>t,ZF:()=>s,_n:()=>g,hg:()=>d,q9:()=>_,rg:()=>C,yr:()=>y});let t=(()=>{class h{constructor(){}}return h.type="[Engine Nodes] Reset",h})(),e=(()=>{class h{constructor(f){this.nodeState=f}}return h.type="[Engine Nodes] init nodes",h})(),r=(()=>{class h{constructor(f){this.patches=f}}return h.type="[Engine Nodes] patch nodes",h})(),o=(()=>{class h{constructor(f){this.activeChapterId=f}}return h.type="[Engine Nodes] set active chapter",h})(),C=(()=>{class h{constructor(f,m){this.originalChapterId=f,this.copyChapterId=m}}return h.type="[Engine Nodes] Duplicate node state",h})(),E=(()=>{class h{constructor(f,m){this.show=f,this.objectIds=m}}return h.type="[Engine Nodes] update tween nodes shown",h})(),y=(()=>{class h{constructor(f,m,i,c=!0,a=!1,l=!1){this.show=f,this.objectIds=m,this.patch=i,this.record=c,this.setByTween=a,this.includeUnavailable=l}}return h.type="[Engine Nodes] update nodes shown",h})(),d=(()=>{class h{constructor(f){this.objectId=f}}return h.type="[Engine Nodes] update nodes selected",h})(),_=(()=>{class h{constructor(f,m,i){this.checked=f,this.objectIds=m,this.patch=i}}return h.type="[Engine Nodes] update nodes checked",h})(),v=(()=>{class h{constructor(f,m,i){this.pickable=f,this.objectIds=m,this.patch=i}}return h.type="[Engine Nodes] update nodes pickable",h})(),b=(()=>{class h{constructor(f,m,i,c=!0){this.recipe=f,this.objectIds=m,this.patch=i,this.record=c}}return h.type="[Engine Nodes] update nodes paint",h})(),P=(()=>{class h{constructor(f,m,i){this.available=f,this.objectIds=m,this.patch=i}}return h.type="[Engine Nodes] update nodes available",h})(),s=(()=>{class h{constructor(f,m){this.objectIds=f,this.sourceChapterId=m}}return h.type="[Engine Nodes] copy nodes paint",h})(),g=(()=>{class h{constructor(f,m=!0){this.objectVariants=f,this.record=m}}return h.type="[Engine Nodes] update node variants",h})()},13409:(ge,F,n)=>{"use strict";n.d(F,{z:()=>S});var t=n(65763);class e{}var s,r=n(61295),o=n(75069),C=n(10467),E=n(12865),y=n(63365),d=n(81025),_=n(35650),v=n(43631),b=n(44867),P=n(54438),g=function(f,m,i,c){var p,a=arguments.length,l=a<3?m:null===c?c=Object.getOwnPropertyDescriptor(m,i):c;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(f,m,i,c);else for(var A=f.length-1;A>=0;A--)(p=f[A])&&(l=(a<3?p(l):a>3?p(m,i,l):p(m,i))||l);return a>3&&l&&Object.defineProperty(m,i,l),l},u=function(f,m){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(f,m)};let S=((s=class{static getAllNodeState(m){return m.nodeState}static getActiveChapter(m){return m.activeChapterId}static getPatches(m){return m.patches}static getNodes(m,i){return m?.[i]??{}}static getAvailableNodes(m,i){return i?m:(0,b.bd)(m)}static getNodePaint(m){return i=>m.nodeState[m.activeChapterId][i].paint}static getNodeIds(m){return Object.keys(m)}static getCheckedNodeIds(m){return m.map(i=>i.objectId)}static getCheckedNodesCount(m){return m.length}static getCheckedNodes(m){return Object.values(m).filter(i=>i.checked)}static getSelectedNode(m){return Object.values(m).find(i=>i.selected)}reset(m,i){m.patchState(d.jM(m.getState(),c=>{c.activeChapterId=void 0,c.nodeState=void 0,c.patches=[],c.patchesForChapter={}}))}applyPatch(m,i){const c=d.$i(m.getState(),i.patches),a=d.jM(c,l=>{l.patchesForChapter[l.activeChapterId].push(...i.patches),l.patches=i.patches});m.patchState(a)}initNodeState(m,i){m.patchState({nodeState:i.nodeState})}setActiveChapter(m,i){const c=m.getState(),a=d.jM(c,l=>{l.activeChapterId=i.activeChapterId,l.patchesForChapter[i.activeChapterId]=l.patchesForChapter[i.activeChapterId]||[],l.patches=l.patchesForChapter[i.activeChapterId]});m.patchState(a)}duplicateNodeState(m,i){const c=m.getState(),a=d.jM(c,l=>{l.nodeState[i.copyChapterId]=l.nodeState[i.originalChapterId],l.patchesForChapter[i.copyChapterId]=l.patchesForChapter[i.originalChapterId].map(A=>(A.path[1]=i.copyChapterId,A))});m.patchState(a)}updateTweenNodesShown(m,i){const c=m.getState(),{finalState:a}=(0,E.r)(c,{...i,record:!1,setByTween:!0,includeUnavailable:!0},this.sceneService),{nodeState:l}=a;m.patchState({nodeState:l})}updateNodesShown(m,i){const c=m.getState(),{finalState:a,patches:l,inversePatches:p}=(0,E.r)(c,i,this.sceneService);m.patchState(a),i.record&&m.dispatch(new o.a.SavePatches([{forward:l,inverse:p,patchAction:r.NP}]))}updateNodesSelected(m,i){const c=m.getState();if(!c)return;const a=d.jM(c,l=>{const p=l.nodeState?.[l.activeChapterId]??{},A=Object.keys(p);void 0===i.objectId?A.forEach(O=>p[O].selected=!1):(A.forEach(O=>p[O].selected=!1),p[i.objectId].selected=!0)});m.patchState(a)}updateNodesChecked(m,i){const c=m.getState(),[a,l,p]=d.vI(c,O=>{const L=O.nodeState?.[O.activeChapterId]??{};void 0===i.patch?(i.objectIds||Object.keys(L)).forEach(q=>{L[q].checked=i.checked,i.objectIds&&(0,C.I7)(this.sceneService,q,L,"checked",i.checked)}):Object.entries(i.patch).forEach(([k,q])=>L[k].checked=q)}),A=d.jM(a,O=>{O.patches=l});m.patchState(A)}updateNodesPickable(m,i){const c=m.getState(),[a,l,p]=d.vI(c,O=>{const L=O.nodeState?.[O.activeChapterId]??{};i.patch?Object.entries(i.patch).forEach(([k,q])=>L[k].pickable=q):(i.objectIds||Object.keys(L)).forEach(q=>{L[q].pickable=i.pickable,i.objectIds&&(0,C.I7)(this.sceneService,q,L,"pickable",i.pickable)})}),A=d.jM(a,O=>{O.patches=l,O.patchesForChapter[O.activeChapterId].push(...l)});m.patchState(A),m.dispatch(new o.a.SavePatches([{forward:l,inverse:p,patchAction:r.NP}]))}updateNodesPaint(m,i){const c=m.getState(),[a,l,p]=d.vI(c,O=>{const L=O.nodeState?.[O.activeChapterId]??{},k=i.objectIds||Object.keys(L);i.patch?Object.entries(i.patch).forEach(([q,B])=>{const j=(0,y.ql)(L[q].paint,B);L[q].paint=j}):k.forEach(q=>{const B=(0,y.ql)(L[q].paint,i.recipe);L[q].paint=B,i.objectIds&&(0,C.I7)(this.sceneService,q,L,"paint",B)})}),A=d.jM(a,O=>{O.patches=l,O.patchesForChapter[O.activeChapterId].push(...l)});m.patchState(A),i.record&&m.dispatch(new o.a.SavePatches([{forward:l,inverse:p,patchAction:r.NP}]))}updateNodesAvailable(m,i){const c=m.getState(),[a,l,p]=d.vI(c,O=>{const L=O.nodeState?.[O.activeChapterId]??{};if(i.patch)Object.entries(i.patch).forEach(([k,q])=>{L[k].available=q,L[k].pickable=q});else{const{available:k,objectIds:q}=i;(q??Object.keys(L)).forEach(j=>{L[j].available=k,L[j].pickable=k,q&&((0,C.I7)(this.sceneService,j,L,"available",k),(0,C.I7)(this.sceneService,j,L,"pickable",k))})}}),A=d.jM(a,O=>{O.patches=l,O.patchesForChapter[O.activeChapterId].push(...l)});m.patchState(A),m.dispatch(new o.a.SavePatches([{forward:l,inverse:p,patchAction:r.NP}]))}updateNodeVariants(m,{objectVariants:i,record:c}){const a=m.getState(),[l,p,A]=d.vI(a,L=>{const k=L.nodeState?.[L.activeChapterId]??{};Object.entries(i).forEach(([q,B])=>{k[q].variant=B})}),O=d.jM(l,L=>{L.patches=p,L.patchesForChapter[L.activeChapterId].push(...p)});m.patchState(O),c&&m.dispatch(new o.a.SavePatches([{forward:p,inverse:A,patchAction:r.NP}]))}copyNodesPaint(m,{sourceChapterId:i,objectIds:c}){const a=m.getState(),[l,p,A]=d.vI(a,L=>{(0,C.hW)(this.sceneService,L.nodeState?.[i]??{},L.nodeState?.[L.activeChapterId]??{},c,"paint")}),O=d.jM(l,L=>{L.patches=p,L.patchesForChapter[L.activeChapterId].push(...p)});m.patchState(O),m.dispatch(new o.a.SavePatches([{forward:p,inverse:A,patchAction:r.NP}]))}constructor(m){this.sceneService=m}}).\u0275fac=function(m){return new(m||s)(P.KVO(_.w))},s.\u0275prov=P.jDH({token:s,factory:s.\u0275fac}),s);g([(0,t.rc)(r.Yn),u("design:type",Function),u("design:paramtypes",[Object,r.Yn]),u("design:returntype",void 0)],S.prototype,"reset",null),g([(0,t.rc)(r.NP),u("design:type",Function),u("design:paramtypes",[Object,r.NP]),u("design:returntype",void 0)],S.prototype,"applyPatch",null),g([(0,t.rc)(r.K8),u("design:type",Function),u("design:paramtypes",[Object,r.K8]),u("design:returntype",void 0)],S.prototype,"initNodeState",null),g([(0,t.rc)(r.IA),u("design:type",Function),u("design:paramtypes",[Object,r.IA]),u("design:returntype",void 0)],S.prototype,"setActiveChapter",null),g([(0,t.rc)(r.rg),u("design:type",Function),u("design:paramtypes",[Object,r.rg]),u("design:returntype",void 0)],S.prototype,"duplicateNodeState",null),g([(0,t.rc)(r.LV),u("design:type",Function),u("design:paramtypes",[Object,r.LV]),u("design:returntype",void 0)],S.prototype,"updateTweenNodesShown",null),g([(0,t.rc)(r.yr),u("design:type",Function),u("design:paramtypes",[Object,r.yr]),u("design:returntype",void 0)],S.prototype,"updateNodesShown",null),g([(0,t.rc)(r.hg),u("design:type",Function),u("design:paramtypes",[Object,r.hg]),u("design:returntype",void 0)],S.prototype,"updateNodesSelected",null),g([(0,t.rc)(r.q9),u("design:type",Function),u("design:paramtypes",[Object,r.q9]),u("design:returntype",void 0)],S.prototype,"updateNodesChecked",null),g([(0,t.rc)(r.Ke),u("design:type",Function),u("design:paramtypes",[Object,r.Ke]),u("design:returntype",void 0)],S.prototype,"updateNodesPickable",null),g([(0,t.rc)(r.Jp),u("design:type",Function),u("design:paramtypes",[Object,r.Jp]),u("design:returntype",void 0)],S.prototype,"updateNodesPaint",null),g([(0,t.rc)(r.Ws),u("design:type",Function),u("design:paramtypes",[Object,r.Ws]),u("design:returntype",void 0)],S.prototype,"updateNodesAvailable",null),g([(0,t.rc)(r._n),u("design:type",Function),u("design:paramtypes",[Object,r._n]),u("design:returntype",void 0)],S.prototype,"updateNodeVariants",null),g([(0,t.rc)(r.ZF),u("design:type",Function),u("design:paramtypes",[Object,r.ZF]),u("design:returntype",void 0)],S.prototype,"copyNodesPaint",null),g([(0,t.MD)(),u("design:type",Function),u("design:paramtypes",[e]),u("design:returntype",void 0)],S,"getAllNodeState",null),g([(0,t.MD)(),u("design:type",Function),u("design:paramtypes",[e]),u("design:returntype",void 0)],S,"getActiveChapter",null),g([(0,t.MD)(),u("design:type",Function),u("design:paramtypes",[e]),u("design:returntype",void 0)],S,"getPatches",null),g([(0,t.Um)({injectContainerState:!1}),(0,t.MD)([S.getAllNodeState,S.getActiveChapter]),u("design:type",Function),u("design:paramtypes",[Object,String]),u("design:returntype",void 0)],S,"getNodes",null),g([(0,t.Um)({injectContainerState:!1}),(0,t.MD)([S.getNodes,v._.getShowUnavailableNodes]),u("design:type",Function),u("design:paramtypes",[Object,Boolean]),u("design:returntype",Object)],S,"getAvailableNodes",null),g([(0,t.MD)(),u("design:type",Function),u("design:paramtypes",[e]),u("design:returntype",void 0)],S,"getNodePaint",null),g([(0,t.Um)({injectContainerState:!1}),(0,t.MD)([S.getNodes]),u("design:type",Function),u("design:paramtypes",[Object]),u("design:returntype",void 0)],S,"getNodeIds",null),g([(0,t.Um)({injectContainerState:!1}),(0,t.MD)([S.getCheckedNodes]),u("design:type",Function),u("design:paramtypes",[Array]),u("design:returntype",void 0)],S,"getCheckedNodeIds",null),g([(0,t.Um)({injectContainerState:!1}),(0,t.MD)([S.getCheckedNodes]),u("design:type",Function),u("design:paramtypes",[Array]),u("design:returntype",void 0)],S,"getCheckedNodesCount",null),g([(0,t.Um)({injectContainerState:!1}),(0,t.MD)([S.getAvailableNodes]),u("design:type",Function),u("design:paramtypes",[Object]),u("design:returntype",void 0)],S,"getCheckedNodes",null),g([(0,t.Um)({injectContainerState:!1}),(0,t.MD)([S.getAvailableNodes]),u("design:type",Function),u("design:paramtypes",[Object]),u("design:returntype",void 0)],S,"getSelectedNode",null),S=g([(0,t.Uw)({name:"engineNodes",defaults:{activeChapterId:void 0,nodeState:void 0,patches:[],patchesForChapter:{}}}),u("design:paramtypes",[_.w])],S)},12865:(ge,F,n)=>{"use strict";n.d(F,{r:()=>o});var t=n(10467),e=n(81025),r=n(44867);function o(C,E,y){if(!C.activeChapterId||!C.nodeState)return;const{objectIds:d,patch:_,setByTween:v,show:b,includeUnavailable:P}=E,[s,g,u]=e.vI(C,S=>{const f=S.nodeState[S.activeChapterId],m=P?f:(0,r.bd)(f);_?Object.entries(_).forEach(([i,c])=>{i in m&&(m[i].shown=c)}):(d??Object.keys(m)).forEach(c=>{c in m&&(m[c].shown=b,m[c].shownSetByTween=v,d&&((0,t.I7)(y,c,m,"shown",b),!0===v&&(0,t.I7)(y,c,m,"shownSetByTween",v)))})});return{finalState:e.jM(s,S=>{S.patches=g,S.patchesForChapter[S.activeChapterId].push(...g)}),patches:g,inversePatches:u}}},10467:(ge,F,n)=>{"use strict";n.d(F,{I7:()=>o,hW:()=>C});var t=n(49204);function r(y,d){const _=d.children;return 0===_.length?[]:(0,t.flattenDeep)(_.map(v=>[v.objectId,...r(y,y.getObjectById(v.objectId))]))}function o(y,d,_,v,b){const P=y.getObjectById(d);r(y,P).forEach(g=>{g in _&&(_[g][v]=b)})}function C(y,d,_,v,b){v.forEach(P=>{const s=y.getObjectById(P),g=r(y,s);E(d,_,P,b),g.forEach(u=>{E(d,_,u,b)})})}function E(y,d,_,v){d[_][v]=(0,t.cloneDeep)(y[_][v])}},35939:(ge,F,n)=>{"use strict";var t,e;n.d(F,{u:()=>t}),(e=t||(t={})).SetParticleState=(()=>{class a{constructor(p,A,O){this.particleSystems=p,this.assignedParticles=A,this.tweenParticleLookup=O}}return a.type="[Engine Particles] Set Particle State",a})(),e.NewParticleSystem=(()=>{class a{constructor(p,A){this.particleSystem=p,this.chapterId=A}}return a.type="[Engine Particles] New Particle System",a})(),e.DuplicateParticleSystem=(()=>{class a{constructor(p,A){this.id=p,this.targetChapterId=A}}return a.type="[Engine Particles] Duplicate Particle System",a})(),e.DuplicateParticleSystemSuccess=(()=>{class a{constructor(p,A){this.id=p,this.targetChapterId=A}}return a.type="[Engine Particles] Duplicate Particle System Success",a})(),e.UpdateParticleSystem=(()=>{class a{constructor(p,A){this.id=p,this.particleSystem=A}}return a.type="[Engine Particles] Update Particle System",a})(),e.SetParticleSystemsVisible=(()=>{class a{constructor(p,A){this.visible=p,this.chapterId=A}}return a.type="[Engine Particles] Set Particle Systems Visible",a})(),e.SetParticleSystemVisible=(()=>{class a{constructor(p,A,O){this.id=p,this.visible=A,this.chapterId=O}}return a.type="[Engine Particles] Set Particle System Visible",a})(),e.AssignParticle=(()=>{class a{constructor(p,A){this.id=p,this.chapterId=A}}return a.type="[Engine Particles] Assign Particle",a})(),e.UnassignParticle=(()=>{class a{constructor(p,A){this.id=p,this.chapterId=A}}return a.type="[Engine Particles] Unassign Particle",a})(),e.DeleteParticleSystem=(()=>{class a{constructor(p){this.id=p}}return a.type="[Engine Partiles] Delete Particle System",a})(),e.SelectParticleSystem=(()=>{class a{constructor(p){this.id=p}}return a.type="[Engine Partiles] Select Particle System",a})(),e.SelectParticleConstraint=(()=>{class a{constructor(p){this.index=p}}return a.type="[Engine Partiles] Select Particle Constraint",a})(),e.SelectParticleCreator=(()=>{class a{constructor(p){this.index=p}}return a.type="[Engine Partiles] Select Particle Creator",a})(),e.SelectParticleUpdater=(()=>{class a{constructor(p){this.index=p}}return a.type="[Engine Partiles] Select Particle Updater",a})(),e.UpdateTweenParticleLookupChapters=(()=>{class a{constructor(p){this.chapterMap=p}}return a.type="[Engine Particles] Update Lookup Chapters",a})(),e.SetLookupForChapter=(()=>{class a{constructor(p,A){this.chapterId=p,this.lookup=A}}return a.type="[Engine Particles] Set Lookup for chapter",a})(),e.DeleteChapterLookup=(()=>{class a{constructor(p){this.chapterId=p}}return a.type="[Engine Particles] Delete chapter lookup",a})(),e.ApplyPatch=(()=>{class a{constructor(p){this.patches=p}}return a.type="[Engine Particles] Apply Patch",a})()},12921:(ge,F,n)=>{"use strict";n.d(F,{B:()=>b});var y,v,t=n(65763),e=n(35939),r=n(11113),o=n(86544),C=n(81025),E=n(54438),d=function(P,s,g,u){var f,h=arguments.length,S=h<3?s:null===u?u=Object.getOwnPropertyDescriptor(s,g):u;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)S=Reflect.decorate(P,s,g,u);else for(var m=P.length-1;m>=0;m--)(f=P[m])&&(S=(h<3?f(S):h>3?f(s,g,S):f(s,g))||S);return h>3&&S&&Object.defineProperty(s,g,S),S},_=function(P,s){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(P,s)};let b=(y=class{static particleSystemIdExists(s){return(0,t.Mz)([v],g=>void 0!==g.particleSystems[s])}static particleSystemsForChapter(s){return(0,t.Mz)([v],g=>(g.assignedParticles[s]||[]).map(h=>g.particleSystems[h]))}static getVisibleParticleSystemsForChapter(s){return(0,t.Mz)([v],g=>{const h=g.visibleParticleSystems[s]||{};return(g.assignedParticles[s]||[]).filter(S=>!1!==h[S])})}static getTweenParticleLookup(s){return s.tweenParticleLookup}static getParticleSystems(s){return s.particleSystems}static getVisisbleParticleSystems(s){return s.visibleParticleSystems}static getParticleSystemsList(s){return Object.values(s.particleSystems)}static getAssignedParticleSystems(s){return s.assignedParticles}static getSelectedParticleSystemId(s){return s.particleSelection.selectedParticle}static getSelectedParticleSystem(s){const{particleSystems:g,particleSelection:u}=s;return g[u.selectedParticle]}static getSelectedParticleConstraintIndex(s){return s.particleSelection.selectedConstraint}static getSelectedParticleConstraint(s){const g=v.getSelectedParticleSystem(s);return g?g.constraints[s.particleSelection.selectedConstraint]:null}static getSelectedParticleCreatorIndex(s){return s.particleSelection.selectedCreator}static getSelectedParticleCreator(s){const g=v.getSelectedParticleSystem(s);return g?g.creators[s.particleSelection.selectedCreator]:null}static getSelectedParticleUpdaterIndex(s){return s.particleSelection.selectedUpdater}static getSelectedParticleUpdater(s){const g=v.getSelectedParticleSystem(s);return g?g.updaters[s.particleSelection.selectedUpdater]:null}applyPatch(s,g){const u=C.$i(s.getState(),g.patches);s.patchState(u)}setParticleState(s,g){s.patchState(C.jM(s.getState(),u=>{u.particleSystems=g.particleSystems.reduce((h,S)=>(h[S.id]=S,h),{}),u.assignedParticles=g.assignedParticles,u.tweenParticleLookup=g.tweenParticleLookup,u.visibleParticleSystems={}}))}setParticlesVisible(s,{visible:g,chapterId:u}){s.patchState(C.jM(s.getState(),h=>{const f=(h.assignedParticles[u]||[]).reduce((m,i)=>(m[i]=g,m),{});h.visibleParticleSystems={...h.visibleParticleSystems,[u]:f}}))}setParticleVisible(s,{id:g,visible:u,chapterId:h}){s.patchState(C.jM(s.getState(),S=>{S.visibleParticleSystems[h]={...S.visibleParticleSystems[h]||{},[g]:u}}))}newParticleSystem(s,g){const{particleSystem:u,chapterId:h}=g,S=u.id,[f,m,i]=C.vI(s.getState(),c=>{c.particleSystems[S]=u,c.assignedParticles[h]=[...c.assignedParticles[h]||[],S]});s.patchState(f)}duplicateParticleSystem(s,g){const{id:u,targetChapterId:h}=g,S=o.R.generateParticleId(u);s.patchState(C.jM(s.getState(),f=>{f.particleSystems[S]=JSON.parse(JSON.stringify(f.particleSystems[u])),f.particleSystems[S].id=S,f.assignedParticles[h].push(S);const m=o.R.getParticleIdRoot(u);f.tweenParticleLookup[h]&&f.tweenParticleLookup[h][m]&&(f.tweenParticleLookup=r.e.addEntryForChapter(h,{[m]:S},f.tweenParticleLookup))})),s.dispatch(new e.u.DuplicateParticleSystemSuccess(S,h))}updateParticleSystem(s,g){const u=C.jM(s.getState(),h=>{h.particleSystems[g.id]=g.particleSystem});s.patchState({...u,particleSystems:{...u.particleSystems}})}deleteChapterLookup(s,g){s.patchState(C.jM(s.getState(),u=>{delete u.tweenParticleLookup[g.chapterId]}))}setLookupForChapter(s,g){s.patchState(C.jM(s.getState(),u=>{u.tweenParticleLookup[g.chapterId]=g.lookup}))}assignParticle(s,g){s.patchState(C.jM(s.getState(),u=>{const h=u.assignedParticles[g.chapterId]||[],S=o.R.getParticleIdRoot(g.id);u.assignedParticles[g.chapterId]=h.concat(g.id),u.tweenParticleLookup=r.e.addEntryForChapter(g.chapterId,{[S]:g.id},u.tweenParticleLookup),u.particleSystems={...u.particleSystems}}))}unassignParticle(s,g){s.patchState(C.jM(s.getState(),u=>{const h=u.assignedParticles[g.chapterId]||[],S=o.R.getParticleIdRoot(g.id);u.assignedParticles[g.chapterId]=h.filter(f=>f!==g.id),u.tweenParticleLookup[g.chapterId]&&delete u.tweenParticleLookup[g.chapterId][S],u.particleSystems={...u.particleSystems}}))}deleteParticleSystem(s,g){s.patchState(C.jM(s.getState(),u=>{delete u.particleSystems[g.id],Object.keys(u.assignedParticles).forEach(h=>{u.assignedParticles[h]=u.assignedParticles[h].filter(S=>S!==g.id)}),Object.keys(u.tweenParticleLookup).forEach(h=>{delete u.tweenParticleLookup[h][o.R.getParticleIdRoot(g.id)]})}))}selectParticleSystem(s,g){s.patchState(C.jM(s.getState(),u=>{u.particleSelection={selectedParticle:g.id}}))}selectParticleConstraint(s,g){const h=s.getState().particleSelection;s.patchState(C.jM(s.getState(),S=>{S.particleSelection={...h,selectedConstraint:g.index}}))}selectParticleCreator(s,g){const h=s.getState().particleSelection;s.patchState(C.jM(s.getState(),S=>{S.particleSelection={...h,selectedCreator:g.index}}))}selectParticleUpdater(s,g){const h=s.getState().particleSelection;s.patchState(C.jM(s.getState(),S=>{S.particleSelection={...h,selectedUpdater:g.index}}))}updateTweenParticleLookupChapters(s,g){s.patchState(C.jM(s.getState(),u=>{u.tweenParticleLookup=r.e.updateChapterIds(u.tweenParticleLookup,g.chapterMap)}))}constructor(){}},v=y,y.\u0275fac=function(s){return new(s||y)},y.\u0275prov=E.jDH({token:y,factory:y.\u0275fac}),y);d([(0,t.rc)(e.u.ApplyPatch),_("design:type",Function),_("design:paramtypes",[Object,e.u.ApplyPatch]),_("design:returntype",void 0)],b.prototype,"applyPatch",null),d([(0,t.rc)(e.u.SetParticleState),_("design:type",Function),_("design:paramtypes",[Object,e.u.SetParticleState]),_("design:returntype",void 0)],b.prototype,"setParticleState",null),d([(0,t.rc)(e.u.SetParticleSystemsVisible),_("design:type",Function),_("design:paramtypes",[Object,e.u.SetParticleSystemsVisible]),_("design:returntype",void 0)],b.prototype,"setParticlesVisible",null),d([(0,t.rc)(e.u.SetParticleSystemVisible),_("design:type",Function),_("design:paramtypes",[Object,e.u.SetParticleSystemVisible]),_("design:returntype",void 0)],b.prototype,"setParticleVisible",null),d([(0,t.rc)(e.u.NewParticleSystem),_("design:type",Function),_("design:paramtypes",[Object,e.u.NewParticleSystem]),_("design:returntype",void 0)],b.prototype,"newParticleSystem",null),d([(0,t.rc)(e.u.DuplicateParticleSystem),_("design:type",Function),_("design:paramtypes",[Object,e.u.DuplicateParticleSystem]),_("design:returntype",void 0)],b.prototype,"duplicateParticleSystem",null),d([(0,t.rc)(e.u.UpdateParticleSystem),_("design:type",Function),_("design:paramtypes",[Object,e.u.UpdateParticleSystem]),_("design:returntype",void 0)],b.prototype,"updateParticleSystem",null),d([(0,t.rc)(e.u.DeleteChapterLookup),_("design:type",Function),_("design:paramtypes",[Object,e.u.DeleteChapterLookup]),_("design:returntype",void 0)],b.prototype,"deleteChapterLookup",null),d([(0,t.rc)(e.u.SetLookupForChapter),_("design:type",Function),_("design:paramtypes",[Object,e.u.SetLookupForChapter]),_("design:returntype",void 0)],b.prototype,"setLookupForChapter",null),d([(0,t.rc)(e.u.AssignParticle),_("design:type",Function),_("design:paramtypes",[Object,e.u.AssignParticle]),_("design:returntype",void 0)],b.prototype,"assignParticle",null),d([(0,t.rc)(e.u.UnassignParticle),_("design:type",Function),_("design:paramtypes",[Object,e.u.UnassignParticle]),_("design:returntype",void 0)],b.prototype,"unassignParticle",null),d([(0,t.rc)(e.u.DeleteParticleSystem),_("design:type",Function),_("design:paramtypes",[Object,e.u.DeleteParticleSystem]),_("design:returntype",void 0)],b.prototype,"deleteParticleSystem",null),d([(0,t.rc)(e.u.SelectParticleSystem),_("design:type",Function),_("design:paramtypes",[Object,e.u.SelectParticleSystem]),_("design:returntype",void 0)],b.prototype,"selectParticleSystem",null),d([(0,t.rc)(e.u.SelectParticleConstraint),_("design:type",Function),_("design:paramtypes",[Object,e.u.SelectParticleConstraint]),_("design:returntype",void 0)],b.prototype,"selectParticleConstraint",null),d([(0,t.rc)(e.u.SelectParticleCreator),_("design:type",Function),_("design:paramtypes",[Object,e.u.SelectParticleCreator]),_("design:returntype",void 0)],b.prototype,"selectParticleCreator",null),d([(0,t.rc)(e.u.SelectParticleUpdater),_("design:type",Function),_("design:paramtypes",[Object,e.u.SelectParticleUpdater]),_("design:returntype",void 0)],b.prototype,"selectParticleUpdater",null),d([(0,t.rc)(e.u.UpdateTweenParticleLookupChapters),_("design:type",Function),_("design:paramtypes",[Object,e.u.UpdateTweenParticleLookupChapters]),_("design:returntype",void 0)],b.prototype,"updateTweenParticleLookupChapters",null),d([(0,t.MD)(),_("design:type",Function),_("design:paramtypes",[Object]),_("design:returntype",void 0)],b,"getTweenParticleLookup",null),d([(0,t.MD)(),_("design:type",Function),_("design:paramtypes",[Object]),_("design:returntype",void 0)],b,"getParticleSystems",null),d([(0,t.MD)(),_("design:type",Function),_("design:paramtypes",[Object]),_("design:returntype",void 0)],b,"getVisisbleParticleSystems",null),d([(0,t.MD)(),_("design:type",Function),_("design:paramtypes",[Object]),_("design:returntype",void 0)],b,"getParticleSystemsList",null),d([(0,t.MD)(),_("design:type",Function),_("design:paramtypes",[Object]),_("design:returntype",void 0)],b,"getAssignedParticleSystems",null),d([(0,t.MD)(),_("design:type",Function),_("design:paramtypes",[Object]),_("design:returntype",void 0)],b,"getSelectedParticleSystemId",null),d([(0,t.MD)(),_("design:type",Function),_("design:paramtypes",[Object]),_("design:returntype",void 0)],b,"getSelectedParticleSystem",null),d([(0,t.MD)(),_("design:type",Function),_("design:paramtypes",[Object]),_("design:returntype",void 0)],b,"getSelectedParticleConstraintIndex",null),d([(0,t.MD)(),_("design:type",Function),_("design:paramtypes",[Object]),_("design:returntype",void 0)],b,"getSelectedParticleConstraint",null),d([(0,t.MD)(),_("design:type",Function),_("design:paramtypes",[Object]),_("design:returntype",void 0)],b,"getSelectedParticleCreatorIndex",null),d([(0,t.MD)(),_("design:type",Function),_("design:paramtypes",[Object]),_("design:returntype",void 0)],b,"getSelectedParticleCreator",null),d([(0,t.MD)(),_("design:type",Function),_("design:paramtypes",[Object]),_("design:returntype",void 0)],b,"getSelectedParticleUpdaterIndex",null),d([(0,t.MD)(),_("design:type",Function),_("design:paramtypes",[Object]),_("design:returntype",void 0)],b,"getSelectedParticleUpdater",null),b=v=d([(0,t.Uw)({name:"engineParticles",defaults:{particleSelection:{},particleSystems:{},visibleParticleSystems:{},assignedParticles:{},tweenParticleLookup:{}}}),_("design:paramtypes",[])],b)},30327:(ge,F,n)=>{"use strict";n.d(F,{J:()=>e,m:()=>t});let t=(()=>{class o{constructor(E,y,d){this.storyLoadProgress=E,this.chapterId=y,this.chapterProgress=d}}return o.type="[Engine Progress] Set Progress",o})(),e=(()=>{class o{constructor(){}}return o.type="[Engine Progress] Reset Progress",o})()},82109:(ge,F,n)=>{"use strict";n.d(F,{N:()=>d});var o,t=n(65763),e=n(30327),r=n(54438),C=function(_,v,b,P){var u,s=arguments.length,g=s<3?v:null===P?P=Object.getOwnPropertyDescriptor(v,b):P;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)g=Reflect.decorate(_,v,b,P);else for(var h=_.length-1;h>=0;h--)(u=_[h])&&(g=(s<3?u(g):s>3?u(v,b,g):u(v,b))||g);return s>3&&g&&Object.defineProperty(v,b,g),g},E=function(_,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(_,v)};const y={storyLoadProgress:0,chapterLoadProgress:{}};let d=((o=class{constructor(){}static getStoryLoadProgress(v){return v.storyLoadProgress}static getChaptersLoadProgress(v){return v.chapterLoadProgress}setProgress(v,b){const{storyLoadProgress:P,chapterId:s,chapterProgress:g}=b;v.patchState({storyLoadProgress:P,chapterLoadProgress:{...v.getState().chapterLoadProgress,[s]:g}})}resetProgress(v,b){v.setState({...y})}}).\u0275fac=function(v){return new(v||o)},o.\u0275prov=r.jDH({token:o,factory:o.\u0275fac}),o);C([(0,t.rc)(e.m),E("design:type",Function),E("design:paramtypes",[Object,e.m]),E("design:returntype",void 0)],d.prototype,"setProgress",null),C([(0,t.rc)(e.J),E("design:type",Function),E("design:paramtypes",[Object,e.J]),E("design:returntype",void 0)],d.prototype,"resetProgress",null),C([(0,t.MD)(),E("design:type",Function),E("design:paramtypes",[Object]),E("design:returntype",void 0)],d,"getStoryLoadProgress",null),C([(0,t.MD)(),E("design:type",Function),E("design:paramtypes",[Object]),E("design:returntype",void 0)],d,"getChaptersLoadProgress",null),d=C([(0,t.Uw)({name:"engineProgress",defaults:y}),E("design:paramtypes",[])],d)},66874:(ge,F,n)=>{"use strict";n.d(F,{z:()=>h});var t=n(15877),e=n(36110),r=n(64346),o=n(19833),C=n(17365),E=n(40470),y=n(45731),d=n(66432),_=n(79440),v=n(24418),b=n(30234),P=n(72865),s=n(54438),g=n(21626);const u=["live"];let h=(()=>{var S;class f{constructor(i){this.http=i}searchInternal(i="",c=""){return this.http.get(`/ws/search/internal?k=${i}&dir=${c}`).pipe((0,e.T)(a=>this.resultsToBookmarks(a)))}getAnatomyCategory(i,c,a=[],l=!1,p="en"){return this.search(i,[c,...a],l,p)}getConditionModel(i){if(v.c.offline)return(0,t.of)(null);const c=this.toDatabaseContentId(i);return this.http.get(`/search/conditions?q=${c}`).pipe((0,r.l)(a=>a.pipe((0,o.c)(1e3),(0,C.s)(3))),(0,e.T)(a=>this.resultsToBookmarks(a)),(0,e.T)(a=>a[0]))}getShowcase(i){return this.http.get(`/ws/product/app/settings/homepage-showcase?ol=${i}`).pipe((0,e.T)(c=>(c.forEach(a=>(a.bookmarks=this.resultsToBookmarks(a.bookmarks),a)),c)))}getZSpaceShowcase(){return this.getAnatomyCategory("",b.a.Zspace,[],!0).pipe((0,e.T)(i=>({title:"zSpace Models",description:" ",url:P.Wj,bookmarks:i})))}createMockShowcase(i){return{title:" ",description:" ",url:"",bookmarks:[...i],loading:!0}}createMockShowcases(i,c){return[...Array(i).keys()].map(()=>this.createMockShowcase(c))}search(i="",c,a,l){const p=i.split(/[ ]+/).join("+"),A=u.concat(c).filter(O=>""!==O&&null!=O).map(O=>`"${O}"`).join("+");return this.http.get(`/search/ai?k=${p}&t=${A}&zspace=${a}&il=${l}&ol=${l}&odns=true`).pipe((0,e.T)(O=>this.resultsToBookmarks(O)))}resultsToBookmarks(i){return i.forEach(c=>{c=(0,_.H)(c)}),(0,E.bj)(y.S,i)}getStoryCategory(i){if(!i.tags)return null;const c=(0,d.QU)().map(a=>a.id.toLocaleLowerCase());return i.tags.find(a=>c.includes(a.toLocaleLowerCase()))}toAppContentId(i){return i.replace("Condition.content.","").replace(".json","").split(".").join("/")}toDatabaseContentId(i){return i.match("Condition.content")?i:`Condition.content.${i.replace(".json","").split("/").join(".")}.json`}}return(S=f).\u0275fac=function(i){return new(i||S)(s.KVO(g.Qq))},S.\u0275prov=s.jDH({token:S,factory:S.\u0275fac,providedIn:"root"}),f})()},96298:(ge,F,n)=>{"use strict";n.d(F,{Z:()=>C});var t=n(49969),e=n(65763),r=n(28696),o=n(54438);let C=(()=>{var E;class y{constructor(_){this.store=_}ngOnInit(){}close(){this.store.dispatch(new r.w.ShowFilters(!1,!0))}}return(E=y).\u0275fac=function(_){return new(_||E)(o.rXU(e.il))},E.\u0275cmp=o.VBU({type:E,selectors:[["app-gallery-drawer"]],decls:8,vars:2,consts:[["appEventFence","","data-test","galleryDrawer",1,"gallery-drawer"],[1,"gallery-drawer__header"],[1,"gallery-drawer__label"],["app-button","","buttonType","ghost","buttonTheme","light","type","button","title","Close","data-test","galleryDrawerClose",3,"click"],["icon","times","size","lg"],[1,"gallery-drawer__body"],["viewMode","expanded"]],template:function(_,v){1&_&&(o.j41(0,"div",0)(1,"div",1)(2,"h1",2),o.EFF(3,"Filters"),o.k0s(),o.j41(4,"button",3),o.bIt("click",function(){return v.close()}),o.nrm(5,"app-icon",4),o.k0s()(),o.j41(6,"div",5),o.nrm(7,"app-gallery-filters",6),o.k0s()()),2&_&&(o.Y8G("@expand",void 0),o.R7$(4),o.BMQ("aria-label","Close"))},styles:[".gallery-drawer[_ngcontent-%COMP%]{box-shadow:0 11px 15px #0003,0 24px 38px #00000024,0 9px 46px #0000001f;background:#fff;border-radius:16px 16px 0 0;display:block;position:fixed;bottom:0;top:auto;width:100vw}.gallery-drawer__header[_ngcontent-%COMP%]{font-size:.875rem;line-height:1.25rem;font-weight:600;border-bottom:1px solid #eaeff5;height:52px;padding:0 12px 0 20px;display:flex;align-items:center}.gallery-drawer__label[_ngcontent-%COMP%]{flex:1 0 auto}.gallery-drawer__body[_ngcontent-%COMP%]{padding:20px}"],data:{animation:[(0,t.hZ)("expand",[(0,t.kY)(":enter",[(0,t.K2)([(0,t.iF)({top:"100%"}),(0,t.i0)("250ms ease-in-out",(0,t.iF)({top:"*"}))])])])]},changeDetection:0}),y})()},68008:(ge,F,n)=>{"use strict";n.d(F,{N:()=>q});var t=n(54438),e=n(65763),r=n(49204),o=n(85052),C=n(2573),E=n(37925),y=n(74394),d=n(24418),_=n(28696),v=n(43194),b=n(30234),P=n(38645),s=n(60177);const g=["app-pill-button",""],u=["*"],h=B=>({"pill-button--selected":B});let S=(()=>{var B;class j{constructor(){this.selected=!1}ngOnInit(){}}return(B=j).\u0275fac=function(M){return new(M||B)},B.\u0275cmp=t.VBU({type:B,selectors:[["button","app-pill-button",""],["a","app-pill-button",""]],inputs:{selected:"selected"},attrs:g,ngContentSelectors:u,decls:2,vars:3,consts:[[1,"pill-button",3,"ngClass"]],template:function(M,N){1&M&&(t.NAR(),t.j41(0,"span",0),t.SdG(1),t.k0s()),2&M&&t.Y8G("ngClass",t.eq3(1,h,N.selected))},dependencies:[s.YU],styles:["[_nghost-%COMP%]{border-color:transparent;background:none;border-width:0;padding:0;margin:0;border-radius:4px;outline:0 none}[_nghost-%COMP%]:not([disabled]):hover{cursor:pointer}[_nghost-%COMP%]:focus   .pill-button[_ngcontent-%COMP%]{outline:#2d72dc solid 2px!important}[_nghost-%COMP%]:disabled   .pill-button[_ngcontent-%COMP%], [_nghost-%COMP%]:disabled:hover   .pill-button[_ngcontent-%COMP%]{background-color:#f9fafd;color:#96a8c0}.pill-button[_ngcontent-%COMP%]{font-size:.75rem;line-height:1rem;font-family:Inter,sans-serif;font-weight:500;color:#374a68;display:flex;align-items:center;justify-content:center;background-color:#eaeff5;border-radius:100px;padding:8px 16px;transition:background-color .12s,color .12s;width:100%}.pill-button[_ngcontent-%COMP%]:hover{background-color:#d7e0ea}.pill-button--selected[_ngcontent-%COMP%], .pill-button--selected[_ngcontent-%COMP%]:hover{background-color:#2d72dc;color:#fff}"],changeDetection:0}),j})();var m,f=n(26779);function a(B,j){if(1&B){const V=t.RV6();t.j41(0,"li",9)(1,"button",10),t.nI1(2,"async"),t.bIt("click",function(){const N=t.eBV(V).$implicit,W=t.XpG().$implicit,$=t.XpG(2);return t.Njj($.setTag(W.title,$.activeTags[W.title]===N?"":N))}),t.EFF(3),t.nI1(4,"titlecase"),t.k0s()()}if(2&B){let V;const M=j.$implicit,N=t.XpG().$implicit,W=t.XpG(2);t.R7$(),t.Y8G("disabled",!(null!=(V=t.bMT(2,3,W.availableTags$))&&V.includes(M)))("selected",W.activeTags[N.title]===M),t.R7$(2),t.SpI(" ",t.bMT(4,5,M)," ")}}function l(B,j){if(1&B&&(t.j41(0,"div",5)(1,"h2",6),t.EFF(2),t.k0s(),t.j41(3,"ul",7),t.DNE(4,a,5,7,"li",8),t.k0s()()),2&B){const V=j.$implicit;t.R7$(2),t.JRh(V.title),t.R7$(2),t.Y8G("ngForOf",V.tags)}}function p(B,j){if(1&B&&(t.j41(0,"div",3),t.DNE(1,l,5,2,"div",4),t.k0s()),2&B){const V=t.XpG();t.R7$(),t.Y8G("ngForOf",V.tagGroups)}}function A(B,j){if(1&B){const V=t.RV6();t.j41(0,"li",9)(1,"button",14),t.bIt("click",function(){t.eBV(V);const N=t.XpG(2).$implicit,W=t.XpG(2);return t.Njj(W.setTag(N.title,""))}),t.j41(2,"span",15),t.EFF(3),t.nI1(4,"titlecase"),t.k0s(),t.nrm(5,"app-icon",16),t.k0s()()}if(2&B){const V=t.XpG().$implicit;t.R7$(3),t.JRh(t.bMT(4,1,V))}}function O(B,j){if(1&B&&(t.qex(0),t.DNE(1,A,6,3,"li",13),t.bVm()),2&B){const V=j.$implicit,M=t.XpG().$implicit,N=t.XpG(2);t.R7$(),t.Y8G("ngIf",N.activeTags[M.title]===V)}}function L(B,j){if(1&B&&(t.qex(0),t.DNE(1,O,2,1,"ng-container",12),t.bVm()),2&B){const V=j.$implicit;t.R7$(),t.Y8G("ngForOf",V.tags)}}function k(B,j){if(1&B&&(t.j41(0,"ul",11),t.DNE(1,L,2,1,"ng-container",12),t.k0s()),2&B){const V=t.XpG();t.R7$(),t.Y8G("ngForOf",V.tagGroups)}}class q{get viewMode(){return this._viewMode}set viewMode(j){this._viewMode=j}get activeTags(){return this._activeTags}set activeTags(j){null==j&&(j={}),this._activeTags=j,this.activeTagList=Object.values(this.activeTags).reduce((V,M)=>(""!=M&&V.push(M),V),[]),this.changeDetectorRef.markForCheck()}constructor(j,V,M){this.changeDetectorRef=j,this.store=V,this.router=M,this.activeTagList=[],this.ngUnsubscribe=new o.B,this._viewMode="expanded",this.tagGroups=[],this._activeTags={},this.selectedTagChange=new t.bkB}ngOnInit(){this.store.select(v.Y.getActiveTags).pipe((0,E.Q)(this.ngUnsubscribe)).subscribe(j=>{this.activeTags=j}),this.initFilters()}isMyLibrary(){return this.router.url.includes("/results/bookmarks")}initFilters(){const j=d.c.native;this.tagGroups=[],j&&this.tagGroups.push(y.VM),this.isMyLibrary()?this.tagGroups.push(y.Ub):this.tagGroups=this.tagGroups.concat([y.oM,{...y.Ue,tags:(0,r.without)(y.Ue.tags,"Quiz",b.a.Zspace)}])}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}setTag(j,V){const M=this.store.selectSnapshot(v.Y.getActiveTags);M[j]=V,this.store.dispatch(new _.w.SetActiveTags(M))}}(m=q).\u0275fac=function(j){return new(j||m)(t.rXU(t.gRc),t.rXU(e.il),t.rXU(P.Ix))},m.\u0275cmp=t.VBU({type:m,selectors:[["app-gallery-filters"]],inputs:{viewMode:"viewMode"},outputs:{selectedTagChange:"selectedTagChange"},decls:3,vars:4,consts:[["data-test","galleryFilters",1,"gallery-filters"],["class","gallery-filters__expanded","data-test","galleryFiltersExpanded",4,"ngIf"],["class","gallery-filters__tags","data-test","galleryFiltersSummary",4,"ngIf"],["data-test","galleryFiltersExpanded",1,"gallery-filters__expanded"],["class","gallery-filters__group",4,"ngFor","ngForOf"],[1,"gallery-filters__group"],[1,"gallery-filters__header"],[1,"gallery-filters__tags"],["class","gallery-filters__tag",4,"ngFor","ngForOf"],[1,"gallery-filters__tag"],["app-pill-button","","data-test","galleryFiltersTag",3,"click","disabled","selected"],["data-test","galleryFiltersSummary",1,"gallery-filters__tags"],[4,"ngFor","ngForOf"],["class","gallery-filters__tag",4,"ngIf"],["app-pill-button","","data-test","galleryFiltersTag",3,"click"],[1,"mr-2"],["icon","times"]],template:function(j,V){1&j&&(t.j41(0,"div",0),t.DNE(1,p,2,1,"div",1)(2,k,2,1,"ul",2),t.k0s()),2&j&&(t.AVh("gallery-filters--multiple",V.tagGroups.length>1),t.R7$(),t.Y8G("ngIf","expanded"===V.viewMode),t.R7$(),t.Y8G("ngIf","summary"===V.viewMode))},dependencies:[S,s.Sq,s.bT,f.R,s.Jj,s.PV],styles:[".gallery-filters__expanded[_ngcontent-%COMP%]{display:flex;gap:32px}.gallery-filters__header[_ngcontent-%COMP%]{font-size:.875rem;line-height:1.25rem;font-weight:600;padding-bottom:8px}.gallery-filters__tag[_ngcontent-%COMP%]{display:inline-block;margin:0 12px 12px 0}@media (max-width: 540px){.gallery-filters__expanded[_ngcontent-%COMP%]{flex-direction:column;gap:0}.gallery-filters__group[_ngcontent-%COMP%]{padding:0 0 24px}}"],changeDetection:0}),function(B,j,V,M){var $,N=arguments.length,W=N<3?j:null===M?M=Object.getOwnPropertyDescriptor(j,V):M;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)W=Reflect.decorate(B,j,V,M);else for(var ne=B.length-1;ne>=0;ne--)($=B[ne])&&(W=(N<3?$(W):N>3?$(j,V,W):$(j,V))||W);N>3&&W&&Object.defineProperty(j,V,W)}([(0,e.l6)(v.Y.getAvailableTags),function(B,j){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata("design:type",j)}(0,C.c)],q.prototype,"availableTags$",void 0)},8377:(ge,F,n)=>{"use strict";n.d(F,{l:()=>A});var t=n(60177),e=n(11818),r=n(89417),o=n(65763),C=n(43194),E=n(76549),y=n(89511),d=n(59162),_=n(78696),v=n(73845),b=n(21604),P=n(82765),s=n(45189),g=n(38645),u=n(81488),h=n(68008),S=n(96298),f=n(24184),m=n(13403),i=n(22346),c=n(54438),a=n(21007),l=n(25780),p=n(26779);let A=(()=>{var O;class L{}return(O=L).\u0275fac=function(q){return new(q||O)},O.\u0275mod=c.$C({type:O}),O.\u0275inj=c.G2t({imports:[o.rK.forFeature([C.Y]),v.Un,g.iI,e.C,t.MD,r.X1,E.k,y.h,_.H,s.G,u.f,d.M,b.G,P.g7,f.C,m.j,i.K]}),L})();c.wjB(S.Z,function(){return[a.Q,l.L,p.R,h.N]},[])},79898:(ge,F,n)=>{"use strict";n.d(F,{g:()=>t});var t=function(e){return e[e.Select=0]="Select",e[e.Import=1]="Import",e[e.Explore=2]="Explore",e[e.Check=3]="Check",e}(t||{})},72192:(ge,F,n)=>{"use strict";n.d(F,{A:()=>t});var t=function(e){return e[e.Query=0]="Query",e[e.Path=1]="Path",e}(t||{})},58841:(ge,F,n)=>{"use strict";n.d(F,{P:()=>r,k:()=>o});var t=n(24418),e=n(27180),r=function(C){return C[C.Row=0]="Row",C[C.Card=1]="Card",C}(r||{});const o=t.c.application===e.c.Loft?r.Row:r.Card},72865:(ge,F,n)=>{"use strict";n.d(F,{Ij:()=>y,O5:()=>_,S8:()=>C,Vf:()=>E,Wj:()=>r,Y0:()=>d,pf:()=>o,qS:()=>v});var t=n(30234),e=n(97948);const r=`/results/modules?categoryId=${t.a.Zspace}&type=Category`;class o{constructor(P,s=[],g=""){this.categoryId=P,this.tags=s,this.query=g,this.type=e.n.Category}}class C{constructor(P,s="",g=[]){this.organizationId=P,this.query=s,this.tags=g,this.type=e.n.Organization}}class E{constructor(P,s,g="",u=[]){this.organizationId=P,this.collectionId=s,this.query=g,this.tags=u,this.type=e.n.Collection}}class y{constructor(P="",s=[]){this.query=P,this.tags=s,this.categoryId="public",this.type=e.n.Community}}class d{constructor(P="",s=[]){this.query=P,this.tags=s,this.type=e.n.Private}}class _{constructor(P="",s="",g=[]){this.query=P,this.directory=s,this.tags=g,this.type=e.n.Internal}}class v{constructor(P,s="",g="",u=[]){this.primary=P,this.secondary=s,this.query=g,this.tags=u,this.type=e.n.Loft}}},54169:(ge,F,n)=>{"use strict";n.d(F,{n:()=>t});class t{constructor(r="",o,C=25,E=0){this.query=r,this.sortBy=o,this.pageSize=C,this.offset=E}}},97948:(ge,F,n)=>{"use strict";n.d(F,{n:()=>t});var t=function(e){return e.Organization="Organization",e.Collection="Collection",e.Private="Private",e.Category="Category",e.Community="Community",e.Internal="Internal",e.Loft="Loft",e}(t||{})},28696:(ge,F,n)=>{"use strict";var t,e;n.d(F,{w:()=>t}),(e=t||(t={})).SetSearchMode=(()=>{class k{constructor(B){this.searchMode=B}}return k.type="[Gallery] Set Search Mode",k})(),e.SetViewMode=(()=>{class k{constructor(B){this.viewMode=B}}return k.type="[Gallery] Set View Mode",k})(),e.ShowFilters=(()=>{class k{constructor(B,j=!1){this.show=B,this.triggerDrawer=j}}return k.type="[Gallery] Show Filters",k})(),e.GetStudioOptions=(()=>{class k{constructor(B){this.organizationId=B}}return k.type="[Gallery] Get Studio Options",k})(),e.GetStudioOptionsSuccess=(()=>{class k{constructor(B){this.options=B}}return k.type="[Gallery] Get Studio Options Success",k})(),e.SearchLoft=(()=>{class k{constructor(B){this.config=B}}return k.type="[Gallery] Search Loft",k})(),e.SearchLoftSuccess=(()=>{class k{constructor(B){this.bookmarks=B}}return k.type="[Gallery] Search Loft Success",k})(),e.SetSearchConfig=(()=>{class k{constructor(B,j){this.config=B,this.options=j}}return k.type="[Gallery] Set Search Config",k})(),e.SetSearchOptions=(()=>{class k{constructor(B){this.options=B}}return k.type="[Gallery] Set Search Options",k})(),e.SetActiveTags=(()=>{class k{constructor(B){this.activeTags=B}}return k.type="[Gallery] Set Active Tags",k})(),e.SearchCategory=(()=>{class k{constructor(B){this.categoryId=B}}return k.type="[Gallery] Search Category",k})(),e.SearchStudio=(()=>{class k{constructor(){}}return k.type="[Gallery] Search Studio",k})(),e.SearchStudioSuccess=(()=>{class k{constructor(B){this.bookmarks=B}}return k.type="[Gallery] Search Studio Success",k})(),e.SearchSuccess=(()=>{class k{constructor(B){this.bookmarks=B}}return k.type="[Gallery] Search Success",k})(),e.SelectBookmark=(()=>{class k{constructor(B){this.result=B}}return k.type="[Gallery] Select Bookmark",k})(),e.SetSidenav=(()=>{class k{constructor(B){this.sidenav=B}}return k.type="[Gallery] Set Sidenav",k})(),e.SetBulkActions=(()=>{class k{constructor(B){this.bulkActions=B}}return k.type="[Gallery] Set Bulk Actions",k})(),e.SetCardActions=(()=>{class k{constructor(B){this.cardActions=B}}return k.type="[Gallery] Set Card Actions",k})(),e.ClearResults=(()=>{class k{constructor(){}}return k.type="[Gallery] Clear Results",k})(),e.CheckItem=(()=>{class k{constructor(B,j){this.id=B,this.checked=j}}return k.type="[Gallery] Check Item",k})(),e.CheckAll=(()=>{class k{constructor(){}}return k.type="[Gallery] Check All",k})(),e.UncheckAll=(()=>{class k{constructor(){}}return k.type="[Gallery] Uncheck All",k})(),e.SetCheckedItems=(()=>{class k{constructor(B){this.ids=B}}return k.type="[Gallery] Set Checked Items",k})(),e.Reset=(()=>{class k{constructor(){}}return k.type="[Gallery] Reset",k})()},50353:(ge,F,n)=>{"use strict";n.d(F,{Bz:()=>t,S4:()=>r});class t{}class r{}},43194:(ge,F,n)=>{"use strict";n.d(F,{Y:()=>w});var t=n(65763),e=n(50353),r=n(72192),o=n(58841),C=n(28696),E=n(65459),y=n(2573),d=n(97978),_=n(36110),v=n(15152),b=n(66874),P=n(40634),s=n(55361),g=n(96728),u=n(97948),h=n(54169);class S{}var f=n(16823),m=n(17766),i=n(47987),c=n(76939),a=n(96298),l=n(54438);let p=(()=>{var te;class R{constructor(T,re){this.overlay=T,this.store=re}openDrawer(){this.overlayRef||this._createOverlay();const T=new c.A8(a.Z);this.overlayRef.attach(T)}closeDrawer(){this.overlayRef.detach()}_createOverlay(){const T=new i.rR({hasBackdrop:!0,scrollStrategy:this.overlay.scrollStrategies.block()});this.overlayRef=this.overlay.create(T),this.overlayRef.backdropClick().subscribe(()=>{this.store.dispatch(new C.w.ShowFilters(!1,!0))})}}return(te=R).\u0275fac=function(T){return new(T||te)(l.KVO(i.hJ),l.KVO(t.il))},te.\u0275prov=l.jDH({token:te,factory:te.\u0275fac,providedIn:"root"}),R})();var W,A=n(74394),O=n(49204),L=n(72865),k=n(24418),q=n(6795),B=n(59e3),j=n(7213),V=n(21424),M=n(52394),N=n(30234),$=function(te,R,D,T){var ae,re=arguments.length,K=re<3?R:null===T?T=Object.getOwnPropertyDescriptor(R,D):T;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)K=Reflect.decorate(te,R,D,T);else for(var ce=te.length-1;ce>=0;ce--)(ae=te[ce])&&(K=(re<3?ae(K):re>3?ae(R,D,K):ae(R,D))||K);return re>3&&K&&Object.defineProperty(R,D,K),K},ne=function(te,R){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(te,R)};const Q=[u.n.Organization,u.n.Collection],le=[...Q,u.n.Category],pe={[M.c.Private]:"My Models",[M.c.TeamEdit]:"View & Edit",[M.c.TeamView]:"View Only"},ie=Object.fromEntries(Object.entries(pe).map(([te,R])=>[R,te])),be={loading:!0,searchMode:r.A.Query,viewMode:o.k,showFilters:!1,searchResults:{total:0,items:[]},checkedResults:[],searchConfig:null,searchOptions:null,sidenav:{enabled:!0,open:!0,disableClose:!1},bulkActions:{enabled:!0,active:!1,items:[]},cardActions:{enabled:!0}},de=[...A.Ht.tags,...A.a.tags,...A.oM.tags,...A.Ue.tags,...A.iE.tags];let w=((W=class{static getLoading(R){return R.loading}static getSearchMode(R){return R.searchMode}static getSearchConfig(R){return R.searchConfig}static getSearchOptions(R){return R.searchOptions}static getHasFilters(R){return le.includes(R.searchConfig?.type)||!0===k.c.native}static getAvailableTags(R,D){const T=new Set,re=R.searchResults.items,K=k.c.native?q.s.getOfflineModelIDList():[];return Q.includes(R.searchConfig?.type)?(0,j.h_)(re).forEach(U=>{T.add(pe[U])}):re.forEach(ce=>{ce.tags.forEach(U=>{"quiz"===U&&(U="Quiz"),de.includes(U)&&T.add(U)}),k.c.native&&K.includes(ce.id)&&T.add("Downloaded")}),Array.from(T)}static getActiveTags(R){const T={};return R.searchConfig.tags.forEach(re=>{const K=A.Pg.find(ae=>ae.tags.some(ce=>ce===re));if(K){const ae=(0,O.get)(K,"title","");T[ae]=re}}),T}static getActiveTagsCount(R){return(0,O.compact)(R.searchConfig.tags).length}static getSearchType(R){return R.searchConfig?R.searchConfig.type:null}static getSearchGroup(R){switch(R.searchConfig?.type){case u.n.Category:case u.n.Community:case u.n.Internal:case u.n.Loft:return m.c.Module;case u.n.Collection:case u.n.Private:case u.n.Organization:return m.c.Bookmark}}static getViewMode(R){return R.viewMode}static getShowFilters(R){return R.showFilters}static getSort(R){return R.searchOptions.sortBy}static getSortOptions(R){switch(R.searchConfig.type){case u.n.Loft:return[g.MQ,g.iU];case u.n.Category:return[g.Ir,g._z,g.MQ,g.iU];default:return[g._z,g.MQ,g.iU,g.He,g.ZZ]}}static getSidenav(R){return R.sidenav}static getBulkActions(R){return R.bulkActions}static getBulkActionsAvailable(R){const{enabled:D,items:T}=R.bulkActions;return D&&T.length>0}static getBulkActionsActive(R){return R.bulkActions.active}static getCardActions(R){return R.cardActions}static getFilteredResults(R){const{searchResults:D,searchOptions:T,searchConfig:re}=R,{ascending:K,fields:ae}=T.sortBy,{offset:ce,pageSize:U}=T;let Z=(0,s.h5)(D.items,ae,K);return Z=(0,s.EL)(T,re,Z),Z=Z.slice(ce,ce+U),{...D,items:Z}}static getAllResults(R){const{searchResults:D,searchOptions:T,searchConfig:re}=R,{ascending:K,fields:ae}=T.sortBy;let ce=(0,s.h5)(D.items,ae,K);return ce=(0,s.EL)(T,re,ce),{total:D.total,items:ce}}static getCheckedResults(R){return R.checkedResults}static isZSpaceSearch(R){return R.searchConfig.type===u.n.Category&&R.searchConfig.categoryId===N.a.Zspace}setSearchMode(R,D){R.patchState({searchMode:D.searchMode})}setViewMode(R,D){R.patchState({viewMode:D.viewMode})}showFilters(R,D){R.patchState({showFilters:D.show}),D.triggerDrawer&&(D.show?this.galleryService.openDrawer():this.galleryService.closeDrawer())}setSearchOptions(R,D){R.patchState({searchOptions:{...D.options}})}setActiveTags(R,D){const re={...R.getState().searchConfig,tags:(0,O.flatten)(Object.values(D.activeTags))};this.store.dispatch(new C.w.SetSearchConfig(re))}setSearchConfig(R,D){const T=D.config||R.getState().searchConfig,re=D.options||R.getState().searchOptions;null!==T&&R.patchState({searchOptions:{...re},searchConfig:{...T}})}searchCategory(R,{categoryId:D}){const T="public"===D?new L.Ij(""):new L.pf(D);R.dispatch(new C.w.SetSearchConfig(T))}searchStudio(R,D){const{searchConfig:T,searchOptions:re}=R.getState(),K=new h.n("",g.MQ),ae=this.store.selectSnapshot(f.k.getUserLanguage),ce=this.store.selectSnapshot(V.q.isZSpaceAccount);R.patchState({loading:!0,searchOptions:{...re,pageSize:K.pageSize,offset:K.offset},checkedResults:[]});let U=new y.c;switch(T.type){case u.n.Category:U=this.exploreService.getAnatomyCategory(T.query,"all"===T.categoryId?"":T.categoryId,T.tags.filter(H=>!H.startsWith("Downloaded")),ce,ae);break;case u.n.Organization:U=this.bookmarksService.getOrganizationContent(T.organizationId,T.query,ae);break;case u.n.Collection:U=this.organizationsService.getCollectionContent(T.organizationId,T.collectionId,T.query,ae);break;case u.n.Community:U=this.bookmarksService.getPublicBookmarks(T.query,ae);break;case u.n.Private:U=this.bookmarksService.getPrivateContent(T.query,ae);break;case u.n.Internal:U=this.exploreService.searchInternal(T.query,T.directory);break;case u.n.Loft:const z=T.query.indexOf(".json")>0;U=this.modulesService.listContents(T.primary,T.secondary,z?T.query:"",!0).pipe((0,_.T)(H=>z?H:H.filter(J=>J.title.indexOf(T.query)>=0)))}const Z=T.tags.reduce((z,H)=>{const J=ie[H];return J&&z.push(J),z},[]);U.pipe((0,_.T)(z=>Z.length>0?(0,j.Lo)(z,Z):z),(0,v.j)(()=>R.patchState({loading:!1}))).subscribe(z=>{const H=k.c.native?q.s.getOfflineModelIDList():[],J=T.tags.includes("Downloaded")?z.filter(Y=>H.includes(Y.id)):z;R.dispatch(new C.w.SearchSuccess(J))})}searchSuccess(R,D){R.patchState({searchResults:{items:D.bookmarks,total:D.bookmarks.length}});const T=R.getState().searchConfig,re=D.bookmarks.length>0?"Search - With Results":"Search - No Results",K={...T,tags:T.tags.filter(ae=>""!==ae).join(", ")};this.vendorAnalyticsService.track(re,K)}checkItem(R,D){let T=R.getState().checkedResults;const re=T.some(K=>K===D.id);D.checked&&!re?T=[...T,D.id]:D.checked||(T=T.filter(K=>K!==D.id)),R.patchState({checkedResults:T})}checkAll(R,D){const T=R.getState().searchResults.items.map(re=>re.id);R.patchState({checkedResults:T})}uncheckAll(R,D){R.patchState({checkedResults:[]})}setCheckedItems(R,D){R.patchState({checkedResults:D.ids})}setSidenav(R,D){R.patchState({sidenav:{...D.sidenav}})}setCardActions(R,D){R.patchState({cardActions:{...D.cardActions}})}setBulkActions(R,D){const{bulkActions:T}=R.getState();R.patchState({bulkActions:{...T,...D.bulkActions}})}clearResults(R,D){R.patchState({searchResults:{items:[],total:0}})}resetGallery(R,D){R.patchState(be)}constructor(R,D,T,re,K,ae,ce){this.organizationsService=R,this.modulesService=D,this.exploreService=T,this.bookmarksService=re,this.galleryService=K,this.store=ae,this.vendorAnalyticsService=ce}}).\u0275fac=function(R){return new(R||W)(l.KVO(E.k),l.KVO(d.F),l.KVO(b.z),l.KVO(P.x),l.KVO(p),l.KVO(t.il),l.KVO(B.e))},W.\u0275prov=l.jDH({token:W,factory:W.\u0275fac}),W);$([(0,t.rc)(C.w.SetSearchMode),ne("design:type",Function),ne("design:paramtypes",[Object,C.w.SetSearchMode]),ne("design:returntype",void 0)],w.prototype,"setSearchMode",null),$([(0,t.rc)(C.w.SetViewMode),ne("design:type",Function),ne("design:paramtypes",[Object,C.w.SetViewMode]),ne("design:returntype",void 0)],w.prototype,"setViewMode",null),$([(0,t.rc)(C.w.ShowFilters),ne("design:type",Function),ne("design:paramtypes",[Object,C.w.ShowFilters]),ne("design:returntype",void 0)],w.prototype,"showFilters",null),$([(0,t.rc)(C.w.SetSearchOptions),ne("design:type",Function),ne("design:paramtypes",[Object,C.w.SetSearchOptions]),ne("design:returntype",void 0)],w.prototype,"setSearchOptions",null),$([(0,t.rc)(C.w.SetActiveTags),ne("design:type",Function),ne("design:paramtypes",[Object,C.w.SetActiveTags]),ne("design:returntype",void 0)],w.prototype,"setActiveTags",null),$([(0,t.rc)(C.w.SetSearchConfig),ne("design:type",Function),ne("design:paramtypes",[Object,C.w.SetSearchConfig]),ne("design:returntype",void 0)],w.prototype,"setSearchConfig",null),$([(0,t.rc)(C.w.SearchCategory),ne("design:type",Function),ne("design:paramtypes",[Object,C.w.SearchCategory]),ne("design:returntype",void 0)],w.prototype,"searchCategory",null),$([(0,t.rc)(C.w.SearchStudio),ne("design:type",Function),ne("design:paramtypes",[Object,C.w.SearchStudio]),ne("design:returntype",void 0)],w.prototype,"searchStudio",null),$([(0,t.rc)(C.w.SearchSuccess),ne("design:type",Function),ne("design:paramtypes",[Object,C.w.SearchSuccess]),ne("design:returntype",void 0)],w.prototype,"searchSuccess",null),$([(0,t.rc)(C.w.CheckItem),ne("design:type",Function),ne("design:paramtypes",[Object,C.w.CheckItem]),ne("design:returntype",void 0)],w.prototype,"checkItem",null),$([(0,t.rc)(C.w.CheckAll),ne("design:type",Function),ne("design:paramtypes",[Object,C.w.CheckAll]),ne("design:returntype",void 0)],w.prototype,"checkAll",null),$([(0,t.rc)(C.w.UncheckAll),ne("design:type",Function),ne("design:paramtypes",[Object,C.w.UncheckAll]),ne("design:returntype",void 0)],w.prototype,"uncheckAll",null),$([(0,t.rc)(C.w.SetCheckedItems),ne("design:type",Function),ne("design:paramtypes",[Object,C.w.SetCheckedItems]),ne("design:returntype",void 0)],w.prototype,"setCheckedItems",null),$([(0,t.rc)(C.w.SetSidenav),ne("design:type",Function),ne("design:paramtypes",[Object,C.w.SetSidenav]),ne("design:returntype",void 0)],w.prototype,"setSidenav",null),$([(0,t.rc)(C.w.SetCardActions),ne("design:type",Function),ne("design:paramtypes",[Object,C.w.SetCardActions]),ne("design:returntype",void 0)],w.prototype,"setCardActions",null),$([(0,t.rc)(C.w.SetBulkActions),ne("design:type",Function),ne("design:paramtypes",[Object,C.w.SetBulkActions]),ne("design:returntype",void 0)],w.prototype,"setBulkActions",null),$([(0,t.rc)(C.w.ClearResults),ne("design:type",Function),ne("design:paramtypes",[Object,C.w.ClearResults]),ne("design:returntype",void 0)],w.prototype,"clearResults",null),$([(0,t.rc)(C.w.Reset),ne("design:type",Function),ne("design:paramtypes",[Object,C.w.Reset]),ne("design:returntype",void 0)],w.prototype,"resetGallery",null),$([(0,t.MD)(),ne("design:type",Function),ne("design:paramtypes",[e.Bz]),ne("design:returntype",void 0)],w,"getLoading",null),$([(0,t.MD)(),ne("design:type",Function),ne("design:paramtypes",[e.Bz]),ne("design:returntype",void 0)],w,"getSearchMode",null),$([(0,t.MD)(),ne("design:type",Function),ne("design:paramtypes",[e.Bz]),ne("design:returntype",void 0)],w,"getSearchConfig",null),$([(0,t.MD)(),ne("design:type",Function),ne("design:paramtypes",[e.Bz]),ne("design:returntype",void 0)],w,"getSearchOptions",null),$([(0,t.MD)(),ne("design:type",Function),ne("design:paramtypes",[e.Bz]),ne("design:returntype",void 0)],w,"getHasFilters",null),$([(0,t.MD)([f.k]),ne("design:type",Function),ne("design:paramtypes",[e.Bz,Object]),ne("design:returntype",void 0)],w,"getAvailableTags",null),$([(0,t.MD)(),ne("design:type",Function),ne("design:paramtypes",[e.Bz]),ne("design:returntype",void 0)],w,"getActiveTags",null),$([(0,t.MD)(),ne("design:type",Function),ne("design:paramtypes",[e.Bz]),ne("design:returntype",void 0)],w,"getActiveTagsCount",null),$([(0,t.MD)(),ne("design:type",Function),ne("design:paramtypes",[e.Bz]),ne("design:returntype",void 0)],w,"getSearchType",null),$([(0,t.MD)(),ne("design:type",Function),ne("design:paramtypes",[e.Bz]),ne("design:returntype",void 0)],w,"getSearchGroup",null),$([(0,t.MD)(),ne("design:type",Function),ne("design:paramtypes",[e.Bz]),ne("design:returntype",void 0)],w,"getViewMode",null),$([(0,t.MD)(),ne("design:type",Function),ne("design:paramtypes",[e.Bz]),ne("design:returntype",void 0)],w,"getShowFilters",null),$([(0,t.MD)(),ne("design:type",Function),ne("design:paramtypes",[e.Bz]),ne("design:returntype",void 0)],w,"getSort",null),$([(0,t.MD)(),ne("design:type",Function),ne("design:paramtypes",[e.Bz]),ne("design:returntype",void 0)],w,"getSortOptions",null),$([(0,t.MD)(),ne("design:type",Function),ne("design:paramtypes",[e.Bz]),ne("design:returntype",void 0)],w,"getSidenav",null),$([(0,t.MD)(),ne("design:type",Function),ne("design:paramtypes",[e.Bz]),ne("design:returntype",void 0)],w,"getBulkActions",null),$([(0,t.MD)(),ne("design:type",Function),ne("design:paramtypes",[e.Bz]),ne("design:returntype",void 0)],w,"getBulkActionsAvailable",null),$([(0,t.MD)(),ne("design:type",Function),ne("design:paramtypes",[e.Bz]),ne("design:returntype",Boolean)],w,"getBulkActionsActive",null),$([(0,t.MD)(),ne("design:type",Function),ne("design:paramtypes",[e.Bz]),ne("design:returntype",void 0)],w,"getCardActions",null),$([(0,t.MD)([f.k]),ne("design:type",Function),ne("design:paramtypes",[e.Bz]),ne("design:returntype",S)],w,"getFilteredResults",null),$([(0,t.MD)(),ne("design:type",Function),ne("design:paramtypes",[e.Bz]),ne("design:returntype",S)],w,"getAllResults",null),$([(0,t.MD)(),ne("design:type",Function),ne("design:paramtypes",[e.Bz]),ne("design:returntype",void 0)],w,"getCheckedResults",null),$([(0,t.MD)(),ne("design:type",Function),ne("design:paramtypes",[e.Bz]),ne("design:returntype",void 0)],w,"isZSpaceSearch",null),w=$([(0,t.Uw)({name:"gallery",defaults:be}),ne("design:paramtypes",[E.k,d.F,b.z,P.x,p,t.il,B.e])],w)},21770:(ge,F,n)=>{"use strict";n.d(F,{U_:()=>d});var t=n(49204),r=n(2573),o=n(14264),C=n(32914);function d(_){return function y(_){return new r.c(v=>{const b=new Image;b.onload=()=>{const P=function E(_){const v=document.createElement("canvas"),b=v.getContext("2d");return v.width=_.naturalWidth,v.height=_.naturalHeight,b.drawImage(_,0,0),v}(b);v.next(P),v.complete()},b.onerror=()=>{const P=document.createElement("canvas");v.next(P),v.complete()},b.src=_})}(_).pipe((0,o.p)(v=>!(0,t.isNil)(v)),(0,C.n)(v=>new r.c(b=>{v.toBlob(P=>{b.next(P),b.complete()},"image/jpeg",100)})))}},1580:(ge,F,n)=>{"use strict";n.d(F,{M:()=>P});var t=n(49204),r=n(46104),o=n(15877),C=n(2573),E=n(32914),y=n(36110),d=n(89612),_=n(21770),v=n(54438),b=n(21626);let P=(()=>{var s;class g{constructor(h){this.http=h}generateFreshChapterImages(h,S,f=!1){const m=[];return h.forEach(i=>{const c=d.V.getChapterThumbnail(i,S);(c.legacy||f)&&m.push(d.V.makeFreshThumbnail(c.storyId,c.chapterId,c.urls.large))}),m.length?(0,r.p)(m):(0,o.of)([])}saveChapterThumbnails(h,S,f){return h.reduce((i,c)=>{const p=S.get(f[c.id]),A=(0,t.get)(p,"snapshot");return A&&i.push(this.saveNewChapterImage(c.id,A)),i},[])}saveNewChapterImage(h,S){return new C.c(f=>{(0,_.U_)(S).pipe((0,E.n)(m=>this.saveImageBlob(m)),(0,y.T)(m=>({chapterId:h,...m}))).subscribe(m=>{f.next(m),f.complete()},()=>{f.next(null),f.complete()})})}getIndexThumbnail(h,S="large"){return`${typeof localBaseDirectory>"u"?"":localBaseDirectory}thumbs/modules/${h}/${S}/index.jpg`}saveImageBlob(h){const f=new File([h],"image.jpg",{type:"image/jpeg"}),m=new FormData;return m.append("file",f),this.http.post("/ws/media/images/upload",m)}}return(s=g).\u0275fac=function(h){return new(h||s)(v.KVO(b.Qq))},s.\u0275prov=v.jDH({token:s,factory:s.\u0275fac,providedIn:"root"}),g})()},28107:(ge,F,n)=>{"use strict";n.d(F,{R:()=>u});var t=n(60177),e=n(38645),r=n(65763),o=n(32408),C=n(45189),E=n(21604),y=n(56400),d=n(89417),_=n(81488),v=n(76549),b=n(8377),P=n(91060),s=n(62497),g=n(54438);let u=(()=>{var h;class S{}return(h=S).\u0275fac=function(m){return new(m||h)},h.\u0275mod=g.$C({type:h}),h.\u0275inj=g.G2t({imports:[E.G,C.G,t.MD,e.iI,_.f,y.P,d.X1,v.k,b.l,P.w,s.N,r.rK.forFeature([o.W])]}),S})()},67271:(ge,F,n)=>{"use strict";n.d(F,{Z:()=>t});var t=function(e){return e.Light="theme-light",e.Dark="theme-dark",e}(t||{})},7277:(ge,F,n)=>{"use strict";n.d(F,{v:()=>t});var t=function(e){return e[e.Mobile=0]="Mobile",e[e.None=1]="None",e}(t||{})},22083:(ge,F,n)=>{"use strict";n.d(F,{D:()=>t});var t=function(e){return e[e.Application=0]="Application",e[e.Search=1]="Search",e[e.View=2]="View",e[e.Hide=3]="Hide",e[e.Share=4]="Share",e[e.Logo=5]="Logo",e}(t||{})},15810:(ge,F,n)=>{"use strict";var t,e;n.d(F,{G:()=>t}),(e=t||(t={})).SetTheme=(()=>{class P{constructor(g){this.theme=g}}return P.type="[Layout] Set Theme",P})(),e.SetSidenav=(()=>{class P{constructor(g){this.sidenav=g}}return P.type="[Layout] Set Sidenav",P})(),e.ToggleSidenav=(()=>{class P{constructor(g){this.open=g}}return P.type="[Layout] Toggle Sidenav",P})(),e.SetHeader=(()=>{class P{constructor(g){this.siteHeaderType=g}}return P.type="[Layout] Set Header",P})(),e.SetFooter=(()=>{class P{constructor(g){this.siteFooterType=g}}return P.type="[Layout] Set Footer",P})(),e.SetHeaderHeight=(()=>{class P{constructor(g){this.height=g}}return P.type="[Layout] Set Header Height",P})(),e.SetFooterHeight=(()=>{class P{constructor(g){this.height=g}}return P.type="[Layout] Set Footer Height",P})(),e.ResetLayout=(()=>{class P{constructor(){}}return P.type="[Layout] Reset",P})()},32408:(ge,F,n)=>{"use strict";n.d(F,{W:()=>s});var t=n(65763),e=n(15810);class r{}var _,C=n(67271),E=n(22083),y=n(7277),d=n(54438),v=function(g,u,h,S){var i,f=arguments.length,m=f<3?u:null===S?S=Object.getOwnPropertyDescriptor(u,h):S;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)m=Reflect.decorate(g,u,h,S);else for(var c=g.length-1;c>=0;c--)(i=g[c])&&(m=(f<3?i(m):f>3?i(u,h,m):i(u,h))||m);return f>3&&m&&Object.defineProperty(u,h,m),m},b=function(g,u){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(g,u)};const P={theme:C.Z.Light,sidenav:{enabled:!0,open:!1},siteHeader:E.D.Application,siteFooter:y.v.None,siteHeaderHeight:56,siteFooterHeight:56};let s=((_=class{static getTheme(u){return u.theme}static getSidenav(u){return u.sidenav}static getSiteHeader(u){return u.siteHeader}static getSiteHeaderHeight(u){return u.siteHeaderHeight}static getSiteFooter(u){return u.siteFooter}static getSiteFooterHeight(u){return u.siteFooterHeight}setTheme({patchState:u},{theme:h}){u({theme:h})}setHeader(u,h){u.patchState({siteHeader:h.siteHeaderType})}setFooter(u,h){u.patchState({siteFooter:h.siteFooterType})}setHeaderHeight(u,h){u.patchState({siteHeaderHeight:h.height})}setFooterHeight(u,h){u.patchState({siteFooterHeight:h.height})}setSidenav(u,h){u.patchState({sidenav:{...h.sidenav}})}toggleSidenav(u,h){const S=u.getState().sidenav;u.patchState({sidenav:{...S,open:h.open}})}resetLayout(u,h){u.setState(P)}}).\u0275fac=function(u){return new(u||_)},_.\u0275prov=d.jDH({token:_,factory:_.\u0275fac}),_);v([(0,t.rc)(e.G.SetTheme),b("design:type",Function),b("design:paramtypes",[Object,e.G.SetTheme]),b("design:returntype",void 0)],s.prototype,"setTheme",null),v([(0,t.rc)(e.G.SetHeader),b("design:type",Function),b("design:paramtypes",[Object,e.G.SetHeader]),b("design:returntype",void 0)],s.prototype,"setHeader",null),v([(0,t.rc)(e.G.SetFooter),b("design:type",Function),b("design:paramtypes",[Object,e.G.SetFooter]),b("design:returntype",void 0)],s.prototype,"setFooter",null),v([(0,t.rc)(e.G.SetHeaderHeight),b("design:type",Function),b("design:paramtypes",[Object,e.G.SetHeaderHeight]),b("design:returntype",void 0)],s.prototype,"setHeaderHeight",null),v([(0,t.rc)(e.G.SetFooterHeight),b("design:type",Function),b("design:paramtypes",[Object,e.G.SetFooterHeight]),b("design:returntype",void 0)],s.prototype,"setFooterHeight",null),v([(0,t.rc)(e.G.SetSidenav),b("design:type",Function),b("design:paramtypes",[Object,e.G.SetSidenav]),b("design:returntype",void 0)],s.prototype,"setSidenav",null),v([(0,t.rc)(e.G.ToggleSidenav),b("design:type",Function),b("design:paramtypes",[Object,e.G.ToggleSidenav]),b("design:returntype",void 0)],s.prototype,"toggleSidenav",null),v([(0,t.rc)(e.G.ResetLayout),b("design:type",Function),b("design:paramtypes",[Object,e.G.ResetLayout]),b("design:returntype",void 0)],s.prototype,"resetLayout",null),v([(0,t.MD)(),b("design:type",Function),b("design:paramtypes",[r]),b("design:returntype",void 0)],s,"getTheme",null),v([(0,t.MD)(),b("design:type",Function),b("design:paramtypes",[r]),b("design:returntype",void 0)],s,"getSidenav",null),v([(0,t.MD)(),b("design:type",Function),b("design:paramtypes",[r]),b("design:returntype",void 0)],s,"getSiteHeader",null),v([(0,t.MD)(),b("design:type",Function),b("design:paramtypes",[r]),b("design:returntype",void 0)],s,"getSiteHeaderHeight",null),v([(0,t.MD)(),b("design:type",Function),b("design:paramtypes",[r]),b("design:returntype",void 0)],s,"getSiteFooter",null),v([(0,t.MD)(),b("design:type",Function),b("design:paramtypes",[r]),b("design:returntype",void 0)],s,"getSiteFooterHeight",null),s=v([(0,t.Uw)({name:"layout",defaults:P})],s)},56400:(ge,F,n)=>{"use strict";n.d(F,{P:()=>g});var t=n(54438),e=n(60177),r=n(37522),o=n(29512),C=n(57078),E=n(50583),y=n(83649),d=n(43649),_=n(98138),v=n(21626),b=n(11040),P=n(4158);[r.A,o.A,C.A,E.A,y.A,d.A,_.A].forEach(u=>{(0,e.EO)(u)});let g=(()=>{var u;class h{static forRoot(){return{ngModule:h,providers:[{provide:t.xe9,useFactory:b.kF},{provide:t.hnV,useFactory:P.vM,deps:[v.Qq,t.xe9],multi:!0}]}}}return(u=h).\u0275fac=function(f){return new(f||u)},u.\u0275mod=t.$C({type:u}),u.\u0275inj=t.G2t({imports:[e.MD]}),h})()},5393:(ge,F,n)=>{"use strict";n.d(F,{E:()=>y});var t=n(28407),e=n(11040);const r=0,o={eng:"en",spa:"es",cmn:"zh",fra:"fr",deu:"de",ita:"it",jpn:"ja",por:"pt"},C=Object.keys(o);function y(_){return d.apply(this,arguments)}function d(){return(d=(0,t.A)(function*(_){return n.e(17).then(n.bind(n,16017)).then(v=>function E(_,v){const b=_.franc(v,{minLength:r,only:C}),P=o[b];return e.IB.find(g=>g.lang===P)?.id}(v,_))})).apply(this,arguments)}},4158:(ge,F,n)=>{"use strict";n.d(F,{KS:()=>b,vM:()=>P});var t=n(15877),e=n(28577),r=n(46104),o=n(32914),C=n(35801),E=n(49204),d=n(11040);const _={"en-US":!0,"en-GB":!0,"es-ES":!0,"es-MX":!0,"fr-FR":!0,"it-IT":!0,"pt-PT":!0,"pt-BR":!0,"de-DE":!1,"zh-CN":!1,"cmn-CN":!1,ja:!1,"ja-JP":!1,"he-IL":!1};function v(s,g){const u=d.WF[g]??g;return _[u]??1?s.get(`assets/locales/${u}.json`).pipe((0,e.W)(()=>(0,t.of)(void 0))):(0,t.of)(void 0)}function b(s,g){const u=g.map(h=>v(s,h));return u.length>0?(0,r.p)(u):(0,t.of)([])}function P(s,g){return()=>{if(g===d.q.id)return(0,t.of)({});const u=d.WF[g]??g;return v(s,g).pipe((0,o.n)(h=>{const S=h?.translations;return(0,E.isNil)(S)?console.warn(`Translations not found for locale: ${u}`):(0,C.Zi)(S),(0,t.of)(h)}))}}},11040:(ge,F,n)=>{"use strict";n.d(F,{A8:()=>y,IB:()=>E,N9:()=>C,NS:()=>d,U1:()=>_,WF:()=>r,kF:()=>P,q:()=>o});var t=n(24418),e=n(27180);const r={ja:"ja-JP","pt-PT":"pt-BR"},o={title:"English",lang:"en",country:"us",id:"en-US",direction:"ltr",applications:[e.c.All]},C=[o,{title:"Espa\xf1ol",lang:"es",country:"es",id:"es-ES",direction:"ltr",applications:[e.c.All]},{title:"\u4e2d\u6587(\u7b80\u4f53)",lang:"zh",country:"cn",id:"zh-CN",direction:"ltr",applications:[e.c.All]},{title:"Fran\xe7ais",lang:"fr",country:"fr",id:"fr-FR",direction:"ltr",applications:[e.c.All]},{title:"Deutsch",lang:"de",country:"de",id:"de-DE",direction:"ltr",applications:[e.c.All]},{title:"Italiano",lang:"it",country:"it",id:"it-IT",direction:"ltr",applications:[e.c.All]},{title:"\u65e5\u672c\u8a9e",lang:"ja",country:"ja",id:"ja",direction:"ltr",applications:[e.c.All]},{title:"Portugu\xeas",lang:"pt",country:"pt",id:"pt-PT",direction:"ltr",applications:[e.c.All]},{title:"\u05e2\u05b4\u05d1\u05e8\u05b4\u05d9\u05ea",lang:"he",country:"il",id:"he-IL",direction:"rtl",applications:[e.c.Viewer]}],E=C.filter(s=>s.applications.includes(e.c.All)||s.applications.includes(t.c.application)),y={en:"englishLocaleButton",es:"spanishLocaleButton",zh:"chineseLocaleButton",fr:"frenchLocaleButton",de:"germanLocaleButton",it:"italianLocaleButton",ja:"japaneseLocaleButton",pt:"portugueseLocaleButton",he:"hebrewLocaleButton"};function d(s){return E.find(g=>g.id===s)}function _(s){return E.find(g=>g.lang===s)}function P(){return(t.c.application===e.c.Viewer?function b(){return _(new URLSearchParams(window.location.search).get("lang"))??o}():function v(){let s="";try{s=localStorage.getItem("locale")}catch{}return d(s)||o}()).id}},1314:(ge,F,n)=>{"use strict";n.d(F,{U_:()=>d,cb:()=>C});var t=n(60177),e=n(40832),r=n(35286),o=n(54438);const C=["strong","sub","sup"];function E(){const _=new e.A4;return _.link=(v,b,P)=>`<a href="${function y(_){return _.match(/^(?:(?:(?:ht)tps?):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i)?_:""}(v)}" target="_blank" rel="noreferrer nofollow">${P}</a>`,_.paragraph=v=>`<p>${v}</p>`,_.image=(v,b,P)=>"",{renderer:_,gfm:!1}}let d=(()=>{var _;class v{}return(_=v).\u0275fac=function(P){return new(P||_)},_.\u0275mod=o.$C({type:_}),_.\u0275inj=o.G2t({imports:[t.MD,r.y2.forRoot({markedOptions:{provide:r.GY,useFactory:E}})]}),v})()},45189:(ge,F,n)=>{"use strict";n.d(F,{G:()=>L});var t=n(45887),e=n(64109),r=n(82765),o=n(86600),C=n(88834),E=n(5951),y=n(82798),d=n(59115),_=n(55911),v=n(65571),b=n(34006),P=n(14823),s=n(95416),g=n(71997),u=n(90882),h=n(67575),m=(n(28931),n(65478)),i=n(81391),c=n(47987),a=n(76939),l=n(30450),p=n(54438);const A={disabled:!0,animation:{enterDuration:0,exitDuration:0}},O={...(0,P.zi)(),touchGestures:"off",disableTooltipInteractivity:!0};let L=(()=>{var k;class q{}return(k=q).\u0275fac=function(j){return new(j||k)},k.\u0275mod=p.$C({type:k}),k.\u0275inj=p.G2t({providers:[{provide:s.x6,useValue:{duration:3e3}},{provide:o.$E,useValue:A},{provide:P.sM,useValue:O}],imports:[i.ad,t.N0,r.g7,r.g7,C.Hl,E.Wk,y.Ve,d.Cn,_.s5,v.Vg,b.hM,P.uc,s._T,g.w,u.vg,m.E9,c.z_,a.jc,l.mV,i.ad,t.N0,e.Dc,r.g7,r.g7,C.Hl,E.Wk,y.Ve,d.Cn,_.s5,v.Vg,b.hM,P.uc,s._T,g.w,u.vg,m.E9,c.z_,a.jc,l.mV,h.PO]}),q})()},95419:(ge,F,n)=>{"use strict";n.d(F,{u:()=>B});var t=n(28407),e=n(97953),r=n(49204),o=n(85052),C=n(14264),E=n(37925);class y{get currentPlayer(){return this.players[this.index]}constructor(V){this.players=V,this.index=0,this.isPlaying=!1,this.eventSubject=new o.B,this.ngUnsubscribe=new o.B,this.loadState="unloaded",this.totalDuration=0,this.init()}state(){return this.loadState}duration(){return this.totalDuration}play(){this.currentPlayer&&this.currentPlayer.play()}pause(){this.currentPlayer&&this.currentPlayer.pause()}stop(){this.currentPlayer&&this.currentPlayer.stop(),this.index=0}seek(V){if(this.currentPlayer)return this.currentPlayer.seek(V)}rate(V){if(this.currentPlayer)return this.currentPlayer.rate(V)}mute(V){if(this.currentPlayer){if((0,r.isNil)(V))return this.currentPlayer.mute();this.currentPlayer.mute(V)}}playing(){return!!this.currentPlayer&&this.currentPlayer.playing()}on(V,M){this.eventSubject.asObservable().pipe((0,C.p)(N=>N===V),(0,E.Q)(this.ngUnsubscribe)).subscribe(M)}load(){this.players.forEach(V=>V.load())}unload(){this.players.forEach(V=>V.unload()),this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}init(){const V=this.players.length;let M=0;this.players.forEach((N,W)=>{N.on("load",()=>{this.totalDuration+=N.duration(),M++,M>=V&&(this.eventSubject.next("load"),this.loadState="loaded")}),N.on("play",()=>{"unloaded"===this.loadState&&(this.loadState="loading"),this.isPlaying||this.eventSubject.next("play"),this.isPlaying=!0,this.index=W}),N.on("pause",()=>{this.isPlaying=!1,this.eventSubject.next("pause")}),N.on("end",()=>{if(this.isPlaying){const ne=this.players[W+1];ne?ne.play():(this.isPlaying=!1,this.index=0,this.eventSubject.next("end"))}}),N.on("stop",()=>{this.isPlaying=!1,this.eventSubject.next("stop")}),N.on("loaderror",()=>{this.eventSubject.next("loaderror")}),N.on("playerror",()=>{this.eventSubject.next("playerror")})})}}var d=n(2573),_=n(36110),v=n(28577),b=n(15877),P=n(46075),s=n(11040),g=n(68947),u=n(5393),h=n(22397),S=n(12347),f=n(45144),m=n(65763),i=n(63008),c=n(54438),a=n(21626),l=n(35286);const A="/media/audio",L=new RegExp(`^${A}/(.*)/.*$`),k=["aac","m4a","mp3","ogg"],q={aac:"audio/aac",m4a:"audio/mp4",mp3:"audio/mpeg",ogg:"audio/ogg"};Howler.autoUnlock=!1;let B=(()=>{var j;class V{constructor(N,W,$,ne,Q){this.http=W,this.markdownService=$,this.animationService=ne,this.store=Q,this.audioPromises=new Map,this.audioPlayers=new Map,this.audioEventSubject=new o.B,this.videoPlayers=new Map,this.videoEventSubject=new o.B,this.videoSources=new Map,this.renderer=N.createRenderer(null,null)}addAudioPlayer(N,W,$,ne={}){var Q=this;return(0,t.A)(function*(){Q.removeAudioPlayer(N);const le=W.then(be=>Q.createAudioPlayer(be,$,ne));Q.audioPromises.set(N,le);const pe=yield le,ie=()=>{pe.playing()&&(Q.audioEventSubject.next({event:"playing",id:N,data:{time:pe.seek()}}),requestAnimationFrame(ie))};return pe.on("load",()=>{Q.audioEventSubject.next({event:"load",id:N})}),pe.on("play",()=>{Q.audioEventSubject.next({event:"play",id:N}),ie()}),pe.on("pause",()=>{Q.audioEventSubject.next({event:"pause",id:N})}),pe.on("stop",()=>{Q.audioEventSubject.next({event:"stop",id:N})}),pe.on("seek",()=>{Q.audioEventSubject.next({event:"seek",id:N,data:{time:pe.seek()}})}),pe.on("end",()=>{Q.audioEventSubject.next({event:"end",id:N})}),pe.on("playerror",()=>{Q.audioEventSubject.next({event:"playerror",id:N})}),Q.audioPlayers.set(N,pe),pe})()}createAudioPlayer(N,W,$){var ne=this;return(0,t.A)(function*(){if(W){const Q=yield ne.createAudioDataUrl(N);return ne.createSinglePlayer(Q,$)}return N.length>1?ne.createSinglePlayer(N[0],$):ne.createMultiPlayer(N,$)})()}createSinglePlayer(N,W){return new e.Howl({...W,src:N,format:k})}createMultiPlayer(N,W){const $=N.map(ne=>this.createSinglePlayer(ne,W));return new y($)}removeAudioPlayer(N){var W=this;return(0,t.A)(function*(){const $=W.audioPromises.get(N);if(W.audioPromises.delete(N),W.audioPlayers.delete(N),$)return $.then(ne=>ne.unload())})()}getAudioPlayer(N){var W=this;return(0,t.A)(function*(){return W.audioPromises.get(N)})()}hasAudioPlayer(N){return this.audioPromises.has(N)}removeAllAudioPlayers(){this.audioPromises.forEach((N,W)=>this.removeAudioPlayer(W))}createAudioUploadEvent(N){return{type:"uploadFile",url:"/ws/media/audio/upload",method:"POST",file:N}}getAudioEvents(){return this.audioEventSubject.asObservable()}getAudioClips(N){return Object.values(N).filter(W=>"audio"===W.streamType)}createAudioClip(N,W,$){const ne=this.getAudioUUID(W),{firstTime:Q,lastTime:le}=this.animationService.getChapterTimeFrame();return[ne,{clipId:ne,streamType:"audio",fullUrl:W,time1:Q,time2:le,lang:$}]}createAudioDataUrl(N){return(0,t.A)(function*(){const W=N.map($=>fetch($).then(ne=>ne.blob()));return Promise.all(W).then($=>{const ne=N[0].split(".").pop();return URL.createObjectURL(new Blob($,{type:q[ne]||q.mp3}))})})()}getDuration(N){return(0,t.A)(function*(){return"loaded"===N.state()?N.duration():new Promise(W=>{N.on("load",()=>{W(N.duration())})})})()}getTTSSources(N,W=s.q.id){var $=this;return(0,t.A)(function*(){const ne=yield g.l.getPlainTextFromMarkdown($.renderer,$.markdownService,N||"",!0),Q=yield(0,u.E)(ne);return(0,h.R)(ne,Q||W)})()}getAudioUUID(N){return N.match(L)[1]}getAudioSrc(N){return N.match(A)?N:`/content/states/${N}`}muteAudio(){this.audioPlayers.forEach(N=>{N.mute(!0)})}unmuteAudio(N){const W=this.audioPlayers.get(N);W&&(W.mute(!1),this.store.dispatch(new i.O.SetAudioMuted(!1)))}stopAllAudio(){this.stopAudio()}stopAllOtherAudio(N){this.stopAudio(N)}stopAudio(N){this.audioPlayers.forEach((W,$)=>{(!N||$!==N)&&W.stop()})}playAudio(N,W){this.getAudioPlayer(N).then($=>{$&&((0,r.isNil)(W)||($.mute(W),this.store.dispatch(new i.O.SetAudioMuted(W))),$.play())})}playChapterAudio(N){this.stopAllAudio(),this.playAudio(N,!1),this.store.dispatch(new i.O.SetAutoplayAudio(!0)),this.store.dispatch(new i.O.SetAudioMuted(!1))}getPlayingAudio(){const N=[];return this.audioPlayers.forEach(W=>{W.playing()&&N.push(W)}),N}getChapterAudioPlayer(N,W,$=!1){var ne=this;return(0,t.A)(function*(){return ne.getChapterAudioPlaybackType(N,W,$)!==f.Y.None?ne.hasAudioPlayer(N.id)?yield ne.getAudioPlayer(N.id):yield ne.createChapterAudioPlayer(N,W,$):null})()}createChapterAudioPlayer(N,W,$=!1){var ne=this;return(0,t.A)(function*(){const Q=ne.getChapterAudioPlaybackType(N,W,$),le=ne.buildChapterAudioSources(N,Q,W);return Q===f.Y.None?null:yield ne.addAudioPlayer(N.id,le,!0,{preload:!0,mute:!0})})()}buildChapterAudioSources(N,W,$){var ne=this;return(0,t.A)(function*(){const le=ne.getChapterAudioInLanguage(N,$)?.fullUrl??"",pe=N?.description,ie=s.IB.find(be=>be.lang===$);switch(W){case f.Y.File:return le?[ne.getAudioSrc(le)]:[];case f.Y.TTS:return ne.getTTSSources(pe,ie?.id);default:return[]}})()}getChapterAudioList(N){return N.media?Object.values(N.media).filter($=>"audio"===$.streamType):[]}getChapterAudioInLanguage(N,W){return this.getChapterAudioList(N).find(ne=>ne.lang===W)}getChapterAudioPlaybackType(N,W,$=!1){let ne=N?.ui?.config?.audio??f.Y.File;const Q=!(0,r.isNil)(this.getChapterAudioList(N).find(pe=>pe.lang===W));$&&!Q&&ne!==f.Y.TTS&&(ne=f.Y.TTS);const le=(0,r.trim)(N?.description??"").length>0;switch(ne){case f.Y.File:return Q?f.Y.File:f.Y.None;case f.Y.TTS:return le?f.Y.TTS:f.Y.None;default:return f.Y.None}}chapterHasAudio(N,W){return this.getChapterAudioPlaybackType(N,W)!==f.Y.None}getVideoPlayer(N){return this.videoPlayers.get(N)}createVideoPlayer(N,W){return(0,t.A)(function*(){return(0,(yield n.e(78).then(n.bind(n,37078))).default)(N,W)})()}getVideoEvents(){return this.videoEventSubject.asObservable()}addVideoPlayer(N,W){var $=this;return(0,t.A)(function*(){const ne=yield $.createVideoPlayer(N,W),Q=ne.id();return ne.on("play",()=>{$.videoEventSubject.next({event:"play",id:Q})}),ne.on("pause",()=>{$.videoEventSubject.next({event:"pause",id:Q})}),ne.on("seeking",()=>{$.videoEventSubject.next({event:"seeking",id:Q})}),ne.on("ended",()=>{$.videoEventSubject.next({event:"ended",id:Q})}),ne.on("error",()=>{$.videoEventSubject.next({event:"error",id:Q})}),$.videoPlayers.set(Q,ne),Q})()}removeVideoPlayer(N){const W=this.getVideoPlayer(N);W&&(W.dispose(),this.videoPlayers.delete(N))}getVideoUrls(N){return this.http.post("/ws/mc/video/upload/authorize",{filename:N})}checkVideoStatus(N){return this.videoSources.has(N)?new d.c(W=>{W.next(this.videoSources.get(N)),W.complete()}):this.http.get(N).pipe((0,_.T)(W=>{const $=W.listing.map(ne=>({src:ne,type:this.getFileMIMEType(ne)}));return this.videoSources.set(N,$),$}),(0,v.W)(()=>(0,b.of)(!1)))}getFileMIMEType(N){const W=N.split(".").pop(),$=P.CC[`.${W}`];return $?$[0]:""}}return(j=V).\u0275fac=function(N){return new(N||j)(c.KVO(c._9s),c.KVO(a.Qq),c.KVO(l.Rl),c.KVO(S.O),c.KVO(m.il))},j.\u0275prov=c.jDH({token:j,factory:j.\u0275fac,providedIn:"root"}),V})()},63008:(ge,F,n)=>{"use strict";var t,e;n.d(F,{O:()=>t}),(e=t||(t={})).SetAudioMuted=(()=>{class y{constructor(_){this.mute=_}}return y.type="[Media] Set Audio Muted",y})(),e.SetAutoplayAudio=(()=>{class y{constructor(_){this.autoplay=_}}return y.type="[Media] Set Autoplay Audio",y})(),e.ResetAudio=(()=>{class y{constructor(){}}return y.type="[Media] Reset Audio",y})()},37710:(ge,F,n)=>{"use strict";n.d(F,{S:()=>v});var C,t=n(65763),e=n(63008),r=n(81025),o=n(54438),E=function(b,P,s,g){var S,u=arguments.length,h=u<3?P:null===g?g=Object.getOwnPropertyDescriptor(P,s):g;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)h=Reflect.decorate(b,P,s,g);else for(var f=b.length-1;f>=0;f--)(S=b[f])&&(h=(u<3?S(h):u>3?S(P,s,h):S(P,s))||h);return u>3&&h&&Object.defineProperty(P,s,h),h},y=function(b,P){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(b,P)};class d{}const _={audioMuted:!0,autoplayAudio:!1};let v=((C=class{static getAudioMuted(P){return P.audioMuted}static getAutoplayAudio(P){return P.autoplayAudio}setAudioMuted(P,s){const g=r.jM(P.getState(),u=>{u.audioMuted=s.mute});P.setState(g)}setAutoplayAudio(P,s){const g=r.jM(P.getState(),u=>{u.autoplayAudio=s.autoplay});P.setState(g)}resetAudio(P,s){P.setState(_)}}).\u0275fac=function(P){return new(P||C)},C.\u0275prov=o.jDH({token:C,factory:C.\u0275fac}),C);E([(0,t.rc)(e.O.SetAudioMuted),y("design:type",Function),y("design:paramtypes",[Object,e.O.SetAudioMuted]),y("design:returntype",void 0)],v.prototype,"setAudioMuted",null),E([(0,t.rc)(e.O.SetAutoplayAudio),y("design:type",Function),y("design:paramtypes",[Object,e.O.SetAutoplayAudio]),y("design:returntype",void 0)],v.prototype,"setAutoplayAudio",null),E([(0,t.rc)(e.O.ResetAudio),y("design:type",Function),y("design:paramtypes",[Object,e.O.ResetAudio]),y("design:returntype",void 0)],v.prototype,"resetAudio",null),E([(0,t.MD)(),y("design:type",Function),y("design:paramtypes",[d]),y("design:returntype",void 0)],v,"getAudioMuted",null),E([(0,t.MD)(),y("design:type",Function),y("design:paramtypes",[d]),y("design:returntype",void 0)],v,"getAutoplayAudio",null),v=E([(0,t.Uw)({name:"media",defaults:_})],v)},16e3:(ge,F,n)=>{"use strict";var t,e;n.d(F,{h:()=>t}),(e=t||(t={})).Reset=(()=>{class E{constructor(){}}return E.type="[Memory] Reset",E})(),e.Update=(()=>{class E{constructor(d,_=!1){this.isFirstChapter=d,this.logToConsole=_}}return E.type="[Memory] Update",E})()},52597:(ge,F,n)=>{"use strict";n.d(F,{d:()=>t});var t=function(e){return e.Success="success",e.Fail="fail",e}(t||{})},97978:(ge,F,n)=>{"use strict";n.d(F,{F:()=>g});var t=n(21626),e=n(15877),r=n(36110),o=n(28577),C=n(52597),E=n(45731),y=n(17766),d=n(35650),_=n(54438);const v="cdb/content",b="cdb/copy/content",P={headers:new t.Lr({"Content-Type":"application/json; charset=utf-8"})},s=["production","client","preview","internal_content","public_preview","demos","social","exports","real_data"];let g=(()=>{var u;class h{constructor(f,m){this.http=f,this.sceneService=m}saveModule(f,m){m=this.formatModulePath(m);const i=[v,"modules",m].join("/"),c=this.JSONStringify(f);return this.http.put(i,c,P).pipe((0,r.T)(()=>C.d.Success),(0,o.W)(({status:a})=>(0,e.of)(a>=200&&a<=202?C.d.Success:C.d.Fail)))}mergeModule(f,m,i="exception"){return this.http.post("/cdb/merge/modules",{loft:`${f}.json`,bridge:`${m}.json`,merge_option:i})}copyState(f,m){const i=[b,"states",m].join("/"),c={headers:new t.Lr({"Content-Type":"application/json; charset=utf-8","source-state":f})};return this.http.put(i,{},c)}listContents(f,m,i,c=!1){const a=this.generateModulePath(f,m||"",i||"");return this.http.get(`/cdb/ls/content/modules/${a}`).pipe((0,r.T)(l=>c?l.contents.map(A=>{const O=A.name.replace("/content/modules/","").replace(".json",""),L=A.name.split("/").pop().replace("/content/modules","").replace(".json",""),k=new E.S;return k.id=O,k.title=L,k.type=y.c.Module,k}):l.contents))}getState(f){return this.http.get(`/cdb/ls/content/states/${f}`).pipe((0,r.T)(m=>m.contents))}getClients(){return this.http.get("/search/client").pipe((0,r.T)(f=>f.clients))}getUsedStates(){const f={};return Object.values(this.sceneService.getObjects()).reduce((m,i)=>(["transformId","morphId","geometryId","materialId"].forEach(c=>{const a=this.getPropertyState(i,c);a.length&&(f[a]=!0)}),i.hasOwnProperty("renderables")&&["morphId","geometryId","materialId"].forEach(c=>{i.renderables.forEach(l=>{const p=this.getPropertyState(l,c);p.length&&(f[p]=!0)})}),m),{}),Object.keys(f)}parseScenePath(f){const m=f.split("/");return 1===m.length?null:{fullPath:`https://qa.biodigital.com/content/modules/${f}`,relativePath:m.slice(0,m.length-1).join("/"),sceneName:m[m.length-1]}}formatModulePath(f){let m=f;return/\.json$/.test(f)||(m=`${m}.json`),m}getPrimaryCategories(){return(0,e.of)(s)}getSecondaryCategories(f){switch(f){case"production":return(0,e.of)(["maleAdult","femaleAdult"]);case"client":return this.getClients();default:return(0,e.of)([])}}generateSaveModule(f){const m=this.parseScenePath(f),i=m.relativePath.split("/");return{id:f,name:m.sceneName,primaryCategory:i[0]||"",secondaryCategory:i[1]||""}}generateModulePath(f,m,i){const c=[];return f.length&&c.push(f),m.length&&c.push(m),i.length&&(i.indexOf(".json")<0&&(i=`${i}.json`),c.push(i)),c.join("/")}getPropertyState(f,m){return null!=f[m]?f[m].split("/")[0]:""}JSONStringify(f){return JSON.stringify(f).replace(/[\u007f-\uffff]/g,m=>"\\u"+("0000"+m.charCodeAt(0).toString(16)).slice(-4))}}return(u=h).\u0275fac=function(f){return new(f||u)(_.KVO(t.Qq),_.KVO(d.w))},u.\u0275prov=_.jDH({token:u,factory:u.\u0275fac,providedIn:"root"}),h})()},30234:(ge,F,n)=>{"use strict";n.d(F,{O:()=>e,a:()=>t});var t=function(r){return r.WoltersKluwer="wolters_kluwer",r.Zspace="zspace",r}(t||{}),e=function(r){return r.None="none",r.Subscription="subcription",r.Device="device",r}(e||{})},15040:(ge,F,n)=>{"use strict";n.d(F,{n:()=>e});class e{}},2824:(ge,F,n)=>{"use strict";n.d(F,{V:()=>r});var t=n(49204);function r(o){return"?"+Object.entries(o).filter(([C,E])=>!(0,t.isNil)(E)).map(([C,E])=>`${C}=${encodeURIComponent(E)}`).join("&")}},65459:(ge,F,n)=>{"use strict";n.d(F,{k:()=>g});var t=n(21626);class e{}var r=n(36110),o=n(40470),C=n(45731),E=n(79440),y=function(u){return u.IdAsc="+collection_id",u.IdDesc="-collection_id",u.NameAsc="+collection_name",u.NameDesc="-collection_name",u.UpdateDateAsc="+collection_updatedate",u.UpdateDateDesc="-collection_updatedate",u.CreateDateAsc="+collection_createdate",u.CreateDateDesc="-collection_createdate",u.CustomAsc="+custom_sort_order",u.CustomDesc="-custom_sort_order",u}(y||{}),d=n(2824),_=n(5690),v=n(49204),b=n(54438);const P="/ws/organization/collection",s="/ws/organization/join/domains";let g=(()=>{var u;class h{constructor(f,m){this.http=f,this.productService=m}createOrganization(f){return this.http.post("/ws/organization/create",f)}updateOrganization(f){return this.http.post("/ws/organization/update",f)}deleteOrganization(f){return this.http.request("delete","/ws/organization/delete",{body:{version:1,app_productkey:this.productService.productKey,app_producttype:this.productService.productType,group_id:f}})}getCollections(f){f.sort_order||(f.sort_order=[y.CustomAsc,y.NameDesc]);const m=d.V(f);return this.http.get(`${P}${m}`).pipe((0,r.T)(i=>(0,o.bj)(e,i).map(c=>this.normalizeCollectionModel(c))))}getCollectionContent(f,m,i="",c="en"){const a=i.toLocaleLowerCase().split(" ");return this.getCollections({group_id:f,collection_id:m,include_content:1,ol:c}).pipe((0,r.T)(l=>l[0].collection_content.map(A=>(0,o.bj)(C.S,A)).filter(A=>{let O=!0;return a.length&&A.title&&a.forEach(L=>{O=O&&A.title.toLocaleLowerCase().indexOf(L)>=0}),O=O&&!0!==A.unavailable,O})))}addCollection(f,m){return this.http.post(P,{group_id:f,collection_name:m})}removeCollection(f){return this.http.request("DELETE",P,{body:{group_id:f.group_id,collection_id:f.collection_id}})}renameCollection(f,m){return this.http.post(P,{group_id:f.group_id,collection_id:f.collection_id,collection_name:m})}reorderCollections(f,m){return this.http.post(`${P}/sort-order`,{group_id:f,collection_id_sort_list:m.map(i=>i.collection_id)})}updateCollectionContent(f,m,i){return this.http.post(`${P}/content`,{group_id:f,add_content:m,remove_content:i})}getOrganizationAttribute(f,m,i){return f.find(c=>c.type===m&&c.name===i)}getPublicProfile(f){return this.http.get("/ws/organization/public/profile",{params:{...f}}).pipe((0,r.T)(m=>m))}normalizeCollectionModel(f){return f.collection_content&&f.collection_content.forEach(m=>{(0,E.H)(m)}),f}isNewJoinDomain(f){return(0,v.isNil)(f.join_domain_id)}checkJoinDomains(f){return this.http.post("/ws/organization/join/domain/check",{version:1,app_productkey:this.productService.productKey,app_producttype:this.productService.productType,email_domains:f}).pipe((0,r.T)(i=>{const c=i.email_domains_checked;return f.map(a=>c[a].is_blacklisted)}))}getJoinDomains(f){const m={version:1,app_productkey:this.productService.productKey,app_producttype:this.productService.productType,...f},i=new t.Nl({fromObject:{...m}});return this.http.get(s,{params:i})}postJoinDomains(f){return this.http.post(s,{version:1,app_productkey:this.productService.productKey,app_producttype:this.productService.productType,email_domains:f})}deleteJoinDomains(f){return this.http.request("delete",s,{body:{version:1,app_productkey:this.productService.productKey,app_producttype:this.productService.productType,join_domain_ids:f}})}generateGroupCode(f){return this.http.post("/ws/organization/generate/groupcode",{version:1,app_productkey:this.productService.productKey,app_producttype:this.productService.productType,group_id:f})}}return(u=h).\u0275fac=function(f){return new(f||u)(b.KVO(t.Qq),b.KVO(_.b))},u.\u0275prov=b.jDH({token:u,factory:u.\u0275fac,providedIn:"root"}),h})()},18152:(ge,F,n)=>{"use strict";n.d(F,{$7:()=>O,A6:()=>e,B4:()=>r,BD:()=>u,DM:()=>Q,F:()=>j,Fy:()=>t,GC:()=>L,Hi:()=>$,LJ:()=>q,Lo:()=>l,O4:()=>M,OG:()=>W,Ot:()=>V,QB:()=>m,Rk:()=>b,T1:()=>_,Uj:()=>ne,XL:()=>k,Yn:()=>S,_o:()=>B,_q:()=>o,bE:()=>pe,cw:()=>a,cz:()=>de,dD:()=>y,dl:()=>C,e1:()=>le,eS:()=>ie,fA:()=>N,hQ:()=>f,hu:()=>h,jK:()=>s,kW:()=>d,ks:()=>P,m1:()=>p,nB:()=>c,ob:()=>v,pv:()=>be,qS:()=>E,qd:()=>g,ul:()=>i,xX:()=>A});let t=(()=>{class te{constructor(D){this.organizations=D}}return te.type="[Organizations] Set Organizations",te})(),e=(()=>{class te{constructor(D){this.organization=D}}return te.type="[Organizations] Select Organization",te})(),r=(()=>{class te{constructor(D){this.collection=D}}return te.type="[Organizations] Select Collection",te})(),o=(()=>{class te{constructor(D){this.organizationId=D}}return te.type="[Organizations] Get Collections",te})(),C=(()=>{class te{constructor(D){this.collections=D}}return te.type="[Organizations] Get Collections Success",te})(),E=(()=>{class te{constructor(D,T){this.organizationId=D,this.collectionName=T}}return te.type="[Organizations] Add Collection",te})(),y=(()=>{class te{constructor(D,T){this.organizationId=D,this.collectionName=T}}return te.type="[Organizations] Add Collection Success",te})(),d=(()=>{class te{constructor(D){this.error=D}}return te.type="[Organizations] Add Collection Error",te})(),_=(()=>{class te{constructor(D){this.collection=D}}return te.type="[Organizations] Remove Collection",te})(),v=(()=>{class te{constructor(D){this.collection=D}}return te.type="[Organizations] Remove Collection Success",te})(),b=(()=>{class te{constructor(D){this.error=D}}return te.type="[Organizations] Remove Collection Error",te})(),P=(()=>{class te{constructor(D){this.collection=D}}return te.type="[Organizations] Set Collection Rename Mode",te})(),s=(()=>{class te{constructor(D,T){this.collection=D,this.collectionName=T}}return te.type="[Organizations] Rename Collection",te})(),g=(()=>{class te{constructor(D,T){this.collection=D,this.collectionName=T}}return te.type="[Organizations] Rename Collection Success",te})(),u=(()=>{class te{constructor(D){this.error=D}}return te.type="[Organizations] Rename Collection Error",te})(),h=(()=>{class te{constructor(D,T){this.organizationId=D,this.collections=T}}return te.type="[Organizations] Reorder Collections",te})(),S=(()=>{class te{constructor(D,T){this.organizationId=D,this.collections=T}}return te.type="[Organizations] Reorder Collections Success",te})(),f=(()=>{class te{constructor(D){this.error=D}}return te.type="[Organizations] Reorder Collections Error",te})(),m=(()=>{class te{constructor(){}}return te.type="[Organizations] Reset",te})(),i=(()=>{class te{constructor(D){this.organization=D}}return te.type="[Organizations] Create Organization",te})(),c=(()=>{class te{constructor(){}}return te.type="[Organizations] Create Organization Success",te})(),a=(()=>{class te{constructor(D){this.error=D}}return te.type="[Organizations] Create Organization Fail",te})(),l=(()=>{class te{constructor(D){this.organization=D}}return te.type="[Organizations] Update Organization",te})(),p=(()=>{class te{constructor(){}}return te.type="[Organizations] Update Organization Success",te})(),A=(()=>{class te{constructor(D){this.error=D}}return te.type="[Organizations] Update Organization Fail",te})(),O=(()=>{class te{constructor(D){this.organization=D}}return te.type="[Organizations] Delete Organization",te})(),L=(()=>{class te{constructor(D){this.organization=D}}return te.type="[Organizations] Delete Organization Success",te})(),k=(()=>{class te{constructor(D){this.error=D}}return te.type="[Organizations] Delete Organization Fail",te})(),q=(()=>{class te{constructor(D){this.request=D}}return te.type="[Organizations] Get Organization Profile",te})(),B=(()=>{class te{constructor(D){this.organizationProfile=D}}return te.type="[Organizations] Get Organization Profile Success",te})(),j=(()=>{class te{constructor(D){this.error=D}}return te.type="[Organizations] Get Organization Profile Fail",te})(),V=(()=>{class te{constructor(){}}return te.type="[Organizations] Clear Organization Profile",te})(),M=(()=>{class te{constructor(D){this.params=D}}return te.type="[Organizations] Get Join Domains",te})(),N=(()=>{class te{constructor(D){this.joinDomains=D}}return te.type="[Organizations] Get Join Domains Success",te})(),W=(()=>{class te{constructor(D){this.emailDomains=D}}return te.type="[Organizations] Post Join Domains",te})(),$=(()=>{class te{constructor(D){this.emailDomains=D}}return te.type="[Organizations] Post Join Domains Success",te})(),ne=(()=>{class te{constructor(D){this.error=D}}return te.type="[Organizations] Post Join Domains Fail",te})(),Q=(()=>{class te{constructor(D){this.joinDomainIds=D}}return te.type="[Organizations] Delete Join Domains",te})(),le=(()=>{class te{constructor(D){this.joinDomainIds=D}}return te.type="[Organizations] Delete Join Domains Success",te})(),pe=(()=>{class te{constructor(D){this.error=D}}return te.type="[Organizations] Delete Join Domains Fail",te})(),ie=(()=>{class te{constructor(D){this.groupId=D}}return te.type="[Organizations] Generate Group Code",te})(),be=(()=>{class te{constructor(D){this.groupCode=D}}return te.type="[Organizations] Generate Group Code Success",te})(),de=(()=>{class te{constructor(D){this.error=D}}return te.type="[Organizations] Generate Group Code Fail",te})()},21424:(ge,F,n)=>{"use strict";n.d(F,{q:()=>i});var t=n(65763);class e{}var u,r=n(18152),o=n(65459),C=n(56583),E=n(16058),y=n(94528),d=n(15152),_=n(59e3),v=n(49204),b=n(30234),P=n(5690),s=n(16823),g=n(54438),h=function(c,a,l,p){var L,A=arguments.length,O=A<3?a:null===p?p=Object.getOwnPropertyDescriptor(a,l):p;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)O=Reflect.decorate(c,a,l,p);else for(var k=c.length-1;k>=0;k--)(L=c[k])&&(O=(A<3?L(O):A>3?L(a,l,O):L(a,l))||O);return A>3&&O&&Object.defineProperty(a,l,O),O},S=function(c,a){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(c,a)};const f={joinDomains:[],loading:!1,creating:!1,updating:!1,deleting:!1,loadingJoinDomains:!1,addingJoinDomains:!1,removingJoinDomains:!1,generatingGroupCode:!1,loadingCollections:!1,addingCollection:!1,reorderingCollections:!1,removingCollection:!1,updatingCollection:!1,collectionRenaming:null};let i=((u=class{static getOrganizations(a){return a.organizations}static getOrganization(a){return a.organization}static getOrganizationLogo(a){return a.organization?.group_logos?.human_app?.default?.logo_url??""}static getSelectedOrganization(a){return a.selectedOrganization}static getSelectedOrganizationProductAccountId(a){return(0,v.get)(a,"organization.product_acctid")}static getOrganizationProfile(a){return a.organizationProfile}static getOrganizationGroupAttributes(a){return(0,v.get)(a,"organization.group_attributes",[])}static getOrganizationAccountSettings(a){return function m(c,a){return c.filter(l=>l.type===a).map(l=>{const{name:p,value:A}=l;return{[p]:{value:A}}})}(this.getOrganizationGroupAttributes(a),"account_settings")}static getDefaultUserRole(a,l){const A=this.getOrganizationGroupAttributes(a).find(O=>"default_user_role"===O.name);return(0,v.get)(A,"value",s.k.getSystemDefaultRole(l))}static getOrganizationGroupCode(a){return(0,v.get)(a,"organization.group_code","")}static getCollections(a){return a.collections}static getSelectedCollection(a){return a.selectedCollection}static getReorderingCollections(a){return a.reorderingCollections}static getAddingCollection(a){return a.addingCollection}static getRemovingCollection(a){return a.removingCollection}static getUpdatingCollection(a){return a.updatingCollection}static getCollectionRenaming(a){return a.collectionRenaming}static getGeneratingGroupCode(a){return a.generatingGroupCode}static getWidgetURL(a){return a.widgetURL}static getWidgetOptions(a){return a.widgetOptions}static getAppFeatures(a){return a.appFeatures}static getCreating(a){return a.creating}static getUpdating(a){return a.updating}static getDeleting(a){return a.deleting}static getLoading(a){return a.loading}static getCollectionsLoading(a){return a.loadingCollections}static getLoadingJoinDomains(a){return a.loadingJoinDomains}static getAddingJoinDomains(a){return a.addingJoinDomains}static getRemovingJoinDomains(a){return a.removingJoinDomains}static hasOrganization(a){return!(0,v.isNil)(a.organization)}static isTrial(a){return(0,v.get)(a,"organization.subscription.free_trial",!1)}static isSubscriptionExpired(a){return!0===(0,v.get)(a,"organization.subscription.expired",!1)}static getSubscriptionEndDate(a){const l=(0,v.get)(a,"organization.subscription.paid_through_date_time");return(0,v.isNil)(l)?void 0:new Date(l)}static getExternalAccount({organization:a}){return a?.external_account}static isValidPaidSubscription(a){return this.hasOrganization(a)&&!this.isTrial(a)&&!this.isSubscriptionExpired(a)}static getJoinDomains(a){return a.joinDomains}static isZSpaceAccount(a){return this.getExternalAccount(a).external_account_provider===b.a.Zspace}static getOrganizationAddOns(a){return a?.organization?.subscription?.addons}selectOrganization(a,l){const p=l.organization;a.patchState({selectedOrganization:p,selectedCollection:null}),p&&a.dispatch(new r._q(p.id))}setOrganizations(a,l){const p=l.organizations||[],A=p[0];let O,L=null,k={...a.getState().appFeatures};if(A&&A.group_attributes){const q=A.group_attributes,B=this.organizationsService.getOrganizationAttribute(q,"widget_settings","widget_custom_url_path");B&&B.value&&(O=B.value);const j=this.organizationsService.getOrganizationAttribute(q,"widget_settings","widget_url_params");j&&j.value&&(L=this.publishService.extendWidgetOptions(new C.$,j.value));const V=this.organizationsService.getOrganizationAttribute(q,"app_settings","web_app_features");V&&(k={...k,...V.value})}a.patchState({organization:A,organizations:p,widgetURL:O,widgetOptions:L,appFeatures:k}),a.dispatch(new y.PE(O)),A&&this.vendorAnalyticsService.updateAccountData(A)}getCollections(a,l){a.patchState({loadingCollections:!0}),this.organizationsService.getCollections({group_id:l.organizationId}).pipe((0,d.j)(()=>a.patchState({loadingCollections:!1}))).subscribe(p=>{a.dispatch(new r.dl(p))})}getCollectionsSuccess(a,l){a.patchState({collections:l.collections})}selectCollection(a,l){const{organization:p,selectedOrganization:A}=a.getState();a.patchState({selectedOrganization:A||p,selectedCollection:l.collection})}addCollection(a,l){a.patchState({addingCollection:!0}),this.organizationsService.addCollection(l.organizationId,l.collectionName).pipe((0,d.j)(()=>{a.patchState({addingCollection:!1})})).subscribe(()=>{a.dispatch(new r.dD(l.organizationId,l.collectionName))},p=>{a.dispatch(new r.kW(p))})}addCollectionSuccess(a,l){this.vendorAnalyticsService.track("Add Collection - Success",{platform:this.productService.productType})}addCollectionError(a,l){this.vendorAnalyticsService.track("Add Collection - Failure",{error:(0,v.get)(l,"error.error.error.message")||"There was an error with collection creation."})}removeCollection(a,l){a.patchState({removingCollection:!0}),this.organizationsService.removeCollection(l.collection).pipe((0,d.j)(()=>{a.patchState({removingCollection:!1})})).subscribe(()=>{a.dispatch(new r.ob(l.collection))},p=>{a.dispatch(new r.Rk(p))})}removeCollectionSuccess(a,l){this.vendorAnalyticsService.track("Remove Collection - Success",{platform:this.productService.productType})}removeCollectionError(a,l){this.vendorAnalyticsService.track("Remove Collection - Failure",{error:(0,v.get)(l,"error.error.error.message")||"There was an error with collection removal."})}setCollectionRenameMode(a,l){a.patchState({collectionRenaming:l.collection})}renameCollection(a,l){a.patchState({updatingCollection:!0}),this.organizationsService.renameCollection(l.collection,l.collectionName).pipe((0,d.j)(()=>{a.patchState({updatingCollection:!1})})).subscribe(()=>{a.dispatch(new r.qd(l.collection,l.collectionName))},p=>{a.dispatch(new r.BD(p))})}renameCollectionSuccess(a,l){this.vendorAnalyticsService.track("Rename Collection - Success",{platform:this.productService.productType})}renameCollectionError(a,l){this.vendorAnalyticsService.track("Rename Collection - Failure",{error:(0,v.get)(l,"error.error.error.message")||"There was an error with collection renaming."})}reorderCollections(a,l){a.patchState({reorderingCollections:!0}),this.organizationsService.reorderCollections(l.organizationId,l.collections).pipe((0,d.j)(()=>{a.patchState({reorderingCollections:!1})})).subscribe(()=>{a.dispatch(new r.Yn(l.organizationId,l.collections))},p=>{a.dispatch(new r.hQ(p))})}reorderCollectionsSuccess(a,l){a.patchState({collections:[...l.collections]})}resetOrganizations(a,l){a.setState(f)}createOrganization(a,{organization:l}){a.patchState({creating:!0}),this.organizationsService.createOrganization(l).pipe((0,d.j)(()=>a.patchState({creating:!1}))).subscribe(()=>a.dispatch(new r.nB),p=>a.dispatch(new r.cw(p)))}createOrganizationSuccess(a){this.vendorAnalyticsService.track("Team Creation - Success",{platform:this.productService.productType})}createOrganizationFail(a,l){this.vendorAnalyticsService.track("Team Creation - Failure",{error:(0,v.get)(l,"error.error.error.message")||"There was an error with team creation."})}updateOrganization(a,{organization:l}){a.patchState({updating:!0}),this.organizationsService.updateOrganization(l).pipe((0,d.j)(()=>a.patchState({updating:!1}))).subscribe(()=>a.dispatch(new r.m1),p=>a.dispatch(new r.xX(p)))}deleteOrganization(a,{organization:l}){a.patchState({deleting:!0}),this.organizationsService.deleteOrganization(l.id).pipe((0,d.j)(()=>a.patchState({deleting:!1}))).subscribe({next:()=>a.dispatch(new r.GC(l)),error:p=>a.dispatch(new r.XL(p))})}getOrganizationProfile(a,{request:l}){a.patchState({loading:!0}),this.organizationsService.getPublicProfile(l).pipe((0,d.j)(()=>a.patchState({loading:!1}))).subscribe(p=>a.dispatch(new r._o(p)),p=>a.dispatch(new r.F(p)))}getOrganizationProfileSuccess(a,{organizationProfile:l}){a.patchState({organizationProfile:l})}clearOrganizationProfile(a,l){a.patchState({organizationProfile:void 0})}getJoinDomains(a,l){a.patchState({loadingJoinDomains:!0}),this.organizationsService.getJoinDomains(l.params).pipe((0,d.j)(()=>a.patchState({loadingJoinDomains:!1}))).subscribe(p=>{a.dispatch(new r.fA(p.email_domains))})}getJoinDomainsSuccess(a,{joinDomains:l}){a.patchState({joinDomains:l})}postJoinDomains(a,l){a.patchState({addingJoinDomains:!0}),this.organizationsService.postJoinDomains(l.emailDomains).pipe((0,d.j)(()=>a.patchState({addingJoinDomains:!1}))).subscribe({next:()=>{a.dispatch(new r.Hi(l.emailDomains))},error:p=>{a.dispatch(new r.Uj(p))}})}deleteJoinDomains(a,l){a.patchState({removingJoinDomains:!0}),this.organizationsService.deleteJoinDomains(l.joinDomainIds).pipe((0,d.j)(()=>a.patchState({removingJoinDomains:!1}))).subscribe({next:()=>{a.dispatch(new r.e1(l.joinDomainIds))},error:p=>{a.dispatch(new r.bE(p))}})}generateGroupCode(a,l){a.patchState({generatingGroupCode:!0}),this.organizationsService.generateGroupCode(l.groupId).pipe((0,d.j)(()=>a.patchState({generatingGroupCode:!1}))).subscribe({next:p=>a.dispatch(new r.pv(p.group_code)),error:p=>a.dispatch(new r.cz(p))})}generateGroupCodeSuccess(a,l){const p={...a.getState().organization,group_code:l.groupCode};a.patchState({organization:p})}constructor(a,l,p,A){this.organizationsService=a,this.publishService=l,this.vendorAnalyticsService=p,this.productService=A}}).\u0275fac=function(a){return new(a||u)(g.KVO(o.k),g.KVO(E.D),g.KVO(_.e),g.KVO(P.b))},u.\u0275prov=g.jDH({token:u,factory:u.\u0275fac}),u);h([(0,t.rc)(r.A6),S("design:type",Function),S("design:paramtypes",[Object,r.A6]),S("design:returntype",void 0)],i.prototype,"selectOrganization",null),h([(0,t.rc)(r.Fy),S("design:type",Function),S("design:paramtypes",[Object,r.Fy]),S("design:returntype",void 0)],i.prototype,"setOrganizations",null),h([(0,t.rc)(r._q),S("design:type",Function),S("design:paramtypes",[Object,r._q]),S("design:returntype",void 0)],i.prototype,"getCollections",null),h([(0,t.rc)(r.dl),S("design:type",Function),S("design:paramtypes",[Object,r.dl]),S("design:returntype",void 0)],i.prototype,"getCollectionsSuccess",null),h([(0,t.rc)(r.B4),S("design:type",Function),S("design:paramtypes",[Object,r.B4]),S("design:returntype",void 0)],i.prototype,"selectCollection",null),h([(0,t.rc)(r.qS),S("design:type",Function),S("design:paramtypes",[Object,r.qS]),S("design:returntype",void 0)],i.prototype,"addCollection",null),h([(0,t.rc)(r.dD),S("design:type",Function),S("design:paramtypes",[Object,r.dD]),S("design:returntype",void 0)],i.prototype,"addCollectionSuccess",null),h([(0,t.rc)(r.kW),S("design:type",Function),S("design:paramtypes",[Object,r.kW]),S("design:returntype",void 0)],i.prototype,"addCollectionError",null),h([(0,t.rc)(r.T1),S("design:type",Function),S("design:paramtypes",[Object,r.T1]),S("design:returntype",void 0)],i.prototype,"removeCollection",null),h([(0,t.rc)(r.ob),S("design:type",Function),S("design:paramtypes",[Object,r.ob]),S("design:returntype",void 0)],i.prototype,"removeCollectionSuccess",null),h([(0,t.rc)(r.Rk),S("design:type",Function),S("design:paramtypes",[Object,r.Rk]),S("design:returntype",void 0)],i.prototype,"removeCollectionError",null),h([(0,t.rc)(r.ks),S("design:type",Function),S("design:paramtypes",[Object,r.ks]),S("design:returntype",void 0)],i.prototype,"setCollectionRenameMode",null),h([(0,t.rc)(r.jK),S("design:type",Function),S("design:paramtypes",[Object,r.jK]),S("design:returntype",void 0)],i.prototype,"renameCollection",null),h([(0,t.rc)(r.qd),S("design:type",Function),S("design:paramtypes",[Object,r.qd]),S("design:returntype",void 0)],i.prototype,"renameCollectionSuccess",null),h([(0,t.rc)(r.BD),S("design:type",Function),S("design:paramtypes",[Object,r.BD]),S("design:returntype",void 0)],i.prototype,"renameCollectionError",null),h([(0,t.rc)(r.hu),S("design:type",Function),S("design:paramtypes",[Object,r.hu]),S("design:returntype",void 0)],i.prototype,"reorderCollections",null),h([(0,t.rc)(r.Yn),S("design:type",Function),S("design:paramtypes",[Object,r.Yn]),S("design:returntype",void 0)],i.prototype,"reorderCollectionsSuccess",null),h([(0,t.rc)(r.QB),S("design:type",Function),S("design:paramtypes",[Object,r.QB]),S("design:returntype",void 0)],i.prototype,"resetOrganizations",null),h([(0,t.rc)(r.ul),S("design:type",Function),S("design:paramtypes",[Object,r.ul]),S("design:returntype",void 0)],i.prototype,"createOrganization",null),h([(0,t.rc)(r.nB),S("design:type",Function),S("design:paramtypes",[Object]),S("design:returntype",void 0)],i.prototype,"createOrganizationSuccess",null),h([(0,t.rc)(r.cw),S("design:type",Function),S("design:paramtypes",[Object,r.cw]),S("design:returntype",void 0)],i.prototype,"createOrganizationFail",null),h([(0,t.rc)(r.Lo),S("design:type",Function),S("design:paramtypes",[Object,r.Lo]),S("design:returntype",void 0)],i.prototype,"updateOrganization",null),h([(0,t.rc)(r.$7),S("design:type",Function),S("design:paramtypes",[Object,r.$7]),S("design:returntype",void 0)],i.prototype,"deleteOrganization",null),h([(0,t.rc)(r.LJ),S("design:type",Function),S("design:paramtypes",[Object,r.LJ]),S("design:returntype",void 0)],i.prototype,"getOrganizationProfile",null),h([(0,t.rc)(r._o),S("design:type",Function),S("design:paramtypes",[Object,r._o]),S("design:returntype",void 0)],i.prototype,"getOrganizationProfileSuccess",null),h([(0,t.rc)(r.Ot),S("design:type",Function),S("design:paramtypes",[Object,r.Ot]),S("design:returntype",void 0)],i.prototype,"clearOrganizationProfile",null),h([(0,t.rc)(r.O4),S("design:type",Function),S("design:paramtypes",[Object,r.O4]),S("design:returntype",void 0)],i.prototype,"getJoinDomains",null),h([(0,t.rc)(r.fA),S("design:type",Function),S("design:paramtypes",[Object,r.fA]),S("design:returntype",void 0)],i.prototype,"getJoinDomainsSuccess",null),h([(0,t.rc)(r.OG),S("design:type",Function),S("design:paramtypes",[Object,r.OG]),S("design:returntype",void 0)],i.prototype,"postJoinDomains",null),h([(0,t.rc)(r.DM),S("design:type",Function),S("design:paramtypes",[Object,r.DM]),S("design:returntype",void 0)],i.prototype,"deleteJoinDomains",null),h([(0,t.rc)(r.eS),S("design:type",Function),S("design:paramtypes",[Object,r.eS]),S("design:returntype",void 0)],i.prototype,"generateGroupCode",null),h([(0,t.rc)(r.pv),S("design:type",Function),S("design:paramtypes",[Object,r.pv]),S("design:returntype",void 0)],i.prototype,"generateGroupCodeSuccess",null),h([(0,t.MD)(),S("design:type",Function),S("design:paramtypes",[e]),S("design:returntype",void 0)],i,"getOrganizations",null),h([(0,t.MD)(),S("design:type",Function),S("design:paramtypes",[e]),S("design:returntype",void 0)],i,"getOrganization",null),h([(0,t.MD)(),S("design:type",Function),S("design:paramtypes",[e]),S("design:returntype",String)],i,"getOrganizationLogo",null),h([(0,t.MD)(),S("design:type",Function),S("design:paramtypes",[e]),S("design:returntype",void 0)],i,"getSelectedOrganization",null),h([(0,t.MD)(),S("design:type",Function),S("design:paramtypes",[e]),S("design:returntype",String)],i,"getSelectedOrganizationProductAccountId",null),h([(0,t.MD)(),S("design:type",Function),S("design:paramtypes",[e]),S("design:returntype",void 0)],i,"getOrganizationProfile",null),h([(0,t.MD)(),S("design:type",Function),S("design:paramtypes",[e]),S("design:returntype",void 0)],i,"getOrganizationGroupAttributes",null),h([(0,t.MD)(),S("design:type",Function),S("design:paramtypes",[e]),S("design:returntype",Array)],i,"getOrganizationAccountSettings",null),h([(0,t.MD)([s.k]),S("design:type",Function),S("design:paramtypes",[e,Object]),S("design:returntype",void 0)],i,"getDefaultUserRole",null),h([(0,t.MD)(),S("design:type",Function),S("design:paramtypes",[e]),S("design:returntype",void 0)],i,"getOrganizationGroupCode",null),h([(0,t.MD)(),S("design:type",Function),S("design:paramtypes",[e]),S("design:returntype",void 0)],i,"getCollections",null),h([(0,t.MD)(),S("design:type",Function),S("design:paramtypes",[e]),S("design:returntype",void 0)],i,"getSelectedCollection",null),h([(0,t.MD)(),S("design:type",Function),S("design:paramtypes",[e]),S("design:returntype",void 0)],i,"getReorderingCollections",null),h([(0,t.MD)(),S("design:type",Function),S("design:paramtypes",[e]),S("design:returntype",void 0)],i,"getAddingCollection",null),h([(0,t.MD)(),S("design:type",Function),S("design:paramtypes",[e]),S("design:returntype",void 0)],i,"getRemovingCollection",null),h([(0,t.MD)(),S("design:type",Function),S("design:paramtypes",[e]),S("design:returntype",void 0)],i,"getUpdatingCollection",null),h([(0,t.MD)(),S("design:type",Function),S("design:paramtypes",[e]),S("design:returntype",void 0)],i,"getCollectionRenaming",null),h([(0,t.MD)(),S("design:type",Function),S("design:paramtypes",[e]),S("design:returntype",void 0)],i,"getGeneratingGroupCode",null),h([(0,t.MD)(),S("design:type",Function),S("design:paramtypes",[e]),S("design:returntype",void 0)],i,"getWidgetURL",null),h([(0,t.MD)(),S("design:type",Function),S("design:paramtypes",[e]),S("design:returntype",void 0)],i,"getWidgetOptions",null),h([(0,t.MD)(),S("design:type",Function),S("design:paramtypes",[e]),S("design:returntype",void 0)],i,"getAppFeatures",null),h([(0,t.MD)(),S("design:type",Function),S("design:paramtypes",[e]),S("design:returntype",void 0)],i,"getCreating",null),h([(0,t.MD)(),S("design:type",Function),S("design:paramtypes",[e]),S("design:returntype",void 0)],i,"getUpdating",null),h([(0,t.MD)(),S("design:type",Function),S("design:paramtypes",[e]),S("design:returntype",void 0)],i,"getDeleting",null),h([(0,t.MD)(),S("design:type",Function),S("design:paramtypes",[e]),S("design:returntype",void 0)],i,"getLoading",null),h([(0,t.MD)(),S("design:type",Function),S("design:paramtypes",[e]),S("design:returntype",void 0)],i,"getCollectionsLoading",null),h([(0,t.MD)(),S("design:type",Function),S("design:paramtypes",[e]),S("design:returntype",void 0)],i,"getLoadingJoinDomains",null),h([(0,t.MD)(),S("design:type",Function),S("design:paramtypes",[e]),S("design:returntype",void 0)],i,"getAddingJoinDomains",null),h([(0,t.MD)(),S("design:type",Function),S("design:paramtypes",[e]),S("design:returntype",void 0)],i,"getRemovingJoinDomains",null),h([(0,t.MD)(),S("design:type",Function),S("design:paramtypes",[e]),S("design:returntype",void 0)],i,"hasOrganization",null),h([(0,t.MD)(),S("design:type",Function),S("design:paramtypes",[e]),S("design:returntype",void 0)],i,"isTrial",null),h([(0,t.MD)(),S("design:type",Function),S("design:paramtypes",[e]),S("design:returntype",void 0)],i,"isSubscriptionExpired",null),h([(0,t.MD)(),S("design:type",Function),S("design:paramtypes",[e]),S("design:returntype",void 0)],i,"getSubscriptionEndDate",null),h([(0,t.MD)(),S("design:type",Function),S("design:paramtypes",[e]),S("design:returntype",Object)],i,"getExternalAccount",null),h([(0,t.MD)(),S("design:type",Function),S("design:paramtypes",[e]),S("design:returntype",void 0)],i,"isValidPaidSubscription",null),h([(0,t.MD)(),S("design:type",Function),S("design:paramtypes",[e]),S("design:returntype",void 0)],i,"getJoinDomains",null),h([(0,t.MD)(),S("design:type",Function),S("design:paramtypes",[e]),S("design:returntype",void 0)],i,"isZSpaceAccount",null),h([(0,t.MD)(),S("design:type",Function),S("design:paramtypes",[e]),S("design:returntype",Object)],i,"getOrganizationAddOns",null),i=h([(0,t.Uw)({name:"organizations",defaults:f}),S("design:paramtypes",[o.k,E.D,_.e,P.b])],i)},74988:(ge,F,n)=>{"use strict";n.d(F,{Av:()=>d,Bg:()=>_,Dx:()=>E,EC:()=>e,Fg:()=>c,P2:()=>m,Q2:()=>r,SJ:()=>y,Un:()=>h,aC:()=>u,gG:()=>S,ie:()=>f,jN:()=>a,t6:()=>i,w2:()=>b});var t=n(97443);const e={title:"Desktop",type:"desktop",dimensions:{width:700,height:550},orientation:"vertical"},r={title:"Standard Aspect Ratio (4:3)",type:"aspectRatio",dimensions:{width:4,height:3,type:t.M.Responsive},orientation:"horizontal"},o={title:"Widescreen Aspect Ratio (16:9)",type:"aspectRatio",dimensions:{width:16,height:9,type:t.M.Responsive},orientation:"horizontal"},C={title:"Square Aspect Ratio (1:1)",type:"aspectRatio",dimensions:{width:1,height:1,type:t.M.Responsive},orientation:"horizontal"},E={...r,title:"Custom"},y={width:320,height:256},d={width:5120,height:2880},_=[r,o,C],b={title:"Medium",type:"desktop",dimensions:{width:700,height:550},orientation:"horizontal"},u=[{title:"Small",type:"desktop",dimensions:{width:480,height:320},orientation:"horizontal"},b,{title:"Large",type:"desktop",dimensions:{width:1920,height:1200},orientation:"horizontal"},{title:"Extra Large",type:"desktop",dimensions:{width:2560,height:1440},orientation:"horizontal"},{title:"Maximum",type:"desktop",dimensions:{width:5120,height:2880},orientation:"horizontal"}],h=300,S={width:300,height:300},f={width:5120,height:2880},m={width:c(S.width),height:c(S.height)},i={width:c(f.width),height:c(f.height)};function c(l,p=h,A=2){return parseFloat((l/p).toFixed(A))}function a(l,p=h){return l*h}},35379:(ge,F,n)=>{"use strict";n.d(F,{K:()=>e,k:()=>t});var t=function(r){return r.Desktop="desktop",r.Tablet="tablet",r.Mobile="mobile",r}(t||{});const e={[t.Desktop]:"Desktop",[t.Tablet]:"iPad Pro 11",[t.Mobile]:"iPhone 8 Plus"}},56583:(ge,F,n)=>{"use strict";n.d(F,{$:()=>o});var t=n(28722),e=n(96557),r=n(47125);class o{constructor(){this.background={colors:null},this.uiAnnotations=!1,this.uiAudio=!0,this.uiMedia=t.Y.Full,this.uiInfo=!0,this.uiFullscreen=!0,this.uiScrubber=!1,this.uiHelp=!0,this.uiBd="",this.loadRotate=null,this.initial={button:!1,handHint:!1,play:!1,summary:!1},this.disableScroll={alert:!1,overlay:!1},this.uiQuiz={mode:r.R.Enabled,number:void 0},this.autoLoad=!0,this.playthrough=!1,this.uiTour=!1,this.uiNav=!0,this.uiSearch=!0,this.uiTools=!0,this.uiUndo=!0,this.uiLabelList=!0,this.uiChapterList=!1,this.all=!1,this.collapseLabel=null,this.uiMenu=!0,this.uiAnatomyDescriptions=!0,this.uiAnatomyPronunciations=!0,this.uiTutorial=!1,this.uiLegend=!0,this.uiLoader=e.kF,this.uiWhiteboard=!0,this.uiVisibilityLayers=!0,this.uiSkinLayers=!0,this.uiAnatomyLabels=!0}}},40430:(ge,F,n)=>{"use strict";n.d(F,{i:()=>P});var t=n(60177),e=n(65763),r=n(45189),o=n(21604),C=n(89417),E=n(68132),y=n(11562),d=n(9529),_=n(72026),v=n(54438);let b=(()=>{var s;class g{}return(s=g).\u0275fac=function(h){return new(h||s)},s.\u0275mod=v.$C({type:s}),s.\u0275inj=v.G2t({imports:[t.MD,r.G,_.o,C.YN,C.X1]}),g})(),P=(()=>{var s;class g{}return(s=g).\u0275fac=function(h){return new(h||s)},s.\u0275mod=v.$C({type:s}),s.\u0275inj=v.G2t({imports:[t.MD,r.G,C.X1,o.G,y.YG,d.bU,b,e.rK.forFeature([E.F])]}),g})()},16058:(ge,F,n)=>{"use strict";n.d(F,{D:()=>B,Q:()=>O});var t=n(15877),e=n(46104),r=n(3266),o=n(56583),C=n(36110),E=n(32914),y=n(28577),d=n(37678),v=n(21626),b=n(74988),P=n(49204),g=n(24418),u=n(12215),h=n(3287),S=n(47125),f=n(60177),m=n(65459),i=n(9632),c=n(4475),a=n(97443),l=n(54438),p=n(81642),A=n(95416),O=function(j){return j.Single="share.widget.link",j.Bulk="share.widget.export",j}(O||{});const L={headers:new v.Lr({"Content-Type":"application/json; charset=utf-8"})},k=new o.$,q={id:"embedded-human",dimensions:b.EC.dimensions,fullScreen:!0};let B=(()=>{var j;class V{constructor(N,W,$,ne,Q,le,pe,ie){this.http=N,this.cameraService=W,this.numberService=$,this.orgnanizationService=ne,this.contentViewService=Q,this.matSnackbar=le,this.APP_BASE_URL=pe,this.VIEWER_BASE_URL=ie}exportBookmarks(N,W,$,ne,Q,le,pe,ie,be=!1,de=""){this.matSnackbar.open(`Exporting ${N.length} models to CSV...`);const w=[{label:"Title",field:"title"},{label:"ID",field:"id"},{label:"Collection",field:"collection"},{label:"URL",field:"url"},{label:"iFrame",field:"iFrame"},{label:"Author",field:"author"},{label:"Thumbnail URL",field:"thumbnail_url"},{label:"Created Date",field:"create_date_time"},{label:"Updated Date",field:"update_date_time"}];be&&w.push({label:"Offline Package URL",field:"offline_url"});const te=ie?(0,t.of)(null):this.getUAID(O.Bulk),R=be?this.getDownloadURLs(N):(0,t.of)([]),D=new Map,T=$.length?(0,e.p)($.map(re=>this.orgnanizationService.getCollectionContent(W,re.collection_id,"",pe).pipe((0,C.T)(K=>{K.forEach(ae=>{D.set(ae.id,re)})})))):(0,t.of)(!0);return(0,e.p)([te,R,T]).pipe((0,C.T)(([re,K])=>N.map((ae,ce)=>{const{id:U,title:Z,author:z,thumbnail_url:H,create_date_time:J,update_date_time:Y}=ae,X=D.get(ae.id)?.collection_name??"",se=this.getWidgetURL(ae,ne,Q,null,re,pe,ie,de),oe=this.getWidgetEmbed(se,le),me=this.buildThumbnailURL(H),Se=K[ce]||"";return{title:Z,id:U,collection:X,url:se,iFrame:oe,author:z,thumbnail_url:me,create_date_time:(0,f.Yq)(new Date(J),"shortDate","en"),update_date_time:(0,f.Yq)(new Date(Y),"shortDate","en"),offline_url:Se}})),(0,E.n)(re=>(0,h.H)(re,w)),(0,E.n)(re=>{const ae=`BioDigital-Widgets-${(new Date).toISOString().split("T")[0]}-export.csv`,ce=new Blob([re],{type:"text/csv;charset=utf-8"});return(0,d.saveAs)(ce,ae),(0,t.of)(!0)}))}generateWidgetURL(N,W,$,ne,Q,le,pe,ie){const be=pe||!Q?(0,t.of)(null):this.getUAID(Q);return(0,e.p)([be,this.contentViewService.trackContentPublish(N.id,N.type)]).pipe((0,C.T)(([de])=>this.getWidgetURL(N,W,$,ne,de,le,pe,ie)))}getWidgetURL(N,W,$,ne,Q,le="en",pe,ie){$=$||k;const be="bookmark"===N.type,de={};de[be?"id":"m"]=`${be?N.id:N.module_name}`;const R={...de,...this.getParamsForUIOptions($||k),...this.getParamsForLoadingExperience($||k),...this.getParamsForScrollMode($||k),...this.getParamsForLoadRotate($||k),...this.getParamsForLabelScale($||k)},D=(0,P.get)($,"background.colors");if(Array.isArray(D)&&D.length>=3){const re=D.slice(0,4).map(K=>this.numberService.roundNumber(K,3));R["background.colors"]=`${re}`}if(ne){const{eye:re,look:K,up:ae}=this.cameraService.roundCamera(ne,3);R.camera=`${[re.x,re.y,re.z,K.x,K.y,K.z,ae.x,ae.y,ae.z]}`}pe?R.dk=pe.app_apikey:Q&&(R.uaid=Q),le&&"en"!==le&&(R.lang=le),ie&&(R.paid=ie);const T=this.isCustomWidget(N.embed_url_path)?N.embed_url_path:W;return this.buildWidgetURL(T,R)}generateWidgetEmbed(N,W,$,ne,Q,le,pe,ie,be){return this.generateWidgetURL(N,W,$,Q,le,pe,ie,be).pipe((0,C.T)(de=>this.getWidgetEmbed(de,ne)))}getWidgetEmbed(N,W){const{width:$,height:ne,type:Q}=W||q.dimensions;let le="";return le=Q===a.M.Responsive?`style="aspect-ratio: ${$} / ${ne}; width: 100%"`:`width="${$}" height="${ne}"`,`<iframe id="${q.id}" frameBorder="0" ${le} allowFullScreen="${q.fullScreen}" loading="lazy" src="${N}"></iframe>`}getImageEmbed(N,W,$){const ne=`BioDigital Human: ${N}`.replace(/"/g,"&quot;");return`<a href="${W}" target="_blank"><img src="${$}" alt="${ne}" title="${ne}" /></a>`}getUAID(N){return this.http.post("/ws/user/analytics",{analytic_type:`${N}`,analytic_platform:"app"},L).pipe((0,C.T)($=>$.id))}getDownloadURLs(N){const W=N.filter($=>!$.favorite&&!$.unavailable).map($=>({type:$.type,id:"module"===$.type?$.module_name:$.id}));return this.http.post("/ws/download/reserve",{content:W},{headers:{"Content-Type":"application/json"}}).pipe((0,C.T)($=>{const ne=$.tokens;return N.map(Q=>{const le=Q.type,pe="module"===Q.type?Q.module_name:Q.id,ie=ne.find(be=>be.type===le&&be.id===pe);return ie&&ie.token?this.buildDownloadURL(ie.token):""})}),(0,y.W)(()=>(0,t.of)(N.map(()=>""))))}extendWidgetOptions(N,W){const $=this.expandWidgetOptions(W);return this.deepExtendWidgetOptions(N,$),N}getWidgetConfig(N){const W={};return Object.keys(N).forEach(ne=>{const Q=N[ne];if(null!==Q){const le=this.getConfigName(ne);W[le]=Q}}),W}getConfigName(N){const $=this.camelToDashCase(N).replace(/^ui-/g,"");return this.dashCaseToCamelCase($)}getParamsForLoadingExperience(N){const W={};return N.autoLoad||(W["auto-load"]=!1),N.initial.button?W["initial.button"]=!0:N.initial.handHint?W["initial.hand"]=!0:N.initial.play?W["initial.play"]=!0:N.initial.summary?W["initial.summary"]=!0:W["initial.none"]=!0,N.playthrough&&(W.playthrough=!0),W}getParamsForScrollMode(N){return N.disableScroll.alert?{"disable-scroll.alert":!0}:N.disableScroll.overlay?{"disable-scroll":!0}:{"disable-scroll":!1}}getParamsForLoadRotate(N){return"number"==typeof N.loadRotate?{"load-rotate":N.loadRotate}:{}}getParamsForLabelScale(N){return{}}getParamsForUIOptions(N){return{"ui-anatomy-descriptions":N.uiAnatomyDescriptions,"ui-anatomy-pronunciations":N.uiAnatomyPronunciations,"ui-anatomy-labels":N.uiAnatomyLabels,"ui-audio":N.uiAudio,"ui-chapter-list":N.uiChapterList,"ui-fullscreen":N.uiFullscreen,"ui-help":N.uiHelp,"ui-info":N.uiInfo,"ui-label-list":N.uiLabelList,"ui-layers":N.uiVisibilityLayers,"ui-skin-layers":N.uiSkinLayers,"ui-loader":N.uiLoader,"ui-media-controls":N.uiMedia,"ui-menu":N.uiMenu,"ui-nav":N.uiNav,"ui-search":N.uiSearch,"ui-tools":N.uiTools,"ui-tutorial":N.uiTutorial,"ui-undo":N.uiUndo,"ui-whiteboard":N.uiWhiteboard,...this.getParamsForUIQuiz(N)}}getParamsForUIQuiz(N){const W={},$=(0,P.get)(N,"uiQuiz.mode"),ne=(0,P.get)(N,"uiQuiz.number");return $===S.R.Disabled&&(W["ui-quiz"]=!1),$===S.R.Locked&&(W["ui-quiz-locked"]=!0),(0,P.isNil)(ne)||(W["ui-quiz-start"]=ne,W["ui-quiz-end"]=ne),W}camelToDashCase(N){return N.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}dashCaseToCamelCase(N){return N.replace(/-([a-z])/g,W=>W[1].toUpperCase())}isCustomWidget(N){return/widgets\/([^\/]+)\//.test(N)}saveUserImage(N,W="jpeg"){return this.http.post("/ws/user/image/v1-0",{image_src:N,image_type:W},L).pipe((0,C.T)($=>$.url))}buildWidgetURL(N,W){const $=Object.entries(W).map(([Q,le])=>`${Q}=${le}`).join("&");let ne=N.replace(/^\/|\/$/g,"");return!1===W["auto-load"]&&"viewer"===ne&&(ne="tiny-viewer"),g.c.deploy===u.Z.Local?`${this.VIEWER_BASE_URL}/?${$}`:`${this.APP_BASE_URL}/${ne}/?${$}`}buildThumbnailURL(N){return`${this.APP_BASE_URL}${N}`}buildDownloadURL(N){return`${this.APP_BASE_URL}/download?t=${N}`}deepExtendWidgetOptions(N,W){Object.entries(N).forEach(([$,ne])=>{const Q=typeof ne;[$,this.camelToDashCase($),this.getConfigName($)].forEach(pe=>{if(W.hasOwnProperty(pe)&&null!==W[pe]){const ie=W[pe];null===ne?N[$]=ie:Q===typeof ie&&("object"===Q?this.deepExtendWidgetOptions(ne,ie):N[$]=ie)}})})}expandWidgetOptions(N){const W={};return Object.entries(N).forEach(([$,ne])=>{const Q=$.split(".");if(Q.length>1){const le=Q[0],pe=Q.slice(1).join(".");(null===W[le]||"object"!=typeof W[le])&&(W[le]={}),W[le][pe]=ne}else W[$]=N[$]}),W}}return(j=V).\u0275fac=function(N){return new(N||j)(l.KVO(v.Qq),l.KVO(r.j),l.KVO(p.D),l.KVO(m.k),l.KVO(c.K),l.KVO(A.UG),l.KVO(i.ar),l.KVO(i.jw))},j.\u0275prov=l.jDH({token:j,factory:j.\u0275fac,providedIn:"root"}),V})()},94528:(ge,F,n)=>{"use strict";n.d(F,{$A:()=>_,D4:()=>y,DU:()=>s,F0:()=>h,H:()=>b,Iz:()=>P,LD:()=>C,LI:()=>e,M:()=>d,PE:()=>t,SJ:()=>S,YJ:()=>g,_T:()=>E,id:()=>v,kS:()=>o,yX:()=>u});let t=(()=>{class m{constructor(c){this.widgetURL=c}}return m.type="[Publish] Set Widget URL",m})(),e=(()=>{class m{constructor(c){this.dimensions=c}}return m.type="[Publish] Set Dimensions",m})(),o=(()=>{class m{constructor(c,a,l,p){this.model=c,this.widgetOptions=a,this.camera=l,this.dimensions=p}}return m.type="[Publish] Get iFrame",m})(),C=(()=>{class m{constructor(c){this.embed=c}}return m.type="[Publish] Get iFrame Success",m})(),E=(()=>{class m{constructor(){}}return m.type="[Publish] Get iFrame Fail",m})(),y=(()=>{class m{constructor(c,a,l){this.model=c,this.widgetOptions=a,this.camera=l}}return m.type="[Publish] Get URL",m})(),d=(()=>{class m{constructor(c,a){this.model=c,this.url=a}}return m.type="[Publish] Get URL Success",m})(),_=(()=>{class m{constructor(c){this.model=c}}return m.type="[Publish] Get URL Fail",m})(),v=(()=>{class m{constructor(c){this.publishing=c}}return m.type="[Publish] Set Publishing",m})(),b=(()=>{class m{constructor(){}}return m.type="[Publish] Reset Publishing",m})(),P=(()=>{class m{constructor(c,a="jpeg"){this.imageData=c,this.imageType=a}}return m.type="[Publish] Save Publish Image",m})(),s=(()=>{class m{constructor(c){this.imageURL=c}}return m.type="[Publish] Save Publish Image Success",m})(),g=(()=>{class m{constructor(){}}return m.type="[Publish] Save Publish Image Fail",m})(),u=(()=>{class m{constructor(c,a,l,p,A){this.model=c,this.imageData=a,this.fileType=l,this.widgetOptions=p,this.camera=A}}return m.type="[Publish] Get Publish Image Code",m})(),h=(()=>{class m{constructor(c){this.embed=c}}return m.type="[Publish] Get Publish Image Code Success",m})(),S=(()=>{class m{constructor(){}}return m.type="[Publish] Get Publish Image Code Fail",m})()},68132:(ge,F,n)=>{"use strict";n.d(F,{F:()=>S,f:()=>h});var t=n(65763);class e{}var P,r=n(94528),o=n(16058),C=n(74988),E=n(16823),y=n(46104),d=n(95416),_=n(21424),v=n(59e3),b=n(54438),s=function(f,m,i,c){var p,a=arguments.length,l=a<3?m:null===c?c=Object.getOwnPropertyDescriptor(m,i):c;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(f,m,i,c);else for(var A=f.length-1;A>=0;A--)(p=f[A])&&(l=(a<3?p(l):a>3?p(m,i,l):p(m,i))||l);return a>3&&l&&Object.defineProperty(m,i,l),l},g=function(f,m){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(f,m)};const u="/viewer",h={publishing:!1,widgetURL:u,dimensions:C.EC.dimensions,minDimensions:{width:300,height:400},aspectRatio:{width:4,height:3}};let S=((P=class{static getDimensions(m){return m.dimensions}static getAspectRatio(m){return m.aspectRatio}static getMinDimensions(m){return m.minDimensions}static getWidgetURL(m){return m.widgetURL}static getPublishing(m){return m.publishing}setPublishWidgetURL(m,i){m.patchState({widgetURL:i.widgetURL||u})}setPublishDimensions(m,i){m.patchState({dimensions:i.dimensions})}getPublishURL(m,i){const{model:c,camera:a,widgetOptions:l}=i,{widgetURL:p}=m.getState(),A=this.store.selectSnapshot(E.k.getUserLanguage),O=this.store.selectSnapshot(E.k.getSelectedUserApp),L=this.store.selectSnapshot(_.q.getSelectedOrganizationProductAccountId);this.publishService.generateWidgetURL(c,p,l,a,o.Q.Single,A,O,L).subscribe(k=>{m.dispatch(new r.M(c,k))},()=>{m.dispatch(new r.$A(c))})}getPublishURLSuccess(m,i){this.vendorAnalyticsService.track("Publish - Success",{type:"url",source:"publish"})}getPublishURLFail(m,i){this.snackbar.open("Unable to generate URL.")}getPublishIFrame(m,i){const{model:c,camera:a,widgetOptions:l}=i,p=m.getState(),A=p.widgetURL,O=i.dimensions??p.dimensions,L=this.store.selectSnapshot(E.k.getUserLanguage),k=this.store.selectSnapshot(E.k.getSelectedUserApp),q=this.store.selectSnapshot(_.q.getSelectedOrganizationProductAccountId);this.publishService.generateWidgetEmbed(c,A,l,O,a,o.Q.Single,L,k,q).subscribe(B=>{m.dispatch(new r.LD(B))},()=>{m.dispatch(new r._T)})}setPublishIFrameSuccess(m,i){this.vendorAnalyticsService.track("Publish - Success",{type:"iframe",source:"publish"})}savePublishImage(m,{imageData:i,imageType:c}){this.publishService.saveUserImage(i,c).subscribe(a=>{m.dispatch(new r.DU(a))},()=>{m.dispatch(new r.YJ)})}savePublishImageSuccess(m,i){this.vendorAnalyticsService.track("Publish - Success",{type:"image",source:"publish"})}getPublishImage(m,i){const{model:c,camera:a,widgetOptions:l,imageData:p,fileType:A}=i,{widgetURL:O}=m.getState(),L=this.store.selectSnapshot(E.k.getUserLanguage),k=this.store.selectSnapshot(E.k.getSelectedUserApp);(0,y.p)(this.publishService.generateWidgetURL(c,O,l,a,o.Q.Single,L,k),this.publishService.saveUserImage(p,A)).subscribe(([q,B])=>{const j=this.publishService.getImageEmbed(c.title,q,B);m.dispatch(new r.F0(j))},()=>{m.dispatch(new r.SJ)})}setPublishing(m,{publishing:i}){m.patchState({publishing:i})}resetPublish(m,i){m.setState(h)}constructor(m,i,c,a){this.publishService=m,this.store=i,this.snackbar=c,this.vendorAnalyticsService=a}}).\u0275fac=function(m){return new(m||P)(b.KVO(o.D),b.KVO(t.il),b.KVO(d.UG),b.KVO(v.e))},P.\u0275prov=b.jDH({token:P,factory:P.\u0275fac}),P);s([(0,t.rc)(r.PE),g("design:type",Function),g("design:paramtypes",[Object,r.PE]),g("design:returntype",void 0)],S.prototype,"setPublishWidgetURL",null),s([(0,t.rc)(r.LI),g("design:type",Function),g("design:paramtypes",[Object,r.LI]),g("design:returntype",void 0)],S.prototype,"setPublishDimensions",null),s([(0,t.rc)(r.D4),g("design:type",Function),g("design:paramtypes",[Object,r.D4]),g("design:returntype",void 0)],S.prototype,"getPublishURL",null),s([(0,t.rc)(r.M),g("design:type",Function),g("design:paramtypes",[Object,r.M]),g("design:returntype",void 0)],S.prototype,"getPublishURLSuccess",null),s([(0,t.rc)(r.$A),g("design:type",Function),g("design:paramtypes",[Object,r.$A]),g("design:returntype",void 0)],S.prototype,"getPublishURLFail",null),s([(0,t.rc)(r.kS),g("design:type",Function),g("design:paramtypes",[Object,r.kS]),g("design:returntype",void 0)],S.prototype,"getPublishIFrame",null),s([(0,t.rc)(r.LD),g("design:type",Function),g("design:paramtypes",[Object,r.LD]),g("design:returntype",void 0)],S.prototype,"setPublishIFrameSuccess",null),s([(0,t.rc)(r.Iz),g("design:type",Function),g("design:paramtypes",[Object,r.Iz]),g("design:returntype",void 0)],S.prototype,"savePublishImage",null),s([(0,t.rc)(r.DU),g("design:type",Function),g("design:paramtypes",[Object,r.DU]),g("design:returntype",void 0)],S.prototype,"savePublishImageSuccess",null),s([(0,t.rc)(r.yX),g("design:type",Function),g("design:paramtypes",[Object,r.yX]),g("design:returntype",void 0)],S.prototype,"getPublishImage",null),s([(0,t.rc)(r.id),g("design:type",Function),g("design:paramtypes",[Object,r.id]),g("design:returntype",void 0)],S.prototype,"setPublishing",null),s([(0,t.rc)(r.H),g("design:type",Function),g("design:paramtypes",[Object,r.H]),g("design:returntype",void 0)],S.prototype,"resetPublish",null),s([(0,t.MD)(),g("design:type",Function),g("design:paramtypes",[e]),g("design:returntype",void 0)],S,"getDimensions",null),s([(0,t.MD)(),g("design:type",Function),g("design:paramtypes",[e]),g("design:returntype",void 0)],S,"getAspectRatio",null),s([(0,t.MD)(),g("design:type",Function),g("design:paramtypes",[e]),g("design:returntype",void 0)],S,"getMinDimensions",null),s([(0,t.MD)(),g("design:type",Function),g("design:paramtypes",[e]),g("design:returntype",void 0)],S,"getWidgetURL",null),s([(0,t.MD)(),g("design:type",Function),g("design:paramtypes",[e]),g("design:returntype",void 0)],S,"getPublishing",null),S=s([(0,t.Uw)({name:"publish",defaults:h}),g("design:paramtypes",[o.D,t.il,d.UG,v.e])],S)},76774:(ge,F,n)=>{"use strict";n.d(F,{Aw:()=>s,Br:()=>f,En:()=>_,Ie:()=>c,MH:()=>i,UB:()=>v,br:()=>P,qH:()=>d,tI:()=>b,z9:()=>g});var t=n(49204),r=n(59429),o=n(24151),C=n(69568),E=n(43753),y=n(65776);const d="Next Question";function _(l){const p=l.map(A=>(A.quizQuestions||[]).map(L=>({...L,chapterId:L.chapterId||A.id})));return[].concat(...p)}function v(l){const p={id:r.u.idWithPrefix("question"),chapterId:"",type:l,questionPrompt:[a()],data:{},explanation:[a()],nextLabel:"",showChapterLabels:!1,sceneConfig:{}};switch(l){case E.Q5.MultipleChoice:const A=[b(),b()];return{...p,data:{correctAnswer:A[0].value,options:A}};case E.Q5.SelectAnatomy:return{...p,data:{showAnswerList:!0,selectType:"all",correctAnswer:[]}};case E.Q5.LabelAnatomy:return{...p,data:{correctAnswer:[],options:[]}};case E.Q5.Instructions:return{...p}}}function b(l=""){return{value:r.u.idWithPrefix("question-option"),label:l}}function P(l){return{value:r.u.idWithPrefix("question-option"),label:l}}function s(l,p,A,O){const L=new C.e(p.label);L.id=r.u.idWithPrefix("quiz-label"),L.chapterId=l;const k=L.hideWire?20:32;return L.title=(0,t.trim)(p.label),L.offset=[k,0],L.objectId=A.objectId,L.barycentric=[A.barycentric[0],A.barycentric[1],A.barycentric[2]],L.pos=[A.worldPos[0],A.worldPos[1],A.worldPos[2]],L.primitiveIndex=A.triIndex,L.renderableIndex=A.renderableIndex||0,L.dir=O,L.occludable=!0,L.shown=!0,L.pinType=o.O.Sequential,L}function g(l,p,A){return{...l,id:p,chapterId:A,data:u(l.type,l.data,A)}}function u(l,p,A){return l===E.Q5.LabelAnatomy?function h(l,p){return{...l,options:l.options.map(A=>({...A,label:{...A.label,chapterId:p}}))}}(p,A):(0,t.cloneDeep)(p)}function S(l){return"string"==typeof l.data.correctAnswer?[l.data.correctAnswer]:l.data.correctAnswer}function f(l,p){const A=S(l);switch(l.type){case E.Q5.LabelAnatomy:return(0,t.isEqual)(A,p);case E.Q5.MultipleChoice:return(0,t.isEqual)(A.sort(),p.sort());case E.Q5.SelectAnatomy:if(void 0===l.data.selectType||"all"===l.data.selectType)return(0,t.isEqual)(A.sort(),p.sort());if("any"===l.data.selectType)return 0===(0,t.difference)(p,A).length&&p.length>0}}function i(l,p){const A=l.filter(N=>N.type!==E.Q5.Instructions),O=l.reduce((N,W)=>(N[W.id]=function m(l,p){const A=l.find(O=>O.questionId===p);return A?A.answer:void 0}(p,W.id),N),{}),L=l.reduce((N,W)=>(N[W.id]=S(W),N),{}),k=A.filter(N=>{const W=O[N.id];return f(N,typeof W>"u"?[]:"string"==typeof W?[W]:W)}),q=l.length,B=A.length,j=k.length,V=q-j;return{score:q>0?Math.round(j/B*100):0,total:q,scorableTotal:B,correctTotal:j,incorrectTotal:V,questionAnswers:O,correctQuestionAnswers:L}}function c(l){switch((0,t.get)(l,"type","")){case E.Q5.MultipleChoice:const A=(0,t.get)(l,"data.correctAnswer","");return A&&""!==A;case E.Q5.SelectAnatomy:case E.Q5.LabelAnatomy:return(0,t.get)(l,"data.correctAnswer",[]).length>0;default:return!0}}function a(l=""){return{type:y.m.Markdown,markdown:l}}},24552:(ge,F,n)=>{"use strict";n.d(F,{h:()=>t});var t=function(e){return e[e.Question=0]="Question",e[e.Explanation=1]="Explanation",e[e.Review=2]="Review",e}(t||{})},43753:(ge,F,n)=>{"use strict";n.d(F,{Q5:()=>t,of:()=>e,sb:()=>r});var t=function(o){return o.MultipleChoice="multiple-choice",o.SelectAnatomy="select-anatomy",o.LabelAnatomy="label-anatomy",o.Instructions="text-only",o}(t||{});const e={[t.MultipleChoice]:"Multiple Choice",[t.SelectAnatomy]:"Select Anatomy in 3D",[t.LabelAnatomy]:"Label Anatomy",[t.Instructions]:"Instructions"},r={[t.MultipleChoice]:"Identify the correct answer from a list of options.",[t.SelectAnatomy]:"Identify the correct structure(s) in the 3D model",[t.LabelAnatomy]:"Correctly label each structure from a list of options",[t.Instructions]:"Use descriptive text to provide context between questions"}},42617:(ge,F,n)=>{"use strict";n.d(F,{c:()=>y});var t=n(60177),e=n(65763),r=n(87710),o=n(89417),C=n(72026),E=n(54438);let y=(()=>{var d;class _{}return(d=_).\u0275fac=function(b){return new(b||d)},d.\u0275mod=E.$C({type:d}),d.\u0275inj=E.G2t({imports:[e.rK.forFeature([r.j]),t.MD,C.o,o.X1]}),_})()},76016:(ge,F,n)=>{"use strict";var t,e;n.d(F,{B:()=>t}),(e=t||(t={})).SetQuizState=(()=>{class p{constructor(O){this.quizState=O}}return p.type="[Quiz] Set Quiz State",p})(),e.ResetQuizState=(()=>{class p{constructor(){}}return p.type="[Quiz] Reset Quiz State",p})(),e.SetQuizSettings=(()=>{class p{constructor(O){this.quizSettings=O}}return p.type="[Quiz] Set Quiz Settings",p})(),e.SetQuizActive=(()=>{class p{constructor(O){this.active=O}}return p.type="[Quiz] Set Quiz Active",p})(),e.SetQuizLocked=(()=>{class p{constructor(O){this.locked=O}}return p.type="[Quiz] Set Quiz Locked",p})(),e.SetEnableQuizRetake=(()=>{class p{constructor(O){this.enable=O}}return p.type="[Quiz] Set Enable Quiz Retake",p})(),e.SetQuizQuestionsMode=(()=>{class p{constructor(O){this.mode=O}}return p.type="[Quiz] Set Quiz Questions Mode",p})(),e.ReorderQuestions=(()=>{class p{constructor(O){this.chapterIds=O}}return p.type="[Quiz] Reoder Quiz Questions",p})(),e.AddQuestion=(()=>{class p{constructor(O){this.question=O}}return p.type="[Quiz] Add Quiz Question",p})(),e.SetQuestions=(()=>{class p{constructor(O){this.questions=O}}return p.type="[Quiz] Set Quiz Questions",p})(),e.RemoveQuestions=(()=>{class p{constructor(O){this.questionIds=O}}return p.type="[Quiz] Remove Quiz Questions",p})(),e.SetQuestion=(()=>{class p{constructor(O){this.question=O}}return p.type="[Quiz] Set Quiz Question",p})(),e.SubmitQuestionAnswer=(()=>{class p{constructor(O){this.submission=O}}return p.type="[Quiz] Submit Question Answer",p})(),e.NextQuestion=(()=>{class p{constructor(){}}return p.type="[Quiz] Advance Question",p})(),e.PreviousQuestion=(()=>{class p{constructor(){}}return p.type="[Quiz] Previous Question",p})(),e.ClearSubmissions=(()=>{class p{constructor(){}}return p.type="[Quiz] Clear Submissions",p})(),e.SetActiveQuestion=(()=>{class p{constructor(O){this.questionId=O}}return p.type="[Quiz] Set Active Question",p})(),e.SetQuizPickMode=(()=>{class p{constructor(O){this.pickMode=O}}return p.type="[Quiz] Set Pick Mode",p})(),e.SetActiveSubmission=(()=>{class p{constructor(O){this.submission=O}}return p.type="[Quiz] Set Active QuestionAnswer",p})(),e.SetQuizLifecycle=(()=>{class p{constructor(O){this.lifecycle=O}}return p.type="[Quiz] Set Quiz Lifecycle",p})()},87710:(ge,F,n)=>{"use strict";n.d(F,{W:()=>b,j:()=>f});var y,v,t=n(65763),e=n(76016),r=n(76774),o=n(43753),C=n(24552),E=n(54438),d=function(m,i,c,a){var A,l=arguments.length,p=l<3?i:null===a?a=Object.getOwnPropertyDescriptor(i,c):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)p=Reflect.decorate(m,i,c,a);else for(var O=m.length-1;O>=0;O--)(A=m[O])&&(p=(l<3?A(p):l>3?A(i,c,p):A(i,c))||p);return l>3&&p&&Object.defineProperty(i,c,p),p},_=function(m,i){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(m,i)},b=function(m){return m[m.Learning=0]="Learning",m[m.Assessment=1]="Assessment",m}(b||{});const s={quizModeActive:!1,quizModeLocked:!1,quizQuestionsMode:"all",enableQuizRetake:!0,launchMode:b.Learning,questions:[],activeQuestionId:void 0,activeSubmission:void 0,questionSubmissions:[],quizSettings:{enabled:!0,showSummary:!0,showExplanation:!0,showSubmit:!0,showProgress:!0},pickMode:"single",lifecycle:C.h.Question};function g(m,i){return m.filter(c=>c.chapterId===i)}function h(m,i){const c=i.map(l=>g(m,l));return[].concat(...c)}function S(m){const i=function u(m){return[...new Set(m.map(i=>i.chapterId))]}(m);return h(m,i)}let f=(v=y=class{static getQuizQuestionsByChapter(i){return(0,t.Mz)([v],c=>g(c.questions,i))}static getLifecycle(i){return i.lifecycle}static getQuizSettings(i){return i.quizSettings}static getQuizModeActive(i){return i.quizModeActive}static getQuizModeLocked(i){return i.quizModeLocked}static getEnableQuizRetake(i){return i.enableQuizRetake}static getQuizReviewEnabled(i){const{quizModeLocked:c,quizQuestionsMode:a,questions:l,quizSettings:p}=i;return!(c&&!p.showSummary||c&&"restricted"===a&&1===l.length)}static globalSceneConfig(i){return i.sceneConfig}static hasQuiz(i){return i.questions.length>0}static getQuizEnabled(i){return!1!==i.quizSettings.enabled}static getAllQuestions(i){return i.questions}static getAllSubmissions(i){return i.questionSubmissions}static getActiveSubmitted(i){const{questionSubmissions:c,activeQuestionId:a}=i;return c.find(l=>l.questionId===a)}static getActiveSubmission(i){return i.activeSubmission}static getActiveQuestion(i){return i.questions.find(c=>c.id===i.activeQuestionId)}static getActiveQuestionId(i){return i.activeQuestionId}static getActiveQuestionLabels(i){const c=i.questions.find(a=>a.id===i.activeQuestionId);return c&&c.type===o.Q5.LabelAnatomy?c.data.options:[]}static getActiveQuestionIndex(i){return i.questions.findIndex(c=>c.id===i.activeQuestionId)}static getQuestionIndex(i,c){return(0,t.Mz)([v],a=>h(a.questions,i).findIndex(l=>l.id===c))}static getQuestionTotal(i){return i.questions.length}static getCorrectAnswerTotal(i){const{questionSubmissions:c,questions:a}=i;return c.filter(p=>{const A=a.find(O=>O.id===p.questionId);return(0,r.Br)(A,p.answer)}).length}static getQuestionsRemaining(i){const{questions:c,questionSubmissions:a}=i;return c.length-a.length}static hasQuestionRemaining(i){const{questions:c,questionSubmissions:a}=i;return a.length<c.length}static getPickMode(i){return i.pickMode}resetQuizState(i,c){i.setState({...s})}setQuizState(i,{quizState:c}){i.setState({...s,...c})}setQuizSettings(i,{quizSettings:c}){i.patchState({quizSettings:c})}setQuizActive(i,c){i.patchState({quizModeActive:c.active,activeQuestionId:!1===c.active?void 0:i.getState().activeQuestionId})}setQuizLocked(i,c){i.patchState({quizModeLocked:c.locked})}setEnableQuizRetake(i,c){i.patchState({enableQuizRetake:c.enable})}setQuizQuestionsMode(i,c){i.patchState({quizQuestionsMode:c.mode})}reorderQuestions(i,{chapterIds:c}){i.patchState({questions:h(i.getState().questions,c)})}addQuestion(i,c){const a=[...i.getState().questions,c.question];i.patchState({questions:S(a)})}setQuestions(i,{questions:c}){i.patchState({questions:S(c)})}setQuestion(i,c){const a=i.getState().questions.map(l=>l.id===c.question.id?c.question:l);i.patchState({questions:a})}removeQuestions(i,c){const a=i.getState(),l=null!=c.questionIds?c.questionIds:a.questions.map(A=>A.id),p=a.questions.filter(A=>!l.includes(A.id));i.patchState({questions:S(p)})}submitQuestionAnswer(i,c){const a=[...i.getState().questionSubmissions],l=a.findIndex(A=>A.questionId===c.submission.questionId);l>-1?a[l]=c.submission:a.push(c.submission),i.patchState({questionSubmissions:a})}nextQuestion(i){const{questions:c,activeQuestionId:a}=i.getState(),l=i.getState().questions.findIndex(A=>A.id===a),p=c[l+1]?.id||void 0;void 0!==p&&i.patchState({activeQuestionId:p})}previousQuestion(i){const{questions:c,activeQuestionId:a}=i.getState(),l=i.getState().questions.findIndex(A=>A.id===a),p=c[l-1]?.id||void 0;void 0!==p&&i.patchState({activeQuestionId:p})}clearSubmissions(i){i.patchState({questionSubmissions:[]})}setActiveQuestion(i,c){i.patchState({activeQuestionId:c.questionId})}setQuizPickMode(i,{pickMode:c}){i.patchState({pickMode:c})}setActiveSubmission(i,{submission:c}){i.patchState({activeSubmission:c})}setQuizLifecycle(i,c){i.patchState({lifecycle:c.lifecycle})}},y.\u0275fac=function(i){return new(i||y)},y.\u0275prov=E.jDH({token:y,factory:y.\u0275fac}),y);d([(0,t.rc)(e.B.ResetQuizState),_("design:type",Function),_("design:paramtypes",[Object,e.B.ResetQuizState]),_("design:returntype",void 0)],f.prototype,"resetQuizState",null),d([(0,t.rc)(e.B.SetQuizState),_("design:type",Function),_("design:paramtypes",[Object,e.B.SetQuizState]),_("design:returntype",void 0)],f.prototype,"setQuizState",null),d([(0,t.rc)(e.B.SetQuizSettings),_("design:type",Function),_("design:paramtypes",[Object,e.B.SetQuizSettings]),_("design:returntype",void 0)],f.prototype,"setQuizSettings",null),d([(0,t.rc)(e.B.SetQuizActive),_("design:type",Function),_("design:paramtypes",[Object,e.B.SetQuizActive]),_("design:returntype",void 0)],f.prototype,"setQuizActive",null),d([(0,t.rc)(e.B.SetQuizLocked),_("design:type",Function),_("design:paramtypes",[Object,e.B.SetQuizLocked]),_("design:returntype",void 0)],f.prototype,"setQuizLocked",null),d([(0,t.rc)(e.B.SetEnableQuizRetake),_("design:type",Function),_("design:paramtypes",[Object,e.B.SetEnableQuizRetake]),_("design:returntype",void 0)],f.prototype,"setEnableQuizRetake",null),d([(0,t.rc)(e.B.SetQuizQuestionsMode),_("design:type",Function),_("design:paramtypes",[Object,e.B.SetQuizQuestionsMode]),_("design:returntype",void 0)],f.prototype,"setQuizQuestionsMode",null),d([(0,t.rc)(e.B.ReorderQuestions),_("design:type",Function),_("design:paramtypes",[Object,e.B.ReorderQuestions]),_("design:returntype",void 0)],f.prototype,"reorderQuestions",null),d([(0,t.rc)(e.B.AddQuestion),_("design:type",Function),_("design:paramtypes",[Object,e.B.AddQuestion]),_("design:returntype",void 0)],f.prototype,"addQuestion",null),d([(0,t.rc)(e.B.SetQuestions),_("design:type",Function),_("design:paramtypes",[Object,e.B.SetQuestions]),_("design:returntype",void 0)],f.prototype,"setQuestions",null),d([(0,t.rc)(e.B.SetQuestion),_("design:type",Function),_("design:paramtypes",[Object,e.B.SetQuestion]),_("design:returntype",void 0)],f.prototype,"setQuestion",null),d([(0,t.rc)(e.B.RemoveQuestions),_("design:type",Function),_("design:paramtypes",[Object,e.B.RemoveQuestions]),_("design:returntype",void 0)],f.prototype,"removeQuestions",null),d([(0,t.rc)(e.B.SubmitQuestionAnswer),_("design:type",Function),_("design:paramtypes",[Object,e.B.SubmitQuestionAnswer]),_("design:returntype",void 0)],f.prototype,"submitQuestionAnswer",null),d([(0,t.rc)(e.B.NextQuestion),_("design:type",Function),_("design:paramtypes",[Object]),_("design:returntype",void 0)],f.prototype,"nextQuestion",null),d([(0,t.rc)(e.B.PreviousQuestion),_("design:type",Function),_("design:paramtypes",[Object]),_("design:returntype",void 0)],f.prototype,"previousQuestion",null),d([(0,t.rc)(e.B.ClearSubmissions),_("design:type",Function),_("design:paramtypes",[Object]),_("design:returntype",void 0)],f.prototype,"clearSubmissions",null),d([(0,t.rc)(e.B.SetActiveQuestion),_("design:type",Function),_("design:paramtypes",[Object,e.B.SetActiveQuestion]),_("design:returntype",void 0)],f.prototype,"setActiveQuestion",null),d([(0,t.rc)(e.B.SetQuizPickMode),_("design:type",Function),_("design:paramtypes",[Object,e.B.SetQuizPickMode]),_("design:returntype",void 0)],f.prototype,"setQuizPickMode",null),d([(0,t.rc)(e.B.SetActiveSubmission),_("design:type",Function),_("design:paramtypes",[Object,e.B.SetActiveSubmission]),_("design:returntype",void 0)],f.prototype,"setActiveSubmission",null),d([(0,t.rc)(e.B.SetQuizLifecycle),_("design:type",Function),_("design:paramtypes",[Object,e.B.SetQuizLifecycle]),_("design:returntype",void 0)],f.prototype,"setQuizLifecycle",null),d([(0,t.MD)(),_("design:type",Function),_("design:paramtypes",[Object]),_("design:returntype",void 0)],f,"getLifecycle",null),d([(0,t.MD)(),_("design:type",Function),_("design:paramtypes",[Object]),_("design:returntype",Object)],f,"getQuizSettings",null),d([(0,t.MD)(),_("design:type",Function),_("design:paramtypes",[Object]),_("design:returntype",void 0)],f,"getQuizModeActive",null),d([(0,t.MD)(),_("design:type",Function),_("design:paramtypes",[Object]),_("design:returntype",void 0)],f,"getQuizModeLocked",null),d([(0,t.MD)(),_("design:type",Function),_("design:paramtypes",[Object]),_("design:returntype",void 0)],f,"getEnableQuizRetake",null),d([(0,t.MD)(),_("design:type",Function),_("design:paramtypes",[Object]),_("design:returntype",Boolean)],f,"getQuizReviewEnabled",null),d([(0,t.MD)(),_("design:type",Function),_("design:paramtypes",[Object]),_("design:returntype",void 0)],f,"globalSceneConfig",null),d([(0,t.MD)(),_("design:type",Function),_("design:paramtypes",[Object]),_("design:returntype",void 0)],f,"hasQuiz",null),d([(0,t.MD)(),_("design:type",Function),_("design:paramtypes",[Object]),_("design:returntype",void 0)],f,"getQuizEnabled",null),d([(0,t.MD)(),_("design:type",Function),_("design:paramtypes",[Object]),_("design:returntype",void 0)],f,"getAllQuestions",null),d([(0,t.MD)(),_("design:type",Function),_("design:paramtypes",[Object]),_("design:returntype",void 0)],f,"getAllSubmissions",null),d([(0,t.MD)(),_("design:type",Function),_("design:paramtypes",[Object]),_("design:returntype",void 0)],f,"getActiveSubmitted",null),d([(0,t.MD)(),_("design:type",Function),_("design:paramtypes",[Object]),_("design:returntype",void 0)],f,"getActiveSubmission",null),d([(0,t.MD)(),_("design:type",Function),_("design:paramtypes",[Object]),_("design:returntype",void 0)],f,"getActiveQuestion",null),d([(0,t.MD)(),_("design:type",Function),_("design:paramtypes",[Object]),_("design:returntype",void 0)],f,"getActiveQuestionId",null),d([(0,t.MD)(),_("design:type",Function),_("design:paramtypes",[Object]),_("design:returntype",Array)],f,"getActiveQuestionLabels",null),d([(0,t.MD)(),_("design:type",Function),_("design:paramtypes",[Object]),_("design:returntype",void 0)],f,"getActiveQuestionIndex",null),d([(0,t.MD)(),_("design:type",Function),_("design:paramtypes",[Object]),_("design:returntype",void 0)],f,"getQuestionTotal",null),d([(0,t.MD)(),_("design:type",Function),_("design:paramtypes",[Object]),_("design:returntype",void 0)],f,"getCorrectAnswerTotal",null),d([(0,t.MD)(),_("design:type",Function),_("design:paramtypes",[Object]),_("design:returntype",void 0)],f,"getQuestionsRemaining",null),d([(0,t.MD)(),_("design:type",Function),_("design:paramtypes",[Object]),_("design:returntype",void 0)],f,"hasQuestionRemaining",null),d([(0,t.MD)(),_("design:type",Function),_("design:paramtypes",[Object]),_("design:returntype",void 0)],f,"getPickMode",null),f=v=d([(0,t.Uw)({name:"quiz",defaults:s})],f)},71120:(ge,F,n)=>{"use strict";n.d(F,{D:()=>E});var t=function(y){return y.Facebook="facebook",y.LinkedIn="linkedin",y.Twitter="twitter",y}(t||{}),e=n(9632),r=function(y){return y.Model="model",y.Quiz="quiz",y}(r||{}),o=n(54438),C=n(21626);let E=(()=>{var y;class d{constructor(v,b){this.http=v,this.APP_BASE_URL=b}shareEmailLink(v){return this.http.post("/ws/user/share/email",v)}generateShareLink(v,b="en"){const P=v.thumbnail_url.replace("/small/","/large/");return{type:v.quiz?r.Quiz:r.Model,title:v.title,relativeUrl:this.createShareUrl(v,"share",b,!1,!1),fullUrl:this.createShareUrl(v,"share",b,!0,!1),thumbUrl:P,social:[{type:t.Facebook,url:`https://www.facebook.com/sharer/sharer.php?u=${this.createShareUrl(v,t.Facebook,b,!0,!0)}`},{type:t.LinkedIn,url:`https://www.linkedin.com/sharing/share-offsite/?url=${this.createShareUrl(v,t.LinkedIn,b,!0,!0)}`},{type:t.Twitter,url:`http://twitter.com/share?url=${this.createShareUrl(v,t.Twitter,b,!0,!0)}`}]}}createShareUrl(v,b,P,s,g){const u=v.id.replace(".json",""),h=Object.values(t).includes(b),f=`/view?id=${u}&lang=${P}&ref=${b}`,m=s||h?`${h?"https://human.biodigital.com":this.APP_BASE_URL}${f}`:f;return g?encodeURIComponent(m):m}}return(y=d).\u0275fac=function(v){return new(v||y)(o.KVO(C.Qq),o.KVO(e.ar))},y.\u0275prov=o.jDH({token:y,factory:y.\u0275fac,providedIn:"root"}),d})()},17192:(ge,F,n)=>{"use strict";n.d(F,{Cg:()=>e,Km:()=>o,Rr:()=>t,zq:()=>r});let t=(()=>{class E{constructor(){}}return E.type="[Share] Reset",E})(),e=(()=>{class E{constructor(d){this.shareEmail=d}}return E.type="[Share] Share Email Link",E})(),r=(()=>{class E{constructor(d){this.shareEmail=d}}return E.type="[Share] Share Email Link Success",E})(),o=(()=>{class E{constructor(d){this.error=d}}return E.type="[Share] Share Email Link Fail",E})()},9940:(ge,F,n)=>{"use strict";n.d(F,{D:()=>h});var P,t=n(65763),e=n(71263),r=n(11756),o=n(15152),C=n(38165),E=n(5690),d=n(17192),_=n(71120),v=n(50262),b=n(54438),s=function(S,f,m,i){var l,c=arguments.length,a=c<3?f:null===i?i=Object.getOwnPropertyDescriptor(f,m):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(S,f,m,i);else for(var p=S.length-1;p>=0;p--)(l=S[p])&&(a=(c<3?l(a):c>3?l(f,m,a):l(f,m))||a);return c>3&&a&&Object.defineProperty(f,m,a),a},g=function(S,f){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(S,f)};const u={sharing:!1};let h=((P=class{static getSharing(f){return f.sharing}resetShare(f,m){f.setState(u)}sendEmail(f,{shareEmail:m}){f.patchState({sharing:!0}),this.authService.verifyIsHuman("share_email").pipe((0,r.Z)(({isHuman:i,verification:c})=>{if(!i)throw new v.s;return this.shareService.shareEmailLink({version:4,app_productkey:this.productService.productKey,app_producttype:this.productService.productType,site_verify_response:c,...m})}),(0,o.j)(()=>f.patchState({sharing:!1}))).subscribe({next:()=>{f.dispatch(new d.zq(m))},error:i=>{i instanceof v.s&&f.dispatch(new C.sz(i)),f.dispatch(new d.Km(i))}})}constructor(f,m,i){this.shareService=f,this.productService=m,this.authService=i}}).\u0275fac=function(f){return new(f||P)(b.KVO(_.D),b.KVO(E.b),b.KVO(e.u))},P.\u0275prov=b.jDH({token:P,factory:P.\u0275fac}),P);s([(0,t.rc)(d.Rr),g("design:type",Function),g("design:paramtypes",[Object,d.Rr]),g("design:returntype",void 0)],h.prototype,"resetShare",null),s([(0,t.rc)(d.Cg),g("design:type",Function),g("design:paramtypes",[Object,d.Cg]),g("design:returntype",void 0)],h.prototype,"sendEmail",null),s([(0,t.MD)(),g("design:type",Function),g("design:paramtypes",[class y{}]),g("design:returntype",void 0)],h,"getSharing",null),h=s([(0,t.Uw)({name:"share",defaults:u}),g("design:paramtypes",[_.D,E.b,e.u])],h)},65881:(ge,F,n)=>{"use strict";n.d(F,{G:()=>r,S:()=>e});var t=n(59429);function e(o,C){return o.reduce((E,y)=>(E[y.id]=!0===C?r():y.id,E),{})}function r(){return t.u.idWithPrefix("chapter")}},4951:(ge,F,n)=>{"use strict";n.d(F,{W:()=>d});var t=n(2573),e=n(15877),r=n(24418),o=n(92811),C=n(65294),E=n(54438),y=n(83621);let d=(()=>{var _;class v{constructor(P){this.applicationEventService=P}getClipboardAPISupport(){return"clipboard"in navigator}getClipboardAPI(){return navigator.clipboard}nativeShareLink(P){(!0===r.c.native||r.c.platform===o.N.SDK)&&this.applicationEventService.fireEvent(C.F.NativeShare,{type:"shareLinkModel",value:JSON.stringify(P)})}copyToClipboard(P,s){if(!0===r.c.native||r.c.platform===o.N.SDK)return new t.c(g=>{this.applicationEventService.fireEvent(C.F.NativeShare,{type:s,value:P}),g.next(!0),g.complete()});if(this.getClipboardAPISupport()){const g=this.getClipboardAPI();return new t.c(u=>{g.writeText(P).then(()=>{u.next(!0),u.complete()}).catch(h=>{u.next(!1),u.complete()})})}return(0,e.of)(!1)}copyInputFieldValue(P){P.select();let s=!1;try{s=document.execCommand("copy")}catch{s=!1}return s}}return(_=v).\u0275fac=function(P){return new(P||_)(E.KVO(y.S))},_.\u0275prov=E.jDH({token:_,factory:_.\u0275fac,providedIn:"root"}),v})()},90908:(ge,F,n)=>{"use strict";function t(){const C=document.createElement("canvas"),E=C.getContext("webgl")||C.getContext("experimental-webgl"),y=E instanceof WebGLRenderingContext;return y&&E.getExtension("WEBGL_lose_context")?.loseContext(),y}function e(){return window.matchMedia("(hover: hover)").matches}function r(){return"ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0}function o(){return"scrollBehavior"in document.documentElement.style}n.d(F,{MN:()=>t,ZO:()=>e,uK:()=>o,yd:()=>r})},93547:(ge,F,n)=>{"use strict";n.d(F,{C:()=>C});var t=n(54438),e=n(60177);const r=["*"];var o=function(E){return E.Danger="danger",E.Info="info",E}(o||{});let C=(()=>{var E;class y{constructor(){this.type=o.Info,this.theme="dark"}ngOnInit(){}}return(E=y).\u0275fac=function(_){return new(_||E)},E.\u0275cmp=t.VBU({type:E,selectors:[["app-alert"]],inputs:{type:"type",theme:"theme"},ngContentSelectors:r,decls:2,vars:5,consts:[[1,"app-alert",3,"ngClass"]],template:function(_,v){1&_&&(t.NAR(),t.j41(0,"div",0),t.SdG(1),t.k0s()),2&_&&(t.AVh("app-alert--dark","dark"===v.theme)("app-alert--light","light"===v.theme),t.Y8G("ngClass","app-alert--"+v.type))},dependencies:[e.YU],styles:[":host{display:block}.app-alert{border-radius:4px;padding:16px;font-size:.75rem;line-height:1rem}.app-alert--info{background:#2d90dc26}.app-alert--danger{background:#de353526}.app-alert--light{color:#1c2a3f}.app-alert--light a,.app-alert--light a:visited{color:#283853}.app-alert--dark{color:#f9fafd}.app-alert--dark a,.app-alert--dark a:visited{color:#fff}\n"],encapsulation:2,changeDetection:0}),y})()},21007:(ge,F,n)=>{"use strict";n.d(F,{Q:()=>b});var t=n(54438),e=n(82542);const r=["app-button",""],o=["*"],E={[e.P.Light]:{default:"text-gray-800 hover:bg-gray-900/10",flat:"text-gray-700 bg-gray-200 hover:text-black",outline:"border border-solid border-gray-300 text-gray-800 hover:bg-gray-900/10 text-gray-900",primary:"bg-red-700 text-white hover:bg-red-600",info:"bg-blue-600 text-white hover:bg-blue-500",text:"text-gray-900 hover:text-gray-800"},[e.P.Dark]:{default:"text-gray-200 hover:bg-gray-800",flat:"bg-gray-700 hover:bg-gray-600",outline:"border border-solid border-gray-600 text-gray-200 hover:bg-white/10 hover:text-white",primary:"bg-red-700 text-white hover:bg-red-600",info:"bg-blue-600 text-white hover:bg-blue-500",text:"text-gray-500"}},y={default:"rounded px-4",rounded:"rounded-3xl px-4",circle:"rounded-full",square:"rounded"},d={"2xs":"h-5",xs:"h-6",sm:"h-8",md:"h-9",lg:"h-11",xl:"h-12"},_={"2xs":"w-5",xs:"w-6",sm:"w-8",md:"w-9",lg:"w-11",xl:"w-12"},v={"2xs":"text-2xs",xs:"text-2xs",sm:"text-xs",md:"text-xs",lg:"text-sm",xl:"text-sm"};let b=(()=>{var P;class s{constructor(){this.buttonSize=(0,t.hFB)("md"),this.buttonType=(0,t.hFB)("default"),this.buttonTheme=(0,t.hFB)(e.P.Dark),this.buttonShape=(0,t.hFB)("default"),this.buttonAlign=(0,t.hFB)("center"),this.uppercase=(0,t.hFB)(!0),this.disabled=(0,t.hFB)(!1),this.classes=(0,t.EWP)(()=>{const u=[];switch(u.push("flex items-center justify-center font-sans transition-colors"),u.push(this.disabled()?"opacity-50":"cursor-pointer"),this.uppercase()&&u.push("uppercase"),u.push("left"===this.buttonAlign()?"text-left":"text-center"),u.push(E[this.buttonTheme()][this.buttonType()]),u.push(d[this.buttonSize()]),u.push(v[this.buttonSize()]),u.push(y[this.buttonShape()]),this.buttonShape()){case"circle":case"square":u.push(_[this.buttonSize()])}return u.join(" ")})}get hostDisabled(){return this.disabled()}get hostButtonType(){return this.buttonType()}}return(P=s).\u0275fac=function(u){return new(u||P)},P.\u0275cmp=t.VBU({type:P,selectors:[["button","app-button",""],["a","app-button",""]],hostVars:2,hostBindings:function(u,h){2&u&&(t.Mr5("disabled",h.hostDisabled),t.BMQ("data-button-type",h.hostButtonType))},inputs:{buttonSize:[t.Mj6.SignalBased,"buttonSize"],buttonType:[t.Mj6.SignalBased,"buttonType"],buttonTheme:[t.Mj6.SignalBased,"buttonTheme"],buttonShape:[t.Mj6.SignalBased,"buttonShape"],buttonAlign:[t.Mj6.SignalBased,"buttonAlign"],uppercase:[t.Mj6.SignalBased,"uppercase"],disabled:[t.Mj6.SignalBased,"disabled"]},attrs:r,ngContentSelectors:o,decls:2,vars:2,template:function(u,h){1&u&&(t.NAR(),t.j41(0,"span"),t.SdG(1),t.k0s()),2&u&&t.HbH(h.classes())},styles:["a[app-button],button[app-button]{border-color:transparent;background:none;border-width:0;padding:0;border-radius:4px;outline:0 none}a[app-button]:focus,button[app-button]:focus{--tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(3px + var(--tw-ring-offset-width)) var(--tw-ring-color);--tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow, 0 0 #0000);--tw-ring-opacity: 1;--tw-ring-color: rgb(45 114 220 / var(--tw-ring-opacity))}a[app-button][buttonshape=circle],a[app-button][ng-reflect-button-shape=circle],button[app-button][buttonshape=circle],button[app-button][ng-reflect-button-shape=circle]{border-radius:.25rem;border-radius:9999px}a[app-button]:not([disabled]):hover,button[app-button]:not([disabled]):hover{cursor:pointer}\n"],encapsulation:2,changeDetection:0}),s})()},11818:(ge,F,n)=>{"use strict";n.d(F,{C:()=>C});var t=n(60177),e=n(72026),r=n(45189),o=n(54438);let C=(()=>{var E;class y{}return(E=y).\u0275fac=function(_){return new(_||E)},E.\u0275mod=o.$C({type:E}),E.\u0275inj=o.G2t({imports:[t.MD,e.o,r.G]}),y})()},32996:(ge,F,n)=>{"use strict";n.d(F,{z:()=>o});var t=n(60177),e=n(59162),r=n(54438);let o=(()=>{var C;class E{}return(C=E).\u0275fac=function(d){return new(d||C)},C.\u0275mod=r.$C({type:C}),C.\u0275inj=r.G2t({imports:[t.MD,e.M]}),E})()},90265:(ge,F,n)=>{"use strict";n.d(F,{B:()=>le});var t=n(54438),r=(n(45731),n(3266)),o=n(85052),C=n(35426),E=n(96513),y=n(94974),d=n(2573),_=n(87996),v=n(37925),b=n(36110),P=n(14264),s=n(21082),g=n(39705),u=n(66897),h=n(515),S=n(65855),f=n(13878),m=n(47125),i=n(49204),c=n(35379),a=n(97443),l=function(pe){return pe.Image="2d",pe.Embed="3d",pe}(l||{}),p=n(68132),A=n(16823),O=n(21424),L=n(65763),k=n(16058),q=n(60177),B=n(345);let j=(()=>{var pe;class ie{set url(de){de&&(this.src=this.sanitizer.bypassSecurityTrustResourceUrl(de))}constructor(de){this.sanitizer=de}}return(pe=ie).\u0275fac=function(de){return new(de||pe)(t.rXU(B.up))},pe.\u0275dir=t.FsC({type:pe,selectors:[["iframe","appEmbedSrc",""]],hostVars:1,hostBindings:function(de,w){2&de&&t.Mr5("src",w.src,t.f$h)},inputs:{url:"url"}}),ie})();const V=["embedViewerContainer"],M=["previewContainer"],N=["groupContainer"],W=["embedViewerFrame"],$=(pe,ie,be)=>({"embed-viewer--light":pe,"embed-viewer--dark":ie,"embed-viewer--compact":be}),ne=(pe,ie,be)=>({"embed-viewer__group--desktop":pe,"embed-viewer__group--tablet":ie,"embed-viewer__group--mobile":be}),Q={[c.k.Desktop]:{width:1,height:1},[c.k.Tablet]:{width:834,height:1194},[c.k.Mobile]:{width:414,height:736}};let le=(()=>{var pe;class ie{set model(de){if(de){const w=this.store.selectSnapshot(p.F.getWidgetURL),te=this.store.selectSnapshot(A.k.getUserLanguage),R=this.store.selectSnapshot(O.q.getSelectedOrganizationProductAccountId);let D=this.publishService.getWidgetURL(de,w,null,null,null,te,null,R);D+="&ui-fadeout=0",this.url=D}}get device(){return this._device}set device(de){this._device=de,this.options&&this.updateViewer(this.options)}get options(){return this._options}set options(de){de&&(this._options=de,this.updateViewer(this.options))}get topOffset(){const w=(this.previewRef.nativeElement.offsetHeight-this.height)/2;return this.scaleFactor<1?w:Math.max(0,w)}get leftOffset(){const w=(this.previewRef.nativeElement.offsetWidth-this.width)/2;return this.scaleFactor<1?w:Math.max(0,w)}get scaleFactor(){if(this.scalable){const{offsetWidth:de,offsetHeight:w}=this.previewRef.nativeElement;let te,R;return this.device===c.k.Desktop?(te=this.previewRef.nativeElement.offsetWidth/this.width,R=this.previewRef.nativeElement.offsetHeight/this.height):(te=de/Q[this.device].width,R=w/Q[this.device].height),Math.min(te,R,1)}return 1}get scaleFactorPercentage(){return Math.round(100*this.scaleFactor)}get zoomInfoText(){if(this.device===c.k.Desktop)return`Displayed at ${this.scaleFactorPercentage}%`;{const{width:de,height:w}=Q[this.device];return`${c.K[this.device]} (${de}x${w} resolution) displayed at ${this.scaleFactorPercentage}%`}}get previewHeight(){return this.containerRef.nativeElement.offsetHeight}get isDesktop(){return this.device===c.k.Desktop}get isTablet(){return this.device===c.k.Tablet}get isMobile(){return this.device===c.k.Mobile}get isThemeLight(){return"light"===this.theme}get isThemeDark(){return"dark"===this.theme}constructor(de,w,te,R,D){this.cameraService=de,this.publishService=w,this.changeDetectorRef=te,this.store=R,this.renderer2=D,this.publishModeEnum=l,this.theme="light",this.compact=!1,this.scalable=!1,this.labelScale=1,this.allVisibilityLayers=[],this.variantSchemas={},this.cameraUpdated=new t.bkB,this.ngUnsubscribe=new o.B,this.widgetOptionsSubject=new o.B}ngOnInit(){this._apiRef=new HumanAPI({iframeId:this.frameRef.nativeElement.id}),this.initAPIListeners(),this.initQuizAPIListeners(),this.initTutorialListeners(),this.initCameraListeners()}ngAfterViewInit(){this.updateViewer(this.options),(0,C.R)(window,"resize").pipe((0,_.B)(50),(0,v.Q)(this.ngUnsubscribe)).subscribe(()=>{this.updateViewer(this.options)})}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}initAPIListeners(){this.getAPIEvent(h.X.HumanReady).pipe((0,v.Q)(this.ngUnsubscribe)).subscribe(()=>{this.setupCameraTracking(),this.setupCameraRotation(),this.setViewerUIConfig(this.options?.options),this.getModelBackgroundColor().pipe((0,v.Q)(this.ngUnsubscribe)).subscribe(de=>{this.defaultBackgroundColor=de,this.setViewerBackground(this.options.backgroundColor||this.defaultBackgroundColor)}),this.getLayers().pipe((0,v.Q)(this.ngUnsubscribe)).subscribe(de=>{this.allVisibilityLayers=de,this.changeDetectorRef.markForCheck()}),this.getVariantSchemas().pipe((0,v.Q)(this.ngUnsubscribe)).subscribe(de=>{this.variantSchemas=de,this.changeDetectorRef.markForCheck()})})}initQuizAPIListeners(){this.widgetOptionsSubject.asObservable().pipe((0,b.T)(w=>w.uiQuiz),(0,P.p)(w=>!(0,i.isNil)(w))).pipe((0,s.F)((w,te)=>(0,i.isEqual)(w,te)),(0,P.p)(()=>!(0,i.isNil)(this._apiRef)),(0,v.Q)(this.ngUnsubscribe)).subscribe(w=>{const{mode:te,number:R}=w,D=te===m.R.Locked;if(D){const T=parseInt(R,10),re=isNaN(T)?1:T,K=isNaN(T)?void 0:T;this._apiRef.send(u.t.QuizReset),this._apiRef.send(u.t.QuizSet,{locked:D,startNumber:re,endNumber:K}),this._apiRef.send(u.t.QuizEnter)}else this._apiRef.send(u.t.QuizSet,{locked:D}),this._apiRef.send(u.t.QuizExit)})}initTutorialListeners(){this.widgetOptionsSubject.asObservable().pipe((0,b.T)(de=>de.uiTutorial),(0,s.F)(),(0,v.Q)(this.ngUnsubscribe)).subscribe(de=>{this._apiRef.send(u.t.UISetTutorial,{enabled:de})})}initCameraListeners(){this.widgetOptionsSubject.asObservable().pipe((0,b.T)(de=>de.loadRotate),(0,s.F)(),(0,v.Q)(this.ngUnsubscribe)).subscribe(de=>{this._rotateDegrees=de})}updateViewer(de){this.width=de.dimensions.width,this.height=de.dimensions.height,this.scalable=de.scalable,this.setLabelsEnabled(de.labelsEnabled),this.setLabelScale(de.labelScale),this.setViewerUIConfig(de.options),this.setViewerBackground(this.options.backgroundColor||this.defaultBackgroundColor);const w=de.dimensions.type;this.setDeviceDimensions(w);const te=this.frameRef?.nativeElement;te&&(w===a.M.Fixed?this.setFixedDimensions(te):w===a.M.Responsive&&this.setResponsiveDimensions(te))}setResponsiveDimensions(de){this.renderer2.removeAttribute(de,"width"),this.renderer2.removeAttribute(de,"height");let w="width",te="height";this.device===c.k.Desktop&&this.containerRef.nativeElement.offsetWidth/this.width>=this.containerRef.nativeElement.offsetHeight/this.height&&(w="height",te="width"),this.renderer2.setStyle(de,w,"100%"),this.renderer2.setStyle(de,te,"auto"),this.renderer2.setStyle(de,"aspect-ratio",`${this.width} / ${this.height}`),this.renderer2.setStyle(de,"max-height","100%")}setFixedDimensions(de){this.renderer2.setAttribute(de,"width",`${this.width}`),this.renderer2.setAttribute(de,"height",`${this.height}`),this.renderer2.setStyle(de,"width",`${this.width}px`),this.renderer2.setStyle(de,"height",`${this.height}px`),this.renderer2.setStyle(de,"aspect-ratio","auto")}setDeviceDimensions(de){this.device===c.k.Desktop&&de===a.M.Fixed?(this.renderer2.setStyle(this.groupContainerRef.nativeElement,"width",`${this.width}px`),this.renderer2.setStyle(this.groupContainerRef.nativeElement,"height",`${this.height}px`),this.renderer2.setStyle(this.groupContainerRef.nativeElement,"left",`${this.leftOffset}px`),this.renderer2.setStyle(this.groupContainerRef.nativeElement,"top",`${this.topOffset}px`)):(this.renderer2.removeStyle(this.groupContainerRef.nativeElement,"width"),this.renderer2.removeStyle(this.groupContainerRef.nativeElement,"height"),this.renderer2.removeStyle(this.groupContainerRef.nativeElement,"left"),this.renderer2.removeStyle(this.groupContainerRef.nativeElement,"top")),this.device!==c.k.Desktop&&this.renderer2.setStyle(this.groupContainerRef.nativeElement,"left",(this.previewRef.nativeElement.offsetWidth-Q[this.device].width*this.scaleFactor)/2+"px"),this.changeDetectorRef.markForCheck()}setViewerUIConfig(de){if(this._apiRef&&de){const w=this.convertWidgetOptionsToDisplayParams(de);this.setUIDisplay(w);const te={enabled:!de.autoLoad},R=(T=de.initial).button?S.i.Button:T.handHint?S.i.Hand:T.play?S.i.Play:T.summary?S.i.Summary:void 0,D=(T=>T.alert?f.M.DoNotCaptureShowMessage:T.overlay?f.M.DoNotCapture:f.M.Capture)(de.disableScroll);this._apiRef.send(u.t.UISetOndemand,te),this._apiRef.send(u.t.UISetLoadingExperience,R),this._apiRef.send(u.t.UISetScrollCaptureMode,D),this.widgetOptionsSubject.next(de)}var T}takeSnapshot(de="jpeg",w){return this.getAPIData(u.t.UISnapshot,{width:this.width,height:this.height,fileType:de,...w})}setCameraOrbit(de){this.sendAPIData(u.t.CameraOrbit,{yaw:de})}setViewerBackground(de){this._apiRef&&de&&this.sendAPIData(u.t.UIPresetBackground,de)}setLabelsEnabled(de){this._apiRef&&this.sendAPIData(de?u.t.LabelsShow:u.t.LabelsHide)}setLabelScale(de){this._apiRef&&this.sendAPIData(u.t.LabelsSetScale,{scale:de})}setupCameraTracking(){this.getCurrentCamera().pipe((0,v.Q)(this.ngUnsubscribe)).subscribe(de=>{this.setDefaultCamera(de),this.getCameraUpdates().pipe((0,v.Q)(this.ngUnsubscribe)).subscribe(w=>{this.setUpdateCamera(w)})})}setupCameraRotation(){let de=performance.now();(0,E.Y)(0,y.X).pipe((0,P.p)(()=>!!this._rotateDegrees),(0,b.T)(()=>this._rotateDegrees*(performance.now()-de)*.001),(0,g.M)(()=>de=performance.now()),(0,v.Q)(this.ngUnsubscribe)).subscribe(w=>{this.setCameraOrbit(w)})}setDefaultCamera(de){this._defaultCamera=de,this.setUpdateCamera(de)}setUpdateCamera(de){this._currentCamera=de;const te=this.cameraService.areCamerasEqual(this.cameraService.roundCamera(this._defaultCamera,3),this.cameraService.roundCamera(this._currentCamera,3))?null:this._currentCamera;this.cameraUpdated.emit(te)}getAPIEvent(de){return new d.c(w=>{this._apiRef.on(de,te=>{w.next(te)})})}getAPIData(de,w){return new d.c(te=>{this._apiRef.send(de,w,R=>{te.next(R),te.complete()})})}sendAPIData(de,w){this._apiRef.send(de,w)}getCurrentCamera(){return this.getAPIData(u.t.CameraInfo).pipe((0,b.T)(de=>({eye:de.position,look:de.target,up:de.up})))}getModelBackgroundColor(){return this.getAPIData(u.t.UIGetBackground).pipe((0,b.T)(de=>{if(de){const{colors:w,gradientType:te,colorStops:R}=de,[D,T]=w;return{colors:[...D,...T],gradientType:te,colorStops:R}}return null}))}getCameraUpdates(){return this.getAPIEvent(h.X.CameraUpdated).pipe((0,b.T)(de=>{const{position:w,target:te,up:R}=de;return{eye:w,look:te,up:R}}))}setUIDisplay(de){this._apiRef.send(u.t.UISetDisplay,de)}getLayers(){return this.getAPIData(u.t.SceneGetLayers)}getVariantSchemas(){return this.getAPIData(u.t.SceneGetVariantSchemas)}convertWidgetOptionsToDisplayParams(de){return{anatomyDescriptions:de.uiAnatomyDescriptions,anatomyPronunciations:de.uiAnatomyPronunciations,anatomyLabels:de.uiAnatomyLabels,audio:de.uiAudio,chapterList:de.uiChapterList,fullscreen:de.uiFullscreen,help:de.uiHelp,info:de.uiInfo,labelList:de.uiLabelList,legend:de.uiLegend,loader:de.uiLoader,media:de.uiMedia,menu:de.uiMenu,nav:de.uiNav,playthrough:de.playthrough,search:de.uiSearch,tools:de.uiTools,undo:de.uiUndo,visibilityLayers:de.uiVisibilityLayers,skinLayers:de.uiSkinLayers,whiteboard:de.uiWhiteboard}}}return(pe=ie).\u0275fac=function(de){return new(de||pe)(t.rXU(r.j),t.rXU(k.D),t.rXU(t.gRc),t.rXU(L.il),t.rXU(t.sFG))},pe.\u0275cmp=t.VBU({type:pe,selectors:[["app-embed-viewer"]],viewQuery:function(de,w){if(1&de&&(t.GBs(V,7),t.GBs(M,7),t.GBs(N,7),t.GBs(W,7)),2&de){let te;t.mGM(te=t.lsd())&&(w.containerRef=te.first),t.mGM(te=t.lsd())&&(w.previewRef=te.first),t.mGM(te=t.lsd())&&(w.groupContainerRef=te.first),t.mGM(te=t.lsd())&&(w.frameRef=te.first)}},inputs:{model:"model",url:"url",device:"device",options:"options",theme:"theme",compact:"compact"},outputs:{cameraUpdated:"cameraUpdated"},decls:27,vars:14,consts:[["embedViewerContainer",""],["previewContainer",""],["groupContainer",""],["embedViewerFrame",""],[1,"embed-viewer",3,"ngClass"],[1,"embed-viewer__preview"],[1,"embed-viewer__group",3,"ngClass"],[1,"embed-viewer__group-text","mb-3"],[1,"embed-viewer__group-text","w-1/2","mb-10"],["appEmbedSrc","","allowfullscreen","","id","embed-viewer-frame","data-test","embedViewerFrame",1,"embed-viewer__frame",3,"url"],[1,"embed-viewer__group-text","w-1/2","mt-5","mb-10"],[1,"embed-viewer__group-text","mb-8"],[1,"embed-viewer__group-text","w-1/3","mb-8"],[1,"embed-viewer__group-text","w-66","mb-8"],[1,"embed-viewer__group-text","w-1/3"],[1,"embed-viewer__label"]],template:function(de,w){1&de&&(t.j41(0,"div",4,0)(2,"div",5,1)(4,"div",6,2),t.nrm(6,"div",7)(7,"div",8)(8,"iframe",9,3)(10,"div",10)(11,"div",7)(12,"div",11)(13,"div",7)(14,"div",7)(15,"div",12)(16,"div",7)(17,"div",7)(18,"div",7)(19,"div",13)(20,"div",7)(21,"div",11)(22,"div",7)(23,"div",7)(24,"div",14),t.k0s()(),t.j41(25,"div",15),t.EFF(26),t.k0s()()),2&de&&(t.Y8G("ngClass",t.sMw(6,$,w.isThemeLight,w.isThemeDark,w.compact)),t.R7$(4),t.xc7("transform","scale("+w.scaleFactor+")"),t.Y8G("ngClass",t.sMw(10,ne,w.isDesktop,w.isTablet,w.isMobile)),t.R7$(4),t.Y8G("url",w.url),t.R7$(18),t.JRh(w.zoomInfoText))},dependencies:[q.YU,j],styles:[".embed-viewer[_ngcontent-%COMP%]{display:flex;flex-flow:column nowrap;align-items:center;width:100%;height:100%;position:relative;overflow:hidden}.embed-viewer--dark[_ngcontent-%COMP%]   .embed-viewer__frame[_ngcontent-%COMP%]{outline:1px solid #6c6c6c}.embed-viewer--dark[_ngcontent-%COMP%]   .embed-viewer__label[_ngcontent-%COMP%]{color:#101823}.embed-viewer--light[_ngcontent-%COMP%]   .embed-viewer__frame[_ngcontent-%COMP%]{outline:1px solid #d7e0ea}.embed-viewer--light[_ngcontent-%COMP%]   .embed-viewer__label[_ngcontent-%COMP%]{color:#61779e}.embed-viewer__preview[_ngcontent-%COMP%]{flex-grow:1;overflow:hidden;width:100%}.embed-viewer__group[_ngcontent-%COMP%]{overflow:hidden}.embed-viewer__group--desktop[_ngcontent-%COMP%]{width:100%;height:100%;padding:0;transform-origin:center center;position:relative}.embed-viewer__group--desktop[_ngcontent-%COMP%] > .embed-viewer__group-text[_ngcontent-%COMP%]{display:none}.embed-viewer__group--tablet[_ngcontent-%COMP%]{border:2px solid #d7e0ea;border-radius:4px;width:834px;height:1194px;padding:40px;transform-origin:left top;position:relative}.embed-viewer__group--mobile[_ngcontent-%COMP%]{border:2px solid #d7e0ea;border-radius:4px;width:414px;height:736px;padding:40px 20px;transform-origin:left top;position:relative}.embed-viewer__group-text[_ngcontent-%COMP%]{background-color:#d9d9d9;height:16px;width:100%}.embed-viewer__container[_ngcontent-%COMP%]{position:relative}.embed-viewer__frame[_ngcontent-%COMP%]{display:block;box-shadow:0 0 0 1px #eaeff5;margin-left:auto;margin-right:auto}.embed-viewer__label[_ngcontent-%COMP%]{flex-basis:40px;padding-top:24px;font-size:.75rem;line-height:1rem;text-align:center}.embed-viewer--compact[_ngcontent-%COMP%]   .embed-viewer__label[_ngcontent-%COMP%]{padding-top:12px}"],changeDetection:0}),ie})()},26779:(ge,F,n)=>{"use strict";n.d(F,{R:()=>r});var t=n(54438),e=n(60177);let r=(()=>{var o;class C{get iconClass(){let d=`${this.custom?"fak":"fas"} fa-${this.icon}`;return this.size&&(d+=` fa-${this.size}`),d}constructor(){this.custom=!1}ngOnInit(){}}return(o=C).\u0275fac=function(y){return new(y||o)},o.\u0275cmp=t.VBU({type:o,selectors:[["app-icon"]],inputs:{icon:"icon",size:"size",custom:"custom"},decls:1,vars:1,consts:[[3,"ngClass"]],template:function(y,d){1&y&&t.nrm(0,"i",0),2&y&&t.Y8G("ngClass",d.iconClass)},dependencies:[e.YU],styles:["[_nghost-%COMP%]{display:inline-block}"],changeDetection:0}),C})()},72026:(ge,F,n)=>{"use strict";n.d(F,{o:()=>r});var t=n(60177),e=n(54438);let r=(()=>{var o;class C{}return(o=C).\u0275fac=function(y){return new(y||o)},o.\u0275mod=e.$C({type:o}),o.\u0275inj=e.G2t({imports:[t.MD]}),C})()},41640:(ge,F,n)=>{"use strict";n.d(F,{P:()=>r});var t=n(54438);const e=["*"];let r=(()=>{var o;class C{constructor(){}ngOnInit(){}}return(o=C).\u0275fac=function(y){return new(y||o)},o.\u0275cmp=t.VBU({type:o,selectors:[["app-list-item"]],ngContentSelectors:e,decls:1,vars:0,template:function(y,d){1&y&&(t.NAR(),t.SdG(0))},encapsulation:2,changeDetection:0}),C})()},78696:(ge,F,n)=>{"use strict";n.d(F,{H:()=>E});var t=n(60177),e=n(89417),r=n(45189),o=n(72026),C=n(54438);let E=(()=>{var y;class d{}return(y=d).\u0275fac=function(v){return new(v||y)},y.\u0275mod=C.$C({type:y}),y.\u0275inj=C.G2t({imports:[r.G,e.YN,t.MD,o.o]}),d})()},77242:(ge,F,n)=>{"use strict";n.d(F,{s:()=>E});var t=n(54438),e=n(60177);const r=[[["app-list-item"]]],o=["app-list-item"];var C=function(y){return y.Default="default",y.Commafied="commafied",y.flat="flat",y.inline="inline",y.bulleted="bulleted",y}(C||{});let E=(()=>{var y;class d{constructor(){this.listType=C.Default,this.dense=!1}ngOnInit(){}}return(y=d).\u0275fac=function(v){return new(v||y)},y.\u0275cmp=t.VBU({type:y,selectors:[["app-list"]],inputs:{listType:"listType",dense:"dense"},ngContentSelectors:o,decls:2,vars:3,consts:[[1,"list",3,"ngClass"]],template:function(v,b){1&v&&(t.NAR(r),t.j41(0,"div",0),t.SdG(1),t.k0s()),2&v&&(t.AVh("list--dense",b.dense),t.Y8G("ngClass","list--"+b.listType))},dependencies:[e.YU],styles:['@charset "UTF-8";.list{display:flex;flex-direction:column}.list--dense{padding:0!important}.list--default app-list-item{display:list-item;margin-left:16px;list-style-type:disc}.list--commafied{align-items:center;display:flex;flex-direction:row;flex-wrap:wrap;padding:0 4px 4px 0}.list--commafied app-list-item:not(:last-child):after{content:", ";float:right;padding-right:4px}.list--bulleted{align-items:center;display:flex;flex-direction:row;flex-wrap:wrap;padding:0 4px 4px 0}.list--bulleted app-list-item:not(:last-child):after{content:" \\2022  ";float:right;padding-right:4px;padding-left:4px}.list--flat app-list-item:not(:last-child){margin-bottom:4px}.list--inline{display:inline-flex;align-items:center;display:flex;flex-direction:row;flex-wrap:wrap}.list--inline app-list-item{margin:0 8px 4px 0}.list__item{display:block}\n'],encapsulation:2,changeDetection:0}),d})()},98101:(ge,F,n)=>{"use strict";n.d(F,{P:()=>_});var t=n(85052),e=n(35426),r=n(37925),o=n(54438),C=n(60177);function E(v,b){if(1&v&&(o.j41(0,"span",4),o.EFF(1),o.k0s()),2&v){const P=o.XpG(2);o.R7$(),o.Lme("",P.remainingCount," ",1===P.remainingCount?"character":"characters"," remaining")}}function y(v,b){if(1&v&&(o.j41(0,"span",4),o.EFF(1),o.k0s()),2&v){const P=o.XpG(2);o.R7$(),o.Lme("",P.count,"/",P.max,"")}}function d(v,b){if(1&v&&(o.j41(0,"div",1),o.DNE(1,E,2,2,"span",2)(2,y,2,2,"span",3),o.k0s()),2&v){const P=o.XpG();o.AVh("counter--inline","inline"===P.display),o.Y8G("ngSwitch",P.mode),o.R7$(),o.Y8G("ngSwitchCase","remaining")}}let _=(()=>{var v;class b{get remainingCount(){return this.max-this.count}constructor(s){this.ref=s,this.ngUnsubscribe=new t.B,this.display="block",this.mode="count"}ngOnInit(){this.count=0,this.max=this.field.maxLength||0}ngAfterViewInit(){this.getValueChanges().pipe((0,r.Q)(this.ngUnsubscribe)).subscribe(()=>{this.updateCount()})}ngAfterContentChecked(){this.updateCount()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}updateCount(){const s=this.getValue().length;this.count!==s&&(this.count=s,this.ref.markForCheck())}getValueChanges(){return this.field.getValueChanges?this.field.getValueChanges():(0,e.R)(this.field,"input")}getValue(){return typeof this.field.textValue<"u"?this.field.textValue:this.field.value}}return(v=b).\u0275fac=function(s){return new(s||v)(o.rXU(o.gRc))},v.\u0275cmp=o.VBU({type:v,selectors:[["app-character-counter"]],inputs:{field:"field",display:"display",mode:"mode"},decls:1,vars:1,consts:[["class","counter text-2xs pt-1 pb-1",3,"counter--inline","ngSwitch",4,"ngIf"],[1,"counter","text-2xs","pt-1","pb-1",3,"ngSwitch"],["class","counter__label",4,"ngSwitchCase"],["class","counter__label",4,"ngSwitchDefault"],[1,"counter__label"]],template:function(s,g){1&s&&o.DNE(0,d,3,4,"div",0),2&s&&o.Y8G("ngIf",g.max)},dependencies:[C.bT,C.ux,C.e1,C.fG],styles:[".theme-light[_nghost-%COMP%]   .counter__label[_ngcontent-%COMP%], .theme-light   [_nghost-%COMP%]   .counter__label[_ngcontent-%COMP%]{color:#1c2a3f}.theme-dark[_nghost-%COMP%]   .counter__label[_ngcontent-%COMP%], .theme-dark   [_nghost-%COMP%]   .counter__label[_ngcontent-%COMP%]{color:#96a8c0}.counter[_ngcontent-%COMP%]{display:block;width:100%;float:right;text-align:right}.counter--inline[_ngcontent-%COMP%]{display:inline-block;width:auto}"]}),b})()},76115:(ge,F,n)=>{"use strict";n.d(F,{H:()=>r});var t=n(15877),e=n(68947);function r(o){return C=>{const E=e.l.parseEmails(C.value),y=E.filter(b=>!e.l.validateEmail(b)),d=E.length,_="number"==typeof o&&d>o;let v={};return _&&(v={...v,maxEmailsExceeded:_,currentEmailCount:d}),y.length>0&&(v={...v,invalidEmails:y}),Object.keys(v).length>0?(0,t.of)(v):(0,t.of)(null)}}},87505:(ge,F,n)=>{"use strict";n.d(F,{K:()=>S});var t=n(85052),e=n(35426),r=n(37925),o=n(54438),C=n(60177);const E=["labelEl"],y=["*",[["","form-field-help",""]]],d=["*","[form-field-help]"],_=(f,m,i,c)=>({"field--light":f,"field--dark":m,"field--inline":i,"field--compact":c});function v(f,m){1&f&&o.eu8(0)}function b(f,m){if(1&f&&(o.j41(0,"label",4,1),o.DNE(2,v,1,0,"ng-container",5),o.k0s()),2&f){const i=o.XpG(),c=o.sdS(4);o.BMQ("aria-label",i.label),o.R7$(2),o.Y8G("ngTemplateOutlet",c)}}function P(f,m){1&f&&o.eu8(0)}function s(f,m){if(1&f&&(o.j41(0,"div",4),o.DNE(1,P,1,0,"ng-container",5),o.k0s()),2&f){const i=o.XpG(),c=o.sdS(4);o.BMQ("aria-label",i.label),o.R7$(),o.Y8G("ngTemplateOutlet",c)}}function g(f,m){if(1&f&&(o.j41(0,"div",10),o.EFF(1),o.k0s()),2&f){const i=o.XpG(2);o.AVh("uppercase",i.uppercase),o.R7$(),o.SpI(" ",i.label," ")}}function u(f,m){if(1&f&&(o.j41(0,"div",11),o.EFF(1),o.k0s()),2&f){const i=o.XpG(2);o.R7$(),o.SpI(" ",i.labelHelp," ")}}function h(f,m){if(1&f&&(o.DNE(0,g,2,3,"div",6)(1,u,2,1,"div",7),o.j41(2,"div",8),o.SdG(3),o.j41(4,"div",9),o.SdG(5,1),o.k0s()()),2&f){const i=o.XpG();o.Y8G("ngIf",i.label),o.R7$(),o.Y8G("ngIf",i.labelHelp)}}let S=(()=>{var f;class m{constructor(){this.display="block",this.theme="dark",this.uppercase=!0,this.isCompact=!1,this.labelElement=!0,this.ngUnsubscribe=new t.B}ngOnInit(){}ngAfterViewInit(){this.labelEl&&this.initLabel()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}initLabel(){this.labelEl.nativeElement.querySelectorAll("[contenteditable]").length>0&&(0,e.R)(this.labelEl.nativeElement,"click").pipe((0,r.Q)(this.ngUnsubscribe)).subscribe(l=>{l.preventDefault()})}}return(f=m).\u0275fac=function(c){return new(c||f)},f.\u0275cmp=o.VBU({type:f,selectors:[["app-form-field"]],viewQuery:function(c,a){if(1&c&&o.GBs(E,5),2&c){let l;o.mGM(l=o.lsd())&&(a.labelEl=l.first)}},inputs:{label:"label",labelHelp:"labelHelp",display:"display",theme:"theme",uppercase:"uppercase",isCompact:"isCompact",labelElement:"labelElement"},ngContentSelectors:d,decls:5,vars:8,consts:[["contentTemplate",""],["labelEl",""],["data-test","formField",1,"field",3,"ngClass"],["class","field__container",4,"ngIf"],[1,"field__container"],[4,"ngTemplateOutlet"],["class","field__label text-2xs","data-test","formFieldLabel",3,"uppercase",4,"ngIf"],["class","text-xs text-gray-400 my-1",4,"ngIf"],[1,"field__input"],[1,"field__help","text-gray-400","text-xs"],["data-test","formFieldLabel",1,"field__label","text-2xs"],[1,"text-xs","text-gray-400","my-1"]],template:function(c,a){1&c&&(o.NAR(y),o.j41(0,"div",2),o.DNE(1,b,3,2,"label",3)(2,s,2,2,"div",3)(3,h,6,2,"ng-template",null,0,o.C5r),o.k0s()),2&c&&(o.Y8G("ngClass",o.ziG(3,_,"light"===a.theme,"dark"===a.theme,"inline"===a.display,a.isCompact)),o.R7$(),o.Y8G("ngIf",a.labelElement),o.R7$(),o.Y8G("ngIf",!a.labelElement))},dependencies:[C.YU,C.bT,C.T3],styles:[".field[_ngcontent-%COMP%]{padding-bottom:16px;display:block;width:100%}.field__input[_ngcontent-%COMP%]{margin-top:4px}.field--light[_ngcontent-%COMP%]   .field__label[_ngcontent-%COMP%]{color:#374a68}.field--dark[_ngcontent-%COMP%]   .field__label[_ngcontent-%COMP%]{color:#96a8c0}.field--inline[_ngcontent-%COMP%]   .field__container[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;width:auto}.field--inline[_ngcontent-%COMP%]   .field__label[_ngcontent-%COMP%]{margin-right:8px}.field--inline[_ngcontent-%COMP%]   .field__input[_ngcontent-%COMP%]{margin-top:auto}.field--compact[_ngcontent-%COMP%]{padding-bottom:0}.field__help[_ngcontent-%COMP%]:not(:empty){padding-top:4px}"],changeDetection:0}),m})()},3272:(ge,F,n)=>{"use strict";n.d(F,{D:()=>r});var t=n(60177),e=n(54438);let r=(()=>{var o;class C{}return(o=C).\u0275fac=function(y){return new(y||o)},o.\u0275mod=e.$C({type:o}),o.\u0275inj=e.G2t({imports:[t.MD]}),C})()},8961:(ge,F,n)=>{"use strict";n.d(F,{X:()=>u});var t=n(49969),e=n(85052),r=n(14264),o=n(87996),C=n(37925),E=n(86050),y=n(54438),d=n(60177),_=n(26779);const v=["*"];function b(h,S){if(1&h&&(y.j41(0,"div",7),y.nrm(1,"app-icon",8),y.k0s()),2&h){const f=y.XpG(2);y.R7$(),y.Y8G("icon",f.icon)}}function P(h,S){if(1&h&&(y.j41(0,"h3",9),y.EFF(1),y.k0s()),2&h){const f=y.XpG(2);y.R7$(),y.JRh(f.title)}}function s(h,S){if(1&h){const f=y.RV6();y.j41(0,"button",10),y.bIt("click",function(){y.eBV(f);const i=y.XpG(2);return y.Njj(i.handleDismissClicked())}),y.nrm(1,"app-icon",11),y.k0s()}}function g(h,S){if(1&h&&(y.j41(0,"div",1)(1,"div",2),y.DNE(2,b,2,1,"div",3),y.j41(3,"div",4),y.DNE(4,P,2,1,"h3",5),y.j41(5,"p"),y.SdG(6),y.k0s()()(),y.DNE(7,s,2,0,"button",6),y.k0s()),2&h){const f=y.XpG();y.AVh("message-toggle--message","message"===f.type)("message-toggle--error","error"===f.type)("message-toggle--danger","danger"===f.type)("message-toggle--notification","notification"===f.type)("message-toggle--warning","warning"===f.type)("message-toggle--rounded","rounded"===f.toggleStyle)("message-toggle--light","light"===f.theme)("message-toggle--dark","dark"===f.theme)("message-toggle--left","left"===f.toggleAlign)("message-toggle--center","center"===f.toggleAlign)("message-toggle--icon-top","top"===f.alignIcon)("message-toggle--icon-center","center"===f.alignIcon)("message-toggle--icon-bottom","bottom"===f.alignIcon),y.Y8G("@show",void 0),y.R7$(2),y.Y8G("ngIf",f.icon),y.R7$(2),y.Y8G("ngIf",f.title),y.R7$(3),y.Y8G("ngIf",f.dismiss)}}let u=(()=>{var h;class S{get shown(){return this._shown}set shown(m){this._shown!==m&&(this._shown=m,this.shownSubject.next(m),this.changeRef.markForCheck())}constructor(m){this.changeRef=m,this.type="message",this.theme="light",this.toggleAlign="left",this.alignIcon="top",this.showDelay=0,this.hideDelay=5e3,this.dismiss=!1,this.toggleStyle="rounded",this.handleDismiss=new e.B,this._shown=!0,this.shownSubject=new e.B,this.ngUnsubscribe=new e.B}ngOnInit(){this.initViewShownListeners()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}handleDismissClicked(){this.handleDismiss.next()}initViewShownListeners(){this.shownSubject.pipe((0,r.p)(()=>this.hideDelay>0),(0,o.B)(this.hideDelay),(0,r.p)(m=>m),(0,C.Q)(this.ngUnsubscribe)).subscribe(()=>{this._shown=!1,this.changeRef.markForCheck()})}}return(h=S).\u0275fac=function(m){return new(m||h)(y.rXU(y.gRc))},h.\u0275cmp=y.VBU({type:h,selectors:[["app-message-toggle"]],inputs:{type:"type",theme:"theme",toggleAlign:"toggleAlign",icon:"icon",alignIcon:"alignIcon",title:"title",showDelay:"showDelay",hideDelay:"hideDelay",dismiss:"dismiss",toggleStyle:"toggleStyle",shown:"shown"},outputs:{handleDismiss:"handleDismiss"},ngContentSelectors:v,decls:1,vars:1,consts:[["class","message-toggle flex flex-row items-start justify-between",3,"message-toggle--message","message-toggle--error","message-toggle--danger","message-toggle--notification","message-toggle--warning","message-toggle--rounded","message-toggle--light","message-toggle--dark","message-toggle--left","message-toggle--center","message-toggle--icon-top","message-toggle--icon-center","message-toggle--icon-bottom",4,"ngIf"],[1,"message-toggle","flex","flex-row","items-start","justify-between"],[1,"message-toggle__wrapper","flex","flex-row","flex-auto"],["class","message-toggle__icon mr-3",4,"ngIf"],[1,"message-toggle__content"],["class","font-semibold mb-1",4,"ngIf"],["class","message-toggle__icon message-toggle__dismiss",3,"click",4,"ngIf"],[1,"message-toggle__icon","mr-3"],[3,"icon"],[1,"font-semibold","mb-1"],[1,"message-toggle__icon","message-toggle__dismiss",3,"click"],["icon","times"]],template:function(m,i){1&m&&(y.NAR(),y.DNE(0,g,8,30,"div",0)),2&m&&y.Y8G("ngIf",i.shown)},dependencies:[d.bT,_.R],styles:[":root{--message-toggle-color: #1c2a3f;--message-toggle-background-color: #f0f8ff;--message-toggle-icon-color: #2d72dc}.message-toggle{padding:16px;box-sizing:border-box;font-size:13px;line-height:20px;color:var(--message-toggle-color);background-color:var(--message-toggle-background-color)}.message-toggle--rounded{border-radius:4px}.message-toggle__icon{color:#fff;font-size:16px;background:none;border:none;color:var(--message-toggle-icon-color)}.message-toggle__content{padding:0 2px;word-break:break-word}.message-toggle__dismiss{font-size:14px;color:var(--message-toggle-color);cursor:pointer}.message-toggle--left .message-toggle__content{flex:1 1 auto}.message-toggle--center .message-toggle__wrapper{justify-content:center}.message-toggle--icon-top .message-toggle__icon{align-self:flex-start}.message-toggle--icon-center .message-toggle__icon{align-self:center}.message-toggle--icon-bottom .message-toggle__icon{align-self:flex-end}.message-toggle.message-toggle--message{--message-toggle-color: #1c2a3f;--message-toggle-background-color: #f0fff0;--message-toggle-icon-color: #33cd54}.message-toggle.message-toggle--notification{--message-toggle-color: #1c2a3f;--message-toggle-background-color: #f0f8ff;--message-toggle-icon-color: #2d72dc}.message-toggle.message-toggle--warning{--message-toggle-color: #1c2a3f;--message-toggle-background-color: #fffcf0;--message-toggle-icon-color: #ffb92e}.message-toggle.message-toggle--error,.message-toggle.message-toggle--danger{--message-toggle-color: #1c2a3f;--message-toggle-background-color: #fff3f0;--message-toggle-icon-color: #f44336}.message-toggle--dark.message-toggle--message{--message-toggle-background-color: #e3ffe5}.message-toggle--dark.message-toggle--notification{--message-toggle-background-color: #d6ecff}.message-toggle--dark.message-toggle--warning{--message-toggle-background-color: #fff6d1}.message-toggle--dark.message-toggle--error,.message-toggle--dark.message-toggle--danger{--message-toggle-background-color: #ffe2db}\n"],encapsulation:2,data:{animation:[(0,t.hZ)("show",[(0,t.kY)(":enter",[(0,t.sM)(E.O.fadeIn,{params:{duration:300}})]),(0,t.kY)(":leave",[(0,t.sM)(E.O.fadeOut,{params:{duration:300}})])])]},changeDetection:0}),S})()},24184:(ge,F,n)=>{"use strict";n.d(F,{C:()=>d});var t=n(60177),e=n(76939),r=n(32996),o=n(72026),C=n(11818),E=n(21604),y=n(54438);let d=(()=>{var _;class v{}return(_=v).\u0275fac=function(P){return new(P||_)},_.\u0275mod=y.$C({type:_}),_.\u0275inj=y.G2t({imports:[t.MD,e.jc,r.z,o.o,C.C,E.G]}),v})()},81488:(ge,F,n)=>{"use strict";n.d(F,{f:()=>o});var t=n(60177),e=n(72026),r=n(54438);let o=(()=>{var C;class E{}return(C=E).\u0275fac=function(d){return new(d||C)},C.\u0275mod=r.$C({type:C}),C.\u0275inj=r.G2t({imports:[t.MD,e.o]}),E})()},90413:(ge,F,n)=>{"use strict";n.d(F,{D:()=>ce});var t=n(54438),e=n(65763),r=n(47610),o=n(13409),C=n(27180),E=n(61295),y=n(4951),d=n(59115),_=n(63365),v=n(58398),b=n(81881),P=n(47555),s=n(41862),g=n(45415),u=n(94604),h=n(43631),S=n(94495),f=n(44867),m=n(60177),i=n(89511),c=n(11818),a=n(72026),l=n(71997),p=n(89079),A=n(95416),O=n(18617),L=n(59369),k=n(21007),q=n(26779);const B=["nodeActionsTrigger"],j=(U,Z)=>Z.id;function V(U,Z){if(1&U&&(t.qex(0),t.j41(1,"button",62),t.pXf(2,22),t.k0s(),t.nrm(3,"mat-divider"),t.bVm()),2&U){t.XpG();const z=t.sdS(30);t.R7$(),t.Y8G("matMenuTriggerFor",z)}}function M(U,Z){1&U&&(t.qex(0),t.pXf(1,23),t.bVm())}function N(U,Z){1&U&&(t.qex(0),t.pXf(1,24),t.bVm())}function W(U,Z){if(1&U&&(t.qex(0),t.nrm(1,"mat-divider"),t.j41(2,"button",63),t.pXf(3,25),t.k0s(),t.bVm()),2&U){t.XpG();const z=t.sdS(49);t.R7$(2),t.Y8G("matMenuTriggerFor",z)}}function $(U,Z){if(1&U&&(t.qex(0),t.nrm(1,"mat-divider"),t.j41(2,"button",64),t.pXf(3,26),t.k0s(),t.bVm()),2&U){t.XpG(2);const z=t.sdS(56);t.R7$(2),t.Y8G("matMenuTriggerFor",z)}}function ne(U,Z){if(1&U&&t.DNE(0,$,4,1,"ng-container",47),2&U){const z=t.XpG();t.Y8G("appFlagApplication",z.application.Loft)("appFlagApplicationMode","include")("appFlagApplicationPage","/edit")}}function Q(U,Z){1&U&&t.nrm(0,"mat-divider")}function le(U,Z){if(1&U){const z=t.RV6();t.j41(0,"button",65),t.bIt("click",function(){t.eBV(z);const J=t.XpG();return t.Njj(J.editNodeLabel(J.node()))}),t.pXf(1,27),t.k0s()}}function pe(U,Z){if(1&U){const z=t.RV6();t.qex(0),t.j41(1,"button",61),t.bIt("click",function(){t.eBV(z);const J=t.XpG();return t.Njj(J.copy(J.node().label))}),t.pXf(2,28),t.k0s(),t.bVm()}}function ie(U,Z){if(1&U&&(t.j41(0,"button",67),t.pXf(1,30),t.k0s()),2&U){t.XpG(2);const z=t.sdS(69);t.Y8G("matMenuTriggerFor",z)}}function be(U,Z){if(1&U&&(t.qex(0),t.j41(1,"button",66),t.pXf(2,29),t.k0s(),t.DNE(3,ie,2,1,"button",67),t.bVm()),2&U){const z=t.XpG(),H=t.sdS(60);t.R7$(),t.Y8G("matMenuTriggerFor",H),t.R7$(2),t.vxM(3,z.node().boolState.available?3:-1)}}function de(U,Z){if(1&U){const z=t.RV6();t.qex(0),t.nrm(1,"mat-divider"),t.j41(2,"button",68),t.bIt("click",function(){t.eBV(z);const J=t.XpG();return t.Njj(J.samplePaint(J.node()))}),t.pXf(3,31),t.k0s(),t.bVm()}}function w(U,Z){if(1&U){const z=t.RV6();t.j41(0,"button",69),t.bIt("click",function(){t.eBV(z);const J=t.XpG();return t.Njj(J.toggleVisible(J.node(),!1))}),t.pXf(1,32),t.k0s()}}function te(U,Z){if(1&U){const z=t.RV6();t.j41(0,"button",70),t.bIt("click",function(){t.eBV(z);const J=t.XpG();return t.Njj(J.toggleVisible(J.node(),!0))}),t.pXf(1,33),t.k0s()}}function R(U,Z){if(1&U){const z=t.RV6();t.j41(0,"button",71),t.bIt("click",function(){t.eBV(z);const J=t.XpG();return t.Njj(J.togglePickable(J.node(),!1))}),t.pXf(1,34),t.k0s()}}function D(U,Z){if(1&U){const z=t.RV6();t.j41(0,"button",72),t.bIt("click",function(){t.eBV(z);const J=t.XpG();return t.Njj(J.togglePickable(J.node(),!0))}),t.pXf(1,35),t.k0s()}}function T(U,Z){if(1&U){const z=t.RV6();t.j41(0,"button",73),t.bIt("click",function(){t.eBV(z);const J=t.XpG();return t.Njj(J.toggleAvailable(J.node(),!1))}),t.pXf(1,36),t.k0s()}}function re(U,Z){if(1&U){const z=t.RV6();t.j41(0,"button",74),t.bIt("click",function(){t.eBV(z);const J=t.XpG();return t.Njj(J.toggleAvailable(J.node(),!0))}),t.pXf(1,37),t.k0s()}}function K(U,Z){if(1&U){const z=t.RV6();t.j41(0,"button",59),t.bIt("click",function(){t.eBV(z);const J=t.XpG().$implicit,Y=t.XpG();return t.Njj(Y.copyChapterPaint(Y.node(),J.id))}),t.pXf(1,38),t.k0s()}if(2&U){const z=t.XpG().$index;t.R7$(),t.uP7(z+1),t.nnv(1)}}function ae(U,Z){if(1&U&&t.DNE(0,K,2,1,"button",75),2&U){const z=Z.$implicit,H=t.XpG();t.vxM(0,z.id!==H.selectedChapterId()?0:-1)}}let ce=(()=>{var U;class Z{constructor(H,J,Y,X,se,oe){this.store=H,this.clipboardService=J,this.snackbar=Y,this.liveAnnouncer=X,this.nodeService=se,this.changeDetectorRef=oe,this.application=C.c,this.perChapterTreeEnabled=(0,p.ot)(this.store.select(h._.getPerChapterTreeEnabled)),this.chapters=(0,p.ot)(this.store.select(S.N.getStoryChapters)),this.selectedChapterId=(0,p.ot)(this.store.select(S.N.getSelectedChapterId)),this.node=(0,t.hFB)(),this.theme=(0,t.hFB)("dark"),this.shortId=(0,t.EWP)(()=>{const me=this.node();return(0,f.KJ)(me.id)}),this.eventCategory=(0,t.hFB)(""),this.nodeActionsClosed=(0,t.CGW)(),this.nodeActionsTrigger=(0,t.ebz)("nodeActionsTrigger")}isNodeChecked(H){return this.store.selectSnapshot(o.z.getNodes)[H].checked}isNodeShown(H){return this.store.selectSnapshot(o.z.getNodes)[H].shown}checkNode(H,J){const Y=void 0===J?!this.isNodeChecked(H.id):J;this.store.dispatch(new E.q9(Y,[H.id]))}checkInverse(H){this.store.dispatch(new E.q9(!0)),this.store.dispatch(new E.q9(!1,[H.id]))}setCheckedNodes(H,J){this.store.dispatch(new E.q9(!1));const Y=void 0===J?!this.isNodeChecked(H.id):J;this.store.dispatch(new E.q9(Y,[H.id]))}flyToNode(H){this.store.dispatch(new r.W6(H.id)).subscribe(()=>{this.liveAnnouncer.announce("Fly to complete")})}hideNode(H){this.store.dispatch(new E.yr(!1,[H.id]))}showNode(H){this.store.dispatch(new E.yr(!0,[H.id])),this.changeDetectorRef.markForCheck()}toggleVisible(H,J){const Y=void 0===J?this.isNodeShown(H.id):J;this.store.dispatch(new E.yr(Y,[H.id])),this.changeDetectorRef.markForCheck()}togglePickable(H,J){this.store.dispatch(new E.Ke(J,[H.id])),this.changeDetectorRef.markForCheck()}makeEverythingElseUnpickale(H){this.store.dispatch(new E.Ke(!1)),this.store.dispatch(new E.Ke(!0,[H.id]))}toggleAvailable(H,J){this.store.dispatch(new E.Ws(J,[H.id])),this.changeDetectorRef.markForCheck()}hideInverse(H){this.nodeService.hideInverse([H.id])}fadeNode(H){this.nodeService.fade([H.id])}fadeInverseNodes(H){this.nodeService.fadeInverse([H.id])}editNodeLabel(H){this.store.dispatch(new r._o(H)),this.store.dispatch(new r.ro(H))}copy(H){this.clipboardService.copyToClipboard(H,"text").subscribe(()=>{this.snackbar.open(`Copied ${H} to clipboard.`)})}onMenuClosed(){this.nodeActionsClosed.emit()}samplePaint(H){const J=this.store.selectSnapshot(o.z.getNodePaint)(H.id),Y=(0,_.Sf)(J);(0,v.Jl)(Y)?this.store.dispatch(new b.WD(J)):this.store.dispatch(new b.Hr),this.store.dispatch(new r.pL(P.s.Paint)),this.store.dispatch(new s.yF(g.x.Paint))}copyChapterPaint(H,J){this.store.dispatch(new E.ZF([H.id],J))}}return(U=Z).\u0275fac=function(H){return new(H||U)(t.rXU(e.il),t.rXU(y.W),t.rXU(A.UG),t.rXU(O.Ai),t.rXU(u.w),t.rXU(t.gRc))},U.\u0275cmp=t.VBU({type:U,selectors:[["app-node-actions"]],viewQuery:function(H,J){1&H&&t.wEZ(J.nodeActionsTrigger,B,5),2&H&&t.NyB()},inputs:{node:[t.Mj6.SignalBased,"node"],theme:[t.Mj6.SignalBased,"theme"],eventCategory:[t.Mj6.SignalBased,"eventCategory"]},outputs:{nodeActionsClosed:"nodeActionsClosed"},standalone:!0,features:[t.aNF],decls:72,vars:31,consts:()=>{let z,H,J,Y,X,se,oe,me,Se,Ue,je,Le,Re,Ee,We,ze,Ze,et,rt,Ge,Ye,Xe,ye,Ce,xe,Je,ot,ct,dt,ke;return z=$localize`:␟8973bc8c23a3f7c42aa9bd447386a3b0d26b74bc␟278590554940342755:menu`,H=$localize`:␟0a1d519b102495c607707a8de3e121d9777eb8f5␟7459515625406813591: Isolate `,J=$localize`:␟3f42464a5a50bfc4200a744e960b2193b395d833␟6476624779946658339: Fade `,Y=$localize`:␟23054cc1a12bc2f02ce35c53dda0a85a599c42b9␟1462430833776684733: Fly To `,X=$localize`:␟54cc524c29eb42615ed3660dbda137e40d9dd502␟7873649950229208086: Select This `,se=$localize`:␟0fffdd57d53d51daf33ea3051cfee157555f7a05␟2795853712015890159: Select Everything Else `,oe=$localize`:␟0ef9e3fa378a368d7def26850536752a3de491cf␟5280042464648975457: Fade This `,me=$localize`:␟b8640b44be68c687650962b406f6363a3b8758d7␟6392506384252263496: Fade Everything Else `,Se=$localize`:␟59e0b28333dd6b25a8fccbe60b09a1e3be64c3eb␟4950300091124319961:Hide Everything Else`,Ue=$localize`:␟3cea94df167f2ab21fb6fbca0ac24da30254ab37␟4608376353419364284: Make Everything Else Unselectable `,je=$localize`:␟70b9aca63f75c39c1c4a5a05b2ba3023a77a2b08␟9128837186595333201: Copy Short ID `,Le=$localize`:␟f9220e31a995fb0f115662c3b630782b55a20506␟9004635034659549721: Copy Full ID `,Re=$localize`:␟0a3f724079cb80043738d1f0784a7563106faddc␟2488186665405139057: Copy Display Name `,Ee=$localize`:␟9ca82952a6bc860b5391d5975322d8af8ceddfa4␟3797570084942068182:Select`,We=$localize`:␟1eede69e18c5ac9c0b0295b72cabb7e64e029e74␟8461609631969932886:Hide`,ze=$localize`:␟2aba1e87039819aca3b70faa9aa848c12bf139ca␟8461842260159597706:Show`,Ze=$localize`:␟864421378feb1d521cd7a7174c792db76b43a218␟7629795719386983652: Selectable / Unselectable `,et=$localize`:␟f8552086e072958cbd175fce6ca62724c5f313bb␟4966413469492836967: Available / Unavailable `,rt=$localize`:␟9ca20604245c07d56b1413d9e67a151a3ab2022d␟55699984583421362: Edit Display Name `,Ge=$localize`:␟db693767fd3d7ba3a7c6d19faf21fbacf0922651␟2283300174173662646: Copy Display Name `,Ye=$localize`:␟353d39004ad14e085967669d05448251baab93a7␟2821938014126744982: Copy `,Xe=$localize`:␟9190906690c1c5cd2136c84fb81d0c85751dbc81␟4172863901001023616: Paint `,ye=$localize`:␟28fc8508c6148c461ec04013970b2ed628bfc06e␟6750409730286190445: Sample Paint `,Ce=$localize`:␟f05cec857f16c24d8db89c50f3059742cbbfbbda␟5339110957660716850: Hide This `,xe=$localize`:␟552d734ad4619a8965231cc491c0e85a7bb155c7␟3401892363421578792: Show This `,Je=$localize`:␟968164c8722359889c83d149a11a539735841660␟1582264599495505864: Make Unselectable `,ot=$localize`:␟e7a08e6fec5a48b10e609eb63886bbd92fbdbacf␟2477567055965309744: Make Selectable `,ct=$localize`:␟99751ab6a5c4c71f400d25371daa6fa7d8d74abb␟2837486388916680829: Make Unavailable `,dt=$localize`:␟7df51bb35892872f649fbbe6c8ae82dae9edcd12␟3656836653049520580: Make Available `,ke=$localize`:␟a8db3e589abd66249c1c5671c8587cc8b6714ffc␟6619637855472690038: Apply Chapter ${"\ufffd0\ufffd"}:INTERPOLATION: Paint `,[["nodeActionsTrigger","matMenuTrigger"],["nodeActions","matMenu"],["selectActions","matMenu"],["fadeActions","matMenu"],["showHideActions","matMenu"],["pickableActions","matMenu"],["availableActions","matMenu"],["copyActions","matMenu"],["paintActions","matMenu"],z,H,J,Y,X,se,oe,me,Se,Ue,je,Le,Re,Ee,We,ze,Ze,et,rt,Ge,Ye,Xe,ye,Ce,xe,Je,ot,ct,dt,ke,["app-button","","data-test","nodeActionsTrigger","buttonSize","xs","buttonShape","square",3,"menuClosed","buttonTheme","matMenuTriggerFor"],["icon","ellipsis-v","aria-hidden","true"],[1,"sr-only"],[3,"overlapTrigger"],[4,"appFlagApplication","appFlagApplicationPage","appFlagApplicationMode"],["mat-menu-item","","data-test","nodeActionsHideShow",3,"click"],["mat-menu-item","","data-test","nodeActionsIsolate",3,"click"],["data-test","nodeActionsFadeTrigger","mat-menu-item","",3,"matMenuTriggerFor"],[4,"appFlagApplication","appFlagApplicationMode","appFlagApplicationPage"],["mat-menu-item","","data-test","nodeActionsFlyTo",3,"click"],["mat-menu-item","","data-test","nodeActionsEditName",3,"click",4,"appFlagApplication","appFlagApplicationPage","appFlagApplicationMode"],["mat-menu-item","","data-test","nodeActionsSelectThis",3,"click"],["mat-menu-item","","data-test","nodeActionsSelectEverythingElse",3,"click"],["mat-menu-item","","data-test","nodeActionsFadeThis",3,"click"],["mat-menu-item","","data-test","nodeActionsFadeEverythingElse",3,"click"],["mat-menu-item","","data-test","nodeActionsShowEverythingElse"],["mat-menu-item","",3,"click"],["mat-menu-item","","data-test","nodeActionsPickable"],["mat-menu-item","","data-test","nodeActionsEverythingElseUnpickable",3,"click"],["mat-menu-item","","data-test","nodeActionsUnavailable"],["mat-menu-item","","data-test","nodeActionsCopyShortID",3,"click"],["mat-menu-item","","data-test","nodeActionsCopyFullID",3,"click"],["mat-menu-item","","data-test","nodeActionsCopyDisplayName",3,"click"],["mat-menu-item","",3,"matMenuTriggerFor"],["mat-menu-item","","data-test","nodeActionsPickableTrigger",3,"matMenuTriggerFor"],["mat-menu-item","","data-test","nodeActionsAvailableTrigger",3,"matMenuTriggerFor"],["mat-menu-item","","data-test","nodeActionsEditName",3,"click"],["mat-menu-item","","data-test","nodeActionsCopyTrigger",3,"matMenuTriggerFor"],["mat-menu-item","","data-test","nodeActionsPaintTrigger",3,"matMenuTriggerFor"],["mat-menu-item","","data-test","nodeActionsSamplePaint",3,"click"],["mat-menu-item","","data-test","nodeActionsShowEverythingElse",3,"click"],["mat-menu-item","","data-test","nodeActionsShowThis",3,"click"],["mat-menu-item","","data-test","nodeActionsPickable",3,"click"],["mat-menu-item","","data-test","nodeActionsUnpickable",3,"click"],["mat-menu-item","","data-test","nodeActionsUnavailable",3,"click"],["mat-menu-item","","data-test","nodeActionsAvailable",3,"click"],["mat-menu-item","","data-test","nodeActionsCopyShortID"]]},template:function(H,J){if(1&H){const Y=t.RV6();t.qex(0),t.j41(1,"button",39,0),t.bIt("menuClosed",function(){return t.eBV(Y),t.Njj(J.onMenuClosed())}),t.nrm(3,"app-icon",40),t.j41(4,"span",41),t.EFF(5),t.qex(6),t.pXf(7,9),t.bVm(),t.k0s()(),t.j41(8,"mat-menu",42,1),t.DNE(10,V,4,1,"ng-container",43),t.j41(11,"button",44),t.bIt("click",function(){return t.eBV(Y),t.Njj(J.toggleVisible(J.node(),!J.node().boolState.shown))}),t.DNE(12,M,2,0,"ng-container")(13,N,2,0),t.k0s(),t.j41(14,"button",45),t.bIt("click",function(){return t.eBV(Y),t.Njj(J.hideInverse(J.node()))}),t.pXf(15,10),t.k0s(),t.nrm(16,"mat-divider"),t.j41(17,"button",46),t.pXf(18,11),t.k0s(),t.DNE(19,W,4,1,"ng-container",47)(20,ne,1,3,"ng-container"),t.nrm(21,"mat-divider"),t.j41(22,"button",48),t.bIt("click",function(){return t.eBV(Y),t.Njj(J.flyToNode(J.node()))}),t.pXf(23,12),t.k0s(),t.DNE(24,Q,1,0,"mat-divider",43)(25,le,2,0,"button",49)(26,pe,3,0,"ng-container",43)(27,be,4,2,"ng-container",43)(28,de,4,0,"ng-container",43),t.k0s(),t.j41(29,"mat-menu",null,2)(31,"button",50),t.bIt("click",function(){return t.eBV(Y),t.Njj(J.checkNode(J.node(),!0))}),t.pXf(32,13),t.k0s(),t.j41(33,"button",51),t.bIt("click",function(){return t.eBV(Y),t.Njj(J.checkInverse(J.node()))}),t.pXf(34,14),t.k0s()(),t.j41(35,"mat-menu",null,3)(37,"button",52),t.bIt("click",function(){return t.eBV(Y),t.Njj(J.fadeNode(J.node()))}),t.pXf(38,15),t.k0s(),t.j41(39,"button",53),t.bIt("click",function(){return t.eBV(Y),t.Njj(J.fadeInverseNodes(J.node()))}),t.pXf(40,16),t.k0s()(),t.j41(41,"mat-menu",null,4),t.DNE(43,w,2,0,"button",54)(44,te,2,0),t.nrm(45,"mat-divider"),t.j41(46,"button",55),t.bIt("click",function(){return t.eBV(Y),t.Njj(J.hideInverse(J.node()))}),t.pXf(47,17),t.k0s()(),t.j41(48,"mat-menu",null,5),t.DNE(50,R,2,0,"button",56)(51,D,2,0),t.nrm(52,"mat-divider"),t.j41(53,"button",57),t.bIt("click",function(){return t.eBV(Y),t.Njj(J.makeEverythingElseUnpickale(J.node()))}),t.pXf(54,18),t.k0s()(),t.j41(55,"mat-menu",null,6),t.DNE(57,T,2,0,"button",58)(58,re,2,0),t.k0s(),t.j41(59,"mat-menu",null,7)(61,"button",59),t.bIt("click",function(){return t.eBV(Y),t.Njj(J.copy(J.shortId()))}),t.pXf(62,19),t.k0s(),t.j41(63,"button",60),t.bIt("click",function(){return t.eBV(Y),t.Njj(J.copy(J.node().id))}),t.pXf(64,20),t.k0s(),t.nrm(65,"mat-divider"),t.j41(66,"button",61),t.bIt("click",function(){return t.eBV(Y),t.Njj(J.copy(J.node().label))}),t.pXf(67,21),t.k0s()(),t.j41(68,"mat-menu",null,8),t.Z7z(70,ae,1,1,null,null,j),t.k0s(),t.bVm()}if(2&H){const Y=t.sdS(9),X=t.sdS(36);t.R7$(),t.Y8G("buttonTheme",J.theme())("matMenuTriggerFor",Y),t.R7$(4),t.SpI("",J.node().label," "),t.R7$(3),t.Y8G("overlapTrigger",!0),t.R7$(2),t.Y8G("appFlagApplication",J.application.All)("appFlagApplicationPage","/edit")("appFlagApplicationMode","include"),t.R7$(2),t.vxM(12,J.node().boolState.shown?12:13),t.R7$(5),t.Y8G("matMenuTriggerFor",X),t.R7$(2),t.Y8G("appFlagApplication",J.application.All)("appFlagApplicationMode","include")("appFlagApplicationPage","/edit"),t.R7$(),t.vxM(20,J.perChapterTreeEnabled()?20:-1),t.R7$(4),t.Y8G("appFlagApplication",J.application.All)("appFlagApplicationPage","/edit")("appFlagApplicationMode","include"),t.R7$(),t.Y8G("appFlagApplication",J.application.All)("appFlagApplicationPage","/edit")("appFlagApplicationMode","include"),t.R7$(),t.Y8G("appFlagApplication",J.application.Studio)("appFlagApplicationPage","/edit")("appFlagApplicationMode","include"),t.R7$(),t.Y8G("appFlagApplication",J.application.Loft)("appFlagApplicationPage","/edit")("appFlagApplicationMode","include"),t.R7$(),t.Y8G("appFlagApplication",J.application.All)("appFlagApplicationPage","/edit")("appFlagApplicationMode","include"),t.R7$(15),t.vxM(43,J.node().boolState.shown?43:44),t.R7$(7),t.vxM(50,J.node().boolState.pickable?50:51),t.R7$(7),t.vxM(57,J.node().boolState.available?57:58),t.R7$(13),t.Dyx(J.chapters())}},dependencies:[m.MD,d.Cn,d.kk,d.fb,d.Cp,l.w,l.q,i.h,L.Y,c.C,k.Q,a.o,q.R],changeDetection:0}),Z})()},82192:(ge,F,n)=>{"use strict";n.d(F,{G:()=>d});var t=n(60177),e=n(90413),r=n(45189),o=n(72026),C=n(11818),E=n(89511),y=n(54438);let d=(()=>{var _;class v{}return(_=v).\u0275fac=function(P){return new(P||_)},_.\u0275mod=y.$C({type:_}),_.\u0275inj=y.G2t({imports:[t.MD,E.h,r.G,C.C,o.o,e.D]}),v})()},46374:(ge,F,n)=>{"use strict";n.d(F,{b:()=>E});var t=n(60177),e=n(11818),r=n(45189),o=n(72026),C=n(54438);let E=(()=>{var y;class d{}return(y=d).\u0275fac=function(v){return new(v||y)},y.\u0275mod=C.$C({type:y}),y.\u0275inj=C.G2t({imports:[t.MD,e.C,r.G,o.o]}),d})()},59162:(ge,F,n)=>{"use strict";n.d(F,{M:()=>r});var t=n(60177),e=n(54438);let r=(()=>{var o;class C{}return(o=C).\u0275fac=function(y){return new(y||o)},o.\u0275mod=e.$C({type:o}),o.\u0275inj=e.G2t({imports:[t.MD]}),C})()},97352:(ge,F,n)=>{"use strict";n.d(F,{tI:()=>d});var t=n(54438),e=n(60177);const r=(_,v,b)=>[_,v,b];function o(_,v){if(1&_&&(t.j41(0,"div",3),t.EFF(1),t.k0s()),2&_){const b=t.XpG();t.R7$(),t.SpI(" ",b.label," ")}}var C=function(_){return _.Small="small",_.Medium="medium",_.Large="large",_.Huge="huge",_}(C||{}),E=function(_){return _.Horizontal="horizontal",_.Vertical="vertical",_}(E||{}),y=function(_){return _.Inline="inline",_.Block="block",_.Fill="fill",_}(y||{});let d=(()=>{var _;class v{constructor(){this.size=C.Medium,this.label="",this.direction=E.Horizontal,this.render=y.Fill}ngOnInit(){}}return(_=v).\u0275fac=function(P){return new(P||_)},_.\u0275cmp=t.VBU({type:_,selectors:[["app-spinner"]],inputs:{size:"size",label:"label",direction:"direction",render:"render"},decls:3,vars:6,consts:[[1,"spinner","spinner--horizontal",3,"ngClass"],[1,"spinner__circle"],["class","spinner__label",4,"ngIf"],[1,"spinner__label"]],template:function(P,s){1&P&&(t.j41(0,"div",0),t.nrm(1,"div",1),t.DNE(2,o,2,1,"div",2),t.k0s()),2&P&&(t.Y8G("ngClass",t.sMw(2,r,"spinner--"+s.size,"spinner--"+s.render,"spinner--"+s.direction)),t.R7$(2),t.Y8G("ngIf",s.label.length))},dependencies:[e.YU,e.bT],styles:['@keyframes _ngcontent-%COMP%_spinner{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.spinner[_ngcontent-%COMP%]{display:inline-flex;justify-content:center;align-items:center}.spinner--small[_ngcontent-%COMP%]   .spinner__circle[_ngcontent-%COMP%]{width:11px;height:11px}.spinner--small[_ngcontent-%COMP%]   .spinner__circle[_ngcontent-%COMP%]:after{width:11px;height:11px}.spinner--small[_ngcontent-%COMP%]   .spinner__label[_ngcontent-%COMP%]{font-size:10px}.spinner--medium[_ngcontent-%COMP%]   .spinner__circle[_ngcontent-%COMP%]{width:14px;height:14px}.spinner--medium[_ngcontent-%COMP%]   .spinner__circle[_ngcontent-%COMP%]:after{width:14px;height:14px}.spinner--medium[_ngcontent-%COMP%]   .spinner__label[_ngcontent-%COMP%]{font-size:10px}.spinner--large[_ngcontent-%COMP%]   .spinner__circle[_ngcontent-%COMP%]{width:28px;height:28px}.spinner--large[_ngcontent-%COMP%]   .spinner__circle[_ngcontent-%COMP%]:after{width:28px;height:28px}.spinner--large[_ngcontent-%COMP%]   .spinner__label[_ngcontent-%COMP%]{font-size:14px}.spinner--huge[_ngcontent-%COMP%]   .spinner__circle[_ngcontent-%COMP%]{width:44px;height:44px}.spinner--huge[_ngcontent-%COMP%]   .spinner__circle[_ngcontent-%COMP%]:after{width:44px;height:44px}.spinner--huge[_ngcontent-%COMP%]   .spinner__label[_ngcontent-%COMP%]{font-size:16px}.spinner--horizontal[_ngcontent-%COMP%]{flex-direction:row}.spinner--vertical[_ngcontent-%COMP%]{align-items:center;flex-direction:column}.spinner--vertical[_ngcontent-%COMP%]   .spinner__label[_ngcontent-%COMP%]{padding:8px 0 0}.spinner--inline[_ngcontent-%COMP%]{display:inline-flex}.spinner--block[_ngcontent-%COMP%]{display:flex}.spinner--fill[_ngcontent-%COMP%]{display:flex;height:100%}.spinner__circle[_ngcontent-%COMP%]{width:14px;height:14px;border-radius:50%;border:2px solid rgba(16,24,35,.1);position:relative}.theme-dark[_nghost-%COMP%]   .spinner__circle[_ngcontent-%COMP%]{border-color:#fff6}.spinner__circle[_ngcontent-%COMP%]:after{animation:_ngcontent-%COMP%_spinner .4s linear infinite;content:" ";border-radius:50%;border:2px solid transparent;border-top-color:#fff3;border-right-color:#10182333;box-sizing:border-box;position:absolute;display:block;width:14px;height:14px;top:-2px;left:-2px}.theme-dark[_nghost-%COMP%]   .spinner__circle[_ngcontent-%COMP%]:after{border-top-color:#fff;border-right-color:#fff}.spinner__label[_ngcontent-%COMP%]{padding-left:8px;font-size:14px;text-transform:uppercase}.theme-dark[_nghost-%COMP%]   .spinner__label[_ngcontent-%COMP%], .theme-dark   [_nghost-%COMP%]   .spinner__label[_ngcontent-%COMP%]{color:#fff3}.theme-light[_nghost-%COMP%]   .spinner__label[_ngcontent-%COMP%], .theme-light   [_nghost-%COMP%]   .spinner__label[_ngcontent-%COMP%]{color:#10182399}'],changeDetection:0}),v})()},66598:(ge,F,n)=>{"use strict";n.d(F,{S:()=>o});var t=n(60177),e=n(89417),r=n(54438);let o=(()=>{var C;class E{}return(C=E).\u0275fac=function(d){return new(d||C)},C.\u0275mod=r.$C({type:C}),C.\u0275inj=r.G2t({imports:[t.MD,e.YN]}),E})()},87424:(ge,F,n)=>{"use strict";n.d(F,{j:()=>C});var t=n(54438),e=n(60177);const r=["*"];function o(E,y){1&E&&(t.j41(0,"div"),t.SdG(1),t.k0s())}let C=(()=>{var E;class y{get isActive(){return this._isActive}set isActive(_){this._isActive=_,this.changeDetector.markForCheck()}constructor(_){this.changeDetector=_,this.hide=!1,this._isActive=!1}ngOnInit(){}}return(E=y).\u0275fac=function(_){return new(_||E)(t.rXU(t.gRc))},E.\u0275cmp=t.VBU({type:E,selectors:[["app-tab"]],inputs:{label:"label",hide:"hide"},ngContentSelectors:r,decls:1,vars:1,consts:[[4,"ngIf"]],template:function(_,v){1&_&&(t.NAR(),t.DNE(0,o,2,0,"div",0)),2&_&&t.Y8G("ngIf",v.isActive)},dependencies:[e.bT],changeDetection:0}),y})()},59464:(ge,F,n)=>{"use strict";n.d(F,{j:()=>o});var t=n(60177),e=n(45189),r=n(54438);let o=(()=>{var C;class E{}return(C=E).\u0275fac=function(d){return new(d||C)},C.\u0275mod=r.$C({type:C}),C.\u0275inj=r.G2t({imports:[t.MD,e.G]}),E})()},57018:(ge,F,n)=>{"use strict";n.d(F,{O:()=>S});var t=n(54438),e=n(87424),r=n(29160),o=n(85052),C=n(37925),E=n(1670),y=n(14264),d=n(60177),_=n(71997);const v=["tabButton"],b=["*"],P=(f,m,i,c)=>({"tabs--small":f,"tabs--medium":m,"tabs--scrollable":i,"tabs--padded":c}),s=(f,m,i,c,a,l)=>({"tabs__label--dark":f,"tabs__label--light":m,"tabs__label--dark-active":i,"tabs__label--light-active":c,"tabs__label--blue":a,"tabs__label--red":l});function g(f,m){if(1&f){const i=t.RV6();t.j41(0,"button",7,1),t.bIt("click",function(){const a=t.eBV(i).$implicit,l=t.XpG();return t.Njj(l.handleTabSelect(a))}),t.EFF(2),t.k0s()}if(2&f){const i=m.$implicit,c=t.XpG();t.Y8G("ngClass",t.l4e(4,s,"dark"===c.tabTheme,"light"===c.tabTheme,"dark"===c.tabTheme&&c.isTabActive(i),"light"===c.tabTheme&&c.isTabActive(i),"blue"===c.tabColor,"red"===c.tabColor)),t.BMQ("aria-selected",c.isTabActive(i))("tabIndex",c.isTabActive(i)?0:-1),t.R7$(2),t.SpI(" ",i.label," ")}}function u(f,m){1&f&&t.nrm(0,"mat-divider")}let S=(()=>{var f;class m{get activeTab(){return this._activeTab.value}set activeTab(c){null!=c&&("string"==typeof c&&(c=c.toUpperCase()),this._activeTab.next(c))}get tabItems(){return this._tabItems}set tabItems(c){this._tabItems=c}constructor(c){this.changeDetector=c,this.display="normal",this.tabTheme="dark",this.activeTabChange=new t.bkB,this._activeTab=new r.t(0),this.tabSize="small",this.tabAlign="default",this.tabColor="blue",this.tabUnderline=!1,this.tabPadded=!1,this.scrollable=!1,this.ngUnsubscribe=new o.B}ngAfterContentInit(){this._tabs.changes.pipe((0,C.Q)(this.ngUnsubscribe)).subscribe(c=>{this.mapTabs(),this.changeDetector.markForCheck()}),this.mapTabs(),this._activeTab.pipe((0,C.Q)(this.ngUnsubscribe)).subscribe(c=>{this.showTab(c)}),this._activeTab.pipe((0,E.J)(),(0,y.p)(([c,a])=>c!==a),(0,C.Q)(this.ngUnsubscribe)).subscribe(([c,a])=>{this.activeTabChange.next(a)})}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}handleTabSelect(c){this._activeTab.next(c.index)}mapTabs(){this.tabItems=this._tabs.map((c,a)=>({index:a,label:c.label||`Item ${a}`,tab:c}))}showTab(c){this._tabs.forEach((a,l)=>{switch(typeof c){case"number":a.isActive=c===l;break;case"string":a.isActive=c.toString().toUpperCase()===a.label.toUpperCase()}}),this.changeDetector.markForCheck()}isTabActive(c){return("string"==typeof this._activeTab.value?c.label.toUpperCase():c.index)===this._activeTab.value}shiftTab(c){const l=(this.tabItems.find(p=>this.isTabActive(p)).index+c+this.tabItems.length)%this.tabItems.length;this._activeTab.next(l),this._buttonRefs.toArray()[l].nativeElement.focus()}}return(f=m).\u0275fac=function(c){return new(c||f)(t.rXU(t.gRc))},f.\u0275cmp=t.VBU({type:f,selectors:[["app-tabs"]],contentQueries:function(c,a,l){if(1&c&&t.wni(l,e.j,4),2&c){let p;t.mGM(p=t.lsd())&&(a._tabs=p)}},viewQuery:function(c,a){if(1&c&&t.GBs(v,5),2&c){let l;t.mGM(l=t.lsd())&&(a._buttonRefs=l)}},inputs:{display:"display",tabTheme:"tabTheme",activeTab:"activeTab",tabSize:"tabSize",tabAlign:"tabAlign",tabColor:"tabColor",tabUnderline:"tabUnderline",tabPadded:"tabPadded",scrollable:"scrollable"},outputs:{activeTabChange:"activeTabChange"},ngContentSelectors:b,decls:7,vars:10,consts:[["tabElements",""],["tabButton",""],[1,"tabs",3,"ngClass"],["role","tablist",1,"tabs__labels",3,"keyup.arrowright","keyup.arrowleft"],["class","tabs__label","role","tab","type","button","data-test","tabButton",3,"ngClass","click",4,"ngFor","ngForOf"],[4,"ngIf"],[1,"tabs__content"],["role","tab","type","button","data-test","tabButton",1,"tabs__label",3,"click","ngClass"]],template:function(c,a){if(1&c){const l=t.RV6();t.NAR(),t.j41(0,"div",2)(1,"div",3,0),t.bIt("keyup.arrowright",function(){return t.eBV(l),t.Njj(a.shiftTab(1))})("keyup.arrowleft",function(){return t.eBV(l),t.Njj(a.shiftTab(-1))}),t.DNE(3,g,3,11,"button",4)(4,u,1,0,"mat-divider",5),t.k0s(),t.j41(5,"div",6),t.SdG(6),t.k0s()()}2&c&&(t.Y8G("ngClass",t.ziG(5,P,"small"===a.tabSize,"medium"===a.tabSize,a.scrollable,a.tabPadded)),t.R7$(),t.AVh("tabs__labels--center","center"===a.tabAlign),t.R7$(2),t.Y8G("ngForOf",a.tabItems),t.R7$(),t.Y8G("ngIf",a.tabUnderline))},dependencies:[d.YU,d.Sq,d.bT,_.q],styles:['.tabs__labels[_ngcontent-%COMP%]{margin-bottom:8px}.tabs__labels--center[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.tabs__label[_ngcontent-%COMP%]{padding:2px 4px 4px;margin-right:8px;font-size:.625rem;line-height:.75rem;text-transform:uppercase;font-weight:500;-webkit-user-select:none;user-select:none;position:relative;background:none;border:none}.tabs__label[_ngcontent-%COMP%]:after{content:"";display:block;border-bottom:3px solid;margin-top:4px;width:0;transition:.25s ease;position:absolute;bottom:0;left:0}.tabs__label[_ngcontent-%COMP%]:hover{cursor:pointer}.tabs__label--blue[_ngcontent-%COMP%]:after{border-color:#2d72dc}.tabs__label--red[_ngcontent-%COMP%]:after{border-color:#de3535}.tabs__label--dark[_ngcontent-%COMP%]{color:#96a8c0}.tabs__label--dark[_ngcontent-%COMP%]:hover, .tabs__label--dark-active[_ngcontent-%COMP%]{color:#fff}.tabs__label--dark-active[_ngcontent-%COMP%]:after{width:100%}.tabs__label--light[_ngcontent-%COMP%]{color:#374a68}.tabs__label--light[_ngcontent-%COMP%]:hover, .tabs__label--light-active[_ngcontent-%COMP%]{color:#283853}.tabs__label--light-active[_ngcontent-%COMP%]:after{width:100%}.tabs--medium[_ngcontent-%COMP%]   .tabs__label[_ngcontent-%COMP%]{font-size:.75rem;line-height:1rem}.tabs--scrollable[_ngcontent-%COMP%]{display:flex;flex-direction:column;max-height:100%}.tabs--scrollable[_ngcontent-%COMP%]   .tabs__content[_ngcontent-%COMP%]{overflow:auto;flex:1 1 auto}.tabs--padded[_ngcontent-%COMP%]   .tabs__content[_ngcontent-%COMP%]{padding:20px 4px}'],changeDetection:0}),m})()},11583:(ge,F,n)=>{"use strict";n.d(F,{e:()=>E});var t=n(54438),e=n(60177),r=n(26779);function o(y,d){if(1&y&&t.nrm(0,"app-icon",3),2&y){const _=t.XpG();t.Y8G("icon",_.icon)}}var C=function(y){return y.Blue="blue",y.Purple="purple",y.Green="green",y.Gray="gray",y}(C||{});let E=(()=>{var y;class d{constructor(){this.label="",this.icon="",this.color=C.Blue}ngOnInit(){}}return(y=d).\u0275fac=function(v){return new(v||y)},y.\u0275cmp=t.VBU({type:y,selectors:[["app-tag"]],inputs:{label:"label",icon:"icon",color:"color"},decls:4,vars:3,consts:[[1,"tag",3,"ngClass"],["class","mr-2",3,"icon",4,"ngIf"],[1,"text-nowrap"],[1,"mr-2",3,"icon"]],template:function(v,b){1&v&&(t.j41(0,"span",0),t.DNE(1,o,1,1,"app-icon",1),t.j41(2,"span",2),t.EFF(3),t.k0s()()),2&v&&(t.Y8G("ngClass","tag--"+b.color),t.R7$(),t.Y8G("ngIf",b.icon),t.R7$(2),t.JRh(b.label))},dependencies:[e.YU,e.bT,r.R],styles:[".tag[_ngcontent-%COMP%]{align-items:center;background-color:#2d72dc;border-radius:10px;color:#fff;display:inline-flex;font-size:10px;height:20px;padding:0 8px;text-transform:uppercase}.tag--blue[_ngcontent-%COMP%]{background-color:#2d72dc}.tag--gray[_ngcontent-%COMP%]{background-color:#374a68}.tag--green[_ngcontent-%COMP%]{background-color:#3f7d84}.tag--purple[_ngcontent-%COMP%]{background-color:#925bc3}"],changeDetection:0}),d})()},89630:(ge,F,n)=>{"use strict";n.d(F,{$:()=>o});var t=n(60177),e=n(72026),r=n(54438);let o=(()=>{var C;class E{}return(C=E).\u0275fac=function(d){return new(d||C)},C.\u0275mod=r.$C({type:C}),C.\u0275inj=r.G2t({imports:[t.MD,e.o]}),E})()},36918:(ge,F,n)=>{"use strict";n.d(F,{e:()=>s});var t=n(60177),e=n(89417),r=n(13403),o=n(3272),C=n(59162),E=n(11818),y=n(45189),d=n(59464),_=n(72026),v=n(64026),b=n(78696),P=n(54438);let s=(()=>{var g;class u{}return(g=u).\u0275fac=function(S){return new(S||g)},g.\u0275mod=P.$C({type:g}),g.\u0275inj=P.G2t({imports:[t.MD,y.G,e.YN,o.D,e.X1,C.M,E.C,r.j,d.j,_.o,v.m,b.H]}),u})()},76203:(ge,F,n)=>{"use strict";n.d(F,{W:()=>v});var t=n(54438),e=n(60177),r=n(77242),o=n(41640),C=n(26779);function E(b,P){if(1&b&&(t.j41(0,"div",4),t.EFF(1),t.k0s()),2&b){const s=t.XpG();t.R7$(),t.SpI(" ",s.label," ")}}function y(b,P){if(1&b&&(t.j41(0,"app-list-item")(1,"div",5),t.nrm(2,"app-icon",6),t.j41(3,"div"),t.EFF(4),t.k0s()()()),2&b){const s=P.$implicit;t.R7$(4),t.JRh(s)}}const _=["Gain unlimited access to over 700 anatomy, disease and treatment models","Save unlimited 3D models","Embed models directly into your learning management system, website or application","Improve cross-team collaboration"];let v=(()=>{var b;class P{constructor(){this.label="Team plans are great for schools or businesses looking to create a collaborative\nexperience for their users. With a team plan, you get:",this.features=_}ngOnInit(){}}return(b=P).\u0275fac=function(g){return new(g||b)},b.\u0275cmp=t.VBU({type:b,selectors:[["app-team-features"]],inputs:{label:"label",features:"features"},decls:4,vars:2,consts:[[1,"feature","text-sm"],["class","mb-4",4,"ngIf"],["listType","flat"],[4,"ngFor","ngForOf"],[1,"mb-4"],[1,"my-1","flex","flex-row"],["icon","check",1,"mr-2"]],template:function(g,u){1&g&&(t.j41(0,"div",0),t.DNE(1,E,2,1,"div",1),t.j41(2,"app-list",2),t.DNE(3,y,5,1,"app-list-item",3),t.k0s()()),2&g&&(t.R7$(),t.Y8G("ngIf",u.label),t.R7$(2),t.Y8G("ngForOf",u.features))},dependencies:[e.Sq,e.bT,r.s,o.P,C.R],changeDetection:0}),P})()},65115:(ge,F,n)=>{"use strict";n.d(F,{H:()=>s});var v,t=n(65763),e=n(85052),r=n(37925),o=n(2573),C=n(21424),E=n(4951),y=n(54438),d=n(95416),_=n(21007);class s{constructor(u,h,S){this.clipboardService=u,this.changeRef=h,this.snackbar=S,this.ngUnsubscribe=new e.B,this.copyErrorMessage="There was a problem copying to the clipboard."}ngOnInit(){this.groupCode$.pipe((0,r.Q)(this.ngUnsubscribe)).subscribe(u=>{this.groupCode=u,this.signupLink=`https://${window.location.host}/login/create?code=${u}`,this.changeRef.markForCheck()})}handleCopyCodeClick(u){u.preventDefault(),this.clipboardService.copyToClipboard(this.groupCode,"text").pipe((0,r.Q)(this.ngUnsubscribe)).subscribe(h=>{this.snackbar.open(h?"Team invite code copied to your clipboard.":this.copyErrorMessage)})}handleCopyLinkClick(u){u.preventDefault(),this.clipboardService.copyToClipboard(this.signupLink,"url").pipe((0,r.Q)(this.ngUnsubscribe)).subscribe(h=>{this.snackbar.open(h?"Team invite link copied to your clipboard.":this.copyErrorMessage)})}}(v=s).\u0275fac=function(u){return new(u||v)(y.rXU(E.W),y.rXU(y.gRc),y.rXU(d.UG))},v.\u0275cmp=y.VBU({type:v,selectors:[["app-team-group-code"]],decls:10,vars:6,consts:[[1,"team-group-code","text-sm","mb-4"],[1,"flex","mb-3"],["type","text",1,"team-group-code__input","input",3,"readonly","value"],["app-button","","buttonSize","md","buttonTheme","light","buttonType","primary",1,"team-group-code__button","ml-4",3,"click","uppercase"],[1,"flex"],["type","text",1,"team-group-code__input","input","underline",3,"readonly","value"]],template:function(u,h){1&u&&(y.j41(0,"div",0),y.EFF(1," Share this code or invite link so people can join your team directly.\n"),y.k0s(),y.j41(2,"div",1),y.nrm(3,"input",2),y.j41(4,"button",3),y.bIt("click",function(f){return h.handleCopyCodeClick(f)}),y.EFF(5," Copy Code "),y.k0s()(),y.j41(6,"div",4),y.nrm(7,"input",5),y.j41(8,"button",3),y.bIt("click",function(f){return h.handleCopyLinkClick(f)}),y.EFF(9," Copy Link "),y.k0s()()),2&u&&(y.R7$(3),y.Y8G("readonly",!0)("value",h.groupCode),y.R7$(),y.Y8G("uppercase",!0),y.R7$(3),y.Y8G("readonly",!0)("value",h.signupLink),y.R7$(),y.Y8G("uppercase",!0))},dependencies:[_.Q],styles:[".team-group-code__input[_ngcontent-%COMP%]{background-color:#eaeff5!important}.team-group-code__button[_ngcontent-%COMP%]{flex:0 0 112px}"],changeDetection:0}),function(g,u,h,S){var i,f=arguments.length,m=f<3?u:null===S?S=Object.getOwnPropertyDescriptor(u,h):S;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)m=Reflect.decorate(g,u,h,S);else for(var c=g.length-1;c>=0;c--)(i=g[c])&&(m=(f<3?i(m):f>3?i(u,h,m):i(u,h))||m);f>3&&m&&Object.defineProperty(u,h,m)}([(0,t.l6)(C.q.getOrganizationGroupCode),function(g,u){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata("design:type",u)}(0,o.c)],s.prototype,"groupCode$",void 0)},64026:(ge,F,n)=>{"use strict";n.d(F,{m:()=>o});var t=n(60177),e=n(11818),r=n(54438);let o=(()=>{var C;class E{}return(C=E).\u0275fac=function(d){return new(d||C)},C.\u0275mod=r.$C({type:C}),C.\u0275inj=r.G2t({imports:[t.MD,e.C]}),E})()},21091:(ge,F,n)=>{"use strict";n.d(F,{G:()=>D});var a,t=n(54438),e=n(89417),r=n(65763),o=n(85052),C=n(2573),E=n(14264),y=n(37925),d=n(56081),_=n(38165),v=n(16823),P=(n(15040),n(68947)),s=n(82608),g=n(99504),u=n(76115),h=n(53236),S=n(21007),f=n(60177),m=n(87505),i=n(53719),c=n(8961),l=function(T,re,K,ae){var Z,ce=arguments.length,U=ce<3?re:null===ae?ae=Object.getOwnPropertyDescriptor(re,K):ae;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)U=Reflect.decorate(T,re,K,ae);else for(var z=T.length-1;z>=0;z--)(Z=T[z])&&(U=(ce<3?Z(U):ce>3?Z(re,K,U):Z(re,K))||U);return ce>3&&U&&Object.defineProperty(re,K,U),U},p=function(T,re){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(T,re)};function O(T,re){if(1&T&&(t.j41(0,"div",10)(1,"app-message-toggle",11),t.EFF(2),t.k0s()()),2&T){const K=t.XpG(2);t.R7$(2),t.SpI(" ",K.sentResponses.length," invite(s) have been sent. Please allow up to a few minutes for invitees to receive their invitations. ")}}function L(T,re){if(1&T&&(t.qex(0),t.DNE(1,O,3,1,"div",9),t.bVm()),2&T){const K=t.XpG();t.R7$(),t.Y8G("ngIf",K.sentResponses.length>0)}}function k(T,re){if(1&T&&(t.j41(0,"div"),t.EFF(1),t.k0s()),2&T){const K=re.$implicit;t.R7$(),t.SpI(" ",K," ")}}function q(T,re){if(1&T&&(t.j41(0,"div",19)(1,"app-message-toggle",20)(2,"div"),t.EFF(3),t.k0s(),t.DNE(4,k,2,1,"div",21),t.k0s()()),2&T){const K=t.XpG(3);t.R7$(3),t.SpI("There was an error sending ",K.errorResponses.length," invite(s)."),t.R7$(),t.Y8G("ngForOf",K.formatResponses(K.errorResponses))}}function B(T,re){if(1&T&&(t.j41(0,"div",19)(1,"app-message-toggle",20),t.EFF(2),t.k0s()()),2&T){const K=t.XpG(3);t.R7$(2),t.SpI(" ",K.errorMessage," ")}}function j(T,re){if(1&T&&(t.j41(0,"div",22)(1,"mat-error"),t.EFF(2),t.k0s()()),2&T){const K=t.XpG().$implicit,ae=t.XpG(2);t.R7$(2),t.Lme(" Please limit your entry to ",ae.maxEmailCount,". Current count: ",null==K.errors?null:K.errors.currentEmailCount,". ")}}function V(T,re){if(1&T&&(t.j41(0,"div",22)(1,"mat-error"),t.EFF(2),t.k0s()()),2&T){const K=t.XpG().$implicit,ae=t.XpG(2);t.R7$(2),t.Lme(" ",ae.formatEmails(null==K.errors?null:K.errors.invalidEmails)," ",1===K.errors.invalidEmails.length?"is not a valid email address.":"are not valid email addresses."," ")}}function M(T,re){if(1&T&&(t.j41(0,"option",27),t.EFF(1),t.k0s()),2&T){const K=re.$implicit;t.Y8G("value",K.role_id),t.R7$(),t.SpI(" ",K.role_display_name," ")}}function N(T,re){1&T&&(t.j41(0,"div",22)(1,"mat-error"),t.EFF(2," Please select a valid role. "),t.k0s()())}function W(T,re){if(1&T&&(t.j41(0,"app-form-field",23)(1,"select",24)(2,"option",25),t.EFF(3,"--"),t.k0s(),t.DNE(4,M,2,2,"option",26),t.k0s(),t.DNE(5,N,3,0,"div",17),t.k0s()),2&T){const K=re.$implicit,ae=t.XpG(3);t.R7$(4),t.Y8G("ngForOf",ae.availableRoles),t.R7$(),t.Y8G("ngIf",K.touched&&K.invalid)}}function $(T,re){if(1&T&&(t.qex(0,13),t.DNE(1,q,5,2,"div",14)(2,B,3,1,"div",14),t.j41(3,"app-form-field",15)(4,"textarea",16),t.EFF(5,"          "),t.k0s(),t.DNE(6,j,3,2,"div",17)(7,V,3,2,"div",17),t.k0s(),t.DNE(8,W,6,2,"app-form-field",18),t.bVm()),2&T){const K=re.$implicit,ae=t.XpG(2);t.Y8G("formGroup",ae.form),t.R7$(),t.Y8G("ngIf",ae.errorResponses.length>0),t.R7$(),t.Y8G("ngIf",ae.errorMessage),t.R7$(2),t.Y8G("placeholder","Enter up to "+ae.maxEmailCount+" email addresses separated by commas or line breaks"),t.R7$(2),t.Y8G("ngIf",null==K.errors?null:K.errors.maxEmailsExceeded),t.R7$(),t.Y8G("ngIf",null==K.errors?null:K.errors.invalidEmails),t.R7$(),t.Y8G("ngIf",ae.form.get("roleId"))}}function ne(T,re){if(1&T&&t.DNE(0,$,9,7,"ng-container",12),2&T){const K=t.XpG();t.Y8G("ngIf",K.form.get("emails"))}}function Q(T,re){if(1&T){const K=t.RV6();t.j41(0,"button",29),t.bIt("click",function(){t.eBV(K);const ce=t.XpG(2);return t.Njj(ce.handleCancelClick())}),t.EFF(1),t.k0s()}if(2&T){const K=t.XpG(2);t.Y8G("uppercase","inline"===K.layout),t.R7$(),t.SpI(" ",K.cancelText," ")}}function le(T,re){if(1&T){const K=t.RV6();t.j41(0,"button",30),t.nI1(1,"async"),t.bIt("click",function(){t.eBV(K);const ce=t.XpG(2);return t.Njj(ce.handleInviteClick())}),t.EFF(2),t.k0s()}if(2&T){const K=t.XpG(2);t.Y8G("uppercase","inline"===K.layout)("disabled",K.form.invalid||t.bMT(1,3,K.inviting$)),t.R7$(2),t.SpI(" ",K.errorResponses.length>0?"Try Again":K.sendText," ")}}function pe(T,re){1&T&&t.eu8(0)}function ie(T,re){1&T&&t.eu8(0)}function be(T,re){if(1&T&&(t.qex(0),t.DNE(1,pe,1,0,"ng-container",31)(2,ie,1,0,"ng-container",31),t.bVm()),2&T){t.XpG();const K=t.sdS(3),ae=t.sdS(5);t.R7$(),t.Y8G("ngTemplateOutlet",K),t.R7$(),t.Y8G("ngTemplateOutlet",ae)}}function de(T,re){1&T&&t.eu8(0)}function w(T,re){1&T&&t.eu8(0)}function te(T,re){if(1&T&&t.DNE(0,de,1,0,"ng-container",31)(1,w,1,0,"ng-container",31),2&T){t.XpG();const K=t.sdS(3),ae=t.sdS(5);t.Y8G("ngTemplateOutlet",ae),t.R7$(),t.Y8G("ngTemplateOutlet",K)}}function R(T,re){if(1&T&&(t.j41(0,"div")(1,"div",28),t.DNE(2,Q,2,2,"ng-template",null,1,t.C5r)(4,le,3,5,"ng-template",null,2,t.C5r)(6,be,3,2,"ng-container",6)(7,te,2,2,"ng-template",null,3,t.C5r),t.k0s()()),2&T){const K=t.sdS(8),ae=t.XpG();t.R7$(6),t.Y8G("ngIf","inline"===ae.layout)("ngIfElse",K)}}class D{get valid(){return this.form.valid}constructor(re,K,ae,ce){this.store=re,this.actions=K,this.formBuilder=ae,this.changeRef=ce,this.maxEmailCount=50,this.availableRoles=[],this.layout="inline",this.enableActions=!0,this.sendText="Send invites",this.cancelText="Cancel",this.inviteSent=new t.bkB,this.inviteCancelled=new t.bkB,this.ngUnsubscribe=new o.B,this.sent=!1,this.sentResponses=[],this.errorResponses=[]}ngOnInit(){this.initForm(),this.initInviteListeners()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}initForm(){this.store.dispatch(new _.Xb),this.currentUserRole=this.store.selectSnapshot(v.k.getUserRole),this.userRoles$.pipe((0,E.p)(re=>re.length>0),(0,y.Q)(this.ngUnsubscribe)).subscribe(re=>{this.availableRoles=re.filter(K=>d.Zv.indexOf(K.role_name)<=d.Zv.indexOf(this.currentUserRole.role_name)),this.changeRef.markForCheck()}),this.form=this.formBuilder.group({emails:["",e.k0.required,(0,u.H)(this.maxEmailCount).bind(this)],roleId:["",e.k0.required]})}initInviteListeners(){this.actions.pipe((0,r.xi)(s.h2),(0,y.Q)(this.ngUnsubscribe)).subscribe(()=>{this.resetState(),this.changeRef.markForCheck()}),this.actions.pipe((0,r.xi)(s.w9),(0,y.Q)(this.ngUnsubscribe)).subscribe(({responses:re})=>{this.resetState(),this.sentResponses=re.filter(K=>"success"===K.status),this.errorResponses=re.filter(K=>"error"===K.status),this.sent=0===this.errorResponses.length,this.sent&&this.inviteSent.next(re),this.changeRef.markForCheck()}),this.actions.pipe((0,r.xi)(s.HZ,_.sz),(0,y.Q)(this.ngUnsubscribe)).subscribe(re=>{this.resetState(),this.errorMessage=(0,h.u1)(re.error)||"There was an error sending the invites, please try again.",this.changeRef.markForCheck()})}handleCancelClick(){this.inviteCancelled.next()}backToFormClick(){this.resetState(),this.changeRef.markForCheck()}handleInviteClick(){const{eid:re}=this.organization,ae=P.l.parseEmails(this.form.value.emails).map(ce=>({user_email:ce,role_id:parseInt(this.form.value.roleId,10)}));this.store.dispatch(new s.h2(re,ae))}formatEmails(re){return re.join(", ")}formatResponses(re){const K=re.map(ce=>ce.reason);return[...new Set([...K])].map(ce=>{const U=re.filter(z=>z.reason===ce).map(z=>z.email),Z=this.formatEmails(U);return`"${ce}": ${Z}`})}resetState(){this.sent=!1,this.sentResponses=[],this.errorResponses=[],this.errorMessage=""}}(a=D).\u0275fac=function(re){return new(re||a)(t.rXU(r.il),t.rXU(r.En),t.rXU(e.ze),t.rXU(t.gRc))},a.\u0275cmp=t.VBU({type:a,selectors:[["app-team-invite"]],inputs:{organization:"organization",layout:"layout",enableActions:"enableActions",sendText:"sendText",cancelText:"cancelText"},outputs:{inviteSent:"inviteSent",inviteCancelled:"inviteCancelled"},ngContentSelectors:["*"],decls:8,vars:7,consts:[["sendFormTmp",""],["cancelBtnTmp",""],["sendBtnTmp",""],["blockBtnTmp",""],[1,"invite"],[1,"theme-light"],[4,"ngIf","ngIfElse"],[4,"ngIf"],[1,"invite__footer"],["class","my-1",4,"ngIf"],[1,"my-1"],["data-test","teamInviteSuccess","type","message"],[3,"formGroup",4,"ngIf"],[3,"formGroup"],["class","mb-4",4,"ngIf"],["theme","light","label","Invite via email"],["formControlName","emails","data-test","teamInviteEmails","rows","8",1,"invite__input","input",3,"placeholder"],["class","mt-1",4,"ngIf"],["theme","light","label","Role",4,"ngIf"],[1,"mb-4"],["type","error"],[4,"ngFor","ngForOf"],[1,"mt-1"],["theme","light","label","Role"],["formControlName","roleId",1,"input"],["value",""],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"invite__buttons"],["app-button","","buttonSize","xl","buttonTheme","light","buttonType","default","data-test","skipInvitesButton",1,"invite__button",3,"click","uppercase"],["app-button","","buttonSize","xl","buttonType","primary","data-test","sendInvitesButton",1,"invite__button",3,"click","uppercase","disabled"],[4,"ngTemplateOutlet"]],template:function(re,K){if(1&re&&(t.NAR(),t.j41(0,"div",4)(1,"div",5),t.DNE(2,L,2,1,"ng-container",6)(3,ne,1,1,"ng-template",null,0,t.C5r),t.k0s(),t.DNE(5,R,9,2,"div",7),t.j41(6,"div",8),t.SdG(7,0,["[select]","invite - footer"]),t.k0s()()),2&re){const ae=t.sdS(4);t.AVh("invite--inline","inline"===K.layout)("invite--block","block"===K.layout),t.R7$(2),t.Y8G("ngIf",K.sent)("ngIfElse",ae),t.R7$(3),t.Y8G("ngIf",K.enableActions&&!K.sent)}},dependencies:[S.Q,f.Sq,f.bT,f.T3,m.K,i.TL,e.xH,e.y7,e.me,e.wz,e.BC,e.cb,e.j4,e.JD,c.X,f.Jj],styles:[".invite__input[_ngcontent-%COMP%]{resize:vertical}.invite__actions[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between;align-items:center}.invite__actions--compact[_ngcontent-%COMP%]{justify-content:flex-end}.invite__buttons[_ngcontent-%COMP%]{display:flex;flex-direction:row;margin:8px auto}.invite--inline[_ngcontent-%COMP%]   .invite__button[_ngcontent-%COMP%]{margin-left:16px}.invite--inline[_ngcontent-%COMP%]   .invite__buttons[_ngcontent-%COMP%]{justify-content:flex-end}.invite--block[_ngcontent-%COMP%]   .invite__button[_ngcontent-%COMP%]{margin:16px 0}.invite--block[_ngcontent-%COMP%]   .invite__buttons[_ngcontent-%COMP%]{justify-content:flex-end;flex-direction:column}"],changeDetection:0}),l([(0,r.l6)(g.e.getInviting),p("design:type",C.c)],D.prototype,"inviting$",void 0),l([(0,r.l6)(v.k.getUserRoles),p("design:type",C.c)],D.prototype,"userRoles$",void 0)},21827:(ge,F,n)=>{"use strict";n.d(F,{H:()=>V});var g,t=n(54438),e=n(65763),r=n(85052),o=n(37925),C=n(2573),E=n(82608),y=n(99504),d=n(95416),_=n(21007),v=n(60177),b=n(26779),P=n(97352),s=n(70914);const S=(M,N,W,$)=>({"team-join--compact":M,"team-join--readonly":N,"team-join--theme-dark":W,"team-join--theme-light":$});function f(M,N){1&M&&(t.j41(0,"div",3),t.nrm(1,"app-spinner",4),t.k0s())}function m(M,N){if(1&M&&(t.j41(0,"div",12),t.nrm(1,"img",13),t.k0s()),2&M){const W=t.XpG(2);t.R7$(),t.Y8G("src",W.pendingJoinOrganization.logoUrl,t.B4B)}}function i(M,N){if(1&M&&(t.j41(0,"div",14),t.EFF(1),t.k0s()),2&M){const W=t.XpG(2);t.R7$(),t.SpI(" ",W.pendingJoinOrganization.name," ")}}function c(M,N){if(1&M&&(t.j41(0,"div",15),t.EFF(1),t.k0s()),2&M){const W=t.XpG(2);t.R7$(),t.SpI(" ",W.pendingJoinOrganization.members," ")}}function a(M,N){if(1&M){const W=t.RV6();t.j41(0,"button",16),t.bIt("click",function(){t.eBV(W);const ne=t.XpG(2);return t.Njj(ne.handleCancelJoinClick(ne.pendingJoinRequest.join_request_key))}),t.EFF(1," Cancel Request "),t.k0s()}}function l(M,N){if(1&M&&(t.qex(0),t.nrm(1,"app-html",5),t.j41(2,"div",6)(3,"div",7),t.DNE(4,m,2,1,"div",8)(5,i,2,1,"div",9)(6,c,2,1,"div",10),t.k0s(),t.DNE(7,a,2,0,"button",11),t.k0s(),t.bVm()),2&M){const W=t.XpG();t.R7$(),t.Y8G("markdownText",W.joinRequestText),t.R7$(3),t.Y8G("ngIf",W.pendingJoinOrganization.logoUrl),t.R7$(),t.Y8G("ngIf",!W.compact||!W.pendingJoinOrganization.logoUrl),t.R7$(),t.Y8G("ngIf",!W.compact),t.R7$(),t.Y8G("ngIf",!W.readonly)}}function p(M,N){if(1&M&&(t.j41(0,"div",12),t.nrm(1,"img",13),t.k0s()),2&M){const W=t.XpG(2).$implicit;t.R7$(),t.Y8G("src",W.logoUrl,t.B4B)}}function A(M,N){if(1&M&&(t.j41(0,"div",14),t.EFF(1),t.k0s()),2&M){const W=t.XpG(2).$implicit;t.R7$(),t.SpI(" ",W.name," ")}}function O(M,N){if(1&M&&(t.j41(0,"div",15),t.EFF(1),t.k0s()),2&M){const W=t.XpG(2).$implicit;t.R7$(),t.SpI(" ",W.members," ")}}function L(M,N){if(1&M){const W=t.RV6();t.j41(0,"button",21),t.bIt("click",function(){t.eBV(W);const ne=t.XpG(2).$implicit,Q=t.XpG(2);return t.Njj(Q.handleRequestJoinClick(ne.id))}),t.EFF(1," Request to Join "),t.k0s()}}function k(M,N){if(1&M&&(t.j41(0,"div",6)(1,"div",7),t.DNE(2,p,2,1,"div",8)(3,A,2,1,"div",9)(4,O,2,1,"div",10),t.k0s(),t.DNE(5,L,2,0,"button",20),t.k0s()),2&M){const W=t.XpG().$implicit,$=t.XpG(2);t.R7$(2),t.Y8G("ngIf",W.logoUrl),t.R7$(),t.Y8G("ngIf",!$.compact||!W.logoUrl),t.R7$(),t.Y8G("ngIf",!$.compact),t.R7$(),t.Y8G("ngIf",!$.readonly)}}function q(M,N){if(1&M&&(t.j41(0,"div"),t.DNE(1,k,6,4,"div",19),t.k0s()),2&M){const W=N.index,$=t.XpG(2);t.R7$(),t.Y8G("ngIf",0===W||$.showAllOrganizations)}}function B(M,N){if(1&M){const W=t.RV6();t.j41(0,"button",22),t.bIt("click",function(){t.eBV(W);const ne=t.XpG(2);return t.Njj(ne.toggleShowAllOrganizations())}),t.j41(1,"div",23),t.EFF(2),t.nrm(3,"app-icon",24),t.k0s()()}if(2&M){const W=t.XpG(2);t.Y8G("uppercase",!1),t.R7$(2),t.SpI(" ",W.toggleText," "),t.R7$(),t.Y8G("icon",W.showAllOrganizations?"caret-up":"caret-down")}}function j(M,N){if(1&M&&(t.qex(0),t.nrm(1,"app-html",5),t.DNE(2,q,2,1,"div",17)(3,B,4,3,"button",18),t.bVm()),2&M){const W=t.XpG();t.R7$(),t.Y8G("markdownText",W.requestOrganizationsText),t.R7$(),t.Y8G("ngForOf",W.requestOrganizations),t.R7$(),t.Y8G("ngIf",W.showToggle)}}class V{get joinRequestText(){if(this._joinRequestText)return this._joinRequestText;{let N=this.pendingJoinOrganization?.name;return N=N?`${N} team`:"team",`Your request to join the ${N} is pending approval from a team administrator. It will automatically expire in 14 days if not approved.`}}set joinRequestText(N){this._joinRequestText=N}constructor(N,W,$,ne){this.changeDetectorRef=N,this.store=W,this.actions=$,this.snackBar=ne,this.readonly=!1,this.compact=!1,this.theme="dark",this.organizations=[],this._joinRequestText="",this.requestOrganizationsText="It looks like some of your teammates are already using the BioDigital Human.",this.pendingJoinRequestSuccess=new t.bkB,this.requestOrganizationsSuccess=new t.bkB,this.joinRequestsLoaded=!1,this.requestOrganizations=[],this.showAllOrganizations=!1,this.showToggle=!1,this.showMoreText="",this.ngUnsubscribe=new r.B}get showPendingRequest(){return void 0!==this.pendingJoinRequest}get showRequestOrganizations(){return void 0===this.pendingJoinRequest&&this.requestOrganizations.length>0}get toggleText(){return this.showAllOrganizations?"Show less":this.showMoreText}ngOnInit(){this.initEventListeners(),this.initRequests()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}initRequests(){this.showAllOrganizations=!this.compact,0===this.organizations.length?this.store.dispatch(new E.dG):this.createRequestOrganizations(this.organizations)}initEventListeners(){this.actions.pipe((0,e.xi)(E.CW),(0,o.Q)(this.ngUnsubscribe)).subscribe(()=>this.handleGetJoinRequestsSuccess()),this.actions.pipe((0,e.xi)(E.ZO),(0,o.Q)(this.ngUnsubscribe)).subscribe(()=>this.handleGetEligibleOrganizationsSuccess()),this.actions.pipe((0,e.xi)(E.ku),(0,o.Q)(this.ngUnsubscribe)).subscribe(()=>{this.snackBar.open("Join request successfully cancelled.")}),this.actions.pipe((0,e.xi)(E.Bf),(0,o.Q)(this.ngUnsubscribe)).subscribe(()=>{this.snackBar.open("There was an error with cancelling the request.")}),this.actions.pipe((0,e.xi)(E._b),(0,o.Q)(this.ngUnsubscribe)).subscribe(()=>{this.snackBar.open("There was an error with making this request.")})}handleRequestJoinClick(N){this.store.dispatch(new E.CA(N))}handleCancelJoinClick(N){this.store.dispatch(new E.XW(N))}toggleShowAllOrganizations(){this.showAllOrganizations=!this.showAllOrganizations}handleGetJoinRequestsSuccess(){this.joinRequestsLoaded=!0,this.pendingJoinRequest=this.store.selectSnapshot(y.e.getPendingJoinRequest),this.pendingJoinRequest?this.pendingJoinOrganization=this.createDisplayOrganization(this.pendingJoinRequest.request_organization):this.store.dispatch(new E.Ae),this.pendingJoinRequestSuccess.next(this.pendingJoinRequest),this.changeDetectorRef.markForCheck()}handleGetEligibleOrganizationsSuccess(){this.createRequestOrganizations(this.store.selectSnapshot(y.e.getEligibleOrganizations)),this.requestOrganizationsSuccess.next(this.requestOrganizations),this.changeDetectorRef.markForCheck()}createRequestOrganizations(N){this.showToggle=this.compact&&N.length>1;const W=N.length-1;this.showMoreText=`Show ${W} more team${1===W?"":"s"}`,this.requestOrganizations=N.map(this.createDisplayOrganization,this),this.requestOrganizations.sort(($,ne)=>ne.logoUrl&&!$.logoUrl?1:-1),this.changeDetectorRef.markForCheck()}createDisplayOrganization(N){return{id:N.organization_id,name:N.organization_name,logoUrl:N.group_logos.default,members:`${N.users_count} member${1===N.users_count?"":"s"}`}}}(g=V).\u0275fac=function(N){return new(N||g)(t.rXU(t.gRc),t.rXU(e.il),t.rXU(e.En),t.rXU(d.UG))},g.\u0275cmp=t.VBU({type:g,selectors:[["app-team-join"]],inputs:{readonly:"readonly",compact:"compact",theme:"theme",organizations:"organizations",joinRequestText:"joinRequestText",requestOrganizationsText:"requestOrganizationsText"},outputs:{pendingJoinRequestSuccess:"pendingJoinRequestSuccess",requestOrganizationsSuccess:"requestOrganizationsSuccess"},decls:7,vars:15,consts:[[1,"team-join",3,"ngClass"],["class","my-6",4,"ngIf"],[4,"ngIf"],[1,"my-6"],["size","huge"],[1,"team-join__text","block","my-4",3,"markdownText"],[1,"team-join__organization","flex","justify-between","mb-3"],[1,"team-join__organization-info","flex","flex-col"],["class","mb-3",4,"ngIf"],["class","team-join__organization-name",4,"ngIf"],["class","team-join__organization-members",4,"ngIf"],["type","submit","app-button","","buttonTheme","light","buttonType","flat",3,"click",4,"ngIf"],[1,"mb-3"],[1,"team-join__organization-logo",3,"src"],[1,"team-join__organization-name"],[1,"team-join__organization-members"],["type","submit","app-button","","buttonTheme","light","buttonType","flat",3,"click"],[4,"ngFor","ngForOf"],["app-button","","buttonSize","xs","buttonType","text","buttonTheme","light",3,"uppercase","click",4,"ngIf"],["class","team-join__organization flex justify-between mb-3",4,"ngIf"],["type","submit","buttonTheme","light","app-button","","buttonType","primary",3,"click",4,"ngIf"],["type","submit","buttonTheme","light","app-button","","buttonType","primary",3,"click"],["app-button","","buttonSize","xs","buttonType","text","buttonTheme","light",3,"click","uppercase"],[1,"text-sm","underline"],[1,"pl-1",3,"icon"]],template:function(N,W){1&N&&(t.j41(0,"div",0),t.DNE(1,f,2,0,"div",1),t.nI1(2,"async"),t.DNE(3,l,8,5,"ng-container",2),t.nI1(4,"async"),t.DNE(5,j,4,3,"ng-container",2),t.nI1(6,"async"),t.k0s()),2&N&&(t.Y8G("ngClass",t.ziG(10,S,W.compact,W.readonly,"dark"===W.theme,"light"===W.theme)),t.R7$(),t.Y8G("ngIf",t.bMT(2,4,W.requesting$)),t.R7$(2),t.Y8G("ngIf",!1===t.bMT(4,6,W.requesting$)&&W.showPendingRequest),t.R7$(2),t.Y8G("ngIf",!1===t.bMT(6,8,W.requesting$)&&W.showRequestOrganizations))},dependencies:[_.Q,v.YU,v.Sq,v.bT,b.R,P.tI,s.V,v.Jj],styles:[".team-join__text[_ngcontent-%COMP%]{font-size:.875rem;line-height:1.25rem}.team-join--theme-light[_ngcontent-%COMP%]   .team-join__text[_ngcontent-%COMP%]{color:#283853}.team-join__organization[_ngcontent-%COMP%]{border:1px solid #d7e0ea;border-radius:4px;padding:16px}.team-join__organization-info[_ngcontent-%COMP%]{flex-basis:50%}.team-join__organization-logo[_ngcontent-%COMP%]{display:block;max-height:32px;max-width:100%}.team-join__organization-name[_ngcontent-%COMP%]{font-size:1rem;line-height:1.5rem;font-weight:600}.team-join__organization-members[_ngcontent-%COMP%]{font-size:.75rem;line-height:1rem;font-weight:500;color:#61779e}.team-join--compact[_ngcontent-%COMP%]   .team-join__text[_ngcontent-%COMP%]{font-size:.875rem;line-height:1.25rem}.team-join--compact[_ngcontent-%COMP%]   .team-join__organization[_ngcontent-%COMP%]{border:none;border-radius:0;padding:0}.team-join--compact[_ngcontent-%COMP%]   .team-join__organization-name[_ngcontent-%COMP%]{font-size:.875rem;line-height:1.25rem;font-weight:500}.team-join--readonly[_ngcontent-%COMP%]   .team-join__organization-info[_ngcontent-%COMP%]{flex-basis:auto}"],changeDetection:0}),function(M,N,W,$){var le,ne=arguments.length,Q=ne<3?N:null===$?$=Object.getOwnPropertyDescriptor(N,W):$;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)Q=Reflect.decorate(M,N,W,$);else for(var pe=M.length-1;pe>=0;pe--)(le=M[pe])&&(Q=(ne<3?le(Q):ne>3?le(N,W,Q):le(N,W))||Q);ne>3&&Q&&Object.defineProperty(N,W,Q)}([(0,e.l6)(y.e.getRequesting),function(M,N){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata("design:type",N)}(0,C.c)],V.prototype,"requesting$",void 0)},45438:(ge,F,n)=>{"use strict";n.d(F,{o:()=>S});var t=n(65763),e=n(2573),r=n(16823),o=n(54438),C=n(60177),E=n(26779);function y(f,m){if(1&f&&o.nrm(0,"app-icon",2),2&f){const i=o.XpG();o.Y8G("icon",i.icon)}}let d=(()=>{var f;class m{constructor(){this.size="medium",this.type="outline",this.color="#CCCCCC"}ngOnInit(){}}return(f=m).\u0275fac=function(c){return new(c||f)},f.\u0275cmp=o.VBU({type:f,selectors:[["app-profile-badge"]],inputs:{size:"size",type:"type",color:"color",icon:"icon",label:"label"},decls:3,vars:12,consts:[[1,"badge","uppercase"],[3,"icon",4,"ngIf"],[3,"icon"]],template:function(c,a){1&c&&(o.j41(0,"div",0),o.DNE(1,y,1,1,"app-icon",1),o.EFF(2),o.k0s()),2&c&&(o.AVh("badge--outline","outline"===a.type)("badge--solid","solid"===a.type)("badge--small","small"===a.size)("badge--medium","medium"===a.size)("badge--large","large"===a.size),o.R7$(),o.Y8G("ngIf",a.icon),o.R7$(),o.SpI(" ",a.label,"\n"))},dependencies:[C.bT,E.R],styles:[".badge[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;border-radius:50%;color:#101823}.badge--outline[_ngcontent-%COMP%]{border:1px solid #ffffff;background-color:#96a8c099;color:#fff}.badge--small[_ngcontent-%COMP%]{width:32px;height:32px;font-size:.75rem;line-height:1rem}.badge--medium[_ngcontent-%COMP%]{width:40px;height:40px;font-size:.875rem;line-height:1.25rem}.badge--large[_ngcontent-%COMP%]{width:48px;height:48px;font-size:1rem;line-height:1.5rem}.badge--x-large[_ngcontent-%COMP%]{width:48px;height:48px;font-size:1.125rem;line-height:1.75rem}"],changeDetection:0}),m})();var _;const P=(f,m)=>({"team-user--light":f,"team-user--dark":m});function s(f,m){if(1&f&&(o.j41(0,"div",8),o.EFF(1),o.k0s()),2&f){const i=o.XpG();o.R7$(),o.SpI(" ",i.user.name||"<Name Unknown>"," ")}}function g(f,m){1&f&&(o.j41(0,"div",9),o.EFF(1,"Developer"),o.k0s())}function u(f,m){if(1&f&&(o.j41(0,"div",10),o.EFF(1),o.k0s()),2&f){const i=o.XpG();o.R7$(),o.SpI(" ",i.user.email," ")}}function h(f,m){if(1&f&&(o.j41(0,"div",11),o.EFF(1),o.k0s()),2&f){const i=o.XpG();o.AVh("team-user__role--expired","expired"===i.user.invitationStatus),o.R7$(),o.SpI(" ",i.user.invitationStatus?i.user.invitationStatus:i.user.role.role_display_name," ")}}class S{constructor(){this.showEmail=!1,this.showRole=!0,this.theme="light"}set showNameUnknown(m){this.showName=m||this.user.name.length>0}}(_=S).\u0275fac=function(m){return new(m||_)},_.\u0275cmp=o.VBU({type:_,selectors:[["app-team-user"]],inputs:{user:"user",showEmail:"showEmail",showNameUnknown:"showNameUnknown",showRole:"showRole",theme:"theme"},decls:8,vars:10,consts:[[1,"team-user","flex","flex-row","grow","align-center","items-center",3,"ngClass"],[1,"team-user__badge","mr-3"],["type","outline","size","small",3,"label","icon"],[1,"team-user__text"],["class","team-user__name text-sm","data-test","teamMemberName",4,"ngIf"],["class","team-user__developer",4,"ngIf"],["class","team-user__email text-xs","data-test","teamMemberEmail",4,"ngIf"],["class","team-user__role flex flex-row items-center justify-end mx-2 text-2xs","data-test","teamMemberInfo",3,"team-user__role--expired",4,"ngIf"],["data-test","teamMemberName",1,"team-user__name","text-sm"],[1,"team-user__developer"],["data-test","teamMemberEmail",1,"team-user__email","text-xs"],["data-test","teamMemberInfo",1,"team-user__role","flex","flex-row","items-center","justify-end","mx-2","text-2xs"]],template:function(m,i){1&m&&(o.j41(0,"div",0)(1,"div",1),o.nrm(2,"app-profile-badge",2),o.k0s(),o.j41(3,"div",3),o.DNE(4,s,2,1,"div",4)(5,g,2,0,"div",5)(6,u,2,1,"div",6),o.k0s(),o.DNE(7,h,2,3,"div",7),o.k0s()),2&m&&(o.Y8G("ngClass",o.l_i(7,P,"light"===i.theme,"dark"===i.theme)),o.R7$(2),o.Y8G("label",i.user.initials)("icon",i.user.initials?"":"user"),o.R7$(2),o.Y8G("ngIf",i.showName),o.R7$(),o.Y8G("ngIf",i.user.activeDeveloper),o.R7$(),o.Y8G("ngIf",i.showEmail),o.R7$(),o.Y8G("ngIf",i.showRole))},dependencies:[C.YU,C.bT,d],styles:[".team-user__badge[_ngcontent-%COMP%]{align-self:center}.team-user__text[_ngcontent-%COMP%]{width:0;flex-grow:1;flex-shrink:1;overflow:hidden}.team-user__name[_ngcontent-%COMP%]{color:#1c2a3f;overflow:hidden;text-overflow:ellipsis}.team-user__developer[_ngcontent-%COMP%]{height:16px;padding:0 8px;margin:4px 0;display:inline-flex;align-items:center;justify-content:center;font-size:8px;color:#374a68;background-color:#eaeff5;border-radius:8px;border:1px solid #96a8c0;text-transform:uppercase}.team-user__email[_ngcontent-%COMP%]{color:#374a68;overflow:hidden;text-overflow:ellipsis}.team-user__role[_ngcontent-%COMP%]{text-transform:uppercase;color:#96a8c0}.team-user__role--expired[_ngcontent-%COMP%]{color:#ed4758}.team-user--dark[_ngcontent-%COMP%]   .team-user__developer[_ngcontent-%COMP%]{background-color:#f9fafd}"],changeDetection:0}),function(f,m,i,c){var p,a=arguments.length,l=a<3?m:null===c?c=Object.getOwnPropertyDescriptor(m,i):c;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(f,m,i,c);else for(var A=f.length-1;A>=0;A--)(p=f[A])&&(l=(a<3?p(l):a>3?p(m,i,l):p(m,i))||l);a>3&&l&&Object.defineProperty(m,i,l)}([(0,t.l6)(r.k.isAdmin),function(f,m){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata("design:type",m)}(0,e.c)],S.prototype,"isAdmin$",void 0)},22397:(ge,F,n)=>{"use strict";n.d(F,{P:()=>y,R:()=>d});var t=n(68947);const e="mp3",r=3e3,o={voiceId:"Amy",voiceLocaleId:"en-GB",supportedLocaleIds:["en-US"],engine:"neural"},C=[o,{voiceId:"Mia",voiceLocaleId:"es-MX",supportedLocaleIds:["es-ES"],engine:"neural"},{voiceId:"Zhiyu",voiceLocaleId:"cmn-CN",supportedLocaleIds:["zh-CN"],engine:"neural"},{voiceId:"Lea",voiceLocaleId:"fr-FR",supportedLocaleIds:[],engine:"neural"},{voiceId:"Vicki",voiceLocaleId:"de-DE",supportedLocaleIds:[],engine:"neural"},{voiceId:"Bianca",voiceLocaleId:"it-IT",supportedLocaleIds:[],engine:"neural"},{voiceId:"Takumi",voiceLocaleId:"ja-JP",supportedLocaleIds:["ja"],engine:"neural"},{voiceId:"Camila",voiceLocaleId:"pt-BR",supportedLocaleIds:["pt-PT"],engine:"neural"}];function y(_){return C.find(v=>{const{voiceLocaleId:b,supportedLocaleIds:P}=v;return b===_||P.includes(_)})}function d(_,v){return(_.length>r?t.l.splitTextByCharacterCount(_,r):[_]).map(s=>function E(_,v){const s=y(v)??o,{voiceId:g,engine:u,voiceLocaleId:h}=s;return`/ws/polly/synthesize?text=${encodeURIComponent(_)}&voice_id=${g}&format=${e}&lang=${h}&engine=${u}&version=2`}(s,v))}},18824:(ge,F,n)=>{"use strict";n.d(F,{j:()=>C});var t=n(60177),e=n(11818),r=n(72026),o=n(54438);let C=(()=>{var E;class y{}return(E=y).\u0275fac=function(_){return new(_||E)},E.\u0275mod=o.$C({type:E}),E.\u0275inj=o.G2t({imports:[t.MD,e.C,r.o]}),y})()},5584:(ge,F,n)=>{"use strict";n.d(F,{d:()=>o});var t=n(60177),e=n(72026),r=n(54438);let o=(()=>{var C;class E{}return(C=E).\u0275fac=function(d){return new(d||C)},C.\u0275mod=r.$C({type:C}),C.\u0275inj=r.G2t({imports:[t.MD,e.o]}),E})()},12854:(ge,F,n)=>{"use strict";n.d(F,{X:()=>g});var t=n(54438),e=n(78109),r=n(65763),o=n(44867),C=n(47610),E=n(82542),y=n(60177),d=n(60724);const _=(u,h)=>h.id,v=u=>({"tree-group--light":u});function b(u,h){if(1&u){const S=t.RV6();t.j41(0,"div",5),t.bIt("click",function(){t.eBV(S);const m=t.XpG(2).$implicit,i=t.XpG();return t.Njj(i.handleExpandClick(m,!0))}),t.k0s()}if(2&u){const S=t.XpG(2).$implicit;t.Y8G("title",S.label)}}function P(u,h){if(1&u&&(t.j41(0,"div",2),t.DNE(1,b,1,1,"div",3),t.nrm(2,"app-tree-group",4),t.k0s()),2&u){const S=t.XpG().$implicit,f=t.XpG();t.R7$(),t.vxM(1,f.hasChildren(S)?1:-1),t.R7$(),t.Y8G("graph",f.graph())("graphNode",S)("theme",f.theme())("layerOrderMode",f.layerOrderMode())("showTreeNodeIds",f.showTreeNodeIds())("showLatinLabel",f.showLatinLabel())}}function s(u,h){if(1&u&&(t.j41(0,"div",0),t.nrm(1,"app-tree-nested-node",1),t.DNE(2,P,3,7,"div",2),t.k0s()),2&u){const S=h.$implicit,f=t.XpG();t.Y8G("ngClass",t.eq3(8,v,f.theme()===f.themeEnum.Light)),t.R7$(),t.Y8G("graph",f.graph())("node",S)("theme",f.theme())("layerOrderMode",f.layerOrderMode())("showTreeNodeIds",f.showTreeNodeIds())("showLatinLabel",f.showLatinLabel()),t.R7$(),t.vxM(2,S.boolState.expanded?2:-1)}}let g=(()=>{var u;class h{constructor(f,m){this.graphService=f,this.store=m,this.themeEnum=E.P,this.graph=t.hFB.required(),this.layerOrderMode=t.hFB.required(),this.showTreeNodeIds=t.hFB.required(),this.showLatinLabel=t.hFB.required(),this.graphNode=(0,t.hFB)(),this.theme=(0,t.hFB)(E.P.Dark),this.nodes=(0,t.EWP)(()=>{const i=this.graphNode(),c=this.graph(),a=i?(0,o.IA)(c,i.id):(0,o.ug)(c);return this.graphService.getNodes(c,a)})}hasChildren(f){const m=this.graph();return(0,o.IA)(m,f.id).length>0}handleExpandClick(f,m){this.store.dispatch(m?new C.z(f):new C._o(f))}}return(u=h).\u0275fac=function(f){return new(f||u)(t.rXU(e.w),t.rXU(r.il))},u.\u0275cmp=t.VBU({type:u,selectors:[["app-tree-group"]],inputs:{graph:[t.Mj6.SignalBased,"graph"],layerOrderMode:[t.Mj6.SignalBased,"layerOrderMode"],showTreeNodeIds:[t.Mj6.SignalBased,"showTreeNodeIds"],showLatinLabel:[t.Mj6.SignalBased,"showLatinLabel"],graphNode:[t.Mj6.SignalBased,"graphNode"],theme:[t.Mj6.SignalBased,"theme"]},standalone:!0,features:[t.aNF],decls:2,vars:0,consts:[[1,"tree-group",3,"ngClass"],[3,"graph","node","theme","layerOrderMode","showTreeNodeIds","showLatinLabel"],[1,"tree-group__children"],[1,"tree-group__collapse",3,"title"],[3,"graph","graphNode","theme","layerOrderMode","showTreeNodeIds","showLatinLabel"],[1,"tree-group__collapse",3,"click","title"]],template:function(f,m){1&f&&t.Z7z(0,s,3,10,"div",0,_),2&f&&t.Dyx(m.nodes())},dependencies:[u,y.MD,y.YU,d.r],styles:['.tree-group[_ngcontent-%COMP%]{-webkit-user-select:none;user-select:none}.tree-group--light[_ngcontent-%COMP%]   .tree-group__collapse[_ngcontent-%COMP%]:after{background:#eaeff5}.tree-group--light[_ngcontent-%COMP%]   .tree-group__collapse[_ngcontent-%COMP%]:hover{background:transparent}.tree-group--light[_ngcontent-%COMP%]   .tree-group__collapse[_ngcontent-%COMP%]:hover:after{background:#d7e0ea}.tree-group__children[_ngcontent-%COMP%]{padding-inline-start:20px;position:relative}.tree-group__collapse[_ngcontent-%COMP%]{position:absolute;inset-inline-start:0;top:0;bottom:0;width:20px;z-index:1}.tree-group__collapse[_ngcontent-%COMP%]:after{content:" ";display:block;position:absolute;width:1px;inset-inline-start:10px;top:0;bottom:0;background:#1c2a3f}.tree-group__collapse[_ngcontent-%COMP%]:hover{cursor:pointer}.tree-group__collapse[_ngcontent-%COMP%]:hover:after{background:#283853}'],changeDetection:0}),h})()},60724:(ge,F,n)=>{"use strict";n.d(F,{r:()=>N});var t=n(54438),e=n(89079),r=n(65763),o=n(47610),C=n(13409),E=n(24418),y=n(44867),d=n(61295),_=n(55494),v=n(82542),b=n(35650),P=n(43631),s=n(60177),g=n(89511),u=n(11818),h=n(72026),S=n(82192),f=n(38645),m=n(37737),i=n(25780),c=n(49989),a=n(21007),l=n(26779),p=n(90413);const A=(W,$,ne,Q)=>({"tree-node--light":W,"tree-node--hidden":$,"tree-node--selected":ne,"tree-node--unpickable":Q}),O=W=>({"tree-node__label--padded":W});function L(W,$){if(1&W){const ne=t.RV6();t.j41(0,"button",14),t.bIt("click",function(){t.eBV(ne);const le=t.XpG();return t.Njj(le.handleExpandClick(le.node()))}),t.nrm(1,"app-icon",15),t.k0s()}if(2&W){const ne=t.XpG();t.Y8G("buttonTheme",ne.theme()),t.BMQ("aria-label",ne.getExpandedLabel(ne.node()))("aria-expanded",ne.node().boolState.expanded),t.R7$(),t.AVh("rotate-45",ne.node().boolState.expanded)}}function k(W,$){if(1&W&&(t.j41(0,"div",18),t.EFF(1),t.k0s()),2&W){const ne=t.XpG(2);t.R7$(),t.SpI(" ",ne.shortId()," ")}}function q(W,$){1&W&&t.nrm(0,"app-icon",20)}function B(W,$){if(1&W&&(t.j41(0,"div",22),t.EFF(1),t.k0s()),2&W){const ne=t.XpG(2);t.R7$(),t.SpI(" ",ne.node().latinLabel," ")}}function j(W,$){if(1&W){const ne=t.RV6();t.j41(0,"div",16),t.bIt("dblclick",function(){t.eBV(ne);const le=t.XpG();return t.Njj(le.setEditLabelMode(!0))}),t.j41(1,"div",17),t.DNE(2,k,2,1,"div",18),t.j41(3,"div",19),t.DNE(4,q,1,0,"app-icon",20),t.j41(5,"span",21),t.pXf(6,2),t.k0s(),t.EFF(7),t.k0s(),t.DNE(8,B,2,1,"div",22),t.k0s()()}if(2&W){const ne=t.XpG();t.Y8G("ngClass",t.eq3(6,O,!ne.hasChildren()&&ne.nested())),t.BMQ("aria-current",ne.checked()),t.R7$(2),t.vxM(2,ne.showTreeNodeIds()?2:-1),t.R7$(2),t.vxM(4,ne.perChapterTreeEnabled()&&!1===ne.node().boolState.available?4:-1),t.R7$(3),t.SpI(" ",ne.node().label," "),t.R7$(),t.vxM(8,ne.showLatinLabel()&&ne.node().latinLabel?8:-1)}}function V(W,$){if(1&W){const ne=t.RV6();t.j41(0,"input",23),t.bIt("blur",function(le){t.eBV(ne);const pe=t.XpG();return t.Njj(pe.handleObjectLabel(le))})("keyup",function(le){t.eBV(ne);const pe=t.XpG();return t.Njj(pe.handleObjectLabel(le))}),t.k0s()}if(2&W){const ne=t.XpG();t.Y8G("value",ne.node().label)}}function M(W,$){if(1&W){const ne=t.RV6();t.j41(0,"input",24),t.bIt("change",function(le){t.eBV(ne);const pe=t.XpG();return t.Njj(pe.handleLayerOrder(le,pe.node()))}),t.k0s()}if(2&W){const ne=t.XpG();t.Y8G("value",ne.node().numState.layer)}}let N=(()=>{var W;class ${constructor(Q,le,pe){this.store=Q,this.sceneService=le,this.router=pe,this.themeEnum=v.P,this.isLoft="module"===E.c.exportType,this.nodes=(0,e.ot)(this.store.select(C.z.getNodes)),this.labelEditNode=(0,e.ot)(this.store.select(_.S.getLabelEditNode)),this.perChapterTreeEnabled=(0,e.ot)(this.store.select(P._.getPerChapterTreeEnabled)),this.graph=t.hFB.required(),this.node=t.hFB.required(),this.layerOrderMode=(0,t.hFB)(),this.showTreeNodeIds=(0,t.hFB)(),this.showLatinLabel=(0,t.hFB)(),this.nested=(0,t.hFB)(!0),this.theme=(0,t.hFB)(v.P.Dark),this.hasChildren=(0,t.EWP)(()=>{const ie=this.node(),be=this.graph();return this.nodeHasChildren(be,ie?.id)}),this.checked=(0,t.EWP)(()=>{const ie=this.node(),be=this.nodes();return this.isNodeChecked(be,ie.id)}),this.editLabelMode=(0,t.EWP)(()=>{const ie=this.node(),be=this.labelEditNode();return ie.id===be?.id}),this.sanitizedID=(0,t.EWP)(()=>{const ie=this.node();return(0,y.Nk)(ie.id)}),this.shortId=(0,t.EWP)(()=>{const ie=this.node();return(0,y.KJ)(ie.id).replace(/_/g," ")})}ngOnInit(){this.isEditMode=this.router.url.indexOf("/edit")>=0}isNodeChecked(Q,le){return Q[le].checked}nodeHasChildren(Q,le){return!(!Q||!le)&&(0,y.IA)(Q,le).length>0}getExpandedLabel(Q){const{boolState:le,label:pe}=Q;return le.expanded?$localize`Collapse`+` ${pe}`:$localize`Expand`+` ${pe}`}handleExpandClick(Q){this.toggleExpanded(Q,Q.boolState.expanded)}toggleVisibleClick(Q){this.toggleVisible(Q,Q.boolState.shown)}handleNodeClick(Q,le){Q.shiftKey?this.checkNode(le):(this.setCheckedNodes(le),this.isFlyToNodeEnabled(le)&&this.store.dispatch(new o.W6(le.id)),this.toggleExpanded(le,!le.boolState.expanded))}toggleVisible(Q,le){this.store.dispatch(new d.yr(!le,[Q.id]))}toggleExpanded(Q,le){this.store.dispatch(le?new o.z(Q):new o._o(Q))}handleLayerOrder(Q,le){const ie=parseInt(Q.target.value,10);this.setLayerOrder(le,ie)}checkNode(Q){const le=this.nodes(),pe=!this.isNodeChecked(le,Q.id);this.store.dispatch(new d.q9(pe,[Q.id]))}setCheckedNodes(Q){const le=this.nodes();this.store.dispatch(new d.q9(!1));const pe=!this.isNodeChecked(le,Q.id);this.store.dispatch(new d.q9(pe,[Q.id]))}setLayerOrder(Q,le){this.store.dispatch(new o.zw([Q],le))}handleObjectLabel(Q){const le=Q.target;Q instanceof KeyboardEvent?("enter"===Q.key.toLowerCase()&&(this.setLabel(le.value),this.setEditLabelMode(!1)),"escape"===Q.key.toLowerCase()&&this.setEditLabelMode(!1)):Q instanceof FocusEvent&&"blur"===Q.type&&(this.setLabel(le.value),this.setEditLabelMode(!1))}setLabel(Q){const le=this.node();this.store.dispatch(new o.$h(le.id,Q))}setEditLabelMode(Q){if(this.isEditMode){const le=this.node();this.store.dispatch(new o.ro(Q?le:null))}}isFlyToNodeEnabled(Q){return!this.isEditMode&&(Q.boolState.shown||this.sceneService.isObjectLoaded(Q.id))}}return(W=$).\u0275fac=function(Q){return new(Q||W)(t.rXU(r.il),t.rXU(b.w),t.rXU(f.Ix))},W.\u0275cmp=t.VBU({type:W,selectors:[["app-tree-nested-node"]],inputs:{graph:[t.Mj6.SignalBased,"graph"],node:[t.Mj6.SignalBased,"node"],layerOrderMode:[t.Mj6.SignalBased,"layerOrderMode"],showTreeNodeIds:[t.Mj6.SignalBased,"showTreeNodeIds"],showLatinLabel:[t.Mj6.SignalBased,"showLatinLabel"],nested:[t.Mj6.SignalBased,"nested"],theme:[t.Mj6.SignalBased,"theme"]},standalone:!0,features:[t.aNF],decls:17,vars:16,consts:()=>{let ne,Q,le;return ne=$localize`:␟6e998fc06a19659c22cca43efa1b35515761cbb2␟5633144232269377096:hide`,Q=$localize`:␟f67337c708d49ce56772539ee443bac996a24f8e␟1504349909398224884:show`,le=$localize`:␟9ca82952a6bc860b5391d5975322d8af8ceddfa4␟3797570084942068182:Select`,[ne,Q,le,["data-test","treeNode",1,"tree-node",3,"keyup.enter","click","ngClass"],["app-button","","appEventFence","","buttonSize","xs","buttonShape","square","data-test","treeNodeExpand",3,"buttonTheme"],["tabindex","0","role","button",1,"tree-node__label",3,"ngClass"],["type","text","appEventFence","","appAutoFocus","","data-test","treeNodeEditLabel",1,"input",3,"value"],["appEventFence","","type","text","data-test","treeNodeLayerOrder",1,"input","input--small","tree-node__layer-order",3,"value"],["app-button","","buttonSize","xs","buttonShape","square","data-test","treeNodeVisible","appEventFence","",1,"tree-node__visible",3,"click","buttonTheme"],["icon","eye","data-test","treeNodeVisibleTrue","size","xs",1,"text-sm","tree-node__eye"],[1,"sr-only","tree-node__eye"],["icon","eye-slash","data-test","treeNodeVisibleFalse","size","xs",1,"text-sm","tree-node__eye-slash"],[1,"sr-only","tree-node__eye-slash"],["eventCategory","Search Node","appEventFence","",3,"theme","node"],["app-button","","appEventFence","","buttonSize","xs","buttonShape","square","data-test","treeNodeExpand",3,"click","buttonTheme"],["appLogicalDir","","icon","caret-right",1,"inline-block","text-sm"],["tabindex","0","role","button",1,"tree-node__label",3,"dblclick","ngClass"],[1,"flex","flex-col"],["data-test","treeNodeId",1,"uppercase","text-2xs",2,"opacity","0.7"],["data-test","treeNodeLabel",1,"flex","items-center"],["icon","ban","data-test","treeNodeUnavailable","size","xs",1,"mr-1","text-xs","tree-node__unavailable"],[1,"sr-only"],[1,"tree-node__latin-label"],["type","text","appEventFence","","appAutoFocus","","data-test","treeNodeEditLabel",1,"input",3,"blur","keyup","value"],["appEventFence","","type","text","data-test","treeNodeLayerOrder",1,"input","input--small","tree-node__layer-order",3,"change","value"]]},template:function(Q,le){1&Q&&(t.j41(0,"div",3),t.bIt("keyup.enter",function(ie){return le.handleNodeClick(ie,le.node())})("click",function(ie){return le.handleNodeClick(ie,le.node())}),t.DNE(1,L,2,5,"button",4)(2,j,9,8,"div",5)(3,V,1,1,"input",6)(4,M,1,1,"input",7),t.j41(5,"button",8),t.bIt("click",function(){return le.toggleVisibleClick(le.node())}),t.nrm(6,"app-icon",9),t.j41(7,"span",10),t.qex(8),t.pXf(9,0),t.bVm(),t.EFF(10),t.k0s(),t.nrm(11,"app-icon",11),t.j41(12,"span",12),t.qex(13),t.pXf(14,1),t.bVm(),t.EFF(15),t.k0s()(),t.nrm(16,"app-node-actions",13),t.k0s()),2&Q&&(t.Y8G("ngClass",t.ziG(11,A,le.theme()===le.themeEnum.Light,!le.node().boolState.shown,le.checked(),!le.node().boolState.pickable)),t.BMQ("data-id",le.sanitizedID()),t.R7$(),t.vxM(1,le.nested()&&le.hasChildren()?1:-1),t.R7$(),t.vxM(2,le.editLabelMode()?-1:2),t.R7$(),t.vxM(3,le.editLabelMode()?3:-1),t.R7$(),t.vxM(4,le.layerOrderMode()?4:-1),t.R7$(),t.Y8G("buttonTheme",le.theme()),t.R7$(5),t.SpI(" ",le.node().label,""),t.R7$(5),t.SpI(" ",le.node().label,""),t.R7$(),t.Y8G("theme",le.theme())("node",le.node()))},dependencies:[s.MD,s.YU,g.h,m.B,i.L,c.e,u.C,a.Q,h.o,l.R,S.G,p.D],styles:[":host{display:block}.tree-node{border-radius:4px;padding:4px;margin-bottom:4px;display:flex;align-items:center;height:100%;-webkit-user-select:none;user-select:none;min-width:200px;transition:background-color .12s}.tree-node--light{padding-right:12px}.tree-node--light:focus{outline:#2d72dc solid 2px!important;outline-offset:-2px;border-radius:4px}.tree-node--light .tree-node__label{color:#101823;font-size:.75rem;line-height:1rem}.tree-node--light .tree-node__latin-label{color:#374a68;font-size:.625rem;line-height:.75rem;text-transform:lowercase;font-style:italic}.tree-node--light.tree-node--selected{background:transparent;border-left-color:transparent}.tree-node--light.tree-node--selected .tree-node__label{color:#101823!important}.tree-node--light.tree-node--selected .tree-node__expand,.tree-node--light.tree-node--selected .tree-node__visible{color:#101823}.tree-node--light.tree-node--unpickable{border:none}.tree-node--light.tree-node--hidden .tree-node__label,.tree-node--light.tree-node--hidden .tree-node__latin-label{color:#61779e}.tree-node--light .tree-node__expand,.tree-node--light .tree-node__visible{background-color:transparent;color:#96a8c0;border-radius:4px}.tree-node--selected{background-color:#2d72dc}.tree-node--selected .tree-node__label{color:#fff}.tree-node--unpickable{border:1px dashed #61779e}.tree-node--hidden .tree-node__expand,.tree-node--hidden .tree-node__visible,.tree-node--hidden .tree-node__label{color:#96a8c0}.tree-node--hidden .tree-node__visible{visibility:visible}.tree-node.tree-node--hidden.tree-node--selected .tree-node__expand,.tree-node.tree-node--hidden.tree-node--selected .tree-node__visible,.tree-node.tree-node--hidden.tree-node--selected .tree-node__label{color:#fff}.tree-node__label{font-size:.75rem;line-height:1rem;font-weight:400;line-height:1.3em;color:#d7e0ea;padding:8px 4px 8px 12px;display:flex;align-items:center;flex:1 1 100%;min-height:28px}.tree-node__label--padded{padding-left:36px}.tree-node__expand i{transition:transform .12s}.tree-node__expand--open app-icon{transform:rotate(45deg)}.tree-node .tree-node__expand+.tree-node__label{margin-left:-8px}.tree-node__expand,.tree-node__visible{border-radius:4px;color:#d7e0ea;display:flex;flex:0 0 24px;height:24px;justify-content:center;align-items:center;border:none}.tree-node__layer-order{font-size:10px;flex:0 0 56px;min-height:28px;height:28px;padding:4px;margin:2px;text-align:center}.tree-node .tree-node__unavailable{color:#de5959}.tree-node .tree-node__eye,.tree-node .tree-node__eye-slash{display:none}.tree-node:not(.tree-node--hidden) .tree-node__eye{display:inline}.tree-node.tree-node--hidden .tree-node__eye-slash{display:inline}@media (hover: hover){.tree-node__visible{visibility:hidden}.tree-node:hover,.tree-node:focus-within{cursor:pointer}.tree-node:hover .tree-node__visible,.tree-node:focus-within .tree-node__visible{visibility:visible}.tree-node:hover .tree-node__label,.tree-node:focus-within .tree-node__label{color:#fff}.tree-node--light:hover,.tree-node--light:focus-within{background-color:#1018230d}.tree-node--light:hover .tree-node__label,.tree-node--light:focus-within .tree-node__label{color:#101823}.tree-node--light:hover .tree-node__latin-label,.tree-node--light:focus-within .tree-node__latin-label{color:#374a68}.tree-node--light.tree-node--selected{background-color:#1018230d}.tree-node--light.tree-node--selected:hover{background-color:#1018231a}.tree-node--light.tree-node--selected .tree-node__label{color:#101823}.tree-node--light.tree-node--selected .tree-node__expand:hover,.tree-node--light.tree-node--selected .tree-node__visible:hover,.tree-node--light .tree-node__expand:hover,.tree-node--light .tree-node__visible:hover{background-color:transparent;color:inherit}.tree-node__expand:hover,.tree-node__visible:hover{background-color:#1c2a3f;color:#fff;cursor:pointer}.tree-node--selected .tree-node__expand:hover,.tree-node--selected .tree-node__visible:hover{background-color:#2d72dc}.tree-node .tree-node__eye,.tree-node .tree-node__eye-slash{display:none}.tree-node:hover:not(.tree-node--hidden) .tree-node__eye{display:inline}.tree-node.tree-node--hidden .tree-node__eye-slash{display:inline}}\n"],encapsulation:2,changeDetection:0}),$})()},30356:(ge,F,n)=>{"use strict";n.d(F,{k:()=>i});var t=n(54438),e=n(89079),r=n(87996),o=n(14264),C=n(17365),E=n(90917),y=n(82542),d=n(18272),_=n(65763),v=n(47610),b=n(60177),P=n(7806),s=n(60724),g=n(65478),u=n(18617);function h(c,a){1&c&&(t.j41(0,"div",3),t.pXf(1,0),t.k0s())}function S(c,a){if(1&c&&t.nrm(0,"app-tree",4),2&c){const l=t.XpG();t.Y8G("theme",l.theme())("graph",l.searchGraph())("layerOrderMode",l.layerOrderMode())("showTreeNodeIds",l.showTreeNodeIds())("showLatinLabel",l.showLatinLabel())}}function f(c,a){if(1&c&&(t.j41(0,"div"),t.nrm(1,"app-tree-nested-node",8),t.k0s()),2&c){const l=a.$implicit,p=t.XpG(2);t.R7$(),t.Y8G("theme",p.theme())("nested",!1)("node",l)("graph",p.viewGraph())("layerOrderMode",p.layerOrderMode())("showTreeNodeIds",p.showTreeNodeIds())("showLatinLabel",p.showLatinLabel())}}function m(c,a){if(1&c&&(t.j41(0,"cdk-virtual-scroll-viewport",5)(1,"div",6),t.DNE(2,f,2,7,"div",7),t.k0s()()),2&c){const l=t.XpG();t.Y8G("itemSize",64),t.R7$(2),t.Y8G("cdkVirtualForOf",l.searchResults())("cdkVirtualForTrackBy",l.trackTreeNode)}}let i=(()=>{var c;class a{constructor(p,A){this.store=p,this.liveAnnouncer=A,this.treeSearchDisplayMode=d.q,this.selectedChapter=t.hFB.required(),this.theme=(0,t.hFB)(y.P.Dark),this.query=(0,t.hFB)(),this.displayMode=(0,t.hFB)(d.q.List),this.viewGraph=(0,t.hFB)(),this.viewGraphMetadata=(0,t.hFB)(),this.viewGraphRank=t.hFB.required(),this.layerOrderMode=(0,t.hFB)(),this.showTreeNodeIds=(0,t.hFB)(),this.showLatinLabel=(0,t.hFB)(),this.searchResults=(0,t.EWP)(()=>{const O=this.query().trim(),L=this.viewGraph(),k=this.displayMode(),q=this.viewGraphRank();if(k===d.q.Tree)return(0,E.i)(L,O,[{field:"label",dir:"asc"}]);{const B=(0,E.Z6)(Object.values(L.nodes),O);return(0,E.XS)(B,q.initiallyShownRank)}}),this.searchGraph=(0,t.EWP)(()=>{const O=this.viewGraph(),L=this.searchResults();return(0,E.YL)(O,L)}),(0,e.br)(this.query).pipe((0,r.B)(600),(0,e.pQ)()).subscribe(()=>{const O=this.searchResults().length;this.liveAnnouncer.announce(`${O} structures found`)}),(0,e.br)(this.displayMode).pipe((0,o.p)(O=>O===d.q.List),(0,C.s)(1),(0,e.pQ)()).subscribe(()=>{this.store.dispatch(new v.q)})}trackTreeNode(p,A){return A.id}}return(c=a).\u0275fac=function(p){return new(p||c)(t.rXU(_.il),t.rXU(u.Ai))},c.\u0275cmp=t.VBU({type:c,selectors:[["app-tree-search"]],inputs:{selectedChapter:[t.Mj6.SignalBased,"selectedChapter"],theme:[t.Mj6.SignalBased,"theme"],query:[t.Mj6.SignalBased,"query"],displayMode:[t.Mj6.SignalBased,"displayMode"],viewGraph:[t.Mj6.SignalBased,"viewGraph"],viewGraphMetadata:[t.Mj6.SignalBased,"viewGraphMetadata"],viewGraphRank:[t.Mj6.SignalBased,"viewGraphRank"],layerOrderMode:[t.Mj6.SignalBased,"layerOrderMode"],showTreeNodeIds:[t.Mj6.SignalBased,"showTreeNodeIds"],showLatinLabel:[t.Mj6.SignalBased,"showLatinLabel"]},standalone:!0,features:[t.aNF],decls:4,vars:2,consts:()=>{let l;return l=$localize`:␟e4e28b371f8453e22779db590cb0fe67f2a080e8␟7839102902838664367:No results`,[l,[1,"tree-search"],["class","tree-search__empty",4,"ngIf"],[1,"tree-search__empty"],[1,"tree-search__tree",3,"theme","graph","layerOrderMode","showTreeNodeIds","showLatinLabel"],[3,"itemSize"],[1,"flex","flex-col","flex-auto","gap-1"],[4,"cdkVirtualFor","cdkVirtualForOf","cdkVirtualForTrackBy"],[1,"",3,"theme","nested","node","graph","layerOrderMode","showTreeNodeIds","showLatinLabel"]]},template:function(p,A){if(1&p&&(t.j41(0,"div",1),t.DNE(1,h,2,0,"div",2)(2,S,1,5)(3,m,3,3),t.k0s()),2&p){let O;t.R7$(),t.Y8G("ngIf",0===A.searchResults().length),t.R7$(),t.vxM(2,(O=A.displayMode())===A.treeSearchDisplayMode.Tree?2:O===A.treeSearchDisplayMode.List?3:-1)}},dependencies:[b.MD,b.bT,P.g,s.r,g.E9,g.yg,g.E$,g.d6],styles:[".tree-search{display:flex;flex-direction:column;flex:1 1 auto;height:100%}.tree-search__tree{flex-grow:1;width:100%;overflow-y:auto;contain:strict}.tree-search__empty{font-size:.875rem;line-height:1.25rem;padding:12px;font-style:italic;margin-top:12px}.tree-search cdk-virtual-scroll-viewport{flex:1 1 auto}\n"],encapsulation:2,changeDetection:0}),a})()},90917:(ge,F,n)=>{"use strict";n.d(F,{D$:()=>v,XS:()=>b,YL:()=>y,Z6:()=>_,i:()=>d});var t=n(44867),e=n(23881),r=n(49204),C=n(78851);function E(u,h,S){(0,t.iu)(u,h);const f=(0,t.ir)(S,h.id);if(f){const m=u.successors[f]||[];m.push(h.id);const i=S.successors[f];return u.successors[f]=(0,r.uniq)(m).sort((c,a)=>i.indexOf(c)-i.indexOf(a)),u.predecessors[h.id]=f,E(u,(0,t.dV)(S,f),S)}return(0,t.Sg)(u,h),u}function y(u,h){if(0===h.length)return(0,e.q3)();const S=h.reduce((m,i)=>E(m,i,u),(0,e.q3)()),f=Object.keys(u.roots);return S.roots=f.reduce((m,i)=>(i in S.roots&&(m[i]=S.roots[i]),m),{}),S}function d(u,h,S=[]){if((0,r.isEmpty)(u))return[];const m=_(Object.values(u.nodes),h);return S.length>0?v(m,S):m}function _(u,h){return h=(0,C.TF)(h.toLowerCase()),u.filter(S=>{const{label:f,latinLabel:m}=S;if(0===h.length)return!0;const i=(0,C.TF)(f.toLowerCase()??""),c=m?.toLowerCase()??"";return i.includes(h)||c.includes(h)})}function v(u,h){return u.sort((S,f)=>{for(let m=0;m<h.length;m++){const{field:i,dir:c}=h[m];if("label"===i){const a=P(S.label,f.label,"asc"===c);if(0!==a)return a}if("depth"===i){const a=s(S.depth,f.depth,"asc"===c);if(0!==a)return a}if("shown"===i){const a=g(S.boolState.shown,f.boolState.shown,"asc"===c);if(0!==a)return a}}return 0})}function b(u,h){return u.sort((S,f)=>h[S.id]-h[f.id])}function P(u,h,S){return S?u.localeCompare(h):h.localeCompare(u)}function s(u,h,S){const f=Math.sign(u-h);return S?f:-f}function g(u,h,S){const f=Math.sign(Number(h)-Number(u));return S?f:-f}},90556:(ge,F,n)=>{"use strict";n.d(F,{f:()=>P});var t=n(60177),e=n(45189),r=n(12854),o=n(60724),C=n(7806),E=n(30356),y=n(89511),d=n(72026),_=n(82192),v=n(11818),b=n(54438);let P=(()=>{var s;class g{}return(s=g).\u0275fac=function(h){return new(h||s)},s.\u0275mod=b.$C({type:s}),s.\u0275inj=b.G2t({imports:[t.MD,d.o,e.G,v.C,_.G,y.h,C.g,r.X,o.r,E.k]}),g})()},7806:(ge,F,n)=>{"use strict";n.d(F,{g:()=>u});var t=n(54438),e=n(65763),r=n(14264),o=n(87996),C=n(13409),E=n(82542),y=n(49204),_=n(46842),v=n(44867),b=n(90908),P=n(89079),s=n(60177),g=n(12854);let u=(()=>{var h;class S{constructor(m){this.store=m,this.graph=t.hFB.required(),this.layerOrderMode=t.hFB.required(),this.showTreeNodeIds=t.hFB.required(),this.showLatinLabel=(0,t.hFB)(),this.theme=(0,t.hFB)(E.P.Dark),this.initNodeScrollListener()}initNodeScrollListener(){this.store.select(C.z.getCheckedNodes).pipe((0,r.p)(m=>1===m.length),(0,o.B)(0),(0,P.pQ)()).subscribe(([m])=>{this.scrollNodeIntoView(m.objectId)})}scrollNodeIntoView(m){const i=(0,v.Nk)(m),c=document.querySelector(`[data-id="${i}"]`);if(!(0,y.isNil)(c)&&(0,b.uK)()){const a=this.store.selectSnapshot(_.U.getPrefersReducedMotion)?"instant":"smooth";c.scrollIntoView({behavior:a,block:"nearest"})}}}return(h=S).\u0275fac=function(m){return new(m||h)(t.rXU(e.il))},h.\u0275cmp=t.VBU({type:h,selectors:[["app-tree"]],inputs:{graph:[t.Mj6.SignalBased,"graph"],layerOrderMode:[t.Mj6.SignalBased,"layerOrderMode"],showTreeNodeIds:[t.Mj6.SignalBased,"showTreeNodeIds"],showLatinLabel:[t.Mj6.SignalBased,"showLatinLabel"],theme:[t.Mj6.SignalBased,"theme"]},standalone:!0,features:[t.aNF],decls:1,vars:5,consts:[[3,"theme","graph","layerOrderMode","showTreeNodeIds","showLatinLabel"]],template:function(m,i){1&m&&t.nrm(0,"app-tree-group",0),2&m&&t.Y8G("theme",i.theme())("graph",i.graph())("layerOrderMode",i.layerOrderMode())("showTreeNodeIds",i.showTreeNodeIds())("showLatinLabel",i.showLatinLabel())},dependencies:[s.MD,g.X],changeDetection:0}),S})()},77276:(ge,F,n)=>{"use strict";n.d(F,{Ty:()=>C,fw:()=>E,kf:()=>r,zx:()=>y});var t=n(43442),e=n(27153);const r="School & Business Plans Only",C={[t.j.BookmarkViewThresholdReached]:{title:"BookmarkViewThresholdReach",actionText:"Upgrade Now"},[t.j.BookmarkViewLimitReached]:{title:"You've reached your 10 free views this month",description:"You can come back next month for another 10 free views or upgrade your plan for unlimited access to 1000+ anatomy, condition, and treatment models.",image:"assets/images/biodigital-human-explore-3d-human-anatomy.jpg",actionText:"Upgrade Now"},[t.j.ProAccountPastDue]:{title:"AccountPastDue",actionText:"Upgrade Now"},[t.j.BookmarkSaveThresholdReached]:{title:"BookmarkSaveThresholdReached",actionText:"Upgrade Now"},[t.j.BookmarkSaveLimitReached]:{title:"You've reached your limit of 5 saved models",description:"In order to save more models on your free plan, you will need to delete models in My Library or upgrade your plan.",image:"assets/images/biodigital-human-3d-model-my-library.jpg",actionText:"Upgrade Now",secondaryActionText:"Go to My Library to delete models"},[t.j.TeamTrailExpired]:{title:"TrailExpired",actionText:"Upgrade Now"},[t.j.Publish]:{title:"Publish your 3D model",description:"Upgrade to publish to your learning management system, website, or application and make your 3D models available for anyone to view and interact.",image:"assets/images/biodigital-human-publish-custom-3D-model.jpg",tag:r,tagIcon:"lock",actionText:"Upgrade Now"},[t.j.IndividualUploadVideo]:{title:"Add videos to your 3D model",description:"Upgrade your account, and take your content to the next level with video uploads. Plus, get full access to 1,000+ anatomy, condition and treatment models.",image:"assets/images/biodigital-human-upload-videos.jpg",tag:r,tagIcon:"lock",actionText:"Upgrade Now"},[t.j.ExternalAccountEdit]:{title:"Your Human Studio access has expired",actionText:"Contact Support",image:"assets/images/biodigital-human-customize-3D-model-in-studio.jpg"},[t.j.TeamEditModel]:{title:"Customize your 3D model",image:"assets/images/biodigital-human-customize-3D-model-in-studio.png",actionText:"Join Team"},[t.j.TeamAddModel]:{title:"Add to My Library",image:"assets/images/biodigital-human-3d-model-my-library.jpg",actionText:"Join Team"},[t.j.TeamPublish]:{title:"Publish your 3D model",image:"assets/images/biodigital-human-publish-custom-3d-model.png",actionText:"Join Team"}};function E(d,_,v){return`To let your institution know that you would like to continue using Human Studio, please contact the ${e.n3[d]} support team at <a class="text-link underline" target="_blank" href="${y(d,_,v)}">${e.mY[d]}</a>.`}function y(d,_,v){return(0,e.NP)(e.mY[d],"Request for Human Studio Access in the BioDigital Human",`Hello,\n  \nI received a notification that access to Human Studio has expired for my team.\n  \nI find Human Studio to be an invaluable resource, and would like my institution, ${_}, to know that I am interested in having our access restored. I would appreciate it if you could notify them on my behalf.\n  \nThanks!\n  \n${v}`)}},74459:(ge,F,n)=>{"use strict";n.d(F,{q:()=>t});var t=function(e){return e.Modal="Modal",e.Footer="Footer",e.Notification="Notification",e}(t||{})},43442:(ge,F,n)=>{"use strict";n.d(F,{j:()=>t});var t=function(e){return e[e.BookmarkViewThresholdReached=0]="BookmarkViewThresholdReached",e[e.BookmarkViewLimitReached=1]="BookmarkViewLimitReached",e[e.BookmarkSaveThresholdReached=2]="BookmarkSaveThresholdReached",e[e.BookmarkSaveLimitReached=3]="BookmarkSaveLimitReached",e[e.ProAccountPastDue=4]="ProAccountPastDue",e[e.TeamTrailExpired=5]="TeamTrailExpired",e[e.Publish=6]="Publish",e[e.IndividualUploadVideo=7]="IndividualUploadVideo",e[e.ExternalAccountEdit=8]="ExternalAccountEdit",e[e.TeamEditModel=9]="TeamEditModel",e[e.TeamAddModel=10]="TeamAddModel",e[e.TeamPublish=11]="TeamPublish",e}(t||{})},39596:(ge,F,n)=>{"use strict";n.d(F,{p:()=>U});var t=n(65763),e=n(49204),r=n(15877),o=n(96513),C=n(14264),E=n(32914),y=n(36110),d=n(38165),_=n(34006),v=n(2573),b=n(15623),P=n(38104),s=n(66571),g=n(54438),u=n(38645),h=n(21007),S=n(26779),f=n(60177),m=n(11583),i=n(35286);function c(Z,z){if(1&Z&&g.nrm(0,"app-tag",11),2&Z){const H=g.XpG();g.Y8G("icon",H.content.tagIcon)("label",H.content.tag)}}function a(Z,z){if(1&Z&&(g.nrm(0,"div",12),g.nI1(1,"markdown"),g.nI1(2,"async")),2&Z){const H=g.XpG();g.Y8G("innerHTML",g.bMT(2,3,g.bMT(1,1,H.content.description)),g.npT)}}function l(Z,z){if(1&Z&&(g.j41(0,"div",13),g.EFF(1," Already a member? "),g.j41(2,"a",14),g.EFF(3,"Sign in"),g.k0s(),g.EFF(4,". "),g.k0s()),2&Z){const H=g.XpG();g.R7$(2),g.Y8G("href",H.content.signInUrl,g.B4B)}}function p(Z,z){if(1&Z){const H=g.RV6();g.j41(0,"a",15),g.bIt("click",function(){g.eBV(H);const Y=g.XpG();return g.Njj(Y.handleSecondaryActionClick())}),g.EFF(1),g.k0s()}if(2&Z){const H=g.XpG();g.R7$(),g.SpI(" ",H.content.secondaryActionText," ")}}function A(Z,z){if(1&Z&&(g.j41(0,"div",16),g.nrm(1,"img",17),g.k0s()),2&Z){const H=g.XpG();g.R7$(),g.Y8G("src",H.content.image,g.B4B),g.BMQ("alt",H.content.title)}}let O=(()=>{var Z;class z{constructor(){this.actionClick=new g.bkB,this.secondaryActionClick=new g.bkB}ngOnInit(){}handleActionClick(){this.actionClick.emit()}handleSecondaryActionClick(){this.secondaryActionClick.emit()}}return(Z=z).\u0275fac=function(J){return new(J||Z)},Z.\u0275cmp=g.VBU({type:Z,selectors:[["app-callout-content"]],inputs:{content:"content",compact:"compact"},outputs:{actionClick:"actionClick",secondaryActionClick:"secondaryActionClick"},decls:14,vars:9,consts:[["data-test","calloutContent",1,"callout","flex","flex-row","items-center"],[1,"callout__content","flex","flex-col","items-start","px-4"],[1,"flex","flex-row","items-center",2,"flex-wrap","wrap"],["data-test","calloutContentTitle",1,"callout__title"],["data-test","calloutContentTag",3,"icon","label",4,"ngIf"],["class","callout__description mt-5 html","data-test","calloutContentDescription",3,"innerHTML",4,"ngIf"],["class","mt-5","data-test","calloutContentSignInUrl",4,"ngIf"],[1,"callout__actions","mt-10"],["type","button","app-button","","buttonTheme","light","buttonType","primary","buttonSize","xl","data-test","calloutContentAction","cdkFocusInitial","",1,"mr-6",3,"click"],["class","text-link text-sm my-4","data-test","calloutContentSecondaryAction",3,"click",4,"ngIf"],["class","callout__image-container flex flex-row items-start justify-between px-4",4,"ngIf"],["data-test","calloutContentTag",3,"icon","label"],["data-test","calloutContentDescription",1,"callout__description","mt-5","html",3,"innerHTML"],["data-test","calloutContentSignInUrl",1,"mt-5"],[1,"text-link","underline",3,"href"],["data-test","calloutContentSecondaryAction",1,"text-link","text-sm","my-4",3,"click"],[1,"callout__image-container","flex","flex-row","items-start","justify-between","px-4"],["data-test","calloutContentImage",1,"callout__image",3,"src"]],template:function(J,Y){1&J&&(g.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),g.EFF(4),g.k0s(),g.j41(5,"div"),g.DNE(6,c,1,2,"app-tag",4),g.k0s()(),g.DNE(7,a,3,5,"div",5)(8,l,5,1,"div",6),g.j41(9,"div",7)(10,"button",8),g.bIt("click",function(){return Y.handleActionClick()}),g.EFF(11),g.k0s(),g.DNE(12,p,2,1,"a",9),g.k0s()(),g.DNE(13,A,2,2,"div",10),g.k0s()),2&J&&(g.AVh("callout--compact",Y.compact),g.R7$(4),g.JRh(Y.content.title),g.R7$(2),g.Y8G("ngIf",Y.content.tag),g.R7$(),g.Y8G("ngIf",Y.content.description),g.R7$(),g.Y8G("ngIf",Y.content.signInUrl),g.R7$(3),g.SpI(" ",Y.content.actionText," "),g.R7$(),g.Y8G("ngIf",Y.content.secondaryActionText),g.R7$(),g.Y8G("ngIf",Y.content.image&&!Y.compact))},dependencies:[h.Q,f.bT,m.e,f.Jj,i.i0],styles:[".callout[_ngcontent-%COMP%]{background-color:#fff}.callout__content[_ngcontent-%COMP%]{flex:1 1 auto}.callout__title[_ngcontent-%COMP%]{font-size:1.5rem;line-height:2rem;letter-spacing:inherit;color:#131c2a;font-weight:600;margin-right:20px}.callout__description[_ngcontent-%COMP%]{font-size:1rem;line-height:1.5rem;display:flex;flex-direction:column;gap:24px}.callout__actions[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;flex-flow:wrap}.callout__image-container[_ngcontent-%COMP%]{flex:1;flex-basis:480px;width:100%}.callout__image[_ngcontent-%COMP%]{max-width:480px}.callout--compact[_ngcontent-%COMP%]   .callout__content[_ngcontent-%COMP%]{flex-basis:100%}.callout--compact[_ngcontent-%COMP%]   .callout__title[_ngcontent-%COMP%]{font-size:1.25rem;line-height:1.75rem;margin-bottom:4px}.callout--compact[_ngcontent-%COMP%]   .callout__description[_ngcontent-%COMP%]{font-size:.875rem;line-height:1.25rem;gap:16px}.callout[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{text-decoration:underline}"],changeDetection:0}),z})();var L;class B{constructor(z,H,J,Y){this.router=z,this.dialogService=H,this.dialogRef=J,this.breakPoints=b.m,this.data=Y}handleCloseClick(){this.dialogRef.close(!0)}handleActionClick(){"function"==typeof this.data.actionHandler?(this.data.actionHandler(),this.dialogRef.close()):this.dialogService.openUpgradeDialog(!1)}handleSecondaryActionClick(){this.router.navigate(["/results/bookmarks"]).then(()=>{this.dialogRef.close()})}}(L=B).\u0275fac=function(z){return new(z||L)(g.rXU(u.Ix),g.rXU(s.o),g.rXU(_.CP),g.rXU(_.Vh))},L.\u0275cmp=g.VBU({type:L,selectors:[["app-premium-access-dialog"]],decls:8,vars:10,consts:[["data-test","premiumAccessDialog",1,"dialog","flex","flex-row","items-start"],[1,"flex","items-center","justify-center","flex-auto"],[1,"dialog__content","flex","flex-row","items-start","justify-center","flex-auto"],[3,"actionClick","secondaryActionClick","content","compact"],["app-button","","buttonType","default","buttonTheme","light","type","button","title","Close","data-test","premiumAccessDialogClose",1,"modal__close",3,"click"],["icon","times","size","lg"]],template:function(z,H){1&z&&(g.j41(0,"div",0),g.nI1(1,"async"),g.j41(2,"div",1)(3,"div",2)(4,"app-callout-content",3),g.nI1(5,"async"),g.bIt("actionClick",function(){return H.handleActionClick()})("secondaryActionClick",function(){return H.handleSecondaryActionClick()}),g.k0s()()(),g.j41(6,"button",4),g.bIt("click",function(){return H.handleCloseClick()}),g.nrm(7,"app-icon",5),g.k0s()()),2&z&&(g.AVh("dialog--compact",g.bMT(1,6,H.horizontalBreakpoint$)<=H.breakPoints.Medium),g.BMQ("aria-label","Premium Access"),g.R7$(4),g.Y8G("content",H.data)("compact",g.bMT(5,8,H.horizontalBreakpoint$)<=H.breakPoints.Medium),g.R7$(2),g.BMQ("aria-label","Close"))},dependencies:[h.Q,S.R,O,f.Jj],styles:[".dialog[_ngcontent-%COMP%]{padding:24px}.dialog__content[_ngcontent-%COMP%]{max-width:1140px}.dialog--compact[_ngcontent-%COMP%]   .dialog__content[_ngcontent-%COMP%]{margin:0}"],changeDetection:0}),function(Z,z,H,J){var se,Y=arguments.length,X=Y<3?z:null===J?J=Object.getOwnPropertyDescriptor(z,H):J;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)X=Reflect.decorate(Z,z,H,J);else for(var oe=Z.length-1;oe>=0;oe--)(se=Z[oe])&&(X=(Y<3?se(X):Y>3?se(z,H,X):se(z,H))||X);Y>3&&X&&Object.defineProperty(z,H,X)}([(0,t.l6)(P.V.getHorizontalBreakpoint),function(Z,z){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata("design:type",z)}(0,v.c)],B.prototype,"horizontalBreakpoint$",void 0);var j=n(85052),V=n(76718),M=n(37925),N=n(84178);let W=(()=>{var Z;class z{constructor(J,Y,X){this.router=J,this.activatedRoute=Y,this.dialogRef=X,this.ngUnsubscribe=new j.B}ngOnInit(){this.closeOnLoginPage()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}closeOnLoginPage(){(0,V.h)(this.activatedRoute.url,this.router.events.pipe((0,C.p)(J=>J instanceof u.wF))).pipe((0,y.T)(()=>this.router.url),(0,M.Q)(this.ngUnsubscribe)).subscribe(J=>{J.startsWith("/login")&&this.dialogRef.close()})}handleDismissClick(){this.dialogRef.close()}}return(Z=z).\u0275fac=function(J){return new(J||Z)(g.rXU(u.Ix),g.rXU(u.nX),g.rXU(_.CP))},Z.\u0275cmp=g.VBU({type:Z,selectors:[["app-signup-footer-dialog"]],decls:5,vars:3,consts:[["data-test","signupFooterDialog",1,"signup-footer-dialog","flex","flex-col","items-center"],[1,"signup-footer-dialog__message"],[3,"compact"],["app-button","","buttonType","default","buttonTheme","light","type","button","title","Close",1,"signup-footer-dialog__close",3,"click"],["icon","times","size","lg"]],template:function(J,Y){1&J&&(g.j41(0,"div",0)(1,"div",1),g.nrm(2,"app-signup-messaging",2),g.k0s(),g.j41(3,"button",3),g.bIt("click",function(){return Y.handleDismissClick()}),g.nrm(4,"app-icon",4),g.k0s()()),2&J&&(g.BMQ("aria-label","Sign Up"),g.R7$(2),g.Y8G("compact",!1),g.R7$(),g.BMQ("aria-label","Close"))},dependencies:[h.Q,S.R,N.i],styles:[".signup-footer-dialog[_ngcontent-%COMP%]{padding-top:36px;padding-bottom:36px}.signup-footer-dialog__message[_ngcontent-%COMP%]{max-width:632px}.signup-footer-dialog__close[_ngcontent-%COMP%]{position:absolute;top:12px;right:12px}@media (max-width: 480px){.signup-footer-dialog[_ngcontent-%COMP%]{padding-top:32px;padding-bottom:32px}.signup-footer-dialog__message[_ngcontent-%COMP%]{max-width:320px}}"],changeDetection:0}),z})();var $=n(17215),ne=n(24418),Q=n(58686),le=n(76203);let ie=(()=>{var Z;class z{constructor(J,Y,X){this.dialogService=J,this.storageService=Y,this.dialogRef=X,this.supportEmail=ne.c.supportEmail,this.upgradeLabel="Your 14-day trial has expired and your account now has limited functionality. To regain access to the full power of the BioDigital Human platform, choose the plan that\u2019s perfect for you and:"}ngOnInit(){}handleCancelClick(){this.storageService.setLocalItem($.UT.TeamTrialExpirationSeen,!0),this.dialogRef.close()}handleChooseClick(){this.storageService.setLocalItem($.UT.TeamTrialExpirationSeen,!0),this.dialogService.openUpgradeDialog()}}return(Z=z).\u0275fac=function(J){return new(J||Z)(g.rXU(s.o),g.rXU($.n$),g.rXU(_.CP))},Z.\u0275cmp=g.VBU({type:Z,selectors:[["app-trial-expired-dialog"]],decls:15,vars:2,consts:[[1,"dialog"],["app-button","","buttonType","text","buttonTheme","light","type","button","title","Close",1,"dialog__close",3,"click"],["icon","times","size","lg"],[1,"dialog__content","flex","flex-col","items-center","justify-center"],[1,"mb-4","text-2xl","font-semibold","text-center"],["src","assets/images/biodigital-multidevice-graphic.jpg",1,"dialog__image"],["app-button","","buttonType","primary",1,"my-4",3,"click"],[1,"my-4"],[3,"label"],[1,"mt-4","text-sm"],["role","button","tabindex","0","appSupportLink","",1,"underline"]],template:function(J,Y){1&J&&(g.j41(0,"div",0)(1,"button",1),g.bIt("click",function(){return Y.handleCancelClick()}),g.nrm(2,"app-icon",2),g.k0s(),g.j41(3,"div",3)(4,"div",4),g.EFF(5,"Your free trial has ended"),g.k0s(),g.nrm(6,"img",5),g.j41(7,"button",6),g.bIt("click",function(){return Y.handleChooseClick()}),g.EFF(8," Upgrade Now "),g.k0s(),g.j41(9,"div",7),g.nrm(10,"app-team-features",8),g.k0s(),g.j41(11,"div",9),g.EFF(12," Need more time for evaluation? "),g.j41(13,"span",10),g.EFF(14,"Contact us"),g.k0s()()()()),2&J&&(g.R7$(),g.BMQ("aria-label","Close"),g.R7$(9),g.Y8G("label",Y.upgradeLabel))},dependencies:[h.Q,Q.R,S.R,le.W],styles:[".dialog[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:center;height:100%;padding:32px;width:90vw;height:90vh}.dialog__close[_ngcontent-%COMP%]{position:absolute;top:8px;right:8px}.dialog__content[_ngcontent-%COMP%]{max-width:520px}.dialog__image[_ngcontent-%COMP%]{width:100%;max-width:360px}@media (max-width: 480px){.dialog[_ngcontent-%COMP%]{width:100vw;height:100vh}}"],changeDetection:0}),z})();var be=n(84370),de=n(94495),w=n(59e3),te=n(5690),R=n(77276),D=n(74459),T=n(43442),re=n(21424),K=n(16823),ae=n(27153);const ce={[T.j.BookmarkViewLimitReached]:"View gate",[T.j.BookmarkSaveLimitReached]:"Save gate",[T.j.Publish]:"Publish gate",[T.j.IndividualUploadVideo]:"Individual video upload gate",[T.j.ExternalAccountEdit]:"External account edit gate"};let U=(()=>{var Z;class z{constructor(J,Y,X,se,oe){this.store=J,this.dialog=Y,this.vendorAnalyticsService=X,this.productService=se,this.router=oe}openPastDue(){this.store.dispatch(new d.$_(T.j.ProAccountPastDue,D.q.Notification))}openBookmarkViewWarning(J,Y){this.store.dispatch(new d.$_(T.j.BookmarkViewThresholdReached,D.q.Footer,{title:`You've viewed **${J} of ${Y}** models this month.`,actionText:"Get Unlimited Acccess"}))}openPublicViewGate(){return this.dialog.open(W,{id:be.t.PublicViewGateDialog,backdropClass:"bd-dialog-backdrop-alt",panelClass:"bg-dialog-docked",disableClose:!0,data:{}}).afterClosed()}closePublicViewGate(){const J=this.dialog.getDialogById(be.t.PublicViewGateDialog);J&&J.close()}openBookmarkViewLimit(){return this.openPremiumAccessDialog(T.j.BookmarkViewLimitReached,{},!1)}openBookmarkSaveWarning(J,Y){this.store.dispatch(new d.$_(T.j.BookmarkSaveThresholdReached,D.q.Footer,{title:`You've saved **${J} of ${Y}** free models.`,actionText:"Get Unlimited Storage"}))}openBookmarkSaveLimit(){return this.openPremiumAccessDialog(T.j.BookmarkSaveLimitReached)}openPublishPaywall(J){const Y=J?.data?.organizations??[];if(Y.length>0){const X=Y?.[0]?.name??"",se=(0,ae.eu)(J),oe=(0,ae.Iw)(J);return this.openPremiumAccessDialog(T.j.TeamPublish,{description:`Join the **${X}** team to generate a direct link to your 3D model or seamlessly embed it into a learning management system or website.`,signInUrl:se,actionText:"Join Team",actionHandler:()=>{this.router.navigateByUrl(oe)}})}return this.openPremiumAccessDialog(T.j.Publish)}openEditPaywall(J){const X=(J?.data?.organizations??[])?.[0]?.name??"",se=(0,ae.eu)(J),oe=(0,ae.Iw)(J);return this.openPremiumAccessDialog(T.j.TeamEditModel,{description:`Join the **${X}** team to access Human Studio, where you can isolate, label, and paint key structures, build virtual tours and quizzes, and more!`,signInUrl:se,actionText:"Join Team",actionHandler:()=>{this.router.navigateByUrl(oe)}})}openAddModelPaywall(J){const X=(J?.data?.organizations??[])?.[0]?.name??"",se=(0,ae.eu)(J),oe=(0,ae.Iw)(J);return this.openPremiumAccessDialog(T.j.TeamAddModel,{description:`Join the **${X}** team to add models to My Library and start collaborating with other members of your institution.`,signInUrl:se,actionText:"Join Team",actionHandler:()=>{this.router.navigateByUrl(oe)}})}openVideoUploadGate(){return this.openPremiumAccessDialog(T.j.IndividualUploadVideo)}openExternalAccountEditGate(J){const Y=this.store.selectSnapshot(re.q.getOrganization).name,X=this.store.selectSnapshot(K.k.getUserProfile).first_name;return this.openPremiumAccessDialog(T.j.ExternalAccountEdit,{description:(0,R.fw)(J,Y,X),actionHandler:()=>{const se=document.createElement("a");se.href=(0,R.zx)(J,Y,X),se.target="_blank",se.click()}})}openTrialExpired(){return this.dialog.open(ie,{id:be.t.TrialExpiredDialog,panelClass:"bg-dialog-responsive"}).afterClosed()}openPremiumAccessDialog(J,Y={},X=!0){const se={...R.Ty[J],...Y};if(this.getOpenPremiumDialogType()===T.j.BookmarkViewLimitReached)return(0,r.of)(void 0);J===T.j.BookmarkViewLimitReached&&this.clearDialogs(),this.vendorAnalyticsService.track(ce[J],{page:this.router.url,platform:this.productService.productKey});const me=this.getPremiumDialogId(J);return this.dialog.open(B,{id:me,backdropClass:X?void 0:"bd-dialog-backdrop-headless",panelClass:"bg-dialog-docked",disableClose:!X,data:se}).afterClosed()}clearDialogs(){this.dialog.closeAll()}clearUserNotifications(...J){this.store.dispatch(new d.rH(J))}getPremiumDialogId(J){return`${be.t.PremiumAccessDialog}_${J}`}getOpenPremiumDialogType(){return Object.values(T.j).find(J=>{const Y=this.getPremiumDialogId(J),X=this.dialog.getDialogById(Y);return!(0,e.isNil)(X)})}createViewinteractionGate(J,Y,X){return this.store.select(de.N.getSelectedChapterModelReady).pipe((0,C.p)(me=>me)).pipe((0,E.n)(()=>(0,o.Y)(1e3)),(0,y.T)(me=>1e3*me)).pipe((0,y.T)(me=>me>=J))}}return(Z=z).\u0275fac=function(J){return new(J||Z)(g.KVO(t.il),g.KVO(_.bZ),g.KVO(w.e),g.KVO(te.b),g.KVO(u.Ix))},Z.\u0275prov=g.jDH({token:Z,factory:Z.\u0275fac,providedIn:"root"}),z})()},64218:(ge,F,n)=>{"use strict";n.d(F,{H:()=>r});var t=n(60177),e=n(54438);let r=(()=>{var o;class C{}return(o=C).\u0275fac=function(y){return new(y||o)},o.\u0275mod=e.$C({type:o}),o.\u0275inj=e.G2t({imports:[t.MD]}),C})()},79435:(ge,F,n)=>{"use strict";n.d(F,{T:()=>v});var t=n(15877),e=n(45326),r=n(36110),o=n(28577),C=n(39705),E=n(24418),y=n(79083),d=n(54438),_=n(21626);let v=(()=>{var b;class P{constructor(g){this.http=g,this.nodeInfoCache=new Map}queryNodeInfo(g,u,h="en",S=!0){if(E.c.offline)return(0,t.of)(void 0);const m=`/search/descriptions?name=${g}&plan=${u===y.H.Wikipedia?"wiki":u}&ol=${h}`,i=m;if(S&&this.nodeInfoCache.has(i)){const c=this.nodeInfoCache.get(i);return(0,t.of)(c)}return this.http.get(m).pipe((0,r.T)(c=>({label:g,latinLabel:c.latin_term,description:c.description,source:c.source,sourceLink:c.url})),(0,o.W)(c=>404===c.status?(0,t.of)(void 0):(0,e.$)(c)),(0,C.M)(c=>this.nodeInfoCache.set(i,c)))}}return(b=P).\u0275fac=function(g){return new(g||b)(d.KVO(_.Qq))},b.\u0275prov=d.jDH({token:b,factory:b.\u0275fac,providedIn:"root"}),P})()},4475:(ge,F,n)=>{"use strict";n.d(F,{K:()=>o});var t=n(5690),e=n(54438),r=n(21626);let o=(()=>{var C;class E{constructor(d,_){this.http=d,this.productService=_}trackContentPublish(d,_){return this.http.post("/ws/user/analytics/content/inapp/publish",{version:4,app_producttype:this.productService.productType,app_productkey:this.productService.productKey,content_type:_,content_id:d})}trackContentView(d,_){return this.http.post("/ws/user/analytics/content/inapp/view",{version:4,app_producttype:this.productService.productType,app_productkey:this.productService.productKey,content_type:_,content_id:d})}checkContentView(){return this.http.get("/ws/user/content/inapp/view/check")}}return(C=E).\u0275fac=function(d){return new(d||C)(e.KVO(r.Qq),e.KVO(t.b))},C.\u0275prov=e.jDH({token:C,factory:C.\u0275fac,providedIn:"root"}),E})()},37737:(ge,F,n)=>{"use strict";n.d(F,{B:()=>r});var t=n(90908),e=n(54438);let r=(()=>{var o;class C{constructor(y){this.el=y}ngAfterContentInit(){(0,t.ZO)()&&setTimeout(()=>{this.el.nativeElement.focus()},0)}}return(o=C).\u0275fac=function(y){return new(y||o)(e.rXU(e.aKT))},o.\u0275dir=e.FsC({type:o,selectors:[["input","appAutoFocus",""]]}),C})()},89511:(ge,F,n)=>{"use strict";n.d(F,{h:()=>r});var t=n(60177),e=n(54438);let r=(()=>{var o;class C{}return(o=C).\u0275fac=function(y){return new(y||o)},o.\u0275mod=e.$C({type:o}),o.\u0275inj=e.G2t({imports:[t.MD]}),C})()},25780:(ge,F,n)=>{"use strict";n.d(F,{L:()=>e});var t=n(54438);let e=(()=>{var r;class o{onClick(E){return E.stopPropagation(),E.stopImmediatePropagation(),E.target instanceof HTMLInputElement&&"checkbox"===E.target.type}onEnterUp(E){return E.stopPropagation(),E.stopImmediatePropagation(),!1}onPointerdown(E){E.stopPropagation(),E.stopImmediatePropagation()}onMouseDown(E){E.stopPropagation(),E.stopImmediatePropagation()}onMousUp(E){return E.stopPropagation(),E.stopImmediatePropagation(),!1}}return(r=o).\u0275fac=function(E){return new(E||r)},r.\u0275dir=t.FsC({type:r,selectors:[["","appEventFence",""]],hostBindings:function(E,y){1&E&&t.bIt("click",function(_){return y.onClick(_,_.target)})("keyup.enter",function(_){return y.onEnterUp(_,_.target)})("pointerdown",function(_){return y.onPointerdown(_,_.target)})("mousedown",function(_){return y.onMouseDown(_,_.target)})("mouseup",function(_){return y.onMousUp(_,_.target)})}}),o})()},59369:(ge,F,n)=>{"use strict";n.d(F,{Y:()=>C});var t=n(24418),e=n(90699),r=n(54438),o=n(38645);let C=(()=>{var E;class y{constructor(_,v,b){this.templateRef=_,this.viewContainer=v,this.router=b,this._appFlagApplicationMode="include"}get appFlagApplication(){return this._appFlagApplication}set appFlagApplication(_){this._appFlagApplication=_}get appFlagApplicationMode(){return this._appFlagApplicationMode}set appFlagApplicationMode(_){this._appFlagApplicationMode=_}get appFlagApplicationPage(){return this._appFlagApplicationPage}set appFlagApplicationPage(_){this._appFlagApplicationPage=_}get appFlagApplicationPlatform(){return this._appFlagApplicationPlatform}set appFlagApplicationPlatform(_){this._appFlagApplicationPlatform=_}get appFlagApplicationNative(){return this._appFlagApplicationNative}set appFlagApplicationNative(_){this._appFlagApplicationNative=_}ngOnInit(){this.update()}update(){let _=!1,v=!1,b=!1,P=!1,s=!1;if(""===this.appFlagApplication?v=!0:Array.isArray(this.appFlagApplication)?v=this.appFlagApplication.some(u=>u===t.c.application):"string"==typeof this.appFlagApplication&&(v=this.appFlagApplication===t.c.application),null==this.appFlagApplicationPage)b=!0;else{const u=this.router.url;Array.isArray(this.appFlagApplicationPage)?b=this.appFlagApplicationPage.some(h=>u.indexOf(h)>=0):"string"==typeof this.appFlagApplicationPage&&(b=u.indexOf(this.appFlagApplicationPage)>=0)}if(null==this.appFlagApplicationPlatform)P=!0;else{const u=t.c.platform;Array.isArray(this.appFlagApplicationPlatform)?P=this.appFlagApplicationPlatform.some(h=>u.indexOf(h)>=0):"string"==typeof this.appFlagApplicationPlatform&&(P=u.indexOf(this.appFlagApplicationPlatform)>=0)}null==this.appFlagApplicationNative?s=!0:(s=t.c.native,(Array.isArray(this.appFlagApplicationNative)?this.appFlagApplicationNative:[this.appFlagApplicationNative]).includes(e.I.iOS)&&(s=t.c.native&&void 0!==window.webkit)),_=v&&b&&P&&s,_&&"include"===this.appFlagApplicationMode||!_&&"exclude"===this.appFlagApplicationMode?this.viewContainer.createEmbeddedView(this.templateRef):this.viewContainer.clear()}}return(E=y).\u0275fac=function(_){return new(_||E)(r.rXU(r.C4Q),r.rXU(r.c1b),r.rXU(o.Ix))},E.\u0275dir=r.FsC({type:E,selectors:[["","appFlagApplication",""]],inputs:{appFlagApplication:"appFlagApplication",appFlagApplicationMode:"appFlagApplicationMode",appFlagApplicationPage:"appFlagApplicationPage",appFlagApplicationPlatform:"appFlagApplicationPlatform",appFlagApplicationNative:"appFlagApplicationNative"}}),y})()},49989:(ge,F,n)=>{"use strict";n.d(F,{e:()=>r});var t=n(54438),e=n(11040);let r=(()=>{var o;class C{constructor(y,d){this.localeId=y,this.el=d}ngOnInit(){"rtl"===(0,e.NS)(this.localeId).direction&&(this.el.nativeElement.style.scale="-1 1")}}return(o=C).\u0275fac=function(y){return new(y||o)(t.rXU(t.xe9),t.rXU(t.aKT))},o.\u0275dir=t.FsC({type:o,selectors:[["","appLogicalDir",""]]}),C})()},58686:(ge,F,n)=>{"use strict";n.d(F,{R:()=>r});var t=n(66571),e=n(54438);let r=(()=>{var o;class C{constructor(y){this.dialogService=y}onClick(y){this.dialogService.openContactDialog()}}return(o=C).\u0275fac=function(y){return new(y||o)(e.rXU(t.o))},o.\u0275dir=e.FsC({type:o,selectors:[["","appSupportLink",""]],hostBindings:function(y,d){1&y&&e.bIt("click",function(v){return d.onClick(v)})("keydown.enter",function(v){return d.onClick(v)})}}),C})()},53236:(ge,F,n)=>{"use strict";n.d(F,{K$:()=>E,u1:()=>y});var t=n(27153),e=n(30234);const r=t.fQ[e.a.WoltersKluwer],o={};function E(d){return d instanceof Error?"":d?.error?.error?.error_id??""}function y(d,_){const v=E(d),b=d instanceof Error?d.message:d?.error?.error?.message,P=function C(d,_){switch(d){case"OPPH01.00126":case"SUH01.00040":return"This invite code is invalid or has expired. Please reach out to your administrator for a new code.";case"OPPH01.00122":case"SUH01.00122":case"SIH01.00122":case"FSH01.00122":case"GSH01.00122":return`We were unable to find an account associated with your institution. \n      Please contact your administrator [here](${r}) and provide this error ID: ${d}.`;case"OPPH01.00123":case"SUH01.00123":case"SIH01.00123":case"FSH01.00123":case"GSH01.00123":return`There are multiple team accounts associated with your institution. \n      Please contact your administrator [here](${r}) and provide this error ID: ${d}.`;case"OPPH01.00124":case"OPPH01.00125":case"OPPH01.00110":case"OPPH01.00111":case"OPPH01.00112":case"SUH01.00124":case"SUH01.00110":case"SUH01.00111":case"SUH01.00112":case"SIH01.00124":case"SIH01.00110":case"SIH01.00111":case"SIH01.00112":case"FSH01.00124":case"FSH01.00125":case"FSH01.00110":case"FSH01.00111":case"FSH01.00112":case"GSH01.00124":case"GSH01.00110":case"GSH01.00111":case"GSH01.00112":return`There was an issue with retrieving information from your institution. \n      Please try again or contact your administrator [here](${r}) and provide this error ID: ${d}.`;case"OSIH01.00111":case"OSIH01.00112":return"We were unable to load this page due to an invalid Ovid token";default:return o[d]||""}}(v);return P||(b?b.replace(/^\[(.+)\]$/,"$1").replace(/^\'(.+)\'$/,"$1"):"")}},85884:(ge,F,n)=>{"use strict";n.d(F,{Y:()=>t});var t=function(e){return e.Content="content",e.Engine="engine",e}(t||{})},66432:(ge,F,n)=>{"use strict";n.d(F,{QU:()=>E,ZV:()=>b,v1:()=>v,p7:()=>_,e7:()=>d,z:()=>y});var t=n(49204),e=n(30234),r=n(74394);const o=[{title:"zSpace Models",id:e.a.Zspace,type:"Category",icon:"zspace"}],C={main:[{title:"All Models",id:"all",type:"Category",icon:"all-models",tabTags:r.Ht,translations:{es:{title:"Todas las Categor\xedas"},zh:{title:"\u6240\u6709\u7c7b\u522b"},fr:{title:"Toutes les cat\xe9gories"},de:{title:"Alle Kategorien"},it:{title:"Tutte le categorie"},ja:{title:"\u3059\u3079\u3066\u306e\u30ab\u30c6\u30b4\u30ea"},pt:{title:"Todas as categorias"}}}],categories:[{title:"Anatomy by Regions",id:"regional",type:"Category",icon:"anatomy-by-regions",tabTags:r.iE,translations:{es:{title:"Anatom\xeda regional"},zh:{title:"\u5c40\u90e8\u89e3\u5256"},fr:{title:"Anatomie r\xe9gionale"},de:{title:"Regionale Anatomie"},it:{title:"Anatomia regionale"},ja:{title:"\u5404\u90e8\u4f4d\u306e\u69cb\u9020"},pt:{title:"Anatomia Regional"}}},{title:"Anatomy by Systems",id:"system",type:"Category",icon:"anatomy-by-systems",tabTags:r.L7,translations:{es:{title:"Anatom\xeda sistem\xe1tica"},zh:{title:"\u7cfb\u7edf\u89e3\u5256"},fr:{title:"Anatomie du syst\xe8me"},de:{title:"Systematische Anatomie"},it:{title:"Anatomia sistemica"},ja:{title:"\u5404\u5668\u5b98\u7cfb\u306e\u69cb\u9020"},pt:{title:"Anatomia do Sistema"}}},{title:"Complete Anatomy",id:"complete anatomy",type:"Category",icon:"complete-anatomy",translations:{de:{title:"Vollst\xe4ndige Anatomie"},es:{title:"Anatom\xeda completa"},fr:{title:"Anatomie compl\xe8te"},it:{title:"Anatomia completa"},ja:{title:"\u4eba\u4f53\u306e\u5168\u4f53\u69cb\u9020"},pt:{title:"Anatomia Completa"},zh:{title:"\u5b8c\u6574\u89e3\u5256"}}},{title:"Bony Landmarks",id:"Bony Landmarks",type:"Category",icon:"bony-landmarks",translations:{de:{title:"Kn\xf6cherne Orientierungspunkte"},es:{title:"Puntos de referencia \xf3seos"},fr:{title:"Rep\xe8res osseux"},it:{title:"Punti di repere ossei"},ja:{title:"\u9aa8\u306e\u30e9\u30f3\u30c9\u30de\u30fc\u30af"},pt:{title:"Marcos \xd3sseos"},zh:{title:"\u9aa8\u6027\u6807\u5fd7"}}},{title:"Cross Sections & Micro Anatomy",id:"Cross Section and Micro Anatomy",type:"Category",icon:"cross-sections-and-micro-anatomy",translations:{de:{title:"Querschnitte und mikroskopische Anatomie"},es:{title:"Cortes transversales y microanatom\xeda"},fr:{title:"Coupes transversales et micro anatomie"},it:{title:"Sezioni trasversali & anatomia microscopica"},ja:{title:"\u65ad\u9762\u56f3\u30fb\u30de\u30a4\u30af\u30ed\u89e3\u5256\u5b66"},pt:{title:"Sec\xe7\xf5es Transversais e Microanatomia"},zh:{title:"\u6a2a\u65ad\u9762&\u663e\u5fae\u89e3\u5256"}}},{title:"Origins & Insertions",id:"Origins and Insertions",type:"Category",icon:"origins-and-insertions",translations:{de:{title:"Urspr\xfcnge und Ans\xe4tze"},es:{title:"Or\xedgenes e inserciones"},fr:{title:"Origines et insertions"},it:{title:"Origini & inserzioni"},ja:{title:"\u8d77\u59cb\u30fb\u505c\u6b62"},pt:{title:"Origens e Inser\xe7\xf5es"},zh:{title:"\u8d77\u6e90\u4e0e\u63d2\u5165"}}},{title:"Anatomy Quizzes",id:"quiz",type:"Category",icon:"quizzes-and-assessments",tabTags:r.iE,translations:{de:{title:"Anatomie Quizfragen"},es:{title:"Pruebas de anatom\xeda"},fr:{title:"Quizz d'anatomie"},it:{title:"Domande di anatomia"},ja:{title:"\u89e3\u5256\u5b66\u30af\u30a4\u30ba"},pt:{title:"Question\xe1rios de Anatomia"},zh:{title:"\u89e3\u5256\u5b66\u6d4b\u9a8c"}}}],specialties:[{title:"Allergy & Immunology",id:"Allergy and Immunology",type:"Category",icon:"allergy-and-immunology",tabTags:r.Ht,translations:{de:{title:"Allergie und Immunologie"},es:{title:"Alergia e inmunolog\xeda"},fr:{title:"Allergie et immunologie"},it:{title:"Allergologia & immunologia"},ja:{title:"\u30a2\u30ec\u30eb\u30ae\u30fc\u3068\u514d\u75ab\u5b66"},pt:{title:"Alergia e Imunologia"},zh:{title:"\u8fc7\u654f\u4e0e\u514d\u75ab\u5b66"}}},{title:"Cardiology",id:"Cardiology",type:"Category",icon:"cardiology",tabTags:r.Ht,translations:{de:{title:"Kardiologie"},es:{title:"Cardiolog\xeda"},fr:{title:"Cardiologie"},it:{title:"Cardiologia"},ja:{title:"\u5fc3\u81d3\u75c5\u5b66"},pt:{title:"Cardiologia"},zh:{title:"\u5fc3\u810f\u79d1"}}},{title:"Dentistry",id:"Dentistry",type:"Category",icon:"dentistry",tabTags:r.Ht,translations:{de:{title:"Zahnmedizin"},es:{title:"Odontolog\xeda"},fr:{title:"Dentisterie"},it:{title:"Odontoiatria"},ja:{title:"\u6b6f\u5b66"},pt:{title:"Odontologia"},zh:{title:"\u7259\u79d1"}}},{title:"Dermatology",id:"Dermatology",type:"Category",icon:"dermatology",tabTags:r.Ht,translations:{de:{title:"Dermatologie"},es:{title:"Dermatolog\xeda"},fr:{title:"Dermatologie"},it:{title:"Dermatologia"},ja:{title:"\u76ae\u819a\u5b66"},pt:{title:"Dermatologia"},zh:{title:"\u76ae\u80a4\u79d1"}}},{title:"Endocrinology",id:"Endocrinology",type:"Category",icon:"endocrinology",tabTags:r.Ht,translations:{de:{title:"Endokrinologie"},es:{title:"Endocrinolog\xeda"},fr:{title:"Endocrinologie"},it:{title:"Endocrinologia"},ja:{title:"\u5185\u5206\u6ccc\u5b66"},pt:{title:"Endocrinologia"},zh:{title:"\u5185\u5206\u6ccc\u79d1"}}},{title:"Gastroenterology",id:"Gastroenterology and Hepatology",type:"Category",icon:"gastroenterology",tabTags:r.Ht,translations:{de:{title:"Gastroenterologie"},es:{title:"Gastroenterolog\xeda"},fr:{title:"Gastroent\xe9rologie"},it:{title:"Gastroenterologia"},ja:{title:"\u80c3\u8178\u5b66"},pt:{title:"Gastroenterologia"},zh:{title:"\u80c3\u80a0\u75c5\u5b66"}}},{title:"Gynecology",id:"Gynecology",type:"Category",icon:"gynecology",tabTags:r.Ht,translations:{de:{title:"Gyn\xe4kologie"},es:{title:"Ginecolog\xeda"},fr:{title:"Gyn\xe9cologie"},it:{title:"Ginecologia"},ja:{title:"\u5a66\u4eba\u79d1\u5b66"},pt:{title:"Ginecologia"},zh:{title:"\u5987\u79d1"}}},{title:"Hematology",id:"Hematology",type:"Category",icon:"hematology",tabTags:r.Ht,translations:{de:{title:"H\xe4matologie"},es:{title:"Hematolog\xeda"},fr:{title:"H\xe9matologie"},it:{title:"Ematologia"},ja:{title:"\u8840\u6db2\u5b66"},pt:{title:"Hematologia"},zh:{title:"\u8840\u6db2\u79d1"}}},{title:"Infectious Disease",id:"Infectious Disease",type:"Category",icon:"infectious-disease",tabTags:r.Ht,translations:{de:{title:"Infektionskrankheit"},es:{title:"Enfermedades infecciosas"},fr:{title:"Maladies infectieuses"},it:{title:"Malattie infettive"},ja:{title:"\u611f\u67d3\u75c7"},pt:{title:"Doen\xe7a Infecciosa"},zh:{title:"\u4f20\u67d3\u75c5"}}},{title:"Nephrology",id:"Nephrology",type:"Category",icon:"nephrology",tabTags:r.Ht,translations:{de:{title:"Nephrologie"},es:{title:"Nefrolog\xeda"},fr:{title:"N\xe9phrologie"},it:{title:"Nefrologia"},ja:{title:"\u814e\u81d3\u5b66"},pt:{title:"Nefrologia"},zh:{title:"\u80be\u79d1"}}},{title:"Neurology & Psychiatry",id:"Neurology and Psychiatry",type:"Category",icon:"neurology-and-psychiatry",tabTags:r.Ht,translations:{de:{title:"Neurologie und Psychiatrie"},es:{title:"Neurolog\xeda y psiquiatr\xeda"},fr:{title:"Neurologie et psychiatrie"},it:{title:"Neurologia & psichiatria"},ja:{title:"\u795e\u7d4c\u5b66\u30fb\u7cbe\u795e\u533b\u5b66"},pt:{title:"Neurologia e Psiquiatria"},zh:{title:"\u795e\u7ecf\u79d1&\u7cbe\u795e\u79d1"}}},{title:"Obstetrics",id:"Obstetrics",type:"Category",icon:"obstetrics",tabTags:r.NB,translations:{de:{title:"Geburtshilfe"},es:{title:"Obstetricia "},fr:{title:"Obst\xe9trique"},it:{title:"Ostetricia"},ja:{title:"\u7523\u79d1\u5b66"},pt:{title:"Obstetr\xedcia"},zh:{title:"\u4ea7\u79d1"}}},{title:"Oncology",id:"Oncology",type:"Category",icon:"oncology",tabTags:r.Ht,translations:{de:{title:"Onkologie"},es:{title:"Oncolog\xeda"},fr:{title:"Oncologie"},it:{title:"Oncologia"},ja:{title:"\u816b\u760d\u5b66"},pt:{title:"Oncologia"},zh:{title:"\u80bf\u7624\u79d1"}}},{title:"Ophthalmology",id:"Ophthalmology",type:"Category",icon:"ophtalmology",tabTags:r.Ht,translations:{de:{title:"Ophthalmologie"},es:{title:"Oftalmolog\xeda"},fr:{title:"Ophtalmologie"},it:{title:"Oftalmologia"},ja:{title:"\u773c\u79d1\u5b66"},pt:{title:"Oftalmologia"},zh:{title:"\u773c\u79d1"}}},{title:"Orthopedics",id:"Orthopedics",type:"Category",icon:"orthopedics",tabTags:r.Ht,translations:{de:{title:"Orthop\xe4die"},es:{title:"Ortopedia"},fr:{title:"Orthop\xe9die"},it:{title:"Ortopedia"},ja:{title:"\u6574\u5f62\u5916\u79d1\u5b66"},pt:{title:"Ortopedia"},zh:{title:"\u9aa8\u79d1"}}},{title:"Otolaryngology",id:"Otolaryngology",type:"Category",icon:"otolarygngology",tabTags:r.Ht,translations:{de:{title:"Otolaryngologie"},es:{title:"Otorrinolaringolog\xeda"},fr:{title:"Otorhinolaryngologie"},it:{title:"Otorinolaringoiatria"},ja:{title:"\u8033\u9f3b\u79d1\u5b66"},pt:{title:"Otorrinolaringologia"},zh:{title:"\u8033\u9f3b\u5589\u79d1"}}},{title:"Pediatrics",id:"Pediatrics",type:"Category",icon:"pediatrics",tabTags:r.Ht,translations:{de:{title:"P\xe4diatrie"},es:{title:"Pediatr\xeda"},fr:{title:"P\xe9diatrie"},it:{title:"Pediatria"},ja:{title:"\u5c0f\u5150\u79d1\u5b66"},pt:{title:"Pediatria"},zh:{title:"\u513f\u79d1"}}},{title:"Physical Therapy",id:"Physical Therapy",type:"Category",icon:"physical-therapy",tabTags:r.Ht,translations:{de:{title:"Physiotherapie"},es:{title:"Fisioterapia"},fr:{title:"Kin\xe9sith\xe9rapie"},it:{title:"Fisioterapia"},ja:{title:"\u7406\u5b66\u7642\u6cd5"},pt:{title:"Fisioterapia"},zh:{title:"\u7269\u7406\u6cbb\u7597"}}},{title:"Primary Care",id:"Primary Care",type:"Category",icon:"primary-care",tabTags:r.Ht,translations:{de:{title:"Prim\xe4rversorgung"},es:{title:"Atenci\xf3n primaria"},fr:{title:"Soins de sant\xe9 primaires"},it:{title:"Assistenza sanitaria di base"},ja:{title:"\u30d7\u30e9\u30a4\u30de\u30ea\u30fc\u30b1\u30a2"},pt:{title:"Aten\xe7\xe3o Prim\xe1ria"},zh:{title:"\u521d\u7ea7\u536b\u751f\u4fdd\u5065"}}},{title:"Pulmonology",id:"Pulmonology and Respiratory",type:"Category",icon:"pulmonology",tabTags:r.Ht,translations:{de:{title:"Pulmonologie"},es:{title:"Neumolog\xeda"},fr:{title:"Pneumologie"},it:{title:"Pneumologia"},ja:{title:"\u547c\u5438\u5668\u5b66"},pt:{title:"Pneumologia"},zh:{title:"\u80ba\u75c5\u79d1"}}},{title:"Rheumatology",id:"Rheumatology",type:"Category",icon:"rheumatology",tabTags:r.Ht,translations:{de:{title:"Rheumatologie"},es:{title:"Reumatolog\xeda"},fr:{title:"Rhumatologie"},it:{title:"Reumatologia"},ja:{title:"\u30ea\u30a6\u30de\u30c1\u5b66"},pt:{title:"Reumatologia"},zh:{title:"\u98ce\u6e7f\u79d1"}}},{title:"Urology",id:"Urology",type:"Category",icon:"urology",tabTags:r.Ht,translations:{de:{title:"Urologie"},es:{title:"Urolog\xeda"},fr:{title:"Urologie"},it:{title:"Urologia"},ja:{title:"\u6ccc\u5c3f\u5668\u79d1\u5b66"},pt:{title:"Urologia"},zh:{title:"\u6ccc\u5c3f\u5916\u79d1"}}}],community:[{title:"Community Bookmarks",id:"public",type:"Community",icon:"community-bookmarks",translations:{de:{title:"Community-Lesezeichen"},es:{title:"Destacados por la comunidad"},fr:{title:"Signets communautaires"},it:{title:"Segnalibri della community"},ja:{title:"\u30b3\u30df\u30e5\u30cb\u30c6\u30a3\u306e\u30d6\u30c3\u30af\u30de\u30fc\u30af"},pt:{title:"Favoritos da comunidade"},zh:{title:"\u793e\u533a\u4e66\u7b7e"}}}],"expert collections":[{id:"Anatomy for Physical Therapy Students",featured:!0,type:"Category",title:"Anatomy for Physical Therapy Students",subtitle:"Created with Kirsten C Moisio PT, PhD",metadata:"Professor of Physical Therapy",image:"/assets/images/expert-collections/physical-therapy.png",featuredIcon:"/assets/images/logos/northwestern-medicine-logo.svg",outerColor:"#28167E",innerColor:"#5B49B6",translations:{de:{title:"Anatomie f\xfcr Studierende der Physiotherapie",subtitle:"Erstellt mit Kirsten C Moisio PT, PhD",metadata:"Professor f\xfcr Physikalische Therapie"},es:{title:"Anatom\xeda para estudiantes de fisioterapia",subtitle:"Creado con Kirsten C Moisio PT, PhD",metadata:"Profesor de Fisioterapia"},fr:{title:"Anatomie pour \xe9tudiants en physioth\xe9rapie",subtitle:"Cr\xe9\xe9 avec Kirsten C Moisio PT, PhD",metadata:"Professeur de kin\xe9sith\xe9rapie"},it:{title:"Anatomia per studenti di terapia fisica",subtitle:"Creato con Kirsten C Moisio PT, PhD",metadata:"Professore di terapia fisica"},ja:{title:"\u7406\u5b66\u7642\u6cd5\u5b66\u751f\u306e\u305f\u3081\u306e\u89e3\u5256\u5b66",subtitle:"Kirsten C Moisio PT, PhD\u3068\u5171\u540c\u3067\u4f5c\u6210",metadata:"\u7406\u5b66\u7642\u6cd5\u5b66\u6559\u6388"},pt:{title:"Anatomia para estudantes de fisioterapia",subtitle:"Criado com Kirsten C Moisio PT, PhD",metadata:"Professor de Fisioterapia"},zh:{title:"\u7269\u7406\u6cbb\u7597\u5b66\u751f\u7684\u89e3\u5256\u5b66",subtitle:"\u7531 Kirsten C Moisio PT \u535a\u58eb\u521b\u4f5c",metadata:"\u7269\u7406\u7597\u6cd5\u6559\u6388"}}},{id:"Anatomy for Medical Students",featured:!0,type:"Category",tabTags:r.iE,title:"Anatomy for Medical Students",subtitle:"Created with Jonathan J Wisco, PhD",metadata:"Associate Professor of Anatomy & Neurobiology",image:"/assets/images/expert-collections/medical.png",featuredIcon:"/assets/images/logos/bu-logo.svg",outerColor:"#242629",innerColor:"#585D64",translations:{de:{title:"Anatomie f\xfcr Medizinstudenten",subtitle:"Erstellt mit Jonathan J Wisco, PhD",metadata:"Assoziierter Professor f\xfcr Anatomie und Neurobiologie"},es:{title:"Anatom\xeda para estudiantes de medicina",subtitle:"Creado con Jonathan J Wisco, PhD",metadata:"Profesor asociado de anatom\xeda y neurobiolog\xeda"},fr:{title:"Anatomie pour les \xe9tudiants en m\xe9decine",subtitle:"Cr\xe9\xe9 avec Jonathan J Wisco, PhD",metadata:"Professeur associ\xe9 d'anatomie et de neurobiologie"},it:{title:"Anatomia per studenti di medicina",subtitle:"Creato con Jonathan J Wisco, PhD",metadata:"Professore associato di Anatomia e Neurobiologia"},ja:{title:"\u533b\u5b66\u751f\u306e\u305f\u3081\u306e\u89e3\u5256\u5b66",subtitle:"\u30b8\u30e7\u30ca\u30b5\u30f3\u30fbJ\u30fb\u30a6\u30a3\u30b9\u30b3\u535a\u58eb\u3068\u5171\u540c\u3067\u4f5c\u6210",metadata:"\u89e3\u5256\u5b66\u304a\u3088\u3073\u795e\u7d4c\u751f\u7269\u5b66\u306e\u51c6\u6559\u6388"},pt:{title:"Anatomia para estudantes de medicina",subtitle:"Criado com Jonathan J Wisco, PhD",metadata:"Professor Associado de Anatomia e Neurobiologia"},zh:{title:"\u533b\u5b66\u751f\u89e3\u5256\u5b66",subtitle:"\u7531 Jonathan J Wisco \u535a\u58eb\u521b\u4f5c",metadata:"\u89e3\u5256\u5b66\u548c\u795e\u7ecf\u751f\u7269\u5b66\u526f\u6559\u6388"}}}]};function E(g){return[...P(C.main,g),...P(C.categories,g),...P(o,g),...P(C.specialties,g),...P(C.community,g),...P(C["expert collections"],g)]}function y(g,u){let h=C.categories;return u&&(h=u.map(S=>o.find(f=>f.id===S)).concat(h)),{all:P(C.main,g),anatomy:P(h,g),specialties:P(C.specialties,g),community:P(C.community,g),"expert collections":P(C["expert collections"],g)}}function d(g,u){return P(C[g],u)}function _(g,u){if(null==g)return null;let h=(0,t.cloneDeep)(E().find(S=>S.id===g));return null==h?null:(u&&(h=s(h,u)),h)}function v(g){return C.specialties.find(u=>g.tags.some(h=>h===u.id))}function b(g){return C.categories.find(u=>g.tags.some(h=>h===u.id))}function P(g,u){return g.map(h=>s(h,u))}function s(g,u){const h=(0,t.cloneDeep)(g);return u&&(h.title=(0,t.get)(h,`translations.${u}.title`,h.title),h.subtitle&&(h.subtitle=(0,t.get)(h,`translations.${u}.subtitle`,h.subtitle)),h.metadata&&(h.metadata=(0,t.get)(h,`translations.${u}.metadata`,h.metadata))),h}},41722:(ge,F,n)=>{"use strict";n.d(F,{K:()=>t});class t{}},45691:(ge,F,n)=>{"use strict";n.d(F,{cC:()=>e.c,dt:()=>o});var t=n(60177),e=n(27044),r=n(54438);let o=(()=>{var C;class E{static forRoot(d){return{ngModule:E,providers:[{provide:d,useClass:d},{provide:e.c,useClass:e.c,deps:[d]}]}}}return(C=E).\u0275fac=function(d){return new(d||C)},C.\u0275mod=r.$C({type:C}),C.\u0275inj=r.G2t({imports:[t.MD]}),E})()},27044:(ge,F,n)=>{"use strict";n.d(F,{c:()=>y});var t=n(49204),r=n(27153),o=n(54438),C=n(41722);let y=(()=>{var d;class _{constructor(b){if(!b.accountUrl)throw new Error("Missing accountUrl. Please set in app config via ZendeskWidgetProvider");this.window=function E(){return window}();let P=this.window;P.zEmbed||function(s,g){var u,h,S,m,i=[],c=document.createElement("iframe");P.zEmbed=function(){i.push(arguments)},P.zE=P.zE||P.zEmbed,c.src="javascript:false",c.title="",c.style.cssText="display: none",(S=(S=document.getElementsByTagName("script"))[S.length-1]).parentNode.insertBefore(c,S),m=c.contentWindow.document;try{h=m}catch{u=document.domain,c.src='javascript:var d=document.open();d.domain="'+u+'";void(0);',h=m}h.open()._l=function(){var a=this.createElement("script");u&&(this.domain=u),a.id="js-iframe-async",a.src="https://assets.zendesk.com/embeddable_framework/main.js",this.t=+new Date,this.zendeskHost=b.accountUrl,this.zEQueue=i,this.body.appendChild(a)},h.write('<body onload="document._l();">'),h.close()}(),this.window.zE(()=>{b.beforePageLoad(this.window.zE)})}setLocale(b){this.window.zE(()=>{this.window.zE.setLocale(b)})}identify(b){this.window.zE(()=>{(0,t.isNil)(b)?this.window.zE("webWidget","clear"):this.window.zE.identify({name:this.getUserFullName(b),email:b.email})})}hide(){this.window.zE(()=>{this.window.zE.hide()})}show(){this.window.zE(()=>{this.window.zE.show()})}activate(b){this.window.zE(()=>{this.window.zE.activate(b)})}showWidget(b="help"){this.hide(),this.setSettings({webWidget:{helpCenter:{suppress:"contact"===b}}}),this.activate({hideOnClose:!0})}setHelpCenterSuggestions(b){this.window.zE(()=>{this.window.zE.setHelpCenterSuggestions(b)})}setSettings(b){this.window.zE(()=>{this.window.zE("webWidget","updateSettings",b)})}updateFromProfile(b){const P=[];if(null!=b){const{premium_account:g,premium_account_type:u,developer_account:h,subscription:S}=b;g?(P.push(`premium_account_${u}`),S&&P.push(`subscription_${S.subscription_provider}`)):P.push("free_account"),h&&P.push("developer_account")}const s=(0,r.E)(b);this.setSettings({webWidget:{position:{horizontal:"right",vertical:"bottom"},offset:{horizontal:"0px",vertical:"0px"},contactForm:{suppress:!s,tags:P,fields:[{id:"name",prefill:{"*":this.getUserFullName(b)}}]}}})}getUserFullName(b){if(b){const{first_name:P,last_name:s}=b;return`${P} ${s}`}return""}}return(d=_).\u0275fac=function(b){return new(b||d)(o.KVO(C.K))},d.\u0275prov=o.jDH({token:d,factory:d.\u0275fac,providedIn:"root"}),_})()},70914:(ge,F,n)=>{"use strict";n.d(F,{V:()=>C});var t=n(28407),e=n(54438),r=n(345),o=n(35286);let C=(()=>{var E;class y{constructor(_,v){var b=this;this.domSanitizer=_,this.markdownService=v,this.html=(0,e.hFB)(""),this.markdownText=(0,e.hFB)(""),this.safeHTML=(0,e.vPA)(""),(0,e.QZP)((0,t.A)(function*(){const P=b.html(),s=b.markdownText(),g=P||(yield b.markdownService.parse(s))||"",u=b.domSanitizer.bypassSecurityTrustHtml(g);b.safeHTML.set(u)}))}}return(E=y).\u0275fac=function(_){return new(_||E)(e.rXU(r.up),e.rXU(o.Rl))},E.\u0275cmp=e.VBU({type:E,selectors:[["app-html"]],inputs:{html:[e.Mj6.SignalBased,"html"],markdownText:[e.Mj6.SignalBased,"markdownText"]},standalone:!0,features:[e.aNF],decls:1,vars:1,consts:[[1,"html",3,"innerHTML"]],template:function(_,v){1&_&&e.nrm(0,"div",0),2&_&&e.Y8G("innerHTML",v.safeHTML(),e.npT)},encapsulation:2,changeDetection:0}),y})()},86050:(ge,F,n)=>{"use strict";n.d(F,{O:()=>e});var e,r,t=n(49969);(r=e||(e={})).slideTransition=(0,t.lY)([(0,t.iF)({transform:"translateY({{ from }}%)",opacity:0}),(0,t.i0)("{{ duration }}ms ease-out",(0,t.iF)({transform:"translateY({{ to }})",opacity:1}))]),r.fadeIn=(0,t.lY)([(0,t.iF)({opacity:0}),(0,t.i0)("{{ duration }}ms ease-out",(0,t.iF)({opacity:1}))]),r.fadeOut=(0,t.lY)([(0,t.iF)({opacity:"*"}),(0,t.i0)("{{ duration }}ms ease-in",(0,t.iF)({opacity:0}))])},11789:(ge,F,n)=>{"use strict";var t;n.d(F,{T:()=>t}),function(e){const o=/(\s*[\d\.]+\s*,){2,15}\s*[\d\.]+\s*/g;function E(a){for(let l=0;l<3;l++)if(parseFloat(`${a[l]}`)>1)return!0;return!1}function d(a){const l=document.createElement("div");l.style.backgroundColor=a,document.documentElement.appendChild(l);const p=window.getComputedStyle(l).backgroundColor.replace(/\s/g,"");return window.document.documentElement.removeChild(l),p}function _(a){const l=a.slice(0,4);3===l.length&&l.push(1);for(let p=0;p<4;p++)l[p]=parseFloat(`${l[p]}`),l[p]<0&&(l[p]=0),l[p]>255&&(l[p]=255);return l[3]>1&&(l[3]=1),l}function v(a){let l;if(Array.isArray(a))l=_(a);else if("string"==typeof a){let p=a.match(o);p?l=_(p[0].split(",")):(p=d(a).match(o),p&&(l=_(p[0].split(","))))}return l}function b(a){const l=v(a);if(!l)throw new TypeError("Invalid color input.");const p=s(l);return{1:E(l)?p:l,255:E(l)?l:p}}function s(a){const l=E(a),p=[];for(let A=0;A<3;A++){let O=l?a[A]/255:255*a[A];O=l?Math.round(100*O)/100:Math.round(O),p.push(O)}return 4===a.length&&p.push(a[3]),p}function g(a,l=!1){a=a.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,(q,B,j,V)=>[B,B,j,j,V,V].join("")).replace(/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,(q,B,j,V)=>[B,j,V,"ff"].join(""));const p=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(a),A=parseInt(p[1],16),O=parseInt(p[2],16),L=parseInt(p[3],16),k=parseInt(p[4],16)/255;if(l){const q=m([A,O,L]);return[q[0],q[1],q[2],k]}return[A,O,L,k]}function S(a){const[l,p,A]=a;return Math.sqrt(l*l*.299+p*p*.587+A*A*.114)}function m(a){return a.map(p=>p/255)}function i(a){return a.map(p=>Math.round(255*p))}function c(a){return`#${a.map(p=>{const A=p.toString(16);return A.length%2?`0${A}`:A}).join("")}`}e.is255=E,e.isLight=function y(a,l){return l||(l=[...a]),(S(a)+S(l))/2>140.25},e.getComputedColor=d,e.convertChannels=_,e.convert=v,e.getColor=b,e.getColors=function P(a){let l=[];if("string"==typeof a){const p=a.match(o);p&&(a=p.join(",")),a=a.split(",")}if(Array.isArray(a))if(Array.isArray(a[0])&&Array.isArray(a[1]))l=a;else if(a.length<=2)l=1===a.length?a.concat(a):a;else{const A=Math.floor(a.length/2);l=a.length>4?[a.slice(0,A),a.slice(A)]:[a,a]}return l.map(p=>b(p))},e.scaleColor=s,e.hexToRgba=g,e.hexToRgb=function u(a,l=!1){const p=g(a,l);return[p[0],p[1],p[2]]},e.rgbToHex=function h(a,l=!1){return c(l?i(a):a)},e.rgbToHSP=S,e.rgbaToHex=function f(a,l=!1){const p=a[0],A=a[1],O=a[2],L=255*a[3];return c(l?[...i([p,A,O]),L]:[p,A,O,L])},e.rgbToDecimal=m,e.rgbFromDecimal=i}(t||(t={}))},3287:(ge,F,n)=>{"use strict";n.d(F,{H:()=>r});var t=n(2573),e=n(74902);function r(o,C,E=!0){const y=new e.F,d=[];return E&&d.push(C.map(_=>_.label)),o.forEach(_=>{const v=C.map(b=>_[b.field]);d.push(v)}),new t.c(_=>{const v=y.unparse(d,{quotes:!0,header:!1});_.next(v),_.complete()})}},87947:(ge,F,n)=>{"use strict";n.d(F,{g:()=>y});var y,t=n(49204),r=n(35426),o=n(76718),C=n(36110),E=n(35160);!function(d){function v(S){s()&&(S||(S=document.body),S.requestFullscreen?S.requestFullscreen():S.webkitRequestFullscreen&&S.webkitRequestFullscreen())}function b(){s()&&(document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen&&document.webkitExitFullscreen())}function P(){return document.fullscreenEnabled||document.webkitFullscreenEnabled}function s(){return!!P()||(console.warn("Fullscreen is not enabled"),!1)}function g(){return document.fullscreenElement||document.webkitFullscreenElement}function u(){return!(0,t.isNil)(g())}d.toggleFullscreen=function _(S){const f=g();(0,t.isNil)(f)?v(S):b()},d.requestFullscreen=v,d.exitFullscreen=b,d.canFullscreen=P,d.checkFullscreenSupport=s,d.getFullscreenElement=g,d.isFullscreen=u,d.onFullscreenChange=function h(){const S=["mozfullscreenchange","webkitfullscreenchange","fullscreenchange"].map(f=>(0,r.R)(document.body,f));return(0,o.h)(...S).pipe((0,C.T)(()=>u()),(0,E.Z)(u()))}}(y||(y={}))},42482:(ge,F,n)=>{"use strict";n.d(F,{X:()=>_});var _,t=n(28407),e=n(15877),r=n(2573),o=n(37678),E=n(67092),y=n(68947),d=n(7662);!function(v){function u(){return(u=(0,t.A)(function*(c,a=!1){return(0,d.mo)(c,{pixelRatio:1,skipFonts:!0,...a?{backgroundColor:"transparent"}:{}})})).apply(this,arguments)}v.exportImage=function b(c,a,l,p){const A="string"==typeof c?v.base64ToBlob(c,a):c;return p?(0,E.r)(A,p).then(function(O){(0,o.saveAs)(O,l)}):(0,o.saveAs)(A,l),(0,e.of)(!0)},v.canvasToBlob=function P(c,a,l){return new r.c(p=>{c.toBlob(A=>{p.next(A),p.complete()},a,l)})},v.fitCanvas=function s(c,a,l){const p=document.createElement("canvas");p.width=a,p.height=l;const A=p.getContext("2d"),q=Math.max(.5*(c.width-p.width/p.height*c.height),0);return A.drawImage(c,q,0,p.width,p.height),p},v.elementToCanvas=function g(c){return u.apply(this,arguments)},v.combineCanvasElements=function h(c){const a=Math.max(0,...c.map(O=>O.width)),l=Math.max(0,...c.map(O=>O.height)),p=document.createElement("canvas");p.width=a,p.height=l;const A=p.getContext("2d");return c.forEach(O=>{A.drawImage(O,0,0)}),p},v.base64ToBlob=function S(c,a){const l=atob(c.split(",")[1]),p=new ArrayBuffer(l.length),A=new Uint8Array(p);for(let O=0;O<l.length;O++)A[O]=l.charCodeAt(O);return new Blob([p],{type:a})},v.blobToBase64=function f(c){return new r.c(a=>{const l=new FileReader;l.addEventListener("load",()=>{a.next(l.result),a.complete()}),l.readAsDataURL(c)})},v.blobToCanvas=function m(c,a,l){return new r.c(p=>{const A=document.createElement("canvas");A.width=a,A.height=l;const O=A.getContext("2d"),L=new Image,k=URL.createObjectURL(c);L.addEventListener("load",()=>{O.drawImage(L,0,0),URL.revokeObjectURL(k),p.next(A),p.complete()}),L.src=k})},v.createModelFileName=function i(c,a,l,p){let A=c||a||"";return c&&a&&c!==a&&(A=`${c}_${a}`),`${y.l.normalize(A).replace(/ /g,"_").replace(/\W/g,"").toLowerCase()}${p?`_${p}`:""}.${l.replace(".","")}`}}(_||(_={}))},46889:(ge,F,n)=>{"use strict";n.d(F,{A1:()=>r,E8:()=>e,dL:()=>o,vT:()=>C});var t=n(38472);function e(E,y){const d=t.create();return t.sub(d,y,E),t.length(d)}function r(E,y){const d=t.create();return t.add(d,y,E),t.scale(d,d,.5),d}function o(E,y,d,_,v,b){const P=(E-y)/(d-y);return(b=b??t.create())[0]=_[0]+P*(v[0]-_[0]),b[1]=_[1]+P*(v[1]-_[1]),b[2]=_[2]+P*(v[2]-_[2]),b}function C(E,y,d){const _=E*E;return y+d*(-1*_*_+_*E*4+-6*_+4*E)}},47833:(ge,F,n)=>{"use strict";n.d(F,{Un:()=>C,mJ:()=>o});var t=n(22083),e=n(24418),r=n(27180);function o(y,d,_=!0){return.01*(window.innerHeight-(_&&y!==t.D.Hide?d:0))}function C(y){return y===t.D.Logo||e.c.application!==r.c.Viewer}},68947:(ge,F,n)=>{"use strict";n.d(F,{l:()=>o});var o,t=n(28407),e=n(49204);!function(C){function P(){return(P=(0,t.A)(function*(u,h,S,f=!1){return s(u,yield h.parse(S),f)})).apply(this,arguments)}function s(u,h,S=!1){const f=u.createElement("div");return u.setProperty(f,"innerHTML",h),S&&f.querySelectorAll("p").forEach(i=>{u.setProperty(i,"textContent",i.textContent+" ")}),(0,e.trim)(f.textContent)}C.normalize=function E(u){return`${u||""}`.replace(/&#(\d+);/g,(S,f)=>String.fromCharCode(f)).replace(/(&.+;)/gi,(S,f)=>String.fromCharCode(S.charCodeAt(0)))},C.prettyPrint=function y(u){return`${u||""}`.trim().replace(/([A-Z])/g," $1").replace(/^./,S=>S.toUpperCase()).trim()},C.parseEmails=function d(u){return u.split(/[,\r\n]/).map(h=>h.trim()).filter(h=>!!h)},C.validateEmail=function _(u){return/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/.test(u)},C.toTitleCase=function v(u){return u.replace(/\w\S*/g,h=>h.charAt(0).toUpperCase()+h.substring(1).toLowerCase())},C.getPlainTextFromMarkdown=function b(u,h,S){return P.apply(this,arguments)},C.getPlainTextFromHTML=s,C.splitTextByCharacterCount=function g(u,h){for(var S=[];u.length>h;){var f=u.substring(0,h).lastIndexOf(" ");S.push(u.substring(0,f=f<=0?h:f));var m=u.indexOf(" ",f)+1;(m<f||m>f+h)&&(m=f),u=u.substring(m)}return S.push(u),S}}(o||(o={}))},83889:(ge,F,n)=>{"use strict";n.d(F,{n:()=>r});var t=n(54438);const e={"Sign in":"3971305","Sign up":"3971297"};let r=(()=>{var o;class C{constructor(y){this.config=y,this.initialized=!1}initialize(){if(!this.config.enabled||this.initialized)return;const y=`\n      _linkedin_partner_id = "${this.config.linkedinId}"; \n      window._linkedin_data_partner_ids = window._linkedin_data_partner_ids || []; \n      window._linkedin_data_partner_ids.push(_linkedin_partner_id);\n      (function(){var s = document.getElementsByTagName("script")[0]; var b = document.createElement("script"); b.type = "text/javascript";b.async = true; b.src = "https://snap.licdn.com/li.lms-analytics/insight.min.js"; s.parentNode.insertBefore(b, s);})();\n    `,d=document.createElement("script");d.textContent=y,document.body.appendChild(d),this.initialized=!0}track(y){const d=e[y];if(d){const _=document.createElement("img");_.height=1,_.width=1,_.style.display="none",_.alt="",_.src=`https://px.ads.linkedin.com/collect/?pid=${this.config.linkedinId}&conversionId=${d}&fmt=gif`,document.body.appendChild(_)}}}return(o=C).\u0275fac=function(y){return new(y||o)(t.KVO("linkedinConfig"))},o.\u0275prov=t.jDH({token:o,factory:o.\u0275fac,providedIn:"root"}),C})()},49206:(ge,F,n)=>{"use strict";n.d(F,{Z:()=>C,n:()=>E});var t=n(89417),e=n(49204),o=n(54438);let C=(()=>{var y;class d{get control(){return this.formControl||this.controlContainer.control.get(this.formControlName)}constructor(v){this.controlContainer=v}registerOnTouched(v){this.formControlDirective.valueAccessor.registerOnTouched(v)}registerOnChange(v){this.formControlDirective.valueAccessor.registerOnChange(v)}writeValue(v){this.formControlDirective.valueAccessor.writeValue(v)}setDisabledState(v){this.formControlDirective.valueAccessor.setDisabledState(v)}}return(y=d).\u0275fac=function(v){return new(v||y)(o.rXU(t.ZU))},y.\u0275cmp=o.VBU({type:y,selectors:[["app-base-accessor-control"]],viewQuery:function(v,b){if(1&v&&o.GBs(t.l_,7),2&v){let P;o.mGM(P=o.lsd())&&(b.formControlDirective=P.first)}},inputs:{formControl:"formControl",formControlName:"formControlName"},decls:0,vars:0,template:function(v,b){},encapsulation:2}),d})(),E=(()=>{var y;class d{get value(){return this._value}set value(v){(0,e.isEqual)(this._value,v)||(this._value=v,this.setFormValues(v),this.onChange(v))}constructor(){}onChange(v){}onTouched(){}registerOnTouched(v){this.onTouched=v}registerOnChange(v){this.onChange=v}writeValue(v){this.value=v}setDisabledState(v){this.disabled=v}}return(y=d).\u0275fac=function(v){return new(v||y)},y.\u0275cmp=o.VBU({type:y,selectors:[["app-abstract-input-control"]],inputs:{value:"value",disabled:"disabled"},decls:0,vars:0,template:function(v,b){},encapsulation:2}),d})()},9592:(ge,F,n)=>{"use strict";n.d(F,{G:()=>e,H:()=>t});var t=function(r){return r.JPEG="image/jpeg",r.PNG="image/png",r}(t||{});const e={[t.JPEG]:"jpeg",[t.PNG]:"png"}},97443:(ge,F,n)=>{"use strict";n.d(F,{M:()=>t});var t=function(e){return e.Responsive="responsive",e.Fixed="fixed",e}(t||{})},3188:(ge,F,n)=>{"use strict";n.d(F,{s:()=>t});var t=function(e){return e.Pending="pending",e.Accepted="accepted",e.Denied="denied",e.Expired="expired",e}(t||{})},82542:(ge,F,n)=>{"use strict";n.d(F,{P:()=>t});var t=function(e){return e.Dark="dark",e.Light="light",e}(t||{})},18272:(ge,F,n)=>{"use strict";n.d(F,{q:()=>t});var t=function(e){return e[e.List=0]="List",e[e.Tree=1]="Tree",e}(t||{})},13491:(ge,F,n)=>{"use strict";n.d(F,{n:()=>t});class t{static toArray(r){return[r.x,r.y,r.z]}static fromArray(r){return{x:r[0],y:r[1],z:r[2]}}}},81642:(ge,F,n)=>{"use strict";n.d(F,{D:()=>e});var t=n(54438);let e=(()=>{var r;class o{constructor(){}roundModel(E,y){const d={...E};return Object.keys(E).filter(_=>"number"==typeof E[_]).forEach(_=>{d[_]=this.roundNumber(E[_],y)}),d}roundNumber(E,y){return Math.round(E*Math.pow(10,y))/Math.pow(10,y)}}return(r=o).\u0275fac=function(E){return new(E||r)},r.\u0275prov=t.jDH({token:r,factory:r.\u0275fac,providedIn:"root"}),o})()},86544:(ge,F,n)=>{"use strict";n.d(F,{R:()=>r});var r,t=n(59429);!function(o){function C(y){return y.split("-")[0].replace(/_particle$/,"")}o.getParticleIdRoot=C,o.generateParticleId=function E(y,d=t.u.getUuid){return`${C(y)}-${d()}`}}(r||(r={}))},6049:(ge,F,n)=>{"use strict";n.d(F,{Y:()=>r});var t=n(60177),e=n(54438);let r=(()=>{var o;class C{}return(o=C).\u0275fac=function(y){return new(y||o)},o.\u0275mod=e.$C({type:o}),o.\u0275inj=e.G2t({imports:[t.MD]}),C})()},78674:(ge,F,n)=>{"use strict";n.d(F,{g:()=>o});var t=n(38645),e=n(14264),r=n(54438);let o=(()=>{var C;class E{constructor(d){this.router=d,this.history=[]}loadRouting(){this.router.events.pipe((0,e.p)(d=>d instanceof t.wF)).subscribe(({urlAfterRedirects:d})=>{this.history=[...this.history,d]})}getHistory(){return this.history}getPreviousUrl(){return this.history[this.history.length-2]||"/"}}return(C=E).\u0275fac=function(d){return new(d||C)(r.KVO(t.Ix))},C.\u0275prov=r.jDH({token:C,factory:C.\u0275fac,providedIn:"root"}),E})()},5690:(ge,F,n)=>{"use strict";n.d(F,{b:()=>C});var t=n(24418),e=n(54438),r=n(36860),o=function(E){return E.Web="web",E.Android="mobile_android",E.iOS="mobile_ios",E}(o||{});let C=(()=>{var E;class y{constructor(_){this.platform=_}get productKey(){return t.c.productKey}get productType(){if(t.c.native){if(this.platform.ANDROID)return o.Android;if(this.platform.IOS)return o.iOS}return o.Web}get productHeader(){return{"Bd-Product-Ua":`BD/Product/${this.productType}/${this.productKey}`}}}return(E=y).\u0275fac=function(_){return new(_||E)(e.KVO(r.OD))},E.\u0275prov=e.jDH({token:E,factory:E.\u0275fac,providedIn:"root"}),y})()},21604:(ge,F,n)=>{"use strict";n.d(F,{G:()=>M});var t=n(60177),e=n(11562),r=n(78696),o=n(45189),C=n(89417),E=n(66598),y=n(41722),d=n(45691),_=n(54438);class v extends y.K{constructor(){super(...arguments),this.accountUrl="biodigital.zendesk.com"}beforePageLoad(W){W.setLocale("en"),W.hide()}}let b=(()=>{var N;class W{}return(N=W).\u0275fac=function(ne){return new(ne||N)},N.\u0275mod=_.$C({type:N}),N.\u0275inj=_.G2t({imports:[d.dt.forRoot(v)]}),W})();var P=n(11818),s=n(90556),g=n(3272),u=n(89511),h=n(59162),S=n(6049),f=n(46374),m=n(59464),i=n(32996),c=n(72026),a=n(82192),l=n(35286),p=n(81488),A=n(38645),O=n(89630);let L=(()=>{var N;class W{}return(N=W).\u0275fac=function(ne){return new(ne||N)},N.\u0275mod=_.$C({type:N}),N.\u0275inj=_.G2t({imports:[t.MD,r.H,c.o]}),W})();var k=n(18824),q=n(9529),B=n(5584),j=n(64218),V=n(64026);let M=(()=>{var N;class W{}return(N=W).\u0275fac=function(ne){return new(ne||N)},N.\u0275mod=_.$C({type:N}),N.\u0275inj=_.G2t({imports:[A.iI,P.C,e.YG,i.z,t.MD,u.h,c.o,g.D,r.H,o.G,p.f,a.G,f.b,S.Y,h.M,C.X1,E.S,m.j,O.$,s.f,b,k.j,q.bU,B.d,j.H,l.y2.forChild(),V.m,P.C,i.z,u.h,g.D,c.o,r.H,p.f,a.G,S.Y,f.b,L,h.M,E.S,m.j,O.$,s.f,B.d,j.H,V.m]}),W})()},17215:(ge,F,n)=>{"use strict";n.d(F,{AJ:()=>y,UT:()=>C,d0:()=>E,n$:()=>v});var t=n(28407),e=n(9989);class r extends e.Ay{constructor(){super("HumanDatabase"),this.version(2).stores({keyValue:",value",analytics:"message"}),this.open(),this.keyValue=this.table("keyValue"),this.analytics=this.table("analytics")}}var o=n(54438),C=function(b){return b.WidgetOptions="widgetOptions",b.SnapshotOptions="snapshotOptions",b.Locale="locale",b.GroupRestriction="GroupRestriction",b.UserAppId="userAppId",b.RememberMeEmail="rememberMeEmail",b.LabelConversionSeen="labelConversionSeen",b.DefaultGroupEdit="defaultGroupEdit",b.DefaultCollectionId="defaultCollectionId",b.GettingStartedTutorial="gettingStartedTutorial",b.SystemMessage="systemMessage",b.ExploreRedesignMessage="exploreRedesignMessage",b.Iphone12Warning="iphone12Warning",b.RecentRecipes="recentRecipes",b.TeamTrialExpirationSeen="teamTrialExpiredSeen",b.ProExpirationSeen="proExpirationSeen",b.PaintPalettes="paintPalettes",b.RecentSearchConfig="recentSearchConfig",b.CameraDebug="cameraDebug",b.TeamWelcomeTourSeen="teamWelcomeTourSeen",b.UserJoinPromptSeen="userJoinPromptSeen",b.UserJoinNotificationInteracted="userJoinNotificationInteracted",b.ZSpaceDevice="zSpaceDevice",b.EnableAdvancedStats="enableAdvancedStats",b.XREnabled="xrEnabled",b}(C||{}),E=function(b){return b.UserMessagesSeen="userMessagesSeen",b.PreviewSize="previewSize",b.GPUAnalyticsStored="gpuAnalyticsStored",b}(E||{}),y=function(b){return b.PreviewStory="previewStory",b.PreviewBookmark="previewBookmark",b}(y||{});class _{constructor(){this._data={}}get keys(){return Object.keys(this._data)}get length(){return this.keys.length}clear(){this._data={}}getItem(P){return this._data[P]}key(P){return this.keys[P]}removeItem(P){delete this._data[P]}setItem(P,s){this._data[P]=s}}let v=(()=>{var b;class P{constructor(){this._localStorage=this.getStorage("localStorage"),this._sessionStorage=this.getStorage("sessionStorage"),this._indexedStorage=new r}getLocalItem(g){return this._localStorage.getItem(`${g}`)}getLocalJSON(g){const u=this.getLocalItem(g);return u?JSON.parse(u):null}setLocalItem(g,u){const h="object"==typeof u?JSON.stringify(u):`${u}`;try{return this._localStorage.setItem(`${g}`,h),!0}catch{return!1}}removeLocalItem(g){this._localStorage.removeItem(`${g}`)}getSessionItem(g){const u=this._sessionStorage.getItem(`${g}`);return u?JSON.parse(u):null}setSessionItem(g,u){const h=JSON.stringify(u);try{return this._sessionStorage.setItem(`${g}`,h),!0}catch{return!1}}removeSessionItem(g){this._sessionStorage.removeItem(`${g}`)}setDatabaseItem(g,u){return this._indexedStorage.keyValue.put(u,g)}setDatabaseAnalyticItem(g){var u=this;(0,t.A)(function*(){yield u._indexedStorage.analytics.put(g)})()}getDatabaseOfflineAnalytics(g){var u=this;(0,t.A)(function*(){const h=yield u._indexedStorage.analytics.toArray();u._indexedStorage.analytics.clear(),g(h)})()}getDatabaseOfflineAnalyticsCount(g){var u=this;(0,t.A)(function*(){const h=yield u._indexedStorage.analytics.toArray();g(h.length)})()}getDatabaseItem(g){return this._indexedStorage.keyValue.get(g)}clearStorage(){this.clearLocalStorage(),this.clearSessionStorage()}clearLocalStorage(){this._localStorage.clear()}clearSessionStorage(){this._sessionStorage.clear()}getStorage(g){try{return window[g]||new _}catch{return new _}}}return(b=P).\u0275fac=function(g){return new(g||b)},b.\u0275prov=o.jDH({token:b,factory:b.\u0275fac,providedIn:"root"}),P})()},89612:(ge,F,n)=>{"use strict";n.d(F,{V:()=>_});var _,t=n(49204),r=n(14264),o=n(36110),C=n(21770),E=n(17766),y=n(57238),d=n(69270);!function(v){function s(h,S){const f=new y.R;if(h.thumbnails)f.legacy=!1,f.storyId=S,f.chapterId=h.id,f.urls={...h.thumbnails};else{const i=`/thumbs/${E.c.Bookmark===(0,d.S)(S)?"bookmarks":"modules"}/${S.replace(".json","")}`;f.legacy=!0,f.storyId=S,f.chapterId=h.id,f.urls={small:`${i}/small/chapters/${h.id}.jpg`,large:`${i}/large/chapters/${h.id}.jpg`}}return f}v.generateLegacyThumbnail=function b(h,S){const i=`/thumbs/${E.c.Bookmark===(0,d.S)(h)?"bookmarks":"modules"}/${h.replace(".json","")}`;return{small:`${i}/small/chapters/${S}.jpg`,large:`${i}/large/chapters/${S}.jpg`}},v.generateThumbnails=function P(h){return h.reduce((S,{originalChapterId:f,newChapterId:m,originalStoryId:i})=>{const c=E.c.Bookmark===(0,d.S)(i),a=new y.R;a.storyId=i,a.chapterId=f;const p=`/thumbs/${c?"bookmarks":"modules"}/${i.replace(".json","")}`;return a.urls={small:`${p}/small/chapters/${f}.jpg`,large:`${p}/large/chapters/${f}.jpg`},S.set(m,a),S},new Map)},v.getChapterThumbnail=s,v.getChapterThumbnails=function g(h,S){return S.reduce((f,m)=>{const i=s(m,h);return f.set(m.id,i),f},new Map)},v.makeFreshThumbnail=function u(h,S,f){return(0,C.U_)(f).pipe((0,r.p)(m=>!(0,t.isNil)(m)),(0,o.T)(m=>{const i=new y.R;return i.snapshot=URL.createObjectURL(m),i.chapterId=S,i.storyId=h,i}))}}(_||(_={}))},97415:(ge,F,n)=>{"use strict";n.d(F,{I:()=>t});const t={small:{width:256,height:256},medium:{width:512,height:512},large:{width:1024,height:1024}}},93455:(ge,F,n)=>{"use strict";n.d(F,{V:()=>r});var e,t=n(81025);class r{constructor(){this[e]=!0}}e=t.lE},11113:(ge,F,n)=>{"use strict";var t,e;n.d(F,{e:()=>t}),(e=t||(t={})).updateChapterIds=function r(y,d){return Object.keys(y).reduce((b,P)=>(b[d[P]]=y[P],b),{})},e.duplicateChapter=function o(y,d,_){return{..._,[d]:_[y]}},e.deleteChapter=function C(y,d){const _={...d};return delete _[y],_},e.addEntryForChapter=function E(y,d,_){return _[y]={..._[y],...d},_}},15318:(ge,F,n)=>{"use strict";n.d(F,{K:()=>v});var t=n(11129),e=n(15877),r=n(36110),o=n(39705),C=n(40470),E=n(15040),y=n(17215),d=n(54438),_=n(21626);let v=(()=>{var b;class P{constructor(g,u){this.http=g,this.storageService=u}getUserMessage(g,u="",h=!0){const S=this.getCachedMessage(g);return h&&S?(0,e.of)(S):this.http.get(`/ws/user/message?version=2&type=${g}&mode=${u}`).pipe((0,r.T)(f=>{const{message_seen_id:m,show_alert:i}=f;let c;switch(g){case t.s$.DomainAlert:c=(0,C.bj)(E.n,f.join_organization);break;case t.s$.WelcomeTour:c=`${f.tour_version}`;break;case t.s$.CompleteProfileAlert:const{is_new_user:a,is_team_user:l}=f||{};c=(0,C.bj)(t.KH,{is_new_user:a,is_team_user:l})}return{messageSeenId:m,messageType:g,showUserAlert:i,messageData:c}}),(0,o.M)(f=>{f.showUserAlert||this.addCachedMessage(f)}))}setUserMessageViewed(g){return this.http.post("/ws/user/message",{version:2,message_seen_id:g})}sendMessage(g){return this.http.post("/ws/user/message",g)}getCachedMessage(g){return this.getCachedMessages().find(h=>h.messageType===g)}getCachedMessages(){return this.storageService.getSessionItem(y.d0.UserMessagesSeen)||[]}addCachedMessage(g){if(!this.getCachedMessage(g.messageType)){const u=this.getCachedMessages();this.storageService.setSessionItem(y.d0.UserMessagesSeen,[...u,g])}}}return(b=P).\u0275fac=function(g){return new(g||b)(d.KVO(_.Qq),d.KVO(y.n$))},b.\u0275prov=d.jDH({token:b,factory:b.\u0275fac,providedIn:"root"}),P})()},59429:(ge,F,n)=>{"use strict";var t;n.d(F,{u:()=>t}),function(e){function r(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(C){const E=16*Math.random()|0;return("x"===C?E:3&E|8).toString(16)})}e.getUuid=r,e.idWithPrefix=function o(C){return C?`${C}-${r()}`:r()}}(t||(t={}))},59e3:(ge,F,n)=>{"use strict";n.d(F,{e:()=>v});var t=n(38645),e=n(49204),o=n(14264),C=n(87145),E=n(24418),y=n(63308),d=n(65459),_=n(54438);let v=(()=>{var b;class P{constructor(g,u,h,S){this.config=g,this.router=u,this.route=h,this.organizationsService=S,this.appended=!1,this.initialized=!1,this.sessionEvents={},this.pageEvents={},this.queuedEvents=[],this.initRouteListener()}appendScripts(){!this.config.enabled||this.appended||(this.appendPendo(),this.appendHubspot(),this.appended=!0)}initialize(g,u){this.config.enabled&&(pendo.initialize({visitor:g,account:u}),this.flushQueuedEvents(),this.initialized=!0)}identify(g,u){this.config.enabled&&(pendo.identify({visitor:g,account:u}),this.hubspotIdentify({...g,account:u}))}createVisitorData(g){const u={},h=(0,y.j)(g.account_settings),S=(0,e.get)(g,"organizations[0].user_role.role_display_name",null);if((0,e.has)(g,"id")&&(u.id=this.getPrefixedId(g.id.toString())),(0,e.has)(g,"email")&&(u.email=g.email),(0,e.has)(g,"first_name")&&(0,e.has)(g,"last_name")&&(u.full_name=`${g.first_name} ${g.last_name}`),(0,e.has)(g,"registration_date")&&(u.registration_date=g.registration_date),(0,e.has)(g,"premium_account")&&(u.premium=g.premium_account),(0,e.has)(g,"user_is_developer")&&(u.developer=g.user_is_developer),(0,e.has)(g,"subscription")&&(u.subscriptionType=g.subscription?g.subscription.subscription_type:null),(0,e.has)(g,"is_third_party")&&(u.thirdParty=g.is_third_party),(0,e.has)(h,"account_purpose")&&(u.purpose=h.account_purpose?h.account_purpose.value:null),(0,e.has)(h,"account_role")&&(u.role=h.account_role?h.account_role.value:null),(0,e.has)(h,"account_field")&&(u.field=h.account_field?h.account_field.value:null),(0,e.has)(h,"email_marketing_optin")){const f=(0,e.get)(h,"email_marketing_optin.value",!1);u.emailMarketing=!!f}return S&&(u.teamRole=S),u}createAccountData(g){const u=(0,e.get)(g,"group_attributes",null);return{id:this.getPrefixedId((0,e.get)(g,"id",null)),name:(0,e.get)(g,"name",null),subscriptionType:(0,e.get)(g,"subscription.type",null),subscriptionEndDate:(0,e.get)(g,"subscription.paid_through_date",null),usersCount:(0,e.get)(g,"users_count",null),purpose:this.getGroupAttributeValue(u,"account_purpose"),field:this.getGroupAttributeValue(u,"account_field"),companyWebsite:this.getGroupAttributeValue(u,"account_company_website"),companySize:this.getGroupAttributeValue(u,"account_company_size"),externalAccountProvider:(0,e.get)(g,"external_account.external_account_provider",null)}}updateVisitorData(g){if(!this.config.enabled)return;const u=this.createVisitorData(g);pendo.updateOptions({visitor:u}),this.hubspotIdentify(u,!0)}updateAccountData(g){if(!this.config.enabled)return;const u=this.createAccountData(g);pendo.updateOptions({account:u})}flushQueuedEvents(){this.queuedEvents.forEach(g=>{this.track(g.trackType,g.metadata)})}track(g,u){this.config.enabled&&(this.initialized?pendo.track(g,u):this.queuedEvents.push({trackType:g,metadata:u}))}trackOncePerSession(g,u){this.sessionEvents[g]||this.config.enabled&&(this.track(g,u),this.sessionEvents[g]=!0)}trackOncePerPage(g,u){this.pageEvents[g]||this.config.enabled&&(this.track(g,u),this.pageEvents[g]=!0)}trackSignIn(g){this.trackSignInSignUp("Sign In - Success",g)}trackSignUp(g){this.trackSignInSignUp("Sign Up - Success",g)}trackSignInSignUp(g,u){const h=this.route.snapshot.queryParams;this.track(g,{type:u,referrer:document.referrer,refParam:h.ref||null,groupInvite:(0,e.has)(h,"group_invite"),groupCode:(0,e.has)(h,"group")&&(0,e.has)(h,"code")})}initRouteListener(){this.router.events.pipe((0,o.p)(g=>g instanceof t.wF),(0,C.i)(1)).subscribe(g=>{this.pageEvents={},this.hubspotTrackPageView(g.urlAfterRedirects)})}getPrefixedId(g){return g&&`${(0,e.get)(this.config,`idPrefixes[${E.c.deploy}]`,"")}${g}`}getGroupAttributeValue(g,u){if(!g)return null;const h=this.organizationsService.getOrganizationAttribute(g,"account_settings",u);return h?h.value:null}appendPendo(){const g=`\n      (function(apiKey){\n        (function(p,e,n,d,o){var v,w,x,y,z;o=p[d]=p[d]||{};o._q=o._q||[];\n        v=['initialize','identify','updateOptions','pageLoad','track'];for(w=0,x=v.length;w<x;++w)(function(m){\n            o[m]=o[m]||function(){o._q[m===v[0]?'unshift':'push']([m].concat([].slice.call(arguments,0)));};})(v[w]);\n            y=e.createElement(n);y.async=!0;y.src='https://cdn.pendo.io/agent/static/'+apiKey+'/pendo.js';\n            z=e.getElementsByTagName(n)[0];z.parentNode.insertBefore(y,z);})(window,document,'script','pendo');\n      })('${this.config.pendoId}');\n    `,u=document.createElement("script");u.textContent=g,document.body.appendChild(u)}appendHubspot(){_hsq=window._hsq=window._hsq||[];const g=`${location.pathname}${location.search}${location.hash}`;_hsq.push(["setPath",g]);const u=document.createElement("script");u.async=!0,u.defer=!0,u.src=`//js.hs-scripts.com/${this.config.hubspotId}.js`,document.body.appendChild(u)}hubspotIdentify(g,u=!1){window._hsq?.push(["identify",g]);const h=u?"Visitor Updated":"Visitor Identified";window._hsq?.push(["trackCustomBehavioralEvent",{name:h}])}hubspotTrackPageView(g){window._hsq?.push(["setPath",g]),window._hsq?.push(["trackPageView"])}}return(b=P).\u0275fac=function(g){return new(g||b)(_.KVO("vendorAnalyticsConfig"),_.KVO(t.Ix),_.KVO(t.nX),_.KVO(d.k))},b.\u0275prov=_.jDH({token:b,factory:b.\u0275fac,providedIn:"root"}),P})()},24477:(ge,F,n)=>{"use strict";n.d(F,{Fm:()=>l,Hz:()=>O,JO:()=>a,RS:()=>m,Rh:()=>i,Sy:()=>A,VD:()=>p,XF:()=>P,ld:()=>u,mf:()=>S});var t=n(93822),o=(n(13878),n(65855),n(49204)),E=n(28722),y=n(96557),d=n(45144),_=n(51640),v=n(43753),b=n(11876);class P{}const s=(M,N)=>(0,o.isNil)(M)?N:M;function g(...M){return!!M.some(N=>!0===N)||!M.some(N=>!1===N)&&void 0}function u(M,N,W){const $=f(W,Object.values(E.Y));return(0,o.isNil)($)?!1===M?E.Y.None:null!=N?N?E.Y.Full:E.Y.Small:null:$}function h(M){return f(M,Object.values(y.aD))}function S(M,N){return!0===N?b.Z.Group:f(M,Object.values(b.Z))}function f(M,N){return N.includes(M)?M:null}function m(M){const N=null!=M.all?l(M.all):new P;return A({all:M.all,startingColumn:M.startingColumn,fadeout:M.fadeout,drawerExpanded:M.infoExpand,logoIsHyperLink:void 0,[t.U.AnatomyLabels]:g(M.anatomyLabels,M.anatomyLabels),[t.U.Audio]:M.audio,[t.U.Camera]:g(M.nav,M.cameraMode,M.center,M.zoomIn,M.zoomOut,M.nav),[t.U.Column]:g(M.info,M.info),[t.U.ContextActions]:M.contextActions,[t.U.ContextMenu]:M.contextMenu,[t.U.Drawer]:g(M.info,M.info),[t.U.Fullscreen]:g(M.fullscreen,M.fullscreen),[t.U.Help]:g(M.help,M.help),[t.U.LabelList]:g(M.labelList,M.labelList),[t.U.Labels]:M.labels,[t.U.Layout]:M.layout,[t.U.Legend]:M.legend,[t.U.Logo]:M.logo,[t.U.Loader]:h(M.loader),[t.U.Media]:u(M.playPause,g(M.scrubber,M["scrubber.chapters"]),M.media),[t.U.NodeAudio]:M.anatomyPronunciations,[t.U.NodeInfo]:M.anatomyDescriptions,[t.U.Pagination]:g(M.tour,M["tour.chapters"]),[t.U.Playthrough]:g(M.playthrough,M.autoplay),[t.U.QuizPrompt]:M["ui-quiz"],[t.U.Search]:g(M.objectTree,M.search),[t.U.TitleOnly]:g(M.info,M.info),[t.U.ToggleLabels]:void 0,[t.U.Toolbar]:g(M.toolbar,M.menu),[t.U.Tools]:g(M.tools,M.tools),[t.U.Tutorial]:void 0,[t.U.Undo]:g(M.reset,M.undo),[t.U.VisibilityLayers]:M.visibilityLayers,[t.U.VisibilityLayersMode]:S(M.visibilityLayersMode,M.skinLayers),[t.U.SkinLayers]:g(M.skinLayers),[t.U.Whiteboard]:M.whiteboard},N)}function i(M){const N={all:void 0,anatomyLabels:M.anatomyLabels.enable,audio:M.audio.enable,cameraMode:M.camera.enable,center:M.camera.enable,contextActions:M.contextActions.enable,contextMenu:M.contextMenu.enable,fadeout:void 0,fullscreen:M.fullscreen.enable,help:M.help.enable,info:M.column.enable||M.drawer.enable,infoExpand:M.drawer.isExpandedInitially,labels:M.labels.enable,legend:M.legend.enable,loader:h(M.loader.template),nav:M.camera.enable,objectTree:M.search.enable,playPause:M.media.enable,"scrubber.chapters":M.media.enable,scrubber:M.media.enable,"tools-display":M.tools.enable,tools:M.tools.enable,"tour.chapters":M.pagination.enable,tour:M.pagination.enable,visibilityLayers:M.visibilityLayers.enable,visibilityLayersMode:M.visibilityLayers.layersMode,skinLayers:M.skinLayers.enable,whiteboard:M.whiteboard.enable,zoomIn:M.camera.enable,zoomOut:M.camera.enable,share:!1,dissect:!1,xray:!1,annotations:!1,crossSection:!1,isolate:!1};return(0,o.pickBy)(N,W=>!(0,o.isNil)(W))}function a(M){if(!M||!M.config)return null;const N=new P;return N[t.U.Column]=M.config.info,N[t.U.Drawer]=M.config.info,N[t.U.Fullscreen]=M.config.fullscreen,N[t.U.Search]=M.config.objectTree,N[t.U.Camera]=M.config.nav,N[t.U.Loader]=h(M.config.loader),N[t.U.Whiteboard]=M.config.whiteboard,N[t.U.VisibilityLayers]=M.config.visibilityLayers,N[t.U.VisibilityLayersMode]=S(M.config.visibilityLayersMode,M.config.skinLayers),N[t.U.SkinLayers]=M.config.skinLayers,N[t.U.ContextActions]=M.config.contextActions,N[t.U.Audio]=(0,o.isNil)(M.config.audio)?null:M.config.audio!==d.Y.None,N[t.U.Media]=u(M.config.playPause,M.config.scrubber,M.config.mediaControls),N}function l(M){return{all:M,drawerExpanded:null,logoIsHyperLink:null,fadeout:null,startingColumn:null,[t.U.AnatomyLabels]:null,[t.U.Audio]:M,[t.U.Camera]:M,[t.U.Column]:M,[t.U.ContextActions]:M,[t.U.ContextMenu]:null,[t.U.Drawer]:M,[t.U.Fullscreen]:M,[t.U.Help]:M,[t.U.LabelList]:M,[t.U.Labels]:null,[t.U.Legend]:!0,[t.U.Loader]:M?y.kF:y.aD.None,[t.U.Logo]:!0,[t.U.Media]:M?E.Y.Full:E.Y.None,[t.U.NodeAudio]:M,[t.U.NodeInfo]:M,[t.U.Pagination]:M,[t.U.QuizPrompt]:M,[t.U.Search]:M,[t.U.TitleOnly]:M,[t.U.ToggleLabels]:!0,[t.U.Toolbar]:M,[t.U.Tools]:M,[t.U.Tutorial]:null,[t.U.Undo]:M,[t.U.VisibilityLayers]:M,[t.U.VisibilityLayersMode]:null,[t.U.SkinLayers]:M,[t.U.Whiteboard]:M}}function p(M){const N=new P;return N.anatomyLabels=!1,N.labelList=!1,N.labels=!1,N.legend=!1,N.nodeInfo=!1,N.pagination=!1,N.search=!1,N.toggleLabels=!1,N.tools=M?.type===v.Q5.SelectAnatomy,N.visibilityLayers=!1,N.whiteboard=!1,N}function A(M,N){return null==N?M:(0,o.uniq)([...Object.keys(M),...Object.keys(N)]).reduce(($,ne)=>($[ne]=null==M[ne]?N[ne]:M[ne],$),new P)}function O(M,N){const W=JSON.parse(JSON.stringify(M)),$={..._.p2};return W.loader.enable=s(N[t.U.Loader]!==y.aD.None,$.loader.enable),null!=N[t.U.Loader]&&(W.loader.template=N[t.U.Loader]),W.anatomyLabels.enable=s(N[t.U.AnatomyLabels],$.anatomyLabels.enable),W.audio.enable=s(N[t.U.Audio],$.audio.enable),W.camera.enable=s(N[t.U.Camera],$.camera.enable),W.column.enable=s(N[t.U.Column],$.column.enable),W.contextActions.enable=s(N[t.U.ContextActions],$.contextActions.enable),W.contextMenu.enable=s(N[t.U.ContextMenu],$.contextMenu.enable),W.description.enable=s(N[t.U.Description],$.description.enable),W.drawer.enable=s(N[t.U.Drawer],$.drawer.enable),W.drawer.isExpandedInitially=s(N[t.U.DrawerExpanded],$.drawer.isExpandedInitially),W.fullscreen.enable=s(N[t.U.Fullscreen],$.fullscreen.enable),W.help.enable=s(N[t.U.Help],$.help.enable),W.labelList.enable=s(N[t.U.LabelList],$.labelList.enable),W.labels.enable=s(N[t.U.Labels],$.labels.enable),W.logo.enable=s(N[t.U.Logo],$.logo.enable),W.logo.isHyperLink=s(N.logoIsHyperLink,$.logo.isHyperLink),W.media.enable=s(N[t.U.Media]!==E.Y.None,$.media.enable),W.media.template=N[t.U.Media],W.nodeAudio.enable=s(N[t.U.NodeAudio],$.nodeAudio.enable),W.nodeInfo.enable=s(N[t.U.NodeInfo],$.nodeInfo.enable),W.pagination.enable=s(N[t.U.Pagination],$.pagination.enable),W.playthrough.enable=s(N[t.U.Playthrough],$.playthrough.enable),W.quizPrompt.enable=s(N[t.U.QuizPrompt],$.quizPrompt.enable),W.search.enable=s(N[t.U.Search],$.search.enable),W.titleOnly.enable=s(N[t.U.TitleOnly],$.titleOnly.enable),W.toggleLabels.enable=s(N[t.U.ToggleLabels],$.toggleLabels.enable),W.toolbar.enable=s(N[t.U.Toolbar],$.toolbar.enable),W.tools.enable=s(N[t.U.Tools],$.tools.enable),W.tutorial.enable=s(N[t.U.Tutorial],$.tutorial.enable),W.undo.enable=s(N[t.U.Undo],$.undo.enable),W.visibilityLayers.enable=s(N[t.U.VisibilityLayers],$.visibilityLayers.enable),W.visibilityLayers.layersMode=S(N[t.U.VisibilityLayersMode]??$.visibilityLayers.layersMode,N[t.U.SkinLayers]),W.skinLayers.enable=s(N[t.U.SkinLayers],$.skinLayers.enable),W.whiteboard.enable=s(N[t.U.Whiteboard],$.whiteboard.enable),W}},49188:(ge,F,n)=>{"use strict";n.d(F,{q:()=>r});var t=n(47610),e=n(515);function r(o,C){return o.dispatch(new t._y(!1)),C.fireEvent(e.X.SceneXrayDisabled),!0}},76037:(ge,F,n)=>{"use strict";n.d(F,{J:()=>je});var t=n(28407),e=n(54438),r=n(79805),o=n(29160),C=n(85052),E=n(37925),y=n(14264),d=n(17365),_=n(36110),v=n(21082),b=n(11756),P=n(9065),s=n(82656),g=n(2573);function f(Le){return Le/1048576}var m=n(82542),i=n(65763),c=n(93915),a=n(38753),l=n(3367),p=n(46799),A=n(55494),O=n(94495),L=n(89417),k=n(49204),q=n(47610),B=n(24418),j=n(12215),V=n(515),M=n(17215),N=n(11724);function W(Le){return Le.toLocaleString()}const Q={totalVisibleLeafObjects:{title:"Visible Objects",description:"This value represents the number of visible objects in current chapter.",thresholds:{stable:[0,1e3],warning:[1e3,2e3],danger:[2e3,Number.MAX_SAFE_INTEGER]}},geometries:{title:"Geometry + Morphs",description:"",thresholds:{stable:[0,1e3],warning:[1e3,2e3],danger:[2e3,Number.MAX_SAFE_INTEGER]}},materials:{title:"Material Count",description:"This value represents the number of materials downloaded from BioDigital server whenever a page is reloaded.",thresholds:{stable:[0,50],warning:[50,100],danger:[100,Number.MAX_SAFE_INTEGER]}},textures:{title:"Texture Count",description:"This value represents the number of textures downloaded from BioDigital server whenever a page is reloaded.",thresholds:{stable:[0,50],warning:[50,100],danger:[100,Number.MAX_SAFE_INTEGER]}},duration:{title:"Time to Load (s)",description:"This value represents the number of seconds it takes for the entire BioDigital scene (Materials + Textures + Vertices + etc) to load when the page is refreshed.",thresholds:{stable:[0,4],warning:[4,10],danger:[10,Number.MAX_SAFE_INTEGER]}},drawCalls:{title:"Draw Call Count",description:"",thresholds:{stable:[0,400],warning:[400,600],danger:[600,Number.MAX_SAFE_INTEGER]}},drawVertices:{title:"Vertex Count",description:"",thresholds:{stable:[0,25e4],warning:[25e4,5e5],danger:[5e5,Number.MAX_SAFE_INTEGER]}},cpuTime:{title:"CPU Time (ms)",description:"",thresholds:{stable:[0,8],warning:[8,12],danger:[12,Number.MAX_SAFE_INTEGER]}},frameRate:{title:"Frame Rate (fps)",description:"",thresholds:{stable:[58,Number.MAX_SAFE_INTEGER],warning:[45,58],danger:[0,45]}},downloadGeometry:{title:"Geometry Data",description:"",thresholds:{stable:[0,10],warning:[10,25],danger:[25,Number.MAX_SAFE_INTEGER]}},downloadMorph:{title:"Morph Data",description:"",thresholds:{stable:[0,5],warning:[5,10],danger:[10,Number.MAX_SAFE_INTEGER]}},downloadMaterial:{title:"Material Data",description:"",thresholds:{stable:[0,.5],warning:[.5,1],danger:[1,Number.MAX_SAFE_INTEGER]}},downloadTransform:{title:"Transform Data",description:"",thresholds:{stable:[0,.5],warning:[.5,1],danger:[1,Number.MAX_SAFE_INTEGER]}},memoryUsage:{title:"Active Memory Usage",description:"",thresholds:{stable:[0,400],warning:[400,600],danger:[600,Number.MAX_SAFE_INTEGER]}},chapterPeakMemory:{title:"Chapter Peak Memory",description:"",thresholds:{stable:[0,400],warning:[400,600],danger:[600,Number.MAX_SAFE_INTEGER]}},scenePeakMemory:{title:"Scene Peak Memory",description:"",thresholds:{stable:[0,400],warning:[400,600],danger:[600,Number.MAX_SAFE_INTEGER]}}};function le(Le){return Q[Le]?.title??""}function pe(Le){const Ee=Q[Le]?.thresholds,We=[];if(Ee){const Ze=Object.entries(Ee).reduce((et,[rt,Ge])=>(et.push(`${rt.toUpperCase()}: ${function $(Le){const[Re,Ee]=Le;let We=W(Re);Re===Number.MIN_SAFE_INTEGER&&(We="min");let ze=W(Ee);return Ee===Number.MAX_SAFE_INTEGER&&(ze="max"),`[${We} - ${ze}]`}(Ge)}`),et),[]).join(" ");We.push(Ze)}return We.join(" ")}function ie(Le,Re){const Ee=Q[Le]?.thresholds;if(Ee){const{stable:We,warning:ze,danger:Ze}=Ee;if((0,k.inRange)(Re,...We))return"stable";if((0,k.inRange)(Re,...ze))return"warning";if((0,k.inRange)(Re,...Ze))return"danger"}return"stable"}var U,be=n(60177),de=n(3272),w=n(11818),te=n(82765),R=n(72026),D=n(14823),T=n(27180),re=n(34006),K=n(87505),ae=n(21007),ce=n(26779),Z=function(Le,Re,Ee,We){var et,ze=arguments.length,Ze=ze<3?Re:null===We?We=Object.getOwnPropertyDescriptor(Re,Ee):We;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)Ze=Reflect.decorate(Le,Re,Ee,We);else for(var rt=Le.length-1;rt>=0;rt--)(et=Le[rt])&&(Ze=(ze<3?et(Ze):ze>3?et(Re,Ee,Ze):et(Re,Ee))||Ze);return ze>3&&Ze&&Object.defineProperty(Re,Ee,Ze),Ze},z=function(Le,Re){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(Le,Re)};const H=(Le,Re)=>({"engine-stats--light":Le,"engine-stats--dark":Re,"engine-stats--advanced":!0});function J(Le,Re){if(1&Le&&(e.j41(0,"a",1)(1,"span",7),e.EFF(2," Documentation"),e.k0s(),e.nrm(3,"app-icon",8),e.k0s()),2&Le){const Ee=e.XpG(2);e.BMQ("href",Ee.statsSupportUrl,e.B4B)}}function Y(Le,Re){if(1&Le&&(e.j41(0,"section",3)(1,"table",4)(2,"caption",5),e.EFF(3," Download Size (Total) "),e.k0s(),e.j41(4,"tr")(5,"th",6),e.EFF(6),e.k0s(),e.j41(7,"td"),e.EFF(8),e.nI1(9,"number"),e.k0s()(),e.j41(10,"tr")(11,"th",6),e.EFF(12),e.k0s(),e.j41(13,"td"),e.EFF(14),e.nI1(15,"number"),e.k0s()(),e.j41(16,"tr")(17,"th",6),e.EFF(18),e.k0s(),e.j41(19,"td"),e.EFF(20),e.nI1(21,"number"),e.k0s()(),e.j41(22,"tr")(23,"th",6),e.EFF(24),e.k0s(),e.j41(25,"td"),e.EFF(26),e.nI1(27,"number"),e.k0s()()()()),2&Le){const Ee=e.XpG(2);e.R7$(5),e.Y8G("matTooltip",Ee.getStatDescription("downloadGeometry")),e.R7$(),e.SpI(" ",Ee.getStatTitle("downloadGeometry")," "),e.R7$(),e.HbH(Ee.getStatCSS("downloadGeometry",Ee.engineStats.downloadGeometry)),e.R7$(),e.SpI(" ",e.i5U(9,20,Ee.engineStats.downloadGeometry,"1.2-2")," MB "),e.R7$(3),e.Y8G("matTooltip",Ee.getStatDescription("downloadMorph")),e.R7$(),e.SpI(" ",Ee.getStatTitle("downloadMorph")," "),e.R7$(),e.HbH(Ee.getStatCSS("downloadMorph",Ee.engineStats.downloadMorph)),e.R7$(),e.SpI(" ",e.i5U(15,23,Ee.engineStats.downloadMorph,"1.2-2")," MB "),e.R7$(3),e.Y8G("matTooltip",Ee.getStatDescription("downloadMaterial")),e.R7$(),e.SpI(" ",Ee.getStatTitle("downloadMaterial")," "),e.R7$(),e.HbH(Ee.getStatCSS("downloadMaterial",Ee.engineStats.downloadMaterial)),e.R7$(),e.SpI(" ",e.i5U(21,26,Ee.engineStats.downloadMaterial,"1.2-2")," MB "),e.R7$(3),e.Y8G("matTooltip",Ee.getStatDescription("downloadTransform")),e.R7$(),e.SpI(" ",Ee.getStatTitle("downloadTransform")," "),e.R7$(),e.HbH(Ee.getStatCSS("downloadTransform",Ee.engineStats.downloadTransform)),e.R7$(),e.SpI(" ",e.i5U(27,29,Ee.engineStats.downloadTransform,"1.2-2")," MB ")}}function X(Le,Re){if(1&Le&&(e.j41(0,"section",3)(1,"table",4)(2,"caption",5),e.EFF(3," Memory "),e.k0s(),e.j41(4,"tr")(5,"th",6),e.EFF(6),e.k0s(),e.j41(7,"td"),e.EFF(8),e.nI1(9,"number"),e.k0s()(),e.j41(10,"tr")(11,"th",6),e.EFF(12),e.k0s(),e.j41(13,"td"),e.EFF(14),e.nI1(15,"number"),e.k0s()(),e.j41(16,"tr")(17,"th",6),e.EFF(18),e.k0s(),e.j41(19,"td"),e.EFF(20),e.nI1(21,"number"),e.k0s()()()()),2&Le){const Ee=e.XpG(3);e.R7$(5),e.Y8G("matTooltip",Ee.getStatDescription("memoryUsage")),e.R7$(),e.SpI(" ",Ee.getStatTitle("memoryUsage")," "),e.R7$(),e.HbH(Ee.getStatCSS("memoryUsage",Ee.currentAppStat.memoryUsage)),e.R7$(),e.SpI(" ",e.i5U(9,15,Ee.currentAppStat.memoryUsage,"1.0-0")," MB "),e.R7$(3),e.Y8G("matTooltip",Ee.getStatDescription("chapterPeakMemory")),e.R7$(),e.SpI(" ",Ee.getStatTitle("chapterPeakMemory")," "),e.R7$(),e.HbH(Ee.getStatCSS("chapterPeakMemory",Ee.currentAppStat.chapterPeakMemory)),e.R7$(),e.SpI(" ",e.i5U(15,18,Ee.currentAppStat.chapterPeakMemory,"1.0-0")," MB "),e.R7$(3),e.Y8G("matTooltip",Ee.getStatDescription("scenePeakMemory")),e.R7$(),e.SpI(" ",Ee.getStatTitle("scenePeakMemory")," "),e.R7$(),e.HbH(Ee.getStatCSS("scenePeakMemory",Ee.currentAppStat.scenePeakMemory)),e.R7$(),e.SpI(" ",e.i5U(21,21,Ee.currentAppStat.scenePeakMemory,"1.0-0")," MB ")}}function se(Le,Re){if(1&Le){const Ee=e.RV6();e.j41(0,"button",21),e.bIt("click",function(){e.eBV(Ee);const ze=e.XpG(4);return e.Njj(ze.viewReportClick())}),e.EFF(1," View Report "),e.k0s()}if(2&Le){const Ee=e.XpG(4);e.Y8G("buttonTheme",Ee.theme())}}function oe(Le,Re){if(1&Le){const Ee=e.RV6();e.j41(0,"section",3)(1,"h2",5),e.EFF(2,"Profiler"),e.k0s(),e.j41(3,"form",9)(4,"div",10)(5,"app-form-field",11)(6,"select",12)(7,"option",13),e.EFF(8,"DOM"),e.k0s(),e.j41(9,"option",14),e.EFF(10,"Markers"),e.k0s(),e.j41(11,"option",15),e.EFF(12,"None"),e.k0s()()(),e.j41(13,"app-form-field",16)(14,"mat-checkbox",17),e.EFF(15," Hover Pick Enabled "),e.k0s()()(),e.j41(16,"div",18)(17,"button",19),e.bIt("click",function(){e.eBV(Ee);const ze=e.XpG(3);return e.Njj(ze.toggleCaptureClick())}),e.EFF(18),e.k0s(),e.DNE(19,se,2,1,"button",20),e.k0s()()(),e.j41(20,"section",3)(21,"h2",5),e.EFF(22,"Tools"),e.k0s(),e.j41(23,"div",18)(24,"button",19),e.bIt("click",function(){e.eBV(Ee);const ze=e.XpG(3);return e.Njj(ze.rayPickClick())}),e.EFF(25," Start Ray Picking "),e.k0s(),e.j41(26,"button",21),e.bIt("click",function(){e.eBV(Ee);const ze=e.XpG(3);return e.Njj(ze.runSpectorJSClick())}),e.EFF(27," Run SpectorJS "),e.k0s()()()}if(2&Le){const Ee=e.XpG(3);e.R7$(3),e.Y8G("formGroup",Ee.form),e.R7$(2),e.Y8G("isCompact",!0),e.R7$(8),e.Y8G("isCompact",!0),e.R7$(4),e.Y8G("buttonTheme",Ee.theme())("disabled",Ee.rayPicking),e.R7$(),e.SpI(" ",Ee.capturing?"Stop":"Start"," Capture "),e.R7$(),e.vxM(19,!Ee.capturing&&Ee.capturedStats.length>0?19:-1),e.R7$(5),e.Y8G("buttonTheme",Ee.theme())("disabled",Ee.capturing||Ee.rayPicking),e.R7$(2),e.Y8G("buttonTheme",Ee.theme())}}function me(Le,Re){if(1&Le&&e.DNE(0,X,22,24,"section",3)(1,oe,28,10),2&Le){const Ee=e.XpG(2);e.vxM(0,null!=Ee.currentAppStat&&Ee.currentAppStat.memoryUsage?0:-1),e.R7$(),e.vxM(1,Ee.showAdvancedTools()?1:-1)}}function Se(Le,Re){if(1&Le&&(e.j41(0,"div",0),e.DNE(1,J,4,1,"a",1),e.j41(2,"div",2)(3,"section",3)(4,"table",4)(5,"caption",5),e.EFF(6," Per Module "),e.k0s(),e.j41(7,"tr")(8,"th",6),e.EFF(9),e.k0s(),e.j41(10,"td"),e.EFF(11),e.nI1(12,"number"),e.k0s()(),e.j41(13,"tr")(14,"th",6),e.EFF(15),e.k0s(),e.j41(16,"td"),e.EFF(17),e.nI1(18,"number"),e.k0s()(),e.j41(19,"tr")(20,"th",6),e.EFF(21),e.k0s(),e.j41(22,"td"),e.EFF(23),e.nI1(24,"number"),e.k0s()(),e.j41(25,"tr")(26,"th",6),e.EFF(27),e.k0s(),e.j41(28,"td"),e.EFF(29),e.nI1(30,"number"),e.k0s()(),e.j41(31,"tr")(32,"th",6),e.EFF(33),e.k0s(),e.j41(34,"td"),e.EFF(35),e.nI1(36,"number"),e.k0s()()()(),e.j41(37,"section",3)(38,"table",4)(39,"caption",5),e.EFF(40),e.k0s(),e.j41(41,"tr")(42,"th",6),e.EFF(43),e.k0s(),e.j41(44,"td"),e.EFF(45),e.nI1(46,"number"),e.k0s()(),e.j41(47,"tr")(48,"th",6),e.EFF(49),e.k0s(),e.j41(50,"td"),e.EFF(51),e.nI1(52,"number"),e.k0s()(),e.j41(53,"tr")(54,"th",6),e.EFF(55),e.k0s(),e.j41(56,"td"),e.EFF(57),e.nI1(58,"number"),e.k0s()(),e.j41(59,"tr")(60,"th",6),e.EFF(61),e.k0s(),e.j41(62,"td"),e.EFF(63),e.nI1(64,"number"),e.k0s()()()(),e.DNE(65,Y,28,32,"section",3)(66,me,2,2),e.nI1(67,"async"),e.k0s()()),2&Le){const Ee=e.XpG();e.Y8G("ngClass",e.l_i(79,H,"light"===Ee.theme(),"dark"===Ee.theme())),e.R7$(),e.vxM(1,Ee.enableAdvancedStats?1:-1),e.R7$(7),e.Y8G("matTooltip",Ee.getStatDescription("totalVisibleLeafObjects")),e.R7$(),e.SpI(" ",Ee.getStatTitle("totalVisibleLeafObjects")," "),e.R7$(),e.HbH(Ee.getStatCSS("totalVisibleLeafObjects",Ee.engineStats.totalVisibleLeafObjects)),e.R7$(),e.SpI(" ",e.i5U(12,50,Ee.engineStats.totalVisibleLeafObjects,"1.0")," "),e.R7$(3),e.Y8G("matTooltip",Ee.getStatDescription("geometries")),e.R7$(),e.SpI(" ",Ee.getStatTitle("geometries")," "),e.R7$(),e.HbH(Ee.getStatCSS("geometries",Ee.engineStats.geometries)),e.R7$(),e.SpI(" ",e.i5U(18,53,Ee.engineStats.geometries,"1.0")," "),e.R7$(3),e.Y8G("matTooltip",Ee.getStatDescription("materials")),e.R7$(),e.SpI(" ",Ee.getStatTitle("materials")," "),e.R7$(),e.HbH(Ee.getStatCSS("materials",Ee.engineStats.materials)),e.R7$(),e.SpI(" ",e.i5U(24,56,Ee.engineStats.materials,"1.0")," "),e.R7$(3),e.Y8G("matTooltip",Ee.getStatDescription("textures")),e.R7$(),e.SpI(" ",Ee.getStatTitle("textures")," "),e.R7$(),e.HbH(Ee.getStatCSS("textures",Ee.engineStats.textures)),e.R7$(),e.SpI(" ",e.i5U(30,59,Ee.engineStats.textures,"1.0")," "),e.R7$(3),e.Y8G("matTooltip",Ee.getStatDescription("duration")),e.R7$(),e.SpI(" ",Ee.getStatTitle("duration")," "),e.R7$(),e.HbH(Ee.getStatCSS("duration",null==Ee.currentAppStat?null:Ee.currentAppStat.duration)),e.R7$(),e.SpI(" ",e.i5U(36,62,null==Ee.currentAppStat?null:Ee.currentAppStat.duration,"1.1-1")," "),e.R7$(5),e.SpI(" Per Frame",Ee.statsCached?" (cached)":""," "),e.R7$(2),e.Y8G("matTooltip",Ee.getStatDescription("drawCalls")),e.R7$(),e.SpI(" ",Ee.getStatTitle("drawCalls")," "),e.R7$(),e.HbH(Ee.getStatCSS("drawCalls",Ee.engineStats.drawCalls)),e.R7$(),e.SpI(" ",e.i5U(46,65,Ee.engineStats.drawCalls,"1.0")," "),e.R7$(3),e.Y8G("matTooltip",Ee.getStatDescription("drawVertices")),e.R7$(),e.SpI(" ",Ee.getStatTitle("drawVertices")," "),e.R7$(),e.HbH(Ee.getStatCSS("drawVertices",Ee.engineStats.drawVertices)),e.R7$(),e.SpI(" ",e.i5U(52,68,Ee.engineStats.drawVertices,"1.0")," "),e.R7$(3),e.Y8G("matTooltip",Ee.getStatDescription("cpuTime")),e.R7$(),e.SpI(" ",Ee.getStatTitle("cpuTime")," "),e.R7$(),e.HbH(Ee.getStatCSS("cpuTime",Ee.engineStats.cpuTime)),e.R7$(),e.SpI(" ",e.i5U(58,71,Ee.engineStats.cpuTime,"1.3-3")," "),e.R7$(3),e.Y8G("matTooltip",Ee.getStatDescription("frameRate")),e.R7$(),e.SpI(" ",Ee.getStatTitle("frameRate")," "),e.R7$(),e.HbH(Ee.getStatCSS("frameRate",Ee.engineStats.frameRate)),e.R7$(),e.SpI(" ",e.i5U(64,74,Ee.engineStats.frameRate,"1.0-0")," "),e.R7$(2),e.vxM(65,Ee.enableAdvancedStats?65:-1),e.R7$(),e.vxM(66,Ee.enableAdvancedStats&&e.bMT(67,77,Ee.chapterReady$)?66:-1)}}const Ue=["cpuTime","gpuTime","postProcessTime","frameTime","frameRate"];class je{get engineStats(){return this.engineStats$.value}constructor(Re,Ee,We,ze,Ze,et,rt){this.store=Re,this.engineService=Ee,this.rendererService=We,this.markerService=ze,this.storageService=Ze,this.dialog=et,this.changeRef=rt,this.statsSupportUrl="https://www.notion.so/biodigital/Performance-Panel-Help-Doc-WIP-c0e54dfc39f2465383a18e33a97bdb4c",this.getStatTitle=le,this.getStatDescription=pe,this.enableAdvancedStats=!1,this.theme=(0,e.hFB)(m.P.Dark),this.showAdvancedTools=(0,e.hFB)(!0),this.capturedStats=[],this.engineStats$=new o.t(void 0),this.capturing=!1,this.rayPicking=!1,this.initialLabels=[],this.initialSceneMemory=0,this.initialMemoryByChapter={},this.peakMemoryByChapter={},this.chapterLoadStats={},this.ngUnsubscribe=new C.B,this.initState()}ngOnInit(){this.initFormListeners(),this.initStatsListeners(),this.initMemoryListeners();const Re=new URLSearchParams(window.location.search),Ee="true"===Re.get("ui-stats-capture"),We="false"!==Re.get("ui-stats-hover"),ze=Re.get("ui-stats-label")||"dom";this.form.setValue({hoverPickEnabled:We,labelsMode:ze}),Ee&&this.toggleCapture(!0),this.enableAdvancedStats=B.c.application===T.c.Loft||B.c.deploy!==j.Z.Production||"true"===this.storageService.getLocalItem(M.UT.EnableAdvancedStats),this.changeRef.markForCheck()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}rayPickClick(){confirm("Please note, this may take upto 10+ seconds to run and will lock your browser temporarily. Continue?")&&(this.rayPicking=!0,this.changeRef.markForCheck(),setTimeout(()=>{this.runRayPickSuite().then(Re=>{this.rayPicking=!1,this.changeRef.markForCheck();const{startMemoryUsage:Ee,endMemoryUsage:We,meanRayPickTime:ze}=Re,Ze={startMemoryUsage:`${Ee.toFixed(0)} MB`,endMemoryUsage:`${We.toFixed(0)} MB`,meanRayPickTime:`${ze.toFixed(2)} ms`};alert(JSON.stringify(Ze,null,2))})},1))}runRayPickSuite(){var Re=this;return(0,t.A)(function*(){return new Promise(Ee=>{const{offsetWidth:We,offsetHeight:ze}=Re.rendererService.getCanvas(),Ze=Re.currentAppStat.memoryUsage,et=[];for(let Ge=0;Ge<ze;Ge+=5)for(let Ye=0;Ye<We;Ye+=5){const Xe=performance.now();Re.rendererService.pick(Ye,Ge,!0);const Ce=performance.now()-Xe;et.push(Ce)}const rt=(0,k.mean)(et);et.length=0,setTimeout(()=>{Ee({startMemoryUsage:Ze,endMemoryUsage:Re.currentAppStat.memoryUsage,meanRayPickTime:rt})},1e3)})})()}toggleCaptureClick(){if(!this.capturing&&confirm("Do you want to reload the page to ensure accurate profiling? Otherwise the profiler will start immediately.")){const{hoverPickEnabled:Ee,labelsMode:We}=this.form.value,ze=new URLSearchParams(window.location.search);ze.set("ui-stats-capture","true"),ze.set("ui-stats-hover",`${Ee}`),ze.set("ui-stats-label",`${We}`);const Ze=`${location.pathname}?${ze.toString()}`;window.location.href=Ze}else this.toggleCapture(!this.capturing)}toggleCapture(Re){this.capturing=Re,this.capturing?(this.capturedStats.length=0,this.capturing=!0):(this.capturing=!1,this.viewReport()),this.changeRef.markForCheck()}getStatCSS(Re,Ee){return["engine-stats-row",`engine-stats-row--${ie(Re,Ee)}`]}runSpectorJSClick(){this.runSpectorJS()}runSpectorJS(){var Re=this;return(0,t.A)(function*(){n.e(492).then(n.t.bind(n,47492,23)).then(({EmbeddedFrontend:Ee,Spector:We})=>{Re.spector||(Re.spector=new We,Re.spector.onCapture.add(Ze=>{console.log("specture captured",Ze,Re.spector),console.log({EmbeddedFrontend:Ee});const et=new Ee.ResultView;et.display(),et.addCapture(Ze)}),Re.spector.onError.add(Ze=>{console.warn("specture error",Ze,Re.spector)})),Re.spector.captureNextFrame(Re.engineService.engine.renderer.canvas,!1)})})()}viewReportClick(){var Re=this;return(0,t.A)(function*(){Re.viewReport()})()}viewReport(){var Re=this;return(0,t.A)(function*(){const Ee=Re.capturedStats,We=Re.store.selectSnapshot(O.N.getStoryChapters),{StatsDialogComponent:ze}=yield n.e(608).then(n.bind(n,36608));Re.dialog.open(ze,{width:"90vw",panelClass:"bd-publish-dialog-panel",data:{chapters:We,appStats:Ee,chapterLoadStats:Re.chapterLoadStats}}).afterClosed().pipe((0,E.Q)(Re.ngUnsubscribe)).subscribe()})()}initState(){const Re=performance?.memory?.usedJSHeapSize??0;this.initialSceneMemory=f(Re),this.form=new L.gE({hoverPickEnabled:new L.MJ(!0),labelsMode:new L.MJ("dom")}),this.store.select(a.y.getLabels).pipe((0,y.p)(Ee=>Ee?.length>0),(0,d.s)(1),(0,E.Q)(this.ngUnsubscribe)).subscribe(Ee=>{this.initialLabels=Ee;const{labelsMode:We}=this.form.value;this.toggleLabelsMode(We)})}initFormListeners(){this.form.valueChanges.pipe((0,_.T)(Re=>Re.hoverPickEnabled),(0,v.F)(),(0,E.Q)(this.ngUnsubscribe)).subscribe(Re=>{this.toggleHoverPick(Re)}),this.form.valueChanges.pipe((0,_.T)(Re=>Re.labelsMode),(0,v.F)(),(0,E.Q)(this.ngUnsubscribe)).subscribe(Re=>{this.toggleLabelsMode(Re)})}initStatsListeners(){this.engineService.getEvent(V.X.AssetsLoadProgress).pipe((0,E.Q)(this.ngUnsubscribe)).subscribe(Re=>{const{chapterId:Ee,chapterProgress:We}=Re,ze=this.chapterLoadStats[Ee]??{chapterId:Ee,startTime:performance.now()};1===We&&(ze.endTime=performance.now(),ze.duration=(ze.endTime-ze.startTime)/1e3),this.chapterLoadStats[Ee]=ze}),this.engineService.engineCreated$.pipe((0,b.Z)(Re=>{const Ee=this.engineService.server;return function S(Le,Re){const{renderer:Ee}=Le;return new g.c(We=>{let ze=performance.now(),Ze=ze,et=0,rt=0,Ge=0,Ye=0,Xe=0,ye=0,Ce=0,xe=0,Je=0,ot=0,ct=0;const dt=function(){var Ae=(0,t.A)(function*(){rt++;const Fe=performance.now();et=Fe-ze,Fe>=Ze+1e3&&(Ye=1e3*rt/(Fe-Ze),Ze=Fe,rt=0),ze=Fe;const he=performance?.memory?.usedJSHeapSize??0;Ge=f(he),xe=f(Re?.dataSize?.material??0),Je=f(Re?.dataSize?.morph??0),ot=f(Re?.dataSize?.geometry??0),ct=f(Re?.dataSize?.transform??0),We.next({...Ee.stats,totalObjects:Xe,totalLeafObjects:ye,totalVisibleLeafObjects:Ce,frameRate:Ye,frameTime:et,memoryUsage:Ge,downloadMaterial:xe,downloadMorph:Je,downloadGeometry:ot,downloadTransform:ct})});return function(){return Ae.apply(this,arguments)}}(),ke=()=>{Le&&(Le.off("destroy",ke),Ee.off("end",dt)),We.next({...Ee.stats,totalObjects:Xe,totalLeafObjects:ye,totalVisibleLeafObjects:Ce,frameRate:Ye,frameTime:et,memoryUsage:Ge,downloadMaterial:xe,downloadMorph:Je,downloadGeometry:ot,downloadTransform:ct}),We.complete()};Ee.on("end",dt),Le.on("changestory",()=>{const{anatomyObjects:Ae}=Le.story.anatomySceneGraph;Xe=Ae.size;const Fe=()=>{ye=0,Ce=0,Ae.forEach(_e=>{!_e.children?.length&&(ye++,_e.shown&&Ce++)})},he=_e=>{"shown"===_e?.property&&Fe()};Fe(),Ae.forEach(_e=>{_e.on("change",he)})}),Le.on("destroy",ke),We.add(ke)})}(Re,Ee instanceof N.BioDigitalWebSocketServer?Ee:void 0)}),(0,P.Z)(100),(0,E.Q)(this.ngUnsubscribe)).subscribe(Re=>{this.statsCached=!1;const Ee=this.engineStats,We=Object.entries(Re).reduce((ze,[Ze,et])=>{const rt=Ze;if(!Ue.includes(rt)){const Ge=Ee?.[rt];!et&&Ge&&(ze[rt]=Ge,this.statsCached=!0)}return ze},{...Ee,...Re});this.engineStats$.next(We),this.changeRef.markForCheck()})}initMemoryListeners(){(0,s.z)([this.engineStats$,this.chapterId$,this.chapterReady$]).pipe((0,y.p)(([Re,,Ee])=>!(0,k.isNil)(Re)&&Ee),(0,E.Q)(this.ngUnsubscribe)).subscribe(([Re,Ee])=>{const We=this.initialSceneMemory,ze=Re.memoryUsage,Ze=ze-We;this.initialMemoryByChapter[Ee]=this.initialMemoryByChapter[Ee]??ze;const Ge=Math.max(this.peakMemoryByChapter[Ee]??0,ze);this.peakMemoryByChapter[Ee]=Ge;const Ye=Object.values(this.peakMemoryByChapter).reduce((ot,ct)=>Math.max(ot,ct),0),Xe={chapterInitialMemory:this.initialMemoryByChapter[Ee],chapterPeakMemory:this.peakMemoryByChapter[Ee],chapterDeltaMemory:Ze,sceneInitialMemory:We,scenePeakMemory:Ye},ye=this.chapterLoadStats[Ee]??{},Ce=performance.now(),{labelsMode:xe,hoverPickEnabled:Je}=this.form.value;this.currentAppStat={...Re,...ye,...Xe,timestamp:Ce,chapterId:Ee,labelsMode:xe,hoverPickEnabled:Je},this.capturing&&this.capturedStats.push(this.currentAppStat),this.changeRef.markForCheck()})}toggleLabelsMode(Re){switch(this.store.dispatch(new c.gJ([])),this.markerService.deleteMarkers(),Re){case"dom":this.store.dispatch(new c.gJ(this.initialLabels));break;case"marker":this.initialLabels.forEach(Ee=>this.markerService.createMarker(Ee))}}toggleHoverPick(Re){this.store.dispatch(new q.Pk({hoverEnabled:Re}))}}(U=je).\u0275fac=function(Re){return new(Re||U)(e.rXU(i.il),e.rXU(r.y),e.rXU(p.z),e.rXU(l.m),e.rXU(M.n$),e.rXU(re.bZ),e.rXU(e.gRc))},U.\u0275cmp=e.VBU({type:U,selectors:[["app-engine-stats"]],inputs:{theme:[e.Mj6.SignalBased,"theme"],showAdvancedTools:[e.Mj6.SignalBased,"showAdvancedTools"]},standalone:!0,features:[e.aNF],decls:1,vars:1,consts:[[1,"engine-stats",3,"ngClass"],["target","_blank","rel","noreferrer nofollow",1,"self-end","text-xs","font-semibold","text-link"],[1,"engine-stats__sections"],[1,"engine-stats__section"],[1,"engine-stats__table"],[1,"engine-stats__section-header"],["scope","row","matTooltipPosition","left",3,"matTooltip"],[1,"text-underline"],["icon","arrow-up-right-from-square",1,"ml-1"],[1,"flex","flex-col","text-xs",3,"formGroup"],[1,"flex","flex-row","justify-between"],["label","Labels",1,"my-1",3,"isCompact"],["formControlName","labelsMode",1,"input"],["value","dom",1,"my-1"],["value","marker",1,"my-1"],["value","none",1,"my-1"],["label","Input",1,"my-1","ml-1",3,"isCompact"],["formControlName","hoverPickEnabled"],[1,"my-1","engine-stats__buttons"],["type","button","app-button","","buttonType","outline","buttonSize","sm",3,"click","buttonTheme","disabled"],["type","button","app-button","","buttonType","outline","buttonSize","sm",3,"buttonTheme"],["type","button","app-button","","buttonType","outline","buttonSize","sm",3,"click","buttonTheme"]],template:function(Re,Ee){1&Re&&e.DNE(0,Se,68,82,"div",0),2&Re&&e.vxM(0,Ee.engineStats?0:-1)},dependencies:[be.MD,be.YU,be.Jj,be.QX,L.X1,L.qT,L.xH,L.y7,L.wz,L.BC,L.cb,L.j4,L.JD,de.D,K.K,te.So,D.oV,w.C,ae.Q,R.o,ce.R],styles:[":root{--engine-stats-color: #374a68;--engine-stats-background-color: #ffffff;--engine-stats-border-color: #eaeff5}.engine-stats{display:flex;flex-direction:column;padding:8px;text-align:left;border-radius:4px;color:var(--engine-stats-color);background-color:var(--engine-stats-background-color);border:1px solid var(--engine-stats-border-color)}.engine-stats__sections{display:flex;flex-direction:column;gap:16px}.engine-stats__section{display:flex;flex-direction:column;font-size:.75rem;line-height:1rem}.engine-stats__section-header{padding-top:.25rem;padding-bottom:.25rem;text-align:left;font-size:.875rem;line-height:1.25rem;font-weight:600}.engine-stats__buttons{display:flex;flex-direction:column;gap:8px}.engine-stats table th{width:60%;border-right:1px solid var(--engine-stats-border-color);font-weight:500;text-align:right}.engine-stats table td{font-weight:600}.engine-stats table th,.engine-stats table td{padding:2px 4px}.engine-stats table tr{border-top:1px solid var(--engine-stats-border-color);border-bottom:1px solid var(--engine-stats-border-color);border-collapse:collapse}.engine-stats-row--warning{background-color:#ffb92e;color:#374a68}.engine-stats-row--danger{background-color:#de3535;color:#d7e0ea}.engine-stats--dark{--engine-stats-color: #d7e0ea;--engine-stats-background-color: #283853;--engine-stats-border-color: #1c2a3f}.engine-stats--advanced{width:260px}\n"],encapsulation:2,changeDetection:0}),Z([(0,i.l6)(A.S.getChapter),z("design:type",g.c)],je.prototype,"chapterId$",void 0),Z([(0,i.l6)(O.N.getSelectedChapterModelReady),z("design:type",g.c)],je.prototype,"chapterReady$",void 0)},18171:(ge,F,n)=>{"use strict";n.d(F,{j:()=>p});var t=n(21164),e=n(62943),r=n(8358),o=n(49204),C=n(76872),E=n(92677),y=n(65881);const d={enabled:!1,clips:{left:{clipId:0,enabled:!1,fade:!1,fadeDistance:0,progress:0},right:{clipId:1,enabled:!1,fade:!1,fadeDistance:0,progress:0},back:{clipId:5,enabled:!1,fade:!1,fadeDistance:0,progress:0},front:{clipId:4,enabled:!1,fade:!1,fadeDistance:0,progress:0},top:{clipId:3,enabled:!1,fade:!1,fadeDistance:0,progress:0},bottom:{clipId:2,enabled:!1,fade:!1,fadeDistance:0,progress:0}}};var _=n(53799),v=n(29284),b=n(23881),P=n(44867),s=n(13491),g=n(35650),u=n(60286),h=n(62751),S=n(11724),f=n(63508),m=n(92333),i=n(76774),c=n(17766),a=n(13976),l=n(54438);let p=(()=>{var A;class O{constructor(k,q,B,j,V){this.serializeChapterService=k,this.labelService=q,this.paintService=B,this.sceneService=j,this.contentBlocksService=V}processChapterForEngine(k){const q=(0,y.S)([k],!1),V=this.sceneService.getRootObjects(),M=(0,b.ow)(this.paintService.getColorRecipes()),N=(0,P.fm)(V,M);return{...this.serializeChapterService.serializeChapter(N,k,{},[],q),sliderLayers:k.sliderLayers}}copyChapter(k,q){const B=(0,o.cloneDeep)(k);return B.id=q,B.readyState={model:!0,animation:!1},B}getChapter(k,q,B,j,V){const M=j.id||(0,y.G)();let N;(0,o.isNil)(j.background)||(N=(0,e.iu)(j.background));const W=j.transparencyMode||S.TransparencyModeEnum.Alpha,$=this.deserializeCamera(j);let ne=!1;const Q=j.timelineMap;let le;Q.forEach(oe=>{"dummy"!==oe.name&&"dummy"!==oe.data.timeline&&(ne=!0)});const pe=j.animation?.loop??q.animation?.loop??!1;if(j.ui&&!(0,o.isEmpty)(j.ui))le=j.ui;else{let oe=0;ne&&pe?oe=-1:ne&&!pe&&(oe=1),le={play:{count:oe}}}const ie=C.D.Annotation,be=[...j.annotations||[]].map(oe=>this.labelService.deserializeAnnotation(oe,j,ie)),de=[],te=this.groupHotspots([...j.hotspots||[]].filter(oe=>{const me=this.labelService.filterHotspot(q,j,oe);return me?oe.theme||(oe.theme=B===c.c.Module?E.T.studioNext:E.T.classicHotspot):de.push(oe),me})).map(oe=>this.labelService.deserializeHotspots(q,j,V,...oe)),R=j.labels?.length>0?j.labels:[...be,...te],D=de,T=(0,o.isEmpty)(j.clippingPlanes)?d:this.sanitizeClippingPlanes(j.clippingPlanes),re=this.deserializeContentBlocks(j.contentBlocks),K=j.legend??[],ce=(j.quizQuestions??[]).map(oe=>(0,i.z9)(oe,oe.id,j.id)),U=j.media??{};Object.values(U).forEach(oe=>{oe&&(0,o.isEmpty)(oe.lang)&&(oe.lang="en")});const z=j.thumbnails,H=k.map(oe=>oe.objectId),{availableObjects:J,showObjects:Y}=j,X=(0,o.isEmpty)(J)?(0,P.K$)(H,Y,J):J;return{...j,id:M,background:N,camera:$,timelineMap:Q,loop:pe,ui:le,labels:R,hotspots:D,clippingPlanes:T,contentBlocks:re,legend:K,quizQuestions:ce,media:U,readyState:{model:!1,animation:!1},thumbnails:z,transparencyMode:W,sliderLayers:{src:{},currentLayers:{},sourceLayerGroups:[],currentLayerGroups:[]},availableObjects:X}}deserializeContentBlocks(k=[]){return k.map(q=>(this.contentBlocksService.isTickerBlock(q)&&(q.enable=q.enable??!0),q))}deserializeCamera(k){const q=k.jumpTo?h.L.JumpTo:h.L.FlyTo,{eye:B,look:j,up:V,title:M}=k[q],N={action:q,location:{eye:B,look:j,up:V},title:M??m.y};return k.cameraRotationCenter&&(N.rotationCenter=k.cameraRotationCenter),k.camera&&Array.isArray(k.camera.rotationCenter)&&(N.rotationCenter=s.n.fromArray(k.camera.rotationCenter)),N}getChapterTweenStates(k){const q=k.timelineMap.filter(B=>"dummy"!==B.data.timeline).map(B=>B.data.timeline);return Array.from(new Set(q))}getChapterLightLibraries(k){return(0,f.Uv)(k)?(k.lights?.libraries??[]).filter(B=>"default"!==B):[]}getChapterReflectionLibraries(k){if((0,f.Uv)(k)){const B=k.environment&&k.environment.reflectionMap||[],j=M=>M.split(".")[0],V=(k.environment&&k.environment.lightMap||[]).map(j).concat(B.map(j));return Array.from(new Set(V))}return[]}hasVisibilityLayers(k){return Array.isArray(k)&&k.length>0}buildVisibilityLayers(k){const q=k.visibilityLayers,B=k.showObjects,j={src:q,currentLayers:{},sourceLayerGroups:[],currentLayerGroups:[]};if(q&&this.hasVisibilityLayers(q.layers)){const V=q.initIndex||0,M=this.unpackLayers(q.layers),N=this.buildShownObjectsSet(B),W=this.buildCurrentLayers(M,N),$=this.buildLayerGrouping(W);j.src={layers:q.layers,initIndex:V},j.currentLayers={layers:W,index:V,position:0},j.sourceLayerGroups=(0,o.cloneDeep)($),j.currentLayerGroups=(0,o.cloneDeep)($)}return j}buildShownObjectsSet(k){const q=this.sceneService.getSceneGraph(this.sceneService.getRootObjects()),B=Object.keys(q.nodes).filter(j=>(0,v.BK)(q,j,k)||(0,v._x)(q,j,k));return new Set(B)}unpackLayers(k){const q=[];return k.forEach(B=>{let j=[];B.objectIds.forEach(M=>{const N=this.sceneService.getObjectById(M);if(N){const W=this.sceneService.getLeaves(N.objectId);j=j.concat(W.map($=>$.objectId))}}),q.push({name:B.name,objectIds:j})}),q}buildCurrentLayers(k,q){const B=[];return k.forEach((j,V)=>{let M=!1;j.objectIds.forEach(N=>{q.has(N)&&(M?B[B.length-1].objectIds.push(N):(B.push({name:k[V].name,objectIds:[N]}),M=!0))})}),B}buildLayerGrouping(k){return k.reduce((q,B,j)=>{const{name:V}=B;let M=q.find(N=>N.name===V);return M||(M={name:V,position:0,layers:[]},q.push(M)),M.layers.push(B),M.position=M.layers.length,q},[])}sanitizeClippingPlanes(k){const q=Object.values(k.clips).some(j=>j.progress>0),B=(0,o.mapKeys)(k.clips,(j,V)=>_.s[V]||V);return{...k,clips:B,enabled:q}}groupHotspots(k){const q={},B=V=>V.primitiveIndex?V.primitiveIndex.toFixed(0):V.pos?V.pos.map(M=>M.toFixed(3)).join(":"):Math.random().toFixed(3),j=V=>RegExp("^circle-(plus|minus)").test(V)?"pair":"single";return k.forEach(V=>{const M=[j(V.type),V.objectId,B(V)].join("|");M in q?q[M].push(V):q[M]=[V]}),Object.values(q)}}return(A=O).\u0275fac=function(k){return new(k||A)(l.KVO(t.p),l.KVO(r.x),l.KVO(u.s),l.KVO(g.w),l.KVO(a.V))},A.\u0275prov=l.jDH({token:A,factory:A.\u0275fac,providedIn:"root"}),O})()},8358:(ge,F,n)=>{"use strict";n.d(F,{x:()=>c});var t=n(69568),e=n(59429),r=n(24151),o=n(76872),C=n(92677),E=n(16124),y=n(49746),d=n(95370),_=n(40470),v=n(20714),b=n(38157),P=n(1300),s=n(79817),g=n(49204),h=n(12347),S=n(35650),f=n(54438);const m={flyToCamera:"flyTo",flyToChapter:"flyTo"};let c=(()=>{var a;class l{constructor(A,O){this.animationService=A,this.sceneService=O,this.convertActionToErrand=(L,k,q)=>{const B=new RegExp("^flyTo(Async)?"),j=new RegExp("^flyToObject(Async)?"),V=new RegExp("^flyTo[w.:]+currentChapter.[flyTo|jumpTo]"),M=q.split(":").slice(0,2),N=L;let W=M[1];/currentChapter/.test(W)&&(W=W.replace("currentChapter",`chapters[${k}]`));let $=null;return j.test(M[0])?$=new y.F((0,g.get)(N,W)):B.test(M[0])?$=new d.v((0,g.get)(N,W)):V.test(M[0])&&($=new P.T),$},this.convertErrandToAction=(L,k)=>{const q=e.u.idWithPrefix("errand").replace(/-/g,"_"),B={};let j="";const V=function i(a){return m[a]||a}(k.type);return k.type===b.X.flyToChapter||(j=`${V}Async:currentChapter.customData.${q}`,B[q]=k.value),{action:j,data:B}}}filterHotspot(A,O,L){const k=new RegExp("^(flyTo|flyToObject|hideHotspot|showHotspot|resetHotspots)"),q=this.getHotspotAction(A,L),B=q.filter(j=>k.test(j));return q.length===B.length}deserializeAnnotation(A,O,L){const k=new t.e(A.title||"");return k.id=A.annotationId||e.u.idWithPrefix("label"),k.chapterId=O.id,k.expandTag=!0,k.showDescription=!0,k.collapseDescription=!1,k.pinGlow=!1,k.hideWire=!1,k.hideTag=!1,L===o.D.Annotation?(k.theme=o.D.Annotation,k.pinType=r.O.Default,k.flyTo=!1,k.states=[]):(k.theme=o.D.StudioNext,k.pinType=r.O.PlusMinus,k.flyTo=!0,k.states=[new E.B,new E.B],k.states[0].errands=[new P.T],k.states[1].errands=[new y.F(A.objectId)]),k.occludable=!1!==A.occludable,k.renderableIndex=A.renderableIndex||0,A.objectId&&Object.prototype.hasOwnProperty.call(A,"barycentric")?(k.objectId=A.objectId,k.primitiveIndex=A.primitiveIndex,k.barycentric=A.barycentric):Object.prototype.hasOwnProperty.call(A,"pos")&&(Object.prototype.hasOwnProperty.call(A,"objectId")&&(k.objectId=A.objectId),k.pos=A.pos),A.dir&&Array.isArray(A.dir)?k.dir=A.dir:A.dir&&A.dir instanceof Object&&(k.dir=Object.values(A.dir)),k.description=A.description||"",k.offset=A.labelOffset||[40,40],k.shown=!1!==A.shown,k.labelShown=!1!==A.labelShown,k}deserializeHotspots(A,O,L,...k){const[q,B]=k,j=new t.e(q.title||"");switch(j.id=e.u.idWithPrefix("hotspot"),j.objectId=q.objectId,j.chapterId=O.id,j.description=q.description||"",j.pinType=/plus|minus/.test(q.className)?r.O.PlusMinus:/sequential/.test(q.className)?r.O.Sequential:/none/.test(q.className)?r.O.None:r.O.Default,/alphabetical/.test(q.className)?j.sequentialType=s.C.Alphabetical:/numerical/.test(q.className)&&(j.sequentialType=s.C.Numerical),j.pinGlow=/pulse/.test(q.className),j.occludable=!0,j.shown=q.shown,j.offset=q.labelOffset?q.labelOffset:[22,-17],(/left/.test(q.className)&&j.offset[0]>0||/right/.test(q.className)&&j.offset[0]<0)&&(j.offset[0]*=-1),Object.prototype.hasOwnProperty.call(q,"barycentric")?(j.renderableIndex=q.renderableIndex||0,j.barycentric=q.barycentric,j.primitiveIndex=q.primitiveIndex):j.pos=q.pos,j.dir=q.dir,q.theme=q.theme?q.theme:C.T.classicHotspot,q.theme){case C.T.classicAnnotation:j.theme=o.D.Annotation,j.showDescription=!0,j.collapseDescription=/collapsible/g.test(q.className),j.expandTag=q.expandTag??!0,j.hideTag=q.hideTag??!1,j.hideWire=!/leader-line/.test(q.className);break;case C.T.classicHotspot:j.theme=o.D.Classic,j.showDescription=/label/.test(q.className),j.expandTag=/label/.test(q.className),j.hideTag=!j.expandTag,j.collapseDescription=!1,j.hideWire=!/leader-line/.test(q.className);break;case C.T.studioNext:j.theme=o.D.StudioNext,j.showDescription=this.hasContent(q),j.collapseDescription=/collapsible/g.test(q.className),j.hideTag=q.hideTag??!1,j.expandTag=q.expandTag??!0,j.hideWire=!/leader-line/.test(q.className)}j.flyTo=!1,j.flyToTarget=null,j.states=[];const V=this.filterHotspotActions(this.getHotspotAction(A,q)),M=B?this.filterHotspotActions(this.getHotspotAction(A,B)):[],N=new E.B,W=new E.B;V.length&&(N.errands=V.map(ne=>this.convertActionToErrand(A,L,ne))),M.length&&(W.errands=M.map(ne=>this.convertActionToErrand(A,L,ne))),j.states=[W,N],N.errands.length>0&&(j.flyTo=!0,j.flyToTarget=N.errands[0].type,N.errands[0].type===b.X.flyToCamera&&(j.cameraPosition=N.errands[0].value));const $=q.contentBlocks;return $&&(j.contentBlocks=JSON.parse(JSON.stringify($))),j}makeDefaultStudioLabel(A){const O=A?{...A}:new t.e("");return O.pinType=r.O.PlusMinus,O.theme=o.D.StudioNext,O.expandTag=!0,O.showDescription=!0,O.collapseDescription=!1,O.pinGlow=!1,O.hideWire=!1,O.hideTag=!1,O.occludable=!0,O.flyTo=!0,O.description="",O.shown=!0,O.states=[new E.B,new E.B],O}makeAnnotationLabel(A){const O=A?{...A}:new t.e("");return O.pinType=r.O.Default,O.theme=o.D.Annotation,O.expandTag=!0,O.showDescription=!0,O.collapseDescription=!1,O.pinGlow=!1,O.hideWire=!1,O.hideTag=!1,O.states=[],O}serializeLabel(A,O){const L={symbol:void 0,className:void 0,dir:void 0,objectId:void 0,shown:void 0,type:void 0},k=(0,_.uK)(A),q=["circle","draggable"];if(L.shown=!0,A.objectId&&(L.objectId=k.objectId),A.objectId&&A.primitiveIndex&&A.barycentric)L.renderableIndex=A.renderableIndex||0,L.primitiveIndex=A.primitiveIndex,L.barycentric=A.barycentric;else{if(!A.objectId)return{data:{},hotspots:[]};L.pos=k.pos}switch((Array.isArray(A.dir)||ArrayBuffer.isView(A.dir))&&(L.dir=Array.prototype.slice.call(A.dir)),L.labelOffset=A.offset,A.theme){case o.D.Annotation:L.theme=C.T.classicAnnotation;break;case o.D.Classic:L.theme=C.T.classicHotspot;break;default:L.theme=C.T.studioNext}L.hideTag=k.hideTag,L.expandTag=k.expandTag,""!==k.title||""!==k.description?(L.title=k.title,L.description=k.description,L.type=v.H.CircleLabel):L.type=v.H.Circle,A.pinGlow&&q.push("pulse"),A.pinType===r.O.PlusMinus&&q.push("plus"),A.pinType===r.O.Sequential&&(q.push("sequential"),q.push(A.sequentialType===s.C.Alphabetical?"alphabetical":"numerical")),A.pinType===r.O.None&&q.push("none"),A.hideWire||q.push("leader-line"),A.hideTag||q.push("label"),A.collapseDescription&&q.push("collapsible collapsed"),L.className=q.join(" ");let B={};L.actions=[];const j=[L],V=A.states.length;A.states.forEach((N,W)=>{if(W===V-1)j[0].actions.push("resetHotspots"),N.errands.forEach($=>{const ne=this.convertErrandToAction(A,$);j[0].actions.push(ne.action),B={...B,...ne.data}});else{const $=(0,g.cloneDeep)(L);$.actions=[],$.className=$.className.replace("plus","minus"),N.errands.forEach(ne=>{const Q=this.convertErrandToAction(A,ne);$.actions.push(Q.action),B={...B,...Q.data}}),j.push($)}}),2===j.length&&(j[0].actions.push(`hideHotspots:currentChapter.hotspots[${O}]`),j[0].actions.push(`showHotspots:currentChapter.hotspots[${O+1}]`),j[1].actions.push(`hideHotspots:currentChapter.hotspots[${O+1}]`),j[1].actions.push(`showHotspots:currentChapter.hotspots[${O}]`),j[0].shown=!0,j[1].shown=!1),2===j.length&&A.collapseDescription&&(j[1].className+=j[1].className.replace("collapsed","")),j.forEach(N=>{L.labelOffset[0]<0?N.className=N.className.replace("right","")+" left":L.labelOffset[0]>0&&(N.className=N.className.replace("left","")+" right")});const M=A.contentBlocks;return M&&(L.contentBlocks=JSON.parse(JSON.stringify(M))),{data:B,hotspots:j}}setLabelContainer(A){this._labelContainer=A}getLabelContainer(){return this._labelContainer}hasContent(A){const{description:O,contentBlocks:L}=A;return!!O||!(0,g.isNil)(L)&&L.length>0}getHotspotAction(A,O){const L=O.actionSrc?(0,g.get)(A,O.actionSrc):O.actions?O.actions:[];return Array.isArray(L)?L:[]}filterHotspotActions(A){const O=new RegExp("^(flyTo|flyToObject)");return A.filter(L=>O.test(L))}}return(a=l).\u0275fac=function(A){return new(A||a)(f.KVO(h.O),f.KVO(S.w))},a.\u0275prov=f.jDH({token:a,factory:a.\u0275fac,providedIn:"root"}),l})()},17042:(ge,F,n)=>{"use strict";n.d(F,{n:()=>a});var m,t=n(85052),e=n(82656),r=n(2573),o=n(14264),C=n(37925),E=n(94909),y=n(65763),d=n(49204),v=n(94495),b=n(33013),P=n(61295),s=n(13409),g=n(63365),u=n(35650),h=n(60286),S=n(55494),f=n(54438),i=function(l,p,A,O){var q,L=arguments.length,k=L<3?p:null===O?O=Object.getOwnPropertyDescriptor(p,A):O;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)k=Reflect.decorate(l,p,A,O);else for(var B=l.length-1;B>=0;B--)(q=l[B])&&(k=(L<3?q(k):L>3?q(p,A,k):q(p,A))||k);return L>3&&k&&Object.defineProperty(p,A,k),k},c=function(l,p){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(l,p)};class a{constructor(p,A,O){this.store=p,this.sceneService=A,this.paintService=O,this.nodeChapterOpacities={}}initObservables(){this.nodesLayerIndex=0,this.objectsLayerIndex=0,this.nodeChapterOpacities={},this.destroyObservables(),this.ngUnsubscribe=new t.B,(0,e.z)([this.selectedChapterId$,this.selectedEngineChapterId$]).pipe((0,o.p)(([p,A])=>p&&(0,d.isEqual)(p,A)),(0,C.Q)(this.ngUnsubscribe)).subscribe(([p])=>{this.updateNodeChapterOpacities(p)}),this.selectedChapterCurrentLayers$.pipe((0,E.E)(this.selectedChapterCurrentLayersIndex$),(0,C.Q)(this.ngUnsubscribe)).subscribe(([,p])=>{this.nodesLayerIndex=this.objectsLayerIndex=p}),(0,e.z)([this.selectedChapterCurrentLayersIndex$,this.selectedChapterCurrentLayersPosition$,this.selectedChapterCurrentLayers$]).pipe((0,o.p)(([p,A])=>!(0,d.isNil)(p)&&!(0,d.isNil)(A)),(0,C.Q)(this.ngUnsubscribe)).subscribe(([p,A,O])=>{this.syncLayersToScene(O,p,A,!0)})}destroyObservables(){this.ngUnsubscribe&&(this.ngUnsubscribe.next(),this.ngUnsubscribe.complete(),this.ngUnsubscribe=null)}syncLayersToState(p,A,O){this.store.dispatch(new b.WZ(p,A,O,!0))}syncLayersToScene(p,A,O,L){this.updateLayerIndex(A,p,L),this.updateLayerPosition(O,p,L)}fractionToIndex(p,A){const O=this.getThreshold(p),L=Math.floor(A/O);return Math.max(0,Math.min(p.length-2,L))}fractionToPosition(p,A,O){const L=this.getThreshold(p);return Math.max(0,Math.min((A-L*O)/L,1))}indexPositionToFraction(p,A,O){const L=this.getThreshold(p);return A*L+O*L}fractionToPercent(p){return Math.round(100*(1-p))}percentToFraction(p){return 1-p/100}getThreshold(p){return p.length>1?1/(p.length-1):1}getCurrentLayerIndexProp(p){return p?"nodesLayerIndex":"objectsLayerIndex"}updateLayerIndex(p,A,O){const L=this.getCurrentLayerIndexProp(O);p!==this[L]&&(this.restoreLayers(p,this[L],A,O),O&&(this.nodesLayerIndex=p),this.objectsLayerIndex=p)}updateLayerPosition(p,A,O){const L=this.getCurrentLayerIndexProp(O),k=A[this[L]]?.objectIds;k?.length>0&&this.setObjectsOpacity(k,1-p)}restoreLayers(p,A,O,L){const q=(p-A)/Math.abs(p-A);let B=[],j=A;for(;j!==p;)B=B.concat(O[j].objectIds),j+=q;const M=-1===q;this.setObjectsOpacity(B,1===q?0:1),L?this.setNodesShown(B,M):this.setObjectsShown(B,M),-1===q&&(L?this.setNodesShown(O[p].objectIds,!0):this.setObjectsShown(O[p].objectIds,!0))}setObjectsOpacity(p,A){p.forEach(O=>{const L=this.nodeChapterOpacities[O];let k;Array.isArray(L)?(k=L.slice(),k[0]=A*L[0],k[1]=A*L[1]):k=A*L,this.paintService.colorObject(O,{opacity:k})})}updateNodeChapterOpacities(p){const O=this.store.selectSnapshot(s.z.getAllNodeState)[p];this.nodeChapterOpacities={},Object.entries(O).forEach(([L,k])=>{if(this.nodeChapterOpacities[L]=1,k.paint&&Object.prototype.hasOwnProperty.call(k.paint,"opacity")){const q=(0,g.Sf)(k.paint);!1!==q.opacity&&(this.nodeChapterOpacities[L]=q.opacity)}})}setObjectsShown(p,A){const O={};for(let L=0;L<p.length;L++)O[p[L]]=A;this.sceneService.setShownObjects({showObjects:O})}setNodesShown(p,A){this.store.dispatch(new P.yr(A,p,void 0,!1))}}(m=a).\u0275fac=function(p){return new(p||m)(f.KVO(y.il),f.KVO(u.w),f.KVO(h.s))},m.\u0275prov=f.jDH({token:m,factory:m.\u0275fac,providedIn:"root"}),i([(0,y.l6)(v.N.getSelectedChapterCurrentLayers),c("design:type",r.c)],a.prototype,"selectedChapterCurrentLayers$",void 0),i([(0,y.l6)(v.N.getSelectedChapterCurrentLayersIndex),c("design:type",r.c)],a.prototype,"selectedChapterCurrentLayersIndex$",void 0),i([(0,y.l6)(v.N.getSelectedChapterCurrentLayersPosition),c("design:type",r.c)],a.prototype,"selectedChapterCurrentLayersPosition$",void 0),i([(0,y.l6)(v.N.getSelectedChapterId),c("design:type",r.c)],a.prototype,"selectedChapterId$",void 0),i([(0,y.l6)(S.S.getChapter),c("design:type",r.c)],a.prototype,"selectedEngineChapterId$",void 0)},3367:(ge,F,n)=>{"use strict";n.d(F,{m:()=>v});var t=n(38472),e=n(49204),o=n(11724),E=n(79805),y=n(515),d=n(35650),_=n(54438);let v=(()=>{var b;class P{constructor(g,u){this.engineService=g,this.sceneService=u,this.markers=new Map,this.initMarkerEvents()}getMarkerWorldPosition(g){if((0,e.isNil)(g))return;const u=t.clone(g.marker3D.position);return t.scale(u,u,1/o.BIODIGITAL_SCENE_SCALE),u}getMarkerById(g){return this.markers.get(g)}createMarker(g){const{id:u,objectId:h,primitiveIndex:S,renderableIndex:f,barycentric:m,pos:i}=g,{engine:c}=this.engineService,{activeChapter:a,chapters:l}=c.story,p=l.find(B=>B.id===g.chapterId)??a,A=S>=0?"primitive":"object";if(!h)return console.warn("An object id is required for creating a marker.",{id:u}),null;const O=this.sceneService.getObjectById(h);if((0,e.isNil)(O))return console.warn("A valid object id is required for creating a marker.",{id:u,objectId:h}),null;let L=i?t.clone(i):void 0;"object"===A&&(0,e.isNil)(L)&&(L=this.sceneService.getObjectBoundaryCenter(h)),(0,e.isNil)(L)||t.scale(L,L,o.BIODIGITAL_SCENE_SCALE);const q=new o.BioDigitalScreenMarker(c,p,{object:O,trackingMode:A,renderableIndex:f||0,primitiveIndex:S,barycenter:m||[1/3,1/3,1/3],worldPosition:L,variantIndex:O.variant},u);return this.markers.set(u,q),q.update(),q}deleteMarker(g){this.markers.get(g)?.destroy(),this.markers.delete(g)}deleteMarkers(){this.markers.forEach(g=>g.destroy()),this.markers.clear()}initMarkerEvents(){this.engineService.engineCreated$.subscribe(g=>{g.renderer.on("update",()=>{this.updateMarkers()})})}updateMarkers(){0!==this.markers.size&&(this.markers.forEach(g=>g.update()),this.engineService.fireEvent(y.X.SceneMarkersUpdated,this.markers))}}return(b=P).\u0275fac=function(g){return new(g||b)(_.KVO(E.y),_.KVO(d.w))},b.\u0275prov=_.jDH({token:b,factory:b.\u0275fac,providedIn:"root"}),P})()},45144:(ge,F,n)=>{"use strict";n.d(F,{Y:()=>t});var t=function(e){return e.File="file",e.TTS="tts",e.None="none",e}(t||{})},62751:(ge,F,n)=>{"use strict";n.d(F,{L:()=>t});var t=function(e){return e.JumpTo="jumpTo",e.FlyTo="flyTo",e}(t||{})},92333:(ge,F,n)=>{"use strict";n.d(F,{y:()=>e}),n(62751);const e=$localize`Starting Position`},53799:(ge,F,n)=>{"use strict";n.d(F,{A:()=>t,s:()=>e});const t={left:0,right:1,bottom:2,top:3,front:4,back:5},e={0:"left",1:"right",2:"bottom",3:"top",4:"front",5:"back"}},17766:(ge,F,n)=>{"use strict";n.d(F,{c:()=>t});var t=function(e){return e.Bookmark="bookmark",e.Module="module",e.Internal="internal",e}(t||{})},38157:(ge,F,n)=>{"use strict";n.d(F,{X:()=>t});var t=function(e){return e.flyToChapter="flyToChapter",e.flyToObject="flyToObject",e.flyToCamera="flyToCamera",e}(t||{})},95370:(ge,F,n)=>{"use strict";n.d(F,{v:()=>e});var t=n(38157);class e{constructor(o){this.type=t.X.flyToCamera,this.value=o}}},1300:(ge,F,n)=>{"use strict";n.d(F,{T:()=>e});var t=n(38157);class e{constructor(){this.type=t.X.flyToChapter,this.value=null}}},49746:(ge,F,n)=>{"use strict";n.d(F,{F:()=>e});var t=n(38157);class e{constructor(o){this.type=t.X.flyToObject,this.value=o}}},92677:(ge,F,n)=>{"use strict";n.d(F,{T:()=>t});var t=function(e){return e.classicAnnotation="classic-annotation",e.classicHotspot="classic-hotspot",e.studioNext="studio-light",e}(t||{})},20714:(ge,F,n)=>{"use strict";n.d(F,{H:()=>t});var t=function(e){return e.Circle="circle",e.CirclePlus="circle-plus",e.CircleMinus="circle-minus",e.Label="label",e.CircleLabel="circle-label",e}(t||{})},15375:(ge,F,n)=>{"use strict";n.d(F,{Q:()=>t});var t=function(e){return e.Toggle="toggle",e.None="none",e}(t||{})},24151:(ge,F,n)=>{"use strict";n.d(F,{O:()=>t});var t=function(e){return e.Default="default",e.Plus="plus",e.Minus="minus",e.PlusMinus="plusMinus",e.Sequential="sequential",e.None="None",e}(t||{})},79817:(ge,F,n)=>{"use strict";n.d(F,{C:()=>t});var t=function(e){return e.Alphabetical="alphabetical",e.Numerical="numerical",e}(t||{})},16124:(ge,F,n)=>{"use strict";n.d(F,{B:()=>t});class t{constructor(){this.title=null,this.description=null,this.errands=[]}}},76872:(ge,F,n)=>{"use strict";n.d(F,{D:()=>t});var t=function(e){return e.Annotation="annotation",e.Classic="classic",e.StudioNext="studioNext",e.Context="context",e}(t||{})},69568:(ge,F,n)=>{"use strict";n.d(F,{e:()=>o});var t=n(24151),e=n(76872),r=n(79817);class o{constructor(y){this.pinType=t.O.PlusMinus,this.sequentialType=r.C.Alphabetical,this.theme=e.D.StudioNext,this.expandTag=!0,this.showDescription=!0,this.collapseDescription=!1,this.pinGlow=!1,this.hideWire=!1,this.hideTag=!1,this.title=y}}},11876:(ge,F,n)=>{"use strict";n.d(F,{Z:()=>t});var t=function(e){return e.Single="single",e.Group="group",e}(t||{})},28722:(ge,F,n)=>{"use strict";n.d(F,{Y:()=>t});var t=function(e){return e.None="none",e.Small="small",e.Full="full",e}(t||{})},57238:(ge,F,n)=>{"use strict";n.d(F,{R:()=>e});var t=n(93455);class e extends t.V{}},33013:(ge,F,n)=>{"use strict";n.d(F,{$V:()=>W,Aq:()=>C,Bc:()=>pe,EN:()=>O,Eh:()=>$,Ej:()=>p,Eo:()=>o,F0:()=>r,FN:()=>j,Lx:()=>s,M5:()=>h,Nw:()=>a,O:()=>P,Oj:()=>u,PA:()=>q,R:()=>i,VU:()=>_,WZ:()=>N,Wd:()=>L,X_:()=>c,YA:()=>B,bg:()=>be,eV:()=>S,is:()=>le,jo:()=>ne,jy:()=>g,lM:()=>d,lc:()=>Q,pN:()=>v,pb:()=>k,qi:()=>A,rT:()=>f,sC:()=>b,sN:()=>m,tg:()=>e,tn:()=>V,wg:()=>y,yr:()=>t,yz:()=>E,zh:()=>ie});let t=(()=>{class w{constructor(R){this.patches=R}}return w.type="[Story Chapter] Apply Patch",w})(),e=(()=>{class w{constructor(){}}return w.type="[Story Chapter] Next Chapter",w})(),r=(()=>{class w{constructor(){}}return w.type="[Story Chapter] Previous Chapter",w})(),o=(()=>{class w{constructor(){}}return w.type="[Story Chapter] First Chapter",w})(),C=(()=>{class w{constructor(){}}return w.type="[Story Chapter] Last Chapter",w})(),E=(()=>{class w{constructor(R){this.chapter=R}}return w.type="[Story Chapter] Select Chapter",w})(),y=(()=>{class w{constructor(R){this.chapterId=R}}return w.type="[Story Chapter] Select Chapter by chapter id",w})(),d=(()=>{class w{constructor(R){this.chapters=R}}return w.type="[Story Chapter] Set Chapters",w})(),_=(()=>{class w{constructor(R,D){this.chapterId=R,this.cameraAction=D}}return w.type="[Story Chapter] Set Chapter Camera Action",w})(),v=(()=>{class w{constructor(R,D){this.chapterId=R,this.title=D}}return w.type="[Story Chapter] Set Chapter Camera Title",w})(),b=(()=>{class w{constructor(R,D){this.chapterId=R,this.ui=D}}return w.type="[Story Chapter] Set Chapter UI",w})(),P=(()=>{class w{constructor(R,D,T){this.chapterId=R,this.description=D,this.displayName=T}}return w.type="[Story Chapter] Set Chapter Info",w})(),s=(()=>{class w{constructor(R,D){this.chapterId=R,this.legend=D}}return w.type="[Story Chapter] Set Chapter Legend",w})(),g=(()=>{class w{constructor(R,D){this.chapterId=R,this.legend=D}}return w.type="[Story Chapter] Add To Chapter Legend",w})(),u=(()=>{class w{constructor(R,D){this.previousIndex=R,this.currentIndex=D}}return w.type="[Story Chapter] Reorder Chapters",w})(),h=(()=>{class w{constructor(R,D){this.chapterId=R,this.readyState=D}}return w.type="[Story Chapter] Set Readystate",w})(),S=(()=>{class w{constructor(R){this.chapterId=R}}return w.type="[Story Chapter] Build Chapter Visibility Layers",w})(),f=(()=>{class w{constructor(R,D,T){this.chapterId=R,this.effects=D,this.properties=T}}return w.type="[Story Chapter] Set Chapter PostProcessing",w})(),m=(()=>{class w{constructor(R,D,T){this.chapterId=R,this.transition=D,this.key=T}}return w.type="[Story Chapter] Set Chapter Transitions",w})(),i=(()=>{class w{constructor(R,D){this.chapterIds=R,this.properties=D}}return w.type="[Story Chapter] Set Chapter Properties",w})(),c=(()=>{class w{constructor(R,D){this.chapterIds=R,this.properties=D}}return w.type="[Story Chapter] Remove Chapter Properties",w})(),a=(()=>{class w{constructor(R,D){this.chapterId=R,this.transparencyMode=D}}return w.type="[Story Chapter] Set Chapter Transparency Mode",w})(),p=(()=>{class w{constructor(R,D,T,re){this.chapterId=R,this.clips=D,this.enabled=T,this.record=re}}return w.type="[Story Chapter] Set Chapter Clipping Planes",w})(),A=(()=>{class w{constructor(R,D){this.chapterId=R,this.background=D}}return w.type="[Story Chapter] Set Chapter Background",w})(),O=(()=>{class w{constructor(R){this.background=R}}return w.type="[Story Chapter] Set All Chapters Background",w})(),L=(()=>{class w{constructor(){}}return w.type="[Story Chapter] Reset Selected Chapter Background",w})(),k=(()=>{class w{constructor(R){this.background=R}}return w.type="[Story Chapter] Set Selected Chapter Background",w})(),q=(()=>{class w{constructor(R,D,T){this.story=R,this.chapter=D,this.chapterId=T}}return w.type="[Story Chapter] Duplicate An Existing Chapter",w})(),B=(()=>{class w{constructor(R){this.chapter=R}}return w.type="[Story Chapter] Remove Chapter",w})(),j=(()=>{class w{constructor(){}}return w.type="[Story Chapter] Reset",w})(),V=(()=>{class w{constructor(R,D,T){this.chapterId=R,this.camera=D,this.rotationCenter=T}}return w.type="[Story Chapters] Record Camera",w})(),N=(()=>{class w{constructor(R,D,T,re){this.chapterId=R,this.index=D,this.position=T,this.record=re}}return w.type="[Story Chapters] Set the current visibility layers index and position",w})(),W=(()=>{class w{constructor(R,D,T){this.chapterId=R,this.targetGroups=D,this.record=T}}return w.type="[Story Chapters] Set the current group layers position",w})(),$=(()=>{class w{constructor(R,D){this.chapterId=R,this.media=D}}return w.type="[Story Chapters] Set the media object",w})(),ne=(()=>{class w{constructor(R,D,T){this.chapterId=R,this.contentBlocks=D,this.record=T}}return w.type="[Story Chapters] Set the content blocks",w})(),Q=(()=>{class w{constructor(R){this.timelineMaps=R}}return w.type="[Story Chapters] Add to timelineMap array",w})(),le=(()=>{class w{constructor(R){this.updates=R}}return w.type="[Story Chapters] Update timelineMap array",w})(),pe=(()=>{class w{constructor(R){this.timelineMapIds=R}}return w.type="[Story Chapters] Remove from timelineMap array",w})(),ie=(()=>{class w{constructor(R,D){this.chapterId=R,this.lightLibId=D}}return w.type="[Story Chapters] Set the lights",w})(),be=(()=>{class w{constructor(R){this.timelineMaps=R}}return w.type="[Story Chapters] set chapter timeline with data from the engine",w})()},59676:(ge,F,n)=>{"use strict";n.d(F,{G:()=>t});class t{}},94495:(ge,F,n)=>{"use strict";n.d(F,{N:()=>$});var j,N,t=n(28407),e=n(65763),r=n(59676),o=n(33013),C=n(18171),E=n(93915),y=n(47610),d=n(49204),v=n(10352),b=n(97415),P=n(12347),s=n(75069),g=n(81391),u=n(61295),h=n(76016),S=n(9592),f=n(65776),m=n(82323),i=n(65650),c=n(11724),l=n(57238),p=n(81025),A=n(35650),O=n(13955),L=n(16606),k=n(68947),q=n(63508),B=n(54438),V=function(ne,Q,le,pe){var de,ie=arguments.length,be=ie<3?Q:null===pe?pe=Object.getOwnPropertyDescriptor(Q,le):pe;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)be=Reflect.decorate(ne,Q,le,pe);else for(var w=ne.length-1;w>=0;w--)(de=ne[w])&&(be=(ie<3?de(be):ie>3?de(Q,le,be):de(Q,le))||be);return ie>3&&be&&Object.defineProperty(Q,le,be),be},M=function(ne,Q){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(ne,Q)};const W={loading:!1,chapters:[],chaptersViewed:[],selectedChapter:null,isChapterAnimated:!1,thumbnails:new Map,patches:[],inversePatches:[]};let $=(j=class{static getStoryChapters(Q){return Q.chapters}static getChaptersViewed(Q){return Q.chaptersViewed}static getChapter(Q){return(0,e.Mz)([N],le=>le.chapters.find(pe=>pe.id===Q))}static getSelectedChapterId(Q){return Q.selectedChapter}static getSelectedChapter(Q){return Q.chapters.find(le=>le.id===Q.selectedChapter)||null}static getSelectedChapterTitle(Q){const le=Q.chapters.find(pe=>pe.id===Q.selectedChapter)||null;return k.l.normalize(le?.displayName)}static getNextChapter(Q){const le=(0,c.clamp)(N.getSelectedChapterIndex(Q)+1,0,Q.chapters.length-1);return Q.chapters[le]}static getPreviousChapter(Q){const le=(0,c.clamp)(N.getSelectedChapterIndex(Q)-1,0,Q.chapters.length-1);return Q.chapters[le]}static getSelectedChapterIndex(Q){return Q.chapters.findIndex(le=>le.id===Q.selectedChapter)}static getChapterCount(Q){return Q.chapters.length}static getChapterPagination(Q){const le=Q.chapters.findIndex(pe=>pe.id===Q.selectedChapter);return{count:Q.chapters.length,index:le,label:`${le+1} ${$localize`of`} ${Q.chapters.length}`}}static getChapterCompletionPercent(Q){return(Q.chapters.findIndex(pe=>pe.id===Q.selectedChapter)+1)/Q.chapters.length*100}static getRegisteredThumbnails(Q){return Q.thumbnails}static getIsChapterAnimated(Q){return Q.isChapterAnimated}static getSelectedChapterReadyState(Q){const{chapters:le,selectedChapter:pe}=Q;return N.findChapter(le,pe)?.readyState??{model:!1,animation:!1,audio:!1}}static getChaptersLoaded(Q){return{count:Q.chapters.length,modelChapters:Q.chapters.filter(le=>le.readyState.model),animationChapters:Q.chapters.filter(le=>le.readyState.animation)}}static getAllChaptersModelsReady(Q){return Q.chapters.length>0&&Q.chapters.every(le=>le.readyState.model)}static getSelectedChapterModelReady(Q){const le=N.getSelectedChapterReadyState(Q);return!(0,d.isNil)(le)&&le.model}static getAllChaptersAnimationsReady(Q){return Q.chapters.length>0&&Q.chapters.every(le=>le.readyState.animation)}static getSelectedChapterAnimationReady(Q){const le=N.getSelectedChapterReadyState(Q);return!(0,d.isNil)(le)&&le.animation}static getSelectedChapterBackground(Q){const{chapters:le,selectedChapter:pe}=Q;return N.findChapter(le,pe)?.background??v.RK}static getAllChaptersBackground(Q){return Q.chapters.map(le=>le?.background)}static getSelectedChapterAllAudio(Q){const le=Q.chapters.find(pe=>pe.id===Q.selectedChapter);return le&&le.media?Object.values(le.media).filter(ie=>"audio"===ie.streamType):[]}static getSelectedChapterLegend(Q){const{chapters:le,selectedChapter:pe}=Q;return N.findChapter(le,pe)?.legend??[]}static getSelectedChapterClippingPlanes(Q){const{chapters:le,selectedChapter:pe}=Q;return N.findChapter(le,pe)?.clippingPlanes}static getChapterCamera(Q){const{chapters:le,selectedChapter:pe}=Q;return N.findChapter(le,pe)?.camera?.location}static findChapter(Q,le){return Q.find(pe=>pe.id===le)}static getAllChaptersCurrentLayers(Q){return Q.chapters.map(le=>le?.sliderLayers?.currentLayers?.layers??[])}static getSelectedChapterSrcLayers(Q){const{chapters:le,selectedChapter:pe}=Q;return N.findChapter(le,pe)?.sliderLayers?.src?.layers??[]}static getSelectedChapterSourceLayerGroups(Q){const{chapters:le,selectedChapter:pe}=Q;return N.findChapter(le,pe)?.sliderLayers?.sourceLayerGroups??[]}static getSelectedChapterLayerGroups(Q){const{chapters:le,selectedChapter:pe}=Q;return N.findChapter(le,pe)?.sliderLayers?.currentLayerGroups??[]}static getSelectedChapterCurrentLayers(Q){const{chapters:le,selectedChapter:pe}=Q;return N.findChapter(le,pe)?.sliderLayers?.currentLayers?.layers??[]}static getSelectedChapterCurrentLayersIndex(Q){const{chapters:le,selectedChapter:pe}=Q;return N.findChapter(le,pe)?.sliderLayers?.currentLayers?.index}static getSelectedChapterCurrentLayersPosition(Q){const{chapters:le,selectedChapter:pe}=Q;return N.findChapter(le,pe)?.sliderLayers?.currentLayers?.position}static getSelectedChapterContentBlocks(Q){const{chapters:le,selectedChapter:pe}=Q;return N.findChapter(le,pe)?.contentBlocks??[]}static getSelectedChapterTimelineMap(Q){const{chapters:le,selectedChapter:pe}=Q;return N.findChapter(le,pe)?.timelineMap??[]}static isLastChapter(Q){return N.getSelectedChapterIndex(Q)+1===Q.chapters.length}setChapters(Q,le){Q.patchState(p.jM(Q.getState(),pe=>{pe.chapters=le.chapters}))}SetChapterCameraAction(Q,le){Q.patchState(p.jM(Q.getState(),pe=>{pe.chapters.find(be=>be.id===le.chapterId).camera.action=le.cameraAction}))}setChapterCameraTitle(Q,le){Q.patchState(p.jM(Q.getState(),pe=>{pe.chapters.find(be=>be.id===le.chapterId).camera.title=le.title}))}setChapterUI(Q,le){Q.patchState(p.jM(Q.getState(),pe=>{pe.chapters.find(be=>be.id===le.chapterId).ui=le.ui}))}setChapterInfo(Q,le){Q.patchState(p.jM(Q.getState(),pe=>{const ie=pe.chapters.find(be=>be.id===le.chapterId);ie.description=le.description,ie.displayName=le.displayName}))}setChapterLegend(Q,le){Q.patchState(p.jM(Q.getState(),pe=>{pe.chapters.find(be=>be.id===le.chapterId).legend=le.legend}))}addToChapterLegend(Q,le){Q.patchState(p.jM(Q.getState(),pe=>{pe.chapters.find(be=>be.id===le.chapterId).legend.push(le.legend)}))}ReorderChapters(Q,le){var pe=this;return(0,t.A)(function*(){return pe.storyService.moveChapterInEngine(le.previousIndex,le.currentIndex).then(ie=>{if(ie){const de=Q.getState().chapters.find(w=>w.id===ie);Q.dispatch(new o.yz(de)),Q.dispatch(new u.IA(ie))}Q.patchState(p.jM(Q.getState(),de=>{(0,g.HD)(de.chapters,le.previousIndex,le.currentIndex)}));const be=Q.getState().chapters.map(de=>de.id);Q.dispatch(new h.B.ReorderQuestions(be))})})()}SetChapterReadyState(Q,le){const pe=p.jM(Q.getState(),ie=>{if(le.chapterId){const be=ie.chapters.find(de=>de.id===le.chapterId);be&&(be.readyState={...be.readyState,...le.readyState})}});Q.patchState(pe)}BuildChapterVisibilityLayers(Q,le){const pe=p.jM(Q.getState(),ie=>{if(le.chapterId){const be=ie.chapters.findIndex(w=>w.id===le.chapterId),de=ie.chapters[be];de.sliderLayers=this.chapterService.buildVisibilityLayers(de)}});Q.patchState(pe)}SetChapterPostProcessing(Q,le){Q.patchState(p.jM(Q.getState(),pe=>{const ie=pe.chapters.find(w=>w.id===le.chapterId),de=ie.properties||{};ie.customData={...ie.customData?ie.customData:{},postprocess:le.effects},ie.properties={...de,...le.properties}}))}SetChapterTransitions(Q,le){Q.patchState(p.jM(Q.getState(),pe=>{const ie=pe.chapters.find(be=>be.id===le.chapterId);ie.transitions=ie.transitions||{},ie.transitions[le.key]=le.transition}))}setChapterProperties(Q,le){const pe=le.chapterIds,ie=le.properties;Q.patchState(p.jM(Q.getState(),be=>{be.chapters.filter(de=>pe.includes(de.id)).forEach(de=>{de.properties={...de.properties??{},...ie}})}))}removeChapterProperties(Q,le){const pe=le.chapterIds,ie=le.properties;Q.patchState(p.jM(Q.getState(),be=>{be.chapters.filter(de=>pe.includes(de.id)).forEach(de=>{de?.properties&&ie.forEach(w=>{delete de.properties[w]})})}))}SetChapterTransparencyMode(Q,le){Q.patchState(p.jM(Q.getState(),pe=>{pe.chapters.find(be=>be.id===le.chapterId).transparencyMode=le.transparencyMode}))}applyChapterPatch(Q,le){const pe=p.$i(Q.getState(),le.patches);Q.patchState(p.jM(pe,ie=>{ie.patches=[],ie.inversePatches=[]}))}setChapterClippingPlane(Q,le){const[pe,ie,be]=p.vI(Q.getState(),w=>{const te=w.chapters.find(R=>R.id===le.chapterId);te.clippingPlanes.clips=le.clips,te.clippingPlanes.enabled=le.enabled,te.clippingPlanes.boundary=te.clippingPlanes.boundary??this.sceneService.getSceneBoundary()}),de=p.jM(pe,w=>{w.patches.push(...ie),w.inversePatches.push(...be)});le.record&&Q.dispatch(new s.a.SavePatches([{forward:de.patches,inverse:[...de.inversePatches].reverse(),patchAction:o.yr}])),Q.patchState(le.record?p.jM(de,w=>{w.patches=[],w.inversePatches=[]}):de)}setChapterBackground(Q,le){le.background&&Q.patchState(p.jM(Q.getState(),pe=>{pe.chapters.find(be=>be.id===le.chapterId).background=le.background}))}setAllChaptersBackground(Q,le){Q.patchState(p.jM(Q.getState(),pe=>{pe.chapters.forEach(ie=>{ie.background=le.background})}))}resetSelectedChapterBackground(Q,le){const{selectedChapter:pe}=Q.getState();this.store.dispatch(new o.qi(pe,v.RK))}setSelectedChapterBackground(Q,{background:le}){const pe=Q.getState().selectedChapter;this.store.dispatch(new o.qi(pe,le))}selectChapter(Q,le){if(!le.chapter)return;this.store.dispatch([new u.q9(!1),new u.hg]);const pe=this.animationService.isChapterAnimated(le.chapter);this.store.dispatch(new y.dB(!!le.chapter));const ie=p.jM(Q.getState(),be=>{be.chaptersViewed.some(de=>le.chapter.id===de)||be.chaptersViewed.push(le.chapter.id),be.selectedChapter=le.chapter?le.chapter.id:null,be.isChapterAnimated=pe});Q.patchState(ie)}selectChapterById(Q,{chapterId:le}){this.store.dispatch(new y.dB(!0)),Q.patchState({selectedChapter:le})}duplicateChapter(Q,le){const pe=le.chapter,ie=this.chapterService.copyChapter(pe,le.chapterId),be=this.store.selectSnapshot(N.getSelectedChapterBackground),de=this.store.selectSnapshot(i.K.getRegisteredThumbnails),w=de.get(pe.id);if((0,d.isNil)(w))if(pe.thumbnails){const D=new l.R;D.chapterId=ie.id,D.snapshot=pe.thumbnails.default,de.set(ie.id,D)}else Q.dispatch(new m.V9(ie.id,be,S.H.JPEG,92,b.I.medium,"square"));else de.set(ie.id,w);const R=Q.getState().chapters.findIndex(D=>D.id==pe.id)+1;Q.patchState(p.jM(Q.getState(),D=>{D.chapters.splice(R,0,ie)})),this.storyService.addChapterToEngine(ie,R).then(()=>{}).catch(D=>{console.error(`Error importing chapter "${ie.id}":`,D)})}nextChapter(Q,le){const pe=this.store.selectSnapshot(N.getNextChapter);Q.dispatch(new o.yz(pe))}previousChapter(Q,le){const pe=this.store.selectSnapshot(N.getPreviousChapter);Q.dispatch(new o.yz(pe))}lastChapter(Q,le){const pe=Q.getState().chapters;Q.dispatch(new o.yz(pe[pe.length-1]))}firstChapter(Q,le){const pe=Q.getState().chapters;Q.dispatch(new o.yz(pe[0]))}removeChapter(Q,le){const{chapters:pe,selectedChapter:ie}=Q.getState();if(1===pe.length)return;const be=pe.findIndex(de=>de.id===le.chapter.id);if(this.storyService.removeChapterFromEngine(be),Q.patchState(p.jM(Q.getState(),de=>{de.chapters.splice(be,1)})),le.chapter.id===ie){const de=Q.getState().chapters,w=Math.min(be,de.length-1);Q.dispatch(new o.yz(de[w]))}Q.dispatch(new E.u1(le.chapter,!1))}resetStoryChaptersState(Q,le){Q.setState(W)}RecordCamera(Q,le){Q.patchState(p.jM(Q.getState(),pe=>{const ie=pe.chapters.find(be=>be.id===le.chapterId);ie.camera.location=le.camera,le.rotationCenter&&(ie.camera.rotationCenter=le.rotationCenter)}))}setChapterCurrentLayersIndexPosition(Q,le){const[pe,ie,be]=p.vI(Q.getState(),w=>{const R=w.chapters.find(D=>D.id===le.chapterId).sliderLayers.currentLayers;R.index=le.index,R.position=le.position}),de=p.jM(pe,w=>{w.patches.push(...ie),w.inversePatches.push(...be)});Q.patchState(de),le.record&&Q.dispatch(new s.a.SavePatches([{forward:de.patches,inverse:de.inversePatches,patchAction:o.yr}]))}setChapterCurrentGroupLayersPosition(Q,le){const[pe,ie,be]=p.vI(Q.getState(),w=>{const te=w.chapters.find(R=>R.id===le.chapterId);te&&(te.sliderLayers.currentLayerGroups=te.sliderLayers.currentLayerGroups.map(R=>{const D=le.targetGroups.find(T=>T.name===R.name);return{...R,position:D?.position??R.position}}))}),de=p.jM(pe,w=>{w.patches.push(...ie),w.inversePatches.push(...be)});Q.patchState(de),le.record&&Q.dispatch(new s.a.SavePatches([{forward:de.patches,inverse:de.inversePatches,patchAction:o.yr}]))}setChapterMedia(Q,le){Q.patchState(p.jM(Q.getState(),pe=>{pe.chapters.find(be=>be.id===le.chapterId).media=le.media}))}setChapterContentBlocks(Q,le){le.contentBlocks=[...le.contentBlocks.filter(w=>w.type===f.m.Ticker),...le.contentBlocks.filter(w=>w.type!==f.m.Ticker)];const[pe,ie,be]=p.vI(Q.getState(),w=>{w.chapters.find(R=>R.id===le.chapterId).contentBlocks=le.contentBlocks}),de=p.jM(pe,w=>{w.patches.push(...ie),w.inversePatches.push(...be)});Q.patchState(de),le.record&&Q.dispatch(new s.a.SavePatches([{forward:de.patches,inverse:de.inversePatches,patchAction:o.yr}]))}setChapterTimelineMap(Q,le){Q.patchState(p.jM(Q.getState(),pe=>{pe.chapters.find(be=>be.id===pe.selectedChapter).timelineMap=le.timelineMaps}))}addChapterTimelineMap(Q,le){Q.patchState(p.jM(Q.getState(),pe=>{const ie=pe.chapters.find(be=>be.id===pe.selectedChapter);le.timelineMaps.forEach(be=>{ie.timelineMap.push(be)})}))}updateChapterTimelineMap(Q,le){Q.patchState(p.jM(Q.getState(),pe=>{const ie=pe.chapters.find(be=>be.id===pe.selectedChapter);le.updates.forEach(be=>{const de=ie.timelineMap.findIndex(w=>w.id===be.id);ie.timelineMap.splice(de,1),ie.timelineMap.push(be)})}))}removeFromChapterTimelineMap(Q,le){Q.patchState(p.jM(Q.getState(),pe=>{const ie=pe.chapters.find(be=>be.id===pe.selectedChapter);le.timelineMapIds.forEach(be=>{const de=ie.timelineMap.findIndex(w=>w.id===be);ie.timelineMap.splice(de,1)})}))}SetChapterLights(Q,{chapterId:le,lightLibId:pe}){Q.patchState(p.jM(Q.getState(),ie=>{const be=ie.chapters.find(de=>de.id===le);(0,q.Mi)(be)?be.lightLibraryId=pe:(0,q.Uv)(be)&&(be.lights.libraries=[pe],this.assetService.setBranchLights(le,pe))}))}constructor(Q,le,pe,ie,be,de){this.store=Q,this.chapterService=le,this.animationService=pe,this.assetService=ie,this.sceneService=be,this.storyService=de}},N=j,j.\u0275fac=function(Q){return new(Q||j)(B.KVO(e.il),B.KVO(C.j),B.KVO(P.O),B.KVO(O.I),B.KVO(A.w),B.KVO(L.J))},j.\u0275prov=B.jDH({token:j,factory:j.\u0275fac}),j);V([(0,e.rc)(o.lM),M("design:type",Function),M("design:paramtypes",[Object,o.lM]),M("design:returntype",void 0)],$.prototype,"setChapters",null),V([(0,e.rc)(o.VU),M("design:type",Function),M("design:paramtypes",[Object,o.VU]),M("design:returntype",void 0)],$.prototype,"SetChapterCameraAction",null),V([(0,e.rc)(o.pN),M("design:type",Function),M("design:paramtypes",[Object,o.pN]),M("design:returntype",void 0)],$.prototype,"setChapterCameraTitle",null),V([(0,e.rc)(o.sC),M("design:type",Function),M("design:paramtypes",[Object,o.sC]),M("design:returntype",void 0)],$.prototype,"setChapterUI",null),V([(0,e.rc)(o.O),M("design:type",Function),M("design:paramtypes",[Object,o.O]),M("design:returntype",void 0)],$.prototype,"setChapterInfo",null),V([(0,e.rc)(o.Lx),M("design:type",Function),M("design:paramtypes",[Object,o.Lx]),M("design:returntype",void 0)],$.prototype,"setChapterLegend",null),V([(0,e.rc)(o.jy),M("design:type",Function),M("design:paramtypes",[Object,o.jy]),M("design:returntype",void 0)],$.prototype,"addToChapterLegend",null),V([(0,e.rc)(o.Oj),M("design:type",Function),M("design:paramtypes",[Object,o.Oj]),M("design:returntype",Promise)],$.prototype,"ReorderChapters",null),V([(0,e.rc)(o.M5),M("design:type",Function),M("design:paramtypes",[Object,o.M5]),M("design:returntype",void 0)],$.prototype,"SetChapterReadyState",null),V([(0,e.rc)(o.eV),M("design:type",Function),M("design:paramtypes",[Object,o.eV]),M("design:returntype",void 0)],$.prototype,"BuildChapterVisibilityLayers",null),V([(0,e.rc)(o.rT),M("design:type",Function),M("design:paramtypes",[Object,o.rT]),M("design:returntype",void 0)],$.prototype,"SetChapterPostProcessing",null),V([(0,e.rc)(o.sN),M("design:type",Function),M("design:paramtypes",[Object,o.sN]),M("design:returntype",void 0)],$.prototype,"SetChapterTransitions",null),V([(0,e.rc)(o.R),M("design:type",Function),M("design:paramtypes",[Object,o.R]),M("design:returntype",void 0)],$.prototype,"setChapterProperties",null),V([(0,e.rc)(o.X_),M("design:type",Function),M("design:paramtypes",[Object,o.X_]),M("design:returntype",void 0)],$.prototype,"removeChapterProperties",null),V([(0,e.rc)(o.Nw),M("design:type",Function),M("design:paramtypes",[Object,o.Nw]),M("design:returntype",void 0)],$.prototype,"SetChapterTransparencyMode",null),V([(0,e.rc)(o.yr),M("design:type",Function),M("design:paramtypes",[Object,o.yr]),M("design:returntype",void 0)],$.prototype,"applyChapterPatch",null),V([(0,e.rc)(o.Ej),M("design:type",Function),M("design:paramtypes",[Object,o.Ej]),M("design:returntype",void 0)],$.prototype,"setChapterClippingPlane",null),V([(0,e.rc)(o.qi),M("design:type",Function),M("design:paramtypes",[Object,o.qi]),M("design:returntype",void 0)],$.prototype,"setChapterBackground",null),V([(0,e.rc)(o.EN),M("design:type",Function),M("design:paramtypes",[Object,o.EN]),M("design:returntype",void 0)],$.prototype,"setAllChaptersBackground",null),V([(0,e.rc)(o.Wd),M("design:type",Function),M("design:paramtypes",[Object,o.Wd]),M("design:returntype",void 0)],$.prototype,"resetSelectedChapterBackground",null),V([(0,e.rc)(o.pb),M("design:type",Function),M("design:paramtypes",[Object,Object]),M("design:returntype",void 0)],$.prototype,"setSelectedChapterBackground",null),V([(0,e.rc)(o.yz),M("design:type",Function),M("design:paramtypes",[Object,o.yz]),M("design:returntype",void 0)],$.prototype,"selectChapter",null),V([(0,e.rc)(o.wg),M("design:type",Function),M("design:paramtypes",[Object,Object]),M("design:returntype",void 0)],$.prototype,"selectChapterById",null),V([(0,e.rc)(o.PA),M("design:type",Function),M("design:paramtypes",[Object,o.PA]),M("design:returntype",void 0)],$.prototype,"duplicateChapter",null),V([(0,e.rc)(o.tg),M("design:type",Function),M("design:paramtypes",[Object,o.tg]),M("design:returntype",void 0)],$.prototype,"nextChapter",null),V([(0,e.rc)(o.F0),M("design:type",Function),M("design:paramtypes",[Object,o.F0]),M("design:returntype",void 0)],$.prototype,"previousChapter",null),V([(0,e.rc)(o.Aq),M("design:type",Function),M("design:paramtypes",[Object,o.Aq]),M("design:returntype",void 0)],$.prototype,"lastChapter",null),V([(0,e.rc)(o.Eo),M("design:type",Function),M("design:paramtypes",[Object,o.Aq]),M("design:returntype",void 0)],$.prototype,"firstChapter",null),V([(0,e.rc)(o.YA),M("design:type",Function),M("design:paramtypes",[Object,o.YA]),M("design:returntype",void 0)],$.prototype,"removeChapter",null),V([(0,e.rc)(o.FN),M("design:type",Function),M("design:paramtypes",[Object,o.FN]),M("design:returntype",void 0)],$.prototype,"resetStoryChaptersState",null),V([(0,e.rc)(o.tn),M("design:type",Function),M("design:paramtypes",[Object,o.tn]),M("design:returntype",void 0)],$.prototype,"RecordCamera",null),V([(0,e.rc)(o.WZ),M("design:type",Function),M("design:paramtypes",[Object,o.WZ]),M("design:returntype",void 0)],$.prototype,"setChapterCurrentLayersIndexPosition",null),V([(0,e.rc)(o.$V),M("design:type",Function),M("design:paramtypes",[Object,o.$V]),M("design:returntype",void 0)],$.prototype,"setChapterCurrentGroupLayersPosition",null),V([(0,e.rc)(o.Eh),M("design:type",Function),M("design:paramtypes",[Object,o.Eh]),M("design:returntype",void 0)],$.prototype,"setChapterMedia",null),V([(0,e.rc)(o.jo),M("design:type",Function),M("design:paramtypes",[Object,o.jo]),M("design:returntype",void 0)],$.prototype,"setChapterContentBlocks",null),V([(0,e.rc)(o.bg),M("design:type",Function),M("design:paramtypes",[Object,o.lc]),M("design:returntype",void 0)],$.prototype,"setChapterTimelineMap",null),V([(0,e.rc)(o.lc),M("design:type",Function),M("design:paramtypes",[Object,o.lc]),M("design:returntype",void 0)],$.prototype,"addChapterTimelineMap",null),V([(0,e.rc)(o.is),M("design:type",Function),M("design:paramtypes",[Object,o.is]),M("design:returntype",void 0)],$.prototype,"updateChapterTimelineMap",null),V([(0,e.rc)(o.Bc),M("design:type",Function),M("design:paramtypes",[Object,o.Bc]),M("design:returntype",void 0)],$.prototype,"removeFromChapterTimelineMap",null),V([(0,e.rc)(o.zh),M("design:type",Function),M("design:paramtypes",[Object,o.zh]),M("design:returntype",void 0)],$.prototype,"SetChapterLights",null),V([(0,e.MD)(),M("design:type",Function),M("design:paramtypes",[r.G]),M("design:returntype",void 0)],$,"getStoryChapters",null),V([(0,e.MD)(),M("design:type",Function),M("design:paramtypes",[r.G]),M("design:returntype",void 0)],$,"getChaptersViewed",null),V([(0,e.MD)(),M("design:type",Function),M("design:paramtypes",[r.G]),M("design:returntype",void 0)],$,"getSelectedChapterId",null),V([(0,e.MD)(),M("design:type",Function),M("design:paramtypes",[r.G]),M("design:returntype",void 0)],$,"getSelectedChapter",null),V([(0,e.MD)(),M("design:type",Function),M("design:paramtypes",[r.G]),M("design:returntype",void 0)],$,"getSelectedChapterTitle",null),V([(0,e.MD)(),M("design:type",Function),M("design:paramtypes",[r.G]),M("design:returntype",void 0)],$,"getNextChapter",null),V([(0,e.MD)(),M("design:type",Function),M("design:paramtypes",[r.G]),M("design:returntype",void 0)],$,"getPreviousChapter",null),V([(0,e.MD)(),M("design:type",Function),M("design:paramtypes",[r.G]),M("design:returntype",void 0)],$,"getSelectedChapterIndex",null),V([(0,e.MD)(),M("design:type",Function),M("design:paramtypes",[r.G]),M("design:returntype",void 0)],$,"getChapterCount",null),V([(0,e.MD)(),M("design:type",Function),M("design:paramtypes",[r.G]),M("design:returntype",void 0)],$,"getChapterPagination",null),V([(0,e.MD)(),M("design:type",Function),M("design:paramtypes",[r.G]),M("design:returntype",void 0)],$,"getChapterCompletionPercent",null),V([(0,e.MD)(),M("design:type",Function),M("design:paramtypes",[r.G]),M("design:returntype",void 0)],$,"getRegisteredThumbnails",null),V([(0,e.MD)(),M("design:type",Function),M("design:paramtypes",[r.G]),M("design:returntype",void 0)],$,"getIsChapterAnimated",null),V([(0,e.MD)(),M("design:type",Function),M("design:paramtypes",[r.G]),M("design:returntype",void 0)],$,"getSelectedChapterReadyState",null),V([(0,e.MD)(),M("design:type",Function),M("design:paramtypes",[r.G]),M("design:returntype",void 0)],$,"getChaptersLoaded",null),V([(0,e.MD)(),M("design:type",Function),M("design:paramtypes",[r.G]),M("design:returntype",void 0)],$,"getAllChaptersModelsReady",null),V([(0,e.MD)(),M("design:type",Function),M("design:paramtypes",[r.G]),M("design:returntype",void 0)],$,"getSelectedChapterModelReady",null),V([(0,e.MD)(),M("design:type",Function),M("design:paramtypes",[r.G]),M("design:returntype",void 0)],$,"getAllChaptersAnimationsReady",null),V([(0,e.MD)(),M("design:type",Function),M("design:paramtypes",[r.G]),M("design:returntype",void 0)],$,"getSelectedChapterAnimationReady",null),V([(0,e.MD)(),M("design:type",Function),M("design:paramtypes",[r.G]),M("design:returntype",void 0)],$,"getSelectedChapterBackground",null),V([(0,e.MD)(),M("design:type",Function),M("design:paramtypes",[r.G]),M("design:returntype",void 0)],$,"getAllChaptersBackground",null),V([(0,e.MD)(),M("design:type",Function),M("design:paramtypes",[r.G]),M("design:returntype",void 0)],$,"getSelectedChapterAllAudio",null),V([(0,e.MD)(),M("design:type",Function),M("design:paramtypes",[r.G]),M("design:returntype",void 0)],$,"getSelectedChapterLegend",null),V([(0,e.MD)(),M("design:type",Function),M("design:paramtypes",[r.G]),M("design:returntype",void 0)],$,"getSelectedChapterClippingPlanes",null),V([(0,e.MD)(),M("design:type",Function),M("design:paramtypes",[r.G]),M("design:returntype",void 0)],$,"getChapterCamera",null),V([(0,e.MD)(),M("design:type",Function),M("design:paramtypes",[r.G]),M("design:returntype",Array)],$,"getAllChaptersCurrentLayers",null),V([(0,e.MD)(),M("design:type",Function),M("design:paramtypes",[r.G]),M("design:returntype",Array)],$,"getSelectedChapterSrcLayers",null),V([(0,e.MD)(),M("design:type",Function),M("design:paramtypes",[r.G]),M("design:returntype",Array)],$,"getSelectedChapterSourceLayerGroups",null),V([(0,e.MD)(),M("design:type",Function),M("design:paramtypes",[r.G]),M("design:returntype",Array)],$,"getSelectedChapterLayerGroups",null),V([(0,e.MD)(),M("design:type",Function),M("design:paramtypes",[r.G]),M("design:returntype",Array)],$,"getSelectedChapterCurrentLayers",null),V([(0,e.MD)(),M("design:type",Function),M("design:paramtypes",[r.G]),M("design:returntype",Number)],$,"getSelectedChapterCurrentLayersIndex",null),V([(0,e.MD)(),M("design:type",Function),M("design:paramtypes",[r.G]),M("design:returntype",Number)],$,"getSelectedChapterCurrentLayersPosition",null),V([(0,e.MD)(),M("design:type",Function),M("design:paramtypes",[r.G]),M("design:returntype",Array)],$,"getSelectedChapterContentBlocks",null),V([(0,e.MD)(),M("design:type",Function),M("design:paramtypes",[r.G]),M("design:returntype",Array)],$,"getSelectedChapterTimelineMap",null),V([(0,e.MD)(),M("design:type",Function),M("design:paramtypes",[r.G]),M("design:returntype",void 0)],$,"isLastChapter",null),$=N=V([(0,e.Uw)({name:"storyChapters",defaults:W}),M("design:paramtypes",[e.il,C.j,P.O,O.I,A.w,L.J])],$)},93915:(ge,F,n)=>{"use strict";n.d(F,{$K:()=>u,$y:()=>g,D3:()=>S,Ds:()=>i,HP:()=>b,S3:()=>d,Sh:()=>C,TR:()=>s,Tz:()=>h,eH:()=>f,gJ:()=>o,h5:()=>E,lb:()=>v,sW:()=>e,tH:()=>P,u1:()=>_,vf:()=>m,vx:()=>y,yi:()=>r});var t=n(15375);let e=(()=>{class a{constructor(p){this.patches=p}}return a.type="[Story Labels] Patch Labels",a})(),r=(()=>{class a{constructor(p,A){this.labelId=p,this.offset=A}}return a.type="[Story Labels] Set label Offset",a})(),o=(()=>{class a{constructor(p){this.labels=p}}return a.type="[Story Labels] Set Labels",a})(),C=(()=>{class a{constructor(p,A=!1){this.label=p,this.record=A}}return a.type="[Story Labels] Add Label",a})(),E=(()=>{class a{constructor(p){this.label=p}}return a.type="[Story Labels] Set Contexdt Label",a})(),y=(()=>{class a{constructor(p){this.label=p}}return a.type="[Story Labels] Remove Label",a})(),d=(()=>{class a{constructor(){}}return a.type="[Story Labels] Remove Context Label",a})(),_=(()=>{class a{constructor(p,A=!1){this.chapter=p,this.record=A}}return a.type="[Story Labels] Remove All Chapter Labels",a})(),v=(()=>{class a{constructor(p,A=!1){this.label=p,this.record=A}}return a.type="[Story Labels] Set Label",a})(),b=(()=>{class a{constructor(p,A){this.id=p,this.states=A}}return a.type="[Story Labels] Set Label States",a})(),P=(()=>{class a{constructor(p){this.scale=p}}return a.type="[Story Labels] Set Label Scale",a})(),s=(()=>{class a{constructor(p){this.label=p}}return a.type="[Story Labels] Select Label",a})(),g=(()=>{class a{constructor(){}}return a.type="[Story Labels] Reset",a})(),u=(()=>{class a{constructor(p,A){this.labels=p,this.fields=A}}return a.type="[Story Labels] Convert",a})(),h=(()=>{class a{constructor(p,A=!0,O=!0,L=!0){this.enable=p,this.enableInfo=A,this.enableActions=O,this.enableAudio=L}}return a.type="[Story Labels] Enable Context Label",a})(),S=(()=>{class a{constructor(p,A){this.labels=p,this.shown=A}}return a.type="[Story Labels] Set Labels Shown",a})(),f=(()=>{class a{constructor(p){this.show=p}}return a.type="[Story Labels] Set All Labels Shown",a})(),m=(()=>{class a{constructor(p,A=t.Q.None){this.collapsed=p,this.collapsedMode=A}}return a.type="[Story Labels] Set Labels Collapsed",a})(),i=(()=>{class a{constructor(p){this.draggable=p}}return a.type="[Story Labels] Set Draggable",a})()},48030:(ge,F,n)=>{"use strict";n.d(F,{j:()=>t,z:()=>e});const t="context-label";class e{}},38753:(ge,F,n)=>{"use strict";n.d(F,{y:()=>c});var h,m,t=n(65763),e=n(48030),r=n(93915),o=n(59429),C=n(94495),E=n(59676),y=n(49204),_=n(15375),v=n(75069),b=n(24151),P=n(79817),s=n(81025),g=n(3367),u=n(54438),S=function(a,l,p,A){var k,O=arguments.length,L=O<3?l:null===A?A=Object.getOwnPropertyDescriptor(l,p):A;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)L=Reflect.decorate(a,l,p,A);else for(var q=a.length-1;q>=0;q--)(k=a[q])&&(L=(O<3?k(L):O>3?k(l,p,L):k(l,p))||L);return O>3&&L&&Object.defineProperty(l,p,L),L},f=function(a,l){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(a,l)};const i={enableContextLabel:{enable:!0,enableInfo:!0,enableActions:!0,enableAudio:!0},loading:!1,labelsCollapsed:!1,labelsCollapsedMode:_.Q.None,labelScale:null,labels:[],contextLabel:null,selectedLabel:null,draggable:{pin:!0,tag:!0}};let c=(h=class{static getLabels(l){return l.labels}static getLabelsCollapsed(l){return l.labelsCollapsed}static getLabelsCollapsedMode(l){return l.labelsCollapsedMode}static getSelectedLabelId(l){return l.selectedLabel}static getSelectedLabel(l){return l.labels.find(p=>p.id===l.selectedLabel)||null}static getContextLabel(l){return l.contextLabel}static getChapterLabels(l,p){return l.labels.filter(A=>A.chapterId===p.selectedChapter)}static getChapterSequentialLabels(l){return(0,t.Mz)([m,C.N],(p,A)=>p.labels.filter(O=>O.chapterId===A.selectedChapter&&O.pinType===b.O.Sequential&&O.sequentialType===l))}static getLabelSequence(l){return(0,t.Mz)([m,m.getChapterSequentialLabels(P.C.Alphabetical),m.getChapterSequentialLabels(P.C.Numerical)],(p,A,O)=>{if(l.pinType!==b.O.Sequential)return null;switch(l.sequentialType){case P.C.Alphabetical:{const L=A.findIndex(k=>k.id===l.id);return"ABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(L)}case P.C.Numerical:return O.findIndex(L=>L.id===l.id)+1}})}static getEnableContextLabel(l){return l.enableContextLabel.enable}static getEnableContextLabelInfo(l){return l.enableContextLabel.enableInfo}static getEnableContextLabelActions(l){return l.enableContextLabel.enableActions}static getEnableContextLabelAudio(l){return l.enableContextLabel.enableAudio}static getLabelsDraggable(l){return l.draggable}static getLabelScale(l){return l.labelScale}PatchLabels(l,p){const A=s.$i(l.getState(),p.patches);l.patchState(A)}setLabelOffset(l,p){const[A,O,L]=s.vI(l.getState(),k=>{const q=k.labels.find(B=>B.id===p.labelId);q&&(q.offset=p.offset)});l.patchState(A),this.savePatches(O,L)}setLabels(l,p){l.patchState(s.jM(l.getState(),A=>{A.labels=p.labels}))}setLabel(l,p){const[A,O,L]=s.vI(l.getState(),k=>{k.labels=k.labels.map(q=>q.id===p.label.id?p.label:q)});l.patchState(A),p.record&&this.savePatches(O,L)}setLabelStates(l,p){const[A,O,L]=s.vI(l.getState(),k=>{k.labels.find(B=>B.id===p.id).states=p.states});l.patchState(A),this.savePatches(O,L)}setLabelScale(l,p){l.patchState({labelScale:p.scale})}addLabel(l,p){const[A,O,L]=s.vI(l.getState(),k=>{const q=p.label.id||o.u.idWithPrefix("label"),B={...p.label,id:q};k.labels.push(B)});l.patchState(A),p.record&&this.savePatches(O,L)}addContextLabel(l,p){const A=s.jM(l.getState(),O=>{O.contextLabel={...p.label,id:e.j}});l.patchState(A)}removeLabel(l,p){const[A,O,L]=s.vI(l.getState(),k=>{k.labels=k.labels.filter(q=>q.id!==p.label.id)});l.patchState(A),this.markerService.deleteMarker(p.label.id),this.savePatches(O,L)}removeContextLabel(l,p){const A=s.jM(l.getState(),O=>{O.contextLabel=void 0});this.markerService.deleteMarker(e.j),l.patchState(A)}removeAllChapterLabels(l,p){const[A,O,L]=s.vI(l.getState(),k=>{const[q,B]=(0,y.partition)(k.labels,j=>j.chapterId!==p.chapter.id);B.forEach(j=>this.markerService.deleteMarker(j.id)),k.labels=q});l.patchState(A),p.record&&this.savePatches(O,L)}selectLabel(l,p){l.patchState({selectedLabel:p.label?p.label.id:null})}resetLabels(l,p){const A=l.getState();this.markerService.deleteMarker(e.j),A.labels.forEach(O=>{this.markerService.deleteMarker(O.id)}),l.setState(s.jM(l.getState(),O=>{}))}convertLabels(l,p){const[A,O,L]=s.vI(l.getState(),k=>{p.labels.forEach(q=>{const B=k.labels.findIndex(j=>j.id===q.id);k.labels[B]={...k.labels[B],...p.fields}})});l.setState({...A}),this.savePatches(O,L)}enableContextLabel(l,p){l.patchState({enableContextLabel:{...p}})}setLabelsShown(l,{labels:p,shown:A}){const O=l.getState().labels.map(L=>{const k=p.some(q=>q.id===L.id);return{...L,shown:k?A:L.shown}});l.patchState({labels:[...O]})}setAllLabelsShown(l,{show:p}){const A=l.getState().labels;l.dispatch(new r.D3(A,p))}setLabelsCollapsed(l,{collapsed:p,collapsedMode:A}){l.patchState({labelsCollapsed:p,labelsCollapsedMode:A})}setLabelsDraggable(l,p){l.patchState({draggable:{...p.draggable}})}savePatches(l,p){this.store.dispatch(new v.a.SavePatches([{forward:l,inverse:p,patchAction:r.sW}]))}constructor(l,p){this.store=l,this.markerService=p}},m=h,h.\u0275fac=function(l){return new(l||h)(u.KVO(t.il),u.KVO(g.m))},h.\u0275prov=u.jDH({token:h,factory:h.\u0275fac}),h);S([(0,t.rc)(r.sW),f("design:type",Function),f("design:paramtypes",[Object,r.sW]),f("design:returntype",void 0)],c.prototype,"PatchLabels",null),S([(0,t.rc)(r.yi),f("design:type",Function),f("design:paramtypes",[Object,r.yi]),f("design:returntype",void 0)],c.prototype,"setLabelOffset",null),S([(0,t.rc)(r.gJ),f("design:type",Function),f("design:paramtypes",[Object,r.gJ]),f("design:returntype",void 0)],c.prototype,"setLabels",null),S([(0,t.rc)(r.lb),f("design:type",Function),f("design:paramtypes",[Object,r.lb]),f("design:returntype",void 0)],c.prototype,"setLabel",null),S([(0,t.rc)(r.HP),f("design:type",Function),f("design:paramtypes",[Object,r.HP]),f("design:returntype",void 0)],c.prototype,"setLabelStates",null),S([(0,t.rc)(r.tH),f("design:type",Function),f("design:paramtypes",[Object,r.tH]),f("design:returntype",void 0)],c.prototype,"setLabelScale",null),S([(0,t.rc)(r.Sh),f("design:type",Function),f("design:paramtypes",[Object,r.Sh]),f("design:returntype",void 0)],c.prototype,"addLabel",null),S([(0,t.rc)(r.h5),f("design:type",Function),f("design:paramtypes",[Object,r.h5]),f("design:returntype",void 0)],c.prototype,"addContextLabel",null),S([(0,t.rc)(r.vx),f("design:type",Function),f("design:paramtypes",[Object,r.vx]),f("design:returntype",void 0)],c.prototype,"removeLabel",null),S([(0,t.rc)(r.S3),f("design:type",Function),f("design:paramtypes",[Object,r.S3]),f("design:returntype",void 0)],c.prototype,"removeContextLabel",null),S([(0,t.rc)(r.u1),f("design:type",Function),f("design:paramtypes",[Object,r.u1]),f("design:returntype",void 0)],c.prototype,"removeAllChapterLabels",null),S([(0,t.rc)(r.TR),f("design:type",Function),f("design:paramtypes",[Object,r.TR]),f("design:returntype",void 0)],c.prototype,"selectLabel",null),S([(0,t.rc)(r.$y),f("design:type",Function),f("design:paramtypes",[Object,r.$y]),f("design:returntype",void 0)],c.prototype,"resetLabels",null),S([(0,t.rc)(r.$K),f("design:type",Function),f("design:paramtypes",[Object,r.$K]),f("design:returntype",void 0)],c.prototype,"convertLabels",null),S([(0,t.rc)(r.Tz),f("design:type",Function),f("design:paramtypes",[Object,r.Tz]),f("design:returntype",void 0)],c.prototype,"enableContextLabel",null),S([(0,t.rc)(r.D3),f("design:type",Function),f("design:paramtypes",[Object,r.D3]),f("design:returntype",void 0)],c.prototype,"setLabelsShown",null),S([(0,t.rc)(r.eH),f("design:type",Function),f("design:paramtypes",[Object,r.eH]),f("design:returntype",void 0)],c.prototype,"setAllLabelsShown",null),S([(0,t.rc)(r.vf),f("design:type",Function),f("design:paramtypes",[Object,r.vf]),f("design:returntype",void 0)],c.prototype,"setLabelsCollapsed",null),S([(0,t.rc)(r.Ds),f("design:type",Function),f("design:paramtypes",[Object,r.Ds]),f("design:returntype",void 0)],c.prototype,"setLabelsDraggable",null),S([(0,t.MD)(),f("design:type",Function),f("design:paramtypes",[e.z]),f("design:returntype",void 0)],c,"getLabels",null),S([(0,t.MD)(),f("design:type",Function),f("design:paramtypes",[e.z]),f("design:returntype",void 0)],c,"getLabelsCollapsed",null),S([(0,t.MD)(),f("design:type",Function),f("design:paramtypes",[e.z]),f("design:returntype",void 0)],c,"getLabelsCollapsedMode",null),S([(0,t.MD)(),f("design:type",Function),f("design:paramtypes",[e.z]),f("design:returntype",void 0)],c,"getSelectedLabelId",null),S([(0,t.MD)(),f("design:type",Function),f("design:paramtypes",[e.z]),f("design:returntype",void 0)],c,"getSelectedLabel",null),S([(0,t.MD)(),f("design:type",Function),f("design:paramtypes",[e.z]),f("design:returntype",void 0)],c,"getContextLabel",null),S([(0,t.MD)([C.N]),f("design:type",Function),f("design:paramtypes",[e.z,E.G]),f("design:returntype",void 0)],c,"getChapterLabels",null),S([(0,t.MD)(),f("design:type",Function),f("design:paramtypes",[e.z]),f("design:returntype",void 0)],c,"getEnableContextLabel",null),S([(0,t.MD)(),f("design:type",Function),f("design:paramtypes",[e.z]),f("design:returntype",void 0)],c,"getEnableContextLabelInfo",null),S([(0,t.MD)(),f("design:type",Function),f("design:paramtypes",[e.z]),f("design:returntype",void 0)],c,"getEnableContextLabelActions",null),S([(0,t.MD)(),f("design:type",Function),f("design:paramtypes",[e.z]),f("design:returntype",void 0)],c,"getEnableContextLabelAudio",null),S([(0,t.MD)(),f("design:type",Function),f("design:paramtypes",[e.z]),f("design:returntype",void 0)],c,"getLabelsDraggable",null),S([(0,t.MD)(),f("design:type",Function),f("design:paramtypes",[e.z]),f("design:returntype",void 0)],c,"getLabelScale",null),c=m=S([(0,t.Uw)({name:"labels",defaults:i}),f("design:paramtypes",[t.il,g.m])],c)},69270:(ge,F,n)=>{"use strict";n.d(F,{S:()=>e});var t=n(17766);function e(r){return r.split("/").length>1?t.c.Module:t.c.Bookmark}},66056:(ge,F,n)=>{"use strict";n.d(F,{Ck:()=>h,Hd:()=>y,Hy:()=>l,KM:()=>v,Nu:()=>O,Pv:()=>_,S9:()=>m,Tt:()=>C,V_:()=>b,Ye:()=>e,Z0:()=>f,cX:()=>o,dC:()=>u,dr:()=>d,fK:()=>E,fn:()=>i,jj:()=>a,nm:()=>A,si:()=>g,t1:()=>S,ub:()=>s,yi:()=>P,yw:()=>c});var t=n(11040);let e=(()=>{class k{constructor(B,j,V=t.q.lang,M=!1){this.id=B,this.type=j,this.lang=V,this.preview=M}}return k.type="[Story] Load Current Story",k})(),o=(()=>{class k{constructor(B){this.story=B}}return k.type="[Story] Replace the Story",k})(),C=(()=>{class k{constructor(B){this.id=B}}return k.type="[Story] Set the Story ID",k})(),E=(()=>{class k{constructor(B){this.displayName=B}}return k.type="[Story] Set Story Text",k})(),y=(()=>{class k{constructor(B){this.tags=B}}return k.type="[Story] Set Story Tags",k})(),d=(()=>{class k{constructor(B){this.playthroughSettings=B}}return k.type="[Story] Set Story Playthrough",k})(),_=(()=>{class k{constructor(B){this.sourceInfo=B}}return k.type="[Story] Set Story Source Info",k})(),v=(()=>{class k{constructor(B){this.lightLibs=B}}return k.type="[Story] Set Story Light Libs",k})(),b=(()=>{class k{}return k.type="[Story] Load Manifests",k})(),P=(()=>{class k{constructor(B,j,V){this.id=B,this.type=j,this.reset=V}}return k.type="[Story] Set Incoming Story Id",k})(),s=(()=>{class k{constructor(){}}return k.type="[Story] Load Story Chunk",k})(),g=(()=>{class k{constructor(B){this.chapterId=B}}return k.type="[Story] Reorder Load Chunks",k})(),u=(()=>{class k{constructor(B){this.chapter=B}}return k.type="[Story] Load Story Chunk Success",k})(),h=(()=>{class k{constructor(B,j,V,M,N=!0){this.id=B,this.story=j,this.type=V,this.chapterIdx=M,this.replaceActiveStory=N}}return k.type="[Story] Build Story In Engine From Story Model",k})(),S=(()=>{class k{constructor(B,j,V){this.story=B,this.id=j,this.type=V}}return k.type="[Story] Build Story Success",k})(),f=(()=>{class k{constructor(B,j,V,M){this.story=B,this.id=j,this.type=V,this.lang=M}}return k.type="[Story] Load Success",k})(),m=(()=>{class k{constructor(B,j){this.id=B,this.type=j}}return k.type="[Story] Load Fail",k})(),i=(()=>{class k{constructor(B,j,V=t.q.lang){this.id=B,this.type=j,this.lang=V}}return k.type="[Story] Import",k})(),c=(()=>{class k{constructor(B,j,V){this.story=B,this.id=j,this.type=V}}return k.type="[Story] Import Success",k})(),a=(()=>{class k{constructor(){}}return k.type="[Story] Clear",k})(),l=(()=>{class k{constructor(){}}return k.type="[Story] Synchronize Chapters",k})(),A=(()=>{class k{constructor(){}}return k.type="[Story] Human Ready (SDK)",k})(),O=(()=>{class k{constructor(B){this.story=B}}return k.type="[Story] Merge Bridge Module Success",k})()},26657:(ge,F,n)=>{"use strict";n.d(F,{Z:()=>e,o:()=>t});class t{}class e{}},22679:(ge,F,n)=>{"use strict";n.d(F,{t:()=>X});var t=n(65763),e=n(26657),r=n(66056),o=n(16606),C=n(94495),E=n(93915),y=n(49204),d=n(59429),v=n(44867);function s(se,oe){const me=et=>void 0!==et.objectId,[Se,Ue]=(0,y.partition)(se,me),[je,Le]=(0,y.partition)(oe,me),Re=function b(se,oe){return oe.reduce((me,Se)=>{for(const Ue of se)(0,y.isEqual)(Ue,Se)||me.push(Se);return me},se)}(Ue,Le),{sceneGraph:Ee,graphsMerged:We,objectIdsUniqueToNew:ze,objectIdsUniqueToOriginal:Ze}=function P(se,oe){const me=se.reduce((je,Le)=>(je[Le.objectId]=Le,je),{}),Se=oe.reduce((je,Le)=>{if(void 0===je.nodes[Le.objectId])return je.nodes[Le.objectId]=Le,je;if(!(0,y.isEqual)(Le,je.nodes[Le.objectId])){const Re=function _(se,oe){const me={},Se={};return{root:function Ue(Le,Re){if(Le.objectId!==Re.objectId)return me[Re.objectId]=!0,[Le,Re];if(void 0===Le.objects&&Re.objects){for(const ze of Re.objects)me[ze.objectId]=!0;return[{...Re}]}if(Le.objects&&void 0===Re.objects){for(const ze of Le.objects)Se[ze.objectId]=!0;return[{...Le}]}if(void 0===Le.objects&&void 0===Re.objects)return[{...Le}];const Ee=[];for(const ze of Le.objects){const Ze=Re.objects.find(et=>et.objectId===ze.objectId);Ze?Ee.push(Ue(ze,Ze)):(Se[ze.objectId]=!0,Ee.push(ze))}for(const ze of Re.objects)Le.objects.find(et=>et.objectId===ze.objectId)||(me[ze.objectId]=!0,Ee.push(ze));const We={...Le};return We.objects=(0,y.flatten)(Ee),[We]}(se,oe),objectIdsUniqueToNew:me,objectIdsUniqueToOriginal:Se}}(je.nodes[Le.objectId],Le);je.nodes[Le.objectId]=Re.root[0],je.graphsMerged.push(Le.objectId),je.objectIdsUniqueToNew[Le.objectId]=Re.objectIdsUniqueToNew,je.objectIdsUniqueToOriginal[Le.objectId]=Re.objectIdsUniqueToOriginal}return je},{nodes:me,graphsMerged:[],objectIdsUniqueToNew:{},objectIdsUniqueToOriginal:{}});return{sceneGraph:Object.keys(Se.nodes).reduce((je,Le)=>(je.push(Se.nodes[Le]),je),[]),graphsMerged:Se.graphsMerged,objectIdsUniqueToNew:Se.objectIdsUniqueToNew,objectIdsUniqueToOriginal:Se.objectIdsUniqueToOriginal}}(Se,je);return{sceneGraph:[...Re,...Ee],graphsMerged:We,objectIdsUniqueToNew:ze,objectIdsUniqueToOriginal:Ze}}function u(se,oe,me){const Se=function g(se,oe,me){const Se={};for(const Ue of se){const je=Object.keys(oe[Ue]);for(const Le of je)Se[Le]=me}return Se}(oe,me,!1);return se.map(Ue=>({...Ue,availableObjects:{...Ue.availableObjects,...Se},showObjects:{...Ue.showObjects,...Se},selectObjects:{...Ue.selectObjects,...Se},pickThroughObjects:{...Ue.pickThroughObjects,...Se}}))}var S=n(17766),f=n(69270);var a=n(63508);function l(se,oe){return se.map(me=>{if((0,a.Mi)(me)||(0,a.Uv)(me)&&!(0,y.isEmpty)(me.lights))return me;const Se={libraries:[...oe],lights:[]};return{...me,lights:Se}})}var p=n(86544);function A(se){return se.reduce((oe,me)=>(oe[me.id]=me,oe),{})}function L(se){return se.reduce((oe,me)=>{const Se=me.id,Ue=me.customData?.particleSystems??[];return Ue.length>0&&(oe[Se]=function O(se){return se.reduce((oe,me)=>(oe[p.R.getParticleIdRoot(me)]=me,oe),{})}(Ue)),oe},{})}function k(se,oe){return se.map(me=>{const Se=me.customData?.particleSystems??[];return Se.length&&(me.customData.particleSystems=Se.map(Ue=>oe[Ue]?.id??Ue)),me})}var B=n(63745),j=n(2096);function V(se,oe,me,Se,Ue=S.c.Bookmark,je=d.u.idWithPrefix){const{sceneGraph:Le,graphsMerged:Re,objectIdsUniqueToNew:Ee,objectIdsUniqueToOriginal:We}=s(se.sceneGraph,me.sceneGraph),ze=function c(se,oe){const me=(Le,Re)=>(0,y.uniq)([...Le,...Re]);return{lights:me(se.lights,oe.lights),tweens:me(se.tweens,oe.tweens),reflections:me(se.reflections,oe.reflections)}}(se.assetLibraries,me.assetLibraries),Ze=function i(se,oe,me,Se){oe=oe||{};const Ue=(je,Le)=>Le.includes("/")?Le:`${function m(se){return(0,f.S)(se)===S.c.Bookmark?se:se.split("/").pop()}(je)}/${Le}`;return{...(0,y.mapKeys)(se=se||{},(je,Le)=>Ue(me,Le)),...(0,y.mapKeys)(oe,(je,Le)=>Ue(Se,Le))}}(se.reflections,me.reflections,oe,Se),et=l(se.chapters,se.assetLibraries.lights),rt=l(me.chapters,me.assetLibraries.lights),ye=function q(se,oe,me,Se,Ue){const je=se.customData?.particleSystems??[],Le=oe.customData?.particleSystems??[],Re=A(je),Ee=A(Le);Object.entries(Ee).forEach(([Ge,Ye])=>{const Xe=Re[Ge];(0,y.isNil)(Xe)||(Ee[Ge]=(0,y.isEqual)(Xe,Ye)?Xe:{...(0,y.cloneDeep)(Ye),id:p.R.generateParticleId(Ge,Ue)})});const We=Array.from(new Set([...Object.values(Re),...Object.values(Ee)])),ze=k(me,Re),Ze=k(Se,Ee),et={...L(ze),...L(Ze)};return{mergedParticles:We,currentChapters:ze,importedChapters:Ze,tweenParticleLookup:(0,y.pickBy)(et,Ge=>!(0,y.isEmpty)(Ge))}}(se,me,u(et,Re,Ee),u(rt,Re,We).map(dt=>{const ke=dt.createdFrom??[];return ke.unshift({id:(0,B.u2)(Se),timestamp:Date.now()}),{...dt,id:je("chapter"),createdFrom:ke}}),je),xe=function h(se,oe){const me=se.map(Se=>Se.objectId);return oe.map(Se=>{const Ue=Se.showObjects??{},je=Se.availableObjects??{};return{...Se,availableObjects:(0,v.K$)(me,Ue,je)}})}(Le,[...ye.currentChapters,...ye.importedChapters]),Je={...se.customData,particleSystems:ye.mergedParticles},ot="module"===Ue?se.tags:[],ct=(0,j.mJ)(se.sourceInfo,me.sourceInfo);return{...se,assetLibraries:ze,chapters:xe,sceneGraph:Le,customData:Je,tags:ot,reflections:Ze,stateId:(0,y.uniq)([...se.stateId,...me.stateId]),tweenParticleLookup:ye.tweenParticleLookup,sourceInfo:ct}}var Z,J,M=n(89612),N=n(24418),W=n(84426),$=n(21894),ne=n(61295),Q=n(29284),le=n(65881),pe=n(35939),ie=n(76016),be=n(21472),de=n(46104),w=n(17215),te=n(76774),R=n(65650),D=n(33013),T=n(82323),re=n(11040),K=n(93132),ae=n(35650),ce=n(79805),U=n(54438),z=function(se,oe,me,Se){var Le,Ue=arguments.length,je=Ue<3?oe:null===Se?Se=Object.getOwnPropertyDescriptor(oe,me):Se;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)je=Reflect.decorate(se,oe,me,Se);else for(var Re=se.length-1;Re>=0;Re--)(Le=se[Re])&&(je=(Ue<3?Le(je):Ue>3?Le(oe,me,je):Le(oe,me))||je);return Ue>3&&je&&Object.defineProperty(oe,me,je),je},H=function(se,oe){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(se,oe)};const Y={loading:!1,incoming:{id:void 0,type:void 0},storyId:void 0,storyType:void 0,storyLang:void 0,loadingChapter:null,loadChapters:[],loadChaptersRemaining:[],thumbnailLookup:[],manifestsMaxTimes:void 0};let X=(J=Z=class{static getStory(oe){return oe.story}static getStoryId(oe){return oe.storyId}static getStoryType(oe){return oe.storyType}static getLoadingChapter(oe){return oe.loadingChapter}static getLoadChapters(oe){return oe.loadChapters}static getLoadChaptersRemaining(oe){return oe.loadChaptersRemaining}static getStoryInfo(oe){return{id:oe.storyId,type:oe.storyType}}static getIncomingStoryInfo(oe){return oe.incoming}static getStoryTags(oe){return oe?.story?.tags??[]}static getStoryLanguage(oe){return oe.storyLang??re.q.lang}static getAnimationManifests(oe){return oe.manifestsMaxTimes}static getStorySourceInfo(oe){return oe.story?.sourceInfo}static getVariantSchemas(oe){return oe.story?.variantSchemas??{}}static getVariantSchema(oe){return(0,t.Mz)([J.getVariantSchemas],me=>me[oe])}setStoryText(oe,me){const Se=oe.getState().story;Se&&oe.patchState({story:{...Se,displayName:me.displayName}})}setStoryTags(oe,{tags:me}){const Se=oe.getState().story;Se&&oe.patchState({story:{...Se,tags:me}})}setStoryPlaythrough(oe,{playthroughSettings:me}){const Se=oe.getState().story;Se&&oe.patchState({story:{...Se,playthroughSettings:me}})}setStorySourceInfo(oe,{sourceInfo:me}){const Se=oe.getState().story;Se&&oe.patchState({story:{...Se,sourceInfo:me}})}loadManifests(oe){oe.patchState({manifestsMaxTimes:void 0});const me=this.storyService.getTweenEndTimes(),Se=Object.values(this.sceneService.getObjects());this.storyService.findMorphEndTimes(Se).subscribe(Ue=>{oe.patchState({manifestsMaxTimes:{...Ue,...me}})})}setStoryLightLibs(oe,me){const Se=oe.getState().story;Se&&oe.patchState({story:{...Se,assetLibraries:{...Se.assetLibraries,lights:me.lightLibs}}})}setStory(oe,me){oe.patchState({story:me.story})}SetStoryId(oe,me){oe.patchState({storyId:me.id})}setIncomingStory(oe,me){const Se=oe.getState(),{id:Ue,type:je,reset:Le}=me;(Ue!==Se.storyId||Le)&&oe.patchState({incoming:{id:Ue,type:je}})}loadStory(oe,me){const Se=me.preview?(0,be.H)(this.storageService.getDatabaseItem(w.AJ.PreviewStory)):this.storyService.getStory(me.id,me.type,me.lang),Ue=this.storyService.getStoryLang(me.id,me.type,me.lang);(0,de.p)([Se,Ue]).subscribe(([je,Le])=>{oe.dispatch(new r.Z0(je,me.id,me.type,Le))},()=>{!0===this.reload?(this.reload=!1,this.loadStory(oe,me)):oe.dispatch(new r.S9(me.id,me.type))})}loadStorySuccess(oe,{story:me,id:Se,type:Ue,lang:je}){oe.patchState({story:me,storyId:Se,storyType:Ue,storyLang:je}),oe.dispatch(new r.Ck(Se,me,Ue))}buildStoryWorkflow(oe,me,Se,Ue,je=0,Le=new Map,Re=!0){if((0,y.isNil)(this.engineService.engine))return;Re&&(Se.moduleId=me,this.engineService.setStory(Se),oe.patchState({storyId:me,story:Se})),this.engineService.engine.start();const Ee=this.sceneService.getRootObjects(),We=this.storyService.getStoryChapters(Ee,Se,Ue);let ze=[];We.forEach(Ce=>{ze=[...ze,...Ce.labels]});const Ze=this.storyService.getStoryLoadChapters(Se);oe.patchState({loadChapters:Ze,loadChaptersRemaining:Ze,incoming:{id:void 0,type:void 0}});const et=this.sceneService.getSceneGraph(Ee),rt=We.reduce((Ce,xe)=>(Ce[xe.id]=(0,Q.iE)(et,xe.showObjects,xe.availableObjects,xe.pickThroughObjects,xe.synchronization),Ce),{});We.forEach(Ce=>{((0,y.isNil)(Ce.createdFrom)||0===Ce.createdFrom.length)&&(Ce.createdFrom=[{id:me,timestamp:Date.now()}])}),oe.dispatch(new ne.K8(rt)),oe.dispatch(new ne.IA(We[je].id)),oe.dispatch(new D.lM(We)),oe.dispatch(new T.W2(Le)),oe.dispatch(new E.gJ(ze)),oe.dispatch(new D.yz(We[je]));const Ge=Se.tweenParticleLookup??{},Ye=Se.customData?.particleSystems??[],Xe=We.reduce((Ce,xe)=>(Ce[xe.id]=xe.customData?.particleSystems??[],Ce),{});oe.dispatch(new pe.u.SetParticleState(Ye,Xe,Ge)),oe.dispatch(new ie.B.ResetQuizState),Se.quizSettings&&oe.dispatch(new ie.B.SetQuizSettings(Se.quizSettings));const ye=(0,te.En)(We);oe.dispatch(new ie.B.SetQuestions(ye)),oe.dispatch(new r.nm),oe.dispatch(new K.B.SetChapterCallToActionSeen(!1)),oe.dispatch(new r.t1(Se,me,Ue)),oe.dispatch(new r.ub)}importStorySuccess(oe,me){const Se=oe.getState(),Ue=Se.storyType,je=Se.storyId,Re=new $.F,We=this.store.selectSnapshot(J.getStory),ze=this.store.selectSnapshot(C.N.getStoryChapters),Ze=(0,le.S)(ze,!1),et=this.serializeModuleService.serialize({},Re,!1,We,ze,Ze).story,rt=V(et,je,me.story,me.id,N.c.exportType),Ge=rt.chapters.slice(et.chapters.length).reduce((Xe,ye,Ce)=>(Xe[me.story.chapters[Ce].id]=ye.id,Xe),{}),Ye=me.story.chapters.reduce((Xe,ye)=>{const Ce=ye.thumbnails?ye.thumbnails.large:M.V.generateLegacyThumbnail(me.id,ye.id).large,xe=M.V.makeFreshThumbnail(je,Ge[ye.id],Ce);return Xe.push(xe),Xe},[]);(0,de.p)(Ye).subscribe(Xe=>{const ye=this.store.selectSnapshot(R.K.getRegisteredThumbnails);Xe.forEach(Ce=>{ye.set(Ce.chapterId,Ce)}),this.buildStoryWorkflow(oe,je,rt,Ue,rt.chapters.length-1,ye)})}buildStory(oe,me){const Se=M.V.getChapterThumbnails(me.id,me.story.chapters);this.buildStoryWorkflow(oe,me.id,me.story,me.type,me.chapterIdx||0,Se,me.replaceActiveStory)}loadChapter(oe){const me=oe.getState().loadChaptersRemaining[0];if(!me)return;oe.patchState({loadingChapter:me});let Se=!1;this.storyService.loadChapter(me).then(()=>{}).catch(Ue=>{(0,y.isNil)(this.engineService.engine?.story)?Se=!0:console.error(Ue)}).finally(()=>{Se?console.warn(`Loading of chapter ${me.chapterId} cancelled.`):oe.dispatch([new r.dC(me),new r.ub])})}reorderLoadChapters(oe,me){const{loadChaptersRemaining:Se}=oe.getState(),[Ue,je]=(0,y.partition)(Se,Le=>Le.chapterId===me.chapterId);oe.patchState({loadChaptersRemaining:[...Ue,...je]})}loadChapterSuccess(oe,me){const Se=oe.getState().loadChaptersRemaining.filter(Ue=>Ue.chapterId!==me.chapter.chapterId);oe.patchState({loadingChapter:null,loadChaptersRemaining:Se}),oe.dispatch(new D.M5(me.chapter.chapterId,{model:!0,animation:!1,...me.chapter.readyState})),oe.dispatch(new D.eV(me.chapter.chapterId))}synchronizeChapters(oe){const me=this.store.selectSnapshot(C.N.getStoryChapters),{story:Se}=oe.getState();oe.patchState({story:{...Se,chapters:[...me]}})}importStory(oe,me){this.storyService.getStory(me.id,me.type,me.lang).subscribe(Se=>{oe.dispatch(new r.yw(Se,me.id,me.type))})}resetStory(oe){oe.setState(Y)}mergeBridgeModuleSuccess(oe,{story:me}){const Se=oe.getState(),Ue=this.store.selectSnapshot(C.N.getSelectedChapterIndex),je=M.V.getChapterThumbnails(Se.storyId,me.chapters);this.buildStoryWorkflow(oe,Se.storyId,me,S.c.Module,Ue,je)}constructor(oe,me,Se,Ue,je,Le){this.store=oe,this.storyService=me,this.serializeModuleService=Se,this.storageService=Ue,this.sceneService=je,this.engineService=Le,this.reload=N.c.native}},Z.\u0275fac=function(oe){return new(oe||Z)(U.KVO(t.il),U.KVO(o.J),U.KVO(W.g),U.KVO(w.n$),U.KVO(ae.w),U.KVO(ce.y))},Z.\u0275prov=U.jDH({token:Z,factory:Z.\u0275fac}),Z);z([(0,t.rc)(r.fK),H("design:type",Function),H("design:paramtypes",[Object,r.fK]),H("design:returntype",void 0)],X.prototype,"setStoryText",null),z([(0,t.rc)(r.Hd),H("design:type",Function),H("design:paramtypes",[Object,r.Hd]),H("design:returntype",void 0)],X.prototype,"setStoryTags",null),z([(0,t.rc)(r.dr),H("design:type",Function),H("design:paramtypes",[Object,r.dr]),H("design:returntype",void 0)],X.prototype,"setStoryPlaythrough",null),z([(0,t.rc)(r.Pv),H("design:type",Function),H("design:paramtypes",[Object,r.Pv]),H("design:returntype",void 0)],X.prototype,"setStorySourceInfo",null),z([(0,t.rc)(r.V_),H("design:type",Function),H("design:paramtypes",[Object]),H("design:returntype",void 0)],X.prototype,"loadManifests",null),z([(0,t.rc)(r.KM),H("design:type",Function),H("design:paramtypes",[Object,r.KM]),H("design:returntype",void 0)],X.prototype,"setStoryLightLibs",null),z([(0,t.rc)(r.cX),H("design:type",Function),H("design:paramtypes",[Object,r.cX]),H("design:returntype",void 0)],X.prototype,"setStory",null),z([(0,t.rc)(r.Tt),H("design:type",Function),H("design:paramtypes",[Object,r.Tt]),H("design:returntype",void 0)],X.prototype,"SetStoryId",null),z([(0,t.rc)(r.yi),H("design:type",Function),H("design:paramtypes",[Object,r.yi]),H("design:returntype",void 0)],X.prototype,"setIncomingStory",null),z([(0,t.rc)(r.Ye),H("design:type",Function),H("design:paramtypes",[Object,r.Ye]),H("design:returntype",void 0)],X.prototype,"loadStory",null),z([(0,t.rc)(r.Z0),H("design:type",Function),H("design:paramtypes",[Object,r.Z0]),H("design:returntype",void 0)],X.prototype,"loadStorySuccess",null),z([(0,t.rc)(r.yw),H("design:type",Function),H("design:paramtypes",[Object,r.yw]),H("design:returntype",void 0)],X.prototype,"importStorySuccess",null),z([(0,t.rc)(r.Ck),H("design:type",Function),H("design:paramtypes",[Object,r.Ck]),H("design:returntype",void 0)],X.prototype,"buildStory",null),z([(0,t.rc)(r.ub),H("design:type",Function),H("design:paramtypes",[Object]),H("design:returntype",void 0)],X.prototype,"loadChapter",null),z([(0,t.rc)(r.si),H("design:type",Function),H("design:paramtypes",[Object,r.si]),H("design:returntype",void 0)],X.prototype,"reorderLoadChapters",null),z([(0,t.rc)(r.dC),H("design:type",Function),H("design:paramtypes",[Object,r.dC]),H("design:returntype",void 0)],X.prototype,"loadChapterSuccess",null),z([(0,t.rc)(r.Hy),H("design:type",Function),H("design:paramtypes",[Object]),H("design:returntype",void 0)],X.prototype,"synchronizeChapters",null),z([(0,t.rc)(r.fn),H("design:type",Function),H("design:paramtypes",[Object,r.fn]),H("design:returntype",void 0)],X.prototype,"importStory",null),z([(0,t.rc)(r.jj),H("design:type",Function),H("design:paramtypes",[Object]),H("design:returntype",void 0)],X.prototype,"resetStory",null),z([(0,t.rc)(r.Nu),H("design:type",Function),H("design:paramtypes",[Object,Object]),H("design:returntype",void 0)],X.prototype,"mergeBridgeModuleSuccess",null),z([(0,t.MD)(),H("design:type",Function),H("design:paramtypes",[e.o]),H("design:returntype",void 0)],X,"getStory",null),z([(0,t.MD)(),H("design:type",Function),H("design:paramtypes",[e.o]),H("design:returntype",void 0)],X,"getStoryId",null),z([(0,t.MD)(),H("design:type",Function),H("design:paramtypes",[e.o]),H("design:returntype",void 0)],X,"getStoryType",null),z([(0,t.MD)(),H("design:type",Function),H("design:paramtypes",[e.o]),H("design:returntype",void 0)],X,"getLoadingChapter",null),z([(0,t.MD)(),H("design:type",Function),H("design:paramtypes",[e.o]),H("design:returntype",void 0)],X,"getLoadChapters",null),z([(0,t.MD)(),H("design:type",Function),H("design:paramtypes",[e.o]),H("design:returntype",void 0)],X,"getLoadChaptersRemaining",null),z([(0,t.MD)(),H("design:type",Function),H("design:paramtypes",[e.o]),H("design:returntype",void 0)],X,"getStoryInfo",null),z([(0,t.MD)(),H("design:type",Function),H("design:paramtypes",[e.o]),H("design:returntype",void 0)],X,"getIncomingStoryInfo",null),z([(0,t.MD)(),H("design:type",Function),H("design:paramtypes",[e.o]),H("design:returntype",void 0)],X,"getStoryTags",null),z([(0,t.MD)(),H("design:type",Function),H("design:paramtypes",[e.o]),H("design:returntype",void 0)],X,"getStoryLanguage",null),z([(0,t.MD)(),H("design:type",Function),H("design:paramtypes",[e.o]),H("design:returntype",void 0)],X,"getAnimationManifests",null),z([(0,t.MD)(),H("design:type",Function),H("design:paramtypes",[e.o]),H("design:returntype",void 0)],X,"getStorySourceInfo",null),z([(0,t.MD)(),H("design:type",Function),H("design:paramtypes",[e.o]),H("design:returntype",Object)],X,"getVariantSchemas",null),X=J=z([(0,t.Uw)({name:"story",defaults:Y}),H("design:paramtypes",[t.il,o.J,W.g,w.n$,ae.w,ce.y])],X)},82323:(ge,F,n)=>{"use strict";n.d(F,{V9:()=>C,W2:()=>r,WX:()=>E,cf:()=>o});var t=n(10352),e=n(9592);let r=(()=>{class d{constructor(v){this.thumbnails=v}}return d.type="[Story Chapters] Register thumbnail URLs from story",d})(),o=(()=>{class d{constructor(v,b){this.chapterId=v,this.thumbnail=b}}return d.type="[Story Chapters] Set chapter thumbnail",d})(),C=(()=>{class d{constructor(v,b=t.RK,P=e.H.JPEG,s=.92,g,u="original",h,S,f=[]){this.chapterId=v,this.background=b,this.imageType=P,this.imageQuality=s,this.dimensions=g,this.crop=u,this.includeLabels=h,this.includeCopyright=S,this.layers=f}}return d.type="[Story Chapters] Take picture",d})(),E=(()=>{class d{constructor(v,b,P){this.chapterId=v,this.blob=b,this.dimensions=P}}return d.type="[Story Chapters] Take picture success",d})()},65650:(ge,F,n)=>{"use strict";n.d(F,{K:()=>S});var s,t=n(65763),r=n(82323),o=n(1308),C=n(11789),E=n(97415),y=n(57238),d=n(30582),_=n(81025),v=n(20342),b=n(98020),P=n(54438),g=function(f,m,i,c){var p,a=arguments.length,l=a<3?m:null===c?c=Object.getOwnPropertyDescriptor(m,i):c;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(f,m,i,c);else for(var A=f.length-1;A>=0;A--)(p=f[A])&&(l=(a<3?p(l):a>3?p(m,i,l):p(m,i))||l);return a>3&&l&&Object.defineProperty(m,i,l),l},u=function(f,m){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(f,m)};const h={thumbnails:new Map};let S=((s=class{static getRegisteredThumbnails(m){return m.thumbnails}registerChapterThumbnails(m,i){m.patchState(_.jM(m.getState(),c=>{c.thumbnails=new Map(i.thumbnails)}))}setChapterThumbnail(m,i){m.patchState(_.jM(m.getState(),c=>{c.thumbnails.set(i.chapterId,i.thumbnail)}))}takeChapterPicture(m,i){const{background:c,chapterId:a,includeLabels:l,includeCopyright:p,dimensions:A,imageType:O,imageQuality:L,crop:k,layers:q}=i,B=A||E.I.large,{width:j,height:V}=B,M=(0,o.F$)(O,c),N=c.colors.slice(0,3),W=C.T.isLight(N),$=this.store.selectSnapshot(b.X.getViewLogoConfig),ne=(0,v.g)($,"full",W?"color":"white"),Q={...o._,crop:k,imageType:O,imageQuality:L,copyrightEnabled:p,copyrightImagePath:ne.logo_url};this.snapshotService.takeSnapshot(j,V,M,q,l,Q).subscribe(le=>{m.dispatch(new r.WX(a,le,B))})}takeChapterPictureSuccess(m,i){m.patchState(_.jM(m.getState(),c=>{const a=c.thumbnails.get(i.chapterId)||new y.R;a.snapshot=URL.createObjectURL(i.blob),c.thumbnails.set(i.chapterId,a)}))}constructor(m,i){this.snapshotService=m,this.store=i}}).\u0275fac=function(m){return new(m||s)(P.KVO(d.M),P.KVO(t.il))},s.\u0275prov=P.jDH({token:s,factory:s.\u0275fac}),s);g([(0,t.rc)(r.W2),u("design:type",Function),u("design:paramtypes",[Object,r.W2]),u("design:returntype",void 0)],S.prototype,"registerChapterThumbnails",null),g([(0,t.rc)(r.cf),u("design:type",Function),u("design:paramtypes",[Object,r.cf]),u("design:returntype",void 0)],S.prototype,"setChapterThumbnail",null),g([(0,t.rc)(r.V9),u("design:type",Function),u("design:paramtypes",[Object,r.V9]),u("design:returntype",void 0)],S.prototype,"takeChapterPicture",null),g([(0,t.rc)(r.WX),u("design:type",Function),u("design:paramtypes",[Object,r.WX]),u("design:returntype",void 0)],S.prototype,"takeChapterPictureSuccess",null),g([(0,t.MD)(),u("design:type",Function),u("design:paramtypes",[class e{}]),u("design:returntype",void 0)],S,"getRegisteredThumbnails",null),S=g([(0,t.Uw)({name:"storyThumbnails",defaults:h}),u("design:paramtypes",[d.M,t.il])],S)},41373:(ge,F,n)=>{"use strict";n.d(F,{F:()=>t});let t=(()=>{class r{constructor(C){this.currentVideo=C}}return r.type="[Story Video] Set current video",r})()},41623:(ge,F,n)=>{"use strict";n.d(F,{Y:()=>v});var E,t=n(65763),e=n(41373),r=n(81025),o=n(95419),C=n(54438),y=function(b,P,s,g){var S,u=arguments.length,h=u<3?P:null===g?g=Object.getOwnPropertyDescriptor(P,s):g;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)h=Reflect.decorate(b,P,s,g);else for(var f=b.length-1;f>=0;f--)(S=b[f])&&(h=(u<3?S(h):u>3?S(P,s,h):S(P,s))||h);return u>3&&h&&Object.defineProperty(P,s,h),h},d=function(b,P){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(b,P)};let v=((E=class{static getCurrentVideo(P){return P.currentVideo}SetCurrentVideo(P,s){P.patchState(r.jM(P.getState(),g=>{const u=g.currentVideo;g.currentVideo=s.currentVideo;const h=this.mediaService.getVideoPlayer(u);h&&h.pause()}))}constructor(P){this.mediaService=P}}).\u0275fac=function(P){return new(P||E)(C.KVO(o.u))},E.\u0275prov=C.jDH({token:E,factory:E.\u0275fac}),E);y([(0,t.rc)(e.F),d("design:type",Function),d("design:paramtypes",[Object,e.F]),d("design:returntype",void 0)],v.prototype,"SetCurrentVideo",null),y([(0,t.MD)(),d("design:type",Function),d("design:paramtypes",[Object]),d("design:returntype",void 0)],v,"getCurrentVideo",null),v=y([(0,t.Uw)({name:"storyVideo",defaults:{currentVideo:null}}),d("design:paramtypes",[o.u])],v)},10381:(ge,F,n)=>{"use strict";n.d(F,{k:()=>h});var t=n(60177),e=n(65763),r=n(22679),o=n(38753),C=n(21604),E=n(94495),y=n(45189),d=n(82192),_=n(35286),v=n(39685),b=n(89417),P=n(42617),s=n(65650),g=n(41623),u=n(54438);let h=(()=>{var S;class f{}return(S=f).\u0275fac=function(i){return new(i||S)},S.\u0275mod=u.$C({type:S}),S.\u0275inj=u.G2t({imports:[e.rK.forFeature([r.t,E.N,o.y,s.K,g.Y]),t.MD,C.G,y.G,d.G,v.y,b.X1,_.y2.forChild(),P.c]}),f})()},16606:(ge,F,n)=>{"use strict";n.d(F,{J:()=>O});var t=n(28407),e=n(15877),r=n(46104),o=n(38399),C=n(36110),E=n(28577),y=n(26657),d=n(18171),_=n(17766),v=n(79805),b=n(11789),P=n(24418),s=n(13976),g=n(43753),u=n(12347),h=n(65763),S=n(94495),f=n(33013),m=n(65881),i=n(49204),a=n(63745),l=n(54438),p=n(21626);function A(L,k,q){return k===_.c.Bookmark?`/search/bookmarks/tr/${q}/${L}`:`/tr/${q}/${L}.json`}let O=(()=>{var L;class k{constructor(B,j,V,M,N,W){this.http=B,this.animationService=j,this.engineService=V,this.chapterService=M,this.contentBlocksService=N,this.store=W}getLoadChapter(B,j){const V=new y.Z;return V.activate=!1,V.chapterId=j.id,V.readyState={model:!0,animation:!0},V}getStory(B,j,V="en"){const M=j===_.c.Bookmark?this.getBookmark(B):this.getContent(B);if("en"===V)return M;{let N;return M.pipe((0,o.q)(W=>(N=W,this.getStoryTranslation(B,j,V)))).pipe((0,C.T)(W=>this.translateStory(N,W)),(0,E.W)(()=>M))}}getContentRoot(){return!0===P.c.offline?typeof localBaseDirectory>"u"?"":localBaseDirectory:"/"}getContent(B){return this.http.get(this.getContentRoot()+`content/modules/${B}.json`).pipe((0,C.T)(j=>this.normalizeStory(j)))}getBookmark(B){return this.http.get("/search/bookmarks/data",{params:{be:B}}).pipe((0,C.T)(j=>this.normalizeStory(j.bookmark)))}addContentRecord(B,j){j.createdFrom||(j.createdFrom=[]),j.createdFrom.unshift({id:(0,a.u2)(B),timestamp:Date.now()})}checkStoryIdChange(B,j){return(0,a.u2)(B)!==(0,a.u2)(j)}getMorphManifest(B){return this.http.get(`/content/states/${B}/animations/morphs/manifest`).pipe((0,C.T)(j=>[B,j]))}getLargestKeyFromManifest(B){const j=Object.values(B.morphs).map(V=>V.keys[V.keys.length-1]);return Math.max(...j)}findMorphEndTimes(B){const j=new Set;if(B.forEach(V=>{V.renderables.filter(({morphId:M})=>!(0,i.isNil)(M)).forEach(({morphId:M})=>{j.add(M.split("/")[0])})}),0===j.size)return(0,e.of)({});{const V=Array.from(j).map(M=>this.getMorphManifest(M));return(0,r.p)(V).pipe((0,C.T)(M=>M.reduce((N,[W,$])=>(N[W]=this.getLargestKeyFromManifest($),N),{})))}}getTweenEndTimes(){const j={};return this.engineService.engine.story.chapters.forEach(V=>{const{tweens:M}=V;Object.keys(M).forEach(N=>{const W=Object.values(M[N].tweens),$=Math.max(...W.map(Q=>Q.keys).flat()),ne=N.split("/")[0];$>(j[ne]??0)&&(j[ne]=$)})}),j}getStoryChapters(B,j,V){return j.chapters.map((M,N)=>this.chapterService.getChapter(B,j,V,M,N))}getStoryLoadChapters(B){return B.chapters.map(V=>this.getLoadChapter(B,V))}loadChapter(B){var j=this;return(0,t.A)(function*(){const V=j.engineService.engine.story.chapters,M=j.store.selectSnapshot(S.N.getStoryChapters),N=j.store.selectSnapshot(S.N.getSelectedChapterIndex),W=M.findIndex(ne=>ne.id===B.chapterId),$=V[W];return $.load().then(()=>W===N?j.animationService.setChapter(B.chapterId):$.id)})()}addChapterToEngine(B,j){var V=this;return(0,t.A)(function*(){const N=V.chapterService.processChapterForEngine(B),W=V.engineService.engine.story.createChapter(N,j);return V.engineService.engine.story.chapters[W].load().then(()=>{V.store.dispatch(new f.yz(B))})})()}removeChapterFromEngine(B){this.engineService.engine.story.chapters.splice(B,1)}moveChapterInEngine(B,j){var V=this;return(0,t.A)(function*(){const M=V.engineService.engine?.story?.activeChapter?.id,N=V.engineService.engine?.story?.chapters.splice(B,1).pop();if(V.engineService.engine.story.chapters.splice(j,0,N),N.id===M)return V.animationService.setChapter(N.id,!0).then(()=>N.id)})()}getStoryTranslation(B,j,V){const M=A(B,j,V);return this.http.get(M)}getStoryLang(B,j,V){if("en"===V)return(0,e.of)("en");const M=A(B,j,V);return this.http.head(M).pipe((0,C.T)(()=>!0),(0,E.W)(()=>(0,e.of)(!1)),(0,C.T)(N=>N?V:"en"))}getStoryType(B){return B.indexOf("/")>=0?_.c.Module:_.c.Bookmark}translateStory(B,j){const M=B.chapters||[],N=B.sceneGraph||[],W=j.objects||{},$=j.chapters||[];return B.displayName=j.displayName||B.displayName,B.description=j.description||B.description,N.forEach(ne=>{(ne.objects||[]).forEach(le=>{this.translateObject(le,W)})}),M.forEach((ne,Q)=>{const le=$[Q];if(le){this.translateMetaInfo(ne,le);const ie=le.annotations||[];(ne.annotations||[]).forEach((T,re)=>{const K=ie[re];K&&this.translateMetaInfo(T,K)});const de=le.hotspots||[];(ne.hotspots||[]).forEach((T,re)=>{const K=de[re];K&&this.translateMetaInfo(T,K)});const te=le.quizQuestions||[];(ne.quizQuestions||[]).forEach((T,re)=>{const K=te[re];K&&this.translateQuizQuestion(T,K)});const R=ne?.contentBlocks,D=le?.contentBlocks;Array.isArray(R)&&Array.isArray(D)&&R.forEach((T,re)=>{const K=D[re];K&&this.translateContentBlock(T,K)})}}),B}translateQuizQuestion(B,j){if(j.nextLabel&&(B.nextLabel=j.nextLabel),["questionPrompt","explanation"].forEach(V=>{const N=j[V]||[];(B[V]||[]).forEach((W,$)=>{const ne=N[$];ne&&(W.markdown=ne.markdown)})}),B.data&&j.data){const M=j.data.options||[];(B.data.options||[]).forEach((N,W)=>{const $=M[W];$&&(B.type===g.Q5.LabelAnatomy?this.translateMetaInfo(N.label,$.label):N.label=$.label)})}}translateMetaInfo(B,j){const{title:V,description:M}=j;B.hasOwnProperty("displayName")&&(B.displayName=V),B.hasOwnProperty("title")&&(B.title=V),B.hasOwnProperty("description")&&(B.description=M)}translateObject(B,j){const M=j[B.objectId];M&&(B.displayName=M);const N=B.objects;N&&N.forEach(W=>{this.translateObject(W,j)})}translateContentBlock(B,j){(0,i.merge)(B,j)}exportWrittenContent(B,j,V){const M=[];return M.push(`\n${B.displayName}\n    `),j.forEach((N,W)=>{M.push(`\n---\n\n# Chapter ${W+1}: ${N.displayName||"-No Title-"}\n\n${N.description||"-No Description-"}\n      `),N.legend.length&&(M.push("\n## Legend\n"),N.legend.forEach(ne=>{M.push(`\n* ${ne.label} (${b.T.rgbToHex(ne.colors,!0)})\n`)}));const $=V.filter(ne=>ne.chapterId===N.id);$.length&&(M.push("\n## Labels\n"),$.forEach(ne=>{M.push(`\n* ${ne.title}\n`),ne.description&&M.push(`\n  > ${ne.description}\n`)}))}),M.join("")}exportQuizKey(B){const j=[];return B.forEach((V,M)=>{switch(j.push(`\n# QUESTION ${M+1} (${g.of[V.type]})\n\n## PROMPT\n${this.contentBlocksService.extractContentBlockText(V.questionPrompt)}\n      `),V.type){case g.Q5.MultipleChoice:V.data.options.forEach((N,W)=>{j.push(`\n## ANSWER ${W+1} ${V.data.correctAnswer===N.value?"- CORRECT":""}\n${N.label}\n            `)});break;case g.Q5.SelectAnatomy:j.push("\n## ANSWERS\n          "),V.data.correctAnswer.forEach((N,W)=>{j.push(`\n${N}\n            `)});break;case g.Q5.LabelAnatomy:V.data.options.forEach((N,W)=>{j.push(`\n## ANSWER ${W+1}\n${N.label.title}\n            `)})}this.contentBlocksService.extractContentBlockText(V.explanation).length&&j.push(`\n  \n## EXPLANATION\n${this.contentBlocksService.extractContentBlockText(V.explanation)}\n        `),j.push("\n\n\n      ")}),j.join("")}normalizeStory(B){return B.chapters.forEach(j=>{j.id||(j.id=(0,m.G)())}),B}}return(L=k).\u0275fac=function(B){return new(B||L)(l.KVO(p.Qq),l.KVO(u.O),l.KVO(v.y),l.KVO(d.j),l.KVO(s.V),l.KVO(h.il))},L.\u0275prov=l.jDH({token:L,factory:L.\u0275fac,providedIn:"root"}),k})()},63508:(ge,F,n)=>{"use strict";n.d(F,{Mi:()=>o,UH:()=>C,Uv:()=>r,VV:()=>E});var t=n(49204);function r(y){return!!("lights"in y&&Array.isArray(y?.lights.libraries)||"environment"in y&&!(0,t.isEmpty)(y?.environment))}function o(y){return"lightLibraryId"in y}function C(y){return y.assetLibraries.lights.map(d=>({type:"legacy",libId:d}))}function E(y){return o(y)?{type:"physical",libId:y.lightLibraryId}:r(y)?{type:"legacy",libId:y.lights.libraries[0]}:null}},2096:(ge,F,n)=>{"use strict";n.d(F,{CE:()=>E,eq:()=>C,mJ:()=>y});var t=n(49204),r=n(24418),o=n(27180);const C="https://www.biodigital.com/p/content-standards-and-development-process";function E(d){if((0,t.isEmpty)(d))return;const{audit:_,reviewed:v,collaborated:b,references:P}=d,s=P?.filter(u=>u.label.trim().length>0)??[],g={};return s.length>0&&(g.references=s),r.c.application!==o.c.Loft||(v?.enabled&&(g.reviewed=v),b?.enabled&&(g.collaborated=b)),_?.enabled&&(g.audit=_),(0,t.isEmpty)(g)?void 0:g}function y(d,_){const v=[...d?.references??[],..._?.references??[]];if(v.length>0)return{references:v,audit:{enabled:!0===d?.audit?.enabled&&!0===_?.audit?.enabled}}}},64566:(ge,F,n)=>{"use strict";n.d(F,{u:()=>i});var S,t=n(85052),e=n(2573),r=n(14264),o=n(37925),C=n(87145),E=n(17365),y=n(65763),d=n(49204),v=n(94495),b=n(61295),P=n(33013),s=n(35650),g=n(93822),u=n(51640),h=n(54438),f=function(c,a,l,p){var L,A=arguments.length,O=A<3?a:null===p?p=Object.getOwnPropertyDescriptor(a,l):p;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)O=Reflect.decorate(c,a,l,p);else for(var k=c.length-1;k>=0;k--)(L=c[k])&&(O=(A<3?L(O):A>3?L(a,l,O):L(a,l))||O);return A>3&&O&&Object.defineProperty(a,l,O),O},m=function(c,a){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(c,a)};class i{constructor(a,l){this.store=a,this.sceneService=l}initObservables(){this.destroyObservables(),this.ngUnsubscribe=new t.B,this.selectedChapterId$.pipe((0,r.p)(a=>!(0,d.isNil)(a)),(0,o.Q)(this.ngUnsubscribe)).subscribe(()=>{this.listenForCurrentLayerGroupsChanges()})}listenForCurrentLayerGroupsChanges(){const a=this.selectedChapterId$.pipe((0,C.i)(1),(0,E.s)(1));this.currentLayerGroups$.pipe((0,r.p)(l=>!(0,d.isNil)(l)&&l.length>0),(0,C.i)(1),(0,o.Q)(a)).subscribe(l=>{const p=this.getObjectVisibilityFromGroups(l);this.store.dispatch(new b.yr(!1,[],p,!1))})}destroyObservables(){this.ngUnsubscribe&&(this.ngUnsubscribe.next(),this.ngUnsubscribe.complete(),this.ngUnsubscribe=null)}syncLayerGroupsToScene(a){const l=this.getObjectVisibilityFromGroups(a);this.sceneService.setShownObjects({showObjects:l})}syncLayerGroupsToState(a,l,p){this.store.dispatch(new P.$V(a,l,p))}computeGroupPositionsByFraction(a,l){const A=a.map(k=>k.layers).flat().length,O=Math.round(A*(0,d.clamp)(l,0,1));let L=A;for(let k=0;k<a.length;k++){const q=a[k];q.position=0;for(let B=q.layers.length,j=B-1,V=B;j>=0;j--,V--,L--)L<=O&&0===q.position&&(q.position=V)}return a}getObjectVisibilityFromGroups(a){const l={};return a.forEach(({layers:p,position:A})=>{const O=p.length-A;p.forEach((L,k)=>{const{objectIds:q}=L,B=O<=k;q.forEach(j=>l[j]=B)})}),l}}(S=i).\u0275fac=function(a){return new(a||S)(h.KVO(y.il),h.KVO(s.w))},S.\u0275prov=h.jDH({token:S,factory:S.\u0275fac,providedIn:"root"}),f([(0,y.l6)(v.N.getSelectedChapterId),m("design:type",e.c)],i.prototype,"selectedChapterId$",void 0),f([(0,y.l6)(v.N.getSelectedChapterLayerGroups),m("design:type",e.c)],i.prototype,"currentLayerGroups$",void 0),f([(0,y.l6)(u.dF.getUIEntry(g.U.VisibilityLayers)),m("design:type",e.c)],i.prototype,"visibilityLayersUI$",void 0)},75069:(ge,F,n)=>{"use strict";var t,e;n.d(F,{a:()=>t}),(e=t||(t={})).Reset=(()=>{class _{constructor(){}}return _.type="[Undo] Reset",_})(),e.Undo=(()=>{class _{constructor(b){this.chapterId=b}}return _.type="[Undo] Undo",_})(),e.UndoAll=(()=>{class _{constructor(b){this.chapterId=b}}return _.type="[Undo] Undo All",_})(),e.Redo=(()=>{class _{constructor(b){this.chapterId=b}}return _.type="[Undo] Redo",_})(),e.SavePatches=(()=>{class _{constructor(b){this.patches=b}}return _.type="[Undo] Store Patches",_})()},68504:(ge,F,n)=>{"use strict";n.d(F,{o:()=>P});var d,t=n(65763),e=n(75069),r=n(94495),o=n(49204),E=n(81025),y=n(54438),_=function(s,g,u,h){var m,S=arguments.length,f=S<3?g:null===h?h=Object.getOwnPropertyDescriptor(g,u):h;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(s,g,u,h);else for(var i=s.length-1;i>=0;i--)(m=s[i])&&(f=(S<3?m(f):S>3?m(g,u,f):m(g,u))||f);return S>3&&f&&Object.defineProperty(g,u,f),f},v=function(s,g){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(s,g)};let P=((d=class{constructor(g){this.store=g}static getStacksForChapter(g){return g.stacksForChapter??{}}static getUndoStack(g,u){return g[u]?.undoStack??[]}static getRedoStack(g,u){return g[u]?.redoStack??[]}static canUndo(g){return g.length>0}static canRedo(g){return g.length>0}static getUndoCount(g){return g.length}reset(g,u){g.patchState(E.jM(g.getState(),h=>{h.stacksForChapter={}}))}undoAll(g,u){const h=g.getState();if(void 0===h.stacksForChapter[u.chapterId])return;const S=[...h.stacksForChapter[u.chapterId].undoStack].reverse(),f=S.flat().reduce((i,c)=>{const{patchAction:a,inverse:l}=c,p=a?.type;return i[p]=i[p]??{actionClass:a,patches:[]},i[p].patches.push(...l),i},{});Object.keys(f).forEach(i=>{const{actionClass:c,patches:a}=f[i];g.dispatch(new c(a))});const m=E.jM(h,i=>{i.stacksForChapter[u.chapterId].undoStack=[],i.stacksForChapter[u.chapterId].redoStack=S});g.patchState(m)}preserveState(g,u){const h=this.store.selectSnapshot(r.N.getSelectedChapterId),S=E.jM(g.getState(),f=>{0===u.patches.length||u.patches.some(i=>0===i.forward.length)&&u.patches.some(i=>0===i.inverse.length)||(void 0===f.stacksForChapter[h]&&(f.stacksForChapter[h]={redoStack:[],undoStack:[]}),f.stacksForChapter[h].redoStack=[],f.stacksForChapter[h].undoStack.push(u.patches))});g.patchState(S)}redo(g,u){const h=g.getState(),S=(0,o.get)(h.stacksForChapter[u.chapterId],"redoStack",[]);if(0===S.length)return;const f=S[S.length-1],m=E.jM(h,i=>{i.stacksForChapter[u.chapterId].redoStack.pop(),i.stacksForChapter[u.chapterId].undoStack.push(f)});g.patchState(m),f.forEach(i=>{g.dispatch(new i.patchAction(i.forward))})}undo(g,u){const h=g.getState(),S=(0,o.get)(h.stacksForChapter[u.chapterId],"undoStack",[]);if(0===S.length)return;const f=S[S.length-1],m=E.jM(h,i=>{i.stacksForChapter[u.chapterId].undoStack.pop(),i.stacksForChapter[u.chapterId].redoStack.push(f)});g.patchState(m),f.forEach(i=>{g.dispatch(new i.patchAction(i.inverse))})}}).\u0275fac=function(g){return new(g||d)(y.KVO(t.il))},d.\u0275prov=y.jDH({token:d,factory:d.\u0275fac}),d);_([(0,t.rc)(e.a.Reset),v("design:type",Function),v("design:paramtypes",[Object,e.a.Reset]),v("design:returntype",void 0)],P.prototype,"reset",null),_([(0,t.rc)(e.a.UndoAll),v("design:type",Function),v("design:paramtypes",[Object,e.a.UndoAll]),v("design:returntype",void 0)],P.prototype,"undoAll",null),_([(0,t.rc)(e.a.SavePatches),v("design:type",Function),v("design:paramtypes",[Object,e.a.SavePatches]),v("design:returntype",void 0)],P.prototype,"preserveState",null),_([(0,t.rc)(e.a.Redo),v("design:type",Function),v("design:paramtypes",[Object,e.a.Redo]),v("design:returntype",void 0)],P.prototype,"redo",null),_([(0,t.rc)(e.a.Undo),v("design:type",Function),v("design:paramtypes",[Object,e.a.Undo]),v("design:returntype",void 0)],P.prototype,"undo",null),_([(0,t.MD)([P]),v("design:type",Function),v("design:paramtypes",[Object]),v("design:returntype",Object)],P,"getStacksForChapter",null),_([(0,t.MD)([P.getStacksForChapter,r.N.getSelectedChapterId]),v("design:type",Function),v("design:paramtypes",[Object,String]),v("design:returntype",Array)],P,"getUndoStack",null),_([(0,t.MD)([P.getStacksForChapter,r.N.getSelectedChapterId]),v("design:type",Function),v("design:paramtypes",[Object,String]),v("design:returntype",Array)],P,"getRedoStack",null),_([(0,t.MD)([P.getUndoStack]),v("design:type",Function),v("design:paramtypes",[Array]),v("design:returntype",Boolean)],P,"canUndo",null),_([(0,t.MD)([P.getRedoStack]),v("design:type",Function),v("design:paramtypes",[Array]),v("design:returntype",Boolean)],P,"canRedo",null),_([(0,t.MD)([P.getUndoStack]),v("design:type",Function),v("design:paramtypes",[Array]),v("design:returntype",Number)],P,"getUndoCount",null),P=_([(0,t.Um)({injectContainerState:!1}),(0,t.Uw)({name:"undo",defaults:{stacksForChapter:{}}}),v("design:paramtypes",[t.il])],P)},82608:(ge,F,n)=>{"use strict";n.d(F,{$k:()=>w,AA:()=>d,Ae:()=>q,Al:()=>a,Bf:()=>pe,CA:()=>W,CU:()=>p,CW:()=>N,DY:()=>R,Fk:()=>L,GV:()=>t,H7:()=>D,HF:()=>e,HO:()=>g,HZ:()=>P,J0:()=>be,Jt:()=>o,Kl:()=>h,Lh:()=>re,QB:()=>m,Qi:()=>ie,Qy:()=>O,Rr:()=>_,S$:()=>f,Ud:()=>j,XW:()=>Q,Xm:()=>c,ZO:()=>B,_M:()=>de,_W:()=>u,_b:()=>ne,ah:()=>k,dG:()=>M,dQ:()=>l,f0:()=>y,h2:()=>v,iW:()=>s,jV:()=>V,jv:()=>A,ku:()=>le,lX:()=>$,mb:()=>te,mq:()=>T,qy:()=>i,rD:()=>S,w9:()=>b,y7:()=>r,yX:()=>C,zi:()=>E});let t=(()=>{class ae{constructor(U){this.organization=U}}return ae.type="[Users] Join Organization",ae})(),e=(()=>{class ae{constructor(U){this.organization=U}}return ae.type="[Users] Join Organization Success",ae})(),r=(()=>{class ae{constructor(U){this.organization=U}}return ae.type="[Users] Join Organization Fail",ae})(),o=(()=>{class ae{constructor(U){this.code=U}}return ae.type="[Users] Join Organization With Code",ae})(),C=(()=>{class ae{constructor(U){this.organizationName=U}}return ae.type="[Users] Join Organization With Code Success",ae})(),E=(()=>{class ae{constructor(U){this.error=U}}return ae.type="[Users] Join Organization With Code Fail",ae})(),y=(()=>{class ae{constructor(U){this.organization=U}}return ae.type="[Users] Leave Organization",ae})(),d=(()=>{class ae{constructor(U){this.organization=U}}return ae.type="[Users] Leave Organization Success",ae})(),_=(()=>{class ae{constructor(U){this.error=U}}return ae.type="[Users] Leave Organization Fail",ae})(),v=(()=>{class ae{constructor(U,Z){this.groupEID=U,this.invites=Z}}return ae.type="[Users] Send Organization Invite",ae})(),b=(()=>{class ae{constructor(U){this.responses=U}}return ae.type="[Users] Send Organization Invite Success",ae})(),P=(()=>{class ae{constructor(U){this.error=U}}return ae.type="[Users] Send Organization Invite Fail",ae})(),s=(()=>{class ae{constructor(U){this.groupId=U}}return ae.type="[Users] Get Organization Users",ae})(),g=(()=>{class ae{constructor(U){this.users=U}}return ae.type="[Users] Get Organization Users Success",ae})(),u=(()=>{class ae{constructor(U){this.error=U}}return ae.type="[Users] Get Organization Users Fail",ae})(),h=(()=>{class ae{constructor(U){this.groupId=U}}return ae.type="[Users] Get Organization Invited Users",ae})(),S=(()=>{class ae{constructor(U){this.invites=U}}return ae.type="[Users] Get Organization Invited Users Success",ae})(),f=(()=>{class ae{constructor(U){this.error=U}}return ae.type="[Users] Get Organization Invited Users Fail",ae})(),m=(()=>{class ae{}return ae.type="[Users] Reset",ae})(),i=(()=>{class ae{constructor(U,Z){this.groupId=U,this.users=Z}}return ae.type="[Users] Update User Roles",ae})(),c=(()=>{class ae{constructor(U,Z){this.groupId=U,this.users=Z}}return ae.type="[Users] Update User Roles Success",ae})(),a=(()=>{class ae{}return ae.type="[Users] Update User Roles Fail",ae})(),l=(()=>{class ae{constructor(U,Z){this.groupId=U,this.users=Z}}return ae.type="[Users] Remove Organization User",ae})(),p=(()=>{class ae{constructor(U,Z){this.groupId=U,this.users=Z}}return ae.type="[Users] Remove Organization User Success",ae})(),A=(()=>{class ae{}return ae.type="[Users] Remove Organization User Fail",ae})(),O=(()=>{class ae{constructor(U,Z){this.groupId=U,this.users=Z}}return ae.type="[Users] Transfer Organization Content",ae})(),L=(()=>{class ae{constructor(U,Z){this.groupId=U,this.users=Z}}return ae.type="[Users] Transfer Organization Content Success",ae})(),k=(()=>{class ae{}return ae.type="[Users] Transfer Organization Content Fail",ae})(),q=(()=>{class ae{constructor(U){this.params=U}}return ae.type="[Users] Get Eligible Join Organizations",ae})(),B=(()=>{class ae{constructor(U){this.eligibleOrganizations=U}}return ae.type="[Users] Get Eligible Join Organizations Success",ae})(),j=(()=>{class ae{constructor(U){this.error=U}}return ae.type="[Users] Get Eligible Join Organizations Error",ae})(),V=(()=>{class ae{}return ae.type="[Users] Clear Eligible Join Organizations",ae})(),M=(()=>{class ae{constructor(U){this.params=U}}return ae.type="[Users] Get Join Requests",ae})(),N=(()=>{class ae{constructor(U){this.joinRequests=U}}return ae.type="[Users] Get Join Requests Success",ae})(),W=(()=>{class ae{constructor(U,Z){this.organizationId=U,this.description=Z}}return ae.type="[Users] Post Join Request",ae})(),$=(()=>{class ae{constructor(U){this.joinRequestKey=U}}return ae.type="[Users] Post Join Request Success",ae})(),ne=(()=>{class ae{constructor(U){this.error=U}}return ae.type="[Users] Post Join Request Error",ae})(),Q=(()=>{class ae{constructor(U){this.joinRequestKey=U}}return ae.type="[Users] Delete Join Request",ae})(),le=(()=>{class ae{}return ae.type="[Users] Delete Join Request Success",ae})(),pe=(()=>{class ae{constructor(U){this.error=U}}return ae.type="[Users] Delete Join Request Error",ae})(),ie=(()=>{class ae{constructor(U){this.params=U}}return ae.type="[Users] Get Organization Join Requests",ae})(),be=(()=>{class ae{constructor(U){this.organizationJoinRequests=U}}return ae.type="[Users] Get Organization Join Requests Success",ae})(),de=(()=>{class ae{constructor(U){this.error=U}}return ae.type="[Users] Get Organization Join Requests Error",ae})(),w=(()=>{class ae{constructor(U){this.joinRequests=U}}return ae.type="[Users] Accept Join Requests",ae})(),te=(()=>{class ae{constructor(U){this.count=U}}return ae.type="[Users] Accept Join Requests Success",ae})(),R=(()=>{class ae{constructor(U,Z){this.count=U,this.error=Z}}return ae.type="[Users] Accept Join Requests Error",ae})(),D=(()=>{class ae{constructor(U){this.joinRequestKeys=U}}return ae.type="[Users] Deny Join Requests",ae})(),T=(()=>{class ae{constructor(U){this.count=U}}return ae.type="[Users] Deny Join Requests Success",ae})(),re=(()=>{class ae{constructor(U,Z){this.count=U,this.error=Z}}return ae.type="[Users] Deny Join Requests Error",ae})()},99504:(ge,F,n)=>{"use strict";n.d(F,{e:()=>m});var t=n(65763),e=n(82608),r=n(15152),o=n(11756),C=n(59e3),E=n(80910);class y{}var g,S,d=n(5690),_=n(71263),v=n(38165),b=n(3188),P=n(50262),s=n(54438),u=function(i,c,a,l){var O,p=arguments.length,A=p<3?c:null===l?l=Object.getOwnPropertyDescriptor(c,a):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)A=Reflect.decorate(i,c,a,l);else for(var L=i.length-1;L>=0;L--)(O=i[L])&&(A=(p<3?O(A):p>3?O(c,a,A):O(c,a))||A);return p>3&&A&&Object.defineProperty(c,a,A),A},h=function(i,c){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(i,c)};const f={joining:!1,leaving:!1,inviting:!1,loadingUsers:!1,loadingInvites:!1,loadingOrganizationJoinRequests:!1,loadingJoinRequests:!1,loadingEligibleOrganizations:!1,postingJoinRequest:!1,deletingJoinRequest:!1,users:[],invites:[],joinRequests:[],organizationJoinRequests:[]};let m=(g=class{static getUsers(c){return c.users}static getInvites(c){return c.invites}static getUsersLoading(c){return c.loadingUsers}static getJoining(c){return c.joining}static getLeaving(c){return c.leaving}static getInviting(c){return c.inviting}static getLoadingJoinRequests(c){return c.loadingJoinRequests}static getLoadingOrganizationJoinRequests(c){return c.organizationJoinRequests}static getLoadingEligibleOrganizations(c){return c.loadingEligibleOrganizations}static getPostingJoinRequest(c){return c.postingJoinRequest}static getDeletingJoinRequest(c){return c.deletingJoinRequest}static getRequesting(c){return c.loadingJoinRequests||c.loadingEligibleOrganizations||c.postingJoinRequest||c.deletingJoinRequest}static getEligibleOrganizations(c){return c.eligibleOrganizations}static hasEligibleOrganizations(c){return Array.isArray(c.eligibleOrganizations)&&c.eligibleOrganizations.length>0}static getJoinRequests(c){return c.joinRequests}static getPendingJoinRequest(c){return c.joinRequests?.find(a=>a.request_status===b.s.Pending)}static getOrganizationJoinRequests(c){return c.organizationJoinRequests}static getPendingOrganizationJoinRequests(c){return c.organizationJoinRequests.filter(a=>a.request_status===b.s.Pending)}joinOrganization(c,{organization:a}){c.patchState({joining:!0}),this.usersService.addUserToOrganization(a.eid).pipe((0,r.j)(()=>c.patchState({joining:!1}))).subscribe(()=>c.dispatch(new e.HF(a)),()=>c.dispatch(new e.y7(a)))}joinOrganizationWithCode(c,{code:a}){c.patchState({joining:!0}),this.usersService.addUserWithGroupCode(a).pipe((0,r.j)(()=>c.patchState({joining:!1}))).subscribe(l=>c.dispatch(new e.yX(l)),l=>c.dispatch(new e.zi(l)))}joinOrganizationWithCodeSuccess(){this.vendorAnalyticsService.track("Account Upgrade - Free Individual to Team")}leaveOrganization(c,{organization:a}){c.patchState({leaving:!0}),this.usersService.removeUser(a.id).pipe((0,r.j)(()=>c.patchState({leaving:!1}))).subscribe({next:()=>c.dispatch(new e.AA(a)),error:l=>c.dispatch(new e.Rr(l))})}sendOrganizationInvite(c,{groupEID:a,invites:l}){c.patchState({inviting:!0}),this.authService.verifyIsHuman("invites","",!0).pipe((0,o.Z)(({isHuman:p,verification:A})=>{if(!p)throw new P.s;return this.usersService.sendOrganizationInvites(a,l,A)}),(0,r.j)(()=>c.patchState({inviting:!1}))).subscribe({next:p=>{c.dispatch(new e.w9(p))},error:p=>{p instanceof P.s&&c.dispatch(new v.sz(p)),c.dispatch(new e.HZ(p))}})}getOrganizationUsers(c,{groupId:a}){c.patchState({loadingUsers:!0}),this.usersService.getOrganizationUsers({group_id:a}).pipe((0,r.j)(()=>c.patchState({loadingUsers:!1}))).subscribe(l=>c.dispatch(new e.HO(l)),l=>c.dispatch(new e._W(l)))}getOrganizationUsersSuccess(c,{users:a}){c.patchState({users:a})}getOrganizationUserInvites(c,{groupId:a}){c.patchState({loadingInvites:!0}),this.usersService.getOrganizationInvites({group_id:a,version:1,app_productkey:this.productService.productKey,app_producttype:this.productService.productType}).pipe((0,r.j)(()=>c.patchState({loadingInvites:!1}))).subscribe(l=>c.dispatch(new e.rD(l)),l=>c.dispatch(new e.S$(l)))}getOrganizationUserInvitesSuccess(c,{invites:a}){c.patchState({invites:a})}resetOrganizations(c){c.setState(f)}updateUserRoles(c,{groupId:a,users:l}){this.usersService.updateUserRoles(a,l).subscribe(()=>c.dispatch(new e.Xm(a,l)),()=>c.dispatch(new e.Al))}removeOrganizationUser(c,{groupId:a,users:l}){this.usersService.removeUsers(a,l).subscribe(()=>c.dispatch(new e.CU(a,l)),()=>c.dispatch(new e.jv))}transferOrganizationContent(c,{groupId:a,users:l}){this.usersService.transferUserContent(a,l).subscribe(()=>c.dispatch(new e.Fk(a,l)),()=>c.dispatch(new e.ah))}clearEligibleJoinOrganizations(c,a){c.patchState({eligibleOrganizations:[]})}getEligibleJoinOrganizations(c,a){c.patchState({loadingEligibleOrganizations:!0}),this.usersService.getEligibleJoinOrganizations(a.params).pipe((0,r.j)(()=>c.patchState({loadingEligibleOrganizations:!1}))).subscribe({next:l=>{c.dispatch(new e.ZO(l.eligible_orgs))},error:l=>c.dispatch(new e.Ud(l))})}getEligibleJoinOrganizationsSuccess(c,{eligibleOrganizations:a}){c.patchState({eligibleOrganizations:a})}getJoinRequests(c,a){c.patchState({loadingJoinRequests:!0}),this.usersService.getJoinRequests(a.params).pipe((0,r.j)(()=>c.patchState({loadingJoinRequests:!1}))).subscribe(l=>{c.dispatch(new e.CW(l.join_requests))})}getJoinRequestsSuccess(c,{joinRequests:a}){c.patchState({joinRequests:a}),S.getPendingJoinRequest(c.getState())&&c.dispatch(new e.jV)}postJoinRequest(c,a){c.patchState({postingJoinRequest:!0}),this.usersService.postJoinRequest(a.organizationId,a.description).pipe((0,r.j)(()=>c.patchState({postingJoinRequest:!1}))).subscribe({next:l=>{c.dispatch(new e.lX(l.join_request_key)),c.dispatch(new e.dG)},error:l=>c.dispatch(new e._b(l))})}deleteJoinRequest(c,a){c.patchState({deletingJoinRequest:!0}),this.usersService.deleteJoinRequest(a.joinRequestKey).pipe((0,r.j)(()=>c.patchState({deletingJoinRequest:!1}))).subscribe({next:()=>{c.dispatch(new e.ku),c.dispatch(new e.dG)},error:l=>c.dispatch(new e.Bf(l))})}getOrganizationJoinRequests(c,a){c.patchState({loadingOrganizationJoinRequests:!0}),this.usersService.getOrganizationJoinRequests(a.params).pipe((0,r.j)(()=>c.patchState({loadingOrganizationJoinRequests:!1}))).subscribe({next:l=>{c.dispatch(new e.J0(l.join_requests))},error:l=>c.dispatch(new e._M(l))})}getOrganizationJoinRequestsSuccess(c,{organizationJoinRequests:a}){c.patchState({organizationJoinRequests:a})}acceptJoinRequests(c,a){const l=a.joinRequests.length;this.usersService.acceptOrganizationJoinRequests(a.joinRequests).subscribe({next:()=>{c.dispatch(new e.mb(l))},error:p=>c.dispatch(new e.DY(l,p))})}denyJoinRequests(c,a){const l=a.joinRequestKeys.length;this.usersService.denyOrganizationJoinRequests(a.joinRequestKeys).subscribe({next:()=>{c.dispatch(new e.mq(l))},error:p=>c.dispatch(new e.Lh(l,p))})}constructor(c,a,l,p){this.usersService=c,this.vendorAnalyticsService=a,this.productService=l,this.authService=p}},S=g,g.\u0275fac=function(c){return new(c||g)(s.KVO(E.g),s.KVO(C.e),s.KVO(d.b),s.KVO(_.u))},g.\u0275prov=s.jDH({token:g,factory:g.\u0275fac}),g);u([(0,t.rc)(e.GV),h("design:type",Function),h("design:paramtypes",[Object,e.GV]),h("design:returntype",void 0)],m.prototype,"joinOrganization",null),u([(0,t.rc)(e.Jt),h("design:type",Function),h("design:paramtypes",[Object,e.Jt]),h("design:returntype",void 0)],m.prototype,"joinOrganizationWithCode",null),u([(0,t.rc)(e.yX),h("design:type",Function),h("design:paramtypes",[]),h("design:returntype",void 0)],m.prototype,"joinOrganizationWithCodeSuccess",null),u([(0,t.rc)(e.f0),h("design:type",Function),h("design:paramtypes",[Object,e.f0]),h("design:returntype",void 0)],m.prototype,"leaveOrganization",null),u([(0,t.rc)(e.h2),h("design:type",Function),h("design:paramtypes",[Object,e.h2]),h("design:returntype",void 0)],m.prototype,"sendOrganizationInvite",null),u([(0,t.rc)(e.iW),h("design:type",Function),h("design:paramtypes",[Object,e.iW]),h("design:returntype",void 0)],m.prototype,"getOrganizationUsers",null),u([(0,t.rc)(e.HO),h("design:type",Function),h("design:paramtypes",[Object,e.HO]),h("design:returntype",void 0)],m.prototype,"getOrganizationUsersSuccess",null),u([(0,t.rc)(e.Kl),h("design:type",Function),h("design:paramtypes",[Object,e.Kl]),h("design:returntype",void 0)],m.prototype,"getOrganizationUserInvites",null),u([(0,t.rc)(e.rD),h("design:type",Function),h("design:paramtypes",[Object,e.rD]),h("design:returntype",void 0)],m.prototype,"getOrganizationUserInvitesSuccess",null),u([(0,t.rc)(e.QB),h("design:type",Function),h("design:paramtypes",[Object]),h("design:returntype",void 0)],m.prototype,"resetOrganizations",null),u([(0,t.rc)(e.qy),h("design:type",Function),h("design:paramtypes",[Object,e.qy]),h("design:returntype",void 0)],m.prototype,"updateUserRoles",null),u([(0,t.rc)(e.dQ),h("design:type",Function),h("design:paramtypes",[Object,e.dQ]),h("design:returntype",void 0)],m.prototype,"removeOrganizationUser",null),u([(0,t.rc)(e.Qy),h("design:type",Function),h("design:paramtypes",[Object,e.Qy]),h("design:returntype",void 0)],m.prototype,"transferOrganizationContent",null),u([(0,t.rc)(e.jV),h("design:type",Function),h("design:paramtypes",[Object,e.jV]),h("design:returntype",void 0)],m.prototype,"clearEligibleJoinOrganizations",null),u([(0,t.rc)(e.Ae),h("design:type",Function),h("design:paramtypes",[Object,e.Ae]),h("design:returntype",void 0)],m.prototype,"getEligibleJoinOrganizations",null),u([(0,t.rc)(e.ZO),h("design:type",Function),h("design:paramtypes",[Object,e.ZO]),h("design:returntype",void 0)],m.prototype,"getEligibleJoinOrganizationsSuccess",null),u([(0,t.rc)(e.dG),h("design:type",Function),h("design:paramtypes",[Object,e.dG]),h("design:returntype",void 0)],m.prototype,"getJoinRequests",null),u([(0,t.rc)(e.CW),h("design:type",Function),h("design:paramtypes",[Object,e.CW]),h("design:returntype",void 0)],m.prototype,"getJoinRequestsSuccess",null),u([(0,t.rc)(e.CA),h("design:type",Function),h("design:paramtypes",[Object,e.CA]),h("design:returntype",void 0)],m.prototype,"postJoinRequest",null),u([(0,t.rc)(e.XW),h("design:type",Function),h("design:paramtypes",[Object,e.XW]),h("design:returntype",void 0)],m.prototype,"deleteJoinRequest",null),u([(0,t.rc)(e.Qi),h("design:type",Function),h("design:paramtypes",[Object,e.Qi]),h("design:returntype",void 0)],m.prototype,"getOrganizationJoinRequests",null),u([(0,t.rc)(e.J0),h("design:type",Function),h("design:paramtypes",[Object,e.J0]),h("design:returntype",void 0)],m.prototype,"getOrganizationJoinRequestsSuccess",null),u([(0,t.rc)(e.$k),h("design:type",Function),h("design:paramtypes",[Object,e.$k]),h("design:returntype",void 0)],m.prototype,"acceptJoinRequests",null),u([(0,t.rc)(e.H7),h("design:type",Function),h("design:paramtypes",[Object,e.H7]),h("design:returntype",void 0)],m.prototype,"denyJoinRequests",null),u([(0,t.MD)(),h("design:type",Function),h("design:paramtypes",[y]),h("design:returntype",void 0)],m,"getUsers",null),u([(0,t.MD)(),h("design:type",Function),h("design:paramtypes",[y]),h("design:returntype",void 0)],m,"getInvites",null),u([(0,t.MD)(),h("design:type",Function),h("design:paramtypes",[y]),h("design:returntype",void 0)],m,"getUsersLoading",null),u([(0,t.MD)(),h("design:type",Function),h("design:paramtypes",[y]),h("design:returntype",void 0)],m,"getJoining",null),u([(0,t.MD)(),h("design:type",Function),h("design:paramtypes",[y]),h("design:returntype",void 0)],m,"getLeaving",null),u([(0,t.MD)(),h("design:type",Function),h("design:paramtypes",[y]),h("design:returntype",void 0)],m,"getInviting",null),u([(0,t.MD)(),h("design:type",Function),h("design:paramtypes",[y]),h("design:returntype",void 0)],m,"getLoadingJoinRequests",null),u([(0,t.MD)(),h("design:type",Function),h("design:paramtypes",[y]),h("design:returntype",void 0)],m,"getLoadingOrganizationJoinRequests",null),u([(0,t.MD)(),h("design:type",Function),h("design:paramtypes",[y]),h("design:returntype",void 0)],m,"getLoadingEligibleOrganizations",null),u([(0,t.MD)(),h("design:type",Function),h("design:paramtypes",[y]),h("design:returntype",void 0)],m,"getPostingJoinRequest",null),u([(0,t.MD)(),h("design:type",Function),h("design:paramtypes",[y]),h("design:returntype",void 0)],m,"getDeletingJoinRequest",null),u([(0,t.MD)(),h("design:type",Function),h("design:paramtypes",[y]),h("design:returntype",void 0)],m,"getRequesting",null),u([(0,t.MD)(),h("design:type",Function),h("design:paramtypes",[y]),h("design:returntype",void 0)],m,"getEligibleOrganizations",null),u([(0,t.MD)(),h("design:type",Function),h("design:paramtypes",[y]),h("design:returntype",void 0)],m,"hasEligibleOrganizations",null),u([(0,t.MD)(),h("design:type",Function),h("design:paramtypes",[y]),h("design:returntype",void 0)],m,"getJoinRequests",null),u([(0,t.MD)(),h("design:type",Function),h("design:paramtypes",[y]),h("design:returntype",void 0)],m,"getPendingJoinRequest",null),u([(0,t.MD)(),h("design:type",Function),h("design:paramtypes",[y]),h("design:returntype",void 0)],m,"getOrganizationJoinRequests",null),u([(0,t.MD)(),h("design:type",Function),h("design:paramtypes",[y]),h("design:returntype",void 0)],m,"getPendingOrganizationJoinRequests",null),m=S=u([(0,t.Uw)({name:"users",defaults:f}),h("design:paramtypes",[E.g,C.e,d.b,_.u])],m)},80910:(ge,F,n)=>{"use strict";n.d(F,{g:()=>h});var t=n(21626),e=n(7974),r=n(63831),o=n(46104),C=n(36110),E=n(26727),y=n(56081),d=n(2824),_=n(5690),v=n(54438);const b="/ws/organization/join/requests",P="/ws/user/join/requests",s="/ws/organization/user",g="/ws/organization/users";let h=(()=>{var S;class f{constructor(i,c){this.http=i,this.productService=c}getOrganizationJoinRequests(i){const c={version:1,app_productkey:this.productService.productKey,app_producttype:this.productService.productType,...i},a=new t.Nl({fromObject:{...c}});return this.http.get(b,{params:a})}acceptOrganizationJoinRequests(i){return this.batchRequest(i,a=>this.http.post(b,{version:1,app_productkey:this.productService.productKey,app_producttype:this.productService.productType,join_requests_accept:a}))}denyOrganizationJoinRequests(i){return this.batchRequest(i,a=>this.http.post(b,{version:1,app_productkey:this.productService.productKey,app_producttype:this.productService.productType,join_requests_deny:a}))}getEligibleJoinOrganizations(i){const c={version:1,app_productkey:this.productService.productKey,app_producttype:this.productService.productType,...i},a=new t.Nl({fromObject:{...c}});return this.http.get(`${P}/eligibility`,{params:a})}getJoinRequests(i){const c={version:1,app_productkey:this.productService.productKey,app_producttype:this.productService.productType,...i},a=new t.Nl({fromObject:{...c}});return this.http.get(P,{params:a})}postJoinRequest(i,c){return this.http.post(P,{version:1,app_productkey:this.productService.productKey,app_producttype:this.productService.productType,organization_id:i,request_desc:c})}deleteJoinRequest(i){return this.http.request("delete",P,{body:{version:1,app_productkey:this.productService.productKey,app_producttype:this.productService.productType,join_request_key:i}})}getOrganizationUsers(i){const c=d.V(i);return this.http.get(`${g}${c}`).pipe((0,C.T)(a=>a.users),(0,C.T)(a=>a.map(l=>({...l,user_role:(0,y.t9)(l.user_role)}))))}getOrganizationInvites(i){const c=d.V(i);return this.http.get(`/ws/organization/invite${c}`).pipe((0,C.T)(a=>a.invites),(0,C.T)(a=>a.map(l=>({...l,invite_user:{...l.inviter_user,user_role:(0,y.t9)(l.inviter_user.user_role)},invitee_user:{...l.invitee_user,user_role:(0,y.t9)(l.invitee_user.user_role)}}))))}sendOrganizationInvites(i,c,a){return this.http.post("/ws/organization/invite",{version:2,group_eid:i,invite_emails:c,site_verify_response:a}).pipe((0,C.T)(l=>{const{messages:p}=l.results_summary;return p}))}addUserToOrganization(i){return this.http.post(`${s}/add`,{group_eid:i})}addUserWithGroupCode(i){return this.http.post(`${s}/add`,{group_code:i}).pipe((0,C.T)(c=>c.organization_name))}updateUserRoles(i,c){return this.batchRequest(c,l=>this.http.post(g,{group_id:i,update_users:l.map(p=>({user_id:p.userId,role_id:p.roleId}))}))}removeUser(i){return this.http.post(`${s}/leave`,{version:1,app_productkey:this.productService.productKey,app_producttype:this.productService.productType,group_id:i})}removeUsers(i,c){return this.batchRequest(c,l=>this.http.post(g,{group_id:i,remove_users:l.map(p=>this.createTransferRequest(p))}))}transferUserContent(i,c){return this.batchRequest(c,l=>this.http.post("/ws/organization/bookmark/transfer",{group_id:i,transfer_bookmarks:l.map(p=>this.createTransferRequest(p))}))}createUserDisplayModel(i,c,a){return{name:this.formatUserName(i),initials:this.formatBadgeLabel(i),email:i.user_email,id:i.user_id,role:i.user_role,activeDeveloper:this.hasActiveDeveloperAccount(i),selected:!1,invitationStatus:c,joinRequestKey:a}}isUserModel(i){return["developer_account","developer_account_active","developer_has_apps"].every(a=>i.hasOwnProperty(a))}hasActiveDeveloperAccount(i){return!!this.isUserModel(i)&&i.developer_account&&i.developer_account_active&&i.developer_has_apps}batchRequest(i,c){let a=0;const l=[];for(;a<i.length;){const A=i.slice(a,a+50);l.push(c(A)),a+=50}const p=(0,e.c)(l,r.T).pipe((0,E.K)());return(0,o.p)(p).pipe((0,C.T)(()=>!0))}createTransferRequest(i){const{sourceUserId:c,targetUserId:a}=i;return"number"==typeof a?{user_id:c,group_bookmarks:{transfer_ownership:1,transfer_user_id:a}}:{user_id:c}}formatUserName(i){const{user_first_name:c,user_last_name:a}=i,l=[c,a].filter(p=>!!p);return l.length>0?l.join(" "):""}formatBadgeLabel(i){const{user_first_name:c,user_last_name:a}=i;return[c,a].filter(p=>!!p).map(p=>p[0]).join("")}}return(S=f).\u0275fac=function(i){return new(i||S)(v.KVO(t.Qq),v.KVO(_.b))},S.\u0275prov=v.jDH({token:S,factory:S.\u0275fac,providedIn:"root"}),f})()},30607:(ge,F,n)=>{"use strict";n.d(F,{k:()=>g});var t=n(65763),e=n(65294),r=n(7431),o=n(24552),C=n(43753),E=n(76016),y=n(87710),d=n(94495),_=n(51529),v=n(39358),b=n(13181),P=n(54438),s=n(83621);let g=(()=>{var u;class h{constructor(f,m,i){this.store=f,this.viewService=m,this.applicationEventService=i}startQuiz(){this.viewService.toggleColumn(!0),this.viewService.toggleLabels(!1),this.viewService.toggleLayers(!1),this.viewService.clearFadedNodes(),this.viewService.clearSelectedNodes(),this.store.dispatch(new r.nW),this.viewService.setContentMode(_.G.Quiz),this.store.dispatch(new E.B.SetQuizActive(!0));const f=this.store.selectSnapshot(y.j.getAllQuestions)[0].id;this.store.dispatch(new E.B.SetActiveQuestion(f))}resetQuiz(){this.viewService.clearFadedNodes(),this.viewService.clearSelectedNodes(),this.store.dispatch(new r.nW),this.store.dispatch(new E.B.SetQuizActive(!1)),this.store.dispatch(new E.B.SetActiveSubmission(void 0)),this.store.dispatch(new E.B.ClearSubmissions),this.store.dispatch(new E.B.SetQuizLifecycle(o.h.Question))}exitQuiz(){this.resetQuiz(),this.viewService.setContentMode(_.G.ChapterInfo),this.viewService.toggleLabels(!0),this.viewService.toggleDrawer(b.Q.Hide),setTimeout(()=>{this.store.dispatch(new r.Ih(this.store.selectSnapshot(d.N.getChapterCamera),!1))})}submitQuestion(f,m){const i=this.store.selectSnapshot(y.j.getAllQuestions).find(p=>p.id===f),{launchMode:c,quizSettings:a}=this.store.selectSnapshot(y.j);this.store.dispatch(new E.B.SubmitQuestionAnswer({questionId:i.id,answer:m})),this.store.dispatch(new E.B.SetActiveSubmission({questionId:i.id,answer:m})),this.applicationEventService.fireEvent(e.F.QuizAnswerSubmitted,{questionId:i.id,answer:m}),c===y.W.Learning&&i.type!==C.Q5.Instructions&&!1!==a.showExplanation?this.store.dispatch(new E.B.SetQuizLifecycle(o.h.Explanation)):this.nextQuestion()}nextQuestion(){this.store.dispatch(new E.B.SetActiveSubmission(void 0)),this.store.selectSnapshot(y.j.hasQuestionRemaining)?(this.store.dispatch(new E.B.SetQuizLifecycle(o.h.Question)),this.viewService.clearFadedNodes(),this.viewService.clearSelectedNodes(),this.store.dispatch(new E.B.NextQuestion)):(this.store.dispatch(new E.B.SetQuizLifecycle(o.h.Review)),this.applicationEventService.fireEvent(e.F.QuizCompleted,!0))}}return(u=h).\u0275fac=function(f){return new(f||u)(P.KVO(t.il),P.KVO(v.z),P.KVO(s.S))},u.\u0275prov=P.jDH({token:u,factory:u.\u0275fac,providedIn:"root"}),h})()},39898:(ge,F,n)=>{"use strict";n.d(F,{J:()=>t});var t=function(e){return e[e.Basics=0]="Basics",e[e.All=1]="All",e[e.Shortcuts=2]="Shortcuts",e}(t||{})},65855:(ge,F,n)=>{"use strict";n.d(F,{i:()=>t});var t=function(e){return e.None="none",e.Play="play",e.Button="button",e.Hand="hand",e.Summary="summary",e}(t||{})},51529:(ge,F,n)=>{"use strict";n.d(F,{G:()=>t});var t=function(e){return e.NodeInfo="nodeInfo",e.LabelInfo="labelInfo",e.ChapterInfo="chapterInfo",e.Quiz="Quiz",e.Search="Search",e.VisibilityLayers="VisibilityLayers",e}(t||{})},79083:(ge,F,n)=>{"use strict";n.d(F,{H:()=>t});var t=function(e){return e.BioDigital="biodigital",e.Wikipedia="wikipedia",e.NCIT="ncit",e}(t||{})},47932:(ge,F,n)=>{"use strict";n.d(F,{A:()=>t});var t=function(e){return e.Mouse="mouse",e.Touch="touch",e}(t||{})},3057:(ge,F,n)=>{"use strict";n.d(F,{o:()=>t});var t=function(e){return e[e.Default=0]="Default",e.DrawerOnly="drawer",e.ColumnOnly="column",e}(t||{})},62949:(ge,F,n)=>{"use strict";n.d(F,{G:()=>t});var t=function(e){return e.Drawer="drawer",e.Column="column",e}(t||{})},96557:(ge,F,n)=>{"use strict";n.d(F,{aD:()=>r,ij:()=>C,kF:()=>E});var t=n(24418),e=n(27180),r=function(y){return y.None="none",y.Circle="circle",y.Bar="bar",y}(r||{});const C=r.Bar,E=t.c.application===e.c.Viewer?C:r.Circle},47125:(ge,F,n)=>{"use strict";n.d(F,{R:()=>t});var t=function(r){return r.Enabled="enabled",r.Disabled="disabled",r.Locked="locked",r}(t||{})},13181:(ge,F,n)=>{"use strict";n.d(F,{Q:()=>t});var t=function(e){return e.Hide="hide",e.Show="show",e.Collapse="collapse",e}(t||{})},93822:(ge,F,n)=>{"use strict";n.d(F,{U:()=>t});var t=function(e){return e.AnatomyLabels="anatomyLabels",e.Audio="audio",e.Camera="camera",e.Column="column",e.ColumnToggle="columnToggle",e.ContextActions="contextActions",e.ContextMenu="contextMenu",e.Description="description",e.Drawer="drawer",e.DrawerToggle="drawerToggle",e.DrawerExpanded="drawerExpanded",e.Fullscreen="fullscreen",e.Help="help",e.LabelList="labelList",e.Labels="labels",e.VisibilityLayers="visibilityLayers",e.VisibilityLayersMode="visibilityLayersMode",e.SkinLayers="skinLayers",e.Layout="layout",e.Legend="legend",e.Loader="loader",e.Logo="logo",e.Media="media",e.ToolbarOverflow="toolbarOverflow",e.NodeInfo="nodeInfo",e.NodeAudio="nodeAudio",e.Pagination="pagination",e.Playthrough="playthrough",e.QuizPrompt="quizPrompt",e.Search="search",e.TitleOnly="titleOnly",e.ToggleLabels="toggleLabels",e.Toolbar="toolbar",e.Tools="tools",e.Tutorial="tutorial",e.Undo="undo",e.Whiteboard="whiteboard",e}(t||{})},17276:(ge,F,n)=>{"use strict";n.d(F,{U:()=>t});var t=function(e){return e[e.OnDemand=0]="OnDemand",e[e.Interact=1]="Interact",e[e.Loader=2]="Loader",e[e.Tutorial=3]="Tutorial",e[e.Whiteboard=4]="Whiteboard",e[e.Help=5]="Help",e}(t||{})},55671:(ge,F,n)=>{"use strict";n.d(F,{D:()=>t});var t=function(r){return r.Text="text",r.Paint="paint",r.Erase="erase",r}(t||{})},50677:(ge,F,n)=>{"use strict";var t,e;n.d(F,{p:()=>t}),(e=t||(t={})).ToggleVisible=(()=>{class y{constructor(_){this.settings=_}}return y.type="[ViewUI] Toggle Visible",y})(),e.SetUI=(()=>{class y{constructor(_){this.ui=_}}return y.type="[ViewUI] Set UI",y})(),e.SetInitialUI=(()=>{class y{constructor(_){this.ui=_}}return y.type="[ViewUI] Set Initial UI",y})()},51640:(ge,F,n)=>{"use strict";n.d(F,{dF:()=>p,p2:()=>c});var t=n(65763),e=n(13181),r=n(93822),o=n(28722),C=n(96557),E=n(11876);class y{constructor(O=e.Q.Hide,L=!0){this.status=O,this.enable=L}}class d extends y{constructor(O){super(),this.userStatusPreference=O}}var S,i,u=n(50677),h=n(54438),f=function(A,O,L,k){var j,q=arguments.length,B=q<3?O:null===k?k=Object.getOwnPropertyDescriptor(O,L):k;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)B=Reflect.decorate(A,O,L,k);else for(var V=A.length-1;V>=0;V--)(j=A[V])&&(B=(q<3?j(B):q>3?j(O,L,B):j(O,L))||B);return q>3&&B&&Object.defineProperty(O,L,B),B},m=function(A,O){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(A,O)};const c={[r.U.Audio]:new y,[r.U.AnatomyLabels]:new y,[r.U.Camera]:new y,[r.U.Column]:new d(null),[r.U.ColumnToggle]:new y,[r.U.ContextActions]:new y,[r.U.ContextMenu]:new y(e.Q.Show,!0),[r.U.Description]:new y,[r.U.Drawer]:new class _ extends d{constructor(){super(...arguments),this.isExpandedInitially=!1}}(null),[r.U.DrawerToggle]:new y,[r.U.Fullscreen]:new y,[r.U.Help]:new y,[r.U.Labels]:new class s extends y{constructor(O=!0){super(),this.shown=O}},[r.U.LabelList]:new y(e.Q.Show,!1),[r.U.Legend]:new y,[r.U.Loader]:new class P extends y{constructor(O=C.kF){super(),this.template=O}},[r.U.Logo]:new class v extends y{constructor(O=!0){super(),this.isHyperLink=O}},[r.U.Media]:new class b extends y{constructor(O=o.Y.Full,L=e.Q.Hide){super(L),this.template=O,this.status=L}},[r.U.NodeInfo]:new y(e.Q.Hide,!1),[r.U.NodeAudio]:new y,[r.U.Playthrough]:new y(e.Q.Hide,!1),[r.U.Pagination]:new y,[r.U.QuizPrompt]:new y,[r.U.Search]:new y,[r.U.TitleOnly]:new y,[r.U.ToggleLabels]:new y,[r.U.Toolbar]:new y,[r.U.ToolbarOverflow]:new y(e.Q.Show,!1),[r.U.Tools]:new y,[r.U.Tutorial]:new y(e.Q.Hide,!1),[r.U.Undo]:new y,[r.U.VisibilityLayers]:new class g extends y{constructor(O=E.Z.Single){super(),this.layersMode=O}},[r.U.SkinLayers]:new y(e.Q.Show,!0),[r.U.Whiteboard]:new y};class a{}const l={visible:{[r.U.Audio]:!1,[r.U.AnatomyLabels]:!1,[r.U.Camera]:!1,[r.U.Column]:!1,[r.U.ColumnToggle]:!1,[r.U.ContextActions]:!1,[r.U.Description]:!1,[r.U.Drawer]:!1,[r.U.DrawerToggle]:!1,[r.U.Fullscreen]:!1,[r.U.Help]:!1,[r.U.Labels]:!1,[r.U.LabelList]:!1,[r.U.Legend]:!1,[r.U.Logo]:!1,[r.U.Media]:!1,[r.U.ToolbarOverflow]:!1,[r.U.NodeInfo]:!1,[r.U.NodeAudio]:!1,[r.U.Pagination]:!1,[r.U.Playthrough]:!1,[r.U.QuizPrompt]:!1,[r.U.Search]:!1,[r.U.ToggleLabels]:!1,[r.U.TitleOnly]:!1,[r.U.Toolbar]:!1,[r.U.Tools]:!1,[r.U.Tutorial]:!1,[r.U.Undo]:!1,[r.U.VisibilityLayers]:!1,[r.U.SkinLayers]:!1,[r.U.Whiteboard]:!1},ui:c,initialUI:c};let p=(i=S=class{static getVisible(O){return(0,t.Mz)([i],L=>L.visible[O])}static getUIEntry(O){return(0,t.Mz)([i],L=>L.ui[O])}static getSearchStatus(O){return O.ui.search.status}static getUI(O){return O.ui}static getInitialUI(O){return O.initialUI}toggleVisible(O,L){const k=O.getState().visible;Object.entries(L.settings).forEach(([q,B])=>{k[q]=B}),O.patchState({visible:k})}setUI(O,L){const k=O.getState().ui;O.patchState({ui:{...k,...L.ui}})}setInitialUI(O,L){const k=O.getState().ui;O.patchState({initialUI:{...k,...L.ui}})}},S.\u0275fac=function(O){return new(O||S)},S.\u0275prov=h.jDH({token:S,factory:S.\u0275fac}),S);f([(0,t.rc)(u.p.ToggleVisible),m("design:type",Function),m("design:paramtypes",[Object,u.p.ToggleVisible]),m("design:returntype",void 0)],p.prototype,"toggleVisible",null),f([(0,t.rc)(u.p.SetUI),m("design:type",Function),m("design:paramtypes",[Object,u.p.SetUI]),m("design:returntype",void 0)],p.prototype,"setUI",null),f([(0,t.rc)(u.p.SetUI),m("design:type",Function),m("design:paramtypes",[Object,u.p.SetUI]),m("design:returntype",void 0)],p.prototype,"setInitialUI",null),f([(0,t.MD)(),m("design:type",Function),m("design:paramtypes",[a]),m("design:returntype",void 0)],p,"getSearchStatus",null),f([(0,t.MD)(),m("design:type",Function),m("design:paramtypes",[a]),m("design:returntype",void 0)],p,"getUI",null),f([(0,t.MD)(),m("design:type",Function),m("design:paramtypes",[a]),m("design:returntype",void 0)],p,"getInitialUI",null),p=i=f([(0,t.Uw)({name:"viewUI",defaults:l})],p)},93132:(ge,F,n)=>{"use strict";n.d(F,{B:()=>e});var e,r,t=n(39898);(r=e||(e={})).SetAutoplay=(()=>{class Y{constructor(se){this.autoplay=se}}return Y.type="[View] Set Autoplay",Y})(),r.SetContentMode=(()=>{class Y{constructor(se){this.column=se}}return Y.type="[View] Set Content Mode",Y})(),r.SetCanHover=(()=>{class Y{constructor(se){this.canHover=se}}return Y.type="[View] Set Can Hover",Y})(),r.SetCanTouch=(()=>{class Y{constructor(se){this.canTouch=se}}return Y.type="[View] Set Can Touch",Y})(),r.SetCanFullscreen=(()=>{class Y{constructor(se){this.canFullscreen=se}}return Y.type="[View] Set Can Fullscreen",Y})(),r.SetInputEnabled=(()=>{class Y{constructor(se){this.enabled=se}}return Y.type="[View] Set Input Enabled",Y})(),r.SetSearchDisplayMode=(()=>{class Y{constructor(se){this.mode=se}}return Y.type="[View] Set Search Display Mode",Y})(),r.TogglePresentation=(()=>{class Y{constructor(se){this.active=se}}return Y.type="[View] Toggle Presentation",Y})(),r.SetInteractType=(()=>{class Y{constructor(se){this.interactType=se}}return Y.type="[View] Set Interact Type",Y})(),r.SetForceAudio=(()=>{class Y{constructor(se){this.forceAudio=se}}return Y.type="[View] Set Force Audio",Y})(),r.SetOnDemand=(()=>{class Y{constructor(se){this.onDemand=se}}return Y.type="[View] Set On Demand",Y})(),r.SetLayout=(()=>{class Y{constructor(se){this.layout=se}}return Y.type="[View] Set Layout",Y})(),r.ToggleHelpTab=(()=>{class Y{constructor(se=t.J.Basics){this.tab=se}}return Y.type="[View] Toggle Help Tab",Y})(),r.SetInputMode=(()=>{class Y{constructor(se){this.inputMode=se}}return Y.type="[View] Set Input Mode",Y})(),r.SetTutorial=(()=>{class Y{constructor(se){this.tutorial=se}}return Y.type="[View] Set Tutorial",Y})(),r.SetIsMobileWeb=(()=>{class Y{constructor(se){this.isMobileWeb=se}}return Y.type="[View] Set Is Mobile Web",Y})(),r.StartTutorial=(()=>{class Y{constructor(se){this.intro=se}}return Y.type="[View] Start Tutorial",Y})(),r.TutorialSeen=(()=>{class Y{constructor(se){this.seen=se}}return Y.type="[View] Tutorial Seen",Y})(),r.TutorialNext=(()=>{class Y{constructor(){}}return Y.type="[View] Tutorial Next",Y})(),r.TutorialPrevious=(()=>{class Y{constructor(){}}return Y.type="[View] Tutorial Previous",Y})(),r.ToggleNodeInfo=(()=>{class Y{constructor(se){this.show=se}}return Y.type="[View] Toggle Node Info",Y})(),r.TogglePanel=(()=>{class Y{constructor(se,oe){this.panel=se,this.show=oe}}return Y.type="[View] Toggle Panel",Y})(),r.SetViewLanguage=(()=>{class Y{constructor(se){this.lang=se}}return Y.type="[View] Set View Language",Y})(),r.SetNodeInfoConfig=(()=>{class Y{constructor(se){this.fallback=se}}return Y.type="[View] Set Node Info Config",Y})(),r.SetMultiPickModeEnabled=(()=>{class Y{constructor(se){this.enabled=se}}return Y.type="[View] Set multi pick mode enabled",Y})(),r.SetLabelBreakpoint=(()=>{class Y{constructor(se){this.labelsBreakpoint=se}}return Y.type="[View] Set Label Breakpoint",Y})(),r.SetPlaythrough=(()=>{class Y{constructor(se){this.playthrough=se}}return Y.type="[View] Set Playthrough",Y})(),r.SetPlaythroughEnabled=(()=>{class Y{constructor(se){this.enabled=se}}return Y.type="[View] Set Playthrough Enabled",Y})(),r.SetStartingColumn=(()=>{class Y{constructor(se){this.column=se}}return Y.type="[View] Set Starting Column",Y})(),r.SetPreferredColumn=(()=>{class Y{constructor(se){this.column=se}}return Y.type="[View] Set Preferred Column",Y})(),r.SetStartingTool=(()=>{class Y{constructor(se){this.tool=se}}return Y.type="[View] Set Starting Tool",Y})(),r.SetFadeout=(()=>{class Y{constructor(se){this.fadeout=se}}return Y.type="[View] Set Fadeout",Y})(),r.SetPreventFadeoutEvent=(()=>{class Y{constructor(se,oe){this.event=se,this.value=oe}}return Y.type="[View] Set Prevent Fadeout Event",Y})(),r.SetUsePrintImage=(()=>{class Y{constructor(se){this.usePrintImage=se}}return Y.type="[View] Set Use Print Image",Y})(),r.SetWindows=(()=>{class Y{constructor(se){this.windows=se}}return Y.type="[View] Set Windows",Y})(),r.OpenWindow=(()=>{class Y{constructor(se){this.window=se}}return Y.type="[View] Open Window",Y})(),r.CloseWindow=(()=>{class Y{constructor(se){this.window=se}}return Y.type="[View] Close Window",Y})(),r.ToggleWindow=(()=>{class Y{constructor(se,oe){this.window=se,this.show=oe}}return Y.type="[View] Toggle Window",Y})(),r.ToggleMenu=(()=>{class Y{constructor(se){this.open=se}}return Y.type="[View] Toggle Menu",Y})(),r.SetWhiteboardEnabled=(()=>{class Y{constructor(se){this.enabled=se}}return Y.type="[View] Whiteboard Enabled",Y})(),r.SetWhiteboardLocked=(()=>{class Y{constructor(se){this.locked=se}}return Y.type="[View] Whiteboard locked",Y})(),r.SetWhiteboardBrushSize=(()=>{class Y{constructor(se){this.brushSize=se}}return Y.type="[View] Whiteboard Brush Size",Y})(),r.SetWhiteboardBrushColor=(()=>{class Y{constructor(se){this.brushColor=se}}return Y.type="[View] Whiteboard Brush Color",Y})(),r.SetWhiteboardTextSize=(()=>{class Y{constructor(se){this.size=se}}return Y.type="[View] Whiteboard Text Size",Y})(),r.SetWhiteboardEraserSize=(()=>{class Y{constructor(se){this.eraserSize=se}}return Y.type="[View] Whiteboard Eraser Size",Y})(),r.SetWhiteboardAnnotateMode=(()=>{class Y{constructor(se){this.mode=se}}return Y.type="[View] Whiteboard Annotate Mode",Y})(),r.SetWhiteboardHasPaint=(()=>{class Y{constructor(se){this.hasPaint=se}}return Y.type="[View] Whiteboard Has Paint",Y})(),r.SetWhiteboardHasText=(()=>{class Y{constructor(se){this.hasText=se}}return Y.type="[View] Whiteboard Has Text",Y})(),r.ShowScrim=(()=>{class Y{constructor(se,oe){this.showSpinner=se,this.label=oe}}return Y.type="[View] Show Scrim",Y})(),r.HideScrim=(()=>{class Y{constructor(){}}return Y.type="[View] Hide Scrim",Y})(),r.SetChapterCallToActionSeen=(()=>{class Y{constructor(se){this.chapterCallToActionSeen=se}}return Y.type="[View] Set Chapter Call To Action Seen",Y})(),r.ResetViewState=(()=>{class Y{constructor(){}}return Y.type="[View] Reset View State",Y})(),r.SetFocusedElement=(()=>{class Y{constructor(se){this.focusedElement=se}}return Y.type="[View] Set Focused Element",Y})()},26463:(ge,F,n)=>{"use strict";n.d(F,{Pf:()=>p});var f,c,t=n(65763),e=n(93132),r=n(87947),o=n(65855),C=n(17276),E=n(39898),y=n(55671),d=n(46107),_=n(47932),v=n(3057),b=n(17215),P=n(79083),s=n(18272),g=n(51529),h=n(49204),S=n(54438),m=function(A,O,L,k){var j,q=arguments.length,B=q<3?O:null===k?k=Object.getOwnPropertyDescriptor(O,L):k;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)B=Reflect.decorate(A,O,L,k);else for(var V=A.length-1;V>=0;V--)(j=A[V])&&(B=(q<3?j(B):q>3?j(O,L,B):j(O,L))||B);return q>3&&B&&Object.defineProperty(O,L,B),B},i=function(A,O){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(A,O)};class a{}const l={autoplay:!1,contentMode:g.G.ChapterInfo,lang:"en",canFullscreen:!1,canHover:!1,canTouch:!1,drawerCoversContent:!1,fadeout:3e3,preventFadeoutEvents:{mouseenter:!1,focusin:!1,overlay:!1},forceAudio:!1,fullscreenActive:!1,help:{tab:E.J.Basics},inputEnabled:!0,inputMode:_.A.Mouse,interactType:o.i.Play,isMobileWeb:!1,onDemand:!1,layout:v.o.Default,labelsBreakpoint:480,menuOpen:!1,multiPickModeEnabled:!1,openWindows:[C.U.Loader],openPanels:new Set,playthroughSettings:{enabled:!1,countdown:3e3,countdownDelay:2e3,forceAudio:!0,loop:!1,minimum:1e4},presentationActive:!1,searchDisplayMode:s.q.List,startingColumn:"info",preferredColumn:null,startingTool:null,nodeInfo:{show:!1,fallback:P.H.Wikipedia},tutorial:{pageSize:0,pageIndex:-1},tutorialSeen:!0,usePrintImage:!1,whiteboard:{enabled:!1,locked:!1,hasPaint:!1,hasText:!1,brushSize:d.iw.size,brushColor:d._T.color,textSize:d.H6.size,eraserSize:d.Om.size,annotateMode:y.D.Paint},scrim:{show:!1,label:""},chapterCallToActionSeen:!1};let p=(c=f=class{static getAutoplay(O){return O.autoplay}static getContentMode(O){return O.contentMode}static getLabelsBreakpoint(O){return O.labelsBreakpoint}static getInputEnabled(O){return O.inputEnabled}static getIsMobileWeb(O){return O.isMobileWeb}static getFullscreenActive(O){return O.fullscreenActive}static getPresentationActive(O){return O.presentationActive}static getDrawerCoversContent(O){return O.drawerCoversContent}static getShowNodeInfo(O){return O.nodeInfo.show}static getNodeInfoFallback(O){return O.nodeInfo.fallback}static getOpenPanels(O){return O.openPanels}static isOpenPanel(O){return(0,t.Mz)([c],L=>L.openPanels.has(O))}static getViewLanguage(O){return O.lang}static getInteractType(O){return O.interactType}static getForceAudio(O){return O.forceAudio}static getOnDemand(O){return O.onDemand}static getFadeout(O){return O.fadeout}static getFadeoutPaused(O){return O.preventFadeoutEvents.mouseenter||O.preventFadeoutEvents.focusin||O.preventFadeoutEvents.overlay}static getPlaythroughSettings(O){return O.playthroughSettings}static getPlaythroughEnabled(O){return O.playthroughSettings.enabled}static getPreferredColumn(O){return O.preferredColumn}static getStartingColumn(O){return O.startingColumn}static getFocusedElement(O){return O.focusedElement}static getStartingTool(O){return O.startingTool}static getLayout(O){return O.layout}static getInputMode(O){return O.inputMode}static getShowHelpTab(O){return O.help.tab}static getTutorial(O){return O.tutorial}static getTutorialSeen(O){return O.tutorialSeen}static getWhiteboardEnabled(O){return O.whiteboard.enabled}static isWhiteboardLocked(O){return O.whiteboard.locked}static getWhiteboardBrushSize(O){return O.whiteboard.brushSize}static getWhiteboardTextSize(O){return O.whiteboard.textSize}static getWhiteboardEraserSize(O){return O.whiteboard.eraserSize}static getWhiteboardAnnotateMode(O){return O.whiteboard.annotateMode}static getWhiteboardBrushColor(O){return O.whiteboard.brushColor}static getWhiteboardHasPaint(O){return O.whiteboard.hasPaint}static getWhiteboardHasText(O){return O.whiteboard.hasText}static getCanTouch(O){return O.canTouch}static getCanHover(O){return O.canHover}static getMultiPickModeEnabled(O){return O.multiPickModeEnabled}static getSearchDisplayMode(O){return O.searchDisplayMode}static getUsePrintImage(O){return O.usePrintImage}static getOpenWindow(O){return O.openWindows.length>0?O.openWindows.sort()[0]:null}static getMenuOpen(O){return O.menuOpen}static getScrim(O){return O.scrim}static getChapterCallToActionSeen(O){return O.chapterCallToActionSeen}static shouldWindowOpen(O){return(0,t.Mz)([c],L=>L.openWindows.indexOf(O)>=0)}setAutoplay(O,L){O.patchState({autoplay:L.autoplay})}setContentMode(O,L){O.patchState({contentMode:L.column})}setInputEnabled(O,L){O.patchState({inputEnabled:L.enabled})}setCanHover(O,L){O.patchState({canHover:L.canHover})}setCanTouch(O,L){O.patchState({canTouch:L.canTouch})}setCanFullscreen(O,L){O.patchState({canFullscreen:L.canFullscreen})}setSearchDisplayMode(O,L){O.patchState({searchDisplayMode:L.mode})}setViewLanguage(O,{lang:L}){O.patchState({lang:L})}toggleNodeInfo(O,{show:L}){O.patchState({nodeInfo:{...O.getState().nodeInfo,show:L}})}setNodeInfoConfig(O,{fallback:L}){O.patchState({nodeInfo:{...O.getState().nodeInfo,fallback:L}})}togglePanel(O,L){const k=O.getState().openPanels;((0,h.isNil)(L.show)?!k.has(L.panel):L.show)?k.add(L.panel):k.delete(L.panel),O.patchState({openPanels:k})}togglePresentation(O,L){O.patchState({presentationActive:L.active})}toggleHelp(O,L){O.patchState({help:{tab:L.tab}})}setFadeout(O,L){O.patchState({fadeout:L.fadeout})}addPreventFadeoutElement(O,L){const k=O.getState().preventFadeoutEvents;k[L.event]=L.value,O.patchState({preventFadeoutEvents:{...k}})}setPlaythrough(O,L){const k=O.getState().playthroughSettings;(0,h.mergeWith)(k,L.playthrough,(q,B)=>{if(!(0,h.isNil)(B))return B}),O.patchState({playthroughSettings:k})}setPlaythroughEnabled(O,L){let k=O.getState().playthroughSettings;k={...k,enabled:L.enabled},O.patchState({playthroughSettings:k})}setStartingColumn(O,L){O.patchState({startingColumn:L.column})}setPreferredColumn(O,L){O.patchState({preferredColumn:L.column})}setStartingTool(O,L){O.patchState({startingTool:L.tool})}setLoaderType(O,L){O.patchState({interactType:L.interactType})}setForceAudio(O,L){O.patchState({forceAudio:L.forceAudio})}setOnDemand(O,L){O.patchState({onDemand:L.onDemand})}setInputMode(O,{inputMode:L}){O.patchState({inputMode:L})}SetLayout(O,L){O.patchState({layout:L.layout})}setTutorial(O,L){const k=O.getState().tutorial;O.patchState({tutorial:{...k,...L.tutorial}})}startTutorial(O,L){O.patchState({tutorial:{...O.getState().tutorial,pageIndex:L.intro?-1:0}}),O.dispatch(new e.B.TutorialSeen(!0))}tutorialSeen(O,L){this.storageService.setLocalItem(b.UT.GettingStartedTutorial,L.seen),O.patchState({tutorialSeen:L.seen})}tutorialPrevious(O,L){const k=O.getState().tutorial,q=Math.max(k.pageIndex-1,0);O.dispatch(new e.B.SetTutorial({...k,pageIndex:q}))}tutorialNext(O,L){const k=O.getState().tutorial,q=Math.min(k.pageIndex+1,k.pageSize-1);O.dispatch(new e.B.SetTutorial({...k,pageIndex:q}))}setWhiteboardEnabled(O,{enabled:L}){O.patchState({whiteboard:{...O.getState().whiteboard,enabled:L}})}setWhiteboardLocked(O,{locked:L}){O.patchState({whiteboard:{...O.getState().whiteboard,locked:L}})}setWhiteboardBrushSize(O,{brushSize:L}){O.patchState({whiteboard:{...O.getState().whiteboard,brushSize:L}})}setWhiteboardTextSize(O,{size:L}){O.patchState({whiteboard:{...O.getState().whiteboard,textSize:L}})}setWhiteboardEraserSize(O,{eraserSize:L}){O.patchState({whiteboard:{...O.getState().whiteboard,eraserSize:L}})}setWhiteboardAnnotateMode(O,{mode:L}){O.patchState({whiteboard:{...O.getState().whiteboard,annotateMode:L}})}setWhiteboardBrushColor(O,{brushColor:L}){O.patchState({whiteboard:{...O.getState().whiteboard,brushColor:L}})}setWhiteboardHasPaint(O,{hasPaint:L}){O.patchState({whiteboard:{...O.getState().whiteboard,hasPaint:L}})}setWhiteboardHasText(O,{hasText:L}){O.patchState({whiteboard:{...O.getState().whiteboard,hasText:L}})}setMultiPickModeEnabled(O,L){O.patchState({multiPickModeEnabled:L.enabled})}setLabelBreakpoint(O,L){O.patchState({labelsBreakpoint:L.labelsBreakpoint})}setUsePrintImage(O,L){O.patchState({usePrintImage:L.usePrintImage})}setWindows(O,L){O.patchState({openWindows:L.windows})}setIsMobileWeb(O,L){O.patchState({isMobileWeb:L.isMobileWeb})}openWindow(O,L){const k=O.getState().openWindows;k.indexOf(L.window)<0&&O.patchState({openWindows:[L.window,...k]})}closeWindow(O,L){let k=O.getState().openWindows;null!=L.window?k=k.filter(q=>q!==L.window):k.shift(),O.patchState({openWindows:[...k]})}toggleWindow(O,L){const k=O.getState().openWindows.indexOf(L.window)>=0;O.dispatch((null!=L.show?L.show:!k)?new e.B.OpenWindow(L.window):new e.B.CloseWindow(L.window))}toggleMenu(O,L){O.patchState({menuOpen:L.open})}showScrim(O,L){O.patchState({scrim:{show:!0,label:L.label}})}hideScrim(O,L){O.patchState({scrim:{show:!1,label:""}})}setChapterCallToActionSeen(O,L){O.patchState({chapterCallToActionSeen:L.chapterCallToActionSeen})}ResetViewState(O,L){O.setState({...l})}setFocusedElement(O,L){O.patchState({focusedElement:L.focusedElement})}constructor(O){this.storageService=O}ngxsOnInit(O){r.g.onFullscreenChange().subscribe(L=>{O.patchState({fullscreenActive:L})}),O.patchState({tutorialSeen:this.storageService.getLocalJSON(b.UT.GettingStartedTutorial)||!1})}},f.\u0275fac=function(O){return new(O||f)(S.KVO(b.n$))},f.\u0275prov=S.jDH({token:f,factory:f.\u0275fac}),f);m([(0,t.rc)(e.B.SetAutoplay),i("design:type",Function),i("design:paramtypes",[Object,e.B.SetAutoplay]),i("design:returntype",void 0)],p.prototype,"setAutoplay",null),m([(0,t.rc)(e.B.SetContentMode),i("design:type",Function),i("design:paramtypes",[Object,e.B.SetContentMode]),i("design:returntype",void 0)],p.prototype,"setContentMode",null),m([(0,t.rc)(e.B.SetInputEnabled),i("design:type",Function),i("design:paramtypes",[Object,e.B.SetInputEnabled]),i("design:returntype",void 0)],p.prototype,"setInputEnabled",null),m([(0,t.rc)(e.B.SetCanHover),i("design:type",Function),i("design:paramtypes",[Object,e.B.SetCanHover]),i("design:returntype",void 0)],p.prototype,"setCanHover",null),m([(0,t.rc)(e.B.SetCanTouch),i("design:type",Function),i("design:paramtypes",[Object,e.B.SetCanTouch]),i("design:returntype",void 0)],p.prototype,"setCanTouch",null),m([(0,t.rc)(e.B.SetCanFullscreen),i("design:type",Function),i("design:paramtypes",[Object,e.B.SetCanFullscreen]),i("design:returntype",void 0)],p.prototype,"setCanFullscreen",null),m([(0,t.rc)(e.B.SetSearchDisplayMode),i("design:type",Function),i("design:paramtypes",[Object,e.B.SetSearchDisplayMode]),i("design:returntype",void 0)],p.prototype,"setSearchDisplayMode",null),m([(0,t.rc)(e.B.SetViewLanguage),i("design:type",Function),i("design:paramtypes",[Object,e.B.SetViewLanguage]),i("design:returntype",void 0)],p.prototype,"setViewLanguage",null),m([(0,t.rc)(e.B.ToggleNodeInfo),i("design:type",Function),i("design:paramtypes",[Object,e.B.ToggleNodeInfo]),i("design:returntype",void 0)],p.prototype,"toggleNodeInfo",null),m([(0,t.rc)(e.B.SetNodeInfoConfig),i("design:type",Function),i("design:paramtypes",[Object,e.B.SetNodeInfoConfig]),i("design:returntype",void 0)],p.prototype,"setNodeInfoConfig",null),m([(0,t.rc)(e.B.TogglePanel),i("design:type",Function),i("design:paramtypes",[Object,e.B.TogglePanel]),i("design:returntype",void 0)],p.prototype,"togglePanel",null),m([(0,t.rc)(e.B.TogglePresentation),i("design:type",Function),i("design:paramtypes",[Object,e.B.TogglePresentation]),i("design:returntype",void 0)],p.prototype,"togglePresentation",null),m([(0,t.rc)(e.B.ToggleHelpTab),i("design:type",Function),i("design:paramtypes",[Object,e.B.ToggleHelpTab]),i("design:returntype",void 0)],p.prototype,"toggleHelp",null),m([(0,t.rc)(e.B.SetFadeout),i("design:type",Function),i("design:paramtypes",[Object,e.B.SetFadeout]),i("design:returntype",void 0)],p.prototype,"setFadeout",null),m([(0,t.rc)(e.B.SetPreventFadeoutEvent),i("design:type",Function),i("design:paramtypes",[Object,e.B.SetPreventFadeoutEvent]),i("design:returntype",void 0)],p.prototype,"addPreventFadeoutElement",null),m([(0,t.rc)(e.B.SetPlaythrough),i("design:type",Function),i("design:paramtypes",[Object,e.B.SetPlaythrough]),i("design:returntype",void 0)],p.prototype,"setPlaythrough",null),m([(0,t.rc)(e.B.SetPlaythroughEnabled),i("design:type",Function),i("design:paramtypes",[Object,e.B.SetPlaythroughEnabled]),i("design:returntype",void 0)],p.prototype,"setPlaythroughEnabled",null),m([(0,t.rc)(e.B.SetStartingColumn),i("design:type",Function),i("design:paramtypes",[Object,e.B.SetStartingColumn]),i("design:returntype",void 0)],p.prototype,"setStartingColumn",null),m([(0,t.rc)(e.B.SetPreferredColumn),i("design:type",Function),i("design:paramtypes",[Object,e.B.SetPreferredColumn]),i("design:returntype",void 0)],p.prototype,"setPreferredColumn",null),m([(0,t.rc)(e.B.SetStartingTool),i("design:type",Function),i("design:paramtypes",[Object,e.B.SetStartingTool]),i("design:returntype",void 0)],p.prototype,"setStartingTool",null),m([(0,t.rc)(e.B.SetInteractType),i("design:type",Function),i("design:paramtypes",[Object,e.B.SetInteractType]),i("design:returntype",void 0)],p.prototype,"setLoaderType",null),m([(0,t.rc)(e.B.SetForceAudio),i("design:type",Function),i("design:paramtypes",[Object,e.B.SetForceAudio]),i("design:returntype",void 0)],p.prototype,"setForceAudio",null),m([(0,t.rc)(e.B.SetOnDemand),i("design:type",Function),i("design:paramtypes",[Object,e.B.SetOnDemand]),i("design:returntype",void 0)],p.prototype,"setOnDemand",null),m([(0,t.rc)(e.B.SetInputMode),i("design:type",Function),i("design:paramtypes",[Object,e.B.SetInputMode]),i("design:returntype",void 0)],p.prototype,"setInputMode",null),m([(0,t.rc)(e.B.SetLayout),i("design:type",Function),i("design:paramtypes",[Object,e.B.SetLayout]),i("design:returntype",void 0)],p.prototype,"SetLayout",null),m([(0,t.rc)(e.B.SetTutorial),i("design:type",Function),i("design:paramtypes",[Object,e.B.SetTutorial]),i("design:returntype",void 0)],p.prototype,"setTutorial",null),m([(0,t.rc)(e.B.StartTutorial),i("design:type",Function),i("design:paramtypes",[Object,e.B.StartTutorial]),i("design:returntype",void 0)],p.prototype,"startTutorial",null),m([(0,t.rc)(e.B.TutorialSeen),i("design:type",Function),i("design:paramtypes",[Object,e.B.TutorialSeen]),i("design:returntype",void 0)],p.prototype,"tutorialSeen",null),m([(0,t.rc)(e.B.TutorialPrevious),i("design:type",Function),i("design:paramtypes",[Object,e.B.TutorialPrevious]),i("design:returntype",void 0)],p.prototype,"tutorialPrevious",null),m([(0,t.rc)(e.B.TutorialNext),i("design:type",Function),i("design:paramtypes",[Object,e.B.TutorialNext]),i("design:returntype",void 0)],p.prototype,"tutorialNext",null),m([(0,t.rc)(e.B.SetWhiteboardEnabled),i("design:type",Function),i("design:paramtypes",[Object,e.B.SetWhiteboardEnabled]),i("design:returntype",void 0)],p.prototype,"setWhiteboardEnabled",null),m([(0,t.rc)(e.B.SetWhiteboardLocked),i("design:type",Function),i("design:paramtypes",[Object,e.B.SetWhiteboardLocked]),i("design:returntype",void 0)],p.prototype,"setWhiteboardLocked",null),m([(0,t.rc)(e.B.SetWhiteboardBrushSize),i("design:type",Function),i("design:paramtypes",[Object,e.B.SetWhiteboardBrushSize]),i("design:returntype",void 0)],p.prototype,"setWhiteboardBrushSize",null),m([(0,t.rc)(e.B.SetWhiteboardTextSize),i("design:type",Function),i("design:paramtypes",[Object,e.B.SetWhiteboardTextSize]),i("design:returntype",void 0)],p.prototype,"setWhiteboardTextSize",null),m([(0,t.rc)(e.B.SetWhiteboardEraserSize),i("design:type",Function),i("design:paramtypes",[Object,e.B.SetWhiteboardEraserSize]),i("design:returntype",void 0)],p.prototype,"setWhiteboardEraserSize",null),m([(0,t.rc)(e.B.SetWhiteboardAnnotateMode),i("design:type",Function),i("design:paramtypes",[Object,e.B.SetWhiteboardAnnotateMode]),i("design:returntype",void 0)],p.prototype,"setWhiteboardAnnotateMode",null),m([(0,t.rc)(e.B.SetWhiteboardBrushColor),i("design:type",Function),i("design:paramtypes",[Object,e.B.SetWhiteboardBrushColor]),i("design:returntype",void 0)],p.prototype,"setWhiteboardBrushColor",null),m([(0,t.rc)(e.B.SetWhiteboardHasPaint),i("design:type",Function),i("design:paramtypes",[Object,e.B.SetWhiteboardHasPaint]),i("design:returntype",void 0)],p.prototype,"setWhiteboardHasPaint",null),m([(0,t.rc)(e.B.SetWhiteboardHasText),i("design:type",Function),i("design:paramtypes",[Object,e.B.SetWhiteboardHasText]),i("design:returntype",void 0)],p.prototype,"setWhiteboardHasText",null),m([(0,t.rc)(e.B.SetMultiPickModeEnabled),i("design:type",Function),i("design:paramtypes",[Object,e.B.SetMultiPickModeEnabled]),i("design:returntype",void 0)],p.prototype,"setMultiPickModeEnabled",null),m([(0,t.rc)(e.B.SetLabelBreakpoint),i("design:type",Function),i("design:paramtypes",[Object,e.B.SetLabelBreakpoint]),i("design:returntype",void 0)],p.prototype,"setLabelBreakpoint",null),m([(0,t.rc)(e.B.SetUsePrintImage),i("design:type",Function),i("design:paramtypes",[Object,e.B.SetUsePrintImage]),i("design:returntype",void 0)],p.prototype,"setUsePrintImage",null),m([(0,t.rc)(e.B.SetWindows),i("design:type",Function),i("design:paramtypes",[Object,e.B.SetWindows]),i("design:returntype",void 0)],p.prototype,"setWindows",null),m([(0,t.rc)(e.B.SetIsMobileWeb),i("design:type",Function),i("design:paramtypes",[Object,e.B.SetIsMobileWeb]),i("design:returntype",void 0)],p.prototype,"setIsMobileWeb",null),m([(0,t.rc)(e.B.OpenWindow),i("design:type",Function),i("design:paramtypes",[Object,e.B.OpenWindow]),i("design:returntype",void 0)],p.prototype,"openWindow",null),m([(0,t.rc)(e.B.CloseWindow),i("design:type",Function),i("design:paramtypes",[Object,e.B.CloseWindow]),i("design:returntype",void 0)],p.prototype,"closeWindow",null),m([(0,t.rc)(e.B.ToggleWindow),i("design:type",Function),i("design:paramtypes",[Object,e.B.ToggleWindow]),i("design:returntype",void 0)],p.prototype,"toggleWindow",null),m([(0,t.rc)(e.B.ToggleMenu),i("design:type",Function),i("design:paramtypes",[Object,e.B.ToggleMenu]),i("design:returntype",void 0)],p.prototype,"toggleMenu",null),m([(0,t.rc)(e.B.ShowScrim),i("design:type",Function),i("design:paramtypes",[Object,e.B.ShowScrim]),i("design:returntype",void 0)],p.prototype,"showScrim",null),m([(0,t.rc)(e.B.HideScrim),i("design:type",Function),i("design:paramtypes",[Object,e.B.HideScrim]),i("design:returntype",void 0)],p.prototype,"hideScrim",null),m([(0,t.rc)(e.B.SetChapterCallToActionSeen),i("design:type",Function),i("design:paramtypes",[Object,e.B.SetChapterCallToActionSeen]),i("design:returntype",void 0)],p.prototype,"setChapterCallToActionSeen",null),m([(0,t.rc)(e.B.ResetViewState),i("design:type",Function),i("design:paramtypes",[Object,e.B.ResetViewState]),i("design:returntype",void 0)],p.prototype,"ResetViewState",null),m([(0,t.rc)(e.B.SetFocusedElement),i("design:type",Function),i("design:paramtypes",[Object,e.B.SetFocusedElement]),i("design:returntype",void 0)],p.prototype,"setFocusedElement",null),m([(0,t.MD)(),i("design:type",Function),i("design:paramtypes",[a]),i("design:returntype",void 0)],p,"getAutoplay",null),m([(0,t.MD)(),i("design:type",Function),i("design:paramtypes",[a]),i("design:returntype",void 0)],p,"getContentMode",null),m([(0,t.MD)(),i("design:type",Function),i("design:paramtypes",[a]),i("design:returntype",void 0)],p,"getLabelsBreakpoint",null),m([(0,t.MD)(),i("design:type",Function),i("design:paramtypes",[a]),i("design:returntype",void 0)],p,"getInputEnabled",null),m([(0,t.MD)(),i("design:type",Function),i("design:paramtypes",[a]),i("design:returntype",void 0)],p,"getIsMobileWeb",null),m([(0,t.MD)(),i("design:type",Function),i("design:paramtypes",[a]),i("design:returntype",void 0)],p,"getFullscreenActive",null),m([(0,t.MD)(),i("design:type",Function),i("design:paramtypes",[a]),i("design:returntype",void 0)],p,"getPresentationActive",null),m([(0,t.MD)(),i("design:type",Function),i("design:paramtypes",[a]),i("design:returntype",void 0)],p,"getDrawerCoversContent",null),m([(0,t.MD)(),i("design:type",Function),i("design:paramtypes",[a]),i("design:returntype",void 0)],p,"getShowNodeInfo",null),m([(0,t.MD)(),i("design:type",Function),i("design:paramtypes",[a]),i("design:returntype",void 0)],p,"getNodeInfoFallback",null),m([(0,t.MD)(),i("design:type",Function),i("design:paramtypes",[a]),i("design:returntype",void 0)],p,"getOpenPanels",null),m([(0,t.MD)(),i("design:type",Function),i("design:paramtypes",[a]),i("design:returntype",void 0)],p,"getViewLanguage",null),m([(0,t.MD)(),i("design:type",Function),i("design:paramtypes",[a]),i("design:returntype",void 0)],p,"getInteractType",null),m([(0,t.MD)(),i("design:type",Function),i("design:paramtypes",[a]),i("design:returntype",void 0)],p,"getForceAudio",null),m([(0,t.MD)(),i("design:type",Function),i("design:paramtypes",[a]),i("design:returntype",void 0)],p,"getOnDemand",null),m([(0,t.MD)(),i("design:type",Function),i("design:paramtypes",[a]),i("design:returntype",void 0)],p,"getFadeout",null),m([(0,t.MD)(),i("design:type",Function),i("design:paramtypes",[a]),i("design:returntype",void 0)],p,"getFadeoutPaused",null),m([(0,t.MD)(),i("design:type",Function),i("design:paramtypes",[a]),i("design:returntype",void 0)],p,"getPlaythroughSettings",null),m([(0,t.MD)(),i("design:type",Function),i("design:paramtypes",[a]),i("design:returntype",void 0)],p,"getPlaythroughEnabled",null),m([(0,t.MD)(),i("design:type",Function),i("design:paramtypes",[a]),i("design:returntype",void 0)],p,"getPreferredColumn",null),m([(0,t.MD)(),i("design:type",Function),i("design:paramtypes",[a]),i("design:returntype",void 0)],p,"getStartingColumn",null),m([(0,t.MD)(),i("design:type",Function),i("design:paramtypes",[a]),i("design:returntype",void 0)],p,"getFocusedElement",null),m([(0,t.MD)(),i("design:type",Function),i("design:paramtypes",[a]),i("design:returntype",void 0)],p,"getStartingTool",null),m([(0,t.MD)(),i("design:type",Function),i("design:paramtypes",[a]),i("design:returntype",void 0)],p,"getLayout",null),m([(0,t.MD)(),i("design:type",Function),i("design:paramtypes",[a]),i("design:returntype",void 0)],p,"getInputMode",null),m([(0,t.MD)(),i("design:type",Function),i("design:paramtypes",[a]),i("design:returntype",void 0)],p,"getShowHelpTab",null),m([(0,t.MD)(),i("design:type",Function),i("design:paramtypes",[a]),i("design:returntype",void 0)],p,"getTutorial",null),m([(0,t.MD)(),i("design:type",Function),i("design:paramtypes",[a]),i("design:returntype",void 0)],p,"getTutorialSeen",null),m([(0,t.MD)(),i("design:type",Function),i("design:paramtypes",[a]),i("design:returntype",void 0)],p,"getWhiteboardEnabled",null),m([(0,t.MD)(),i("design:type",Function),i("design:paramtypes",[a]),i("design:returntype",void 0)],p,"isWhiteboardLocked",null),m([(0,t.MD)(),i("design:type",Function),i("design:paramtypes",[a]),i("design:returntype",void 0)],p,"getWhiteboardBrushSize",null),m([(0,t.MD)(),i("design:type",Function),i("design:paramtypes",[a]),i("design:returntype",void 0)],p,"getWhiteboardTextSize",null),m([(0,t.MD)(),i("design:type",Function),i("design:paramtypes",[a]),i("design:returntype",void 0)],p,"getWhiteboardEraserSize",null),m([(0,t.MD)(),i("design:type",Function),i("design:paramtypes",[a]),i("design:returntype",void 0)],p,"getWhiteboardAnnotateMode",null),m([(0,t.MD)(),i("design:type",Function),i("design:paramtypes",[a]),i("design:returntype",void 0)],p,"getWhiteboardBrushColor",null),m([(0,t.MD)(),i("design:type",Function),i("design:paramtypes",[a]),i("design:returntype",void 0)],p,"getWhiteboardHasPaint",null),m([(0,t.MD)(),i("design:type",Function),i("design:paramtypes",[a]),i("design:returntype",void 0)],p,"getWhiteboardHasText",null),m([(0,t.MD)(),i("design:type",Function),i("design:paramtypes",[a]),i("design:returntype",void 0)],p,"getCanTouch",null),m([(0,t.MD)(),i("design:type",Function),i("design:paramtypes",[a]),i("design:returntype",void 0)],p,"getCanHover",null),m([(0,t.MD)(),i("design:type",Function),i("design:paramtypes",[a]),i("design:returntype",void 0)],p,"getMultiPickModeEnabled",null),m([(0,t.MD)(),i("design:type",Function),i("design:paramtypes",[a]),i("design:returntype",void 0)],p,"getSearchDisplayMode",null),m([(0,t.MD)(),i("design:type",Function),i("design:paramtypes",[a]),i("design:returntype",void 0)],p,"getUsePrintImage",null),m([(0,t.MD)(),i("design:type",Function),i("design:paramtypes",[a]),i("design:returntype",void 0)],p,"getOpenWindow",null),m([(0,t.MD)(),i("design:type",Function),i("design:paramtypes",[a]),i("design:returntype",void 0)],p,"getMenuOpen",null),m([(0,t.MD)(),i("design:type",Function),i("design:paramtypes",[a]),i("design:returntype",void 0)],p,"getScrim",null),m([(0,t.MD)(),i("design:type",Function),i("design:paramtypes",[a]),i("design:returntype",void 0)],p,"getChapterCallToActionSeen",null),p=c=m([(0,t.Uw)({name:"view",defaults:l}),i("design:paramtypes",[b.n$])],p)},34215:(ge,F,n)=>{"use strict";n.d(F,{d:()=>j});var t=n(65763),e=n(26463),r=n(13181),o=n(93822),C=n(38753),E=n(94495),y=n(49204),_=n(15623),v=n(38104),b=n(17276),P=n(96557),s=n(18171),g=n(3057),u=n(87710),h=n(62949),S=n(82109),f=n(51640),m=n(55494),i=n(51529),c=n(12347),a=n(95419),l=n(45144),p=n(21523),A=n(58832),O=n(32408),L=n(47833),k=n(73987),q=n(22679),B=n(54438);let j=(()=>{var V;class M{constructor(W,$,ne,Q){this.store=W,this.chapterService=$,this.animationService=ne,this.mediaService=Q,this.ui=null,this.horizontalBreakpoint=null}getBase(){return{ui:this.store.selectSnapshot(f.dF.getUI),layout:this.store.selectSnapshot(e.Pf.getLayout),horizontalBreakpoint:this.store.selectSnapshot(v.V.getHorizontalBreakpoint),canvasHeightBreakpoint:this.store.selectSnapshot(m.S.getCanvasHeightBreakpoint),quizActive:this.store.selectSnapshot(u.j.getQuizModeActive),hideUI:this.isUIHidden()}}isUIHidden(){const W=this.store.selectSnapshot(e.Pf.getOpenWindow),$=this.store.selectSnapshot(E.N.getSelectedChapterIndex),ne=this.store.selectSnapshot(f.dF.getUI),Q=W===b.U.Loader&&$<=0&&ne.loader.template===P.aD.Circle,le=this.store.selectSnapshot(S.N.getStoryLoadProgress);return Q||0===le||W===b.U.OnDemand||W===b.U.Interact||W===b.U.Tutorial||W===b.U.Whiteboard}isDrawerVisible(){const{layout:W,quizActive:$,hideUI:ne}=this.getBase();if(ne||this.getViewLayout(W)!==h.G.Drawer)return!1;if($)return!0;const Q=this.store.selectSnapshot(e.Pf.getContentMode);return!(Q===i.G.ChapterInfo&&"full"!==this.getVisibleContent(i.G.ChapterInfo)||Q===i.G.Quiz&&"full"!==this.getVisibleContent(i.G.Quiz)||Q===i.G.LabelInfo&&"none"===this.getVisibleContent(i.G.LabelInfo))&&this.isUIVisible(o.U.Drawer)}isDrawerToggleVisible(){const{ui:W,layout:$,quizActive:ne}=this.getBase(),Q=this.getVisibleContent(i.G.ChapterInfo);return this.getViewLayout($)===h.G.Drawer&&"full"===Q&&!1!==W.drawer.enable&&!ne&&this.isUIVisible(o.U.DrawerToggle)}isColumnVisible(){const{layout:W,ui:$}=this.getBase();if($.column.status===r.Q.Collapse||this.getViewLayout(W)!==h.G.Column)return!1;const ne=this.store.selectSnapshot(e.Pf.getContentMode);return!(ne===i.G.ChapterInfo&&"full"!==this.getVisibleContent(i.G.ChapterInfo)||ne===i.G.Quiz&&"full"!==this.getVisibleContent(i.G.Quiz))&&this.isUIVisible(o.U.Column)}isColumnToggleVisible(){const{hideUI:W,layout:$,ui:ne}=this.getBase();if(W||this.getViewLayout($)!==h.G.Column)return!1;const Q=this.store.selectSnapshot(e.Pf.getContentMode);return!(Q===i.G.ChapterInfo&&"full"!==this.getVisibleContent(i.G.ChapterInfo)||Q===i.G.Quiz&&"full"!==this.getVisibleContent(i.G.Quiz))&&ne.column.enable}isTitleOnlyVisible(){const{hideUI:W,ui:$,layout:ne}=this.getBase();if(W)return!1;const Q=this.getViewLayout(ne),le=this.getVisibleContent(i.G.ChapterInfo),pe=this.isPaginationVisible();let ie=!0;return!(this.store.selectSnapshot(u.j.getQuizModeActive)||Q===h.G.Column&&(!1===$.column.enable&&!1===pe||!1===$.column.enable&&"titleOnly"===le&&!1===pe||$.column.enable&&"full"===le&&$.column.status!==r.Q.Collapse))&&(Q===h.G.Drawer&&(ie=$.drawer.enable||pe),ie)}isToggleLabelsVisible(){return 0!==this.store.selectSnapshot(C.y.getChapterLabels).length&&this.isUIVisible(o.U.ToggleLabels)}isToolsVisible(){return this.isUIVisible(o.U.Tools)}isToolbarVisible(){return this.isUIVisible(o.U.Toolbar)}isFullScreenVisible(){return!this.store.selectSnapshot(e.Pf.getIsMobileWeb)&&this.isUIVisible(o.U.Fullscreen)}isLogoVisible(){const{ui:W}=this.getBase();if(this.store.selectSnapshot(e.Pf.getOpenWindow)===b.U.OnDemand)return!1;const $=this.store.selectSnapshot(e.Pf.getIsMobileWeb),ne=this.store.selectSnapshot(f.dF.getUIEntry(o.U.Media));return!(this.isMediaVisible()&&"show"===ne.status&&!$)&&W.logo.enable}isCameraVisible(){return this.isUIVisible(o.U.Camera)}isPaginationVisible(){return!(this.store.selectSnapshot(E.N.getChapterCount)<=1||this.store.selectSnapshot(u.j.getQuizModeActive))&&this.isUIVisible(o.U.Pagination)}isMediaVisible(){const{hideUI:W,ui:$}=this.getBase(),ne=$.media.enable,Q=this.store.selectSnapshot(E.N.getSelectedChapter);return!(this.store.selectSnapshot(m.S.getCanvasHeightBreakpoint)===k.h.Tiny||W||!ne||!Q?.id||!this.animationService.isChapterAnimated(Q))&&this.isUIVisible(o.U.Media)}isPlaythroughVisible(){const W=this.store.selectSnapshot(E.N.getChapterCount)>1;return!(this.store.selectSnapshot(p.J.getSelectedBookmarkViewMode)===A._.Quiz||!W)&&this.isUIVisible(o.U.Playthrough)}isToolbarOverflowVisible(){const{canvasHeightBreakpoint:W}=this.getBase(),$=this.isUIVisible(o.U.Help),ne=this.isToggleLabelsVisible(),Q=this.store.selectSnapshot(u.j.hasQuiz),le=this.store.selectSnapshot(u.j.getQuizEnabled),pe=this.isUIVisible(o.U.QuizPrompt),ie=this.store.selectSnapshot(u.j.getQuizModeLocked),be=this.store.selectSnapshot(p.J.getSelectedBookmarkViewMode),de=this.store.selectSnapshot(e.Pf.getIsMobileWeb);if(W>k.h.Tiny&&($||ne||Q&&pe&&le&&!1===ie&&be!==A._.Content&&de))return!0;const te=this.isUIVisible(o.U.Tools),R=this.isUIVisible(o.U.VisibilityLayers),D=this.isUIVisible(o.U.Search),T=this.isUIVisible(o.U.Whiteboard);return!!(W<=k.h.Tiny&&(te||R||D||T))||this.isUIVisible(o.U.ToolbarOverflow)}isNodeInfoColumnVisible(){const{hideUI:W,ui:$,horizontalBreakpoint:ne}=this.getBase();return!W&&(!!(ne>=_.m.Large&&this.isUIVisible(o.U.NodeInfo))||(ne<_.m.Large?!$.drawer.enable&&this.isUIVisible(o.U.NodeInfo):void 0))}isNodeInfoVisible(W){const{hideUI:$,horizontalBreakpoint:ne}=this.getBase();return!$&&(ne>=_.m.Large&&W===h.G.Column||ne<_.m.Large&&W===h.G.Drawer)&&this.isUIVisible(o.U.NodeInfo)}isAudioVisible(){const{hideUI:W,ui:$}=this.getBase(),ne=this.store.selectSnapshot(e.Pf.getViewLanguage),Q=this.store.selectSnapshot(E.N.getSelectedChapter),le=this.store.selectSnapshot(e.Pf.getForceAudio);return!(0,y.isNil)(Q)&&this.mediaService.getChapterAudioPlaybackType(Q,ne,le)!==l.Y.None&&!W&&$[o.U.Audio].status!==r.Q.Hide&&($[o.U.Audio].enable||le)}isQuizPromptVisible(){const{hideUI:W}=this.getBase();return!W&&this.isUIVisible(o.U.QuizPrompt)}isSearchVisible(){return this.store.selectSnapshot(m.S.getCanvasHeightBreakpoint)!==k.h.Tiny&&this.isUIVisible(o.U.Search)}isUndoVisible(){const{hideUI:W,ui:$}=this.getBase();return!W&&$.undo.enable}isSkinLayersVisible(){const W=this.store.selectSnapshot(q.t.getVariantSchema("skin"));return!(0,y.isEmpty)(W)&&this.store.selectSnapshot(m.S.getCanvasHeightBreakpoint)!==k.h.Tiny&&this.isUIVisible(o.U.SkinLayers)}isVisibilityLayersVisible(){const W=this.store.selectSnapshot(E.N.getSelectedChapterSrcLayers),$=this.isSkinLayersVisible();return!(!this.chapterService.hasVisibilityLayers(W)&&!$||this.store.selectSnapshot(m.S.getCanvasHeightBreakpoint)===k.h.Tiny)&&(this.isUIVisible(o.U.VisibilityLayers)||this.isSkinLayersVisible())}isWhiteboardVisible(){return this.isUIVisible(o.U.Whiteboard)}isVisible(W){switch(W){case o.U.Audio:return this.isAudioVisible();case o.U.Camera:return this.isCameraVisible();case o.U.Column:return this.isColumnVisible();case o.U.ColumnToggle:return this.isColumnToggleVisible();case o.U.Drawer:return this.isDrawerVisible();case o.U.DrawerToggle:return this.isDrawerToggleVisible();case o.U.Fullscreen:return this.isFullScreenVisible();case o.U.Logo:return this.isLogoVisible();case o.U.Media:return this.isMediaVisible();case o.U.ToolbarOverflow:return this.isToolbarOverflowVisible();case o.U.QuizPrompt:return this.isQuizPromptVisible();case o.U.Pagination:return this.isPaginationVisible();case o.U.Playthrough:return this.isPlaythroughVisible();case o.U.Search:return this.isSearchVisible();case o.U.TitleOnly:return this.isTitleOnlyVisible();case o.U.ToggleLabels:return this.isToggleLabelsVisible();case o.U.Tools:return this.isToolsVisible();case o.U.Toolbar:return this.isToolbarVisible();case o.U.Undo:return this.isUndoVisible();case o.U.VisibilityLayers:return this.isVisibilityLayersVisible();case o.U.SkinLayers:return this.isSkinLayersVisible();case o.U.Whiteboard:return this.isWhiteboardVisible();default:return this.isUIVisible(W)}}isUIVisible(W){const{hideUI:$,ui:ne}=this.getBase();return ne[W]?!$&&ne[W].enable&&ne[W].status!==r.Q.Hide:(console.warn("Attempting to check visibility of a non-existent element: ${element}"),!1)}isUIEnabled(W){const{ui:$}=this.getBase();return $[W].enable}getChapterVisibility(){const{ui:W}=this.getBase(),$=this.store.selectSnapshot(C.y.getChapterLabels),ne=this.store.selectSnapshot(E.N.getSelectedChapter),Q=ne?.displayName,le=null!=Q&&(0,y.trim)(Q).length>0,pe=(0,y.get)(ne,"contentBlocks",[]).length>0,ie=W.labelList.enable&&$.length>0,be=ne?.description,de=null!=be&&(0,y.trim)(be).length>0,w=(0,y.get)(ne,"legend",[]);return ie||de||W.legend.enable&&w.length>0||pe?"full":le?"titleOnly":"none"}getQuizVisibility(){return this.store.selectSnapshot(u.j.getQuizModeActive)?"full":"none"}getLabelInfoVisibility(){const W=this.store.selectSnapshot(C.y.getSelectedLabel);if((0,y.isNil)(W))return"none";const $=W?.title,ne=null!=$&&(0,y.trim)($).length>0;return(0,y.trim)(W.description).length>0||W.contentBlocks?.length>0?"full":ne?"titleOnly":"none"}getVisibleContent(W){switch(W){case i.G.ChapterInfo:return this.getChapterVisibility();case i.G.LabelInfo:return this.getLabelInfoVisibility();case i.G.Quiz:return this.getQuizVisibility()}}getViewLayout(W){const{innerHeight:$,innerWidth:ne}=window,Q=ne/$>=1?"landscape":"portrait",{horizontalBreakpoint:le}=this.getBase(),pe=this.store.selectSnapshot(O.W.getSiteHeader),ie=this.store.selectSnapshot(O.W.getSiteHeaderHeight),de=384+((0,L.Un)(pe)?ie:0);switch(W){case g.o.ColumnOnly:return h.G.Column;case g.o.DrawerOnly:return h.G.Drawer;default:return"portrait"===Q?h.G.Drawer:le>=_.m.Large||$<=de&&ne>=708?h.G.Column:h.G.Drawer}}}return(V=M).\u0275fac=function(W){return new(W||V)(B.KVO(t.il),B.KVO(s.j),B.KVO(c.O),B.KVO(a.u))},V.\u0275prov=B.jDH({token:V,factory:V.\u0275fac,providedIn:"root"}),M})()},39358:(ge,F,n)=>{"use strict";n.d(F,{z:()=>rt});var t=n(28407),e=n(65763),r=n(66056),o=n(55494),C=n(22679),E=n(85052),y=n(82656),d=n(14264),_=n(17365),v=n(33013),b=n(13409),P=n(47555),s=n(47610),g=n(26463),u=n(13181),h=n(93132),S=n(20458),f=n(93915),m=n(94495),i=n(7431),c=n(63745),a=n(49204),l=n(54438);let p=(()=>{var Ge;class Ye{constructor(ye){this.store=ye}chapterHasTransition(ye,Ce){const Je=(0,a.get)(ye,Ce?"transitions.pre":"transitions.post");return!!Je&&(Ce?Je.onPrevious:Je.onNext)}searchChapterTransitions(ye,Ce,xe){let Je=[...xe],ot=Je.findIndex(Ae=>Ae.id===ye),ct=Je.findIndex(Ae=>Ae.id===Ce);const dt=ct<ot;if(dt&&(Je=Je.reverse(),ot=Je.findIndex(Ae=>Ae.id===ye),ct=Je.findIndex(Ae=>Ae.id===Ce)),ot<0||ct<0||ot===ct)return null;const ke=Je.slice(ot,ct).find(Ae=>this.chapterHasTransition(Ae,dt));return ke?dt?ke.transitions.pre:ke.transitions.post:null}}return(Ge=Ye).\u0275fac=function(ye){return new(ye||Ge)(l.KVO(e.il))},Ge.\u0275prov=l.jDH({token:Ge,factory:Ge.\u0275fac,providedIn:"root"}),Ye})();var A=n(62751),O=n(38104),L=n(17276),k=n(61295),q=n(75069),B=n(39898),j=n(34215),V=n(47632),M=n(24477),N=n(59e3),W=n(87710),$=n(18272),ne=n(34006),Q=n(2573),le=n(32408),pe=n(47833),ie=n(26779),be=n(87424),de=n(57018),w=n(60177);let te=(()=>{var Ge;class Ye{transform(ye){return ye.split(" ").map(xe=>`<kbd>${xe}</kbd>`).join("")}}return(Ge=Ye).\u0275fac=function(ye){return new(ye||Ge)},Ge.\u0275pipe=l.EJ8({name:"kbd",type:Ge,pure:!0}),Ye})();function R(Ge,Ye){if(1&Ge&&(l.j41(0,"label",10),l.EFF(1),l.k0s()),2&Ge){const Xe=l.XpG().$implicit;l.R7$(),l.JRh(Xe.pronunciation)}}function D(Ge,Ye){if(1&Ge&&(l.j41(0,"span"),l.nrm(1,"kbd",8),l.nI1(2,"kbd"),l.DNE(3,R,2,1,"label",9),l.k0s()),2&Ge){const Xe=Ye.$implicit;l.R7$(),l.Y8G("innerHTML",l.bMT(2,3,Xe.shortcut),l.npT),l.BMQ("aria-hidden",Xe.hasOwnProperty("pronunciation")),l.R7$(2),l.Y8G("ngIf",Xe.hasOwnProperty("pronunciation"))}}function T(Ge,Ye){if(1&Ge&&(l.j41(0,"tr")(1,"th",6),l.EFF(2),l.k0s(),l.j41(3,"td",7),l.DNE(4,D,4,5,"span",5),l.k0s()()),2&Ge){const Xe=Ye.$implicit;l.R7$(2),l.JRh(Xe.label),l.R7$(2),l.Y8G("ngForOf",Xe.keys)}}function re(Ge,Ye){if(1&Ge&&(l.j41(0,"div",2)(1,"h2",3),l.EFF(2),l.k0s(),l.j41(3,"table",4),l.DNE(4,T,5,2,"tr",5),l.k0s()()),2&Ge){const Xe=Ye.$implicit;l.R7$(2),l.JRh(Xe.label),l.R7$(2),l.Y8G("ngForOf",Xe.shortcuts)}}var K=function(Ge){return Ge.Left="\u2190",Ge.Right="\u2192",Ge.Up="\u2191",Ge.Down="\u2193",Ge.Command="\u2318",Ge}(K||{});let ae=(()=>{var Ge;class Ye{constructor(){this.shortcutGroups=[{label:$localize`Navigation`,shortcuts:[{keys:[{shortcut:",",pronunciation:"Comma."},{shortcut:"Pg-Up",pronunciation:"page-up"}],label:$localize`Previous chapter`},{keys:[{shortcut:".",pronunciation:"Period."},{shortcut:"Pg-Down",pronunciation:"Page-down."}],label:$localize`Next chapter`},{keys:[{shortcut:"/",pronunciation:"Forward slash."}],label:$localize`Open Search`},{keys:[{shortcut:"Ctrl + Enter"}],label:$localize`Enter Fullscreen`},{keys:[{shortcut:"Ctrl/Cmd + ,",pronunciation:"Control or command plus comma."}],label:$localize`Toggle Description`},{keys:[{shortcut:"Shift + /"}],label:$localize`Open Help`}]},{label:$localize`Tools`,shortcuts:[{keys:[{shortcut:"1"}],label:$localize`Use "Select" tool`},{keys:[{shortcut:"2"}],label:$localize`Use "Hide" tool`},{keys:[{shortcut:"3"}],label:$localize`Use "Fade" tool`},{keys:[{shortcut:"del",pronunciation:"Delete."},{shortcut:"backspace"}],label:$localize`Hide selected structure`},{keys:[{shortcut:"Shift + R"}],label:$localize`Reset chapter`},{keys:[{shortcut:"P"}],label:$localize`Toggle between pan and rotate mode`},{keys:[{shortcut:"Ctrl/Cmd + Z",pronunciation:"Control or command plus z."}],label:$localize`Undo`},{keys:[{shortcut:"Ctrl/Cmd + Shift + Z",pronunciation:"Control or command plus shift pluz z."},{shortcut:"Ctrl/Cmd + Y",pronunciation:"Control or command plus y."}],label:$localize`Redo`}]},{label:$localize`Pan`,shortcuts:[{keys:[{shortcut:"W"}],label:$localize`Pan up`},{keys:[{shortcut:"S"}],label:$localize`Pan down`},{keys:[{shortcut:"A"}],label:$localize`Pan left`},{keys:[{shortcut:"D"}],label:$localize`Pan right`},{keys:[{shortcut:"Shift + W"}],label:$localize`Slow pan up`},{keys:[{shortcut:"Shift + S"}],label:$localize`Slow pan down`},{keys:[{shortcut:"Shift + A"}],label:$localize`Slow pan left`},{keys:[{shortcut:"Shift + D"}],label:$localize`Slow pan right`}]},{label:$localize`Rotate`,shortcuts:[{keys:[{shortcut:K.Up}],label:$localize`Rotate up`},{keys:[{shortcut:K.Down}],label:$localize`Rotate down`},{keys:[{shortcut:K.Left}],label:$localize`Rotate left`},{keys:[{shortcut:K.Right}],label:$localize`Rotate right`},{keys:[{shortcut:`Shift + ${K.Up}`}],label:$localize`Slow rotate up`},{keys:[{shortcut:`Shift + ${K.Down}`}],label:$localize`Slow rotate down`},{keys:[{shortcut:`Shift + ${K.Left}`}],label:$localize`Slow rotate left`},{keys:[{shortcut:`Shift + ${K.Right}`}],label:$localize`Slow rotate right`}]},{label:$localize`Zoom`,shortcuts:[{keys:[{shortcut:"E"},{shortcut:"=",pronunciation:"Equals."}],label:$localize`Zoom in`},{keys:[{shortcut:"C"},{shortcut:"-",pronunciation:"Hyphen."}],label:$localize`Zoom out`},{keys:[{shortcut:"Shift + E"},{shortcut:"Shift + =",pronunciation:"Shift plus equals."}],label:$localize`Slow zoom in`},{keys:[{shortcut:"Shift + C"},{shortcut:"Shift + -",pronunciation:"Shift plus hyphen."}],label:$localize`Slow zoom out`}]},{label:$localize`Modify Selected Objects`,shortcuts:[{keys:[{shortcut:"Shift + H"}],label:$localize`Hide selected objects`},{keys:[{shortcut:"Shift + F"}],label:$localize`Fade selected objects`},{keys:[{shortcut:"Shift + I"}],label:$localize`Isolate selected objects`}]},{label:$localize`Media Controls`,shortcuts:[{keys:[{shortcut:"J"}],label:$localize`Rewind 1 second`},{keys:[{shortcut:"L"}],label:$localize`Fast forward 1 second`},{keys:[{shortcut:"K"},{shortcut:"space"}],label:$localize`Play / pause`}]}]}}return(Ge=Ye).\u0275fac=function(ye){return new(ye||Ge)},Ge.\u0275cmp=l.VBU({type:Ge,selectors:[["app-view-shortcuts"]],decls:2,vars:1,consts:[[1,"view-shortcuts"],["class","view-shortcuts__group",4,"ngFor","ngForOf"],[1,"view-shortcuts__group"],[1,"view-shortcuts__label","font-bold"],[1,"view-shortcuts__table"],[4,"ngFor","ngForOf"],["scope","row",1,"view-shortcuts__cell-header"],[1,"view-shortcuts__cell","view-shortcuts__cell--key"],[1,"view-shortcuts__key",3,"innerHTML"],["class","sr-only",4,"ngIf"],[1,"sr-only"]],template:function(ye,Ce){1&ye&&(l.j41(0,"div",0),l.DNE(1,re,5,2,"div",1),l.k0s()),2&ye&&(l.R7$(),l.Y8G("ngForOf",Ce.shortcutGroups))},dependencies:[w.Sq,w.bT,te],styles:[".view-shortcuts{display:flex;flex-direction:column}.view-shortcuts__group{width:100%;padding-bottom:32px;margin-top:32px}.view-shortcuts__label{padding:8px 0 12px}.view-shortcuts__table{width:100%}.view-shortcuts__cell{padding:8px;border-bottom:1px solid rgba(255,255,255,.3);width:50%}.view-shortcuts__cell-header{text-align:start;padding:8px;border-bottom:1px solid rgba(255,255,255,.3);width:50%}.view-shortcuts__key{border-radius:4px;display:inline-flex;padding:4px;margin-right:4px;background:#000;color:#fff;justify-content:center;align-items:center;font-family:monospace;font-size:16px}.view-shortcuts__key>kbd{margin-inline-end:8px}.view-shortcuts__key>kbd:last-child{margin-inline-end:0}\n"],encapsulation:2,changeDetection:0}),Ye})();var ce;const z=["viewHelp"];class H{constructor(Ye,Xe,ye,Ce){this.dialogRef=Ye,this.renderer=Xe,this.store=ye,this.data=Ce,this.helpTypeEnum=B.J,this.activeTab=B.J.Basics,this.ngUnsubscribe=new E.B,this.activeTab=Ce.tab}ngOnInit(){this.initWindowSizeObserver()}ngAfterViewInit(){this.updateViewHeight()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}initWindowSizeObserver(){this.renderer.listen("window","resize",()=>{this.updateViewHeight()})}updateViewHeight(){const Ye=this.store.selectSnapshot(le.W.getSiteHeader),Xe=this.store.selectSnapshot(le.W.getSiteHeaderHeight),ye=(0,pe.mJ)(Ye,Xe,!1);this.viewHelp.nativeElement.style.setProperty("--vh",`${ye}px`)}handleCloseClick(){this.dialogRef.close()}}(ce=H).\u0275fac=function(Ye){return new(Ye||ce)(l.rXU(ne.CP),l.rXU(l.sFG),l.rXU(e.il),l.rXU(ne.Vh))},ce.\u0275cmp=l.VBU({type:ce,selectors:[["app-help-dialog"]],viewQuery:function(Ye,Xe){if(1&Ye&&l.GBs(z,7),2&Ye){let ye;l.mGM(ye=l.lsd())&&(Xe.viewHelp=ye.first)}},decls:147,vars:1,consts:()=>{let Ge,Ye,Xe,ye,Ce,xe,Je,ot,ct,dt,ke,Ae,Fe,he,_e,Ie,Oe,tt,gt,bt,qe,Ot,_t,Ft,Rt,Pt,jt,yt,Qt,Gt,wt,Dt,zt,Kt,kt,Jt,Yt,tn,nn,sn,Be,Te,Me,De,Ne,He,st,it,ut,mt,St,ft,ht,Lt;return Ge=$localize`:␟fe6f57177418d5e7beb3165189f76d610996162d␟7676085147402388734:Navigation Basics`,Ye=$localize`:␟429597f3d7d1d78213dcf7dd66eebfde0d86678e␟6253898756323650322:A heart with an arrow wrapped around it, which symbolises objects being rotated withing the 3D viewport.`,Xe=$localize`:␟e18d3340208bca7ddf2d94f70d0a660dbd42385d␟5773019152243041254:A heart with left and right arrows pointing away from it, which symbolises objects being panned within the 3D viewport`,ye=$localize`:␟d39dadf537d9b0839ce21a28536327f9f5a686c7␟4934730967388350918:A heart with a magnifying glass over it, which symbolises zooming into and out from an object within the 3D viewport.`,Ce=$localize`:␟304ad8b02639512724d4bd74a4e0948235755937␟354592426013976576:A heart with a smaller region colored in blue and a popup window specifying that the Right Ventricle is selected.`,xe=$localize`:␟6cfe97f88f0ed2276b3712e9f9f3afa30a520281␟6061724875357600922:All Controls`,Je=$localize`:␟18a94681247b809ceced9eb0f694ae4c0d312da4␟6414411281097606478:A mouse with the left button being held in.`,ot=$localize`:␟1170cfcc8c84af3864f78a0492ec1fd780284368␟8257874423928835005:A mouse with the right button being held in.`,ct=$localize`:␟7af3be3703c527b268af7bdf41dbea65aa79a6ec␟9056964158501440909:A mouse with the left button being clicked.`,dt=$localize`:␟2060ac29b56620ac4dee9e60c192070663dbe8ae␟1011682562656049028:A mouse with the left button being double clicked.`,ke=$localize`:␟3151632192d235a3f169dca7cc9ef84780febe86␟6187030666890085624:A mouse with the left button being held in for a long duration.`,Ae=$localize`:␟966f12391c5738cf46c32d1cb6a5f5a834048642␟4740543999988156181:The arrow keys.`,Fe=$localize`:␟6ba68416157f6fe2131511ecdd079903b2eeefb7␟8470097694829285611:The W, A, S and D keys.`,he=$localize`:␟0ac7f1fedebf3949fc40233a13c6eb4e0e040664␟4819033955395086119:The plus and minus keys grouped together or the E and C keys grouped together.`,_e=$localize`:␟2b78dffe01cdcaf46976e26b031c327066fff0fa␟6264224730837738660:The shift key.`,Ie=$localize`:␟a302d6da0d4e760ae27cb11470852686dc847291␟4683038358223678995:A finger clicking the trackpad once.`,Oe=$localize`:␟ed595e7bcf6f65d4bfcb7302f8436fdc171e87a1␟2262651993298779843:A finger clicking the trackpad twice.`,tt=$localize`:␟23c69f01719b0c53dea3a4f38b7b6b20b1a68f35␟4216705101587735156:A finger pressing for a long duration on the trackpad.`,gt=$localize`:␟58f7f1cfc7494c3ad8af6f045a100569af8e763d␟3981109811663390815:Two fingers pressing the trackpad while moving vertically.`,bt=$localize`:␟eedb1f2596af2c8fcb065b15ace6b88d079e45db␟4831075576673859232:Keyboard Shortcuts`,qe=$localize`:␟85b79c9064aed1ead31ace985f31aa1363f6bdaf␟7911416166208830577:Help`,Ot=$localize`:␟0ce04cf84ced2fc10b64d8d01c93254302fae720␟8819530610784848299:Close help modal`,_t=$localize`:␟20058274f3bdffd2cf7023d350d44170f6ff7a12␟1050269006235116171:Rotate`,Ft=$localize`:␟b2ba3edf1e4f930372c8c0648a80cd8540824bb2␟7927106883889636493:Click and drag or use one finger to change the viewing angle.`,Rt=$localize`:␟7cd14ceae63b4aba71ab7935638f5d3b799f4f4b␟9128067536654850026:Pan`,Pt=$localize`:␟5f2421818b14ff6b2b6760f657072c9d1edf54c0␟875857706935138088:Hold the shift key and drag or use two fingers to move the model's position.`,jt=$localize`:␟e76cd6dbaa898f85934f363fef654b29e44d004b␟6421460271971606186:Zoom`,yt=$localize`:␟943378a26adbb00b393fc72f7d8751a3d154419f␟2968417613352515367:Scroll up and down or pinch with two fingers to zoom in or out.`,Qt=$localize`:␟eb55d5cbcf6e2a42868bede1caa64be0f1f1e435␟5702628055979003671:Explore the Anatomy`,Gt=$localize`:␟1e2bffd4aecf789df7c101eec013ece36ac4d1b1␟3307141625837320493:Click or tap an anatomic structure or label to learn more.`,wt=$localize`:␟06525f75da53823cbe1725093bc86cd88ade8597␟728862926652618704:Mouse`,Dt=$localize`:␟c3cee0bf85850fda5c38ee3e4d1bff10de4ce5c5␟7193182677599035399:Hold left button to rotate`,zt=$localize`:␟23c0d0956b66d711cfe7df58ef6a7b4d07075b00␟4504766784431323465:Hold right button to pan`,Kt=$localize`:␟430665e380a10950da6951cf7f4002d0cc8dd157␟5037804585803260848:Single-click left button to select a structure`,kt=$localize`:␟45cebd73bba4b4553ff774400b20119e5a9d97ff␟2243293724382272862:Double-click left button to auto-focus on a structure`,Jt=$localize`:␟7e25565e229d4feddc9c05e1738729a9aac57a28␟7760284646478975781:Long-click to fly to a structure`,Yt=$localize`:␟50b412747cc527764294a1b903ec5c1d62844a11␟1724029931462476938:Rotate with arrows`,tn=$localize`:␟07614e55f8def77bf252040fc41cc9453e0fa34d␟8399776404178179481:Pan up (W), left (A), down (S), right(D)`,nn=$localize`:␟064d015bd99ad65866112d59a58eb66cd4ed3dcf␟2527063424056268537:Zoom out (-, C) and zoom in (+, E)`,sn=$localize`:␟6b1e5719efa1db70ea28a09765b11b1488dc3dcb␟3479840639285374289:Hold with any previous key to slow down motion`,Be=$localize`:␟3b12deb58592fad9559bee11b1c81a314f6c0dfd␟5453789791073353804:Trackpad`,Te=$localize`:␟03e5f4b8f37c3498d675cce895d5cbbe14f001dd␟8732399774338102812:Single-tap to auto-focus a structure`,Me=$localize`:␟fa6d739684a57595169beedef230af0de5e835f8␟893674047997882971:Double-tap to select a structure`,De=$localize`:␟38d81be3a0506d3d76acab0eb9ba6d756e643b9e␟6955199594650294227:Long-press to fly to a structure`,Ne=$localize`:␟bbc241c56a687bd4b728277bbbfc5714fe71564d␟8600401187735507174:Scroll up and down to zoom`,He=$localize`:␟2d2c5215cbb8cb0c926c8d132668eb16275558b0␟8973369245527156970:In-App`,st=$localize`:␟74d17ea41b9374ceefcf8f7c763a1176cd96dbae␟491840984763060870: The plus symbol, which represents zooming in in the camera control menu. `,it=$localize`:␟e28ee80cd3a124e109793180dfd1f8d8067dcc6b␟6500061599200357251:Zoom in`,ut=$localize`:␟402a1f359e7c008f0aef6b084fafaf2f49ce56d3␟399413764515891152: The minus symbol, which represents zooming out in the camera control menu. `,mt=$localize`:␟a3dfc58748f790fa096cf3c5fc331f90846e1772␟944767796496567082:Zoom out`,St=$localize`:␟c4f9fc3dd4d06c87f09dc68e8e0a3b38ae4948ff␟7289327967342552784: The map pin symbol, which resets the camera in the camera control menu. `,ft=$localize`:␟ac4a855ff1671d74a0692e3b9ee5be349e6281ca␟6332173527621530176:Return to Starting Position`,ht=$localize`:␟5108bd6e5963ccd847b1a768fd214262ccfbc81d␟8038524584906192988: Arrows pointing in four directions, which represents panning in the camera control menu. `,Lt=$localize`:␟7cd14ceae63b4aba71ab7935638f5d3b799f4f4b␟9128067536654850026:Pan`,[["viewHelp",""],qe,Ot,_t,Ft,Rt,Pt,jt,yt,Qt,Gt,wt,Dt,zt,Kt,kt,Jt,Yt,tn,nn,sn,Be,Te,Me,De,Ne,He,st,it,ut,mt,St,ft,ht,Lt,["role","dialog","aria-labelledby","helpTitle",1,"view-help"],["id","helpTitle",1,"view-help__header"],["type","button",1,"view-help__close",3,"click"],["icon","times","aria-hidden","true"],[1,"sr-only"],[1,"view-help__inner"],["tabSize","medium","tabAlign","center","cdkFocusInitial","",3,"activeTab"],["label",Ge,"id","helpBasics","aria-controls","basicsPanel"],["role","tabpanel","aria-labelledby","helpBasics","tabindex","0","id","basicsPanel"],[1,"view-help__group"],[1,"view-help__item"],[1,"view-help__image"],["src","assets/images/widget/help-rotate.svg","alt",Ye],[1,"view-help__label"],["src","assets/images/widget/help-pan.svg","alt",Xe],["src","assets/images/widget/help-zoom.svg","alt",ye],["src","assets/images/widget/help-learn.svg","alt",Ce],["label",xe,"id","helpAll","aria-controls","allPanel"],["role","tabpanel","aria-labelledby","helpAll","tabindex","0","id","allPanel"],[1,"view-help__section-header"],["src","assets/images/widget/help-mouse-hold-left.svg","alt",Je],["src","assets/images/widget/help-mouse-hold-right.svg","alt",ot],["src","assets/images/widget/help-mouse-single-click-left.svg","alt",ct],["src","assets/images/widget/help-mouse-double-click-left.svg","alt",dt],["src","assets/images/widget/help-mouse-long-press-left.svg","alt",ke],["src","assets/images/widget/help-keyboard-rotate.svg","alt",Ae],["src","assets/images/widget/help-keyboard-pan.svg","alt",Fe],["src","assets/images/widget/help-keyboard-zoom.svg","alt",he],["src","assets/images/widget/help-keyboard-slow-motion.svg","alt",_e],["src","assets/images/widget/help-trackpad-single-tap.svg","alt",Ie],["src","assets/images/widget/help-trackpad-double-tap.svg","alt",Oe],["src","assets/images/widget/help-trackpad-long-press.svg","alt",tt],["src","assets/images/widget/help-trackpad-scroll.svg","alt",gt],["icon","plus","aria-hidden","true",1,"view-help__icon"],["icon","minus","aria-hidden","true",1,"view-help__icon"],["icon","location","aria-hidden","true",1,"view-help__icon"],["icon","arrows","aria-hidden","true",1,"view-help__icon"],["label",bt,"id","helpShortcuts","aria-controls","shortcutsPanel"],["role","tabpanel","aria-labelledby","helpShortcuts","tabindex","0","id","shortcutsPanel"]]},template:function(Ye,Xe){if(1&Ye){const ye=l.RV6();l.j41(0,"div",35,0)(2,"h2",36),l.pXf(3,1),l.k0s(),l.j41(4,"button",37),l.bIt("click",function(){return l.eBV(ye),l.Njj(Xe.handleCloseClick())}),l.nrm(5,"app-icon",38),l.j41(6,"span",39),l.pXf(7,2),l.k0s()(),l.j41(8,"div",40)(9,"app-tabs",41)(10,"app-tab",42)(11,"div",43)(12,"ul",44)(13,"li",45)(14,"div",46),l.nrm(15,"img",47),l.k0s(),l.j41(16,"div",48),l.pXf(17,3),l.k0s(),l.qex(18),l.pXf(19,4),l.bVm(),l.k0s(),l.j41(20,"li",45)(21,"div",46),l.nrm(22,"img",49),l.k0s(),l.j41(23,"div",48),l.pXf(24,5),l.k0s(),l.qex(25),l.pXf(26,6),l.bVm(),l.k0s(),l.j41(27,"li",45)(28,"div",46),l.nrm(29,"img",50),l.k0s(),l.j41(30,"div",48),l.pXf(31,7),l.k0s(),l.qex(32),l.pXf(33,8),l.bVm(),l.k0s(),l.j41(34,"li",45)(35,"div",46),l.nrm(36,"img",51),l.k0s(),l.j41(37,"div",48),l.pXf(38,9),l.k0s(),l.qex(39),l.pXf(40,10),l.bVm(),l.k0s()()()(),l.j41(41,"app-tab",52)(42,"div",53)(43,"h3",54),l.pXf(44,11),l.k0s(),l.j41(45,"ul",44)(46,"li",45)(47,"div",46),l.nrm(48,"img",55),l.k0s(),l.qex(49),l.pXf(50,12),l.bVm(),l.k0s(),l.j41(51,"li",45)(52,"div",46),l.nrm(53,"img",56),l.k0s(),l.qex(54),l.pXf(55,13),l.bVm(),l.k0s(),l.j41(56,"li",45)(57,"div",46),l.nrm(58,"img",57),l.k0s(),l.qex(59),l.pXf(60,14),l.bVm(),l.k0s(),l.j41(61,"li",45)(62,"div",46),l.nrm(63,"img",58),l.k0s(),l.qex(64),l.pXf(65,15),l.bVm(),l.k0s(),l.j41(66,"li",45)(67,"div",46),l.nrm(68,"img",59),l.k0s(),l.qex(69),l.pXf(70,16),l.bVm(),l.k0s()(),l.j41(71,"h3",54),l.EFF(72,"Keyboard"),l.k0s(),l.j41(73,"ul",44)(74,"li",45)(75,"div",46),l.nrm(76,"img",60),l.k0s(),l.qex(77),l.pXf(78,17),l.bVm(),l.k0s(),l.j41(79,"li",45)(80,"div",46),l.nrm(81,"img",61),l.k0s(),l.qex(82),l.pXf(83,18),l.bVm(),l.k0s(),l.j41(84,"li",45)(85,"div",46),l.nrm(86,"img",62),l.k0s(),l.qex(87),l.pXf(88,19),l.bVm(),l.k0s(),l.j41(89,"li",45)(90,"div",46),l.nrm(91,"img",63),l.k0s(),l.qex(92),l.pXf(93,20),l.bVm(),l.k0s()(),l.j41(94,"h3",54),l.pXf(95,21),l.k0s(),l.j41(96,"ul",44)(97,"li",45)(98,"div",46),l.nrm(99,"img",64),l.k0s(),l.qex(100),l.pXf(101,22),l.bVm(),l.k0s(),l.j41(102,"li",45)(103,"div",46),l.nrm(104,"img",65),l.k0s(),l.qex(105),l.pXf(106,23),l.bVm(),l.k0s(),l.j41(107,"li",45)(108,"div",46),l.nrm(109,"img",66),l.k0s(),l.qex(110),l.pXf(111,24),l.bVm(),l.k0s(),l.j41(112,"li",45)(113,"div",46),l.nrm(114,"img",67),l.k0s(),l.qex(115),l.pXf(116,25),l.bVm(),l.k0s()(),l.j41(117,"h3",54),l.pXf(118,26),l.k0s(),l.j41(119,"ul",44)(120,"li",45),l.nrm(121,"app-icon",68),l.j41(122,"span",39),l.pXf(123,27),l.k0s(),l.qex(124),l.pXf(125,28),l.bVm(),l.k0s(),l.j41(126,"li",45),l.nrm(127,"app-icon",69),l.j41(128,"span",39),l.pXf(129,29),l.k0s(),l.qex(130),l.pXf(131,30),l.bVm(),l.k0s(),l.j41(132,"li",45),l.nrm(133,"app-icon",70),l.j41(134,"span",39),l.pXf(135,31),l.k0s(),l.qex(136),l.pXf(137,32),l.bVm(),l.k0s(),l.j41(138,"li",45),l.nrm(139,"app-icon",71),l.j41(140,"span",39),l.pXf(141,33),l.k0s(),l.qex(142),l.pXf(143,34),l.bVm(),l.k0s()()()(),l.j41(144,"app-tab",72)(145,"div",73),l.nrm(146,"app-view-shortcuts"),l.k0s()()()()()}2&Ye&&(l.R7$(9),l.Y8G("activeTab",Xe.activeTab))},dependencies:[ie.R,be.j,de.O,ae],styles:[".view-help{background-color:#101823e6;color:#fff;display:flex;align-items:center;flex-direction:column;position:fixed;top:0;left:0;right:0;z-index:10000;height:100vh;height:calc(var(--vh, 1vh) * 100);max-height:100vh;overflow:auto}.view-help__inner{width:100%;max-width:1140px;height:99vh;height:calc(var(--vh, 1vh) * 99);padding:32px;position:relative}.view-help__close{color:#fff;width:40px;height:40px;display:flex;align-items:center;justify-content:center;position:fixed;right:8px;top:8px;z-index:10;border:none;background:none}.view-help__header{font-size:.875rem;line-height:1.25rem;font-weight:600;padding-bottom:12px;margin-top:32px}.view-help__section-header{font-size:.75rem;line-height:1rem;border-bottom:1px solid rgba(255,255,255,.3);font-weight:600;padding-bottom:12px;margin-top:32px}.view-help__label{font-size:.875rem;line-height:1.25rem;font-weight:600;margin-bottom:12px}.view-help__group{display:flex;justify-content:space-around;flex-wrap:wrap}.view-help__item{font-size:.75rem;line-height:1rem;display:flex;flex-flow:column;text-align:center;padding:20px;flex:0 1 180px}.view-help__image{justify-content:center;margin-bottom:16px;width:160px;height:100px}.view-help__icon{font-size:24px;margin-bottom:16px}\n"],encapsulation:2,changeDetection:0}),function(Ge,Ye,Xe,ye){var Je,Ce=arguments.length,xe=Ce<3?Ye:null===ye?ye=Object.getOwnPropertyDescriptor(Ye,Xe):ye;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)xe=Reflect.decorate(Ge,Ye,Xe,ye);else for(var ot=Ge.length-1;ot>=0;ot--)(Je=Ge[ot])&&(xe=(Ce<3?Je(xe):Ce>3?Je(Ye,Xe,xe):Je(Ye,Xe))||xe);Ce>3&&xe&&Object.defineProperty(Ye,Xe,xe)}([(0,e.l6)(g.Pf.getCanTouch),function(Ge,Ye){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata("design:type",Ye)}(0,Q.c)],H.prototype,"canTouch$",void 0);var J=n(3829),Y=n(51529),X=n(93822),se=n(51640),oe=n(50677),me=n(38753),Se=n(35650),Ue=n(62949),je=function(Ge){return Ge.DiscoveredChapterNav="Discovered Chapter Nav",Ge}(je||{}),Le=n(11153),Re=n(95419),Ee=n(37710),We=n(28722),ze=n(46842),Ze=n(18617),et=n(47987);let rt=(()=>{var Ge;class Ye{constructor(ye,Ce,xe,Je,ot,ct,dt,ke,Ae,Fe){this.dialog=ye,this.store=Ce,this.location=xe,this.transitionService=Je,this.mediaService=ot,this.sceneService=ct,this.viewUIService=dt,this.vendorAnalyticsService=ke,this.liveAnnouncer=Ae,this.overlayContainer=Fe,this.materialOverlayOut$=new E.B}initStory(ye,Ce,xe){const Je="preview"===ye;this.store.dispatch(new V.Xt(ye,Ce,Je)),this.store.dispatch(new r.yi(ye,Ce,!0));const ot=this.store.select(o.S.getReady),ct=this.store.select(C.t.getIncomingStoryInfo);(0,y.z)([ot,ct]).pipe((0,d.p)(([dt,ke])=>dt&&!!ke.id),(0,_.s)(1)).subscribe(()=>{this.store.dispatch(new v.yz),this.store.dispatch(new r.Ye(ye,Ce,xe,Je))})}nextChapter(ye){const Ce=this.store.selectSnapshot(m.N.getSelectedChapterIndex),xe=this.store.selectSnapshot(m.N.getStoryChapters);this.vendorAnalyticsService.trackOncePerSession(je.DiscoveredChapterNav,{source:ye,breakpoint:this.store.selectSnapshot(O.V.getHorizontalBreakpointLabel)});const Je=xe[Ce+1];Je&&this.selectChapter(Je)}previousChapter(ye){const Ce=this.store.selectSnapshot(m.N.getSelectedChapterIndex),xe=this.store.selectSnapshot(m.N.getStoryChapters);this.vendorAnalyticsService.trackOncePerSession(je.DiscoveredChapterNav,{source:ye,breakpoint:this.store.selectSnapshot(O.V.getHorizontalBreakpointLabel)});const Je=xe[Ce-1];Je&&this.selectChapter(Je)}firstChapter(ye){const Ce=this.store.selectSnapshot(m.N.getStoryChapters);this.vendorAnalyticsService.trackOncePerSession(ye,{source:ye,breakpoint:this.store.selectSnapshot(O.V.getHorizontalBreakpointLabel)});const xe=Ce[0];xe&&this.selectChapter(xe)}selectChapter(ye){var Ce=this;return(0,t.A)(function*(){if(!Ce.store.selectSnapshot(W.j.getQuizModeActive)){const ot=Ce.store.selectSnapshot(m.N.getSelectedChapterId),ct=ye.id,dt=Ce.store.selectSnapshot(m.N.getStoryChapters);let ke=null;Ce.store.selectSnapshot(ze.U.getPrefersReducedMotion)||(ke=Ce.transitionService.searchChapterTransitions(ot,ct,dt)),Ce.vendorAnalyticsService.trackOncePerSession(je.DiscoveredChapterNav,{source:"Chapter List",breakpoint:Ce.store.selectSnapshot(O.V.getHorizontalBreakpointLabel)}),ke&&(yield Ce.chapterTransition(ke)),Ce.store.dispatch([new r.si(ye.id),new v.yz(ye)])}const Je=document.getElementById("chapter-title");Je&&setTimeout(()=>Je.querySelector("button").focus(),200)})()}chapterTransition(ye){return new Promise(Ce=>{ye.camera&&this.store.dispatch(new i.Ih(ye.camera,!0,ye.duration)),ye.fadeColor&&this.store.dispatch(new s.zW(ye.fadeColor,ye.duration)),setTimeout(()=>{Ce(!0)},1e3*ye.duration)})}hideSelectedStructures(){const ye=this.store.selectSnapshot(b.z.getCheckedNodeIds);this.store.dispatch(new k.yr(!1,ye))}selectTool(ye){this.store.selectSnapshot(W.j.getQuizModeActive)&&ye===P.s.Select&&(ye=P.s.Quiz),this.store.dispatch(new s.pL(ye))}toggleAutoplay(ye){ye=ye??!this.store.selectSnapshot(g.Pf.getAutoplay),this.store.dispatch(new h.B.SetAutoplay(ye))}toggleAnimation(){const ye=this.store.selectSnapshot(o.S.getAnimationPlaying);this.store.dispatch(new s.dE(!ye))}toggleMedia(ye){const Ce=this.store.selectSnapshot(se.dF.getUI);Ce.media.status=(ye=ye??Ce.media.status!==u.Q.Show)?u.Q.Show:u.Q.Collapse,this.store.dispatch(new oe.p.SetUI(Ce))}toggleDrawer(ye,Ce=!1){const xe=this.store.selectSnapshot(se.dF.getUI);null==ye&&(ye=xe.drawer.status==u.Q.Hide?u.Q.Show:u.Q.Hide),xe.drawer.status=ye,Ce&&(xe.drawer.userStatusPreference=xe.drawer.status),this.store.dispatch(new oe.p.SetUI(xe))}toggleColumn(ye){const Ce=this.store.selectSnapshot(se.dF.getUI);null==ye&&(ye=Ce.column.status!==u.Q.Show),Ce.column.status=ye?u.Q.Show:u.Q.Collapse,Ce.column.userStatusPreference=Ce.column.status,this.store.dispatch(new oe.p.SetUI(Ce))}togglePresentation(){this.store.selectSnapshot(g.Pf.getPresentationActive)?this.stopPresentation():this.startPresentation()}startPresentation(){this.store.dispatch(new h.B.TogglePresentation(!0))}stopPresentation(){this.store.dispatch(new h.B.TogglePresentation(!1))}toggleHelp(ye=B.J.Basics){0===this.dialog.openDialogs.length&&this.dialog.open(H,{maxWidth:"100vw",maxHeight:"100vh",height:"100%",width:"100%",data:{tab:ye}})}toggleInteract(ye){this.store.dispatch(new h.B.ToggleWindow(L.U.Interact,ye))}toggleOnDemand(ye){this.store.dispatch(new h.B.SetOnDemand(ye)),this.store.dispatch(new h.B.ToggleWindow(L.U.OnDemand,ye))}togglePlaythrough(ye,Ce){this.store.dispatch(new h.B.SetPlaythroughEnabled(ye)),(0,a.isNil)(Ce)||this.store.dispatch(new h.B.SetForceAudio(Ce))}toggleTutorial(ye){this.store.dispatch(new h.B.ToggleWindow(L.U.Tutorial,ye)),ye&&this.store.dispatch(new h.B.StartTutorial(!0))}toggleWhiteboard(ye){this.store.dispatch(new h.B.ToggleWindow(L.U.Whiteboard,ye)),ye&&this.store.dispatch(new h.B.SetWhiteboardEnabled(!0))}showLabels(ye){const Ce=this.store.selectSnapshot(se.dF.getUI);ye=(0,a.isNil)(ye)?!Ce.labels.shown:ye,Ce.labels.shown=ye,this.store.dispatch(new oe.p.SetUI(Ce))}toggleLabels(ye){this.store.dispatch(new s.Gv(ye))}togglePan(){const ye="pan"===this.store.selectSnapshot(J.x.getPanMode)?"rotate":"pan";this.store.dispatch(new i.vq(ye))}toggleSearch(ye=$.q.List,Ce){const xe=this.store.selectSnapshot(se.dF.getUI);xe.search.status=(Ce=Ce??xe.search.status!==u.Q.Show)?u.Q.Show:u.Q.Collapse,Ce&&(xe.visibilityLayers.status=u.Q.Collapse,xe.nodeInfo.status=u.Q.Hide),this.store.dispatch(new h.B.SetSearchDisplayMode(ye)),this.store.dispatch(new oe.p.SetUI(xe))}toggleLayers(ye){const Ce=this.store.selectSnapshot(g.Pf.getLayout);this.viewUIService.getViewLayout(Ce)===Ue.G.Drawer?this.toggleLayersDrawer(ye):this.toggleLayersColumn(ye)}toggleLayersColumn(ye){const Ce=this.store.selectSnapshot(se.dF.getUI);Ce.visibilityLayers.status=(ye=ye??Ce.visibilityLayers.status!==u.Q.Show)?u.Q.Show:u.Q.Collapse,ye&&(Ce.search.status=u.Q.Collapse,Ce.nodeInfo.status=u.Q.Hide),this.store.dispatch(new oe.p.SetUI(Ce))}toggleLayersDrawer(ye){const Ce=this.store.selectSnapshot(se.dF.getVisible(X.U.Drawer)),xe=(ye=ye??!Ce)?u.Q.Show:u.Q.Hide;this.setContentMode(Y.G.VisibilityLayers),this.toggleDrawer(xe)}toggleNodeInfo(ye){this.setContentMode(ye?Y.G.NodeInfo:null)}toggleLabelInfo(ye){const Ce=this.store.selectSnapshot(se.dF.getVisible(X.U.Drawer)),xe=this.store.selectSnapshot(g.Pf.getContentMode);ye=(0,a.isNull)(ye)?!Ce:ye;const Je=this.store.selectSnapshot(me.y.getSelectedLabel),ot=this.store.selectSnapshot(se.dF.getVisible(X.U.LabelList)),ct=Ce&&ot;if(ye&&Je)this.toggleDrawer(ct&&xe===Y.G.ChapterInfo||Je?.description||Je.contentBlocks?.length>0?u.Q.Show:u.Q.Collapse),ct||this.setContentMode(Y.G.LabelInfo);else{if(ct&&xe===Y.G.ChapterInfo)return;this.toggleDrawer(u.Q.Hide)}}playChapterAudio(ye=!1){const Ce=this.store.selectSnapshot(g.Pf.getViewLanguage),xe=this.store.selectSnapshot(m.N.getSelectedChapter);this.mediaService.stopAllAudio(),this.mediaService.getChapterAudioPlayer(xe,Ce,ye).then(Je=>{if((this.store.selectSnapshot(Ee.S.getAutoplayAudio)||ye)&&this.store.selectSnapshot(m.N.getSelectedChapterId)===xe.id){const dt=this.store.selectSnapshot(Ee.S.getAudioMuted);this.mediaService.playAudio(xe.id,dt)}})}setContentMode(ye){ye||(ye=Y.G.ChapterInfo),this.store.dispatch(new h.B.SetContentMode(ye))}delegateNodeClick(ye,Ce){if(this.clearSelectedLabel(),ye||Ce.srcEvent.shiftKey)if(Ce.srcEvent.shiftKey||this.store.selectSnapshot(g.Pf.getMultiPickModeEnabled))this.checkNode(ye);else switch(this.store.selectSnapshot(o.S.getActiveTool)){case P.s.Hide:this.hideNode(ye);break;case P.s.Select:this.selectNode(ye);break;case P.s.Isolate:this.isolateNode(ye);break;case P.s.Fade:this.fadeNode(ye)}else this.clearSelectedNodes()}clearSelectedLabel(){this.store.dispatch(new f.TR)}clearSelectedNodes(){this.store.dispatch(new k.hg),this.store.dispatch(new k.q9(!1))}clearFadedNodes(){const ye=this.store.selectSnapshot(m.N.getSelectedChapterId);this.store.dispatch(new q.a.UndoAll(ye))}checkNode(ye,Ce){void 0!==ye&&(null==Ce&&(Ce=this.store.selectSnapshot(b.z.getNodes)[ye.id].checked),this.store.dispatch(new k.q9(!Ce,[ye.id])),this.store.dispatch(new k.hg(ye.id)))}fadeNode(ye){this.store.dispatch(new k.Jp(S.EC,[ye.id]))}isolateNode(ye){this.store.dispatch(new k.yr(!1)),this.store.dispatch(new k.yr(!0,[ye.id]))}selectNode(ye){const Ce=!this.store.selectSnapshot(b.z.getNodes)[ye.id].checked;this.store.dispatch(new k.q9(!1)),Ce&&(this.store.dispatch(new k.q9(!0,[ye.id])),this.store.dispatch(new k.hg(ye.id))),this.store.dispatch(new s._o(ye));const xe=this.store.selectSnapshot(g.Pf.getNodeInfoFallback),Je=this.store.selectSnapshot(g.Pf.getViewLanguage);this.store.dispatch(new s.bo(ye,xe,Je))}hideNode(ye){this.store.dispatch(new k.yr(!1,[ye.id])),this.store.dispatch(new k.q9(!1))}selectLabel(ye,Ce=!1){const{objectId:xe,states:Je}=ye;this.store.dispatch(new f.TR(ye)),Ce&&xe&&0===Je.length&&this.store.dispatch(new s.W6(xe,!0))}applyChapterCamera(ye){this.store.selectSnapshot(J.x.getChapterCameraEnabled)&&this.store.dispatch(new i.Ih(ye.camera.location,ye.camera.action===A.L.FlyTo,void 0,ye.camera.rotationCenter))}applyChapterScenegraph(ye){const Ce=this.sceneService.createViewGraph({availableObjects:ye.availableObjects,viewGraphMetadata:this.store.selectSnapshot(o.S.getViewGraphMetadata)});this.store.dispatch(new s.LL(Ce)),this.store.dispatch(new k.IA(ye.id))}playChapterFromStart(){this.store.dispatch(new s.K6)}resetCamera(){const Ce=this.store.selectSnapshot(m.N.getSelectedChapter)?.camera?.location;(0,a.isNil)(Ce)||this.store.dispatch(new i.Ih(Ce))}resetChapter(){this.resetCamera();const ye=this.store.selectSnapshot(m.N.getSelectedChapterId);this.store.dispatch(new q.a.UndoAll(ye)).subscribe(()=>{this.liveAnnouncer.announce("reset complete")}),this.store.dispatch(new k.q9(!1)),this.store.dispatch(new f.S3)}resetUI(){const ye=this.store.selectSnapshot(se.dF.getUI);this.viewUIService.isUIHidden()?Object.keys(ye).forEach(Ce=>{ye[Ce].status=u.Q.Hide}):(this.store.selectSnapshot(W.j.getQuizModeActive)||(ye.drawer.status=ye.drawer.isExpandedInitially?u.Q.Show:u.Q.Hide),Object.keys(ye).forEach(xe=>{ye[xe].userStatusPreference?ye[xe].status=ye[xe].userStatusPreference:xe!==X.U.Drawer&&(ye[xe].status=u.Q.Show)}),ye.search.status=u.Q.Collapse,ye.visibilityLayers.status=u.Q.Collapse,ye.nodeInfo.status=u.Q.Hide,ye.media.status=u.Q.Collapse,ye.quizPrompt.status=this.store.selectSnapshot(W.j.hasQuiz)?u.Q.Show:u.Q.Hide),this.store.dispatch(new oe.p.SetUI(ye))}resetContentMode(){const Ce=this.store.selectSnapshot(W.j.getQuizModeActive)?Y.G.Quiz:Y.G.ChapterInfo;this.store.dispatch(new h.B.SetContentMode(Ce))}undo(){this.store.dispatch(new q.a.Undo(this.store.selectSnapshot(m.N.getSelectedChapterId))).subscribe(()=>{this.liveAnnouncer.announce("undo complete")})}redo(){this.store.dispatch(new q.a.Redo(this.store.selectSnapshot(m.N.getSelectedChapterId))).subscribe(()=>{this.liveAnnouncer.announce("redo complete")})}toggleTools(ye){const Ce=this.store.selectSnapshot(se.dF.getUI);Ce.tools.status=(ye=ye??Ce.tools.status!==u.Q.Show)?u.Q.Show:u.Q.Collapse,this.store.dispatch(new oe.p.SetUI(Ce))}closeToolbar(){const ye=this.store.selectSnapshot(se.dF.getUI);ye.media.status=u.Q.Hide,ye.tools.status=u.Q.Hide,ye.visibilityLayers.status=u.Q.Hide,this.selectTool(P.s.Select),this.store.dispatch(new oe.p.SetUI(ye))}normalizeQueryParams(ye){const Ce={...ye};return{id:(0,c.mF)(Ce),type:(0,c.lm)(Ce),lang:ye.lang}}sanitizeRouteId(ye){return ye=ye.replace(/\.json$/,""),this.location.replaceState("view",`?id=${ye}`),ye}openInNewTab(){const ye=window.document.location.href;window.open(ye)}getComputedTransform(ye){const Je=getComputedStyle(ye).transform.replace("matrix3d","").replace("matrix","").replace("(","").replace(")","").split(",").map(dt=>dt.trim()).map(dt=>parseInt(dt,10)),ot=16===Je.length?Je[12]:Je[4],ct=16===Je.length?Je[13]:Je[5];return Number.isNaN(ot)||Number.isNaN(ct)?null:{x:ot,y:ct}}setUI(ye){let Ce=new M.XF;Ce=(0,M.Sy)(Ce,ye.quizUIConfig),Ce=(0,M.Sy)(Ce,ye.apiUIConfig),Ce=(0,M.Sy)(Ce,ye.urlUIConfig),Ce=(0,M.Sy)(Ce,ye.chapterUIConfig),Ce=(0,M.Sy)(Ce,ye.baseUIConfig),this.store.selectSnapshot(ze.U.getPrefersReducedMotion)&&(Ce.media=We.Y.Full);const xe=this.store.selectSnapshot(se.dF.getUI),Je=(0,M.Hz)(xe,Ce);this.store.dispatch(new oe.p.SetUI(Je))}setViewLanguage(ye="en"){this.store.dispatch(new h.B.SetViewLanguage(ye))}setViewLogos(ye){this.store.dispatch(new Le.v9(ye))}setHeaderLogos(ye){this.store.dispatch(new Le.vf(ye))}setAnatomyDescriptionFallback(ye){this.store.dispatch(new h.B.SetNodeInfoConfig(ye))}observeMaterialOverlay(){this.materialOverlayObserver=new MutationObserver(()=>{this.materialOverlayOut$.next(this.isMaterialOverlayOut())}),this.materialOverlayObserver.observe(this.overlayContainer.getContainerElement(),{childList:!0})}unobserveMaterialOverlay(){this.materialOverlayObserver&&this.materialOverlayObserver.disconnect(),this.materialOverlayOut$.complete()}isMaterialOverlayOut(){return this.overlayContainer.getContainerElement().childElementCount>0}isMaterialMenuOut(){return null!==this.overlayContainer.getContainerElement().querySelector("[role=menu]")}elementHasFocus(ye){return!(!ye||!ye.contains(document.activeElement))}}return(Ge=Ye).\u0275fac=function(ye){return new(ye||Ge)(l.KVO(ne.bZ),l.KVO(e.il),l.KVO(w.aZ),l.KVO(p),l.KVO(Re.u),l.KVO(Se.w),l.KVO(j.d),l.KVO(N.e),l.KVO(Ze.Ai),l.KVO(et.Sf))},Ge.\u0275prov=l.jDH({token:Ge,factory:Ge.\u0275fac,providedIn:"root"}),Ye})()},6795:(ge,F,n)=>{"use strict";n.d(F,{s:()=>C});var o,t=n(66897),e=n(29160),r=n(65294);class C{static getOfflineModelIDs(){return C._offlineModelIDs$}static setOfflineModelIDs(y){C._offlineModelIDs.next(y)}static getOfflineModelIDList(){return this._offlineModelIDs.getValue()}static setStore(y){C.store=y}static setServices(y,d){C.rpcService=y,C.applicationEventService=d}static setSnackBar(y){C.snackBar=y}static setRouter(y){C.router=y}static debug(y){this.fire(r.F.NativeDebugMessage,y)}static fire(y,d){C.applicationEventService&&C.applicationEventService.fireEvent(y,d)}on(y,d){C.rpcService&&C.rpcService.getEvent(y,!1).subscribe(d)}send(y,d){let _=null,v={};switch(y){case t.t.NativeErrorMessage:_=C.snackBar.open(d,"OK",{duration:6e3,verticalPosition:"top"}),_.onAction().subscribe(()=>{_.dismiss()});break;case t.t.NativeSetAppVersion:C.appVersion=d.appVersion;break;case t.t.NativeRedirect:v=JSON.parse(d.queryItems),C.router.navigate([d.url],{queryParams:v});break;case t.t.NativeReload:window.location.href=d.url;break;case t.t.NativeOfflineModelIds:C.setOfflineModelIDs(d.modelIds);break;default:C.debug("unprocessed HumanWindowAPI send "+y)}}}(o=C).store=null,o.snackBar=null,o.router=null,o.appVersion="",o._offlineModelIDs=new e.t([]),o._offlineModelIDs$=o._offlineModelIDs.asObservable()},66897:(ge,F,n)=>{"use strict";n.d(F,{t:()=>t});var t=function(e){return e.AnnotationsCreate="annotations.create",e.AnnotationsDestroy="annotations.destroy",e.AnnotationsInfo="annotations.info",e.AnnotationsSetDescription="annotations.setDescription",e.AnnotationsSetLabelsShown="annotations.setLabelsShown",e.AnnotationsSetTitle="annotations.setTitle",e.AnnotationsUpdate="annotations.update",e.AnnotationsSetEnabled="annotations.setEnabled",e.CameraInfo="camera.info",e.CameraOrbit="camera.orbit",e.CameraPan="camera.pan",e.CameraReset="camera.reset",e.CameraSet="camera.set",e.CameraZoom="camera.zoom",e.setCameraMode="camera.setCameraMode",e.CameraDisableChapterCamera="camera.disableChapterCamera",e.CameraEnableChapterCamera="camera.enableChapterCamera",e.GetAnnotationInfo="annotations.info",e.HideAnnotations="annotations.hide",e.HotspotsCreate="hotspots.create",e.HotspotsDestroy="hotspots.destroy",e.HotspotsHide="hotspots.hide",e.HotspotsInfo="hotspots.info",e.HotspotsShow="hotspots.show",e.HotspotsTypes="hotspots.types",e.HotspotsUpdate="hotspots.update",e.HumanInfo="human.info",e.HumanCanvasInfo="human.canvasInfo",e.InputDisable="input.disable",e.InputEnable="input.enable",e.LabelsCreate="labels.create",e.LabelsDestroy="labels.destroy",e.LabelsInfo="labels.info",e.LabelsHide="labels.hide",e.LabelsSetEnabled="labels.setEnabled",e.LabelsShow="labels.show",e.LabelsUpdate="labels.update",e.LabelsCanvasUpdate="labels.canvasUpdate",e.LabelsSetScale="labels.setScale",e.NativeErrorMessage="native.errorMessage",e.NativeSetSdkOffline="native.setSdkOffline",e.NativeSetAppVersion="native.setAppVersion",e.NativeRedirect="native.redirect",e.NativeReload="native.reload",e.NativeOfflineModelIds="native.offlineModelIDs",e.QuizInfo="quiz.info",e.QuizEnter="quiz.enter",e.QuizExit="quiz.exit",e.QuizQuestion="quiz.currentQuestion",e.QuizSubmit="quiz.submit",e.QuizNextQuestion="quiz.next",e.QuizPreviousQuestion="quiz.previous",e.QuizSelectQuestion="quiz.select",e.QuizSet="quiz.set",e.QuizReset="quiz.reset",e.SceneMetaData="scene.metadata",e.SceneSetHighlightColor="scene.setHighlightColor",e.SceneColorObject="scene.colorObject",e.SceneDisableHighlight="scene.disableHighlight",e.SceneEnableHighlight="scene.enableHighlight",e.SceneGetColor="scene.getColor",e.SceneInfo="scene.info",e.SceneLoad="scene.load",e.ScenePick="scene.pick",e.SceneReset="scene.reset",e.SceneSelectObjects="scene.selectObjects",e.SceneShowObjects="scene.showObjects",e.SceneTransformObject="scene.transformObject",e.SceneUncolorObject="scene.uncolorObject",e.SceneSnapshot="scene.snapshot",e.SceneCapture="scene.capture",e.SceneRestore="scene.restore",e.SceneEnableXrayMode="scene.enableXray",e.SceneDisableXrayMode="scene.disableXray",e.SceneSetLayersSliderPosition="scene.setLayersSliderPosition",e.SceneGetLayers="scene.getLayers",e.SceneGetPositions="scene.getPositions",e.SceneSetBaseDirectory="scene.setBaseDirectory",e.ShowAnnotations="annotations.show",e.SetAnnotationsShown="annotations.setShown",e.TimelineInfo="timeline.info",e.TimelineQuery="timeline.query",e.TimelineNext="timeline.nextChapter",e.TimelinePause="timeline.pause",e.TimelinePlay="timeline.play",e.TimelinePrev="timeline.previousChapter",e.TimelineSet="timeline.set",e.TimelineSetPlaybackSpeed="timeline.setPlaybackSpeed",e.TimelineGetPlaybackSpeed="timeline.getPlaybackSpeed",e.UIGetBackground="ui.getBackground",e.UIGetDisplay="ui.getDisplay",e.UIGetWorldPosition="ui.getWorldPosition",e.UISetBackground="ui.setBackground",e.UIPresetBackground="ui.presetBackground",e.UISetDisplay="ui.setDisplay",e.UIResetDisplay="ui.resetDisplay",e.UISnapshot="ui.snapshot",e.focusObject="focus.focusObject",e.dissectSetEnabled="dissect.setEnabled",e.pickSingleSetEnabled="pick.single.setEnabled",e.pickMultiSetEnabled="pick.multi.setEnabled",e.getCanvasPos="scene.getCanvasPos",e.sceneSetClickMode="scene.setClickMode",e.sceneGetClickMode="scene.getClickMode",e.IsolateObject="scene.isolateObject",e.UISetOndemand="ui.setOndemand",e.UISetLoadingExperience="ui.setLoadingExperience",e.UISetScrollCaptureMode="ui.setScrollCaptureMode",e.UISetTutorial="ui.setTutorial",e.UISetQuizLock="ui.setQuizLock",e.UIGetWindow="ui.getWindow",e.SceneGetVariantSchemas="scene.getVariantSchemas",e}(t||{})},63745:(ge,F,n)=>{"use strict";function C(m){const{id:i,s:c,m:a,be:l,b:p}=m;let A="";if(i)A=i;else if(l)A=l;else if(p){const O=parseInt(p,10);A=Number.isNaN(O)?"":function d(m){const c=(A,O)=>[Math.floor(A/O),A%O],a=[];let p,l=m;for(;l>0;)[l,p]=c(l,62),a.unshift("0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz"[p]);return a.join("")}(O)}else a&&(A=function _(m,i="male"){return m.includes("/")?m:`production/${i}Adult/${m}`}(a,"female"===c?"female":"male"));return E(A)}function E(m){return m.replace(/\.json$/,"")}function y(m){return C(m).includes("/")?"module":"bookmark"}n.d(F,{lm:()=>y,mF:()=>C,u2:()=>E}),n(11789)},48570:(ge,F,n)=>{"use strict";var t,e;n.d(F,{W:()=>t}),(e=t||(t={})).SetEnabled=(()=>{class _{constructor(b){this.enabled=b}}return _.type="[XR] Set XR Enabled",_})(),e.SetSession=(()=>{class _{constructor(b,P,s,g){this.active=b,this.session=P,this.sessionMode=s,this.supportedModes=g}}return _.type="[XR] Set XR Session",_})(),e.SetXRState=(()=>{class _{constructor(b){this.value=b}}return _.type="[XR] Set XR State",_})(),e.EnterXR=(()=>{class _{constructor(b="immersive-vr"){this.sessionMode=b}}return _.type="[XR] Enter XR",_})(),e.ExitXR=(()=>{class _{constructor(b=!1){this.closeTab=b}}return _.type="[XR] Exit XR",_})()},32724:(ge,F,n)=>{"use strict";n.d(F,{U:()=>v});var E,t=n(65763),e=n(48570),r=n(77994),o=n(17215),C=n(54438),y=function(b,P,s,g){var S,u=arguments.length,h=u<3?P:null===g?g=Object.getOwnPropertyDescriptor(P,s):g;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)h=Reflect.decorate(b,P,s,g);else for(var f=b.length-1;f>=0;f--)(S=b[f])&&(h=(u<3?S(h):u>3?S(P,s,h):S(P,s))||h);return u>3&&h&&Object.defineProperty(P,s,h),h},d=function(b,P){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(b,P)};let v=((E=class{constructor(P,s){this.xrService=P,this.storageService=s}ngxsOnInit(P){P.patchState({enabled:"true"===this.storageService.getLocalItem(o.UT.XREnabled)})}static getXREnabled(P){return P.enabled}static getXRActive(P){return P.active}static getXROverlayType(P){return P.session?.domOverlayState?.type||""}static getXRSessionMode(P){return P.sessionMode||""}static getXRSupportedModes(P){return P.supportedModes||{"immersive-ar":!1,"immersive-vr":!1}}static getXRError(P){return!0===P.error}static getXRRequesting(P){return P.requesting}setXRState(P,s){P.setState(s.value)}setEnabled(P,s){P.patchState({enabled:s.enabled}),this.storageService.setLocalItem(o.UT.XREnabled,s.enabled)}enterXR(P,s){P.patchState({requesting:!0}),this.xrService.enterXR(s.sessionMode).then(()=>{console.log("Enter XR Success"),P.patchState({error:!1})}).catch(g=>{console.warn("Enter XR Fail",g),P.patchState({error:!0})}).finally(()=>{P.patchState({requesting:!1})})}exitXR(P,{closeTab:s}){this.xrService.exitXR(),s&&window.close(),console.log("Exit XR Success")}setSession(P,s){P.patchState({active:s.active,session:s.session,sessionMode:s.sessionMode,supportedModes:s.supportedModes,error:!1})}}).\u0275fac=function(P){return new(P||E)(C.KVO(r.S),C.KVO(o.n$))},E.\u0275prov=C.jDH({token:E,factory:E.\u0275fac}),E);y([(0,t.rc)(e.W.SetXRState),d("design:type",Function),d("design:paramtypes",[Object,e.W.SetXRState]),d("design:returntype",void 0)],v.prototype,"setXRState",null),y([(0,t.rc)(e.W.SetEnabled),d("design:type",Function),d("design:paramtypes",[Object,e.W.SetEnabled]),d("design:returntype",void 0)],v.prototype,"setEnabled",null),y([(0,t.rc)(e.W.EnterXR),d("design:type",Function),d("design:paramtypes",[Object,e.W.EnterXR]),d("design:returntype",void 0)],v.prototype,"enterXR",null),y([(0,t.rc)(e.W.ExitXR),d("design:type",Function),d("design:paramtypes",[Object,e.W.ExitXR]),d("design:returntype",void 0)],v.prototype,"exitXR",null),y([(0,t.rc)(e.W.SetSession),d("design:type",Function),d("design:paramtypes",[Object,e.W.SetSession]),d("design:returntype",void 0)],v.prototype,"setSession",null),y([(0,t.MD)(),d("design:type",Function),d("design:paramtypes",[Object]),d("design:returntype",void 0)],v,"getXREnabled",null),y([(0,t.MD)(),d("design:type",Function),d("design:paramtypes",[Object]),d("design:returntype",void 0)],v,"getXRActive",null),y([(0,t.MD)(),d("design:type",Function),d("design:paramtypes",[Object]),d("design:returntype",void 0)],v,"getXROverlayType",null),y([(0,t.MD)(),d("design:type",Function),d("design:paramtypes",[Object]),d("design:returntype",void 0)],v,"getXRSessionMode",null),y([(0,t.MD)(),d("design:type",Function),d("design:paramtypes",[Object]),d("design:returntype",void 0)],v,"getXRSupportedModes",null),y([(0,t.MD)(),d("design:type",Function),d("design:paramtypes",[Object]),d("design:returntype",void 0)],v,"getXRError",null),y([(0,t.MD)(),d("design:type",Function),d("design:paramtypes",[Object]),d("design:returntype",void 0)],v,"getXRRequesting",null),v=y([(0,t.Uw)({name:"xr",defaults:{enabled:!1,active:!1,requesting:!1,error:!1,session:null,sessionMode:"",supportedModes:{"immersive-ar":!1,"immersive-vr":!1}}}),d("design:paramtypes",[r.S,o.n$])],v)},66915:(ge,F,n)=>{"use strict";n.d(F,{z:()=>o});var t=n(65763),e=n(32724),r=n(54438);let o=(()=>{var C;class E{}return(C=E).\u0275fac=function(d){return new(d||C)},C.\u0275mod=r.$C({type:C}),C.\u0275inj=r.G2t({imports:[t.rK.forFeature([e.U])]}),E})()},77994:(ge,F,n)=>{"use strict";n.d(F,{S:()=>u});var t=n(28407),e=n(29160),r=n(11724),o=n(65763),E=n(38472),y=n(9556),d=n(48570),_=n(54438);const v=[120,120,120,255].map(h=>h/255);let u=(()=>{var h;class S{constructor(m){this.store=m,this.presentingXR=null,this.xrState=new e.t(void 0)}initXR(m){var i=this;const{renderer:c}=m,a={"immersive-ar":!1,"immersive-vr":!1},l=function(){var p=(0,t.A)(function*(){if(i.presentingXR){const A=i.presentingXR,O=yield i.getRefSpace(A.session,m);A===i.presentingXR&&(c.xrRefSpace=O)}});return function(){return p.apply(this,arguments)}}();if(!this._xr){const p=k=>(0,t.A)(function*(){const{presenting:q,session:B,sessionMode:j,supported:V}=k;if(B&&!c.xrSession){const M=yield i.getRefSpace(B,m);c.xrRefSpace=M,c.xrSession=B,B.addEventListener("reset",l)}q?i.presentingXR=k:k===i.presentingXR&&(i.presentingXR=null,c.xrSession=null,c.xrRefSpace=null),q&&"immersive-vr"===j?m.renderer.setXRClearColor(...v):m.renderer.setXRClearColor(0,0,0,0),i.xrInputCollection&&(i.xrInputCollection.session=B),a[j]=V,i.store.dispatch(new d.W.SetSession(null!==i.presentingXR,B,i.presentingXR?.sessionMode||null,a))}),A=["local-floor","bounded-floor","hand-tracking"];c.extensions.includes("OCULUS_multiview")&&A.push("layers");const O=new r.XR("immersive-vr",{optionalFeatures:A}),L=new r.XR("immersive-ar",{requiredFeatures:["local-floor"],optionalFeatures:["dom-overlay"],domOverlay:{root:document.getElementById("viewContainer")}});this._xr={"immersive-vr":O,"immersive-ar":L},O.on("*",p(O)),L.on("*",p(L))}}destroyXR(){this._xr?.["immersive-ar"].destroy(),this._xr?.["immersive-vr"].destroy(),this._xr=null,this.presentingXR=null}enterXR(m="immersive-vr"){if(!this._xr)throw new Error("Cannot enter XR. XR service has been destroyed.");return this._xr[m].enter()}exitXR(){this.presentingXR?.exit()}initInput(m){}getRefSpace(m,i){return(0,t.A)(function*(){let c=null;try{c=yield m.requestReferenceSpace("bounded-floor")}catch{c=yield m.requestReferenceSpace("local-floor")}const{bounds:a,story:l}=i,{module:p}=l,A=E.distance(a.min,a.max),O=l.module.chapters[l.activeChapterIndex],L=O.jumpTo||O.flyTo||p.camera,k=r.vec3Pool.get(),q=r.vec3Pool.get(),B=r.vec3Pool.get(),j=r.vec3Pool.get(),V=L?.eye||p.camera?.eye;if(V){const{x:ie,y:be,z:de}=V;E.set(k,ie,be,de),E.scale(k,k,r.BIODIGITAL_SCENE_SCALE)}const M=L?.look||p.camera?.look;if(M){const{x:ie,y:be,z:de}=M;E.set(q,ie,be,de),E.scale(q,q,r.BIODIGITAL_SCENE_SCALE)}E.subtract(B,k,q),E.set(j,B[0],B[1],0);const N=[0,0,0,1],W=-Math.atan2(B[0],B[2]);y.fromEuler(N,0,180*W/Math.PI,0);const $={x:N[0],y:N[1],z:N[2],w:N[3]},ne=Math.max(.6,.6*A,E.length(j)),le={x:0,y:Math.max(1.6-k[1],-a.min[1]),z:-ne,w:1};r.vec3Pool.release(j),r.vec3Pool.release(B),r.vec3Pool.release(q),r.vec3Pool.release(k);const pe=new XRRigidTransform(le,$);return c.getOffsetReferenceSpace(pe)})()}}return(h=S).\u0275fac=function(m){return new(m||h)(_.KVO(o.il))},h.\u0275prov=_.jDH({token:h,factory:h.\u0275fac,providedIn:"root"}),S})()},24418:(ge,F,n)=>{"use strict";n.d(F,{c:()=>C});var t=n(27180),e=n(17766),r=n(12215),o=n(92811);const C={production:!0,assetDomain:"assets-human.biodigital.com",supportEmail:"support@biodigital.com",productKey:"ma_qXLcFIrsaG",googleAuthKey:"66261904577-061oin26uo7sor0vrqc8dnn105irq82n.apps.googleusercontent.com",googleAnalyticsId:"UA-1141985-30",linkedinId:"2641938",pendoId:"3a783681-e53b-4ebd-69c0-788bbae48f13",hubspotId:"23868815",recaptchaV3Key:"6LdvZvcUAAAAAM0Z1St9WQXwvSYd__hMUY2WZ6um",recaptchaV2Key:"6LdtyhsUAAAAAF-hCYS1co8ZhnAEnzHlNhRMHSxE",application:t.c.Studio,deploy:r.Z.Production,platform:o.N.Web,exportType:e.c.Bookmark,offline:!1,native:!0,minPasswordLength:8}},27180:(ge,F,n)=>{"use strict";n.d(F,{c:()=>t});var t=function(e){return e.Loft="Loft",e.Studio="Studio",e.Viewer="Viewer",e.All="",e}(t||{})},12215:(ge,F,n)=>{"use strict";n.d(F,{Z:()=>t});var t=function(e){return e.Local="Local",e.QA="QA",e.Staging="Staging",e.Production="Production",e}(t||{})},92811:(ge,F,n)=>{"use strict";n.d(F,{N:()=>t});var t=function(e){return e.Web="web",e.SDK="sdk",e}(t||{})},90699:(ge,F,n)=>{"use strict";n.d(F,{I:()=>t});var t=function(e){return e.All="all",e.iOS="ios",e.Android="android",e}(t||{})},287:(ge,F,n)=>{"use strict";n.d(F,{AY:()=>v,FV:()=>_,Nq:()=>s,dU:()=>y,kK:()=>g,sO:()=>d});var t=n(44867),e=n(56343);const E={trueWins:u=>({result:u.votesFor.length>0,dissenters:[...u.votesAgainst]}),falseWins:u=>({result:u.votesAgainst.length>0,dissenters:[...u.votesFor]}),majorityWins:u=>{const h=u.votesFor.length>u.votesAgainst.length;return{result:h,dissenters:h?[...u.votesAgainst]:[...u.votesFor]}}};function y(u,h){return u.reduce((S,f)=>(S[f]=h[f]||!1,S),{})}function d(u,h){return Object.keys(u).reduce((f,m)=>(f[m]=y(h,u[m]),f),{})}function _(u,h){const f=u.map(i=>(0,t.dV)(h,i).depth);return Math.max(0,...f)-1}function v(u,h,S){return(0,t.y$)(u,h).filter(m=>m&&(0,t.dV)(u,m).depth===S)}function s(u,h,S){return Object.keys(h).reduce((m,i)=>{const c=h[i],a=S[i]||e.t.MajorityWins,{result:l,dissenters:p}=E[a](c);return m[i]={id:u,result:l,dissenters:p,voters:[...c.votesFor,...c.votesAgainst]},m},{})}function g(u,h,S,f){const m=Object.keys(f);return{results:S.reduce((c,a)=>{const l=(0,t.IA)(u,a),p=l.map(L=>({[L]:h[L]||y(m,(0,t._D)(u,L,m))}));l.forEach(L=>{delete h[L]});const O=s(a,function b(u,h){return u.reduce((S,f)=>{const m=function P(u,h){return u.reduce((S,f)=>{const m=Object.keys(f)[0];return f[m][h]?S.votesFor.push(m):S.votesAgainst.push(m),S},{votesFor:[],votesAgainst:[]})}(h,f);return S[f]=m,S},{})}(m,p),f);return h[a]=Object.entries(O).reduce((L,[k,q])=>(L[k]=q.result,L),{}),c.push(O),c},[]),remainingVoters:h}}},44867:(ge,F,n)=>{"use strict";n.d(F,{DS:()=>E,IA:()=>b,If:()=>l,K$:()=>p,KJ:()=>B,Nk:()=>q,Sg:()=>o,TJ:()=>i,Wy:()=>f,_D:()=>P,bd:()=>O,dV:()=>d,fm:()=>m,ir:()=>_,iu:()=>y,jX:()=>g,u7:()=>L,ug:()=>u,vU:()=>A,xe:()=>s,y$:()=>v});var t=n(23881),e=n(49204);function o(j,V){y(j,V);const M=d(j,V.id);j.roots[M.id]=M}function E(j,V,M=!1,N="ascending"){const W=M?[V]:[];let $=j.predecessors[V];for(;$;)W.push($),$=j.predecessors[$];return"descending"===N&&W.reverse(),W}function y(j,V){j.nodes[V.id]||(j.nodes[V.id]=V)}function d(j,V){return j.nodes[V]??null}function _(j,V){return j.predecessors[V]??null}function v(j,V){const M=new Set;return V.forEach(N=>{const W=_(j,N);W&&M.add(W)}),Array.from(M)}function b(j,V){return[...j.successors[V]||[]]}function P(j,V,M){const N={},W=d(j,V);return Object.entries(W.boolState).forEach(([$,ne])=>{M&&M.includes($)&&(N[$]=ne)}),Object.entries(W.numState).forEach(([$,ne])=>{M&&M.includes($)&&(N[$]=ne)}),N}function s(j,V){return!!j.nodes[V]&&void 0===j.successors[V]}function g(j,V){return j.roots.hasOwnProperty(V)||!1}function u(j){return Object.keys(j.roots)}function S(j,V,M,N,W){const $=(0,t.vm)(M.objectId);$.depth=W,function h(j,V,M){Object.entries(M).forEach(([N,W])=>{const $=W(V.objectId);"boolean"==typeof $?j.boolState[N]=$:"number"==typeof $?j.numState[N]=$:j[N]=$})}($,M,N),j.nodes[$.id]=$,V?(j.successors[V]=[...j.successors[V]||[],$.id],j.predecessors[$.id]=V):j.roots[$.id]=$,W+=1,M.children.forEach(Q=>{S(j,$.id,Q,N,W)})}function f(j,V,M){M?(V(M),b(j,M).forEach(N=>{(0,e.isNil)(N)||f(j,V,N)})):u(j).forEach(N=>{V(N),f(j,V,N)})}function m(j,V){const N=(0,t.q3)();return j.forEach(W=>{S(N,null,W,V,0)}),N}function i(j,V,M){const N=[];for(const W of j){const $=V[W.objectId],ne=void 0===$?M:$,Q=i(W.children||[],V,ne);if(ne){const le={...W};le.children=Q,N.push(le)}else Q.forEach(le=>N.push(le))}return N}function c(j,V,M,N){const W=V?.[j];if("boolean"==typeof W)return W;{const $=M(j);return $?.length>0?c($,V,M,N):N}}function a(j,V,M,N){const W=M(j);return 0===W.length?N:W.some(ne=>!0===V?.[ne])||W.some(ne=>a(ne,V,M,N))}function l(j,V,M,N){const W=a(j,V,N,void 0);return!(!1===c(j,V,M,void 0)&&(!1===W||void 0===W))}function p(j,V,M){return j.reduce((N,W)=>(N[W]=N[W]??!1,N),{...V,...M})}function A(j,V=!0){const{roots:M,successors:N,predecessors:W,nodes:$}=j,ne=(0,t.q3)();for(const Q in $){const le=$[Q];if(le.boolState.available===V){ne.nodes[Q]=le;const ie=W[Q];ie&&(ne.predecessors[Q]=ie);const be=N[Q];be&&(ne.successors[Q]=be);const de=M[Q];de&&(ne.roots[Q]=de)}}return ne}function O(j){const V={};for(const M in j){const N=j[M];N.available&&(V[M]=N)}return V}function L(j,V){const M=V?.titlesToLatin??{};return Object.values(j.nodes).forEach(N=>{const W=function k(j,V){const{id:M,label:N}=V,W=j[N];if(W)return W;const ne=j[B(M)];return ne||void 0}(M,N);W&&(N.latinLabel=W)}),j}function q(j){const V=new RegExp(/\|:/,"gi");return j.replace(V,"_")}function B(j){const V=j.split("-");return 2===V.length?V[1]:V[0]}},78109:(ge,F,n)=>{"use strict";n.d(F,{w:()=>C});var t=n(287),e=n(44867);class r{}var o=n(54438);let C=(()=>{var E;class y{serializeNode(_,v,b={},P=(s=>!0)){const s={};return s.id=v.id,Object.entries(v.boolState).forEach(([g,u])=>{b.hasOwnProperty(g)&&(s[g]=u)}),Object.entries(v.numState).forEach(([g,u])=>{b.hasOwnProperty(g)&&(s[g]=u)}),_.successors[v.id]&&(s.children=[],_.successors[v.id].forEach(g=>{P(g)&&s.children.push(this.serializeNode(_,_.nodes[g],b,P))},this)),s}getAllSiblingsFromList(_,v,b){const P=[];let s;for(s=0;s<v.length;s++)this.getSiblings(_,v[s],b).forEach(g=>{P.includes(g)||P.push(g)});return P}getElectionResults(_,v,b,P){class s extends r{constructor(m,i){super(),Object.entries(m).forEach(([c,a])=>{this[c]={votesFor:[],votesAgainst:[]},Object.entries(i).forEach(([l,p])=>{p[c]?this[c].votesFor.push(l):this[c].votesAgainst.push(l)},this)},this)}}let g,u;const h=Object.keys(P),S=[];return b.forEach(f=>{u={},(0,e.IA)(_,f).forEach(c=>{u[c]=v[c]||(0,t.dU)(h,(0,e._D)(_,c,h)),delete v[c]},this),g=new s(P,u);const m=(0,t.Nq)(f,g,P);S.push(m);const i={};Object.entries(m).forEach(([c,a])=>{i[c]=a.result}),v[f]=i},this),S}updateGraphStateRecord(_,v,b,P,s=!0){b.forEach(g=>{const u=g[P[0]].id,h=(0,e._D)(_,u,P),S={};let f=!1;P.forEach(m=>{(s||g[m].result!==h[m])&&(S[m]=g[m].result,f=!0)}),f&&(v[u]=S)},this)}nodeExists(_,v){return!!_.nodes[v]}getLeaves(_){const v=[];return Object.entries(_.nodes).forEach(([b,P])=>{_.successors[b]||v.push(b)}),v}getDescendants(_,v,b=!1){const P=[];return function g(u){(0,e.IA)(_,u).forEach(h=>{P.push(h),g(h)})}(v),b&&P.push(v),P}getLeafDescendants(_,v,b=!1){const P=this.getDescendants(_,v,b).filter(s=>(0,e.xe)(_,s));return((0,e.xe)(_,v)||b)&&P.push(v),P}getAllLeafDescendants(_,v){const b=[];v.forEach(s=>{(0,e.xe)(_,s)?b.push(s):b.push(...this.getLeafDescendants(_,s,!1))});const P=new Set(b.sort());return Array.from(P)}getInverseSelection(_,v){const b=this.getAllLeafDescendants(_,v);return this.getLeaves(_).filter(P=>b.indexOf(P)<0)}getSiblings(_,v,b=!1){const P=_.predecessors[v];let s=[];if(s=P?(0,e.IA)(_,P):(0,e.ug)(_),!b){const g=s.indexOf(v);g>=0&&s.splice(g,1)}return s}getNodes(_,v){const b=[];return v.forEach(P=>{_.nodes[P]&&b.push(_.nodes[P])}),b}setState(_,v,b){const P=(0,e.dV)(_,v),s={};return Object.entries(b).forEach(([g,u])=>{"boolean"==typeof u&&P.boolState[g]!==u?(P.boolState[g]=u,s[g]=u):"number"==typeof u&&P.numState[g]!==u&&(P.numState[g]=u,s[g]=u)}),s}synchronize(_,v,b){const P=this.calculateGraphStateMap(_,v,b);return Object.entries(P).forEach(([s,g])=>{this.setState(_,s,g)},this),P}calculateGraphStateMap(_,v,b,P=!b){let s=[];const g={};let u=[];const h={},S=Object.keys(v);let f=0;for(b?Object.entries(b).forEach(([m,i])=>{g[m]=(0,t.dU)(S,b[m]),h[m]={...g[m]},f=Math.max(f,(0,e.dV)(_,m).depth)},this):this.getLeaves(_).forEach(m=>{g[m]=(0,t.dU)(S,(0,e.dV)(_,m).boolState),h[m]={...g[m]},f=Math.max(f,(0,e.dV)(_,m).depth)},this),f-=1,s=(0,t.AY)(_,Object.keys(g),f);f>=0;)u=this.getElectionResults(_,g,s,v),this.updateGraphStateRecord(_,h,u,S,P),f-=1,s=(0,t.AY)(_,Object.keys(g),f);return h}filterGraphAccessors(_,v){const P=this.getNodes(_,v).sort((u,h)=>u.depth-h.depth),s=new Map;return P.filter(u=>!s.has(u.id)&&(this.getDescendants(_,u.id,!0).forEach(h=>s.set(h,!0)),!0)).map(u=>u.id)}resetDepth(_){(0,e.Wy)(_,b=>{let P=0;_.predecessors[b]&&(P=(0,e.dV)(_,_.predecessors[b]).depth+1),(0,e.dV)(_,b).depth=P})}deleteNode(_,v,b=!0){if(!this.nodeExists(_,v))return;delete _.nodes[v];const P=_.predecessors[v];P&&(delete _.predecessors[v],_.successors[P]&&(_.successors[P]=_.successors[P].filter(g=>g!==v)));const s=_.successors[v];s&&(delete _.successors[v],b&&s.forEach(g=>{this.deleteNode(_,g)},this)),_.roots[v]&&delete _.roots[v]}resetAsLeaf(_,v){let b=[];return _.nodes[v]&&!(0,e.xe)(_,v)&&(b=this.getDescendants(_,v),delete _.successors[v],b.forEach(P=>{delete _.nodes[P],delete _.successors[P],delete _.predecessors[P]})),b}}return(E=y).\u0275fac=function(_){return new(_||E)},E.\u0275prov=o.jDH({token:E,factory:E.\u0275fac,providedIn:"root"}),y})()},56343:(ge,F,n)=>{"use strict";n.d(F,{t:()=>t});var t=function(e){return e.MajorityWins="majorityWins",e.TrueWins="trueWins",e.FalseWins="falseWins",e}(t||{})},23881:(ge,F,n)=>{"use strict";function t(E){return{id:E,depth:0,boolState:{},numState:{}}}function e(){return{nodes:{},successors:{},predecessors:{},roots:{}}}n.d(F,{YR:()=>o,ow:()=>C,q3:()=>e,vm:()=>t});class o{}function C(E=[]){return{available:()=>!0,shown:()=>!1,selected:()=>!1,pickable:()=>!0,renderable:()=>!1,expanded:()=>!1,...E.reduce((y,d)=>(y[d]=()=>!1,y),{})}}},28709:(ge,F,n)=>{"use strict";var t=n(345),e=n(54438),r=n(728),o=n(38645),C=n(85446),E=n(37925),y=n(85052),d=n(60177);const _=()=>["/explore"];function v(I,G){1&I&&(e.qex(0),e.j41(1,"div",5)(2,"div"),e.EFF(3,"Our apologies."),e.k0s(),e.j41(4,"div"),e.EFF(5,"We're unable to find the model you are looking for."),e.k0s()(),e.j41(6,"p",6),e.EFF(7,"404 Error. Content not found."),e.k0s(),e.bVm())}function b(I,G){1&I&&(e.qex(0),e.j41(1,"div",5)(2,"div"),e.EFF(3,"Our apologies."),e.k0s(),e.j41(4,"div"),e.EFF(5,"We're unable to find the page you are looking for."),e.k0s()(),e.j41(6,"p",6),e.EFF(7,"404 Error. Page not found."),e.k0s(),e.bVm())}let P=(()=>{var I;class G{constructor(x){this.route=x,this.ngUnsubscribe=new y.B}ngOnInit(){this.route.queryParams.pipe((0,E.Q)(this.ngUnsubscribe)).subscribe(x=>{this.errorType=x.errorType})}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}}return(I=G).\u0275fac=function(x){return new(x||I)(e.rXU(o.nX))},I.\u0275cmp=e.VBU({type:I,selectors:[["app-not-found"]],decls:6,vars:4,consts:[[1,"error",3,"ngSwitch"],["src","assets/images/biodigital-logo.svg",1,"error__logo"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[1,"error__button",3,"routerLink"],[1,"error__text"],[1,"error__subtext"]],template:function(x,ue){1&x&&(e.j41(0,"div",0),e.nrm(1,"img",1),e.DNE(2,v,8,0,"ng-container",2)(3,b,8,0,"ng-container",3),e.j41(4,"button",4),e.EFF(5,"Go to our home page"),e.k0s()()),2&x&&(e.Y8G("ngSwitch",ue.errorType),e.R7$(2),e.Y8G("ngSwitchCase","content"),e.R7$(2),e.Y8G("routerLink",e.lJ4(3,_)))},dependencies:[d.ux,d.e1,d.fG,o.Wk],styles:["body[_ngcontent-%COMP%]{background-color:#fff}.error[_ngcontent-%COMP%]{padding:160px;display:flex;flex-direction:column;align-items:flex-start;justify-content:center;color:#283853;font-size:16px}.error__logo[_ngcontent-%COMP%]{width:240px}.error__text[_ngcontent-%COMP%]{margin-top:32px;font-size:32px;line-height:48px;font-weight:500;letter-spacing:.025em}.error__subtext[_ngcontent-%COMP%]{font-size:20px;margin-top:32px}.error__button[_ngcontent-%COMP%]{margin-top:48px;padding:16px 24px;border-radius:4px;border:1px solid #96a8c0;font-size:16px;font-weight:500;letter-spacing:.075em;color:#374a68;text-transform:uppercase;outline:0;cursor:pointer}.error__button[_ngcontent-%COMP%]:hover{background:#eaeff5;color:#1c2a3f;border-color:#1c2a3f}@media (max-width: 1024px){.error[_ngcontent-%COMP%]{padding:10%}.error__text[_ngcontent-%COMP%]{font-size:24px;line-height:32px;letter-spacing:normal}.error__subtext[_ngcontent-%COMP%]{font-size:18px;line-height:26px}.error__button[_ngcontent-%COMP%]{font-size:14px}}@media (max-width: 768px){.error__logo[_ngcontent-%COMP%]{width:200px}.error__text[_ngcontent-%COMP%]{font-size:20px;line-height:28px}.error__subtext[_ngcontent-%COMP%]{font-size:16px;line-height:24px;margin-top:24px}.error__button[_ngcontent-%COMP%]{font-size:12px;padding:12px 20px;margin-top:32px}}"],changeDetection:0}),G})();var s=n(24418),g=n(27180);const u=[{path:"",pathMatch:"full",redirectTo:s.c.application===g.c.Studio?"/explore":"/results/modules"},{path:"dashboard",pathMatch:"full",redirectTo:s.c.application===g.c.Studio?"/results/bookmarks":"/results/modules"},{path:"explore/search",redirectTo:"results/modules"},{path:"account",loadChildren:()=>Promise.all([n.e(736),n.e(907),n.e(957),n.e(76),n.e(270)]).then(n.bind(n,42270)).then(I=>I.AccountModule)},{path:"login",loadChildren:()=>Promise.all([n.e(76),n.e(731)]).then(n.bind(n,74731)).then(I=>I.LoginModule)},{path:"results",canActivate:[C.q],loadChildren:()=>Promise.all([n.e(736),n.e(685),n.e(742),n.e(637)]).then(n.bind(n,50637)).then(I=>I.SearchModule)},{path:"explore",canActivate:[C.q],loadChildren:()=>Promise.all([n.e(736),n.e(685),n.e(76),n.e(99)]).then(n.bind(n,19099)).then(I=>I.ExploreModule)},{path:"view",loadChildren:()=>Promise.all([n.e(736),n.e(907),n.e(951),n.e(46)]).then(n.bind(n,88046)).then(I=>I.ViewInternalModule)},{path:"edit",loadChildren:()=>Promise.all([n.e(736),n.e(685),n.e(907),n.e(951),n.e(742),n.e(957),n.e(76),n.e(284)]).then(n.bind(n,25284)).then(I=>I.EditModule)},{path:"account",loadChildren:()=>Promise.all([n.e(736),n.e(907),n.e(957),n.e(76),n.e(270)]).then(n.bind(n,42270)).then(I=>I.AccountModule)},{path:"**",component:P}];let h=(()=>{var I;class G{}return(I=G).\u0275fac=function(x){return new(x||I)},I.\u0275mod=e.$C({type:I}),I.\u0275inj=e.G2t({imports:[o.iI.forRoot(u),o.iI]}),G})();n(26579);var f=n(14264),m=n(17365),i=n(11756),c=n(36110),a=n(35160),l=n(87996),p=n(35426),A=n(2573),O=n(17215),L=n(49204),k=n(65763),q=n(16823),B=n(71263),j=n(59e3),V=n(34006),M=n(21007);function N(I,G){if(1&I&&(e.j41(0,"div",7),e.EFF(1),e.j41(2,"a",8),e.EFF(3,"Contact us"),e.k0s(),e.EFF(4," if you have any questions regarding your group account. "),e.k0s()),2&I){const ee=e.XpG();e.R7$(),e.SpI(" You must be within the ",ee.organizationName," network to access this group account. "),e.R7$(),e.Y8G("href","mailto:"+ee.supportEmail,e.B4B)}}function W(I,G){if(1&I&&(e.j41(0,"div",7),e.EFF(1),e.j41(2,"a",8),e.EFF(3,"Contact us"),e.k0s(),e.EFF(4," if you have any questions regarding your group account. "),e.k0s()),2&I){const ee=e.XpG();e.R7$(),e.SpI(" You must be within the ",ee.organizationName," network to access this group account. "),e.R7$(),e.Y8G("href","mailto:"+ee.supportEmail,e.B4B)}}let $=(()=>{var I;class G{constructor(x,ue,fe){this.dialogRef=x,this.data=ue,this.storageService=fe,this.email=!1,this.ip=!1,this.supportEmail=s.c.supportEmail,this.organizationName=ue.organizationName,this.email=ue.email,this.ip=ue.ip}ngOnInit(){}handleDontShowClick(){const x=this.storageService.getLocalJSON(O.UT.GroupRestriction)||{};x.dontShowDialog=!0,this.storageService.setLocalItem(O.UT.GroupRestriction,x),this.dialogRef.close()}}return(I=G).\u0275fac=function(x){return new(x||I)(e.rXU(V.CP),e.rXU(V.Vh),e.rXU(O.n$))},I.\u0275cmp=e.VBU({type:I,selectors:[["app-group-restriction-dialog"]],decls:13,vars:4,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[1,"py-4"],["class","text-sm",4,"ngIf"],["mat-dialog-actions",""],["app-button","","buttonTheme","light","buttonType","outline",3,"click"],["app-button","","buttonType","primary","cdkFocusInitial","",3,"mat-dialog-close"],[1,"text-sm"],[3,"href"]],template:function(x,ue){1&x&&(e.j41(0,"h1",0),e.EFF(1,"Oh no, you have no access to the "),e.nrm(2,"br"),e.EFF(3),e.k0s(),e.j41(4,"div",1)(5,"div",2),e.DNE(6,N,5,2,"div",3)(7,W,5,2,"div",3),e.k0s()(),e.j41(8,"div",4)(9,"button",5),e.bIt("click",function(){return ue.handleDontShowClick()}),e.EFF(10," Don't show me this again "),e.k0s(),e.j41(11,"button",6),e.EFF(12,"Close"),e.k0s()()),2&x&&(e.R7$(3),e.SpI("",ue.organizationName," group!"),e.R7$(3),e.Y8G("ngIf",ue.ip),e.R7$(),e.Y8G("ngIf",ue.email),e.R7$(4),e.Y8G("mat-dialog-close",!0))},dependencies:[d.bT,V.tx,V.BI,V.E7,V.Yi,M.Q],changeDetection:0}),G})();var ne=n(84370),Q=n(83889),le=n(3266),pe=n(79805),ie=n(60286),be=n(60830);function de(I,G){const{procName:ee,actionFn:x,aliases:ue=[],mapFnIn:fe,mapFnOut:ve,hideDefinition:Pe=!1}=G,Ve=function(Qe){const nt=this,pt=fe?fe(Qe):Qe,Et=x(pt);if(!(typeof Et>"u"))if(Et instanceof A.c)Et.pipe((0,be.$)()).subscribe(Ke=>{const at=ve?ve(Ke):Ke;nt.setResult(at)});else{const Ct=ve?ve(Et):Et;nt.setResult(Ct)}};[ee,...ue].forEach(Qe=>{I.defineAPIProcedure(Qe,Ve,{hidden:Pe})})}var w=n(66897),te=n(7431),R=n(515),D=n(47610),T=n(82656),re=n(19833),K=n(55494),ae=n(94495),ce=n(22679),U=n(13409);function Z(I){return(0,T.z)([I.select(ae.N.getStoryChapters),I.select(K.S.getChapter)]).pipe((0,f.p)(([G,ee])=>!(0,L.isEmpty)(G)&&!!ee),(0,re.c)(0),(0,m.s)(1))}function H(I){return I.select(ae.N.getAllChaptersModelsReady).pipe((0,f.p)(G=>!0===G),(0,m.s)(1))}function J(I){return(0,T.z)([I.select(ce.t.getStory),I.select(U.z.getNodes)]).pipe((0,f.p)(([G,ee])=>!(0,L.isNil)(G)&&!(0,L.isEmpty)(ee)),(0,m.s)(1))}function Y(I){const G=I.captureCamera();return{position:G.lookAt.eye,target:G.lookAt.look,up:G.lookAt.up,zoom:G.zoom}}var xe,I,oe=n(65294),me=n(17766),Se=n(66056),Ue=n(38753),je=n(15877),Le=n(46104),Re=n(21472),Ee=n(93915),We=n(28577),ze=n(39705),Ze=n(33013),et=n(93132),rt=n(47555),Ge=n(26463),Ye=n(38472),Xe=n(34525),Ce=n(10352);(I=xe||(xe={})).isLegacyCaptureFormat=function G(ue){return void 0!==ue.engineVersion},I.convertCaptureFormat=function ee(ue){const fe=Object.keys(ue.objects).reduce((ve,Pe)=>(ve.push({objectId:Pe,selected:!1,hidden:!1}),ve),[]);return{storyId:ue.timeline.rootName.replace(".json",""),camera:{lookAt:ue.camera,zoom:void 0},labels:[],objects:fe,background:[],activeChapterId:ue.timeline.scrub?ue.timeline.scrub.chapterId:void 0}},I.convertMediaFormat=function x(ue){const fe={};return Object.entries(ue).forEach(([ve,Pe])=>{fe[ve]={fullUrl:Pe.fullUrl,lang:Pe.lang,streamType:Pe.streamType}}),fe};var Je=n(49188),ot=n(61295),ct=n(63365),dt=n(20458);let bt=(()=>{class G{}return G.type="[Analytics] Reset First Interaction",G})();var qe=n(65776),Ot=n(13491),_t=n(51640),Ft=n(11876);function Rt(I){if(!I)return null;const{objectId:G,canvasPos:ee,worldPos:x,normal:ue}=I;return{objectId:G||void 0,canvasPosition:ee?{x:ee.x,y:ee.y}:void 0,mode:"query",position:x?Ot.n.fromArray(x):void 0,normal:ue?Ot.n.fromArray(ue):void 0}}function Pt(I,G,ee){const x=I.getObjectById(ee).parent;return null!==x&&(G[x.objectId].checked||Pt(I,G,x.objectId))}function Dt(I,G,ee){const x=G.getEvent(R.X.HumanStarted).pipe((0,be.$)()),ue=ee.includes("/")?me.c.Module:me.c.Bookmark;return I.dispatch(new Se.Ye(ee,ue)),x}function kt(I,G){return I.dispatch(new D._y(!0)),G.fireEvent(R.X.SceneXrayEnabled),!0}function Jt(I){return I.find(ee=>ee.type==qe.m.Images)?.images?.filter(ee=>null!=ee.urls?.default).map(ee=>ee.urls.default)??[]}function Me(I,G,ee,x,ue,fe,ve,Pe,Ve,$e,Qe,nt,pt,Et,Ct){return[{procName:w.t.SceneMetaData,actionFn:()=>function z(I){return(0,T.z)([I.select(ce.t.getStory),I.select(ae.N.getStoryChapters)]).pipe((0,f.p)(([G,ee])=>!(0,L.isNil)(G)&&!(0,L.isEmpty)(ee)),(0,m.s)(1))}(I).pipe((0,c.T)(([Ke,at])=>({title:Ke.displayName,description:Ke.description,chapters:at.map(lt=>({id:lt.id,title:lt.displayName,description:lt.description,isAnimated:ve.isChapterAnimated(lt),loops:ve.isChapterLooped(lt),duration:ve.getChapterTimeFrame(lt.id),media:xe.convertMediaFormat(lt.media),images:lt.contentBlocks?Jt(lt.contentBlocks):[],thumbnail:lt.thumbnails?lt.thumbnails.default:""}))})))},{procName:w.t.focusObject,actionFn:Ke=>(function Kt(I,G,ee){I.select&&I.xray?kt(G,ee):(0,Je.q)(G,ee),I.select&&G.dispatch(new ot.q9(!0,[I.objectId])),G.dispatch(new D.W6(I.objectId,!0,1))}(Ke,I,ee),!0),hideDefinition:!0},{procName:w.t.dissectSetEnabled,actionFn:Ke=>(I.dispatch(new D.pL(Ke.enable?rt.s.Hide:rt.s.Select)),!0),hideDefinition:!0},{procName:w.t.sceneSetClickMode,actionFn:Ke=>(I.dispatch(new D.pL("select"===Ke?rt.s.Select:"hide"===Ke?rt.s.Hide:"fade"===Ke?rt.s.Fade:rt.s.Select)),!0)},{procName:w.t.sceneGetClickMode,actionFn:()=>I.selectSnapshot(K.S.getActiveTool)},{procName:w.t.pickSingleSetEnabled,actionFn:Ke=>{const at=(()=>{switch(Ke.enable){case void 0:return!I.selectSnapshot(Ge.Pf.getMultiPickModeEnabled);case!0:return!1;case!1:return!0}})();return I.dispatch(new et.B.SetMultiPickModeEnabled(at)),!0},hideDefinition:!0},{procName:w.t.pickMultiSetEnabled,actionFn:Ke=>{const at=void 0===Ke.enable?!I.selectSnapshot(Ge.Pf.getMultiPickModeEnabled):Ke.enable;return I.dispatch(new et.B.SetMultiPickModeEnabled(at)),!0},hideDefinition:!0},{procName:w.t.getCanvasPos,actionFn:Ke=>{const at=nt.getCanvas();return function ye(I,G,ee,x,ue){ee&&Ye.add(G,ee,G);const fe=I.getViewMat(),ve=I.getProjMat(),Pe=Xe.create();Ye.transformMat4(Pe,G,fe),Pe[3]=1,Xe.transformMat4(Pe,Pe,ve);const $e=Pe[1],Qe=Pe[3];return[Math.round((1+Pe[0]/Qe)*x/2),Math.round((1-$e/Qe)*ue/2)]}(nt,Ke.worldPos,Ke.offset,at.width,at.height)},hideDefinition:!0},{procName:w.t.SceneCapture,actionFn:()=>Z(I).pipe((0,c.T)(()=>function Gt(I,G,ee){const x=ee.captureCamera(),ue=G.selectSnapshot(U.z.getNodes),fe=Object.keys(ue).map(nt=>({objectId:nt,selected:ue[nt].checked||Pt(I,ue,nt),hidden:!ue[nt].shown})),ve=G.selectSnapshot(ae.N.getStoryChapters).map(nt=>({chapterId:nt.id,background:nt.background||Ce.RK})),Pe=G.selectSnapshot(ce.t.getStoryId);return{camera:x,labels:G.selectSnapshot(Ue.y.getLabels),storyId:Pe,objects:fe,background:ve,activeChapterId:G.selectSnapshot(ae.N.getSelectedChapterId)}}(pt,I,ue)))},{procName:w.t.SceneRestore,actionFn:Ke=>H(I).pipe((0,i.Z)(()=>{const at=xe.isLegacyCaptureFormat(Ke),lt=at?xe.convertCaptureFormat(Ke):Ke;return function zt(I,G,ee,x,ue){return Dt(ee,x,G.storyId).pipe((0,i.Z)(()=>(0,Re.H)(function wt(I,G,ee,x=!1){return new Promise(ue=>{const fe=G.objects.filter(Qe=>!0===Qe.selected).map(Qe=>Qe.objectId),ve=x?I.getLeafIds().filter(nt=>void 0===G.objects.find(Ct=>Ct.objectId===nt)):G.objects.filter(Qe=>!0===Qe.hidden).map(Qe=>Qe.objectId),Pe=G.background.map(Qe=>new Ze.qi(Qe.chapterId,Qe.background)),Ve=G.activeChapterId?[new Ze.wg(G.activeChapterId)]:[],$e=void 0!==G.camera.zoom?[new te.F5(G.camera.zoom)]:[];setTimeout(()=>{ee.dispatch([new te.Ih(G.camera.lookAt,!1),new Ee.gJ(G.labels),new ot.yr(!1,ve,void 0,void 0,void 0,!0),new ot.q9(!0,fe),...$e,...Ve,...Pe]),ue(void 0)})})}(I,G,ee,ue))),(0,ze.M)(()=>{x.fireEvent(R.X.SceneRestored)}),(0,c.T)(()=>!0))}(pt,lt,I,ee,at)}))},{procName:w.t.SceneEnableXrayMode,actionFn:()=>Z(I).pipe((0,c.T)(()=>kt(I,ee)))},{procName:w.t.SceneDisableXrayMode,actionFn:()=>Z(I).pipe((0,c.T)(()=>(0,Je.q)(I,ee)))},{procName:w.t.SceneLoad,actionFn:Ke=>H(I).pipe((0,i.Z)(()=>{G.pipe((0,k.xi)(Se.Z0),(0,m.s)(1)).subscribe(()=>{ee.fireEvent(R.X.SceneReady)});const at=Dt(I,ee,Ke);return I.dispatch(new bt),at}))},{procName:w.t.SceneSetBaseDirectory,actionFn:Ke=>(Qe.fireEvent(oe.F.NativeSetBaseDirectory,Ke),!0)},{procName:w.t.NativeSetSdkOffline,actionFn:Ke=>(Qe.fireEvent(oe.F.NativeSetSdkOffline,Ke),!0)},{procName:w.t.SceneReset,actionFn:()=>(Pe.resetChapter(),!0)},{procName:w.t.SceneInfo,actionFn:Ke=>Z(I).pipe((0,i.Z)(()=>J(I)),(0,i.Z)(([at,lt])=>{const Mt=Ke?.chapterId;let Tt=lt;Mt&&(Tt=I.selectSnapshot(U.z.getAllNodeState)[Mt]??{});const At=Ke?.objectId,Bt=At?[At]:Object.keys(pt.getObjects()),xt=!!Ke.objectId,{displayName:wn}=at;return function yt(I,G,ee,x,ue,fe,ve,Pe){const Ve=fe.map($e=>function jt(I,G,ee,x,ue,fe){const ve=ee.getObjectById(ue),{children:Pe,displayName:Ve,parent:$e,shown:Qe}=ve,nt=ee.isLeaf(ve)?G[ue].checked||Pt(ee,G,ue):void 0,pt=G[ue].available;return(fe?function Qt(I,G,ee){const x=I.selectSnapshot(Ge.Pf.getNodeInfoFallback),ue=I.selectSnapshot(Ge.Pf.getViewLanguage);return G.queryNodeInfo(ee,x,ue).pipe((0,c.T)(fe=>fe?.description||""),(0,We.W)(()=>(0,je.of)("")))}(I,x,Ve):(0,je.of)("")).pipe((0,c.T)(Ct=>({objectId:ue,name:Ve,description:Ct,available:pt,shown:Qe,selected:nt,children:Pe?.map(Ke=>Ke.objectId),parent:$e?$e.objectId:null})))}(I,G,ee,x,$e,ve));return(0,Le.p)(Ve).pipe((0,c.T)($e=>{const Qe=$e.reduce((nt,pt)=>((Pe||pt.available)&&(nt[pt.objectId]=pt),nt),{});return{name:ue,objects:Qe}}))}(I,Tt,pt,Et,wn,Bt,xt,Ke?.includeUnavailable??!Mt)}))},{procName:w.t.ScenePick,actionFn:Ke=>Rt(nt.pick(Ke.x,Ke.y))},{procName:w.t.SceneSelectObjects,actionFn:Ke=>Z(I).pipe((0,c.T)(()=>{const at=!0===Ke.replace,lt=Ke;return delete lt.replace,at&&I.dispatch(new ot.q9(!1)),I.dispatch(new ot.q9(!1,[],lt)),!0}))},{procName:w.t.SceneShowObjects,actionFn:Ke=>Z(I).pipe((0,c.T)(()=>{delete Ke.replace;const at=(Mt,Tt)=>{const At=pt.getObjectById(Mt).children;let Bt={[Mt]:Tt};for(const xt of At)void 0===Ke[xt.objectId]&&(Bt[xt.objectId]=Tt,Bt={...Bt,...at(xt.objectId,Tt)});return Bt},lt=Object.entries(Ke).reduce((Mt,[Tt,At])=>({...Mt,...at(Tt,At)}),{});return I.dispatch(new ot.yr(!1,[],lt,void 0,void 0,!0)),!0}))},{procName:w.t.IsolateObject,actionFn:Ke=>{const at="string"==typeof Ke?[Ke]:Ke,lt=I.selectSnapshot(K.S.getViewGraph),Mt=fe.getInverseSelection(lt,at),Tt=fe.getNodes(lt,Mt);return I.dispatch(new ot.yr(!1,Tt.map(At=>At.id),void 0,void 0,void 0,!0)),!0}},{procName:w.t.SceneTransformObject,actionFn:Ke=>Z(I).pipe((0,c.T)(()=>(pt.transformObject(Ke.objectId,Ke),!0)))},{procName:w.t.SceneColorObject,actionFn:Ke=>J(I).pipe((0,c.T)(()=>{const{objectId:at,tintColor:lt,saturation:Mt,contrast:Tt,brightness:At,opacity:Bt}=Ke;return I.dispatch(new ot.Jp((0,ct.H)({tintColor:lt,saturation:Mt,contrast:Tt,brightness:At,opacity:Bt}),[at])),!0}))},{procName:w.t.SceneGetColor,actionFn:Ke=>J(I).pipe((0,c.T)(()=>{const at=I.selectSnapshot(U.z.getNodePaint)(Ke.objectId);return(0,ct.Sf)(at)}))},{procName:w.t.SceneUncolorObject,actionFn:Ke=>J(I).pipe((0,c.T)(()=>(I.dispatch(new ot.Jp(dt.NR,[Ke.objectId])),!0)))},{procName:w.t.SceneDisableHighlight,actionFn:()=>(x.disableHighlight(),!0)},{procName:w.t.SceneEnableHighlight,actionFn:()=>(x.enableHighlight(),!0)},{procName:w.t.SceneSetHighlightColor,actionFn:Ke=>(x.setHighlightColor(Ke),!0)},{procName:w.t.SceneSetLayersSliderPosition,actionFn:Ke=>Z(I).pipe((0,c.T)(()=>{const{layersMode:at}=I.selectSnapshot(_t.dF.getUI).visibilityLayers;return at===Ft.Z.Group?function sn(I,G,ee){const x=(0,L.clamp)(ee.position,0,1),ue=!0===ee.record,fe=I.selectSnapshot(ae.N.getSelectedChapterId),ve=I.selectSnapshot(ae.N.getSelectedChapterLayerGroups),Pe=G.computeGroupPositionsByFraction(ve,x);return G.syncLayerGroupsToScene(Pe),G.syncLayerGroupsToState(fe,Pe,ue),!0}(I,Ve,Ke):function tn(I,G,ee){const x=I.selectSnapshot(ae.N.getSelectedChapterId),ue=I.selectSnapshot(ae.N.getSelectedChapterCurrentLayers),fe=Math.min(1,Math.max(ee.position,0)),ve=G.fractionToIndex(ue,fe),Pe=G.fractionToPosition(ue,fe,ve);return ee.record?G.syncLayersToState(x,ve,Pe):G.syncLayersToScene(ue,ve,Pe,!1),!0}(I,$e,Ke)}))},{procName:w.t.SceneGetLayers,actionFn:()=>Z(I).pipe((0,c.T)(()=>{const{layersMode:Ke}=I.selectSnapshot(_t.dF.getUI).visibilityLayers;return Ke===Ft.Z.Group?function nn(I){return[I.selectSnapshot(ae.N.getSelectedChapterLayerGroups).map(x=>x.layers).flat()]}(I):function Yt(I){return I.selectSnapshot(ae.N.getAllChaptersCurrentLayers)}(I)}))},{procName:w.t.SceneGetPositions,actionFn:()=>Z(I).pipe((0,c.T)(()=>{const Ke=Ct.findContentBlockByType(I.selectSnapshot(ae.N.getSelectedChapterContentBlocks),qe.m.Positions);return(Ke?Ke.positions:[]).map(lt=>function Be(I){const G=I.camera.location;return{title:I.title,camera:{position:G.eye,target:G.look,up:G.up}}}(lt))}))},{procName:w.t.SceneGetVariantSchemas,actionFn:()=>Z(I).pipe((0,c.T)(()=>I.selectSnapshot(ce.t.getVariantSchemas)))}]}function De(I,G,ee,x){I.defineAPIEvent(G,{events:ee||[G],map:x||(ue=>ue)})}var st=n(11724);function mt(I){return I.selectSnapshot(K.S.getPlaybackSpeed)}var ft=n(12347);let we=(()=>{class G{constructor(x){this.enabled=x}}return G.type="[Widget] Set Input Enabled",G})(),vt=(()=>{class G{constructor(x){this.config=x}}return G.type="[Widget] Set API Config",G})();var xn=n(11789),un=n(24477),Wt=n(17276),Pn=n(42482),Mn=n(9592),Ut=n(76016),Tn=n(82323),Dn=n(29160),In=n(92811),Gn=n(65855),Zt=n(50677);function Es(I){return xn.T.getColors(I).map(ee=>ee[255])}function bs(I,G){const ee=I.selectSnapshot(ae.N.getSelectedChapterBackground),{colors:x,colorStops:ue,gradientType:fe}=ee,ve=G.gradientType||fe,Pe=G.colorStops||ue;if(G.colors){const[Ve,$e]=G.colors;return{colors:[...Ve,...$e],gradientType:ve,colorStops:Pe}}return{colors:x,gradientType:ve,colorStops:Pe}}function Cs(I){return Object.entries(Wt.U).reduce((G,[ee,x])=>x===I?ee:G,"None")}var Os=n(76872);function An(I){return I.selectSnapshot(Ue.y.getChapterLabels)}function Ps(I,G){return function vo(I,G){return I.find(ee=>G===ee.id)}(An(I),G)}function zn(I,G){const ee=I.getMarkerById(G.id),x=I.getMarkerWorldPosition(ee);return{annotationId:G.id,objectId:G.objectId||null,title:G.title,description:G.description,shown:G.shown,occludable:G.occludable,position:x?Ot.n.fromArray(x):null,canvasPosition:ee?{x:ee.canvasPosition[0],y:ee.canvasPosition[1]}:null}}function Wn(I,G){const ee=Ps(I,G.annotationId);return ee?{...ee,...G}:null}function Vn(I,G){return G&&I.dispatch(new Ee.lb(G)),!0}function $n(I,G){return I.dispatch(new Ee.eH(G)),!0}function Ms(I,G){return I.reduce((ee,x)=>({...ee,[`${x}`]:G}),{})}function Kn(I,G){return function To(I,G){return Object.entries(I).filter(([ee,x])=>G(ee,x)).reduce((ee,[x,ue])=>({...ee,[`${x}`]:ue}),{})}(I,(ee,x)=>x===G)}function Ts(I,G){return Object.keys(Kn(I,G))}function Ds(I,G,ee){return function Eo(I,G){return I.filter(ee=>G.includes(ee.id))}(I,Ts(G,ee))}function Is(I,G,ee){const x=Ts(G,ee).map(fe=>function bo(I,...G){const ee=G.map(ue=>I.filter(ve=>ue===ve.objectId));return function So(I){const G=new Set(I);return Array.from(G.values())}([].concat(...ee))}(I,fe)).map(fe=>fe.map(ve=>ve.id));return Ms([].concat(...x),ee)}function Ao(I,G){return[{eventName:oe.F.AnnotationsCreated,aliasEvents:[oe.F.LabelsCreated],mapFn:ee=>zn(I,ee)},{eventName:oe.F.AnnotationsDestroyed,aliasEvents:[oe.F.LabelsDestroyed],mapFn:ee=>({annotationId:ee.id})},{eventName:oe.F.AnnotationsShown,aliasEvents:[oe.F.LabelsEnabled],mapFn:()=>!0},{eventName:oe.F.AnnotationsHidden,aliasEvents:[oe.F.LabelsDisabled],mapFn:()=>!0}]}function Ro(I,G,ee,x){return[{procName:w.t.AnnotationsInfo,actionFn:()=>An(I),mapFnOut:ue=>function Oo(I,G){return G.reduce((ee,x)=>(ee[x.id]=zn(I,x),ee),{})}(ee,ue)},{procName:w.t.AnnotationsCreate,mapFnIn:ue=>function Co(I,G,ee,x){const ue=G.selectSnapshot(ae.N.getSelectedChapter),fe=I.getObjectById(x.objectId)?x.objectId:void 0;return ee.deserializeAnnotation({annotationId:x.annotationId,title:x.title,description:x.description,objectId:fe,pos:x.position,occludable:x.occludable,labelOffset:x.labelOffset,shown:x.shown,labelShown:x.shown},ue,Os.D.Annotation)}(x,I,G,ue),actionFn:ue=>function Po(I,G){return G.objectId?(I.dispatch(new Ee.Sh(G,!0)),G):null}(I,ue),mapFnOut:ue=>ue?zn(ee,ue):null},{procName:w.t.AnnotationsUpdate,mapFnIn:ue=>Wn(I,ue),actionFn:ue=>Vn(I,ue)},{procName:w.t.AnnotationsSetTitle,mapFnIn:ue=>Wn(I,ue),actionFn:ue=>Vn(I,ue),hideDefinition:!0},{procName:w.t.AnnotationsSetDescription,mapFnIn:ue=>Wn(I,ue),actionFn:ue=>Vn(I,ue),hideDefinition:!0},{procName:w.t.AnnotationsDestroy,mapFnIn:ue=>Ps(I,ue),actionFn:ue=>function Mo(I,G){return G&&I.dispatch(new Ee.vx(G)),!0}(I,ue)},{procName:w.t.ShowAnnotations,actionFn:()=>$n(I,!0)},{procName:w.t.SetAnnotationsShown,actionFn:()=>$n(I,!0),hideDefinition:!0},{procName:w.t.HideAnnotations,actionFn:()=>$n(I,!1)},{procName:w.t.AnnotationsSetLabelsShown,mapFnIn:ue=>function Do(I,G){const{annotations:ee,objects:x,replace:ue}=G,ve=ee||{},Pe=x||{},Ve=An(I),$e={...Kn(ve,!0),...Kn(ve,!1),...Is(Ve,Pe,!0),...Is(Ve,Pe,!1)};return ue?{...Ms(Ve.map(Qe=>Qe.id),!1),...$e}:$e}(I,ue),actionFn:ue=>function Io(I,G){const ee=An(I),x=Ds(ee,G,!1),ue=Ds(ee,G,!0);I.dispatch(new Ee.D3(ue,!0)),I.dispatch(new Ee.D3(x,!1))}(I,ue),hideDefinition:!0}]}var on=n(20714),pn=n(24151);const Lo={};function As(I,G){G.hasOwnProperty("data")&&(G[I]=G.data)}const Vt={hotspotSeedId:0,hotspotIdMap:new Map,getHotspotMap:I=>{const{hotspotIdMap:G,createHotspotId:ee}=Vt;return I.selectSnapshot(Ue.y.getLabels).forEach(ue=>{const fe=ue.id;typeof G.get(fe)>"u"&&ee(fe)}),G},createHotspotId:I=>(Vt.hotspotSeedId++,Vt.hotspotIdMap.set(I,Vt.hotspotSeedId),Vt.hotspotSeedId),getHotspotIdByLabel:(I,G,ee)=>{const{getHotspotMap:x,createHotspotId:ue}=Vt,ve=x(I).get(G);return ee&&typeof ve>"u"?ue(G):ve},getLabelIdByHotspotId:(I,G)=>{const ee=Vt.getHotspotMap(I),x=Array.from(ee).find(([ue,fe])=>fe===G);return x?x[0]:null}};function Rs(I,G){const ee=I.selectSnapshot(Ue.y.getLabels);return typeof G<"u"?ee.filter(x=>x.chapterId===G):ee}function Rn(I,G){const ee=Rs(I),x=Vt.getLabelIdByHotspotId(I,G);return ee.find(ue=>ue.id===x)}function Ls(I){return I===on.H.CirclePlus?pn.O.Plus:I===on.H.CircleMinus?pn.O.Minus:pn.O.Default}function Hn(I,G){return Vt.getHotspotIdByLabel(I,G)}function Ln(I,G){return{...G,id:Hn(I,G.id)}}function Us(I,G,ee){const x=G.selectSnapshot(ae.N.getStoryChapters);return ee.map(ue=>function ko(I,G,ee,x){const{id:ue,chapterId:fe,title:ve,objectId:Pe}=x,Ve=ee.findIndex(Et=>fe===Et.id),$e=Vt.getHotspotIdByLabel(G,ue,!0),Qe=I.getMarkerById(ue),nt=I.getMarkerWorldPosition(Qe),pt=Qe?.marker3D?.direction;return{id:$e,title:ve,objectId:Pe,position:nt?Ns(nt):null,direction:pt?Ns(pt):null,canvasPosition:Qe?Bo(Qe.canvasPosition):null,chapterScope:Ve,type:x.pinType===pn.O.PlusMinus?on.H.CirclePlus:on.H.Circle,shown:x.shown,data:Lo[x.id]}}(I,G,x,ue))}function Ns(I){return{x:I[0],y:I[1],z:I[2]}}function Un(I){return[I.x,I.y,I.z]}function Bo(I){return{x:I[0],y:I[1]}}function Fs(I,G,ee){return I.dispatch(new Ee.D3(G,ee)),!0}function Xn(I,G){if("number"==typeof G){const ee=Rn(I,G);return ee?[ee]:[]}return Rs(I)}function Wo(I){return[{eventName:oe.F.HotspotsEntered,mapFn:G=>Ln(I,G)},{eventName:oe.F.HotspotsLeft,mapFn:G=>Ln(I,G)},{eventName:oe.F.HotspotsPicked,mapFn:G=>Ln(I,G)},{eventName:oe.F.HotspotsDisplayUpdated,mapFn:G=>Ln(I,G)},{eventName:oe.F.HotspotsPositionUpdated,mapFn:G=>function No(I,G){const{id:ee,canvasPos:x}=G,{x:ue,y:fe}=x;return{id:Hn(I,ee),canvasPosition:{x:ue,y:fe,0:ue,1:fe},occluded:G.occluded}}(I,G)}]}function Vo(I,G,ee){return[{procName:w.t.HotspotsInfo,actionFn:x=>{const ue="number"==typeof x?x:void 0;if(void 0!==ue){const fe=Rn(I,ue);return Us(ee,I,[fe])[0]}{const fe=Xn(I,ue);return Us(ee,I,fe)}}},{procName:w.t.HotspotsTypes,mapFnIn:()=>function jo(){return Object.values(on.H).map(I=>`${I}`)}(),actionFn:x=>x},{procName:w.t.HotspotsCreate,mapFnIn:x=>function Uo(I,G,ee){const{title:x,objectId:ue,position:fe,direction:ve,chapterScope:Pe,type:Ve}=ee,$e=I.selectSnapshot(ae.N.getStoryChapters),Qe=I.selectSnapshot(ae.N.getSelectedChapter),nt=I.selectSnapshot(ae.N.getSelectedChapterIndex),pt="number"==typeof Pe?Pe:nt,Et=$e[pt]||Qe,Ct=!1!==ee.shown,at={title:x,type:Ve||on.H.CircleLabel,objectId:ue,pos:fe?Un(fe):null,dir:ve?Un(ve):null,shown:Ct,symbol:"",className:""},lt=G.deserializeHotspots({},Et,pt,at);return lt.title=x,lt.flyTo=!1,lt.flyToTarget=null,lt.occludable=!0,lt.pinGlow=!1,lt.pinType=pn.O.PlusMinus,lt.shown=Ct,lt.hideWire=!0,lt.theme=Os.D.StudioNext,lt.pinType=Ls(Ve),As(lt.id,ee),lt}(I,G,x),actionFn:x=>function wo(I,G){return G.objectId?(I.dispatch(new Ee.Sh(G,!0)),G):null}(I,x),mapFnOut:x=>x?Hn(I,x.id):null},{procName:w.t.HotspotsUpdate,mapFnIn:x=>function zo(I,G){const ee=Rn(I,G.id);return ee?function Fo(I,G){const{title:ee,objectId:x,direction:ue,position:fe,shown:ve,type:Pe}=I,Ve={...G,title:ee,objectId:x,shown:ve,pos:fe?Un(fe):null,dir:ue?Un(ue):null,pinType:Pe?Ls(Pe):null};return As(G.id,I),{...G,...(0,L.omitBy)(Ve,L.isNil)}}(G,ee):null}(I,x),actionFn:x=>x?function xo(I,G){return I.dispatch(new Ee.lb(G)),G}(I,x):null},{procName:w.t.HotspotsDestroy,mapFnIn:x=>Rn(I,x),actionFn:x=>x?function Go(I,G){return I.dispatch(new Ee.vx(G)),G}(I,x):null},{procName:w.t.HotspotsShow,mapFnIn:x=>Xn(I,x),actionFn:x=>Fs(I,x,!0)},{procName:w.t.HotspotsHide,mapFnIn:x=>Xn(I,x),actionFn:x=>Fs(I,x,!1)}]}var $o=n(49746),Ko=n(1300),Ho=n(59429),ks=n(16124),Xo=n(95370);function Bs(I){return I.selectSnapshot(Ue.y.getChapterLabels)}function js(I,G){return I.dispatch(new Ee.eH(G)),!0}function rn(I,G){return Bs(I).find(x=>G===x.id)}function Qn(I,G){return Bs(I).filter(x=>G.includes(x.id))}function Jn(I,G,ee){return G&&G.objectId?(I.dispatch(ee?new Ee.Sh(G,!0):new Ee.lb(G)),G):null}function ws(I,G){const ee=document.createElement("span");return ee.innerHTML=I,(0,L.trim)(ee.textContent).length<=G}function xs(I,G){const ee=(0,L.cloneDeep)(I);return ee.title=G.title&&ws(G.title,100)?G.title:ee.title,ee.description=G.description&&ws(G.description,300)?G.description:ee.description,ee.theme=G.theme||ee.theme,ee.pinType=G.pinType||ee.pinType,ee.sequentialType=G.sequentialType||ee.sequentialType,ee.offset=function Zo(I,G){return G||[-(I.hideWire?20:32),0]}(ee,G.labelOffset),ee.pinGlow=void 0!==G.pinGlow?G.pinGlow:ee.pinGlow,ee.hideWire=void 0!==G.hideWire?G.hideWire:ee.hideWire,ee.hideTag=void 0!==G.hideTag?G.hideTag:ee.hideTag,ee.collapseDescription=void 0!==G.collapseDescription?G.collapseDescription:ee.collapseDescription,ee.occludable=void 0!==G.occludable?G.occludable:ee.occludable,ee.cameraPosition=G.flyToCamera||ee.cameraPosition,ee.flyTo=function qo(I,G){return!1!==G&&(G||I.flyTo)}(ee,G.flyTo),ee.states=function ei(I){if(!I.flyTo)return[];const G=[new ks.B,new ks.B];G[0].errands=[new Ko.T],G[1].errands=I.cameraPosition?[new Xo.v(I.cameraPosition)]:[new $o.F(I.objectId)]}(ee),ee}function an(I,G){if(G){const ee=I.getMarkerById(G.id),x=I.getMarkerWorldPosition(ee);return{labelId:G.id,objectId:G.objectId,title:G.title,description:G.description,theme:G.theme,pinType:G.pinType,labelOffset:G.offset,hideWire:G.hideWire,pinGlow:G.pinGlow,occludable:G.occludable,sequentialType:G.sequentialType,shown:G.shown,collapseDescription:G.collapseDescription,hideTag:G.hideTag,flyTo:!0===G.flyTo,flyToCamera:G.cameraPosition,position:x??G.pos,canvasPosition:ee?.canvasPosition??[-1,-1],occluded:ee?.occluded??!0}}return null}function Gs(I,G){return G.reduce((ee,x)=>(ee[x.id]=an(I,x),ee),{})}var si=n(8358),oi=n(78109),zs=n(39358),Nn=function(I){return I.Widget="widget",I.WidgetAPI="widgetapi",I}(Nn||{}),ii=n(64566),ri=n(24552),ln=n(43753),Ht=n(87710),Fn=n(76774);function Yn(I){return I.selectSnapshot(Ht.j.getAllQuestions)}function Zn(I,G){return Yn(I).find(ee=>ee.id===G)}function Ws(I){return Zn(I,es(I))}function cn(I){return{enabled:I.selectSnapshot(Ht.j.getQuizEnabled),active:I.selectSnapshot(Ht.j.getQuizModeActive),questions:pi(Yn(I)),questionId:es(I),submissions:li(I,qn(I))}}function li(I,G){return G.map(ee=>Vs(I,ee))}function Vs(I,G){const ee=Ws(I);return{questionId:G.questionId,answerIds:ee.data.correctAnswer,correctAnswerIds:ss(ee),correct:(0,Fn.Br)(ee,G.answer)}}function qn(I){return I.selectSnapshot(Ht.j.getAllSubmissions)}function es(I){return I.selectSnapshot(Ht.j.getActiveQuestionId)}function ts(I){const G=Ws(I),ee=function ai(I){return qn(I).find(ee=>ee.questionId===es(I))}(I);return{question:ns(G),submission:ee?Vs(I,ee):void 0}}function $s(I){return I.map(G=>function ci(I){const G=I.type;switch(G){case qe.m.Markdown:{const{markdown:ee}=I;return{type:G,content:ee}}case qe.m.Images:{const{images:ee}=I;return{type:G,content:ee.map(ue=>ue.urls.default)}}default:return{type:G,content:""}}}(G))}function ns(I){let G=[],ee="";switch(I.type){case ln.Q5.MultipleChoice:{const x=I.data;G=function di(I){return I.map(G=>function ui(I){return{answerId:I.value,displayText:I.label}}(G))}(x.options),ee=x.correctAnswer;break}case ln.Q5.SelectAnatomy:G=I.data.correctAnswer.map(ue=>({answerId:ue,displayText:ue})),ee="";break;case ln.Q5.LabelAnatomy:G=I.data.options.map(ue=>({answerId:ue.value,displayText:ue.label.title})),ee=""}return{questionId:I.id,questionType:I.type,questionPrompt:$s(I.questionPrompt),answerExplanation:$s(I.explanation),answers:G,answerId:ee}}function pi(I,G){const ee=I.map(x=>ns(x));return typeof G<"u"?ee.filter(x=>G.includes(x.questionId)):ee}function ss(I){const G=ns(I);switch(G.questionType){case ln.Q5.LabelAnatomy:case ln.Q5.SelectAnatomy:return G.answers.map(({answerId:ee})=>ee);case ln.Q5.Instructions:return["-"];default:return[G.answerId]}}var _i=n(30607),mi=n(28407),gn=n(21626),os=n(40470),fi=n(69984),yi=n(41981);class is{}class Si{}class vi{}const Ei={headers:new gn.Lr({"Content-Type":"application/json; charset=utf-8"})},Ks="127.0.0.1";let bi=(()=>{var I;class G{constructor(x,ue){this.http=x,this.storageService=ue}getAnalytic(x){return s.c.offline?(fetch("https://human.biodigital.com/ws/user/analytics?analytic_id="+x,{method:"GET",mode:"no-cors"}),(0,je.of)({success:!0})):this.http.get("/ws/user/analytics?analytic_id="+x).pipe((0,c.T)(()=>({success:!0})),(0,We.W)(fe=>(0,je.of)(this.parseError(fe))))}sendAnalytic(x){if(s.c.offline){const ve=x instanceof is?"https://human.biodigital.com/ws/user/analytics":"https://human.biodigital.com/ws/developer/apps/access/key",Pe=(0,fi.stringify)(x);if(navigator.onLine)this.sendOfflineAnalytic(ve,Pe),this.sendSavedOfflineMessages(ve);else{const $e="offline_event=1&event_timestamp="+(new Date).toISOString().substring(0,19)+"&"+Pe;this.storageService.setDatabaseAnalyticItem({url:ve,message:$e})}return(0,je.of)({success:!0})}return this.http.post(x instanceof is?"/ws/user/analytics":"/ws/developer/apps/access/key",x,Ei).pipe((0,c.T)(()=>({success:!0})),(0,We.W)(ve=>(0,je.of)(this.parseError(ve))))}sendOfflineAnalytic(x,ue){var fe=this;return(0,mi.A)(function*(){fetch(x,{headers:{"Content-Type":"application/x-www-form-urlencoded"},method:"POST",mode:"no-cors",body:ue}).catch(()=>{navigator.onLine?setTimeout(()=>{fetch(x,{headers:{"Content-Type":"application/x-www-form-urlencoded"},method:"POST",mode:"no-cors",body:ue})},300):fe.storageService.setDatabaseAnalyticItem({url:x,message:ue})})})()}sendSavedOfflineMessages(x){this.storageService.getDatabaseOfflineAnalytics(ue=>{ue.forEach(fe=>{this.sendOfflineAnalytic(fe.url??x,fe.message)})})}buildUserAnalytic(x,ue,fe){const{widgetUrlConfig:ve,parentUrl:Pe}=x,Ve=ve.uaid,$e=Pe.domain,Qe={...this.buildAppActivityData(x),parent_analytic_identifier:Ve,referer_domain:$e,[`${ue}_source`]:fe},nt={analytic_platform:Nn.Widget,analytic_type:ue,analytic_data:Qe};return s.c.offline&&(nt.app_domain=Ks),(0,os.bj)(is,nt)}buildDeveloperAnalytic(x,ue,fe=Nn.Widget,ve){const{widgetUrlConfig:Pe,parentUrl:Ve,embedded:$e}=x;return(0,os.bj)(Si,{platform:fe,app_activity:ue,app_productkey:Pe["app-productkey"],app_userid:Pe["app-userid"],app_apikey:Pe.dk,app_domain:s.c.offline?Ks:Ve.full,app_activity_data:ve,widget_is_fullscreen:!$e})}buildAppActivityData(x){const{engineVersion:ue,engineAPIVersion:fe,widgetUrlConfig:ve}=x,Pe={engine_version:ue,api_version:fe};return Object.entries(ve).filter(([Ve])=>"dk"!==Ve).forEach(([Ve,$e])=>{Pe[`url_param_${Ve}`]=$e}),(0,os.bj)(vi,Pe)}parseError(x){if(s.c.offline)return{success:!0,message:"",errorCode:null};const ue=x.error.error,fe=x.status,Pe=ue&&ue.message?ue.message:"";return{success:fe>=500&&fe<=504,message:Pe,errorCode:Object.values(yi.U).includes(Pe)?Pe:null}}}return(I=G).\u0275fac=function(x){return new(x||I)(e.KVO(gn.Qq),e.KVO(O.n$))},I.\u0275prov=e.jDH({token:I,factory:I.\u0275fac,providedIn:"root"}),G})();var Hs=function(I){return I.Init="init",I.View="view",I.ChanceInteraction="interactionc",I.FirstInteraction="interactionf",I.Call="call",I}(Hs||{}),rs=n(76718),as=n(26655),ls=n(83621);class Oi{constructor(G,ee,x){this.subject=G,this.callId=ee,this.procedureName=x}setResult(G){const{callId:ee,procedureName:x}=this;this.subject.next({callId:ee,value:G,procedureName:x})}}const Pi=Object.values(R.X),Mi=Object.values(oe.F);let cs=(()=>{var I;class G{constructor(x,ue){this.engineService=x,this.applicationEventService=ue,this.proceduresMap={},this.hiddenProcedures={},this.eventsMap={},this.resultsSubject=new y.B,this.logEntries=[],this.ngUnsubscribe=new y.B,this.init()}getAPIProcedureNames(){return Object.keys(this.proceduresMap).filter(x=>!(!0===this.hiddenProcedures[x]))}getAPIEventNames(){const x=Object.keys(this.eventsMap);return[R.X.HumanReady,...x]}logAPIProcedure(x){this.logEntries.length>1e4&&this.logEntries.shift(),this.logEntries.push({engine_version:as.A,api_version:as.m,identifier:x,category:x.split(".")[0]})}getAPILog(){return this.logEntries}resetAPILog(){this.logEntries.length=0}callAPIProcedure(x,ue,fe){const ve=this.proceduresMap[ue];ve?ve(x,fe):console.warn("API:",`Target procedure not found: ${ue}`)}defineAPIEvent(x,ue){this.eventsMap[x]&&console.warn("API:",`Redefining event: ${x}`),this.eventsMap[x]=ue||x}defineAPIProcedure(x,ue,fe){this.proceduresMap[x]&&console.warn("API:",`Redefining procedure: ${x}`),this.hiddenProcedures[x]=!0===fe?.hidden,this.proceduresMap[x]=(ve,Pe)=>{ue.call(new Oi(this.resultsSubject,ve,x),Pe??{})}}onResults(){return this.resultsSubject.asObservable()}getEvent(x,ue){let fe;if(Pi.includes(x)?fe=this.engineService.getEvent(x):Mi.includes(x)&&(fe=this.applicationEventService.getEvent(x)),!(0,L.isNil)(fe))return ue?fe.pipe((0,m.s)(1)):fe}init(){const x=this;this.defineAPIProcedure("apiEvents.on",function(ue){x.enableEvent.call(x,this,ue,!1)},{hidden:!0}),this.defineAPIProcedure("apiEvents.once",function(ue){x.enableEvent.call(x,this,ue,!0)},{hidden:!0})}enableEvent(x,ue,fe){if(!this.eventsMap[ue])return void console.warn("API:",`Event: ${ue} not defined.`);const ve=this.eventsMap[ue];if("string"==typeof ve){const Pe=this.getEvent(ve,fe);Pe?Pe.subscribe(Ve=>{x.setResult(Ve)}):console.warn("API:",`Error defining event: ${ue}`)}else this.mapEvents(x,ve,fe)}mapEvents(x,ue,fe){const ve=ue.events,Pe=ue.map;ue.init&&ue.init();const $e=ve.map(Qe=>{const nt=this.getEvent(Qe,fe);if(nt)return nt;console.warn("API:",`Error defining event: ${Qe}`)}).filter(Qe=>!(0,L.isNil)(Qe));(0,rs.h)(...$e).subscribe(function Ve(Qe){const nt=Pe?Pe(Qe):Qe;null!==nt&&x.setResult(nt||{})})}}return(I=G).\u0275fac=function(x){return new(x||I)(e.KVO(pe.y),e.KVO(ls.S))},I.\u0275prov=e.jDH({token:I,factory:I.\u0275fac,providedIn:"root"}),G})(),Ti=(()=>{var I;class G{constructor(x,ue,fe){this.engineService=x,this.rpcService=ue,this.zone=fe,this.responseQueue=[],this.listening=!1,this.listen()}listen(){this.listening||(this.ngUnsubscribe||(this.ngUnsubscribe=new y.B),this.zone.runOutsideAngular(()=>{this._listen()}))}close(){this.ngUnsubscribe&&(this.ngUnsubscribe.next(),this.ngUnsubscribe.complete(),this.ngUnsubscribe=null,this.listening=!1)}_listen(){this.listening=!0,this.engineService.getEvent(R.X.Started).pipe((0,E.Q)(this.ngUnsubscribe)).subscribe(()=>{this.sendResponse({message:"status",status:"ready"})}),this.rpcService.onResults().pipe((0,E.Q)(this.ngUnsubscribe)).subscribe(({callId:x,value:ue})=>{this.sendResponse({results:{[x]:ue}})}),(0,p.R)(window,"message").pipe((0,E.Q)(this.ngUnsubscribe)).subscribe(x=>{const ue=this.getClientRequest(x.data);if(!ue)return;const{action:fe,call:ve}=ue;"connect"===fe?this.client||(this.client=x.source,this.clientOrigin=x.origin,this.sendResponse({message:"connected"}),this.flushResponseQueue()):ve&&this.executeCall(ue)})}getClientRequest(x){try{return JSON.parse(x)}catch{return}}sendResponse(x){const ue=JSON.stringify(x);this.client?this.postClientMessage(ue):this.responseQueue.push(ue)}postClientMessage(x){this.client.postMessage(x,this.clientOrigin)}flushResponseQueue(){for(;this.responseQueue.length>0;)this.postClientMessage(this.responseQueue.pop())}executeCall(x){const{id:ue,call:fe,params:ve}=x;try{this.rpcService.callAPIProcedure(ue,fe,ve),this.rpcService.logAPIProcedure(fe)}catch(Pe){console.error("API:",`Error executing API call [callId: ${ue}, procedure: ${fe}]: ${Pe}`)}}}return(I=G).\u0275fac=function(x){return new(x||I)(e.KVO(pe.y),e.KVO(cs),e.KVO(e.SKi))},I.\u0275prov=e.jDH({token:I,factory:I.\u0275fac,providedIn:"root"}),G})();var Xs=n(46799),Di=n(3367),Ii=n(35650),Ri=n(79435),Li=n(17042),Ui=n(13976);let Ni=(()=>{var I;class G{constructor(x,ue,fe,ve,Pe,Ve,$e,Qe,nt,pt,Et,Ct,Ke,at,lt,Mt,Tt,At,Bt,xt,wn){this.store=x,this.actions=ue,this.cameraService=fe,this.engineService=ve,this.animationService=Pe,this.paintService=Ve,this.labelsService=$e,this.graphService=Qe,this.viewService=nt,this.analyticsService=pt,this.visibilityLayersService=Et,this.legacyVisibilityLayersService=Ct,this.quizService=Ke,this.rpcService=at,this.windowClient=lt,this.applicationEventService=Mt,this.engineRendererService=Tt,this.markerService=At,this.sceneService=Bt,this.contentInfoService=xt,this.contentBlocksService=wn}listen(x,ue){this.ngUnsubscribe||(this.ngUnsubscribe=new y.B),s.c.native&&this.initNativeEventListeners(),this.initProcedures(),this.initEvents(),x&&ue&&this.logAPIUsage(ue)}close(){this.ngUnsubscribe&&(this.ngUnsubscribe.next(),this.ngUnsubscribe.complete(),this.ngUnsubscribe=null)}logAPIUsage(x){setInterval(()=>{const fe=this.rpcService.getAPILog(),ve=(0,L.uniqBy)(fe,Pe=>Pe.identifier);if(ve.length>0){const Pe=JSON.stringify(ve),Ve=this.analyticsService.buildDeveloperAnalytic(x,Hs.Call,Nn.WidgetAPI,Pe);this.analyticsService.sendAnalytic(Ve).pipe((0,E.Q)(this.ngUnsubscribe)).subscribe({next:$e=>{},error:$e=>{throw new Error($e)}}),this.rpcService.resetAPILog()}},1e4)}initEvents(){De(this.rpcService,R.X.HumanProgress,void 0,x=>x),function Ne(I){return[{eventName:R.X.HumanReady,aliasEvents:[R.X.HumanStarted]},{eventName:R.X.Error,aliasEvents:[R.X.HumanError],mapFn:G=>G},{eventName:R.X.HumanCanvasResized,aliasEvents:[R.X.CanvasResized],mapFn:()=>I.selectSnapshot(K.S.getEnginePosition)}]}(this.store).forEach(x=>{De(this.rpcService,x.eventName,x.aliasEvents,x.mapFn)}),function Te(){return[{eventName:R.X.SceneLoaded,mapFn:()=>!0},{eventName:R.X.ScenePicked,aliasEvents:[R.X.PickPicked],mapFn:Rt},{eventName:R.X.SceneObjectsSelected,mapFn:I=>I.selectedObjectsUpdate},{eventName:R.X.SceneObjectsShown,mapFn:I=>I.enabledObjectsUpdate},{eventName:R.X.SceneReady,aliasEvents:[R.X.Started,R.X.SceneReady]},{eventName:R.X.SceneRestored,mapFn:()=>!0},{eventName:R.X.SceneXrayEnabled,mapFn:()=>!0},{eventName:R.X.SceneXrayDisabled,mapFn:()=>!0},{eventName:oe.F.NativeShare,mapFn:I=>I},{eventName:oe.F.NativeDebugMessage,mapFn:I=>I}]}().forEach(x=>{De(this.rpcService,x.eventName,x.aliasEvents,x.mapFn)}),function X(I){return[{eventName:R.X.CameraUpdated,aliasEvents:[R.X.CameraRested],mapFn:()=>Y(I)}]}(this.cameraService).forEach(x=>{De(this.rpcService,x.eventName,x.aliasEvents,x.mapFn)}),function it(){return[{eventName:R.X.TimelinePlaying,mapFn:I=>I},{eventName:R.X.TimelineCompleted,mapFn:()=>!0},{eventName:R.X.TimelineChapterTransition,mapFn:I=>({previousChapter:I.oldChapterIndex,currentChapter:I.newChapterIndex,time:I.time})}]}().forEach(x=>{De(this.rpcService,x.eventName,x.aliasEvents,x.mapFn)}),[].forEach(x=>{De(this.rpcService,x.eventName,x.aliasEvents,x.mapFn)}),function fo(){return[{eventName:oe.F.UIUpdated,mapFn:I=>(0,un.Rh)(I)},{eventName:oe.F.UIWindowUpdated,mapFn:I=>Cs(I)}]}().forEach(x=>{De(this.rpcService,x.eventName,x.aliasEvents,x.mapFn)}),function ti(I,G){return[...Ao(G),...Wo(I),{eventName:oe.F.LabelsChapterInfo,mapFn:ee=>Gs(G,ee)},{eventName:oe.F.LabelsCreated,mapFn:ee=>an(G,ee)},{eventName:oe.F.LabelsUpdated,mapFn:ee=>an(G,ee)},{eventName:oe.F.LabelsDestroyed,mapFn:ee=>({labelId:ee.id})},{eventName:oe.F.LabelsEntered,mapFn:ee=>ee},{eventName:oe.F.LabelsLeft,mapFn:ee=>ee},{eventName:oe.F.LabelsPicked,mapFn:ee=>ee},{eventName:oe.F.LabelsMoved,mapFn:ee=>ee},{eventName:oe.F.LabelsEnabled,mapFn:()=>!0},{eventName:oe.F.LabelsDisabled,mapFn:()=>!0},{eventName:oe.F.LabelsShown,mapFn:ee=>ee},{eventName:oe.F.LabelsHidden,mapFn:ee=>ee}]}(this.store,this.markerService).forEach(x=>{De(this.rpcService,x.eventName,x.aliasEvents,x.mapFn)}),function gi(I){return[{eventName:oe.F.QuizEntered,mapFn:()=>cn(I)},{eventName:oe.F.QuizExited,mapFn:()=>!0},{eventName:oe.F.QuizQuestionLoaded,mapFn:G=>G},{eventName:oe.F.QuizAnswerSelected,mapFn:G=>{const{questionId:ee,answerId:x}=G;return{questionId:ee,answerId:x,correctAnswerIds:ss(Zn(I,G.questionId))}}},{eventName:oe.F.QuizAnswerSubmitted,mapFn:G=>{const ee=Zn(I,G.questionId),x=ss(ee);return{questionId:G.questionId,answerIds:G.answer,correctAnswerIds:x,correct:(0,Fn.Br)(ee,G.answer)}}},{eventName:oe.F.QuizCompleted,mapFn:()=>{const G=Yn(I),ee=qn(I);return(0,Fn.MH)(G,ee)}}]}(this.store).forEach(x=>{De(this.rpcService,x.eventName,x.aliasEvents,x.mapFn)}),function Ai(){return[{eventName:oe.F.WhiteboardDrawingStarted,mapFn:()=>!0},{eventName:oe.F.WhiteboardDrawingFinished,mapFn:()=>!0},{eventName:oe.F.WhiteboardModeUpdated,mapFn:I=>({mode:I})}]}().forEach(x=>{De(this.rpcService,x.eventName,x.aliasEvents,x.mapFn)})}initProcedures(){(function He(I,G,ee,x){return[{procName:w.t.HumanInfo,actionFn:()=>({version:I,webglInfo:G.getWEBGLInfo(),apiFunctions:ee.getAPIProcedureNames().sort(),apiEvents:ee.getAPIEventNames().sort()})},{procName:w.t.HumanCanvasInfo,actionFn:()=>x.selectSnapshot(K.S.getEnginePosition)}]})(as.A,this.engineService,this.rpcService,this.store).forEach(x=>{de(this.rpcService,x)}),Me(this.store,this.actions,this.engineService,this.paintService,this.cameraService,this.graphService,this.animationService,this.viewService,this.visibilityLayersService,this.legacyVisibilityLayersService,this.applicationEventService,this.engineRendererService,this.sceneService,this.contentInfoService,this.contentBlocksService).forEach(x=>{de(this.rpcService,x)}),function se(I,G){return[{procName:w.t.CameraInfo,actionFn:()=>Z(I).pipe((0,c.T)(()=>Y(G)))},{procName:w.t.CameraOrbit,actionFn:ee=>Z(I).pipe((0,c.T)(()=>(I.dispatch(new te.RJ(void 0===ee.pitch?0:ee.pitch,void 0===ee.yaw?0:ee.yaw)),!0)))},{procName:w.t.CameraPan,actionFn:ee=>Z(I).pipe((0,c.T)(()=>(I.dispatch(new te.bB(void 0===ee.x?0:ee.x,void 0===ee.y?0:ee.y,void 0===ee.z?0:ee.z)),!0)))},{procName:w.t.CameraReset,actionFn:()=>Z(I).pipe((0,i.Z)(()=>I.dispatch(new te.nW)))},{procName:w.t.CameraSet,actionFn:ee=>Z(I).pipe((0,c.T)(()=>{const x=ee.animate||!1;if(ee.objectId)return I.dispatch(new D.W6(ee.objectId,x,ee.animationDuration)),!0;const ue=Y(G);return I.dispatch(new te.Ih({eye:ee.position||ue.position,look:ee.target||ue.target,up:ee.up||ue.up},x)),!0}))},{procName:w.t.CameraZoom,actionFn:ee=>Z(I).pipe((0,c.T)(()=>(I.dispatch(new te.F5(ee||0)),!0)))},{procName:w.t.setCameraMode,actionFn:ee=>(I.dispatch(new te.vq("pan"===ee?"pan":"rotate")),!0)},{procName:w.t.CameraDisableChapterCamera,actionFn:()=>(I.dispatch(new te.Qn(!1)),!0)},{procName:w.t.CameraEnableChapterCamera,actionFn:()=>(I.dispatch(new te.Qn(!0)),!0)}]}(this.store,this.cameraService).forEach(x=>{de(this.rpcService,x)}),function St(I,G,ee){return[{procName:w.t.TimelineQuery,actionFn:()=>({chapters:I.selectSnapshot(ae.N.getStoryChapters).map(ue=>({description:ue.description,displayName:ue.displayName,annotations:ue.labels.map(Ve=>({title:Ve.title,description:Ve.description}))}))}),hideDefinition:!0},{procName:w.t.TimelineInfo,actionFn:()=>Z(I).pipe((0,c.T)(([x])=>function ut(I,G,ee){const x=ee.getChapterTimeFrame();return{time:ee.getTime(),startTime:x.firstTime,endTime:x.lastTime,chapters:G.map(ue=>ue.id),playing:ee.isPlaying(),playbackSpeed:mt(I)}}(I,x,G)))},{procName:w.t.TimelinePlay,actionFn:x=>H(I).pipe((0,i.Z)(()=>{const ue=G.getGlobalTime(),fe=x.time??ue,ve=x.loop??!1;let Pe=x.chapterId;return void 0===Pe&&(Pe=G.mapGlobalTimeToChapterId(fe)),new A.c(Ve=>{I.selectSnapshot(K.S.getChapter)!==Pe&&I.dispatch(new Ze.wg(Pe)),I.select(K.S.getChapter).pipe((0,f.p)(nt=>nt===Pe),(0,m.s)(1)).subscribe(()=>function $e(){if(fe!==ue){const nt=(0,st.clamp)(G.mapChapterGlobalTime(Pe,x.time),0,G.getChapterDuration());G.pause(),G.scrub(nt)}G.setAnimationLoop(ve),G.play(),Ve.next(!0),Ve.complete()}())})}))},{procName:w.t.TimelinePause,actionFn:()=>Z(I).pipe((0,c.T)(()=>(G.pause(),!0)))},{procName:w.t.TimelineSet,actionFn:x=>H(I).pipe((0,i.Z)(()=>{if(void 0===x.time&&void 0===x.chapterId)return(0,je.of)(!0);let ue=x.chapterId;void 0===ue&&(ue=G.mapGlobalTimeToChapterId(x.time));const fe=I.selectSnapshot(K.S.getChapter)!==ue;return new A.c(ve=>{function Pe(){let Ve=x.time??0;Ve=(0,st.clamp)(G.mapChapterGlobalTime(ue,Ve),0,G.getChapterDuration()),G.pause(),G.scrub(Ve),ve.next(!0),ve.complete()}fe?(I.select(K.S.getChapter).pipe((0,f.p)(Ve=>Ve===ue),(0,m.s)(1)).subscribe(()=>Pe()),I.dispatch(new Ze.wg(ue))):Pe()})}))},{procName:w.t.TimelineSetPlaybackSpeed,actionFn:x=>H(I).pipe((0,c.T)(()=>"number"==typeof x&&(I.dispatch(new D.Vs(x)),!0)))},{procName:w.t.TimelineGetPlaybackSpeed,actionFn:()=>H(I).pipe((0,c.T)(()=>mt(I)))},{procName:w.t.TimelineNext,actionFn:()=>H(I).pipe((0,c.T)(()=>(ee.nextChapter("API"),!0)))},{procName:w.t.TimelinePrev,actionFn:()=>H(I).pipe((0,c.T)(()=>(ee.previousChapter("API"),!0)))}]}(this.store,this.animationService,this.viewService).forEach(x=>{de(this.rpcService,x)}),function On(I){return[{procName:w.t.InputEnable,actionFn:()=>(I.dispatch(new we(!0)),!0)},{procName:w.t.InputDisable,actionFn:()=>(I.dispatch(new we(!1)),!0)}]}(this.store).forEach(x=>{de(this.rpcService,x)}),function yo(I,G,ee,x){const ue=new Dn.t(!1);return G.pipe((0,k.rM)(Ze.lM)).subscribe(()=>{ue.next(!0)}),[{procName:w.t.UIGetBackground,actionFn:()=>Z(I).pipe((0,c.T)(()=>function _o(I){const{colors:G,gradientType:ee,colorStops:x}=I;return{colors:Array.isArray(G)?[[G[0],G[1],G[2],G[3]],[G[4],G[5],G[6],G[7]]]:[[0,0,0,0],[0,0,0,0]],gradientType:ee,colorStops:x}}(I.selectSnapshot(ae.N.getSelectedChapterBackground))))},{procName:w.t.UISetBackground,mapFnIn:fe=>{const{colors:ve,colorStops:Pe,gradientType:Ve}=fe;return{colors:ve&&Es(ve),gradientType:Ve,colorStops:Pe}},actionFn:fe=>Z(I).pipe((0,c.T)(()=>{if(fe){const ve=bs(I,fe);I.dispatch(new Ze.pb(ve))}return!0}))},{procName:w.t.UIPresetBackground,mapFnIn:fe=>{const{colors:ve,colorStops:Pe,gradientType:Ve}=fe;return{colors:ve&&Es(ve),gradientType:Ve,colorStops:Pe}},actionFn:fe=>{if(fe){const ve=bs(I,fe);s.c.platform===In.N.SDK&&ue.next(!1),ue.pipe((0,f.p)(Pe=>!!Pe),(0,m.s)(1)).subscribe(()=>{I.dispatch(new Ze.EN(ve))})}return!0}},{procName:w.t.UIGetWorldPosition,actionFn:fe=>Z(I).pipe((0,c.T)(()=>{const{worldPos:ve}=ee.pick(fe.x,fe.y);if(ve){const{0:Pe,1:Ve,2:$e}=ve;return{x:Pe,y:Ve,z:$e}}return null}))},{procName:w.t.UISetOndemand,actionFn:fe=>(I.dispatch([new et.B.ToggleWindow(Wt.U.OnDemand,fe.enabled)]),!0)},{procName:w.t.UISetLoadingExperience,actionFn:fe=>((0,L.isEmpty)(fe)?I.dispatch([new et.B.SetInteractType(Gn.i.None),new et.B.CloseWindow(Wt.U.Interact)]):I.dispatch([new et.B.SetInteractType(fe),new et.B.OpenWindow(Wt.U.Interact)]),!0)},{procName:w.t.UISetScrollCaptureMode,actionFn:fe=>(I.dispatch(new D.hk(fe)),!0)},{procName:w.t.UISetTutorial,actionFn:fe=>(I.dispatch([new et.B.ToggleWindow(Wt.U.Tutorial,fe.enabled),new et.B.StartTutorial(fe.enabled)]),!0)},{procName:w.t.UIGetWindow,actionFn:()=>Cs(I.selectSnapshot(Ge.Pf.getOpenWindow))},{procName:w.t.UIGetDisplay,actionFn:()=>Z(I).pipe((0,c.T)(()=>{const fe=I.selectSnapshot(_t.dF.getUI);return(0,un.Rh)(fe)}))},{procName:w.t.UISetDisplay,actionFn:fe=>{const ve=(0,un.RS)(fe);return I.dispatch(new vt(ve)),fe}},{procName:w.t.UIResetDisplay,actionFn:()=>{const fe=I.selectSnapshot(_t.dF.getInitialUI);I.dispatch(new Zt.p.SetUI(fe))}},{procName:w.t.UISetQuizLock,actionFn:fe=>(G.pipe((0,k.xi)(Se.nm),(0,m.s)(1)).subscribe(()=>{I.dispatch(new Ut.B.SetQuizLocked(fe)),I.dispatch(new Ut.B.SetEnableQuizRetake(fe)),!0===fe&&x.startQuiz()}),!0)},{procName:w.t.UISnapshot,aliases:[w.t.SceneSnapshot],actionFn:fe=>Z(I).pipe((0,i.Z)(()=>{const{width:ve,height:Pe}=ee.getCanvas();fe={width:ve,height:Pe,openInTab:!1,fileType:"jpeg",quality:.92,...fe};const{width:Ve,height:$e,openInTab:Qe,fileType:nt}=fe,pt=I.selectSnapshot(ae.N.getSelectedChapterId),Et={width:Ve,height:$e},Ct="jpeg"===nt?Mn.H.JPEG:Mn.H.PNG,Ke=I.selectSnapshot(ae.N.getSelectedChapterBackground);return I.dispatch(new Tn.V9(pt,Ke,Ct,.92,Et,"original",!0,!0)).pipe((0,i.Z)(()=>G.pipe((0,k.xi)(Tn.WX),(0,m.s)(1))),(0,i.Z)(at=>Pn.X.blobToBase64(at.blob)),(0,ze.M)(at=>{Qe&&at&&function mo(I){const G=window.open("","_blank");if(G){const ee=G.document.createElement("img");ee.src=I,G.document.body.appendChild(ee)}}(at)}),(0,We.W)(()=>(0,je.of)(null)))}))}]}(this.store,this.actions,this.engineRendererService,this.quizService).forEach(x=>{de(this.rpcService,x)}),function ni(I,G,ee,x,ue,fe){return[...Ro(I,G,x,ue),...Vo(I,G,x),{procName:w.t.LabelsInfo,actionFn:ve=>Z(I).pipe((0,c.T)(()=>ve.length>0?Qn(I,ve):I.selectSnapshot(Ue.y.getChapterLabels))),mapFnOut:ve=>Gs(x,ve)},{procName:w.t.LabelsCreate,actionFn:ve=>Z(I).pipe((0,c.T)(()=>{if(ve.labelId&&rn(I,ve.labelId))return null;if(!ve.objectId)return console.log("attempt to create a label with no objectId."),null;const Pe=function Qo(I,G,ee){const x=G.makeDefaultStudioLabel();x.id=ee.labelId||Ho.u.idWithPrefix("label"),x.objectId=ee.objectId,x.pos=ee.position,x.renderableIndex=0,x.occludable=!!ee.position,x.flyTo=!0,x.description="",x.shown=!0;const ue=I.selectSnapshot(ae.N.getSelectedChapter);return ue?(x.chapterId=ue.id,xs(x,ee)):null}(I,G,ve);return Jn(I,Pe,!0)})),mapFnOut:ve=>an(x,ve)},{procName:w.t.LabelsUpdate,actionFn:ve=>Z(I).pipe((0,c.T)(()=>{let Pe=null;return rn(I,ve.labelId)&&(Pe=function Jo(I,G){return xs(rn(I,G.labelId),G)}(I,ve),Jn(I,Pe,!1)),Pe})),mapFnOut:ve=>an(x,ve)},{procName:w.t.LabelsCanvasUpdate,actionFn:ve=>Z(I).pipe((0,c.T)(()=>{let Pe=null;return rn(I,ve.labelId)&&(Pe=function Yo(I,G,ee,x){const ue=rn(I,x.labelId),fe=x.canvasPosition,ve=G.pick(fe[0],fe[1]);return ve&&ve.objectId?(ue.objectId=ve.objectId,ue.pos=[ve.worldPos[0],ve.worldPos[1],ve.worldPos[2]],ue.offset=[ue.hideWire?20:32,0],ue.barycentric=[ve.barycentric[0],ve.barycentric[1],ve.barycentric[2]],ue.primitiveIndex=ve.triIndex,ue.renderableIndex=ve.renderableIndex||0,ue.dir=ee.getDirection(ve),ue):null}(I,ee,fe,ve),Pe&&Jn(I,Pe,!1)),Pe})),mapFnOut:ve=>an(x,ve)},{procName:w.t.LabelsDestroy,actionFn:ve=>Z(I).pipe((0,c.T)(()=>{const Pe=rn(I,ve);return Pe?(I.dispatch(new Ee.vx(Pe)),{labelId:Pe.id}):null}))},{procName:w.t.LabelsShow,actionFn:ve=>Z(I).pipe((0,c.T)(()=>(ve.length>0?I.dispatch(new Ee.D3(Qn(I,ve),!0)):js(I,!0),!0)))},{procName:w.t.LabelsHide,actionFn:ve=>Z(I).pipe((0,c.T)(()=>(ve.length>0?I.dispatch(new Ee.D3(Qn(I,ve),!1)):js(I,!1),!0)))},{procName:w.t.LabelsSetEnabled,aliases:[w.t.AnnotationsSetEnabled],actionFn:ve=>{I.dispatch(new D.Gv(ve.enable))},hideDefinition:!0},{procName:w.t.LabelsSetScale,actionFn:ve=>{I.dispatch(new Ee.tH(ve.scale))}}]}(this.store,this.labelsService,this.engineRendererService,this.markerService,this.sceneService,this.cameraService).forEach(x=>{de(this.rpcService,x)}),function hi(I,G){function ee(x){return I.selectSnapshot(Ht.j.getQuizModeActive)?x():{error:"quiz mode is not active"}}return[{procName:w.t.QuizInfo,actionFn:()=>Z(I).pipe((0,c.T)(()=>I.selectSnapshot(Ht.j.hasQuiz)?cn(I):null))},{procName:w.t.QuizSubmit,actionFn:x=>Z(I).pipe((0,c.T)(()=>ee(()=>(G.submitQuestion(x.questionId,x.answerIds),cn(I)))))},{procName:w.t.QuizQuestion,actionFn:()=>ee(()=>Z(I).pipe((0,c.T)(()=>ts(I))))},{procName:w.t.QuizEnter,actionFn:()=>Z(I).pipe((0,c.T)(()=>I.selectSnapshot(Ht.j.hasQuiz)?(G.startQuiz(),!0):{error:"quiz not found"}))},{procName:w.t.QuizExit,actionFn:()=>Z(I).pipe((0,c.T)(()=>(G.exitQuiz(),!0)))},{procName:w.t.QuizSelectQuestion,actionFn:x=>ee(()=>(I.dispatch(new Ut.B.SetActiveQuestion(x)),cn(I)))},{procName:w.t.QuizNextQuestion,actionFn:()=>Z(I).pipe((0,c.T)(()=>ee(()=>(G.nextQuestion(),ts(I)))))},{procName:w.t.QuizPreviousQuestion,actionFn:()=>Z(I).pipe((0,c.T)(()=>ee(()=>(I.dispatch(new Ut.B.SetQuizLifecycle(ri.h.Question)),I.dispatch(new Ut.B.PreviousQuestion),ts(I)))))},{procName:w.t.QuizReset,actionFn:()=>Z(I).pipe((0,c.T)(()=>(G.resetQuiz(),cn(I))))},{procName:w.t.QuizSet,actionFn:x=>Z(I).pipe((0,c.T)(()=>{const{settings:ue,startNumber:fe,endNumber:ve,locked:Pe}=x;if(!(0,L.isNil)(ue)){const $e=I.selectSnapshot(Ht.j.getQuizSettings);I.dispatch(new Ut.B.SetQuizSettings({...$e,...ue}))}if("number"==typeof fe||"number"==typeof ve){const $e=I.selectSnapshot(ae.N.getStoryChapters),Qe=(0,Fn.En)($e),Et=Qe.slice("number"==typeof fe?fe-1:0,"number"==typeof ve?ve:Qe.length);I.dispatch(new Ut.B.SetQuestions(Et))}return"boolean"==typeof Pe&&I.dispatch(new Ut.B.SetQuizLocked(Pe)),I.dispatch(new Ut.B.SetQuizQuestionsMode("number"==typeof fe&&"number"==typeof ve?"restricted":"all")),cn(I)}))}]}(this.store,this.quizService).forEach(x=>{de(this.rpcService,x)})}initNativeEventListeners(){this.applicationEventService.getEvent(oe.F.NativeSetBaseDirectory).pipe((0,E.Q)(this.ngUnsubscribe)).subscribe(x=>{window.localBaseDirectory=x}),this.applicationEventService.getEvent(oe.F.NativeSetSdkOffline).pipe((0,E.Q)(this.ngUnsubscribe)).subscribe(x=>{window.sdkOffline=!0===x})}}return(I=G).\u0275fac=function(x){return new(x||I)(e.KVO(k.il),e.KVO(k.En),e.KVO(le.j),e.KVO(pe.y),e.KVO(ft.O),e.KVO(ie.s),e.KVO(si.x),e.KVO(oi.w),e.KVO(zs.z),e.KVO(bi),e.KVO(ii.u),e.KVO(Li.n),e.KVO(_i.k),e.KVO(cs),e.KVO(Ti),e.KVO(ls.S),e.KVO(Xs.z),e.KVO(Di.m),e.KVO(Ii.w),e.KVO(Ri.T),e.KVO(Ui.V))},I.\u0275prov=e.jDH({token:I,factory:I.\u0275fac,providedIn:"root"}),G})();var hn=n(38165),_n=n(6795),Fi=n(27044),Qs=n(90908);let ki=(()=>{var I;class G{constructor(x){this.viewService=x}initialize(){window.BDGlobalActions={toggleTutorial:x=>this.viewService.toggleTutorial(x)}}}return(I=G).\u0275fac=function(x){return new(x||I)(e.KVO(zs.z))},I.\u0275prov=e.jDH({token:I,factory:I.\u0275fac,providedIn:"root"}),G})();var Bi=n(5690),ji=n(82633),Js=n(66571),wi=n(78674),Ys=n(47428),xi=n(95416),$t=n(49969),Zs=n(26779);const Gi=["*"];let qs=(()=>{var I;class G{constructor(){this.type="message",this.dismissClick=new e.bkB}ngOnInit(){}handleDismissClicked(){this.dismissClick.emit()}}return(I=G).\u0275fac=function(x){return new(x||I)},I.\u0275cmp=e.VBU({type:I,selectors:[["app-header-notification"]],inputs:{type:"type"},outputs:{dismissClick:"dismissClick"},ngContentSelectors:Gi,decls:8,vars:10,consts:[[1,"header-notification","flex","flex-row","justify-center"],[1,"text-sm","flex","flex-row","justify-center","items-center","flex-auto"],[1,"mr-3"],["icon","exclamation-triangle"],["app-button","","buttonType","text","buttonTheme","light","type","button","title","Dismiss",3,"click"],["icon","times","size","lg"]],template:function(x,ue){1&x&&(e.NAR(),e.j41(0,"div",0)(1,"div",1)(2,"div",2),e.nrm(3,"app-icon",3),e.k0s(),e.j41(4,"div"),e.SdG(5),e.k0s()(),e.j41(6,"button",4),e.bIt("click",function(){return ue.handleDismissClicked()}),e.nrm(7,"app-icon",5),e.k0s()()),2&x&&(e.AVh("header-notification--message","message"===ue.type)("header-notification--error","error"===ue.type)("header-notification--notification","notification"===ue.type)("header-notification--warning","warning"===ue.type),e.Y8G("@inFromTop",void 0),e.R7$(6),e.BMQ("aria-label","Dismiss"))},dependencies:[M.Q,Zs.R],styles:[".header-notification[_ngcontent-%COMP%]{position:fixed;z-index:10000;width:100vw;color:#fff;padding:8px}.header-notification--message[_ngcontent-%COMP%]{background-color:#138032}.header-notification--error[_ngcontent-%COMP%]{background-color:#a81914}.header-notification--notification[_ngcontent-%COMP%]{background-color:#1c5ab9}.header-notification--warning[_ngcontent-%COMP%]{color:#1c2a3f;background-color:#ffb92e}"],data:{animation:[(0,$t.hZ)("inFromTop",[(0,$t.kY)(":enter",[(0,$t.iF)({transform:"translateY(-100%)"}),(0,$t.i0)("250ms ease-out",(0,$t.iF)({transform:"*"}))])])]},changeDetection:0}),G})();function zi(I,G){if(1&I){const ee=e.RV6();e.j41(0,"app-header-notification",1),e.bIt("dismissClick",function(){e.eBV(ee);const ue=e.XpG();return e.Njj(ue.handleHeaderDismissClick())}),e.j41(1,"div",2),e.EFF(2,"You are offline. Check your data or wifi connection."),e.k0s()()}}let Wi=(()=>{var I;class G{constructor(x){this.changeRef=x,this.enabled=!s.c.native,this.offline=!1,this.seen=!1,this.ngUnsubscribe=new y.B}ngOnInit(){this.offline=!window.navigator.onLine;const x=(0,p.R)(window,"online"),ue=(0,p.R)(window,"offline");(0,rs.h)(x,ue).pipe((0,E.Q)(this.ngUnsubscribe)).subscribe(()=>{this.offline=!window.navigator.onLine,this.offline&&(this.seen=!1),this.changeRef.markForCheck()})}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}handleHeaderDismissClick(){this.seen=!0}}return(I=G).\u0275fac=function(x){return new(x||I)(e.rXU(e.gRc))},I.\u0275cmp=e.VBU({type:I,selectors:[["app-offline-message"]],decls:1,vars:1,consts:[["type","warning",3,"dismissClick",4,"ngIf"],["type","warning",3,"dismissClick"],[1,"text-sm"]],template:function(x,ue){1&x&&e.DNE(0,zi,3,0,"app-header-notification",0),2&x&&e.Y8G("ngIf",ue.enabled&&ue.offline&&!ue.seen)},dependencies:[d.bT,qs],changeDetection:0}),G})();var mn=n(21082),eo=n(1670),Vi=n(94909),$i=n(87145),Ki=n(27182),Hi=n(83513),to=n(47632),Xi=n(15623),no=n(38104),so=n(21424),Xt=n(74459),dn=n(43442),Qi=n(39596),Ji=n(40634),Yi=n(72865),Zi=n(30234),oo=n(35286);function qi(I,G){if(1&I){const ee=e.RV6();e.j41(0,"button",6),e.bIt("click",function(){e.eBV(ee);const ue=e.XpG();return e.Njj(ue.handleActionClick())}),e.EFF(1),e.k0s()}if(2&I){const ee=e.XpG();e.R7$(),e.SpI(" ",ee.buttonLabel," ")}}let er=(()=>{var I;class G{constructor(){this.dismissClick=new e.bkB,this.actionClick=new e.bkB}ngOnInit(){}handleActionClick(){this.actionClick.emit()}handleDismissClick(){this.dismissClick.emit()}}return(I=G).\u0275fac=function(x){return new(x||I)},I.\u0275cmp=e.VBU({type:I,selectors:[["app-footer-notification"]],inputs:{label:"label",buttonLabel:"buttonLabel",compact:"compact"},outputs:{dismissClick:"dismissClick",actionClick:"actionClick"},decls:8,vars:9,consts:[["data-test","footerNotification",1,"footer-notification","flex","flex-row","items-start","justify-center"],[1,"footer-notification__wrapper"],["data-test","footerNotificationTitle",1,"footer-notification__title","text-base","html",3,"innerHTML"],["app-button","","buttonType","primary","data-test","footerNotificationAction",3,"click",4,"ngIf"],["app-button","","buttonType","default","buttonTheme","light","type","button","title","Close","data-test","footerNotificationDismiss",1,"footer-notification__close",3,"click"],["icon","times","size","lg"],["app-button","","buttonType","primary","data-test","footerNotificationAction",3,"click"]],template:function(x,ue){1&x&&(e.j41(0,"div",0)(1,"div",1),e.nrm(2,"div",2),e.nI1(3,"markdown"),e.nI1(4,"async"),e.DNE(5,qi,2,1,"button",3),e.k0s(),e.j41(6,"button",4),e.bIt("click",function(){return ue.handleDismissClick()}),e.nrm(7,"app-icon",5),e.k0s()()),2&x&&(e.AVh("footer-notification--compact",ue.compact),e.R7$(2),e.Y8G("innerHTML",e.bMT(4,7,e.bMT(3,5,ue.label)),e.npT),e.R7$(3),e.Y8G("ngIf",ue.buttonLabel),e.R7$(),e.BMQ("aria-label","Close"))},dependencies:[d.bT,M.Q,Zs.R,d.Jj,oo.i0],styles:[".footer-notification[_ngcontent-%COMP%]{padding:16px 40px;background-color:#fff;box-shadow:0 11px 15px #0003,0 24px 38px #00000024,0 9px 46px #0000001f}.footer-notification__wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;justify-content:center;flex:1 1 auto}.footer-notification__title[_ngcontent-%COMP%]{margin-right:40px}.footer-notification--compact[_ngcontent-%COMP%]   .footer-notification__wrapper[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;justify-content:flex-start}.footer-notification--compact[_ngcontent-%COMP%]   .footer-notification__title[_ngcontent-%COMP%]{margin-right:auto;margin-bottom:20px}"],changeDetection:0}),G})();var fn,ds=function(I,G,ee,x){var ve,ue=arguments.length,fe=ue<3?G:null===x?x=Object.getOwnPropertyDescriptor(G,ee):x;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)fe=Reflect.decorate(I,G,ee,x);else for(var Pe=I.length-1;Pe>=0;Pe--)(ve=I[Pe])&&(fe=(ue<3?ve(fe):ue>3?ve(G,ee,fe):ve(G,ee))||fe);return ue>3&&fe&&Object.defineProperty(G,ee,fe),fe},us=function(I,G){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(I,G)};const tr=()=>["/account/profile"],nr=()=>({section:"subscription",mode:"edit"});function sr(I,G){if(1&I){const ee=e.RV6();e.j41(0,"app-header-notification",6),e.bIt("dismissClick",function(){e.eBV(ee);const ue=e.XpG(3);return e.Njj(ue.handleHeaderDismissClick(ue.headerNotification))}),e.j41(1,"div",7),e.EFF(2," Your Personal Pro subscription has expired. Please update your "),e.j41(3,"span",8),e.EFF(4," payment information "),e.k0s(),e.EFF(5," to keep enjoying full access. "),e.k0s()()}2&I&&(e.R7$(3),e.Y8G("routerLink",e.lJ4(2,tr))("queryParams",e.lJ4(3,nr)))}function or(I,G){if(1&I&&(e.j41(0,"div",4),e.DNE(1,sr,6,4,"app-header-notification",5),e.k0s()),2&I){const ee=e.XpG(2);e.Y8G("ngSwitch",ee.headerNotification.type),e.R7$(),e.Y8G("ngSwitchCase",ee.gateTypes.ProAccountPastDue)}}function ir(I,G){if(1&I){const ee=e.RV6();e.j41(0,"div",9)(1,"app-footer-notification",10),e.nI1(2,"async"),e.bIt("actionClick",function(){e.eBV(ee);const ue=e.XpG(2);return e.Njj(ue.handleActionClick(ue.footerNotification.type))})("dismissClick",function(){e.eBV(ee);const ue=e.XpG(2);return e.Njj(ue.handleFooterDismissClick(ue.footerNotification))}),e.k0s()()}if(2&I){const ee=e.XpG(2);e.Y8G("@inFromBottom",void 0),e.R7$(),e.Y8G("label",ee.footerNotification.data.title)("compact",e.bMT(2,4,ee.horizontalBreakpoint$)<ee.breakPoints.Medium)("buttonLabel",ee.footerNotification.data.actionText)}}function rr(I,G){if(1&I&&(e.j41(0,"div",1),e.DNE(1,or,2,2,"div",2)(2,ir,3,6,"div",3),e.k0s()),2&I){const ee=e.XpG();e.R7$(),e.Y8G("ngIf",ee.headerNotification),e.R7$(),e.Y8G("ngIf",ee.footerNotification)}}class yn{constructor(G,ee,x,ue,fe,ve,Pe,Ve,$e,Qe){this.store=G,this.actions=ee,this.router=x,this.activatedRoute=ue,this.userAccessService=fe,this.bookmarksService=ve,this.bookmarkActionService=Pe,this.storageService=Ve,this.dialogService=$e,this.changeRef=Qe,this.breakPoints=Xi.m,this.displayTypes=Xt.q,this.gateTypes=dn.j,this.ngUnsubscribe=new y.B,this.initUtilityStates()}ngOnInit(){this.initNotificationListeners(),this.initContentViews(),this.initContentSaves(),this.initFreeTrial(),this.initPastDue(),this.initContentViewsCheck(),this.initZSpaceRestriction()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}initZSpaceRestriction(){this.story$.pipe((0,f.p)(G=>!(0,L.isNil)(G)&&this.isContentViewPage(this.router.url)),(0,E.Q)(this.ngUnsubscribe)).subscribe(G=>{const ee=this.bookmarksService.getZSpaceRestriction()!==Zi.O.None,x=this.bookmarksService.isZSpaceModel(G);ee&&x&&this.router.navigateByUrl(Yi.Wj)})}initContentViewsCheck(){this.store.select(q.k.getUserProfile).pipe((0,c.T)(G=>!(0,L.isNil)(G)),(0,mn.F)(),(0,f.p)(G=>G),(0,E.Q)(this.ngUnsubscribe)).subscribe(()=>{this.store.dispatch(new hn.OF)})}initUtilityStates(){this.pageNavigation$=(0,rs.h)(this.activatedRoute.url,this.router.events.pipe((0,f.p)(G=>G instanceof o.wF))).pipe((0,c.T)(()=>this.router.url))}initNotificationListeners(){const G=this.store.select(q.k.getLoggedIn).pipe((0,eo.J)(),(0,c.T)(([ee,x])=>ee===x?"unchanged":!ee&&x?"loggingIn":"loggingOut"),(0,mn.F)());this.actions.pipe((0,k.xi)(hn.$_),(0,E.Q)(this.ngUnsubscribe)).subscribe(ee=>{const{display:ue}=ee;switch(ue){case Xt.q.Notification:this.headerNotification=ee;break;case Xt.q.Footer:this.footerNotification=ee}this.changeRef.markForCheck()}),this.actions.pipe((0,k.xi)(hn.rH),(0,E.Q)(this.ngUnsubscribe)).subscribe(ee=>{ee.displays.forEach(x=>{switch(x){case Xt.q.Notification:this.headerNotification=void 0;break;case Xt.q.Footer:this.footerNotification=void 0}}),this.changeRef.markForCheck()}),this.pageNavigation$.pipe((0,Vi.E)(G),(0,f.p)(([,ee])=>"loggingIn"!==ee),(0,E.Q)(this.ngUnsubscribe)).subscribe(()=>{this.userAccessService.clearDialogs();const ee=this.isEditPage(this.router.url);this.clearNotifications(ee,!0)}),this.actions.pipe((0,k.xi)(hn.fQ),(0,E.Q)(this.ngUnsubscribe)).subscribe(()=>{this.clearNotifications(!0,!0),this.changeRef.markForCheck()})}initContentViews(){const G=this.pageNavigation$.pipe((0,c.T)(()=>this.isContentViewPage(this.router.url)),(0,mn.F)((fe,ve)=>fe===ve),(0,f.p)(fe=>fe));let ee;this.pageNavigation$.pipe((0,c.T)(()=>this.router.url),(0,eo.J)(),(0,E.Q)(this.ngUnsubscribe)).subscribe(([fe,ve])=>{ee=fe});const x=this.contentViews$.pipe((0,c.T)(fe=>fe.limit_reached),(0,mn.F)());G.pipe((0,f.p)(()=>!this.store.selectSnapshot(q.k.isPremiumUser)),(0,i.Z)(()=>x),(0,f.p)(fe=>fe),(0,i.Z)(()=>this.userAccessService.openBookmarkViewLimit()),(0,E.Q)(this.ngUnsubscribe)).subscribe(fe=>{if(!fe)return;const ve=this.router.url,Pe=this.isContentViewPage(ee),Ve=this.isLoginPage(ee),$e=this.isAccountPage(ee);this.isAccountPage(ve)||((0,L.isNil)(ee)||$e||Ve||Pe?this.router.navigate(["/results/bookmarks"]):this.router.navigateByUrl(ee))});const ue=this.pageNavigation$.pipe((0,$i.i)(1),(0,i.Z)(fe=>this.isContentViewPage(fe)?this.store.select(ae.N.getSelectedChapterReadyState).pipe((0,f.p)(Pe=>!(0,L.isNil)(Pe)&&Pe.model)):(0,je.of)(!0)));(0,T.z)([ue,this.contentViews$]).pipe((0,mn.F)((fe,ve)=>fe[1].inapp_view_count===ve[1].inapp_view_count),(0,l.B)(2500),(0,E.Q)(this.ngUnsubscribe)).subscribe(([fe,ve])=>{const{inapp_view_count:Pe,inapp_view_limit:Ve}=ve,$e=Pe/Ve;$e>.7&&$e<1&&(this.userAccessService.openBookmarkViewWarning(Pe,Ve),setTimeout(()=>{this.userAccessService.clearUserNotifications(Xt.q.Footer)},2e4))})}initContentSaves(){this.actions.pipe((0,k.xi)(to.lN,to.x$),(0,f.p)(()=>!this.store.selectSnapshot(q.k.isPremiumUser)),(0,i.Z)(()=>this.bookmarkActionService.checkBookmarkLimit()),(0,l.B)(2500),(0,E.Q)(this.ngUnsubscribe)).subscribe(G=>{const{inapp_content_limit:ee,inapp_content_count:x}=G,ue=x/ee;ue>.6&&ue<1&&(this.userAccessService.openBookmarkSaveWarning(x,ee),setTimeout(()=>{this.userAccessService.clearUserNotifications(Xt.q.Footer)},2e4))})}initFreeTrial(){const G=this.store.select(so.q.isSubscriptionExpired);(0,T.z)([G,this.pageNavigation$]).pipe((0,f.p)(([ee])=>ee),(0,f.p)(()=>"true"!==this.storageService.getLocalItem(O.UT.TeamTrialExpirationSeen)),(0,m.s)(1),(0,l.B)(1e3),(0,E.Q)(this.ngUnsubscribe)).subscribe(([ee])=>{ee&&this.userAccessService.openTrialExpired()})}initPastDue(){this.store.select(q.k.getUserProfile).pipe((0,f.p)(G=>!(0,L.isNil)(G)),(0,f.p)(()=>"true"!==this.storageService.getLocalItem(O.UT.ProExpirationSeen)),(0,E.Q)(this.ngUnsubscribe)).subscribe(G=>{this.store.selectSnapshot(q.k.getUserType)!==Ki.I.Team&&G.subscription&&"past due"===G.subscription.subscription_status&&this.userAccessService.openPastDue()})}handleActionClick(G){switch(G){case dn.j.BookmarkViewThresholdReached:case dn.j.BookmarkSaveThresholdReached:case dn.j.BookmarkViewLimitReached:case dn.j.BookmarkSaveLimitReached:this.dialogService.openUpgradeDialog()}this.clearNotifications(!1,!0)}handleHeaderDismissClick(G){G.type===dn.j.ProAccountPastDue&&this.storageService.setLocalItem(O.UT.ProExpirationSeen,!0),this.clearNotifications(!0,!1),this.changeRef.markForCheck()}handleFooterDismissClick(G){this.clearNotifications(!1,!0),this.changeRef.markForCheck()}clearNotifications(G,ee){const x=[];G&&(x.push(Xt.q.Notification),this.headerNotification=void 0),ee&&x.push(Xt.q.Footer),this.userAccessService.clearUserNotifications(...x)}isViewPage(G){return G.startsWith("/view")}isEditPage(G){return G.startsWith("/edit")}isAccountPage(G){return G.startsWith("/account")}isLoginPage(G){return G.startsWith("/login")}isContentViewPage(G){const ee=this.isEditPage(G);return this.isViewPage(G)||ee}}(fn=yn).\u0275fac=function(G){return new(G||fn)(e.rXU(k.il),e.rXU(k.En),e.rXU(o.Ix),e.rXU(o.nX),e.rXU(Qi.p),e.rXU(Ji.x),e.rXU(Hi.h),e.rXU(O.n$),e.rXU(Js.o),e.rXU(e.gRc))},fn.\u0275cmp=e.VBU({type:fn,selectors:[["app-user-access"]],decls:1,vars:1,consts:[["class","user-access",4,"ngIf"],[1,"user-access"],["class","user-access__header",3,"ngSwitch",4,"ngIf"],["class","user-access__footer",4,"ngIf"],[1,"user-access__header",3,"ngSwitch"],["type","warning",3,"dismissClick",4,"ngSwitchCase"],["type","warning",3,"dismissClick"],[1,"text-sm"],[1,"text-link","underline",3,"routerLink","queryParams"],[1,"user-access__footer"],[3,"actionClick","dismissClick","label","compact","buttonLabel"]],template:function(G,ee){1&G&&e.DNE(0,rr,3,2,"div",0),2&G&&e.Y8G("ngIf",ee.headerNotification||ee.footerNotification)},dependencies:[d.bT,d.ux,d.e1,o.Wk,qs,er,d.Jj],styles:[".user-access__footer[_ngcontent-%COMP%]{position:fixed;z-index:100;left:0;right:0;bottom:0}"],data:{animation:[(0,$t.hZ)("inFromBottom",[(0,$t.kY)(":enter",[(0,$t.iF)({transform:"translateY(100%)"}),(0,$t.i0)("250ms ease-out",(0,$t.iF)({transform:"*"}))])])]},changeDetection:0}),ds([(0,k.l6)(no.V.getHorizontalBreakpoint),us("design:type",A.c)],yn.prototype,"horizontalBreakpoint$",void 0),ds([(0,k.l6)(q.k.getContentViews),us("design:type",A.c)],yn.prototype,"contentViews$",void 0),ds([(0,k.l6)(ce.t.getStory),us("design:type",A.c)],yn.prototype,"story$",void 0);var Sn,ps=function(I,G,ee,x){var ve,ue=arguments.length,fe=ue<3?G:null===x?x=Object.getOwnPropertyDescriptor(G,ee):x;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)fe=Reflect.decorate(I,G,ee,x);else for(var Pe=I.length-1;Pe>=0;Pe--)(ve=I[Pe])&&(fe=(ue<3?ve(fe):ue>3?ve(G,ee,fe):ve(G,ee))||fe);return ue>3&&fe&&Object.defineProperty(G,ee,fe),fe},gs=function(I,G){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(I,G)};class vn{constructor(G,ee,x,ue,fe,ve,Pe,Ve,$e,Qe,nt,pt,Et,Ct,Ke,at,lt,Mt,Tt,At,Bt,xt){this.ga=ee,this.authService=x,this.storageService=ue,this.dialog=fe,this.router=ve,this.activatedRoute=Pe,this.viewContainerRef=Ve,this.linkedinInsights=$e,this.vendorAnalyticsService=Qe,this.widgetAPIHandler=nt,this.engineService=pt,this.applicationEventService=Et,this.store=Ct,this.actions=Ke,this.zendeskService=at,this.snackBar=lt,this.titleService=Mt,this.globalActionsService=Tt,this.productService=At,this.rpcService=Bt,this.dialogService=xt,this.title="human-studio-next",this.ngUnsubscribe=new y.B,G.loadRouting()}ngOnInit(){this.initPageTitle(),this.initProfileListeners(),this.initPageAnalytics(),this.initGPUAnalytics(),s.c.native&&this.initNativeAPIHooks(),this.userProfile$.pipe((0,f.p)(G=>null!=G),(0,m.s)(1),(0,E.Q)(this.ngUnsubscribe)).subscribe(G=>{this.checkProfileAccess(G)}),this.initZendesk(),this.initVendorAnalytics(),this.globalActionsService.initialize(),this.initZSpace()}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}initProfileListeners(){this.groupUserProfile$.pipe((0,f.p)(G=>{const ee=!0===this.storageService.getLocalJSON(O.UT.TeamWelcomeTourSeen);return!(0,L.isNil)(G)&&!ee}),(0,i.Z)(()=>this.dialogService.openWelcomeTourDialog(ji.G.NewUser).afterClosed()),(0,m.s)(1),(0,E.Q)(this.ngUnsubscribe)).subscribe(()=>{this.storageService.setLocalItem(O.UT.TeamWelcomeTourSeen,!0)})}initPageTitle(){const G=this.titleService.getTitle();this.router.events.pipe((0,f.p)(ee=>ee instanceof o.wF),(0,c.T)(()=>{let ee="",x=this.activatedRoute;for(;x.firstChild;){const ue=x.firstChild.snapshot.data.title;(0,L.isNil)(ue)||(ee=ue),x=x.firstChild}return ee}),(0,c.T)(ee=>ee.length?`${ee} | BioDigital Human Platform`:G)).subscribe(ee=>{this.titleService.setTitle(ee)})}initPageAnalytics(){this.linkedinInsights.initialize(),this.router.events.pipe((0,f.p)(G=>G instanceof o.wF),(0,E.Q)(this.ngUnsubscribe)).subscribe(G=>{this.ga.pageView(G.urlAfterRedirects)})}initZendesk(){this.zendeskService.updateFromProfile(),(0,p.R)(window,"resize").pipe((0,a.Z)((0,Qs.ZO)()),(0,l.B)(100),(0,c.T)(()=>(0,Qs.ZO)()),(0,E.Q)(this.ngUnsubscribe)).subscribe(G=>{this.zendeskService.setHelpCenterSuggestions({labels:[G?"webhelp":"mobilehelp"]})}),this.userProfile$.pipe((0,E.Q)(this.ngUnsubscribe)).subscribe(G=>{this.zendeskService.identify(G),this.zendeskService.updateFromProfile(G)}),this.userLocale$.pipe((0,f.p)(G=>!(0,L.isNil)(G)),(0,E.Q)(this.ngUnsubscribe)).subscribe(G=>{this.zendeskService.setLocale(G.lang)})}initVendorAnalytics(){this.vendorAnalyticsService.appendScripts(),this.vendorAnalyticsService.initialize({},{}),this.userProfile$.pipe((0,f.p)(G=>null!=G),(0,m.s)(1),(0,E.Q)(this.ngUnsubscribe)).subscribe(G=>{this.setVendorAnalyticsVisitorData(G)})}initGPUAnalytics(){this.engineService.initAnalytics(this.productService.productType,this.productService.productKey)}setVendorAnalyticsVisitorData(G){this.vendorAnalyticsService.identify(this.vendorAnalyticsService.createVisitorData(G),this.vendorAnalyticsService.createAccountData(G.organizations[0]))}checkProfileAccess(G){const ee=this.authService.getProfileRestrictions(G),x=this.storageService.getLocalJSON(O.UT.GroupRestriction);!0!==(0,L.get)(x,"dontShowDialog")&&(ee.email||ee.ip)&&setTimeout(()=>{const fe={id:ne.t.GroupRestrictionDialog,width:"480px",height:"auto",data:{...ee}};this.dialog.open($,fe)})}initNativeAPIHooks(){window.HumanWindowAPI=_n.s,_n.s.setStore(this.store),_n.s.setServices(this.rpcService,this.applicationEventService),_n.s.setSnackBar(this.snackBar),_n.s.setRouter(this.router),this.widgetAPIHandler.listen(!1),this.engineService.fireEvent(R.X.HumanStarted,null),this.actions.pipe((0,k.xi)(hn.tM)).pipe((0,E.Q)(this.ngUnsubscribe)).subscribe(()=>{this.applicationEventService.fireEvent(oe.F.NativeDeleteData)})}initZSpace(){this.activatedRoute.queryParams.pipe((0,E.Q)(this.ngUnsubscribe)).subscribe(G=>{const ee="true"===G.zspace;ee&&this.storageService.setLocalItem(O.UT.ZSpaceDevice,ee)})}}(Sn=vn).\u0275fac=function(G){return new(G||Sn)(e.rXU(wi.g),e.rXU(Ys.p),e.rXU(B.u),e.rXU(O.n$),e.rXU(V.bZ),e.rXU(o.Ix),e.rXU(o.nX),e.rXU(e.c1b),e.rXU(Q.n),e.rXU(j.e),e.rXU(Ni),e.rXU(pe.y),e.rXU(ls.S),e.rXU(k.il),e.rXU(k.En),e.rXU(Fi.c),e.rXU(xi.UG),e.rXU(t.hE),e.rXU(ki),e.rXU(Bi.b),e.rXU(cs),e.rXU(Js.o))},Sn.\u0275cmp=e.VBU({type:Sn,selectors:[["app-root"]],decls:3,vars:0,template:function(G,ee){1&G&&e.nrm(0,"app-user-access")(1,"app-offline-message")(2,"router-outlet")},dependencies:[Wi,o.n3,yn],changeDetection:0}),ps([(0,k.l6)(q.k.getUserProfile),gs("design:type",A.c)],vn.prototype,"userProfile$",void 0),ps([(0,k.l6)(q.k.getGroupUserProfile),gs("design:type",A.c)],vn.prototype,"groupUserProfile$",void 0),ps([(0,k.l6)(q.k.getUserLocale),gs("design:type",A.c)],vn.prototype,"userLocale$",void 0);var cr=n(28107);let dr=(()=>{var I;class G{intercept(x,ue){return ue.handle(x).pipe((0,c.T)(fe=>(fe instanceof gn.cS&&fe.body&&fe.body.hasOwnProperty("results")&&(fe=fe.clone({body:fe.body.results})),fe)))}}return(I=G).\u0275fac=function(x){return new(x||I)},I.\u0275prov=e.jDH({token:I,factory:I.\u0275fac}),G})();var ur=n(76549),pr=n(16515),gr=n(10381),hr=n(45189),hs=n(21604),_r=n(40430);let mr=(()=>{var I;class G{}return(I=G).\u0275fac=function(x){return new(x||I)},I.\u0275mod=e.$C({type:I}),I.\u0275inj=e.G2t({imports:[d.MD,hr.G,hs.G,_r.i,k.rK.forFeature([so.q])]}),G})();var fr=n(45367),yr=n(34440),ao=n(56400),Sr=n(74707);let vr=(()=>{var I;class G{}return(I=G).\u0275fac=function(x){return new(x||I)},I.\u0275mod=e.$C({type:I}),I.\u0275inj=e.G2t({imports:[k.rK.forFeature([q.k,yr.z]),d.MD,ao.P,Sr.k]}),G})(),Er=(()=>{var I;class G{parse(x){x=x.replace(/&amp;/g,"&");const fe=(new o.nU).parse(x);return this.ensureQueryParam(fe.queryParams,"dk",x),this.ensureQueryParam(fe.queryParams,"uaid",x),fe}serialize(x){return(new o.nU).serialize(x).replace(/%2F/g,"/")}ensureQueryParam(x,ue,fe){if(x.hasOwnProperty(ue))return x;const ve=this.getParameterByName(ue,fe);return null!==ve&&(x[ue]=ve),x}getParameterByName(x,ue){ue||(ue=window.location.href),x=x.replace(/[\[\]]/g,"\\$&");const ve=new RegExp("[?&]"+x+"(=([^&#]*)|&|#|$)").exec(ue);return ve?ve[2]?decodeURIComponent(ve[2].replace(/\+/g," ")):"":null}}return(I=G).\u0275fac=function(x){return new(x||I)},I.\u0275prov=e.jDH({token:I,factory:I.\u0275fac}),G})(),br=(()=>{var I;class G{}return(I=G).\u0275fac=function(x){return new(x||I)},I.\u0275mod=e.$C({type:I}),I.\u0275inj=e.G2t({imports:[k.rK.forFeature([no.V]),d.MD]}),G})();var Cr=n(68504);let Or=(()=>{var I;class G{}return(I=G).\u0275fac=function(x){return new(x||I)},I.\u0275mod=e.$C({type:I}),I.\u0275inj=e.G2t({imports:[k.rK.forFeature([Cr.o]),d.MD]}),G})();var En=n(16e3),_s=n(13955),kn=function(I){return I[I.Positions=4]="Positions",I[I.Normals=4]="Normals",I[I.UVs=4]="UVs",I}(kn||{}),Bn=function(I){return I[I.Positions=2]="Positions",I[I.Normals=.6666666666666666]="Normals",I[I.UVs=2]="UVs",I}(Bn||{});let Pr=(()=>{var I;class G{constructor(x){this.assetService=x}getBytesPerIndex(x,ue){return x.length<Math.pow(2,8)?1:x.length<Math.pow(2,16)?2:x.length<Math.pow(2,32)?4:void 0}getAsset(x){return this.assetService.getGeometries()[x]}getPositions(x){return this.getAsset(x).geometry._core.arrays.positions}getNormals(x){return this.getAsset(x).geometry._core.arrays.positions}getIndices(x){return this.getAsset(x).geometry._core.arrays.indices}hasUVs(x){return this.getAsset(x).geometry._core.arrays.hasOwnProperty("uvs")}getUVs(x){return this.hasUVs(x)?this.getAsset(x).geometry._core.arrays.uvs[0]:[]}isCompressed(x){return this.getAsset(x).compressed}calculatePositions(x,ue){return this.getPositions(x).length*(ue?Bn.Positions:kn.Positions)}calculateIndices(x,ue){const fe=this.getIndices(x),ve=this.getBytesPerIndex(fe,ue);return fe.length*ve}calculateNormals(x,ue){const fe=this.getNormals(x);return Math.floor(fe.length*(ue?Bn.Normals:kn.Normals))}calculateUVs(x,ue){return this.getUVs(x).length*(ue?Bn.UVs:kn.UVs)}calculateGeometry(x,ue){let fe=0;return fe+=this.calculateIndices(x,ue),fe+=this.calculatePositions(x,ue),fe+=this.calculateNormals(x,ue),fe+=this.calculateUVs(x,ue),fe}getTris(x){return this.getIndices(x).length/3}getVerts(x){return this.getPositions(x).length/3}getGeometryMemory(x){const ue=this.getAsset(x).geometry._core,fe=ue.vertexBuf.itemByteSize*ue.vertexBuf.length,ve=ue.indexBuf.itemByteSize*ue.indexBuf.length,Pe=ue.normalBuf.itemByteSize*ue.normalBuf.length;let Ve=0;if(ue.uvBufs)for(let $e=0;$e<ue.uvBufs.length;$e++)Ve+=ue.uvBufs[$e].itemByteSize*ue.uvBufs[$e].length;return fe+ve+Pe+Ve}getStat(x){return{id:x,tris:this.getTris(x),verts:this.getVerts(x),memory:this.getGeometryMemory(x)}}}return(I=G).\u0275fac=function(x){return new(x||I)(e.KVO(_s.I))},I.\u0275prov=e.jDH({token:I,factory:I.\u0275fac,providedIn:"root"}),G})();var ms=function(I){return I[I.Positions=4]="Positions",I[I.Normals=4]="Normals",I}(ms||{}),fs=function(I){return I[I.Positions=2]="Positions",I[I.Normals=1]="Normals",I}(fs||{});let Mr=(()=>{var I;class G{constructor(x){this.assetService=x}getAsset(x){return this.assetService.getMorphs()[x]}getPositions(x){return this.getAsset(x).morphGeometry._core.targets[0].positions}getNormals(x){return this.getAsset(x).morphGeometry._core.targets[0].normals}isCompressed(x){return this.getAsset(x).compressed}calculatePositions(x,ue){return this.getPositions(x).length*(ue?fs.Positions:ms.Positions)}calculateNormals(x,ue){return this.getNormals(x).length*(ue?fs.Normals:ms.Normals)}calculateMorph(x,ue){return this.calculatePositions(x,ue)+this.calculateNormals(x,ue)}getVerts(x){return this.getAsset(x).morphGeometry._core.targets[0].positions.length/3}getMorphMemory(x){const ue=this.getAsset(x),fe=ue.morphGeometry._core.targets[0],ve=ue.morphGeometry._core.targets.length;let Pe=0;return Pe+=ve*(fe.normalBuf.itemByteSize*fe.normalBuf.length),Pe+=ve*(fe.vertexBuf.itemByteSize*fe.vertexBuf.length),Pe}getStat(x){return{id:x,verts:this.getVerts(x),memory:this.getMorphMemory(x)}}}return(I=G).\u0275fac=function(x){return new(x||I)(e.KVO(_s.I))},I.\u0275prov=e.jDH({token:I,factory:I.\u0275fac,providedIn:"root"}),G})();class It{constructor(G,ee,x,ue){this.name=G,this.value=ee,this.unit=x,this.reports=ue}}class Tr{constructor(){this.geometryDownloadTotal=0,this.textureDownloadTotal=0,this.jsonDownloadTotal=0}}class lo{}let co=(()=>{var I;class G{constructor(x,ue,fe,ve){this.geometryAssetMemoryService=x,this.morphAssetMemoryService=ue,this.engineRendererService=fe,this.assetService=ve}engineSupportsGeometryCompression(){return this.assetService.getGeometryCompressionSupported()}engineSupportsTextureCompression(){return this.assetService.getTextureCompressionSupported()}getFirstChapterDownloadSize(x){return 0}updateGlobalStats(x,ue){const fe=new Tr;fe.memory=this.getTotalMem(x,ue),fe.textureMemory=this.getTotalTexMem(),fe.geometryMemory=this.getTotalGeoMem(x),fe.morphMemory=this.getTotalMorphMem(ue);const ve=this.assetService.getGeometries();fe.uncompressedGeos=Object.values(ve).reduce(($e,Qe)=>(Qe.compressed||$e++,$e),0);const Pe=this.assetService.getMorphs();fe.uncompressedMorphs=Object.values(Pe).reduce(($e,Qe)=>{const nt=Qe.morphGeometry._core;return(!nt.compressedNormals||!nt.compressedPositions)&&$e++,$e},0);const Ve=this.assetService.getMaterials();return fe.uncompressedTextures=Object.entries(Ve).reduce(($e,[Qe,nt])=>(nt.textures.forEach(pt=>{pt._core.compressed||$e++}),$e),0),fe}updateGeoStats(x){null==x&&(x=new lo);const ue=this.assetService.getGeometries();return Object.keys(ue).forEach(fe=>{x.hasOwnProperty(fe)||(x[fe]=this.geometryAssetMemoryService.getStat(fe))}),x}updateMorphStats(x){null==x&&(x=new lo);const ue=this.assetService.getMorphs();return Object.keys(ue).forEach(fe=>{x.hasOwnProperty(fe)||(x[fe]=this.morphAssetMemoryService.getStat(fe))}),x}getTotalGeoMem(x){return Object.values(x).reduce((ue,fe)=>ue+fe.memory,0)}getTotalMorphMem(x){return Object.values(x).reduce((ue,fe)=>ue+fe.memory,0)}getTotalTexMem(){const x=this.engineRendererService.getScene();return Object.values(x.stats.textures).reduce((ue,fe)=>ue+fe.memory,0)}getTotalMem(x,ue){return this.getTotalGeoMem(x)+this.getTotalMorphMem(ue)+this.getTotalTexMem()}buildSceneGeometryReport(x){const ue=Object.keys(x).length;let fe=0,ve=0,Pe=0;Object.values(x).forEach(nt=>{ve+=nt.tris,fe+=nt.verts,Pe+=nt.memory});const Ve=new It("Shape Count (uninstanced)",ue,null),$e=new It("Triangle Count (uninstanced)",ve,null),Qe=new It("Vertex Count (uninstanced)",fe,null);return new It("Geometry Memory",Pe,"bytes",[Ve,$e,Qe])}buildSceneMorphReport(x){const ue=Object.keys(x).length;let fe=0,ve=0;Object.values(x).forEach($e=>{fe+=$e.verts,ve+=$e.memory});const Pe=new It("Morph Count (uninstanced)",ue,null),Ve=new It("Vertex Count (uninstanced)",fe,null);return new It("Morph Memory",ve,"bytes",[Pe,Ve])}buildSceneTextureReport(){const ue=this.engineRendererService.getScene().stats.textures;let fe=0;const Pe={};return Object.entries({baseColor:"diffuse",alpha:"alpha",emit:"emit",normals:"normals",specular:"specular",texture:"texture"}).forEach(([Ve,$e])=>{const Qe=this.generateTextureSummary(ue[Ve]),nt=[...Qe.reports];Pe[$e]=new It($e,Qe.submemory,"bytes",nt),fe+=Qe.submemory}),new It("Texture Memory",fe,"bytes",Object.values(Pe))}buildSceneDownloadReport(x){if(!x)return null;const ue=x.geometryDownloadTotal+x.textureDownloadTotal+x.jsonDownloadTotal,fe=new It("Geometry",x.geometryDownloadTotal,"bytes"),ve=new It("Textures",x.textureDownloadTotal,"bytes"),Pe=new It("JSON",x.jsonDownloadTotal,"bytes");return new It("Download Size",ue,"bytes",[fe,ve,Pe])}toMB(x){return(x/1048576).toFixed(2)}setDownloadTrackingEnabled(x){}generateTextureSummary(x){const ue=[];let fe=0,ve=0;return(0,L.isNil)(x)||Object.entries(x).forEach(Pe=>{const Ve=Pe[0],$e=Pe[1];"memory"===Ve?ve=$e:(ue.push(new It(Ve,$e,null)),fe+=$e)}),{reports:ue,submemory:ve,subtotal:fe}}}return(I=G).\u0275fac=function(x){return new(x||I)(e.KVO(Pr),e.KVO(Mr),e.KVO(Xs.z),e.KVO(_s.I))},I.\u0275prov=e.jDH({token:I,factory:I.\u0275fac,providedIn:"root"}),G})();var qt,bn=function(I,G,ee,x){var ve,ue=arguments.length,fe=ue<3?G:null===x?x=Object.getOwnPropertyDescriptor(G,ee):x;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)fe=Reflect.decorate(I,G,ee,x);else for(var Pe=I.length-1;Pe>=0;Pe--)(ve=I[Pe])&&(fe=(ue<3?ve(fe):ue>3?ve(G,ee,fe):ve(G,ee))||fe);return ue>3&&fe&&Object.defineProperty(G,ee,fe),fe},Nt=function(I,G){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(I,G)};class uo{}const po={compressionSupport:{geometry:!1,morph:!1,texture:!1},morphStats:null,geoStats:null,geoStatsReport:null,morphStatsReport:null,textureStatsReport:null,downloadReport:null,globalStats:{memory:0,textureMemory:0,geometryMemory:0,morphMemory:0,downloadSize:0,uncompressedGeos:0,uncompressedMorphs:0,uncompressedTextures:0,geometryDownloadTotal:0,textureDownloadTotal:0,jsonDownloadTotal:0},firstChapterDownloadSize:0};let en=((qt=class{constructor(G,ee,x){this.engineService=G,this.memoryService=ee,this.store=x}static getGlobalStats(G){return G.globalStats}static getFirstChapterDownloadSize(G){return G.firstChapterDownloadSize}reset(G,ee){G.setState({...po})}update(G,ee){const x=this.memoryService.updateGeoStats(),ue=this.memoryService.updateMorphStats(),fe=this.memoryService.updateGlobalStats(x,ue);ee.isFirstChapter&&G.patchState({firstChapterDownloadSize:this.memoryService.getFirstChapterDownloadSize(fe)});const ve=this.memoryService.buildSceneGeometryReport(x),Pe=this.memoryService.buildSceneMorphReport(ue),Ve=this.memoryService.buildSceneTextureReport(),$e=this.memoryService.buildSceneDownloadReport(fe);G.setState({...G.getState(),geoStats:x,morphStats:ue,globalStats:fe,geoStatsReport:ve,morphStatsReport:Pe,textureStatsReport:Ve,downloadReport:$e}),ee.logToConsole&&this.logMemoryState(G.getState())}ngxsOnInit(G){this.memoryService.setDownloadTrackingEnabled(!0),this.engineService.getEvent(R.X.GraphAssetAttachFinish).subscribe(()=>{const ee=(0,L.get)(this.store.selectSnapshot(ce.t),"loadingChapter.chapterId",""),x=(0,L.get)(this.store.selectSnapshot(ae.N),"chapters[0].id");G.dispatch(new En.h.Update(ee===x))})}makeReportTableFriendly(G){return G.reports.reduce((ee,x)=>({...ee,[x.name]:x.value}),{})}logMemoryState(G){console.groupCollapsed("Memory Usage"),console.group("Totals"),console.table({"Total Memory":G.globalStats.memory,"Total Geo Memory":G.globalStats.geometryMemory,"Total Morph Memory":G.globalStats.morphMemory,"Total Texture Memory":G.globalStats.textureMemory}),console.groupEnd(),console.group("Uncompressed Assets"),console.table({"Uncompressed Geos":G.globalStats.uncompressedGeos,"Uncompressed Morphs":G.globalStats.uncompressedMorphs,"Uncompressed Textures":G.globalStats.uncompressedTextures}),console.groupEnd(),console.group("Geometry Stats"),console.table(this.makeReportTableFriendly(G.geoStatsReport)),console.groupEnd(),console.group("Morph Stats"),console.table(this.makeReportTableFriendly(G.morphStatsReport)),console.groupEnd(),console.group("Texture Stats"),console.table(this.makeReportTableFriendly(G.textureStatsReport)),G.textureStatsReport.reports.forEach(ee=>{ee.reports.length&&(console.group(ee.name),console.table(this.makeReportTableFriendly(ee)),console.groupEnd())}),console.groupEnd(),console.group("Download Size"),console.table(this.makeReportTableFriendly(G.downloadReport)),console.groupEnd(),console.groupCollapsed()}}).\u0275fac=function(G){return new(G||qt)(e.KVO(pe.y),e.KVO(co),e.KVO(k.il))},qt.\u0275prov=e.jDH({token:qt,factory:qt.\u0275fac}),qt);bn([(0,k.rc)(En.h.Reset),Nt("design:type",Function),Nt("design:paramtypes",[Object,En.h.Reset]),Nt("design:returntype",void 0)],en.prototype,"reset",null),bn([(0,k.rc)(En.h.Update),Nt("design:type",Function),Nt("design:paramtypes",[Object,En.h.Update]),Nt("design:returntype",void 0)],en.prototype,"update",null),bn([(0,k.MD)(),Nt("design:type",Function),Nt("design:paramtypes",[uo]),Nt("design:returntype",void 0)],en,"getGlobalStats",null),bn([(0,k.MD)(),Nt("design:type",Function),Nt("design:paramtypes",[uo]),Nt("design:returntype",void 0)],en,"getFirstChapterDownloadSize",null),en=bn([(0,k.Uw)({name:"memory",defaults:po}),Nt("design:paramtypes",[pe.y,co,k.il])],en);let Dr=(()=>{var I;class G{}return(I=G).\u0275fac=function(x){return new(x||I)},I.\u0275mod=e.$C({type:I}),I.\u0275inj=e.G2t({imports:[k.rK.forFeature([en]),d.MD]}),G})();var Ir=n(1314);let Ar=(()=>{var I;class G{static forRoot(x){return{ngModule:G,providers:[j.e,{provide:"vendorAnalyticsConfig",useValue:x}]}}}return(I=G).\u0275fac=function(x){return new(x||I)},I.\u0275mod=e.$C({type:I}),I.\u0275inj=e.G2t({}),G})(),Rr=(()=>{var I;class G{static forRoot(x){return{ngModule:G,providers:[Q.n,{provide:"linkedinConfig",useValue:x}]}}}return(I=G).\u0275fac=function(x){return new(x||I)},I.\u0275mod=e.$C({type:I}),I.\u0275inj=e.G2t({}),G})();var jn=n(12215);let Lr=(()=>{var I;class G{}return(I=G).\u0275fac=function(x){return new(x||I)},I.\u0275mod=e.$C({type:I}),I.\u0275inj=e.G2t({imports:[d.MD,o.iI,hs.G,oo.y2.forChild()]}),G})();var Ur=n(29242),Nr=n(9632),Fr=n(99504);let kr=(()=>{var I;class G{}return(I=G).\u0275fac=function(x){return new(x||I)},I.\u0275mod=e.$C({type:I}),I.\u0275inj=e.G2t({imports:[d.MD,k.rK.forFeature([Fr.e])]}),G})();var Br=n(9940);let jr=(()=>{var I;class G{}return(I=G).\u0275fac=function(x){return new(x||I)},I.\u0275mod=e.$C({type:I}),I.\u0275inj=e.G2t({imports:[d.MD,k.rK.forFeature([Br.D])]}),G})();var ys=n(81025),go=n(4845),wr=n(66915),xr=n(62497);ys.IP(),ys.YT(),ys.ht(!1);const ho=s.c.application===g.c.Studio,Gr=[{provide:gn.a7,useClass:dr,multi:!0},{provide:o.Sd,useClass:Er},{provide:Ur.Uh,useValue:"https://recaptcha.net/recaptcha/api.js"},{provide:go.g8,useFactory:go.ht}];let zr=(()=>{var I;class G{}return(I=G).\u0275fac=function(x){return new(x||I)},I.\u0275mod=e.$C({type:I,bootstrap:[vn]}),I.\u0275inj=e.G2t({providers:Gr,imports:[k.rK.forRoot(),Ys.HU.forRoot(s.c.googleAnalyticsId),Rr.forRoot({enabled:ho,linkedinId:s.c.linkedinId}),Ar.forRoot({enabled:ho,pendoId:s.c.pendoId,hubspotId:s.c.hubspotId,idPrefixes:{[jn.Z.Local]:"local-",[jn.Z.QA]:"qa-",[jn.Z.Staging]:"staging-",[jn.Z.Production]:""}}),ao.P.forRoot(),Ir.U_,r.wb,t.Bb,gn.q1,xr.N,vr,pr.x,br,wr.z,ur.k,cr.R,mr,kr,gr.k,hs.G,Or,s.c.application===g.c.Loft?Dr:[],fr.P,h,Lr,jr,Nr.Gt]}),G})();s.c.production&&(0,e.SmG)(),t.sG().bootstrapModule(zr).catch(I=>console.error(I))},95904:()=>{},42634:()=>{}},ge=>{ge.O(0,[502],()=>ge(ge.s=28709)),ge.O()}]);