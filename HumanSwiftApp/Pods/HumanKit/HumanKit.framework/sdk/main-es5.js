!function(){function e(t,n,i){return(e="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=r(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(t,n,i||t)}function t(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&n(e,t)}function n(e,t){return(n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function i(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=r(e);if(t){var a=r(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return o(this,n)}}function o(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?a(e):t}function a(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function r(e){return(r=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function c(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=g(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,r=!0,c=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return r=e.done,e},e:function(e){c=!0,a=e},f:function(){try{r||null==n.return||n.return()}finally{if(c)throw a}}}}function s(e){return function(e){if(Array.isArray(e))return h(e)}(e)||l(e)||g(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function p(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function u(e,t){return f(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],i=!0,o=!1,a=void 0;try{for(var r,c=e[Symbol.iterator]();!(i=(r=c.next()).done)&&(n.push(r.value),!t||n.length!==t);i=!0);}catch(s){o=!0,a=s}finally{try{i||null==c.return||c.return()}finally{if(o)throw a}}return n}(e,t)||g(e,t)||d()}function d(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function g(e,t){if(e){if("string"==typeof e)return h(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?h(e,t):void 0}}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function f(e){if(Array.isArray(e))return e}function b(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function v(e,t,n){return t&&b(e.prototype,t),n&&b(e,n),e}function m(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{0:function(e,t,n){e.exports=n("dwNn")},1:function(e,t){},dwNn:function(n,o,h){"use strict";var b,y,x;h.r(o);var w,k,O,C,S,_=h("fXoL"),j=function(e){return e.Loft="loft",e.Studio="studio",e.Viewer="viewer",e.All="",e}({}),P=function(e){return e.Bookmark="bookmark",e.Module="module",e.Internal="internal",e}({}),M=function(e){return e.Local="Local",e.QA="QA",e.Staging="Staging",e.Production="Production",e}({}),I=function(e){return e.Web="web",e.SDK="sdk",e}({}),z={production:!0,assetDomain:"assets-human.biodigital.com",supportEmail:"support@biodigital.com",googleAuthKey:"66261904577-061oin26uo7sor0vrqc8dnn105irq82n.apps.googleusercontent.com",facebookAuthKey:"218801781466301",facebookPixelId:"973525219844030",googleAnalyticsId:"UA-1141985-29",linkedinId:"2641938",pendoId:"3a783681-e53b-4ebd-69c0-788bbae48f13",rollbarToken:"dd70f513aa0740668070fa3fd62b33a0",recaptchaKey:"6LdvZvcUAAAAAM0Z1St9WQXwvSYd__hMUY2WZ6um",application:j.Viewer,deploy:M.Production,platform:I.SDK,exportType:P.Bookmark,offline:!1,native:!1,minPasswordLength:8},T=h("jhN1"),U=h("R1ws"),L=h("AcyG"),D=function e(){m(this,e)},E=function(){var e=function e(t,n,i){m(this,e),this.hostingURL=t,this.embedded=n,this.widgetConfig=i};return e.type="[Widget] Setup Widget",e}(),F=function(){var e=function e(t,n){m(this,e),this.interaction=t,this.source=n};return e.type="[Widget] Log Interaction",e}(),A=function(){var e=function e(t,n){m(this,e),this.interaction=t,this.response=n};return e.type="[Widget] Log Interaction Success",e}(),R=function(){var e=function e(t,n){m(this,e),this.interaction=t,this.response=n};return e.type="[Widget] Log Interaction Failure",e}(),N=function(){var e=function e(){m(this,e)};return e.type="[Widget] Auth",e}(),V=function(){var e=function e(t,n){m(this,e),this.userType=t,this.response=n};return e.type="[Widget] Auth Success",e}(),H=function(){var e=function e(t,n){m(this,e),this.userType=t,this.response=n};return e.type="[Widget] Auth Failure",e}(),B=function(){var e=function e(){m(this,e)};return e.type="[Widget] Reset",e}(),Q=((w=function e(t){m(this,e),this.enabled=t}).type="[Widget] Set Input Enabled",w),q=function(){var e=function e(t){m(this,e),this.config=t};return e.type="[Widget] Set API Config",e}(),W=h("tk/3"),$=h("LRne"),K=h("lJxs"),G=h("JIr8"),Z=function(e){return e.InvalidUAID="analytic id does not exist",e.InvalidDeveloperId="Client id invalid",e.InvalidProductKey="app product key",e.MissingUAID="analytic id missing",e.WebOnlyAPI="Api key only compatible with Web Widget",e.AndroidOnlyAPI="Api key only compatible with Mobile Widget SDK for Android",e.IOSOnlyAPI="Api key only compatible with Mobile Widget SDK for iOS",e.MixedAPIKeys="Use of both an app product key and an app api key not allowed",e.ProductKeyNotRegistered='App product key "xxx" has not been registered or is incorrect.  Ensure it has been registered by the system admin',e.ProductKeyInvalidAppBundleID='The app product key "xxx" has not been authorized to be used for app bundle id "yyy".  Confirm the correct values are being used from the system admin',e.ProductKeyBundleIDWhitelist='Use of app product key "xxx" requires the affiliated app bundle id (app_domain) to be white-listed.  Ensure the system admin has white-listed "yyy"',e.ImproperProductKeyUsage='Improper use of app product key "xxx" detected. Contact the system admin if issue continues',e.InvalidPlatformSource="Invalid platform source",e.MissingSource="Missing source",e.MissingPlatform="Missing platform",e.MissingAppDomain="Missing app domain",e.APIKeyMissing="Api key missing",e.APIKeyInvalid="Api key invalid",e.DeveloperDeactivated="Developer account for api key is deactivated",e.BundleIDNotAllowed="App bundle id not allowed",e.BundleIDUnregistered="App bundle id unregistered",e}({}),J=function e(){m(this,e)},X=function e(){m(this,e)},Y=h("b36G"),ee=function(e){return e.Widget="widget",e.WidgetAPI="widgetapi",e}({}),te=h("Qyje"),ne={headers:new W.d({"Content-Type":"application/json; charset=utf-8"})},ie=((O=function(){function e(t){m(this,e),this.http=t}return v(e,[{key:"getAnalytic",value:function(e){var t=this;return z.offline?(fetch("https://human.biodigital.com/ws/user/analytics?analytic_id="+e,{method:"GET",mode:"no-cors"}),Object($.a)({success:!0})):this.http.get("/ws/user/analytics?analytic_id="+e).pipe(Object(K.a)((function(){return{success:!0}})),Object(G.a)((function(e){return Object($.a)(t.parseError(e))})))}},{key:"sendAnalytic",value:function(e){var t=this;if(z.offline){var n=e instanceof X?"https://human.biodigital.com/ws/user/analytics":"https://human.biodigital.com/ws/developer/apps/access/key",i=JSON.parse(JSON.stringify(e)),o=Object(te.stringify)(i);return fetch(n,{headers:{"Content-Type":"application/x-www-form-urlencoded"},method:"POST",mode:"no-cors",body:o}),Object($.a)({success:!0})}return this.http.post(e instanceof X?"/ws/user/analytics":"/ws/developer/apps/access/key",e,ne).pipe(Object(K.a)((function(){return{success:!0}})),Object(G.a)((function(e){return Object($.a)(t.parseError(e))})))}},{key:"buildDeveloperAnalytic",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:ee.Widget,i=arguments.length>3?arguments[3]:void 0,o=e.widgetUrlConfig,a=e.parentUrl,r=e.embedded,c={platform:n,app_activity:t,app_productkey:o["app-productkey"],app_userid:o["app-userid"],app_apikey:o.dk,app_domain:a.full,app_activity_data:i,widget_is_fullscreen:!r};return Object(Y.plainToClass)(J,c)}},{key:"parseError",value:function(e){if(z.offline)return{success:!0,message:"",errorCode:null};var t=e.error.error,n=e.status,i=t&&t.message?t.message:"";return{success:n>=500&&n<=504,message:i,errorCode:Object.values(Z).includes(i)?i:null}}}]),e}()).\u0275fac=function(e){return new(e||O)(_.Zb(W.b))},O.\u0275prov=_.Lb({token:O,factory:O.\u0275fac,providedIn:"root"}),O),oe=((k=function(){function e(t){m(this,e),this.analyticsService=t}return v(e,[{key:"authDeveloper",value:function(e){return this.analyticsService.sendAnalytic(e)}},{key:"authUser",value:function(e){return this.analyticsService.getAnalytic(e)}}]),e}()).\u0275fac=function(e){return new(e||k)(_.Zb(ie))},k.\u0275prov=_.Lb({token:k,factory:k.\u0275fac,providedIn:"root"}),k),ae=h("nYR2"),re=function e(){m(this,e)},ce=function(e){return e[e.User=0]="User",e[e.Developer=1]="Developer",e}({}),se=function(e){return e.Init="init",e.View="view",e.ChanceInteraction="interactionc",e.FirstInteraction="interactionf",e.Call="call",e}({}),le=function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r},pe=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},ue={userType:ce.User,authenticating:!1,authenticated:!1,widgetUrlConfig:{id:"",type:""},widgetApiConfig:null,parentUrl:{full:"",domain:""},embedded:!1,engineVersion:"",engineAPIVersion:"",inputEnabled:!0},de=((C=function(){function e(t,n){m(this,e),this.authService=t,this.analyticsService=n}return v(e,[{key:"setupWidget",value:function(e,t){var n=t.hostingURL,i=t.embedded,o=t.widgetConfig,a=n.match(/:\/\/(.[^/]+)/);e.patchState({userType:o.uaid?ce.User:ce.Developer,embedded:i,widgetUrlConfig:o,parentUrl:{full:n,domain:a&&a[1]?a[1]:n}})}},{key:"authWidget",value:function(e,t){var n=e.getState(),i=n.userType,o=n.widgetUrlConfig,a=i===ce.User?this.authService.authUser(o.uaid):this.authService.authDeveloper(this.analyticsService.buildDeveloperAnalytic(n,se.Init,ee.WidgetAPI,this.buildAppActivityData(n)));e.patchState({authenticating:!0}),a.pipe(Object(ae.a)((function(){return e.patchState({authenticating:!1})}))).subscribe((function(t){var n=t.success;e.patchState({authenticated:n}),e.dispatch(n?new V(i,t):new H(i,t))}))}},{key:"logWidgetInteraction",value:function(e,t){var n=t.interaction,i=t.source,o=e.getState(),a=o.userType===ce.User?this.buildUserAnalytic(o,n,i):this.analyticsService.buildDeveloperAnalytic(o,n,ee.Widget,this.buildAppActivityData(o));this.analyticsService.sendAnalytic(a).subscribe((function(t){e.dispatch(t.success?new A(n,t):new R(n,t))}))}},{key:"resetWidget",value:function(e,t){e.setState(ue)}},{key:"buildAppActivityData",value:function(e){var t=e.engineVersion,n=e.engineAPIVersion,i=e.widgetUrlConfig,o={engine_version:t,api_version:n};return Object.entries(i).filter((function(e){return"dk"!==u(e,1)[0]})).forEach((function(e){var t=u(e,2),n=t[0],i=t[1];o["url_param_"+n]=i})),Object(Y.plainToClass)(re,o)}},{key:"setInputEnabled",value:function(e,t){e.patchState({inputEnabled:t.enabled})}},{key:"setWidgetApiConfig",value:function(e,t){e.patchState({widgetApiConfig:t.config})}},{key:"buildUserAnalytic",value:function(e,t,n){var i=e.widgetUrlConfig,o=e.parentUrl,a=i.uaid,r=o.domain,c=Object.assign(Object.assign({},this.buildAppActivityData(e)),p({parent_analytic_identifier:a,referer_domain:r},t+"_source",n)),s={analytic_platform:ee.Widget,analytic_type:t,analytic_data:c};return Object(Y.plainToClass)(X,s)}},{key:"ngxsOnInit",value:function(e){e.patchState({engineVersion:Human.VERSION,engineAPIVersion:Human.API_VERSION})}}],[{key:"getWidgetState",value:function(e){return e}},{key:"getUserType",value:function(e){return e.userType}},{key:"getWidgetAuthenticating",value:function(e){return e.authenticating}},{key:"getWidgetAuthenticated",value:function(e){return e.authenticated}},{key:"getInputEnabled",value:function(e){return e.inputEnabled}},{key:"getEmbedded",value:function(e){return e.embedded}},{key:"getParentURL",value:function(e){return e.parentUrl.full}},{key:"getWidgetUrlConfig",value:function(e){return e.widgetUrlConfig}},{key:"getWidgetApiUIConfig",value:function(e){return e.widgetApiConfig}}]),e}()).\u0275fac=function(e){return new(e||C)(_.Zb(oe),_.Zb(ie))},C.\u0275prov=_.Lb({token:C,factory:C.\u0275fac}),le([Object(L.a)(E),pe("design:type",Function),pe("design:paramtypes",[Object,E]),pe("design:returntype",void 0)],C.prototype,"setupWidget",null),le([Object(L.a)(N),pe("design:type",Function),pe("design:paramtypes",[Object,N]),pe("design:returntype",void 0)],C.prototype,"authWidget",null),le([Object(L.a)(F),pe("design:type",Function),pe("design:paramtypes",[Object,F]),pe("design:returntype",void 0)],C.prototype,"logWidgetInteraction",null),le([Object(L.a)(B),pe("design:type",Function),pe("design:paramtypes",[Object,B]),pe("design:returntype",void 0)],C.prototype,"resetWidget",null),le([Object(L.a)(Q),pe("design:type",Function),pe("design:paramtypes",[Object,Q]),pe("design:returntype",void 0)],C.prototype,"setInputEnabled",null),le([Object(L.a)(q),pe("design:type",Function),pe("design:paramtypes",[Object,q]),pe("design:returntype",void 0)],C.prototype,"setWidgetApiConfig",null),le([Object(L.e)(),pe("design:type",Function),pe("design:paramtypes",[D]),pe("design:returntype",void 0)],C,"getWidgetState",null),le([Object(L.e)(),pe("design:type",Function),pe("design:paramtypes",[D]),pe("design:returntype",void 0)],C,"getUserType",null),le([Object(L.e)(),pe("design:type",Function),pe("design:paramtypes",[D]),pe("design:returntype",void 0)],C,"getWidgetAuthenticating",null),le([Object(L.e)(),pe("design:type",Function),pe("design:paramtypes",[D]),pe("design:returntype",void 0)],C,"getWidgetAuthenticated",null),le([Object(L.e)(),pe("design:type",Function),pe("design:paramtypes",[D]),pe("design:returntype",void 0)],C,"getInputEnabled",null),le([Object(L.e)(),pe("design:type",Function),pe("design:paramtypes",[D]),pe("design:returntype",void 0)],C,"getEmbedded",null),le([Object(L.e)(),pe("design:type",Function),pe("design:paramtypes",[D]),pe("design:returntype",void 0)],C,"getParentURL",null),le([Object(L.e)(),pe("design:type",Function),pe("design:paramtypes",[D]),pe("design:returntype",void 0)],C,"getWidgetUrlConfig",null),le([Object(L.e)(),pe("design:type",Function),pe("design:paramtypes",[D]),pe("design:returntype",void 0)],C,"getWidgetApiUIConfig",null),C=le([Object(L.f)({name:"widget",defaults:ue})],C)),ge=h("XNiG"),he=h("HDdC"),fe=h("1G5W"),be=h("pLZG"),ve=function(e){return e[e.Basics=0]="Basics",e[e.All=1]="All",e[e.Shortcuts=2]="Shortcuts",e}({});!function(e){var t=function e(t){m(this,e),this.canHover=t};t.type="[View] Set Can Hover",e.SetCanHover=t;var n=function e(t){m(this,e),this.canTouch=t};n.type="[View] Set Can Touch",e.SetCanTouch=n;var i=function e(t){m(this,e),this.canFullscreen=t};i.type="[View] Set Can Fullscreen",e.SetCanFullscreen=i;var o=function e(t){m(this,e),this.ui=t};o.type="[View] Set UI",e.SetUI=o;var a=function e(t){m(this,e),this.ui=t};a.type="[View] Set Initial UI",e.SetInitialUI=a;var r=function e(t){m(this,e),this.enabled=t};r.type="[View] Set Input Enabled",e.SetInputEnabled=r;var c=function e(t){m(this,e),this.mode=t};c.type="[View] Set Search Display Mode",e.SetSearchDisplayMode=c;var s=function e(t){m(this,e),this.active=t};s.type="[View] Toggle Presentation",e.TogglePresentation=s;var l=function e(t){m(this,e),this.interactType=t};l.type="[View] Set Interact Type",e.SetInteractType=l;var p=function e(t){m(this,e),this.onDemand=t};p.type="[View] Set On Demand",e.SetOnDemand=p;var u=function e(t){m(this,e),this.layout=t};u.type="[View] Set Layout",e.SetLayout=u;var d=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ve.Basics;m(this,e),this.tab=t};d.type="[View] Toggle Help Tab",e.ToggleHelpTab=d;var g=function e(t){m(this,e),this.inputMode=t};g.type="[View] Set Input Mode",e.SetInputMode=g;var h=function e(t){m(this,e),this.tutorial=t};h.type="[View] Set Tutorial",e.SetTutorial=h;var f=function e(t){m(this,e),this.intro=t};f.type="[View] Start Tutorial",e.StartTutorial=f;var b=function e(t){m(this,e),this.seen=t};b.type="[View] Tutorial Seen",e.TutorialSeen=b;var v=function e(){m(this,e)};v.type="[View] Tutorial Next",e.TutorialNext=v;var y=function e(){m(this,e)};y.type="[View] Tutorial Previous",e.TutorialPrevious=y;var x=function e(t){m(this,e),this.show=t};x.type="[View] Toggle Node Info",e.ToggleNodeInfo=x;var w=function e(t){m(this,e),this.enabled=t};w.type="[View] Set multi pick mode enabled",e.SetMultiPickModeEnabled=w;var k=function e(t){m(this,e),this.labelsBreakpoint=t};k.type="[View] Set Label Breakpoint",e.SetLabelBreakpoint=k;var O=function e(t){m(this,e),this.usePrintImage=t};O.type="[View] Set Use Print Image",e.SetUsePrintImage=O;var C=function e(t){m(this,e),this.windows=t};C.type="[View] Set Windows",e.SetWindows=C;var S=function e(t){m(this,e),this.window=t};S.type="[View] Open Window",e.OpenWindow=S;var _=function e(t){m(this,e),this.window=t};_.type="[View] Close Window",e.CloseWindow=_;var j=function e(t,n){m(this,e),this.window=t,this.show=n};j.type="[View] Toggle Window",e.ToggleWindow=j;var P=function e(t){m(this,e),this.open=t};P.type="[View] Toggle Menu",e.ToggleMenu=P;var M=function e(t){m(this,e),this.enabled=t};M.type="[View] Whiteboard Enabled",e.SetWhiteboardEnabled=M;var I=function e(t){m(this,e),this.brushSize=t};I.type="[View] Whiteboard Brush Size",e.SetWhiteboardBrushSize=I;var z=function e(t){m(this,e),this.brushColor=t};z.type="[View] Whiteboard Brush Color",e.SetWhiteboardBrushColor=z;var T=function e(t){m(this,e),this.size=t};T.type="[View] Whiteboard Text Size",e.SetWhiteboardTextSize=T;var U=function e(t){m(this,e),this.eraserSize=t};U.type="[View] Whiteboard Eraser Size",e.SetWhiteboardEraserSize=U;var L=function e(t){m(this,e),this.mode=t};L.type="[View] Whiteboard Annotate Mode",e.SetWhiteboardAnnotateMode=L;var D=function e(t){m(this,e),this.hasPaint=t};D.type="[View] Whiteboard Has Paint",e.SetWhiteboardHasPaint=D;var E=function e(t){m(this,e),this.hasText=t};E.type="[View] Whiteboard Has Text",e.SetWhiteboardHasText=E}(S||(S={}));var me,ye,xe,we=h("tyNb"),ke=(h("mNvP"),h("m+po"),h("Wdmj")),Oe=h("LvDl"),Ce=function(e){return e.DiscoveredChapterNav="Discovered Chapter Nav",e}({}),Se=((me=function(){function e(t){m(this,e),this.config=t,this.appended=!1,this.singleEvents={}}return v(e,[{key:"appendScript",value:function(){if(this.config.enabled&&!this.appended){var e="\n      (function(apiKey){\n        (function(p,e,n,d,o){var v,w,x,y,z;o=p[d]=p[d]||{};o._q=o._q||[];\n        v=['initialize','identify','updateOptions','pageLoad','track'];for(w=0,x=v.length;w<x;++w)(function(m){\n            o[m]=o[m]||function(){o._q[m===v[0]?'unshift':'push']([m].concat([].slice.call(arguments,0)));};})(v[w]);\n            y=e.createElement(n);y.async=!0;y.src='https://cdn.pendo.io/agent/static/'+apiKey+'/pendo.js';\n            z=e.getElementsByTagName(n)[0];z.parentNode.insertBefore(y,z);})(window,document,'script','pendo');\n      })('".concat(this.config.pendoId,"');\n    "),t=document.createElement("script");t.textContent=e,document.body.appendChild(t),this.appended=!0}}},{key:"initialize",value:function(e){var t,n=Object.assign({},e);if(this.pendoEnabled()){var i=Object(Oe.get)(this.config,"idPrefixes[".concat(z.deploy,"]"),"");n.visitor.id="".concat(i).concat(n.visitor.id),n.account.id="".concat(i).concat(null!==(t=n.account.id)&&void 0!==t?t:999999999),pendo.initialize(e)}}},{key:"track",value:function(e,t){this.pendoEnabled()&&pendo.track(e,t)}},{key:"trackSingle",value:function(e,t){this.singleEvents[e]||this.pendoEnabled()&&(this.track(e,t),this.singleEvents[e]=!0)}},{key:"pendoEnabled",value:function(){if(!this.config.enabled)return!1;var e=Object(Oe.get)(this.config,"whitelist[".concat(z.application,"]"),null);if(!Object(Oe.isNil)(e)){var t=new URLSearchParams(window.location.search),n=t.get("id")||t.get("be")||t.get("m");return e.includes(n)}return!0}}]),e}()).\u0275fac=function(e){return new(e||me)(_.Zb("pendoConfig"))},me.\u0275prov=_.Lb({token:me,factory:me.\u0275fac,providedIn:"root"}),me),_e=function(){var e=function e(){m(this,e)};return e.type="[Engine] Load",e}(),je=function(){var e=function e(t){m(this,e),this.result=t};return e.type="[Engine] Load Success",e}(),Pe=function(){var e=function e(t){m(this,e),this.ready=t};return e.type="[Engine] Set Ready",e}(),Me=function(){var e=function e(t){m(this,e),this.display=t};return e.type="[Engine] Set Display of 3D Scene",e}(),Ie=function(){var e=function e(t){m(this,e),this.scrollMode=t};return e.type="[Engine] Set Zoom via scroll Allowed",e}(),ze=function(){var e=function e(t){m(this,e),this.shown=t};return e.type="[Engine] Set Scroll Alert Shwon",e}(),Te=function(){var e=function e(t){m(this,e),this.visible=t};return e.type="[Engine] Set Visibility of 3D Scene",e}(),Ue=function(){var e=function e(t,n){m(this,e),this.color=t,this.duration=n};return e.type="[Engine] Fade",e}(),Le=function(){var e=function e(){m(this,e)};return e.type="[Engine] Fade Complete",e}(),De=function(){var e=function e(t){m(this,e),this.graph=t};return e.type="[Engine] Set Graph",e}(),Ee=function(){var e=function e(){m(this,e)};return e.type="[Engine] Clear Graph",e}(),Fe=function(){var e=function e(t){m(this,e),this.enabled=t};return e.type="[Engine] Set Xray Mode",e}(),Ae=function(){var e=function e(t){m(this,e),this.chapterId=t};return e.type="[Engine] Set Engine Chapter",e}(),Re=function(){var e=function e(t){m(this,e),this.chapterInit=t};return e.type="[Eninge] Set Chapter Init",e}(),Ne=function(){var e=function e(t,n,i){m(this,e),this.node=t,this.event=n,this.hit=i};return e.type="[Engine] Click Node",e}(),Ve=function(){var e=function e(t,n){m(this,e),this.node=t,this.hit=n};return e.type="[Engine] Set Contextmenu",e}(),He=function(){var e=function e(t){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=arguments.length>2?arguments[2]:void 0;m(this,e),this.objectId=t,this.animate=n,this.animationDuration=i};return e.type="[Engine] Fly To Object",e}(),Be=function(){var e=function e(){m(this,e)};return e.type="[Engine] Center Camera on Visible Nodes",e}(),Qe=function(){var e=function e(t,n){m(this,e),this.leafVisibilityState=t,this.nodes=n};return e.type="[Engine] Synchronize Visible Nodes On Tree",e}(),qe=function(){var e=function e(t){m(this,e),this.leafRenderableState=t};return e.type="[Engine] Synchronize Renderable State of Nodes On Tree",e}(),We=function(){var e=function e(t,n){m(this,e),this.leafPickableState=t,this.nodes=n};return e.type="[Engine] Synchronize Pickable State of Nodes On Tree",e}(),$e=function(){var e=function e(t){m(this,e),this.show=t};return e.type="[Engine] Toggle Camera Bar",e}(),Ke=function(){var e=function e(t){m(this,e),this.show=t};return e.type="[Engine] Toggle Progress Bar",e}(),Ge=function(){var e=function e(t){m(this,e),this.show=t};return e.type="[Engine] Toggle Labels",e}(),Ze=function(){var e=function e(t){m(this,e),this.tool=t};return e.type="[Engine] Set active tool",e}(),Je=function(){var e=function e(t,n){m(this,e),this.chapter=t,this.pause=n};return e.type="[Engine] Play chapter animation",e}(),Xe=function(){var e=function e(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];m(this,e),this.play=t};return e.type="[Engine] Play animation",e}(),Ye=function(){var e=function e(t){m(this,e),this.playing=t};return e.type="[Engine] Set animation playing",e}(),et=function(){var e=function e(t){m(this,e),this.speed=t};return e.type="[Engine] Set playback speed",e}(),tt=function(){var e=function e(t){m(this,e),this.play=t};return e.type="[Engine] Play audio",e}(),nt=function(){var e=function e(){m(this,e)};return e.type="[Engine] Play chapter from start",e}(),it=function(){var e=function e(t){m(this,e),this.enable=t};return e.type="[Engine] Set autoplay",e}(),ot=function(){var e=function e(t,n){m(this,e),this.nodes=t,this.layer=n};return e.type="[Engine] Set object layer order",e}(),at=function(){var e=function e(t,n){m(this,e),this.nodeId=t,this.displayName=n};return e.type="[Engine] Set object display name",e}(),rt=function(){var e=function e(){m(this,e)};return e.type="[Engine] Auto Sort object layer orders",e}(),ct=function(){var e=function e(){m(this,e)};return e.type="[Engine] Reset object layer orders",e}(),st=function(){var e=function e(t){m(this,e),this.position=t};return e.type="[Engine] Set Engine Position",e}(),lt=function(){var e=function e(){m(this,e)};return e.type="[Engine] Reset Engine Position",e}(),pt=function(){var e=function e(t){m(this,e),this.effects=t};return e.type="[Engine] Set Post Processing Effects",e}(),ut=function(){var e=function e(t){m(this,e),this.properties=t};return e.type="[Engine] Set Properties",e}(),dt=function(){var e=function e(t){m(this,e),this.mode=t};return e.type="[Engine] Set Transparency Mode",e}(),gt=function(){var e=function e(t){m(this,e),this.node=t};return e.type="[Engine] Expand ViewTree Node",e}(),ht=function(){var e=function e(t){m(this,e),this.node=t};return e.type="[Engine] Collapse ViewTree Node",e}(),ft=function(){var e=function e(t,n){m(this,e),this.node=t,this.hit=n};return e.type="[Engine] Hover Node",e}(),bt=function(){var e=function e(t){m(this,e),this.node=t};return e.type="[Engine] Set Label Edit Node",e}(),vt=function(){var e=function e(t,n){m(this,e),this.node=t,this.description=n};return e.type="[Engine] Set Node Info",e}(),mt=function(){var e=function e(t){m(this,e),this.node=t};return e.type="[Engine] Query Node Info",e}(),yt=function(){var e=function e(t,n){m(this,e),this.node=t,this.description=n};return e.type="[Engine] Query Node Info Success",e}(),xt=function(){var e=function e(t){m(this,e),this.node=t};return e.type="[Engine Nodes] Query Node Info Failure",e}(),wt=function e(){m(this,e)},kt=function e(){m(this,e)},Ot=function e(t){var n=this;m(this,e),this.shown=function(e){return!1},this.selected=function(e){return!1},this.pickable=function(e){return!0},t.forEach((function(e){n[e]=function(e){return!1}}))};!function(e){function t(e,t){e.nodes[t.id]||(e.nodes[t.id]=t)}function n(e,t){return e.nodes[t]||null}function i(e,t){return e.predecessors[t]||null}function o(e,t){return s(e.successors[t]||[])}function a(e){return Object.keys(e.roots)}e.addRootNode=function(e,i){t(e,i);var o=n(e,i.id);e.roots[o.id]=o},e.getNodes=function(e,t){var n=[];return t.forEach((function(t){e.nodes[t]&&n.push(e.nodes[t])})),n},e.getAncestors=function(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"ascending",o=n?[t]:[],a=e.predecessors[t];a;)o.push(a),a=e.predecessors[a];return"descending"===i&&o.reverse(),o},e.addNode=t,e.getNode=n,e.getAncestor=i,e.getAllAncestorsFromList=function(e,t){var n,o={};return t.forEach((function(t){(n=i(e,t))&&!o[n]&&(o[n]=!0)})),Object.keys(o)},e.getSuccessors=o,e.getState=function(e,t,i){var o={},a=n(e,t);return Object.entries(a.boolState).forEach((function(e){var t=u(e,2),n=t[0],a=t[1];i&&i.includes(n)&&(o[n]=a)})),Object.entries(a.numState).forEach((function(e){var t=u(e,2),n=t[0],a=t[1];i&&i.includes(n)&&(o[n]=a)})),o},e.isLeaf=function(e,t){return!!e.nodes[t]&&void 0===e.successors[t]},e.isRoot=function(e,t){return e.roots.hasOwnProperty(t)||!1},e.getRoots=a,e.depthFirst=function e(t,n,i){i?(n(i),o(t,i).forEach((function(i){e(t,n,i)}))):a(t).forEach((function(i){n(i),e(t,n,i)}))},e.createGraphFromSrc=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"objectId",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"objects",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o={nodes:{},successors:{},predecessors:{},roots:{}};return e.forEach((function(e){!function e(t,n,i,o,a,r,c){var l={id:i[o],depth:0,boolState:{},numState:{}};l.depth=c,function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"id";Object.entries(n).forEach((function(n){var o,a=u(n,2),r=a[0],c=a[1];"string"==typeof c?o=t[c]:"function"==typeof c&&(o=c(t[i])),"boolean"==typeof o?e.boolState[r]=o:"number"==typeof o?e.numState[r]=o:e[r]=o}))}(l,i,r,o),t.nodes[l.id]=l,n?(t.successors[n]=[].concat(s(t.successors[n]||[]),[l.id]),t.predecessors[l.id]=n):t.roots[l.id]=l,c+=1,(i[a]||[]).forEach((function(n){e(t,l.id,n,o,a,r,c)}))}(o,null,e,t,n,i,0)})),o},e.pruneHiddenObjects=function e(t,n,i){var o,a=[],r=c(t);try{for(r.s();!(o=r.n()).done;){var s=o.value,l=n[s.objectId],p=!0===l||!1!==l&&i,u=e(s.objects||[],n,p);if(p){var d=Object.assign({},s);d.objects=u,a.push(d)}else u.forEach((function(e){return a.push(e)}))}}catch(g){r.e(g)}finally{r.f()}return a}}(ye||(ye={})),function(e){function t(e,t){return e.reduce((function(e,n){return e[n]=t[n]||!1,e}),{})}e.createVoter=t,e.getInitialVoterState=function(e,n){return Object.keys(e).reduce((function(i,o){return i[o]=t(n,e[o]),i}),{})},e.getInitialElectionDepth=function(e,t){return Object.keys(e).reduce((function(e,n){return Math.max(e,ye.getNode(t,n).depth)}),0)-1},e.getEligibleElections=function(e,t,n){return ye.getAllAncestorsFromList(e,t).filter((function(t){return t&&ye.getNode(e,t).depth===n}))};var n={trueWins:function(e){return{result:e.votesFor.length>0,dissenters:s(e.votesAgainst)}},falseWins:function(e){return{result:e.votesAgainst.length>0,dissenters:s(e.votesFor)}},majorityWins:function(e){var t=e.votesFor.length>e.votesAgainst.length;return{result:t,dissenters:s(t?e.votesAgainst:e.votesFor)}}};function i(e,t,i){return Object.keys(t).reduce((function(o,a){var r=t[a],c=i[a]||"majorityWins",l=n[c](r),p=l.result,u=l.dissenters;return o[a]={id:e,result:p,dissenters:u,voters:[].concat(s(r.votesFor),s(r.votesAgainst))},o}),{})}e.buildElectionResult=i,e.getElectionResults=function(e,n,o,a){var r=n,c=Object.keys(a);return{results:o.reduce((function(o,s){var l=ye.getSuccessors(e,s),d=l.map((function(i){return p({},i,n[i]||t(c,ye.getState(e,i,c)))}));l.forEach((function(e){delete r[e]}));var g=i(s,function(e,t){return Object.keys(e).reduce((function(e,n){var i=t.reduce((function(e,t){var i=Object.keys(t)[0];return t[i][n]?e.votesFor.push(i):e.votesAgainst.push(i),e}),{votesFor:[],votesAgainst:[]});return e[n]=i,e}),{})}(a,d),a);return r[s]=Object.entries(g).reduce((function(e,t){var n=u(t,2),i=n[0],o=n[1];return e[i]=o.result,e}),{}),o.results.push(g),o}),{results:[]}).results,remainingVoters:r}}}(xe||(xe={}));var Ct,St=((Ct=function(){function e(){m(this,e)}return v(e,[{key:"serializeNode",value:function(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(e){return!0},a={};return a.id=t.id,Object.entries(t.boolState).forEach((function(e){var t=u(e,2),n=t[0],o=t[1];i.hasOwnProperty(n)&&(a[n]=o)})),Object.entries(t.numState).forEach((function(e){var t=u(e,2),n=t[0],o=t[1];i.hasOwnProperty(n)&&(a[n]=o)})),e.successors[t.id]&&(a.children=[],e.successors[t.id].forEach((function(t){o(t)&&a.children.push(n.serializeNode(e,e.nodes[t],i,o))}),this)),a}},{key:"getAllSiblingsFromList",value:function(e,t,n){var i,o=[];for(i=0;i<t.length;i++)this.getSiblings(e,t[i],n).forEach((function(e){o.includes(e)||o.push(e)}));return o}},{key:"getElectionResults",value:function(e,n,o,r){var c,s,l=this,p=function(e){t(o,e);var n=i(o);function o(e,t){var i;return m(this,o),i=n.call(this),Object.entries(e).forEach((function(e){var n=u(e,2),o=n[0];n[1],i[o]={votesFor:[],votesAgainst:[]},Object.entries(t).forEach((function(e){var t=u(e,2),n=t[0];t[1][o]?i[o].votesFor.push(n):i[o].votesAgainst.push(n)}),a(i))}),a(i)),i}return o}(function(){return function e(){m(this,e)}}()),d=Object.keys(r),g=[];return o.forEach((function(t){s={},ye.getSuccessors(e,t).forEach((function(t){s[t]=n[t]||xe.createVoter(d,ye.getState(e,t,d)),delete n[t]}),l),c=new p(r,s);var i=xe.buildElectionResult(t,c,r);g.push(i);var o={};Object.entries(i).forEach((function(e){var t=u(e,2),n=t[0],i=t[1];o[n]=i.result})),n[t]=o}),this),g}},{key:"updateGraphStateRecord",value:function(e,t,n,i){var o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];n.forEach((function(n){var a=n[i[0]].id,r=ye.getState(e,a,i),c={},s=!1;i.forEach((function(e){(o||n[e].result!==r[e])&&(c[e]=n[e].result,s=!0)})),s&&(t[a]=c)}),this)}},{key:"nodeExists",value:function(e,t){return!!e.nodes[t]}},{key:"getLeaves",value:function(e){var t=[];return Object.entries(e.nodes).forEach((function(n){var i=u(n,2),o=i[0];i[1],e.successors[o]||t.push(o)})),t}},{key:"getDescendants",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=[];return function t(n){ye.getSuccessors(e,n).forEach((function(e){i.push(e),t(e)}))}(t),n&&i.push(t),i}},{key:"getLeafDescendants",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=this.getDescendants(e,t,n).filter((function(t){return ye.isLeaf(e,t)}));return(ye.isLeaf(e,t)||n)&&i.push(t),i}},{key:"getAllLeafDescendants",value:function(e,t){var n=this,i=[];return t.forEach((function(t){i=ye.isLeaf(e,t)?[].concat(s(i),[t]):[].concat(s(i),s(n.getLeafDescendants(e,t,!1)))})),i.sort().reduce((function(e,t){return e.indexOf(t)<0&&e.push(t),e}),[])}},{key:"getInverseSelection",value:function(e,t){var n=this.getAllLeafDescendants(e,t);return this.getLeaves(e).filter((function(e){return n.indexOf(e)<0}))}},{key:"getSiblings",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=e.predecessors[t],o=[];if(o=i?ye.getSuccessors(e,i):ye.getRoots(e),!n){var a=o.indexOf(t);a>=0&&o.splice(a,1)}return o}},{key:"getNodes",value:function(e,t){var n=[];return t.forEach((function(t){e.nodes[t]&&n.push(e.nodes[t])})),n}},{key:"setState",value:function(e,t,n){var i=ye.getNode(e,t),o={};return Object.entries(n).forEach((function(e){var t=u(e,2),n=t[0],a=t[1];"boolean"==typeof a&&i.boolState[n]!==a?(i.boolState[n]=a,o[n]=a):"number"==typeof a&&i.numState[n]!==a&&(i.numState[n]=a,o[n]=a)})),o}},{key:"synchronize",value:function(e,t,n){var i=this,o=this.calculateGraphStateMap(e,t,n);return Object.entries(o).forEach((function(t){var n=u(t,2),o=n[0],a=n[1];i.setState(e,o,a)}),this),o}},{key:"calculateGraphStateMap",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:!n,o=[],a={},r=[],c={},s=Object.keys(t),l=0;for(n?Object.entries(n).forEach((function(t){var i=u(t,2),o=i[0];i[1],a[o]=xe.createVoter(s,n[o]),c[o]=Object.assign({},a[o]),l=Math.max(l,ye.getNode(e,o).depth)}),this):this.getLeaves(e).forEach((function(t){a[t]=xe.createVoter(s,ye.getNode(e,t).boolState),c[t]=Object.assign({},a[t]),l=Math.max(l,ye.getNode(e,t).depth)}),this),l-=1,o=xe.getEligibleElections(e,Object.keys(a),l);l>=0;)r=this.getElectionResults(e,a,o,t),this.updateGraphStateRecord(e,c,r,s,i),l-=1,o=xe.getEligibleElections(e,Object.keys(a),l);return c}},{key:"filterGraphAccessors",value:function(e,t){var n=this,i=this.getNodes(e,t).sort((function(e,t){return e.depth-t.depth})),o=new Map;return i.filter((function(t){return!o.has(t.id)&&(n.getDescendants(e,t.id,!0).forEach((function(e){return o.set(e,!0)})),!0)})).map((function(e){return e.id}))}},{key:"resetDepth",value:function(e){ye.depthFirst(e,(function(t){var n=0;e.predecessors[t]&&(n=ye.getNode(e,e.predecessors[t]).depth+1),ye.getNode(e,t).depth=n}))}},{key:"deleteNode",value:function(e,t){var n=this,i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(this.nodeExists(e,t)){delete e.nodes[t];var o=e.predecessors[t];o&&(delete e.predecessors[t],e.successors[o]&&(e.successors[o]=e.successors[o].filter((function(e){return e!==t}))));var a=e.successors[t];a&&(delete e.successors[t],i&&a.forEach((function(t){n.deleteNode(e,t)}),this)),e.roots[t]&&delete e.roots[t]}}},{key:"sanitizeNodeID",value:function(e){var t=new RegExp(/\|/,"gi");return e.replace(t,"_")}},{key:"resetAsLeaf",value:function(e,t){var n=[];return e.nodes[t]&&!ye.isLeaf(e,t)&&(n=this.getDescendants(e,t),delete e.successors[t],n.forEach((function(t){delete e.nodes[t],delete e.successors[t],delete e.predecessors[t]}))),n}},{key:"createGraphStateMapFromPropertyMaps",value:function(e){var t={};for(var n in e)for(var i in e[n])t[i]=Object.assign(Object.assign({},t[i]||{}),p({},n,e[n][i]));return t}},{key:"extractPropertymapFromGraphState",value:function(e,t){var n={};for(var i in e)e[i].hasOwnProperty(t)&&(n[i]=e[i][t]);return n}}]),e}()).\u0275fac=function(e){return new(e||Ct)},Ct.\u0275prov=_.Lb({token:Ct,factory:Ct.\u0275fac,providedIn:"root"}),Ct),_t=function e(){m(this,e)};function jt(e,t,n){var i={},o={};return ye.depthFirst(e,(function(a){o[a]=ye.isRoot(e,a)?Object.assign(Object.assign({},ye.getState(e,a,n)),t[a]||{}):Object.assign(Object.assign({},o[e.predecessors[a]]),t[a]||{}),ye.isLeaf(e,a)&&(i[a]=o[a])})),i}var Pt,Mt,It,zt,Tt,Ut,Lt=function(e){return e.Started="started",e.Loaded="loaded",e.Tick="tick",e.HumanReady="human.ready",e.HumanStarted="started",e.Error="error",e.HumanError="human.error",e.LogDebug="_log.debug",e.LogError="_log.error",e.LogInfo="_log.info",e.LogWarn="_log.warn",e.SceneLoaded="scene.loaded",e.HumanProgress="human.progress",e.AnnotationsCreated="annotations.created",e.AnnotationsDestroyed="annotations.destroyed",e.AnnotationsHidden="annotations.hidden",e.AnnotationsShown="annotations.shown",e.AssetsLoadFinish="assets.load.finish",e.AssetsLoadProgress="assets.load.progress",e.AssetsLoadStart="assets.load.start",e.CameraRested="camera.rested",e.CameraUpdated="camera.updated",e.HotspotsDisplayUpdated="hotspots.displayUpdated",e.HotspotsEntered="hotspots.entered",e.HotspotsLeft="hotspots.left",e.HotspotsPicked="hotspots.picked",e.HotspotsPositionUpdated="hotspots.positionUpdated",e.LabelsCreated="labels.created",e.LabelsUpdated="labels.updated",e.LabelsMoved="labels.moved",e.LabelsDestroyed="labels.destroyed",e.LabelsChapterInfo="labels.chapterInfo",e.LabelsShown="labels.shown",e.LabelsHidden="labels.hidden",e.LabelsEnabled="labels.enabled",e.LabelsDisabled="labels.disabled",e.LabelsEntered="labels.entered",e.LabelsLeft="labels.left",e.LabelsPicked="labels.picked",e.ModuleInteractive="module.interactive",e.ModulesActivateFinish="modules.activate.finish",e.ModulesCreateFinish="modules.create.finish",e.ModulesDestroyFinish="modules.destroy.finish",e.PickPicked="pick.picked",e.QuizEntered="quiz.entered",e.QuizExited="quiz.exited",e.QuizQuestionLoaded="quiz.questionLoaded",e.QuizAnswerSelected="quiz.answerSelected",e.QuizAnswerSubmitted="quiz.answerSubmitted",e.QuizCompleted="quiz.completed",e.SceneMarkersUpdated="scene.markers.updated",e.SceneObjectRenderable="scene.objectRenderable",e.SceneObjectsSelected="scene.objectsSelected",e.SceneObjectsShown="scene.objectsShown",e.ScenePicked="scene.picked",e.SceneRestored="scene.restored",e.SceneXrayEnabled="scene.xrayEnabled",e.SceneXrayDisabled="scene.xrayDisabled",e.SceneReady="scene.ready",e.TimelineChaptersActivated="timeline.chapters.activated",e.TimelineChaptersActivateFinish="timeline.chapters.activate.finish",e.TimelineChaptersActivateStart="timeline.chapters.activate.start",e.TimelineChapterTransition="timeline.chapterTransition",e.TimelinePlaying="timeline.playing",e.TimelineScrubbed="timeline.scrubbed",e.TimelinePlayed="timeline.played",e.TimelineStopped="timeline.stopped",e.TimelinePaused="timeline.paused",e.TimelineUnpaused="timeline.unpaused",e.TimelineCompleted="timeline.completed",e.GraphAssetAttachFinish="graph.assetAttach.finish",e.TweenVisibilityUpdate="TweenVisibilityUpdate",e.NativeDeleteData="native.deleteData",e.NativeUpgrade="native.upgrade",e.NativeRestore="native.restore",e.NativeShare="native.share",e.NativeGoogleSignUp="native.googleSignUp",e.NativeDebugMessage="native.debugMessage",e}({}),Dt=function(e){return e.SSAO="sao",e.Blur="blur",e.RadialBlur="radialBlur",e.DOF="dof",e.FXAA="fxaa",e.GroundShadow="groundShadow",e}({}),Et={shown:"shown",renderable:function(e){return Human.scene.objects[e].isRenderable()},pickable:"pickable",label:function(e){return Human.scene.objects[e].displayName},expanded:function(e){return!1},layer:"layer"},Ft={shown:"trueWins",renderable:"falseWins",pickable:"trueWins"},At={trim:!0},Rt=function e(t){m(this,e),this.trim=t.trim||!1,this.terminal=t.terminal||[],this.root=t.root||{children:[],replace:!1},this.connect=t.connect||{},this.nodes=t.nodes||[]},Nt=((Pt=function(){function e(t){var n=this;m(this,e),this.graphService=t,this.objectToNodeMap={},this.nodeToObjectMap={},this.events={},this.events=Object.values(Lt).reduce((function(e,t){return e[t]=n.makeObservable(t),e}),{})}return v(e,[{key:"makeObservable",value:function(e){return new he.a((function(t){Human.events.on(e,(function(e){t.next(e)}))}))}},{key:"getCanvas",value:function(){return Human.renderer.canvas.canvas}},{key:"getEvent",value:function(e){return this.events[e]}},{key:"fireEvent",value:function(e,t){Human.events.fire(e,t)}},{key:"getSceneBoundary",value:function(){return Human.scene.getBoundary()}},{key:"getObjectBoundary",value:function(e){return Human.scene.objects[e].getBoundary()}},{key:"getObjectLoaded",value:function(e){var t=this.getObjectBoundary(e);return!Object(Oe.isNil)(t)&&Object.values(t).every((function(e){return isFinite(e)}))}},{key:"pickScene",value:function(e){return Human.renderer.pick.pick(e.x,e.y,{rayPick:e.rayPick})}},{key:"transformObject",value:function(e,t){var n=Human.scene.objects[e];n?n.setTransform(t):console.error("Scene object not found: '".concat(e,"'"))}},{key:"toggleNodes",value:function(e,t){var n=this,i={replace:!1,objects:{},fetchAssets:t};e.forEach((function(e){n.getObjects(e).forEach((function(e){i.objects[e]=t}))})),Human.scene.setEnabledObjects(i)}},{key:"setNodesVisible",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n={replace:t,objects:Object.assign({},e),fetchAssets:!0};Human.scene.setEnabledObjects(n)}},{key:"setNodesPickable",value:function(e){var t=this;Object.keys(e).forEach((function(n){(Human.scene.objects[n].isLeaf()?[n]:t.getLeafObjects(n)).forEach((function(t){Human.scene.objects[t].setPickable(e[n])}))}))}},{key:"filterObjects",value:function(e,t){for(var n=e.length;n--;)switch(!0){case e[n]instanceof Human.scene.Group:e[n].objects=this.filterObjects(e[n].objects,t),0===e[n].objects.length&&e.splice(n,1);break;case e[n]instanceof Human.scene.Object:-1===e[n].displayName.toLowerCase().indexOf(t)&&e.splice(n,1)}return e}},{key:"setObjectLayer",value:function(e,t){var n=Human.scene.objects[e];if(n.layer=t,n.renderables)for(var i=0;i<n.renderables.length;++i)n.renderables[i].setLayer(t);else n.hasOwnProperty("_layerNode")?n._layerNode.setPriority(t):n.hasOwnProperty("_propertiesNode")&&n._propertiesNode.setProperties({layer:t})}},{key:"getObjectLayerValues",value:function(e){var t={},n=Human.scene.getBoundary();return e.forEach((function(e){var i=Human.scene.objects[e],o=i.getBoundary(),a=Math.min(o.xmin-n.xmin,n.xmax-o.xmax),r=2*Math.min(o.ymin-n.ymin,n.ymax-o.ymax),c=Math.min(o.zmin-n.zmin,n.zmax-o.zmax),s=i.layer;t[s]=t[s]||[],t[s].push({nodeId:e,value:Math.min(a,r,c)})})),t}},{key:"getSceneGraph",value:function(e){var t=ye.createGraphFromSrc(e,"objectId","objects",Et);return this.graphService.synchronize(t,Ft),t}},{key:"createViewGraph",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=t?ye.pruneHiddenObjects(Human.scene.rootObjects,e):Human.scene.rootObjects,i=n.reduce((function(e,t){var n=t.objectId.includes("-root");return e[t.objectId]=!0!==n,n&&t.objects.forEach((function(t){e[t.objectId]=!0})),e}),{}),o=this.getSceneGraph(ye.pruneHiddenObjects(n,i));return this.graphService.resetDepth(o),o}},{key:"getNode",value:function(e,t){return this.graphService.nodeExists(e,t)?ye.getNode(e,t):this.objectToNodeMap[t]?ye.getNode(e,this.objectToNodeMap[t]):null}},{key:"getChapterGraphConfig",value:function(){var e=Human.timeline.activeRoot._nowBranch;return new Rt(Object.assign(Object.assign({},At),e.graph||{}))}},{key:"getRootObjects",value:function(){return Human.scene.rootObjects}},{key:"getAllSceneObjects",value:function(){return Human.scene.objects}},{key:"getObjects",value:function(e){return this.nodeToObjectMap[e]?this.nodeToObjectMap[e]:[Human.scene.objects[e].objectId]||!1}},{key:"getLeafObjects",value:function(e){if(e in this.nodeToObjectMap){var t={};return this.nodeToObjectMap[e].forEach((function(e){Human.scene.objects[e].isLeaf()?t[e]=!0:Human.scene.getLeaves(e).forEach((function(e){t[e]=!0}))})),Object.keys(t)}return e in Human.scene.objects?Human.scene.getLeaves(e):[]}},{key:"getChapter",value:function(e){return Human.timeline.branchTimelines[e]||null}},{key:"getActiveChapters",value:function(){return Human.timeline.activeRoot?Human.timeline.activeRoot._chapters:[]}},{key:"getBoundaryFromObjects",value:function(e){return e=e.filter((function(e){return Human.scene.objects[e].isLeaf()})),Human.scene.getBoundary({objectIds:e,clipped:!0})}},{key:"getLeaves",value:function(e){return Human.scene.getLeaves(e)}},{key:"getVisibleLeaves",value:function(){return Human.scene.getEnabledLeaves()}},{key:"getCameraLookAt",value:function(){return Object(Y.plainToClass)(_t,Human.renderer.camera.getLookAt())}},{key:"barycentricToWorld",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=new Float32Array([0,0,0]);return Human.scene.objects[e].barycentricToWorldSpace(i,t,n,o),isNaN(o[0])?[0,0,0]:s(Array.from(o))}},{key:"setGraphState",value:function(e){Human.scene.setObjectProperties(e)}},{key:"getAssetNamespaces",value:function(){var e={};return Object.keys(Human.assets.loadedAssets).map((function(e){return e.split("/")[0]})).forEach((function(t){e[t]=!0})),Object.keys(e)}},{key:"queryShownObjects",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i={};e.forEach((function(e){var n=jt(t,e.synchronization,["shown"]);for(var o in n)n.hasOwnProperty(o)&&(i[o]=i[o]||n[o].shown)}));var o=i;if(n){var a=this.graphService.createGraphStateMapFromPropertyMaps({shown:i}),r=this.graphService.calculateGraphStateMap(t,{shown:"trueWins"},a,!0);o=this.graphService.extractPropertymapFromGraphState(r,"shown")}return o}},{key:"loadGraphObject",value:function(e){var t=this.getObjects(e).map((function(e){return Human.scene.objects[e]}));return new he.a((function(e){Human.scene.graph.attachAssetSetsToSubtree(t,null,(function(){e.next(!0),e.complete()}))}))}},{key:"setProperties",value:function(e){Human.properties.set(e)}},{key:"setTransparencyMode",value:function(e){Human.renderer.setTransparencyMode(e)}},{key:"setPostProcessingEnabled",value:function(e){e?Human.renderer.postprocess.enable():Human.renderer.postprocess.disable()}},{key:"setPostProcessingFeatures",value:function(e){var t=e.filter((function(e){return e.effect!==Dt.GroundShadow}));Human.renderer.postprocess.parse(t);var n=e.find((function(e){return e.effect===Dt.GroundShadow}));n?(Human.renderer.groundShadow.init(),Human.renderer.groundShadow.update({blurAmount:n.blur,opacity:n.opacity,translation:[n.xPos,n.yPos,n.zPos],scale:n.size})):Human.renderer.groundShadow.destroy()}},{key:"enableAnimation",value:function(){Human.timeline.enableAnimation()}},{key:"enableRender",value:function(){Human.renderer.enableRender()}},{key:"canIRender",value:function(){return Human.renderer.canIRender()}}]),e}()).\u0275fac=function(e){return new(e||Pt)(_.Zb(St))},Pt.\u0275prov=_.Lb({token:Pt,factory:Pt.\u0275fac,providedIn:"root"}),Pt),Vt=function e(t,n,i,o,a){m(this,e),this.left=t,this.top=n,this.width=i,this.height=o,this.visibility=a},Ht=function(e){return e[e.Hidden=-1]="Hidden",e[e.Shown=1]="Shown",e}({}),Bt=function e(){m(this,e)},Qt=function(){var e=function e(t){m(this,e),this.id=t};return e.type="[Engine Camera] Clear Camera",e}(),qt=function(){var e=function e(t,n){m(this,e),this.id=t,this.camera=n};return e.type="[Engine Camera] Store Camera",e}(),Wt=function(){var e=function e(t){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=arguments.length>2?arguments[2]:void 0;m(this,e),this.camera=t,this.animate=n,this.animationDuration=i};return e.type="[Engine Camera] Set Camera",e}(),$t=function(){var e=function e(){m(this,e)};return e.type="[Engine Camera] Set Camera Success",e}(),Kt=function(){var e=function e(t){m(this,e),this.cameraMotion=t};return e.type="[Engine Camera] Move Camera",e}(),Gt=function(){var e=function e(){m(this,e)};return e.type="[Engine Camera] Reset Camera",e}(),Zt=function(){var e=function e(t){m(this,e),this.value=t};return e.type="[Engine Camera] Zoom Camera",e}(),Jt=function(){var e=function e(t){m(this,e),this.value=t};return e.type="[Engine Camera] Zoom Camera Static",e}(),Xt=function(){var e=function e(t){m(this,e),this.value=t};return e.type="[Engine Camera] Pan Camera X",e}(),Yt=function(){var e=function e(t){m(this,e),this.value=t};return e.type="[Engine Camera] Pan Camera Y",e}(),en=function(){var e=function e(t,n,i){m(this,e),this.x=t,this.y=n,this.z=i};return e.type="[Engine Camera] Pan Camera Static",e}(),tn=function(){var e=function e(t){m(this,e),this.value=t};return e.type="[Engine Camera] Rotate Camera X",e}(),nn=function(){var e=function e(t){m(this,e),this.value=t};return e.type="[Engine Camera] Rotate Camera Y",e}(),on=function(){var e=function e(t,n){m(this,e),this.x=t,this.y=n};return e.type="[Engine Camera] Rotate Camera Static",e}(),an=function(){var e=function e(t){m(this,e),this.mode=t};return e.type="[Engine Camera] Set Camera Mode",e}(),rn=function(){var e=function e(t){m(this,e),this.zoomed=t};return e.type="[Engine Camera] Set Zoomed",e}(),cn=function(){var e=function e(t){m(this,e),this.lock=t};return e.type="[Engine Camera] Lock camera",e}(),sn=function(){var e=function e(t){m(this,e),this.camera=t};return e.type="[Engine Camera] Set Camera Fly To",e}(),ln=function(){var e=function e(t){m(this,e),this.patches=t};return e.type="[Engine Camera] Patch Camera State",e}(),pn=function(){function e(){m(this,e)}return v(e,null,[{key:"toArray",value:function(e){return[e.x,e.y,e.z]}},{key:"fromArray",value:function(e){return{x:e[0],y:e[1],z:e[2]}}}]),e}(),un=((It=function(){function e(){m(this,e)}return v(e,[{key:"roundModel",value:function(e,t){var n=this,i=Object.assign({},e);return Object.keys(e).filter((function(t){return"number"==typeof e[t]})).forEach((function(o){i[o]=n.roundNumber(e[o],t)})),i}},{key:"roundNumber",value:function(e,t){return Math.round(e*Math.pow(10,t))/Math.pow(10,t)}}]),e}()).\u0275fac=function(e){return new(e||It)},It.\u0275prov=_.Lb({token:It,factory:It.\u0275fac,providedIn:"root"}),It),dn=((Mt=function(){function e(t){m(this,e),this.numberService=t,this.rotation={vx:0,vy:0},this.pan={x:0,y:0,z:0},this.zoom=0}return v(e,[{key:"getEye",value:function(){return Human.renderer.camera.eye}},{key:"setEye",value:function(e){Human.renderer.camera.setLookAt({eye:e})}},{key:"getCamera",value:function(){return Human.renderer.camera.getLookAt()}},{key:"getLookDirection",value:function(){var e=vec3.create();return Human.renderer.camera.getLookDir(e),e}},{key:"setCamera",value:function(e){return Human.renderer.camera.setLookAt(e)}},{key:"getCameraZoom",value:function(){return Human.renderer.camera.getZoom()}},{key:"captureCamera",value:function(){return{lookAt:Human.renderer.camera.getLookAt(),zoom:Human.renderer.camera.getZoom()}}},{key:"resetCamera",value:function(){return new he.a((function(e){Human.init.resetCamera((function(){e.next(),e.complete()}))}))}},{key:"getDirection",value:function(e){var t=this.getEye(),n=vec3.create();return n[0]=t.x-e.worldPos[0],n[1]=t.y-e.worldPos[1],n[2]=t.z-e.worldPos[2],vec3.normalize(n,n),n}},{key:"rotateCameraStatic",value:function(e,t){Human.renderer.camera.rotateX(e),Human.renderer.camera.rotateY(t)}},{key:"panCameraStatic",value:function(e,t,n){Human.renderer.camera.pan({x:e,y:t,z:n})}},{key:"setHumanZoom",value:function(e){Human.renderer.camera.zoom(e)}},{key:"setHumanZoomFactor",value:function(e){Human.renderer.camera.setZoom(e)}},{key:"setCameraRotation",value:function(e,t){this.rotation.vx=t,this.rotation.vy=-e}},{key:"setCameraPan",value:function(e,t){this.pan.x=e,this.pan.y=t}},{key:"setCameraZoom",value:function(e){this.zoom=.03*e}},{key:"setCameraZoomWithVelocity",value:function(e){var t=this;this.setCameraZoom(e),requestAnimationFrame((function(){e*=.85,Math.abs(e)>1&&t.setCameraZoomWithVelocity(e)}))}},{key:"tickCameraRotation",value:function(){return this.rotation.vx=this.checkEpsilon(this.rotation.vx),this.rotation.vy=this.checkEpsilon(this.rotation.vy),this.rotation}},{key:"tickCameraPan",value:function(){return this.pan.x=this.checkEpsilon(this.pan.x),this.pan.y=this.checkEpsilon(this.pan.y),this.pan.z=this.checkEpsilon(this.pan.z),this.pan}},{key:"tickCameraZoom",value:function(){return this.zoom=this.checkEpsilon(this.zoom),this.zoom}},{key:"areCamerasEqual",value:function(e,t){return this.compareXYZ(e.eye,t.eye)&&this.compareXYZ(e.look,t.look)&&this.compareXYZ(e.up,t.up)}},{key:"compareXYZ",value:function(e,t){return e.x===t.x&&e.y===t.y&&e.z===t.z}},{key:"roundCamera",value:function(e,t){var n=e.eye,i=e.look,o=e.up;return{eye:this.numberService.roundModel(n,t),look:this.numberService.roundModel(i,t),up:this.numberService.roundModel(o,t)}}},{key:"cameraAfterFlyTo",value:function(e){var t=this.getCamera(),n=pn.toArray(t.look),i=pn.toArray(t.eye),o=vec3.create();vec3.subtract(o,i,n);var a=vec3.create();vec3.normalize(a,o);var r=Math.abs(vec3.length(a)),c=Human.math.getBoundaryDiag(e),s=Math.abs(c/1.8/Math.tan(27.5))/r*2.5,l=Human.math.getBoundaryCenter(e);vec3.scale(o,a,s);var p=vec3.add(vec3.create(),l,o);return{eye:pn.fromArray(p),look:pn.fromArray(l),up:{x:0,y:1,z:0}}}},{key:"checkEpsilon",value:function(e){return Math.abs(e)<.001?0:e}}]),e}()).\u0275fac=function(e){return new(e||Mt)(_.Zb(un))},Mt.\u0275prov=_.Lb({token:Mt,factory:Mt.\u0275fac,providedIn:"root"}),Mt),gn=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,r=arguments.length>5&&void 0!==arguments[5]&&arguments[5];m(this,e),this.zoom=t,this.panX=n,this.panY=i,this.rotateX=o,this.rotateY=a,this.applyFriction=r},hn=h("vkgz"),fn=function e(){m(this,e)},bn=function(e){return e.JPEG="image/jpeg",e.PNG="image/png",e}({}),vn=function(){var e=function e(t){m(this,e),this.patches=t};return e.type="[Story Chapter] Apply Patch",e}(),mn=function(){var e=function e(){m(this,e)};return e.type="[Story Chapter] Next Chapter",e}(),yn=function(){var e=function e(){m(this,e)};return e.type="[Story Chapter] Previous Chapter",e}(),xn=function(){var e=function e(){m(this,e)};return e.type="[Story Chapter] First Chapter",e}(),wn=function(){var e=function e(){m(this,e)};return e.type="[Story Chapter] Last Chapter",e}(),kn=function(){var e=function e(t){m(this,e),this.chapter=t};return e.type="[Story Chapter] Select Chapter",e}(),On=function(){var e=function e(t){m(this,e),this.chapterId=t};return e.type="[Story Chapter] Select Chapter by chapter id",e}(),Cn=function(){var e=function e(t){m(this,e),this.chapters=t};return e.type="[Story Chapter] Set Chapters",e}(),Sn=function(){var e=function e(t,n){m(this,e),this.chapterId=t,this.cameraAction=n};return e.type="[Story Chapter] Set Chapter Camera Action",e}(),_n=function(){var e=function e(t,n){m(this,e),this.chapterId=t,this.ui=n};return e.type="[Story Chapter] Set Chapter UI",e}(),jn=function(){var e=function e(t,n){m(this,e),this.chapterId=t,this.info=n};return e.type="[Story Chapter] Set Chapter Info",e}(),Pn=function(){var e=function e(t,n){m(this,e),this.chapterId=t,this.legend=n};return e.type="[Story Chapter] Set Chapter Legend",e}(),Mn=function(){var e=function e(t,n){m(this,e),this.chapterId=t,this.legend=n};return e.type="[Story Chapter] Add To Chapter Legend",e}(),In=function(){var e=function e(t,n){m(this,e),this.previousIndex=t,this.currentIndex=n};return e.type="[Story Chapter] Reorder Chapters",e}(),zn=function(){var e=function e(t,n){m(this,e),this.chapterId=t,this.readyState=n};return e.type="[Story Chapter] Set Readystate",e}(),Tn=function(){var e=function e(t,n,i){m(this,e),this.chapterId=t,this.effects=n,this.properties=i};return e.type="[Story Chapter] Set Chapter PostProcessing",e}(),Un=function(){var e=function e(t,n,i){m(this,e),this.chapterId=t,this.transition=n,this.key=i};return e.type="[Story Chapter] Set Chapter Transitions",e}(),Ln=function(){var e=function e(t,n){m(this,e),this.chapterId=t,this.transparencyMode=n};return e.type="[Story Chapter] Set Chapter Transparency Mode",e}(),Dn=function(){var e=function e(t,n,i,o){m(this,e),this.chapterId=t,this.clips=n,this.enabled=i,this.record=o};return e.type="[Story Chapter] Set Chapter Clipping Planes",e}(),En=function(){var e=function e(t,n){m(this,e),this.chapterId=t,this.background=n};return e.type="[Story Chapter] Set Chapter Background",e}(),Fn=function(){var e=function e(t){m(this,e),this.background=t};return e.type="[Story Chapter] Set All Chapters Background",e}(),An=function(){var e=function e(){m(this,e)};return e.type="[Story Chapter] Reset Selected Chapter Background",e}(),Rn=function(){var e=function e(t){m(this,e),this.background=t};return e.type="[Story Chapter] Set Selected Chapter Background",e}(),Nn=function(){var e=function e(t,n){m(this,e),this.chapter=t,this.chapterId=n};return e.type="[Story Chapter] Duplicate An Existing Chapter",e}(),Vn=function(){var e=function e(t){m(this,e),this.chapter=t};return e.type="[Story Chapter] Remove Chapter",e}(),Hn=function(){var e=function e(){m(this,e)};return e.type="[Story Chapter] Reset",e}(),Bn=function(){var e=function e(t){m(this,e),this.thumbnails=t};return e.type="[Story Chapters] Register thumbnail URLs from story",e}(),Qn=function(){var e=function e(t,n){m(this,e),this.sourceChapter=t,this.targetChapter=n};return e.type="[Story Chapters] Copy Thumbnail From Chapter",e}(),qn=((zt=function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:bn.JPEG,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.92,o=arguments.length>3?arguments[3]:void 0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"original",r=arguments.length>5?arguments[5]:void 0,c=arguments.length>6?arguments[6]:void 0,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:[];m(this,e),this.chapterId=t,this.imageType=n,this.imageQuality=i,this.dimensions=o,this.crop=a,this.includeLabels=r,this.includeCopyright=c,this.layers=s}).type="[Story Chapters] Take picture",zt),Wn=function(){var e=function e(t,n,i){m(this,e),this.chapterId=t,this.blob=n,this.dimensions=i};return e.type="[Story Chapters] Take picture success",e}(),$n=function(){var e=function e(t,n){m(this,e),this.chapterId=t,this.camera=n};return e.type="[Story Chapters] Record Camera",e}(),Kn=function(){var e=function e(t,n,i,o){m(this,e),this.chapterId=t,this.index=n,this.position=i,this.record=o};return e.type="[Story Chapters] Set the current visibility layers index and position",e}(),Gn=function(){var e=function e(t,n){m(this,e),this.chapterId=t,this.media=n};return e.type="[Story Chapters] Set the media object",e}(),Zn=function(){var e=function e(t,n){m(this,e),this.chapterId=t,this.contentBlocks=n};return e.type="[Story Chapters] Set the content blocks",e}(),Jn=function(e){return e.Default="default",e.Plus="plus",e.Minus="minus",e.PlusMinus="plusMinus",e.Sequential="sequential",e.None="None",e}({}),Xn=function(e){return e.Annotation="annotation",e.Classic="classic",e.StudioNext="studioNext",e.Context="context",e}({}),Yn=function(e){return e.Alphabetical="alphabetical",e.Numerical="numerical",e}({}),ei=function e(t){m(this,e),this.pinType=Jn.PlusMinus,this.sequentialType=Yn.Alphabetical,this.theme=Xn.StudioNext,this.expandTag=!0,this.showDescription=!0,this.collapseDescription=!1,this.pinGlow=!1,this.hideWire=!1,this.hideTag=!1,this.title=t},ti=function e(){m(this,e)},ni=function e(){m(this,e)},ii=function(e,t){var n=s(e);return t.forEach((function(e){n.push(void 0!==e?Number(e):1)})),n},oi=function(e){var t=/rgba?\((\d{1,3})\,\s*(\d{1,3})\,\s*(\d{1,3})\,?\s*(\d+\.\d{0,5})?\)/g,n=[],i=t.exec(e),o=t.exec(e);return n=ii(n,i.slice(1,5)),n=ii(n,o.slice(1,5))},ai=function(){function e(t,n,i){m(this,e),this.colors=t,this.gradientType=n,this.colorStops=i}return v(e,null,[{key:"equals",value:function(e,t){return e.gradientType===t.gradientType&&e.colors.length===t.colors.length&&e.colors.every((function(e,n){return e===t.colors[n]}))&&e.colorStops.length===t.colorStops.length&&e.colorStops.every((function(e,n){return e===t.colorStops[n]}))}},{key:"deserialize",value:function(t){if(!Object.keys(t).length)return null;var n=[];"string"==typeof t.colors?n=oi(t.colors):Array.isArray(t.colors)&&8===t.colors.length&&(n=t.colors.map((function(e,t){return(t+1)%4&&e<=1?Math.round(255*e):e})));var i=/radial|linear/.test(t.gradientType)?t.gradientType:"radial",o=t.colorStops;return new e(n,i,Array.isArray(o)&&2===o.length?[o[0],o[1]]:[0,100])}},{key:"toCSS",value:function(e){var t=e.colors,n="rgba(".concat(t[0],",").concat(t[1],", ").concat(t[2],", ").concat(t[3],") ").concat(e.colorStops[0],"%"),i="rgba(".concat(t[4],",").concat(t[5],", ").concat(t[6],", ").concat(t[7],") ").concat(e.colorStops[1],"%");return"radial"===e.gradientType?"radial-gradient(circle, ".concat(n,", ").concat(i,")"):"linear-gradient(180deg, ".concat(n,", ").concat(i,")")}},{key:"fromCSS",value:function(t){var n=/radial-gradient/.test(t)?"radial":"linear",i=oi(t),o=/([0-9]+)\%/g,a=[0,100];return a[0]=Number(o.exec(t)[1]),a[1]=Number(o.exec(t)[1]),new e(i,n,a)}},{key:"isTransparent",value:function(e){if(!e||!e.colors)return!1;var t=e.colors,n=t[3];return t.length<=4?0===n:0===n&&0===t[7]}}]),e}(),ri=function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r},ci=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},si=function e(){m(this,e),this[Tt]=!0};Tt=immer.immerable,ri([Object(Y.Type)((function(){return ei})),Object(Y.Type)((function(){return ti})),Object(Y.Type)((function(){return _t})),Object(Y.Type)((function(){return ni})),Object(Y.Expose)(),ci("design:type",String)],si.prototype,"id",void 0),ri([Object(Y.Expose)(),ci("design:type",Object)],si.prototype,"info",void 0),ri([Object(Y.Expose)(),ci("design:type",Array)],si.prototype,"labels",void 0),ri([Object(Y.Expose)(),ci("design:type",Object)],si.prototype,"colorRecipeObjects",void 0),ri([Object(Y.Expose)(),ci("design:type",Array)],si.prototype,"hotspots",void 0),ri([Object(Y.Expose)(),ci("design:type",ti)],si.prototype,"synchronization",void 0),ri([Object(Y.Expose)(),ci("design:type",ai)],si.prototype,"background",void 0),ri([Object(Y.Expose)(),ci("design:type",Object)],si.prototype,"lights",void 0),ri([Object(Y.Expose)(),ci("design:type",Array)],si.prototype,"timelineMap",void 0),ri([Object(Y.Expose)(),ci("design:type",Object)],si.prototype,"camera",void 0),ri([Object(Y.Expose)(),ci("design:type",Object)],si.prototype,"transitions",void 0),ri([Object(Y.Expose)(),ci("design:type",Object)],si.prototype,"properties",void 0),ri([Object(Y.Expose)(),ci("design:type",Boolean)],si.prototype,"loop",void 0),ri([Object(Y.Expose)(),ci("design:type",Object)],si.prototype,"customData",void 0),ri([Object(Y.Expose)(),ci("design:type",Object)],si.prototype,"clippingPlanes",void 0),ri([Object(Y.Expose)(),ci("design:type",function(){return function e(){m(this,e)}}())],si.prototype,"ui",void 0),ri([Object(Y.Expose)(),ci("design:type",ni)],si.prototype,"graph",void 0),ri([Object(Y.Expose)(),ci("design:type",Object)],si.prototype,"viewModes",void 0),ri([Object(Y.Expose)(),ci("design:type",Object)],si.prototype,"recipes",void 0),ri([Object(Y.Expose)(),ci("design:type",String)],si.prototype,"transparencyMode",void 0),ri([Object(Y.Expose)(),ci("design:type",Object)],si.prototype,"fallbackTransparency",void 0),ri([Object(Y.Expose)(),ci("design:type",Object)],si.prototype,"effects",void 0),ri([Object(Y.Expose)(),ci("design:type",Object)],si.prototype,"environment",void 0),ri([Object(Y.Expose)(),ci("design:type",Object)],si.prototype,"pickThroughObjects",void 0),ri([Object(Y.Expose)(),ci("design:type",Object)],si.prototype,"showObjects",void 0),ri([Object(Y.Expose)(),ci("design:type",Object)],si.prototype,"options",void 0),ri([Object(Y.Expose)(),ci("design:type",Object)],si.prototype,"media",void 0),ri([Object(Y.Expose)(),ci("design:type",Array)],si.prototype,"legend",void 0),ri([Object(Y.Expose)(),ci("design:type",function(){return function e(){m(this,e)}}())],si.prototype,"visibilityLayers",void 0),ri([Object(Y.Expose)(),ci("design:type",Array)],si.prototype,"contentBlocks",void 0),ri([Object(Y.Expose)(),ci("design:type",Array)],si.prototype,"quizQuestions",void 0),si=ri([Object(Y.Exclude)()],si),function(e){function t(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))}e.getUuid=t,e.idWithPrefix=function(e){return e?"".concat(e,"-").concat(t()):t()}}(Ut||(Ut={}));var li,pi,ui,di=function e(){m(this,e)},gi=function(e){return e.classicAnnotation="classic-annotation",e.classicHotspot="classic-hotspot",e.studioNext="studio-light",e}({}),hi=function e(){m(this,e),this.title=null,this.description=null,this.errands=[]},fi=function(e){return e.flyToChapter="flyToChapter",e.flyToObject="flyToObject",e.flyToCamera="flyToCamera",e}({}),bi=function e(t){m(this,e),this.type=fi.flyToObject,this.value=t},vi=function e(t){m(this,e),this.type=fi.flyToCamera,this.value=t},mi=function(e){return e.Circle="circle",e.CirclePlus="circle-plus",e.CircleMinus="circle-minus",e.Label="label",e.CircleLabel="circle-label",e}({}),yi=function e(){m(this,e),this.type=fi.flyToChapter,this.value=null},xi={flyToCamera:"flyTo",flyToChapter:"flyTo"},wi=((li=function(){function e(t){var n=this;m(this,e),this.engineService=t,this.convertActionToErrand=function(e,t,n){var i=new RegExp("^flyTo(Async)?"),o=new RegExp("^flyToObject(Async)?"),a=new RegExp("^flyTo[w.:]+currentChapter.[flyTo|jumpTo]"),r=n.split(":").slice(0,2),c=e,s=r[1];/currentChapter/.test(s)&&(s=s.replace("currentChapter","chapters[".concat(t,"]")));var l=null;return o.test(r[0])?l=new bi(Object(Oe.get)(c,s)):i.test(r[0])?l=new vi(Object(Oe.get)(c,s)):a.test(r[0])&&(l=new yi),l},this.convertErrandToAction=function(e,t){var i=Ut.idWithPrefix("errand").replace(/\-/g,"_"),o={},a="",r=function(e){return xi[e]||e}(t.type);return t.type===fi.flyToChapter?a="".concat(r,"Async:currentChapter.").concat(n.engineService.getChapter(e.chapterId).camera.action):(a="".concat(r,"Async:currentChapter.customData.").concat(i),o[i]=t.value),{action:a,data:o}}}return v(e,[{key:"filterHotspot",value:function(e,t,n){var i=new RegExp("^(flyTo|flyToObject|hideHotspot|showHotspot|resetHotspots)"),o=this.getHotspotAction(e,n),a=o.filter((function(e){return i.test(e)}));return o.length===a.length}},{key:"deserializeAnnotation",value:function(e,t,n){var i=new ei(e.title||"");return i.id=e.annotationId||Ut.idWithPrefix("label"),i.chapterId=t.id,i.expandTag=!0,i.showDescription=!0,i.collapseDescription=!1,i.pinGlow=!1,i.hideWire=!1,i.hideTag=!1,n===Xn.Annotation?(i.theme=Xn.Annotation,i.pinType=Jn.Default,i.flyTo=!1,i.states=[]):(i.theme=Xn.StudioNext,i.pinType=Jn.PlusMinus,i.flyTo=!0,i.states=[new hi,new hi],i.states[0].errands=[new yi],i.states[1].errands=[new bi(e.objectId)]),i.occludable=!1!==e.occludable,i.renderableIndex=e.renderableIndex||0,e.objectId&&e.hasOwnProperty("barycentric")?(i.objectId=e.objectId,i.primitiveIndex=e.primitiveIndex,i.barycentric=e.barycentric):e.hasOwnProperty("pos")&&(e.hasOwnProperty("objectId")&&(i.objectId=e.objectId),i.pos=e.pos),e.dir&&Array.isArray(e.dir)?i.dir=e.dir:e.dir&&e.dir instanceof Object&&(i.dir=Object.values(e.dir)),i.description=e.description||"",i.offset=e.labelOffset||[40,40],i.shown=!1!==e.shown,i.labelShown=!1!==e.labelShown,i}},{key:"deserializeHotspots",value:function(e,t,n){for(var i=this,o=arguments.length,a=new Array(o>3?o-3:0),r=3;r<o;r++)a[r-3]=arguments[r];var c=a[0],s=a[1],l=new ei(c.title||"");switch(l.id=Ut.idWithPrefix("hotspot"),l.objectId=c.objectId,l.chapterId=t.id,l.description=c.description||"",l.pinType=/plus|minus/.test(c.className)?Jn.PlusMinus:/sequential/.test(c.className)?Jn.Sequential:/none/.test(c.className)?Jn.None:Jn.Default,/alphabetical/.test(c.className)?l.sequentialType=Yn.Alphabetical:/numerical/.test(c.className)&&(l.sequentialType=Yn.Numerical),l.pinGlow=/pulse/.test(c.className),l.occludable=!0,l.shown=c.shown,l.offset=c.labelOffset?c.labelOffset:[22,-17],(/left/.test(c.className)&&l.offset[0]>0||/right/.test(c.className)&&l.offset[0]<0)&&(l.offset[0]*=-1),c.hasOwnProperty("barycentric")?(l.renderableIndex=c.renderableIndex||0,l.barycentric=c.barycentric,l.primitiveIndex=c.primitiveIndex):l.pos=c.pos,l.dir=c.dir,c.theme=c.theme?c.theme:gi.classicHotspot,c.theme){case gi.classicAnnotation:l.theme=Xn.Annotation,l.showDescription=!0,l.collapseDescription=/collapsible/g.test(c.className),l.expandTag=!0,l.hideTag=!1,l.hideWire=!/leader-line/.test(c.className);break;case gi.classicHotspot:l.theme=Xn.Classic,l.showDescription=/label/.test(c.className),l.expandTag=/label/.test(c.className),l.hideTag=!l.expandTag,l.collapseDescription=!1,l.hideWire=!/leader-line/.test(c.className);break;case gi.studioNext:l.theme=Xn.StudioNext,l.showDescription=this.hasContent(c),l.collapseDescription=/collapsible/g.test(c.className),l.hideTag=!c.title,l.hideWire=!/leader-line/.test(c.className)}l.flyTo=!1,l.flyToTarget=null,l.states=[];var p=this.filterHotspotActions(this.getHotspotAction(e,c)),u=s?this.filterHotspotActions(this.getHotspotAction(e,s)):[],d=new hi,g=new hi;p.length&&(d.errands=p.map((function(t){return i.convertActionToErrand(e,n,t)}))),u.length&&(g.errands=u.map((function(t){return i.convertActionToErrand(e,n,t)}))),l.states=[g,d],d.errands.length>0&&(l.flyTo=!0,l.flyToTarget=d.errands[0].type,d.errands[0].type===fi.flyToCamera&&(l.cameraPosition=d.errands[0].value));var h=c.contentBlocks;return h&&(l.contentBlocks=JSON.parse(JSON.stringify(h))),l}},{key:"makeDefaultStudioLabel",value:function(e){var t=e?Object.assign({},e):new ei("");return t.pinType=Jn.PlusMinus,t.theme=Xn.StudioNext,t.expandTag=!0,t.showDescription=!0,t.collapseDescription=!1,t.pinGlow=!1,t.hideWire=!1,t.hideTag=!1,t.occludable=!0,t.flyTo=!0,t.description="",t.shown=!0,t.states=[new hi,new hi],t}},{key:"makeAnnotationLabel",value:function(e){var t=e?Object.assign({},e):new ei("");return t.pinType=Jn.Default,t.theme=Xn.Annotation,t.expandTag=!0,t.showDescription=!0,t.collapseDescription=!1,t.pinGlow=!1,t.hideWire=!1,t.hideTag=!1,t.states=[],t}},{key:"serializeLabel",value:function(e,t){var n=this,i=new di,o=Object(Y.classToClass)(e),a=["circle","draggable"];i.shown=!0,e.objectId&&(i.objectId=o.objectId);try{e.primitiveIndex&&e.barycentric&&e.objectId?(i.renderableIndex=e.renderableIndex||0,i.primitiveIndex=e.primitiveIndex,i.barycentric=e.barycentric,i.pos=this.engineService.barycentricToWorld(e.objectId,e.primitiveIndex,e.barycentric)):i.pos=o.pos}catch(p){return{data:{},hotspots:[]}}switch(e.dir&&(i.dir=Array.prototype.slice.call(e.dir)),i.labelOffset=e.offset,e.theme){case Xn.Annotation:i.theme=gi.classicAnnotation;break;case Xn.Classic:i.theme=gi.classicHotspot;break;default:i.theme=gi.studioNext}""!==o.title?(i.title=o.title,i.description=o.description,i.type=mi.CircleLabel):i.type=mi.Circle,e.pinGlow&&a.push("pulse"),e.pinType===Jn.PlusMinus&&a.push("plus"),e.pinType===Jn.Sequential&&(a.push("sequential"),a.push(e.sequentialType===Yn.Alphabetical?"alphabetical":"numerical")),e.pinType===Jn.None&&a.push("none"),e.hideWire||a.push("leader-line"),e.hideTag||a.push("label"),e.collapseDescription&&a.push("collapsible collapsed"),i.className=a.join(" ");var r={};i.actions=[];var c=[i],s=e.states.length;e.states.forEach((function(t,o){if(o===s-1)c[0].actions.push("resetHotspots"),t.errands.forEach((function(t){var i=n.convertErrandToAction(e,t);c[0].actions.push(i.action),r=Object.assign(Object.assign({},r),i.data)}));else{var a=Object(Y.classToClass)(i);a.actions=[],a.className=a.className.replace("plus","minus"),t.errands.forEach((function(t){var i=n.convertErrandToAction(e,t);a.actions.push(i.action),r=Object.assign(Object.assign({},r),i.data)})),c.push(a)}})),2===c.length&&(c[0].actions.push("hideHotspots:currentChapter.hotspots[".concat(t,"]")),c[0].actions.push("showHotspots:currentChapter.hotspots[".concat(t+1,"]")),c[1].actions.push("hideHotspots:currentChapter.hotspots[".concat(t+1,"]")),c[1].actions.push("showHotspots:currentChapter.hotspots[".concat(t,"]")),c[0].shown=!0,c[1].shown=!1),2===c.length&&e.collapseDescription&&(c[1].className+=c[1].className.replace("collapsed","")),c.forEach((function(e){i.labelOffset[0]<0?e.className=e.className.replace("right","")+" left":i.labelOffset[0]>0&&(e.className=e.className.replace("left","")+" right")}));var l=e.contentBlocks;return l&&(i.contentBlocks=JSON.parse(JSON.stringify(l))),{data:r,hotspots:c}}},{key:"setLabelContainer",value:function(e){this._labelContainer=e}},{key:"getLabelContainer",value:function(){return this._labelContainer}},{key:"hasContent",value:function(e){var t=e.description,n=e.contentBlocks;return!!t||!Object(Oe.isNil)(n)&&n.length>0}},{key:"getHotspotAction",value:function(e,t){var n=t.actionSrc?Object(Oe.get)(e,t.actionSrc):t.actions?t.actions:[];return Array.isArray(n)?n:[]}},{key:"filterHotspotActions",value:function(e){var t=new RegExp("^(flyTo|flyToObject)");return e.filter((function(e){return t.test(e)}))}}]),e}()).\u0275fac=function(e){return new(e||li)(_.Zb(Nt))},li.\u0275prov=_.Lb({token:li,factory:li.\u0275fac,providedIn:"root"}),li),ki=function e(){m(this,e)};function Oi(e,t,n,i){(function e(t,n){var i=n.objects;return 0===i.length?[]:Object(Oe.flattenDeep)(i.map((function(n){return[n.objectId].concat(s(e(t,t.scene.objects[n.objectId])))})))})(Human,Human.scene.objects[e]).forEach((function(e){return t[e][n]=i}))}function Ci(e,t){if(void 0!==e.activeChapterId&&void 0!==e.nodeState){var n=immer.produceWithPatches(e,(function(e){var n=e.nodeState[e.activeChapterId],i=t.objectIds||Object.keys(n);t.patch?Object.entries(t.patch).forEach((function(e){var t=u(e,2),i=t[0],o=t[1];n[i].shown=o})):i.forEach((function(e){n[e].shown=t.show,n[e].shownSetByTween=t.setByTween,t.objectIds&&(Oi(e,n,"shown",t.show),!0===t.setByTween&&Oi(e,n,"shownSetByTween",t.setByTween))}))})),i=u(n,3),o=i[0],a=i[1],r=i[2];return{finalState:immer.produce(o,(function(e){var t;e.patches=a,(t=e.patchesForChapter[e.activeChapterId]).push.apply(t,s(a))})),patches:a,inversePatches:r}}}!function(e){var t=function e(){m(this,e)};t.type="[Engine Nodes] Reset",e.Reset=t;var n=function e(t){m(this,e),this.nodeState=t};n.type="[Engine Nodes] init nodes",e.InitNodeState=n;var i=function e(t){m(this,e),this.patches=t};i.type="[Engine Nodes] patch nodes",e.ApplyPatch=i;var o=function e(t){m(this,e),this.activeChapterId=t};o.type="[Engine Nodes] set active chapter",e.SetActiveChapter=o;var a=function e(t,n){m(this,e),this.originalChapterId=t,this.copyChapterId=n};a.type="[Engine Nodes] Duplicate node state",e.DuplicateNodeState=a;var r=function e(t,n,i){var o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];m(this,e),this.show=t,this.objectIds=n,this.patch=i,this.record=o,this.setByTween=a};r.type="[Engine Nodes] update nodes shown",e.UpdateNodesShown=r;var c=function e(t){m(this,e),this.objectId=t};c.type="[Engine Nodes] update nodes selected",e.UpdateNodeSelected=c;var s=function e(t,n,i){m(this,e),this.checked=t,this.objectIds=n,this.patch=i};s.type="[Engine Nodes] update nodes checked",e.UpdateNodesChecked=s;var l=function e(t,n,i){m(this,e),this.pickable=t,this.objectIds=n,this.patch=i};l.type="[Engine Nodes] update nodes pickable",e.UpdateNodesPickable=l;var p=function e(t,n,i){var o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];m(this,e),this.recipe=t,this.objectIds=n,this.patch=i,this.record=o};p.type="[Engine Nodes] update nodes paint",e.UpdateNodesPaint=p}(pi||(pi={})),function(e){var t=function e(){m(this,e)};t.type="[Undo] Reset",e.Reset=t;var n=function e(t){m(this,e),this.chapterId=t};n.type="[Undo] Undo",e.Undo=n;var i=function e(t){m(this,e),this.chapterId=t};i.type="[Undo] Undo All",e.UndoAll=i;var o=function e(t){m(this,e),this.chapterId=t};o.type="[Undo] Redo",e.Redo=o;var a=function e(t){m(this,e),this.patches=t};a.type="[Undo] Store Patches",e.SavePatches=a}(ui||(ui={}));var Si=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{center:[0,0,0],edge:[1,1,1],centerBias:1,edgeBias:0,power:1};m(this,e);var n=t.edge,i=t.center,o=t.centerBias,a=t.edgeBias,r=t.power;this.edge=n,this.center=i,this.centerBias=o,this.edgeBias=a,this.power=r}return v(e,null,[{key:"toEngine",value:function(e){var t=e.center,n=e.edge,i=e.centerBias,o=e.edgeBias,a=e.power;return[s(t),s(n),i,o,a]}}]),e}(),_i=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{center:0,edge:1,centerBias:1,edgeBias:0,power:1};m(this,e);var n=t.edge,i=t.center,o=t.centerBias,a=t.edgeBias,r=t.power;this.edge=n,this.center=i,this.centerBias=o,this.edgeBias=a,this.power=r}return v(e,null,[{key:"toEngine",value:function(e){return[e.center,e.edge,e.centerBias,e.edgeBias,e.power]}}]),e}();function ji(e,t){switch(!0){case void 0===e[t]:return;case!1===e[t]:return!1;case"number"==typeof e[t]:return 100*e[t];default:return new _i({center:e[t][0],edge:e[t][1],centerBias:e[t][2],edgeBias:e[t][3],power:e[t][4]})}}var Pi,Mi,Ii,zi,Ti,Ui=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};m(this,e);var n=t.tintColor,i=t.saturation,o=t.contrast,a=t.brightness,r=t.opacity;this.tintColor=n,this.saturation=i,this.contrast=o,this.brightness=a,this.opacity=r}return v(e,null,[{key:"fromEngine",value:function(t){return new e({tintColor:function(){switch(!0){case void 0===t.tintColor:return;case!1===t.tintColor:return!1;case Array.isArray(t.tintColor):return 3===t.tintColor.length?s(t.tintColor):new Si({center:t.tintColor[0],edge:t.tintColor[1],centerBias:t.tintColor[2],edgeBias:t.tintColor[3],power:t.tintColor[4]})}}(),saturation:ji(t,"saturation"),brightness:ji(t,"brightness"),contrast:ji(t,"contrast"),opacity:ji(t,"opacity")})}},{key:"toEngine",value:function(e){var t=!1!==e.tintColor&&void 0,n=!1!==e.saturation&&void 0,i=!1!==e.brightness&&void 0,o=!1!==e.contrast&&void 0,a=!1!==e.opacity&&void 0;return Array.isArray(e.tintColor)?t=s(e.tintColor):e.tintColor&&e.tintColor instanceof Si&&(t=Si.toEngine(e.tintColor)),"number"==typeof e.saturation?n=e.saturation/100:e.saturation instanceof _i&&(n=_i.toEngine(e.saturation)),"number"==typeof e.brightness?i=e.brightness/100:e.brightness instanceof _i&&(i=_i.toEngine(e.brightness)),"number"==typeof e.contrast?o=e.contrast/100:e.contrast instanceof _i&&(o=_i.toEngine(e.contrast)),"number"==typeof e.opacity?a=e.opacity/100:e.opacity instanceof _i&&(a=_i.toEngine(e.opacity)),{tintColor:t,saturation:n,brightness:i,contrast:o,opacity:a}}},{key:"mergeRecipes",value:function(e,t){for(var n=Object.assign({},e),i=0,o=Object.entries(t);i<o.length;i++){var a=u(o[i],2),r=a[0],c=a[1];void 0!==c&&(n[r]=c)}return n}}]),e}(),Li=function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r},Di=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Ei={activeChapterId:void 0,nodeState:void 0,patches:[],patchesForChapter:{}},Fi=((Mi=Pi=function(){function e(){m(this,e)}return v(e,[{key:"reset",value:function(e,t){e.patchState(immer.produce(e.getState(),(function(e){e.activeChapterId=void 0,e.nodeState=void 0,e.patches=[],e.patchesForChapter={}})))}},{key:"applyPatch",value:function(e,t){var n=immer.applyPatches(e.getState(),t.patches),i=immer.produce(n,(function(e){var n;(n=e.patchesForChapter[e.activeChapterId]).push.apply(n,s(t.patches)),e.patches=t.patches}));e.patchState(i)}},{key:"initNodeState",value:function(e,t){e.patchState({nodeState:t.nodeState})}},{key:"setActiveChapter",value:function(e,t){var n=e.getState(),i=immer.produce(n,(function(e){e.activeChapterId=t.activeChapterId,e.patchesForChapter[t.activeChapterId]=e.patchesForChapter[t.activeChapterId]||[],e.patches=e.patchesForChapter[t.activeChapterId]}));e.patchState(i)}},{key:"duplicateNodeState",value:function(e,t){var n=e.getState(),i=immer.produce(n,(function(e){e.nodeState[t.copyChapterId]=e.nodeState[t.originalChapterId],e.patchesForChapter[t.copyChapterId]=e.patchesForChapter[t.originalChapterId].map((function(e){return e.path[1]=t.copyChapterId,e}))}));e.patchState(i)}},{key:"updateNodesShown",value:function(e,t){var n=Ci(e.getState(),t),i=n.finalState,o=n.patches,a=n.inversePatches;e.patchState(i),t.record&&e.dispatch(new ui.SavePatches([{forward:o,inverse:a,patchAction:pi.ApplyPatch}]))}},{key:"updateNodesSelected",value:function(e,t){var n=e.getState(),i=immer.produce(n,(function(e){var n=e.nodeState[e.activeChapterId],i=Object.keys(n);switch(t.objectId){case void 0:i.forEach((function(e){return n[e].selected=!1}));break;default:i.forEach((function(e){return n[e].selected=!1})),n[t.objectId].selected=!0}}));e.patchState(i)}},{key:"updateNodesChecked",value:function(e,t){var n=e.getState(),i=immer.produceWithPatches(n,(function(e){var n=e.nodeState[e.activeChapterId];switch(t.patch){case void 0:(t.objectIds||Object.keys(n)).forEach((function(e){n[e].checked=t.checked,t.objectIds&&Oi(e,n,"checked",t.checked)}));break;default:Object.entries(t.patch).forEach((function(e){var t=u(e,2),i=t[0],o=t[1];return n[i].checked=o}))}})),o=u(i,3),a=o[0],r=o[1],c=(o[2],immer.produce(a,(function(e){e.patches=r})));e.patchState(c)}},{key:"updateNodesPickable",value:function(e,t){var n=e.getState(),i=immer.produceWithPatches(n,(function(e){var n=e.nodeState[e.activeChapterId];t.patch?Object.entries(t.patch).forEach((function(e){var t=u(e,2),i=t[0],o=t[1];return n[i].pickable=o})):(t.objectIds||Object.keys(n)).forEach((function(e){n[e].pickable=t.pickable,t.objectIds&&Oi(e,n,"pickable",t.pickable)}))})),o=u(i,3),a=o[0],r=o[1],c=o[2],l=immer.produce(a,(function(e){var t;e.patches=r,(t=e.patchesForChapter[e.activeChapterId]).push.apply(t,s(r))}));e.patchState(l),e.dispatch(new ui.SavePatches([{forward:r,inverse:c,patchAction:pi.ApplyPatch}]))}},{key:"updateNodesPaint",value:function(e,t){var n=e.getState(),i=immer.produceWithPatches(n,(function(e){var n=e.nodeState[e.activeChapterId],i=t.objectIds||Object.keys(n);t.patch?Object.entries(t.patch).forEach((function(e){var t=u(e,2),i=t[0],o=t[1],a=Ui.mergeRecipes(n[i].paint,o);n[i].paint=a})):i.forEach((function(e){var i=Ui.mergeRecipes(n[e].paint,t.recipe);n[e].paint=i,t.objectIds&&Oi(e,n,"paint",i)}))})),o=u(i,3),a=o[0],r=o[1],c=o[2],l=immer.produce(a,(function(e){var t;e.patches=r,(t=e.patchesForChapter[e.activeChapterId]).push.apply(t,s(r))}));e.patchState(l),t.record&&e.dispatch(new ui.SavePatches([{forward:r,inverse:c,patchAction:pi.ApplyPatch}]))}}],[{key:"getAllNodeState",value:function(e){return e.nodeState}},{key:"getActiveChapter",value:function(e){return e.activeChapterId}},{key:"getPatches",value:function(e){return e.patches}},{key:"getNodes",value:function(e){return void 0===e.activeChapterId||void 0===e.nodeState?{}:e.nodeState[e.activeChapterId]||{}}},{key:"getNodePaint",value:function(e){return function(t){return e.nodeState[e.activeChapterId][t].paint}}},{key:"getNodeIds",value:function(e){return Object.keys(Pi.getNodes(e))}},{key:"getCheckedNodeIds",value:function(e){return Object.values(Pi.getNodes(e)).filter((function(e){return e.checked})).map((function(e){return e.objectId}))}},{key:"getCheckedNodes",value:function(e){return Pi.getCheckedNodeIds(e).map((function(t){return e.nodeState[e.activeChapterId][t]}))}},{key:"getUncheckedNodeIds",value:function(e){return Pi.getNodeIds(e).filter((function(t){return!e.nodeState[e.activeChapterId][t].checked}))}},{key:"getSelectedNode",value:function(e){var t=Pi.getNodeIds(e).find((function(t){return e.nodeState[e.activeChapterId][t].selected}));return t?e.nodeState[e.activeChapterId][t]:void 0}}]),e}()).\u0275fac=function(e){return new(e||Mi)},Mi.\u0275prov=_.Lb({token:Mi,factory:Mi.\u0275fac}),Li([Object(L.a)(pi.Reset),Di("design:type",Function),Di("design:paramtypes",[Object,pi.Reset]),Di("design:returntype",void 0)],Mi.prototype,"reset",null),Li([Object(L.a)(pi.ApplyPatch),Di("design:type",Function),Di("design:paramtypes",[Object,pi.ApplyPatch]),Di("design:returntype",void 0)],Mi.prototype,"applyPatch",null),Li([Object(L.a)(pi.InitNodeState),Di("design:type",Function),Di("design:paramtypes",[Object,pi.InitNodeState]),Di("design:returntype",void 0)],Mi.prototype,"initNodeState",null),Li([Object(L.a)(pi.SetActiveChapter),Di("design:type",Function),Di("design:paramtypes",[Object,pi.SetActiveChapter]),Di("design:returntype",void 0)],Mi.prototype,"setActiveChapter",null),Li([Object(L.a)(pi.DuplicateNodeState),Di("design:type",Function),Di("design:paramtypes",[Object,pi.DuplicateNodeState]),Di("design:returntype",void 0)],Mi.prototype,"duplicateNodeState",null),Li([Object(L.a)(pi.UpdateNodesShown),Di("design:type",Function),Di("design:paramtypes",[Object,pi.UpdateNodesShown]),Di("design:returntype",void 0)],Mi.prototype,"updateNodesShown",null),Li([Object(L.a)(pi.UpdateNodeSelected),Di("design:type",Function),Di("design:paramtypes",[Object,pi.UpdateNodeSelected]),Di("design:returntype",void 0)],Mi.prototype,"updateNodesSelected",null),Li([Object(L.a)(pi.UpdateNodesChecked),Di("design:type",Function),Di("design:paramtypes",[Object,pi.UpdateNodesChecked]),Di("design:returntype",void 0)],Mi.prototype,"updateNodesChecked",null),Li([Object(L.a)(pi.UpdateNodesPickable),Di("design:type",Function),Di("design:paramtypes",[Object,pi.UpdateNodesPickable]),Di("design:returntype",void 0)],Mi.prototype,"updateNodesPickable",null),Li([Object(L.a)(pi.UpdateNodesPaint),Di("design:type",Function),Di("design:paramtypes",[Object,pi.UpdateNodesPaint]),Di("design:returntype",void 0)],Mi.prototype,"updateNodesPaint",null),Li([Object(L.e)(),Di("design:type",Function),Di("design:paramtypes",[ki]),Di("design:returntype",void 0)],Mi,"getAllNodeState",null),Li([Object(L.e)(),Di("design:type",Function),Di("design:paramtypes",[ki]),Di("design:returntype",void 0)],Mi,"getActiveChapter",null),Li([Object(L.e)(),Di("design:type",Function),Di("design:paramtypes",[ki]),Di("design:returntype",void 0)],Mi,"getPatches",null),Li([Object(L.e)(),Di("design:type",Function),Di("design:paramtypes",[ki]),Di("design:returntype",void 0)],Mi,"getNodes",null),Li([Object(L.e)(),Di("design:type",Function),Di("design:paramtypes",[ki]),Di("design:returntype",void 0)],Mi,"getNodePaint",null),Li([Object(L.e)(),Di("design:type",Function),Di("design:paramtypes",[ki]),Di("design:returntype",void 0)],Mi,"getNodeIds",null),Li([Object(L.e)(),Di("design:type",Function),Di("design:paramtypes",[ki]),Di("design:returntype",void 0)],Mi,"getCheckedNodeIds",null),Li([Object(L.e)(),Di("design:type",Function),Di("design:paramtypes",[ki]),Di("design:returntype",void 0)],Mi,"getCheckedNodes",null),Li([Object(L.e)(),Di("design:type",Function),Di("design:paramtypes",[ki]),Di("design:returntype",void 0)],Mi,"getUncheckedNodeIds",null),Li([Object(L.e)(),Di("design:type",Function),Di("design:paramtypes",[ki]),Di("design:returntype",void 0)],Mi,"getSelectedNode",null),Mi=Pi=Li([Object(L.f)({name:"engineNodes",defaults:Ei})],Mi)),Ai=function e(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"_color",o=arguments.length>3?arguments[3]:void 0;m(this,e),this.label=t,this.recipe=n,this.icon=i,this.group=o},Ri=function(e){return e.Colors="Colors",e.Effects="Effects",e}({}),Ni=function(e){return e.Colors="_color",e.Effects="adjust",e}({}),Vi=new Ai("Original",new Ui({tintColor:!1,saturation:!1,contrast:!1,brightness:!1,opacity:!1}),"times-circle",Ri.Colors),Hi=new Ai("Black",{tintColor:[0,0,0],saturation:!1,contrast:!1,brightness:!1,opacity:!1},Ni.Colors,Ri.Colors),Bi=new Ai("Red",{tintColor:[1,0,0],saturation:!1,contrast:!1,brightness:!1,opacity:!1},Ni.Colors,Ri.Colors),Qi=new Ai("Yellow",new Ui({tintColor:[1,1,0],saturation:!1,contrast:!1,brightness:!1,opacity:!1}),Ni.Colors,Ri.Colors),qi=new Ai("Green",new Ui({tintColor:[0,1,0],saturation:!1,contrast:!1,brightness:!1,opacity:!1}),Ni.Colors,Ri.Colors),Wi=new Ai("Cyan",new Ui({tintColor:[0,1,1],saturation:!1,contrast:!1,brightness:!1,opacity:!1}),Ni.Colors,Ri.Colors),$i=new Ai("Blue",new Ui({tintColor:[0,0,1],saturation:!1,contrast:!1,brightness:!1,opacity:!1}),Ni.Colors,Ri.Colors),Ki=new Ai("Pink",new Ui({tintColor:[1,0,1],saturation:!1,contrast:!1,brightness:!1,opacity:!1}),Ni.Colors,Ri.Colors),Gi=(new Ai("Grayscale",new Ui({tintColor:!1,saturation:-100,contrast:!1,brightness:!1,opacity:!1}),Ni.Effects,Ri.Effects),new Ai("Desaturated",new Ui({tintColor:!1,saturation:-50,contrast:!1,brightness:!1,opacity:!1}),Ni.Effects,Ri.Effects),new Ai("Fade",new Ui({tintColor:[0,0,0],contrast:!1,brightness:55,saturation:-100,opacity:new _i({edge:1,center:0,edgeBias:0,centerBias:1,power:1})}),Ni.Effects,Ri.Effects)),Zi=[Hi,Bi,Qi,qi,Wi,$i,Ki],Ji=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};m(this,e);var n=t.tintColor,i=t.saturation,o=t.contrast,a=t.brightness,r=t.opacity;this.tintColor=n,this.saturation=i,this.contrast=o,this.brightness=a,this.opacity=r}return v(e,null,[{key:"isFresnel",value:function(e){return Array.isArray(e)&&5===e.length}},{key:"isColor",value:function(e){return Array.isArray(e)&&3===e.length}}]),e}();function Xi(e,t,n){var i=ye.getSuccessors(e,t);if(0===i.length)return!1;var o,a=c(i);try{for(a.s();!(o=a.n()).done;){var r=o.value;if(!0===n[r])return!0}}catch(s){a.e(s)}finally{a.f()}return i.some((function(t){return Xi(e,t,n)}))}function Yi(e,t,n){switch(n[t]){case!0:return!0;case!1:return!1;case void 0:var i=ye.getAncestor(e,t);return!!i&&Yi(e,i,n)}}!function(e){var t=function e(t,n,i){m(this,e),this.particleSystems=t,this.assignedParticles=n,this.tweenParticleLookup=i};t.type="[Engine Particles] Set Particle State",e.SetParticleState=t;var n=function e(t,n){m(this,e),this.particleSystem=t,this.chapterId=n};n.type="[Engine Particles] New Particle System",e.NewParticleSystem=n;var i=function e(t,n){m(this,e),this.id=t,this.targetChapterId=n};i.type="[Engine Particles] Duplicate Particle System",e.DuplicateParticleSystem=i;var o=function e(t,n){m(this,e),this.id=t,this.targetChapterId=n};o.type="[Engine Particles] Duplicate Particle System Success",e.DuplicateParticleSystemSuccess=o;var a=function e(t,n){m(this,e),this.id=t,this.particleSystem=n};a.type="[Engine Particles] Update Particle System",e.UpdateParticleSystem=a;var r=function e(t,n){m(this,e),this.oldId=t,this.newId=n};r.type="[Engine Particles] Set Particle System Id",e.SetParticleSystemId=r;var c=function e(t,n){m(this,e),this.visible=t,this.chapterId=n};c.type="[Engine Particles] Set Particle Systems Visible",e.SetParticleSystemsVisible=c;var s=function e(t,n,i){m(this,e),this.id=t,this.visible=n,this.chapterId=i};s.type="[Engine Particles] Set Particle System Visible",e.SetParticleSystemVisible=s;var l=function e(t,n){m(this,e),this.id=t,this.chapterId=n};l.type="[Engine Particles] Assign Particle",e.AssignParticle=l;var p=function e(t,n){m(this,e),this.id=t,this.chapterId=n};p.type="[Engine Particles] Unassign Particle",e.UnassignParticle=p;var u=function e(t){m(this,e),this.id=t};u.type="[Engine Partiles] Delete Particle System",e.DeleteParticleSystem=u;var d=function e(t){m(this,e),this.id=t};d.type="[Engine Partiles] Select Particle System",e.SelectParticleSystem=d;var g=function e(t){m(this,e),this.index=t};g.type="[Engine Partiles] Select Particle Constraint",e.SelectParticleConstraint=g;var h=function e(t){m(this,e),this.index=t};h.type="[Engine Partiles] Select Particle Creator",e.SelectParticleCreator=h;var f=function e(t){m(this,e),this.index=t};f.type="[Engine Partiles] Select Particle Updater",e.SelectParticleUpdater=f;var b=function e(t){m(this,e),this.chapterMap=t};b.type="[Engine Particles] Update Lookup Chapters",e.UpdateTweenParticleLookupChapters=b;var v=function e(t,n){m(this,e),this.chapterId=t,this.lookup=n};v.type="[Engine Particles] Set Lookup for chapter",e.SetLookupForChapter=v;var y=function e(t){m(this,e),this.chapterId=t};y.type="[Engine Particles] Delete chapter lookup",e.DeleteChapterLookup=y;var x=function e(t){m(this,e),this.patches=t};x.type="[Engine Particles] Apply Patch",e.ApplyPatch=x}(Ii||(Ii={})),function(e){e.updateChapterIds=function(e,t){return Object.keys(e).reduce((function(n,i){return n[t[i]]=e[i],n}),{})},e.duplicateChapter=function(e,t,n){return Object.assign(Object.assign({},n),p({},t,n[e]))},e.deleteChapter=function(e,t){var n=Object.assign({},t);return delete n[e],n},e.addEntryForChapter=function(e,t,n){return n[e]=Object.assign(Object.assign({},n[e]),t),n},e.refreshEngineLookup=function(e,t){Human.modules.moduleData[e].tweenParticleLookup=t}}(zi||(zi={})),function(e){function t(e){return e.split("_particle-")[0]}e.getParticleIdRoot=t,e.generateParticleId=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ut.getUuid;return"".concat(t(e),"_particle-").concat(n())}}(Ti||(Ti={}));var eo,to,no,io=function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r},oo=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},ao=((to=eo=function(){function e(){m(this,e)}return v(e,[{key:"applyPatch",value:function(e,t){var n=immer.applyPatches(e.getState(),t.patches);e.patchState(n)}},{key:"setParticleState",value:function(e,t){e.patchState(immer.produce(e.getState(),(function(e){e.particleSystems=t.particleSystems.reduce((function(e,t){return e[t.id]=t,e}),{}),e.assignedParticles=t.assignedParticles,e.tweenParticleLookup=t.tweenParticleLookup,e.visibleParticleSystems={}})))}},{key:"setParticlesVisible",value:function(e,t){var n=t.visible,i=t.chapterId;e.patchState(immer.produce(e.getState(),(function(e){var t=(e.assignedParticles[i]||[]).reduce((function(e,t){return e[t]=n,e}),{});e.visibleParticleSystems=Object.assign(Object.assign({},e.visibleParticleSystems),p({},i,t))})))}},{key:"setParticleVisible",value:function(e,t){var n=t.id,i=t.visible,o=t.chapterId;e.patchState(immer.produce(e.getState(),(function(e){e.visibleParticleSystems[o]=Object.assign(Object.assign({},e.visibleParticleSystems[o]||{}),p({},n,i))})))}},{key:"newParticleSystem",value:function(e,t){var n=t.particleSystem,i=t.chapterId,o=n.id,a=u(immer.produceWithPatches(e.getState(),(function(e){e.particleSystems[o]=n,e.assignedParticles[i]=[].concat(s(e.assignedParticles[i]||[]),[o])})),3),r=a[0];a[1],a[2],e.patchState(r)}},{key:"setParticleSystemId",value:function(e,t){void 0!==e.getState().particleSystems[t.newId]||e.patchState(immer.produce(e.getState(),(function(e){e.particleSelection.selectedParticle=e.particleSelection.selectedParticle===t.oldId?t.newId:e.particleSelection.selectedParticle,e.particleSystems[t.newId]=Object.assign(Object.assign({},e.particleSystems[t.oldId]),{id:t.newId}),delete e.particleSystems[t.oldId],Object.entries(e.assignedParticles).forEach((function(n){var i=u(n,2),o=i[0],a=i[1];e.assignedParticles[o]=a.map((function(e){return e===t.oldId?t.newId:e}))})),Object.entries(e.tweenParticleLookup).forEach((function(n){var i=u(n,2),o=i[0],a=i[1];e.tweenParticleLookup[o]=Object(Oe.mapValues)(a,(function(e,n,i){return e===t.oldId?t.newId:e}))}))})))}},{key:"duplicateParticleSystem",value:function(e,t){var n=t.id,i=t.targetChapterId,o=Ti.generateParticleId(n);e.patchState(immer.produce(e.getState(),(function(e){e.particleSystems[o]=JSON.parse(JSON.stringify(e.particleSystems[n])),e.particleSystems[o].id=o,e.assignedParticles[i].push(o);var t=Ti.getParticleIdRoot(n);e.tweenParticleLookup[i]&&e.tweenParticleLookup[i][t]&&(e.tweenParticleLookup=zi.addEntryForChapter(i,p({},t,o),e.tweenParticleLookup))}))),e.dispatch(new Ii.DuplicateParticleSystemSuccess(o,i))}},{key:"updateParticleSystem",value:function(e,t){var n=immer.produce(e.getState(),(function(e){e.particleSystems[t.id]=t.particleSystem}));e.patchState(Object.assign(Object.assign({},n),{particleSystems:Object.assign({},n.particleSystems)}))}},{key:"deleteChapterLookup",value:function(e,t){e.patchState(immer.produce(e.getState(),(function(e){delete e.tweenParticleLookup[t.chapterId]})))}},{key:"setLookupForChapter",value:function(e,t){e.patchState(immer.produce(e.getState(),(function(e){e.tweenParticleLookup[t.chapterId]=t.lookup})))}},{key:"assignParticle",value:function(e,t){e.patchState(immer.produce(e.getState(),(function(e){var n=e.assignedParticles[t.chapterId]||[],i=Ti.getParticleIdRoot(t.id);e.assignedParticles[t.chapterId]=n.concat(t.id),e.tweenParticleLookup=zi.addEntryForChapter(t.chapterId,p({},i,t.id),e.tweenParticleLookup),e.particleSystems=Object.assign({},e.particleSystems)})))}},{key:"unassignParticle",value:function(e,t){e.patchState(immer.produce(e.getState(),(function(e){var n=e.assignedParticles[t.chapterId]||[],i=Ti.getParticleIdRoot(t.id);e.assignedParticles[t.chapterId]=n.filter((function(e){return e!==t.id})),e.tweenParticleLookup[t.chapterId]&&delete e.tweenParticleLookup[t.chapterId][i],e.particleSystems=Object.assign({},e.particleSystems)})))}},{key:"deleteParticleSystem",value:function(e,t){e.patchState(immer.produce(e.getState(),(function(e){delete e.particleSystems[t.id],Object.keys(e.assignedParticles).forEach((function(n){e.assignedParticles[n]=e.assignedParticles[n].filter((function(e){return e!==t.id}))})),Object.keys(e.tweenParticleLookup).forEach((function(n){delete e.tweenParticleLookup[n][Ti.getParticleIdRoot(t.id)]}))})))}},{key:"selectParticleSystem",value:function(e,t){e.patchState(immer.produce(e.getState(),(function(e){e.particleSelection={selectedParticle:t.id}})))}},{key:"selectParticleConstraint",value:function(e,t){var n=e.getState().particleSelection;e.patchState(immer.produce(e.getState(),(function(e){e.particleSelection=Object.assign(Object.assign({},n),{selectedConstraint:t.index})})))}},{key:"selectParticleCreator",value:function(e,t){var n=e.getState().particleSelection;e.patchState(immer.produce(e.getState(),(function(e){e.particleSelection=Object.assign(Object.assign({},n),{selectedCreator:t.index})})))}},{key:"selectParticleUpdater",value:function(e,t){var n=e.getState().particleSelection;e.patchState(immer.produce(e.getState(),(function(e){e.particleSelection=Object.assign(Object.assign({},n),{selectedUpdater:t.index})})))}},{key:"updateTweenParticleLookupChapters",value:function(e,t){e.patchState(immer.produce(e.getState(),(function(e){e.tweenParticleLookup=zi.updateChapterIds(e.tweenParticleLookup,t.chapterMap)})))}}],[{key:"particleSystemIdExists",value:function(e){return Object(L.h)([eo],(function(t){return void 0!==t.particleSystems[e]}))}},{key:"particleSystemsForChapter",value:function(e){return Object(L.h)([eo],(function(t){return(t.assignedParticles[e]||[]).map((function(e){return t.particleSystems[e]}))}))}},{key:"getVisibleParticleSystesmForChapter",value:function(e){return Object(L.h)([eo],(function(t){var n=t.visibleParticleSystems[e]||{};return(t.assignedParticles[e]||[]).filter((function(e){return!1!==n[e]}))}))}},{key:"getTweenParticleLookup",value:function(e){return e.tweenParticleLookup}},{key:"getParticleSystems",value:function(e){return e.particleSystems}},{key:"getVisisbleParticleSystems",value:function(e){return e.visibleParticleSystems}},{key:"getParticleSystemsList",value:function(e){return Object.values(e.particleSystems)}},{key:"getAssignedParticleSystems",value:function(e){return e.assignedParticles}},{key:"getSelectedParticleSystemId",value:function(e){return e.particleSelection.selectedParticle}},{key:"getSelectedParticleSystem",value:function(e){return e.particleSystems[e.particleSelection.selectedParticle]}},{key:"getSelectedParticleConstraintIndex",value:function(e){return e.particleSelection.selectedConstraint}},{key:"getSelectedParticleConstraint",value:function(e){var t=eo.getSelectedParticleSystem(e);return t?t.constraints[e.particleSelection.selectedConstraint]:null}},{key:"getSelectedParticleCreatorIndex",value:function(e){return e.particleSelection.selectedCreator}},{key:"getSelectedParticleCreator",value:function(e){var t=eo.getSelectedParticleSystem(e);return t?t.creators[e.particleSelection.selectedCreator]:null}},{key:"getSelectedParticleUpdaterIndex",value:function(e){return e.particleSelection.selectedUpdater}},{key:"getSelectedParticleUpdater",value:function(e){var t=eo.getSelectedParticleSystem(e);return t?t.updaters[e.particleSelection.selectedUpdater]:null}}]),e}()).\u0275fac=function(e){return new(e||to)},to.\u0275prov=_.Lb({token:to,factory:to.\u0275fac}),io([Object(L.a)(Ii.ApplyPatch),oo("design:type",Function),oo("design:paramtypes",[Object,Ii.ApplyPatch]),oo("design:returntype",void 0)],to.prototype,"applyPatch",null),io([Object(L.a)(Ii.SetParticleState),oo("design:type",Function),oo("design:paramtypes",[Object,Ii.SetParticleState]),oo("design:returntype",void 0)],to.prototype,"setParticleState",null),io([Object(L.a)(Ii.SetParticleSystemsVisible),oo("design:type",Function),oo("design:paramtypes",[Object,Ii.SetParticleSystemsVisible]),oo("design:returntype",void 0)],to.prototype,"setParticlesVisible",null),io([Object(L.a)(Ii.SetParticleSystemVisible),oo("design:type",Function),oo("design:paramtypes",[Object,Ii.SetParticleSystemVisible]),oo("design:returntype",void 0)],to.prototype,"setParticleVisible",null),io([Object(L.a)(Ii.NewParticleSystem),oo("design:type",Function),oo("design:paramtypes",[Object,Ii.NewParticleSystem]),oo("design:returntype",void 0)],to.prototype,"newParticleSystem",null),io([Object(L.a)(Ii.SetParticleSystemId),oo("design:type",Function),oo("design:paramtypes",[Object,Ii.SetParticleSystemId]),oo("design:returntype",void 0)],to.prototype,"setParticleSystemId",null),io([Object(L.a)(Ii.DuplicateParticleSystem),oo("design:type",Function),oo("design:paramtypes",[Object,Ii.DuplicateParticleSystem]),oo("design:returntype",void 0)],to.prototype,"duplicateParticleSystem",null),io([Object(L.a)(Ii.UpdateParticleSystem),oo("design:type",Function),oo("design:paramtypes",[Object,Ii.UpdateParticleSystem]),oo("design:returntype",void 0)],to.prototype,"updateParticleSystem",null),io([Object(L.a)(Ii.DeleteChapterLookup),oo("design:type",Function),oo("design:paramtypes",[Object,Ii.DeleteChapterLookup]),oo("design:returntype",void 0)],to.prototype,"deleteChapterLookup",null),io([Object(L.a)(Ii.SetLookupForChapter),oo("design:type",Function),oo("design:paramtypes",[Object,Ii.SetLookupForChapter]),oo("design:returntype",void 0)],to.prototype,"setLookupForChapter",null),io([Object(L.a)(Ii.AssignParticle),oo("design:type",Function),oo("design:paramtypes",[Object,Ii.AssignParticle]),oo("design:returntype",void 0)],to.prototype,"assignParticle",null),io([Object(L.a)(Ii.UnassignParticle),oo("design:type",Function),oo("design:paramtypes",[Object,Ii.UnassignParticle]),oo("design:returntype",void 0)],to.prototype,"unassignParticle",null),io([Object(L.a)(Ii.DeleteParticleSystem),oo("design:type",Function),oo("design:paramtypes",[Object,Ii.DeleteParticleSystem]),oo("design:returntype",void 0)],to.prototype,"deleteParticleSystem",null),io([Object(L.a)(Ii.SelectParticleSystem),oo("design:type",Function),oo("design:paramtypes",[Object,Ii.SelectParticleSystem]),oo("design:returntype",void 0)],to.prototype,"selectParticleSystem",null),io([Object(L.a)(Ii.SelectParticleConstraint),oo("design:type",Function),oo("design:paramtypes",[Object,Ii.SelectParticleConstraint]),oo("design:returntype",void 0)],to.prototype,"selectParticleConstraint",null),io([Object(L.a)(Ii.SelectParticleCreator),oo("design:type",Function),oo("design:paramtypes",[Object,Ii.SelectParticleCreator]),oo("design:returntype",void 0)],to.prototype,"selectParticleCreator",null),io([Object(L.a)(Ii.SelectParticleUpdater),oo("design:type",Function),oo("design:paramtypes",[Object,Ii.SelectParticleUpdater]),oo("design:returntype",void 0)],to.prototype,"selectParticleUpdater",null),io([Object(L.a)(Ii.UpdateTweenParticleLookupChapters),oo("design:type",Function),oo("design:paramtypes",[Object,Ii.UpdateTweenParticleLookupChapters]),oo("design:returntype",void 0)],to.prototype,"updateTweenParticleLookupChapters",null),io([Object(L.e)(),oo("design:type",Function),oo("design:paramtypes",[Object]),oo("design:returntype",void 0)],to,"getTweenParticleLookup",null),io([Object(L.e)(),oo("design:type",Function),oo("design:paramtypes",[Object]),oo("design:returntype",void 0)],to,"getParticleSystems",null),io([Object(L.e)(),oo("design:type",Function),oo("design:paramtypes",[Object]),oo("design:returntype",void 0)],to,"getVisisbleParticleSystems",null),io([Object(L.e)(),oo("design:type",Function),oo("design:paramtypes",[Object]),oo("design:returntype",void 0)],to,"getParticleSystemsList",null),io([Object(L.e)(),oo("design:type",Function),oo("design:paramtypes",[Object]),oo("design:returntype",void 0)],to,"getAssignedParticleSystems",null),io([Object(L.e)(),oo("design:type",Function),oo("design:paramtypes",[Object]),oo("design:returntype",void 0)],to,"getSelectedParticleSystemId",null),io([Object(L.e)(),oo("design:type",Function),oo("design:paramtypes",[Object]),oo("design:returntype",void 0)],to,"getSelectedParticleSystem",null),io([Object(L.e)(),oo("design:type",Function),oo("design:paramtypes",[Object]),oo("design:returntype",void 0)],to,"getSelectedParticleConstraintIndex",null),io([Object(L.e)(),oo("design:type",Function),oo("design:paramtypes",[Object]),oo("design:returntype",void 0)],to,"getSelectedParticleConstraint",null),io([Object(L.e)(),oo("design:type",Function),oo("design:paramtypes",[Object]),oo("design:returntype",void 0)],to,"getSelectedParticleCreatorIndex",null),io([Object(L.e)(),oo("design:type",Function),oo("design:paramtypes",[Object]),oo("design:returntype",void 0)],to,"getSelectedParticleCreator",null),io([Object(L.e)(),oo("design:type",Function),oo("design:paramtypes",[Object]),oo("design:returntype",void 0)],to,"getSelectedParticleUpdaterIndex",null),io([Object(L.e)(),oo("design:type",Function),oo("design:paramtypes",[Object]),oo("design:returntype",void 0)],to,"getSelectedParticleUpdater",null),to=eo=io([Object(L.f)({name:"engineParticles",defaults:{particleSelection:{},particleSystems:{},visibleParticleSystems:{},assignedParticles:{},tweenParticleLookup:{}}})],to));!function(e){var t=function e(t){m(this,e),this.quizState=t};t.type="[Quiz] Set Quiz State",e.SetQuizState=t;var n=function e(){m(this,e)};n.type="[Quiz] Reset Quiz State",e.ResetQuizState=n;var i=function e(t){m(this,e),this.quizSettings=t};i.type="[Quiz] Set Quiz Settings",e.SetQuizSettings=i;var o=function e(t){m(this,e),this.active=t};o.type="[Quiz] Set Quiz Active",e.SetQuizActive=o;var a=function e(t){m(this,e),this.enabled=t};a.type="[Quiz] Set Quiz Enabled",e.SetQuizEnabled=a;var r=function e(t){m(this,e),this.locked=t};r.type="[Quiz] Set Quiz Locked",e.SetQuizLocked=r;var c=function e(t,n){m(this,e),this.sourceChapterId=t,this.targetChapterId=n};c.type="[Quiz] Copy Quiz Questions",e.CopyQuestions=c;var s=function e(t){m(this,e),this.chapterIds=t};s.type="[Quiz] Reoder Quiz Questions",e.ReorderQuestions=s;var l=function e(t){m(this,e),this.question=t};l.type="[Quiz] Add Quiz Question",e.AddQuestion=l;var p=function e(t){m(this,e),this.id=t};p.type="[Quiz] Delete Quiz Question",e.DeleteQuestion=p;var u=function e(t){m(this,e),this.questions=t};u.type="[Quiz] Set Quiz Questions",e.SetQuestions=u;var d=function e(t){m(this,e),this.question=t};d.type="[Quiz] Set Quiz Question",e.SetQuestion=d;var g=function e(t){m(this,e),this.submission=t};g.type="[Quiz] Submit Question Answer",e.SubmitQuestionAnswer=g;var h=function e(){m(this,e)};h.type="[Quiz] Advance Question",e.NextQuestion=h;var f=function e(){m(this,e)};f.type="[Quiz] Previous Question",e.PreviousQuestion=f;var b=function e(){m(this,e)};b.type="[Quiz] Clear Submissions",e.ClearSubmissions=b;var v=function e(t){m(this,e),this.questionId=t};v.type="[Quiz] Set Active Question",e.SetActiveQuestion=v;var y=function e(t){m(this,e),this.pickMode=t};y.type="[Quiz] Set Pick Mode",e.SetQuizPickMode=y;var x=function e(t){m(this,e),this.submission=t};x.type="[Quiz] Set Active QuestionAnswer",e.SetActiveSubmission=x;var w=function e(t){m(this,e),this.lifecycle=t};w.type="[Quiz] Set Quiz Lifecycle",e.SetQuizLifecycle=w}(no||(no={}));var ro=function(e){return e.Markdown="markdown",e.Images="images",e.Ticker="ticker",e}({}),co=function(e){return e.MultipleChoice="multiple-choice",e.SelectAnatomy="select-anatomy",e.LabelAnatomy="label-anatomy",e.Instructions="text-only",e}({}),so=(p(b={},co.MultipleChoice,"Multiple Choice"),p(b,co.SelectAnatomy,"Select Anatomy in 3D"),p(b,co.LabelAnatomy,"Label Anatomy"),p(b,co.Instructions,"Instructions"),b);function lo(e){var t,n=e.map((function(e){return(e.quizQuestions||[]).map((function(t){return Object.assign(Object.assign({},t),{chapterId:t.chapterId||e.id})}))}));return(t=[]).concat.apply(t,s(n))}function po(e,t){var n="string"==typeof e.data.correctAnswer?[e.data.correctAnswer]:e.data.correctAnswer;switch(e.type){case co.LabelAnatomy:return Object(Oe.isEqual)(n,t);case co.MultipleChoice:case co.SelectAnatomy:return Object(Oe.isEqual)(n.sort(),t.sort())}}function uo(e,t){var n=e.filter((function(e){return e.type!==co.Instructions})),i=e.reduce((function(e,n){return e[n.id]=function(e,t){var n=e.find((function(e){return e.questionId===t}));return n?n.answer:void 0}(t,n.id),e}),{}),o=n.filter((function(e){var t=i[e.id];return po(e,void 0===t?[]:"string"==typeof t?[t]:t)})),a=e.length,r=n.length,c=o.length,s=a-c;return{score:a>0?Math.round(c/r*100):0,total:a,scorableTotal:r,correctTotal:c,incorrectTotal:s,questionAnswers:i}}var go,ho=function(e){return e[e.Question=0]="Question",e[e.Explanation=1]="Explanation",e[e.Review=2]="Review",e}({}),fo=function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r},bo=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},vo=function(e){return e[e.Learning=0]="Learning",e[e.Assessment=1]="Assessment",e}({}),mo={quizModeActive:!1,quizModeLocked:!1,launchMode:vo.Learning,questions:[],activeQuestionId:void 0,activeSubmission:void 0,questionSubmissions:[],quizSettings:{enabled:!0,showSummary:!0,showExplanation:!0,showSubmit:!0,showProgress:!0},pickMode:"single",lifecycle:ho.Question};function yo(e,t){return e.filter((function(e){return e.chapterId===t}))}function xo(e,t){var n,i=t.map((function(t){return yo(e,t)}));return(n=[]).concat.apply(n,s(i))}function wo(e){var t=function(e){return s(new Set(e.map((function(e){return e.chapterId}))))}(e);return xo(e,t)}var ko,Oo,Co,So=((ko=go=function(){function e(){m(this,e)}return v(e,[{key:"resetQuizState",value:function(e,t){e.setState(Object.assign({},mo))}},{key:"setQuizState",value:function(e,t){var n=t.quizState;e.setState(Object.assign(Object.assign({},mo),n))}},{key:"setQuizSettings",value:function(e,t){var n=t.quizSettings;e.patchState({quizSettings:n})}},{key:"setQuizActive",value:function(e,t){e.patchState({quizModeActive:t.active,activeQuestionId:!1===t.active?void 0:e.getState().activeQuestionId})}},{key:"setQuizEnabled",value:function(e,t){var n=e.getState().quizSettings;e.patchState({quizSettings:Object.assign(Object.assign({},n),{enabled:t.enabled})})}},{key:"setQuizLocked",value:function(e,t){e.patchState({quizModeLocked:t.locked})}},{key:"copyQuestions",value:function(e,t){var n=t.sourceChapterId,i=t.targetChapterId,o=e.getState().questions,a=[].concat(s(o),s(yo(e.getState().questions,n).map((function(e){return Object.assign(Object.assign({},JSON.parse(JSON.stringify(e))),{id:Ut.idWithPrefix("question"),chapterId:i})}))));e.patchState({questions:wo(a)})}},{key:"reorderQuestions",value:function(e,t){var n=t.chapterIds;e.patchState({questions:xo(e.getState().questions,n)})}},{key:"addQuestion",value:function(e,t){var n=[].concat(s(e.getState().questions),[t.question]);e.patchState({questions:wo(n)})}},{key:"deleteQuestion",value:function(e,t){var n=e.getState().questions.filter((function(e){return e.id!==t.id}));e.patchState({questions:wo(n)})}},{key:"setQuestions",value:function(e,t){var n=t.questions;e.patchState({questions:wo(n)})}},{key:"setQuestion",value:function(e,t){var n=e.getState().questions.map((function(e){return e.id===t.question.id?t.question:e}));e.patchState({questions:n})}},{key:"submitQuestionAnswer",value:function(e,t){var n=s(e.getState().questionSubmissions),i=n.findIndex((function(e){return e.questionId===t.submission.questionId}));i>-1?n[i]=t.submission:n.push(t.submission),e.patchState({questionSubmissions:n})}},{key:"nextQuestion",value:function(e){var t,n=e.getState(),i=n.questions,o=n.activeQuestionId,a=(null===(t=i[e.getState().questions.findIndex((function(e){return e.id===o}))+1])||void 0===t?void 0:t.id)||void 0;void 0!==a&&e.patchState({activeQuestionId:a})}},{key:"previousQuestion",value:function(e){var t,n=e.getState(),i=n.questions,o=n.activeQuestionId,a=(null===(t=i[e.getState().questions.findIndex((function(e){return e.id===o}))-1])||void 0===t?void 0:t.id)||void 0;void 0!==a&&e.patchState({activeQuestionId:a})}},{key:"clearSubmissions",value:function(e){e.patchState({questionSubmissions:[]})}},{key:"setActiveQuestion",value:function(e,t){e.patchState({activeQuestionId:t.questionId})}},{key:"setQuizPickMode",value:function(e,t){var n=t.pickMode;e.patchState({pickMode:n})}},{key:"setActiveSubmission",value:function(e,t){var n=t.submission;e.patchState({activeSubmission:n})}},{key:"setQuizLifecycle",value:function(e,t){e.patchState({lifecycle:t.lifecycle})}}],[{key:"getQuizQuestionsByChapter",value:function(e){return Object(L.h)([go],(function(t){return yo(t.questions,e)}))}},{key:"getLifecycle",value:function(e){return e.lifecycle}},{key:"getQuizSettings",value:function(e){var t=e.quizModeLocked,n=e.quizSettings,i=e.questions;if(t){var o=1===i.length;return Object.assign(Object.assign({},n),{showSummary:!o&&n.showSummary,showExplanation:!!o||n.showExplanation})}return n}},{key:"getQuizModeActive",value:function(e){return e.quizModeActive}},{key:"getQuizModeLocked",value:function(e){return e.quizModeLocked}},{key:"globalSceneConfig",value:function(e){return e.sceneConfig}},{key:"hasQuiz",value:function(e){return e.questions.length>0}},{key:"getQuizEnabled",value:function(e){return!1!==e.quizSettings.enabled}},{key:"getAllQuestions",value:function(e){return e.questions}},{key:"getAllSubmissions",value:function(e){return e.questionSubmissions}},{key:"getActiveSubmission",value:function(e){return e.activeSubmission}},{key:"getActiveQuestion",value:function(e){return e.questions.find((function(t){return t.id===e.activeQuestionId}))}},{key:"getActiveQuestionId",value:function(e){return e.activeQuestionId}},{key:"getActiveQuestionLabels",value:function(e){var t=e.questions.find((function(t){return t.id===e.activeQuestionId}));return t&&t.type===co.LabelAnatomy?t.data.options:[]}},{key:"getActiveQuestionIndex",value:function(e){return e.questions.findIndex((function(t){return t.id===e.activeQuestionId}))}},{key:"getQuestionIndex",value:function(e){return Object(L.h)([go],(function(t){return t.questions.findIndex((function(t){return t.id===e}))}))}},{key:"getQuestionTotal",value:function(e){return e.questions.length}},{key:"getCorrectAnswerTotal",value:function(e){var t=e.questionSubmissions,n=e.questions;return t.filter((function(e){return po(n.find((function(t){return t.id===e.questionId})),e.answer)})).length}},{key:"getQuestionsRemaining",value:function(e){var t=e.questions,n=e.questionSubmissions;return t.length-n.length}},{key:"hasQuestionRemaining",value:function(e){var t=e.questions;return e.questionSubmissions.length<t.length}},{key:"getPickMode",value:function(e){return e.pickMode}}]),e}()).\u0275fac=function(e){return new(e||ko)},ko.\u0275prov=_.Lb({token:ko,factory:ko.\u0275fac}),fo([Object(L.a)(no.ResetQuizState),bo("design:type",Function),bo("design:paramtypes",[Object,no.ResetQuizState]),bo("design:returntype",void 0)],ko.prototype,"resetQuizState",null),fo([Object(L.a)(no.SetQuizState),bo("design:type",Function),bo("design:paramtypes",[Object,no.SetQuizState]),bo("design:returntype",void 0)],ko.prototype,"setQuizState",null),fo([Object(L.a)(no.SetQuizSettings),bo("design:type",Function),bo("design:paramtypes",[Object,no.SetQuizSettings]),bo("design:returntype",void 0)],ko.prototype,"setQuizSettings",null),fo([Object(L.a)(no.SetQuizActive),bo("design:type",Function),bo("design:paramtypes",[Object,no.SetQuizActive]),bo("design:returntype",void 0)],ko.prototype,"setQuizActive",null),fo([Object(L.a)(no.SetQuizEnabled),bo("design:type",Function),bo("design:paramtypes",[Object,no.SetQuizEnabled]),bo("design:returntype",void 0)],ko.prototype,"setQuizEnabled",null),fo([Object(L.a)(no.SetQuizLocked),bo("design:type",Function),bo("design:paramtypes",[Object,no.SetQuizLocked]),bo("design:returntype",void 0)],ko.prototype,"setQuizLocked",null),fo([Object(L.a)(no.CopyQuestions),bo("design:type",Function),bo("design:paramtypes",[Object,no.CopyQuestions]),bo("design:returntype",void 0)],ko.prototype,"copyQuestions",null),fo([Object(L.a)(no.ReorderQuestions),bo("design:type",Function),bo("design:paramtypes",[Object,no.ReorderQuestions]),bo("design:returntype",void 0)],ko.prototype,"reorderQuestions",null),fo([Object(L.a)(no.AddQuestion),bo("design:type",Function),bo("design:paramtypes",[Object,no.AddQuestion]),bo("design:returntype",void 0)],ko.prototype,"addQuestion",null),fo([Object(L.a)(no.DeleteQuestion),bo("design:type",Function),bo("design:paramtypes",[Object,no.DeleteQuestion]),bo("design:returntype",void 0)],ko.prototype,"deleteQuestion",null),fo([Object(L.a)(no.SetQuestions),bo("design:type",Function),bo("design:paramtypes",[Object,no.SetQuestions]),bo("design:returntype",void 0)],ko.prototype,"setQuestions",null),fo([Object(L.a)(no.SetQuestion),bo("design:type",Function),bo("design:paramtypes",[Object,no.SetQuestion]),bo("design:returntype",void 0)],ko.prototype,"setQuestion",null),fo([Object(L.a)(no.SubmitQuestionAnswer),bo("design:type",Function),bo("design:paramtypes",[Object,no.SubmitQuestionAnswer]),bo("design:returntype",void 0)],ko.prototype,"submitQuestionAnswer",null),fo([Object(L.a)(no.NextQuestion),bo("design:type",Function),bo("design:paramtypes",[Object]),bo("design:returntype",void 0)],ko.prototype,"nextQuestion",null),fo([Object(L.a)(no.PreviousQuestion),bo("design:type",Function),bo("design:paramtypes",[Object]),bo("design:returntype",void 0)],ko.prototype,"previousQuestion",null),fo([Object(L.a)(no.ClearSubmissions),bo("design:type",Function),bo("design:paramtypes",[Object]),bo("design:returntype",void 0)],ko.prototype,"clearSubmissions",null),fo([Object(L.a)(no.SetActiveQuestion),bo("design:type",Function),bo("design:paramtypes",[Object,no.SetActiveQuestion]),bo("design:returntype",void 0)],ko.prototype,"setActiveQuestion",null),fo([Object(L.a)(no.SetQuizPickMode),bo("design:type",Function),bo("design:paramtypes",[Object,no.SetQuizPickMode]),bo("design:returntype",void 0)],ko.prototype,"setQuizPickMode",null),fo([Object(L.a)(no.SetActiveSubmission),bo("design:type",Function),bo("design:paramtypes",[Object,no.SetActiveSubmission]),bo("design:returntype",void 0)],ko.prototype,"setActiveSubmission",null),fo([Object(L.a)(no.SetQuizLifecycle),bo("design:type",Function),bo("design:paramtypes",[Object,no.SetQuizLifecycle]),bo("design:returntype",void 0)],ko.prototype,"setQuizLifecycle",null),fo([Object(L.e)(),bo("design:type",Function),bo("design:paramtypes",[Object]),bo("design:returntype",void 0)],ko,"getLifecycle",null),fo([Object(L.e)(),bo("design:type",Function),bo("design:paramtypes",[Object]),bo("design:returntype",Object)],ko,"getQuizSettings",null),fo([Object(L.e)(),bo("design:type",Function),bo("design:paramtypes",[Object]),bo("design:returntype",void 0)],ko,"getQuizModeActive",null),fo([Object(L.e)(),bo("design:type",Function),bo("design:paramtypes",[Object]),bo("design:returntype",void 0)],ko,"getQuizModeLocked",null),fo([Object(L.e)(),bo("design:type",Function),bo("design:paramtypes",[Object]),bo("design:returntype",void 0)],ko,"globalSceneConfig",null),fo([Object(L.e)(),bo("design:type",Function),bo("design:paramtypes",[Object]),bo("design:returntype",void 0)],ko,"hasQuiz",null),fo([Object(L.e)(),bo("design:type",Function),bo("design:paramtypes",[Object]),bo("design:returntype",void 0)],ko,"getQuizEnabled",null),fo([Object(L.e)(),bo("design:type",Function),bo("design:paramtypes",[Object]),bo("design:returntype",void 0)],ko,"getAllQuestions",null),fo([Object(L.e)(),bo("design:type",Function),bo("design:paramtypes",[Object]),bo("design:returntype",void 0)],ko,"getAllSubmissions",null),fo([Object(L.e)(),bo("design:type",Function),bo("design:paramtypes",[Object]),bo("design:returntype",void 0)],ko,"getActiveSubmission",null),fo([Object(L.e)(),bo("design:type",Function),bo("design:paramtypes",[Object]),bo("design:returntype",void 0)],ko,"getActiveQuestion",null),fo([Object(L.e)(),bo("design:type",Function),bo("design:paramtypes",[Object]),bo("design:returntype",void 0)],ko,"getActiveQuestionId",null),fo([Object(L.e)(),bo("design:type",Function),bo("design:paramtypes",[Object]),bo("design:returntype",Array)],ko,"getActiveQuestionLabels",null),fo([Object(L.e)(),bo("design:type",Function),bo("design:paramtypes",[Object]),bo("design:returntype",void 0)],ko,"getActiveQuestionIndex",null),fo([Object(L.e)(),bo("design:type",Function),bo("design:paramtypes",[Object]),bo("design:returntype",void 0)],ko,"getQuestionTotal",null),fo([Object(L.e)(),bo("design:type",Function),bo("design:paramtypes",[Object]),bo("design:returntype",void 0)],ko,"getCorrectAnswerTotal",null),fo([Object(L.e)(),bo("design:type",Function),bo("design:paramtypes",[Object]),bo("design:returntype",void 0)],ko,"getQuestionsRemaining",null),fo([Object(L.e)(),bo("design:type",Function),bo("design:paramtypes",[Object]),bo("design:returntype",void 0)],ko,"hasQuestionRemaining",null),fo([Object(L.e)(),bo("design:type",Function),bo("design:paramtypes",[Object]),bo("design:returntype",void 0)],ko,"getPickMode",null),ko=go=fo([Object(L.f)({name:"quiz",defaults:mo})],ko)),_o=function e(t){var n=this;m(this,e),this.shown="majorityWins",this.selected="majorityWins",this.pickable="majorityWins",t.forEach((function(e){n[e]="majorityWins"}))},jo=((Oo=function(){function e(t,n,i){m(this,e),this.store=t,this.labelService=n,this.graphService=i}return v(e,[{key:"getMinimumGraphSync",value:function(e,t,n){var i=this,o=Human.scene.colorRecipes.getRecipes(),a=Object.keys(new Ot(o)),r=jt(e,t,a),s=function(e,t,n){var i=Object.keys(t),o=xe.getInitialVoterState(n,i),a=xe.getInitialElectionDepth(n,e),r=Object(Oe.range)(a,-1).reduce((function(n,i){var o=xe.getEligibleElections(e,Object.keys(n.remainingVoters),i),a=xe.getElectionResults(e,n.remainingVoters,o,t),r=function(e){return e.reduce((function(e,t){var n=Object.keys(t).map((function(e){return function(e,t,n,i){var o=i.reduce((function(t,i){return t[i]=p({},e,!n),t}),{});return o[t]=p({},e,n),o}(e,t[e].id,t[e].result,t[e].dissenters)})).reduce((function(e,t){return Object(Oe.merge)(e,t)}),{});return Object.keys(n).forEach((function(t){e[t]=n[t]})),e}),{})}(a.results);return Object.keys(r).forEach((function(e){n.syncGraph[e]=r[e]})),n.remainingVoters=a.remainingVoters,n}),{syncGraph:{},remainingVoters:o}).syncGraph;return function(e,t,n,i){var o,a=t.reduce((function(t,o){var a,r=e[o],s=e[i.predecessors[o]],l=c(n);try{for(l.s();!(a=l.n()).done;){var p=a.value;r[p]===s[p]&&t.push({successorId:o,prop:p})}}catch(u){l.e(u)}finally{l.f()}return t}),[]),r=c(a);try{for(r.s();!(o=r.n()).done;){var s=o.value;delete e[s.successorId][s.prop],0===Object.keys(e[s.successorId]).length&&delete e[s.successorId]}}catch(l){r.e(l)}finally{r.f()}return e}(r,Object.keys(r).filter((function(t){return!e.roots[t]&&!!e.successors[t]})),i,e)}(e,JSON.parse(JSON.stringify(new _o(o))),r);Object.entries(t).forEach((function(e){var t=u(e,2),n=t[0],i=t[1],o=Object(Oe.omit)(i,a);Object(Oe.isEmpty)(o)||(s[n]=Object.assign(Object.assign({},s[n]||{}),o))}));var l=new kt;return Object.entries(s).forEach((function(e){var t=u(e,2),o=t[0],a=t[1];l[i.switchNamespace(o,n)]=a}),this),l}},{key:"convertGraphSync",value:function(e){var t=this,n={},i={},o={},a={};return Object.entries(e).forEach((function(e){var r=u(e,2),c=r[0],s=r[1];Object.entries(s).forEach((function(e){var t=u(e,2),r=t[0],s=t[1];"shown"===r?n[c]=s:"selected"===r?i[c]=s:"pickable"===r?o[c]=!s:a[c]=Object.assign(Object.assign({},a[c]||{}),p({},r,s))}),t)}),this),{showObjects:n,selectObjects:i,pickThroughObjects:o,synchronization:a}}},{key:"switchNamespace",value:function(e,t){return t[e]||e}},{key:"serializeTimelineMaps",value:function(e,t){var n=this,i=e.timelineMap;return i.forEach((function(e){e.data.timeline=n.switchNamespace(e.data.timeline,t)})),i}},{key:"serializeProperties",value:function(e){var t=Object.assign({},e.properties),n=Human.properties.properties["annotations.layout.type"];return"draggable"!==n&&(t["annotations.layout.type"]=n),t}},{key:"serializeHotspots",value:function(e,t){var n=this,i=s(e.hotspots),o={};return t.filter((function(t){return t.chapterId===e.id})).forEach((function(e){var t=n.labelService.serializeLabel(e,i.length);i=[].concat(s(i),s(t.hotspots)),o=Object.assign(Object.assign({},o),t.data)})),{customData:o,hotspots:i}}},{key:"serializeMedia",value:function(e){return e.media?Object.entries(e.media).reduce((function(e,t){var n=u(t,2),i=n[0],o=n[1];return e[i]=Object.assign({},o.data),e}),{}):null}},{key:"serializeBackground",value:function(e){return e?Object(Y.classToClass)(e):{}}},{key:"serializeUI",value:function(e,t){return Object(Oe.isEmpty)(t)?{play:{count:1}}:t}},{key:"calcMinimumPaintState",value:function(e,t){return Object.keys(e.roots).reduce((function(n,i){return Object.assign(Object.assign({},n),function n(i){var o=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],a=(e.successors[i]||[]).reduce((function(e,o){var a=!Object(Oe.isEqual)(t[i],t[o]);return Object.assign(Object.assign({},e),n(o,a))}),{});return o?Object.assign(p({},i,t[i]),a):a}(i))}),{})}},{key:"serializeChapter",value:function(e,t,n,i,o){var a,r=this.serializeHotspots(t,i),c=this.store.selectSnapshot(ao.particleSystemsForChapter(t.id)),s=Object.assign(Object.assign(Object.assign({},t.customData),r.customData),{particleSystems:c.map((function(e){return e.id}))}),l=this.store.selectSnapshot(So.getQuizQuestionsByChapter(t.id)).map((function(e){var t=Object.assign({},e);return delete t.chapterId,t})),d=(p(a={id:o[t.id],displayName:t.info.displayName,description:t.info.description},t.camera.action,t.camera.location),p(a,"background",this.serializeBackground(t.background)),p(a,"hotspots",r.hotspots),p(a,"clippingPlanes",{clips:t.clippingPlanes.clips,boundary:t.clippingPlanes.boundary}),p(a,"ui",this.serializeUI(t,t.ui)),p(a,"media",this.serializeMedia(t)),p(a,"graph",t.graph||{}),p(a,"timelineMap",t.timelineMap||[]),p(a,"customData",s),p(a,"viewModes",t.viewModes),p(a,"lights",t.lights),p(a,"recipes",t.recipes||{}),p(a,"transparencyMode",t.transparencyMode||""),p(a,"fallbackTransparency",t.fallbackTransparency||""),p(a,"properties",this.serializeProperties(t)),p(a,"effects",t.effects||{}),p(a,"options",t.options),p(a,"transitions",t.transitions),p(a,"environment",t.environment||{}),p(a,"legend",t.legend||[]),p(a,"visibilityLayers",t.visibilityLayers.src),p(a,"colorRecipeObjects",t.colorRecipeObjects),p(a,"contentBlocks",t.contentBlocks||[]),p(a,"quizQuestions",l),a),g=this.store.selectSnapshot(Fi.getAllNodeState)[t.id],h=Object.keys(g).reduce((function(n,i){var o=g[i],a=o.shownSetByTween?Yi(e,i,t.showObjects)||Xi(e,i,t.showObjects):o.shown;return n.boolState[i]={shown:a,pickable:o.pickable},n.paintState[i]=Ui.toEngine(o.paint),n}),{boolState:{},paintState:{}}),f=this.getMinimumGraphSync(e,h.boolState,n);return Object.entries(this.convertGraphSync(f)).forEach((function(e){var t=u(e,2),n=t[0],i=t[1];d[n]=i})),d.synchronization=this.calcMinimumPaintState(e,h.paintState),d}}]),e}()).\u0275fac=function(e){return new(e||Oo)(_.Zb(L.g),_.Zb(wi),_.Zb(St))},Oo.\u0275prov=_.Lb({token:Oo,factory:Oo.\u0275fac,providedIn:"root"}),Oo);(Co||(Co={})).makeChapterIdMap=function(e,t){return e.reduce((function(e,n){return e[n.id]=!0===t?Ut.idWithPrefix("chapter"):n.id,e}),{})};var Po,Mo,Io,zo,To=function(e){return e[e.LeftClip=0]="LeftClip",e[e.RightClip=1]="RightClip",e[e.BottomClip=2]="BottomClip",e[e.TopClip=3]="TopClip",e[e.FrontClip=4]="FrontClip",e[e.BackClip=5]="BackClip",e}({}),Uo={0:"left",1:"right",2:"bottom",3:"top",4:"front",5:"back"},Lo={enabled:!1,clips:{left:{clipId:To.LeftClip,enabled:!1,fade:!1,fadeDistance:0,progress:0},right:{clipId:To.RightClip,enabled:!1,fade:!1,fadeDistance:0,progress:0},back:{clipId:To.BackClip,enabled:!1,fade:!1,fadeDistance:0,progress:0},front:{clipId:To.FrontClip,enabled:!1,fade:!1,fadeDistance:0,progress:0},top:{clipId:To.TopClip,enabled:!1,fade:!1,fadeDistance:0,progress:0},bottom:{clipId:To.BottomClip,enabled:!1,fade:!1,fadeDistance:0,progress:0}}},Do=((Po=function(){function e(t,n,i){m(this,e),this.engineService=t,this.serializeChapterService=n,this.labelService=i}return v(e,[{key:"addChapterToEngine",value:function(e,t){var n=Co.makeChapterIdMap([e],!1),i=ye.createGraphFromSrc(Object.values(Human.scene.rootObjects),"objectId","objects",new Ot(Human.scene.colorRecipes.getRecipes())),o=this.serializeChapterService.serializeChapter(i,e,{},[],n);o.synchronization=JSON.parse(JSON.stringify(e.synchronization));var a=new Human.timeline.BranchTimeline(o);Human.timeline.activeRoot.addChapter(a,{rebuild:!0,position:t})}},{key:"removeChapterFromEngine",value:function(e){Human.timeline.activeRoot._chapters=Human.timeline.activeRoot._chapters.filter((function(t){return t.id!==e.id})),Human.timeline.activeRoot.build()}},{key:"copyChapter",value:function(e,t){var n=Object(Y.classToClass)(e);return n.id=t,n.labels.forEach((function(e){e.id=Ut.idWithPrefix("label"),e.chapterId=n.id})),n.readyState={model:!0,animation:!0},n}},{key:"getCurrentChapterId",value:function(){return Human.timeline.activeRoot._nowBranch.id}},{key:"fromHumanChapter",value:function(e,t,n,i){var o=this,a=Object.assign({},n),r=e.chapters[i];a.environment=Object.assign({},r.environment),a.transitions=Object.assign({},r.transitions),r.transparencyMode&&(a.transparencyMode=r.transparencyMode),a.showObjects=Object.assign({},e.chapters[i].showObjects),a.pickThroughObjects=Object.assign({},e.chapters[i].pickThroughObjects),a.id||(a.id=Ut.idWithPrefix("chapter"));var c=!1;a.timelineMap=Object.values(n.maps).map((function(e){return"dummy"!==e.data.timeline.id&&(c=!0),{start:e.start,end:e.end,data:{timeline:e.data.timeline.id,start:e.data.start,end:e.data.end,fit:e.data.fit||!1,onEnd:e.data.onEnd}}})),delete a.maps;var l=0,p=!!n.animation&&n.animation.loop;c&&p?l=-1:c&&!p&&(l=1),a.ui=n.ui&&!Object(Oe.isEmpty)(n.ui)?n.ui:{play:{count:l}};var u=Xn.Annotation,d=s(a.annotations||[]).map((function(e){return o.labelService.deserializeAnnotation(e,a,u)})),g=[],h=this.groupHotspots(s(a.hotspots||[]).filter((function(i){var a=o.labelService.filterHotspot(e,n,i);return a?i.theme||(i.theme="module"===t?gi.studioNext:gi.classicHotspot):g.push(i),a}))).map((function(t){var a;return(a=o.labelService).deserializeHotspots.apply(a,[e,n,i].concat(s(t)))}));a.labels=[].concat(s(d),s(h)),delete a.annotations,a.background=ai.deserialize(n.background);var f=Object(Y.plainToClass)(si,a);return f.hotspots=g,f.readyState={model:!1,animation:!1},f.clippingPlanes=Object(Oe.isEmpty)(f.clippingPlanes)?Lo:this.sanitizeClippingPlanes(f.clippingPlanes),f.legend=s(r.legend||[]),f.visibilityLayers=this.buildVisibilityLayers(r.visibilityLayers,f.showObjects),f.colorRecipeObjects=r.colorRecipeObjects,f.contentBlocks=s(r.contentBlocks||[]),f.quizQuestions=(r.quizQuestions||[]).map((function(e){return Object.assign(Object.assign({},e),{chapterId:a.id})})),f}},{key:"getChapterTweenStates",value:function(e){var t=e.timelineMap.filter((function(e){return"dummy"!==e.data.timeline})).map((function(e){return e.data.timeline}));return Array.from(new Set(t))}},{key:"getChapterLightLibraries",value:function(e){return(e.lights&&e.lights.libraries||[]).filter((function(e){return"default"!==e}))}},{key:"getChapterReflectionLibraries",value:function(e){var t=e.environment&&e.environment.reflectionMap||[],n=function(e){return e.split(".")[0]},i=(e.environment&&e.environment.lightMap||[]).map(n).concat(t.map(n));return Array.from(new Set(i))}},{key:"hasVisibilityLayers",value:function(e){return Array.isArray(e)&&e.length>0}},{key:"buildVisibilityLayers",value:function(e,t){var n={src:{},current:{}};if(e&&this.hasVisibilityLayers(e.layers)){var i=e.initIndex||0,o=this.unpackLayers(e.layers),a=this.buildShownObjectsSet(t),r=this.buildCurrentLayers(o,a);n.src={layers:e.layers,initIndex:i},n.current={layers:r,index:i,position:0}}return n}},{key:"buildShownObjectsSet",value:function(e){var t=this.engineService.getSceneGraph(Human.scene.rootObjects),n=Object.keys(t.nodes).filter((function(n){return Yi(t,n,e)||Xi(t,n,e)}));return new Set(n)}},{key:"unpackLayers",value:function(e){var t=[];return e.forEach((function(e){var n=[];e.objectIds.forEach((function(e){var t=Human.scene.objects[e].getLeafObjects();n=n.concat(t.map((function(e){return e.objectId})))})),t.push({name:e.name,objectIds:n})})),t}},{key:"buildCurrentLayers",value:function(e,t){var n=[];return e.forEach((function(i,o){var a=!1;i.objectIds.forEach((function(i){t.has(i)&&(a?n[n.length-1].objectIds.push(i):(n.push({name:e[o].name,objectIds:[i]}),a=!0))}))})),n}},{key:"sanitizeClippingPlanes",value:function(e){var t=Object.values(e.clips).some((function(e){return e.progress>0})),n=Object(Oe.mapKeys)(e.clips,(function(e,t){return Uo[t]||t}));return Object.assign(Object.assign({},e),{clips:n,enabled:t})}},{key:"groupHotspots",value:function(e){var t={},n=function(e){return e.primitiveIndex?e.primitiveIndex.toFixed(0):e.pos?e.pos.map((function(e){return e.toFixed(3)})).join(":"):Math.random().toFixed(3)};return e.forEach((function(e){var i,o=[(i=e.type,RegExp("^circle-(plus|minus)").test(i)?"pair":"single"),e.objectId,n(e)].join("|");o in t?t[o].push(e):t[o]=[e]})),Object.values(t)}}]),e}()).\u0275fac=function(e){return new(e||Po)(_.Zb(Nt),_.Zb(jo),_.Zb(wi))},Po.\u0275prov=_.Lb({token:Po,factory:Po.\u0275fac,providedIn:"root"}),Po),Eo=function(e){return e.Toggle="toggle",e.None="none",e}({}),Fo=function(){var e=function e(t){m(this,e),this.patches=t};return e.type="[Story Labels] Patch Labels",e}(),Ao=function(){var e=function e(t,n){m(this,e),this.labelId=t,this.offset=n};return e.type="[Story Labels] Set label Offset",e}(),Ro=function(){var e=function e(t){m(this,e),this.labels=t};return e.type="[Story Labels] Set Labels",e}(),No=function(){var e=function e(t){m(this,e),this.label=t};return e.type="[Story Labels] Add Label",e}(),Vo=function(){var e=function e(t){m(this,e),this.label=t};return e.type="[Story Labels] Set Contexdt Label",e}(),Ho=function(){var e=function e(t,n){m(this,e),this.sourceChapter=t,this.targetChapter=n};return e.type="[Story Labels] Copy Labels",e}(),Bo=function(){var e=function e(t){m(this,e),this.label=t};return e.type="[Story Labels] Remove Label",e}(),Qo=function(){var e=function e(){m(this,e)};return e.type="[Story Labels] Remove Context Label",e}(),qo=function(){var e=function e(t){m(this,e),this.chapter=t};return e.type="[Story Labels] Remove All Chapter Labels",e}(),Wo=function(){var e=function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];m(this,e),this.label=t,this.record=n};return e.type="[Story Labels] Set Label",e}(),$o=function(){var e=function e(t,n){m(this,e),this.id=t,this.states=n};return e.type="[Story Labels] Set Label States",e}(),Ko=function(){var e=function e(t){m(this,e),this.scale=t};return e.type="[Story Labels] Set Label Scale",e}(),Go=function(){var e=function e(t){m(this,e),this.label=t};return e.type="[Story Labels] Select Label",e}(),Zo=function(){var e=function e(){m(this,e)};return e.type="[Story Labels] Reset",e}(),Jo=function(){var e=function e(t,n){m(this,e),this.labels=t,this.fields=n};return e.type="[Story Labels] Convert",e}(),Xo=function(){var e=function e(t){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];m(this,e),this.enable=t,this.enableInfo=n,this.enableActions=i};return e.type="[Story Labels] Enable Context Label",e}(),Yo=function(){var e=function e(t,n){m(this,e),this.labels=t,this.shown=n};return e.type="[Story Labels] Set Labels Shown",e}(),ea=function(){var e=function e(t){m(this,e),this.show=t};return e.type="[Story Labels] Set All Labels Shown",e}(),ta=((Mo=function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Eo.None;m(this,e),this.collapsed=t,this.collapsedMode=n}).type="[Story Labels] Set Labels Collapsed",Mo),na=function(){var e=function e(t){m(this,e),this.draggable=t};return e.type="[Story Labels] Set Draggable",e}(),ia=h("GyhO"),oa=h("5+tZ"),aa=h("7wxJ"),ra=h("wOnQ"),ca=h.n(ra),sa=(h("INDF"),h("Cfvw")),la=h("Iab2"),pa=h("VUv2");(zo=Io||(Io={})).exportImage=function(e,t,n,i){var o="string"==typeof e?zo.base64ToBlob(e,t):e;return i?Object(pa.changeDpiBlob)(o,i).then((function(e){Object(la.saveAs)(e,n)})):Object(la.saveAs)(o,n),Object($.a)(!0)},zo.canvasToBlob=function(e,t,n){return new he.a((function(i){e.toBlob((function(e){i.next(e),i.complete()}),t,n)}))},zo.fitCanvas=function(e,t){var n=t.width,i=t.height,o=document.createElement("canvas");o.width=n,o.height=i;var a=o.getContext("2d"),r=Math.max(.5*(e.width-o.width/o.height*e.height),0);return new he.a((function(t){a.drawImage(e,r,0,o.width,o.height),t.next(o),t.complete()}))},zo.elementToCanvas=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=t?{backgroundColor:"transparent"}:{};return Object(sa.a)(ca()(e,n))},zo.combineCanvasElements=function(e){var t=Math.max.apply(Math,[0].concat(s(e.map((function(e){return e.width}))))),n=Math.max.apply(Math,[0].concat(s(e.map((function(e){return e.height}))))),i=document.createElement("canvas");i.width=t,i.height=n;var o=i.getContext("2d");return e.forEach((function(e){o.drawImage(e,0,0)})),i},zo.base64ToBlob=function(e,t){for(var n=atob(e.split(",")[1]),i=new ArrayBuffer(n.length),o=new Uint8Array(i),a=0;a<n.length;a++)o[a]=n.charCodeAt(a);return new Blob([i],{type:t})},zo.blobToBase64=function(e){return new he.a((function(t){var n=new FileReader;n.addEventListener("load",(function(){t.next(n.result),t.complete()})),n.readAsDataURL(e)}))},zo.blobToCanvas=function(e,t){var n=t.width,i=t.height;return new he.a((function(t){var o=document.createElement("canvas");o.width=n,o.height=i;var a=o.getContext("2d"),r=new Image;r.addEventListener("load",(function(){a.drawImage(r,0,0),t.next(o),t.complete()})),r.src=URL.createObjectURL(e)}))};var ua,da,ga=((ua=function(){function e(t,n,i){m(this,e),this.engineService=t,this.labelsService=n,this.store=i}return v(e,[{key:"localResize",value:function(e,t){var n=Human.renderer.canvas.canvas,i=Human.renderer.canvas.annotationCanvas,o=n.parentNode,a=o.clientWidth,r=o.clientHeight;return o.width=e,o.height=t,n.width=e,n.height=t,i.width=e,i.height=t,o.style.width=e+"px",o.style.height=t+"px",Human.renderer.canvas.init(),Human.renderer.viewportDirty=!0,Human.renderer.camera.updateCanvas(),Human.renderer.postprocess.updateCanvas(),Human.renderer.draw.updateCanvas(),Human.renderer.viewportDirty=!0,Human.renderer.prepareFrame(),Human.renderer.forceRenderFrame(),[a,r]}},{key:"canvasToImage",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"original",n=e.width/e.height,i=this.engineService.getCanvas(),o=i.width,a=i.height,r=.5*(i.width-o),c=0;switch(t){case"square":a>o?a=o:o=a,r=.5*(i.width-o),c=.5*(i.height-a);break;case"original":o=n*a}return new he.a((function(t){var n=e.getContext("2d");Human.renderer.forceRenderFrame(),n.drawImage(i,r,c,o,a,0,0,e.width,e.height),t.next(),t.complete()}))}},{key:"canvasToImageWithResize",value:function(e){var t=this,n=this.engineService.getCanvas();n.style.opacity="0",this.store.dispatch(new Ge(!1));var i=u(this.localResize(e.width,e.height),2),o=i[0],a=i[1],r=e.getContext("2d");return new he.a((function(e){setTimeout((function(){Human.renderer.viewportDirty=!0,Human.renderer.prepareFrame(),Human.renderer.forceRenderFrame(),r.drawImage(n,0,0,n.width,n.height),t.localResize(o,a),document.getElementById("theCanvas").style.opacity="",t.store.dispatch(new Ge(!0)),e.next(),e.complete()}),10)}))}},{key:"drawRadialGradient",value:function(e,t){var n=t.colors,i=u(t.colorStops.map((function(t){return n=t,i=e.width,o=e.height,a=[Math.pow(i/2,2),Math.pow(o/2,2)],r=a[0],c=a[1],n/100*Math.pow(r+c,.5);var n,i,o,a,r,c})),2),o=i[0],a=i[1],r=e.getContext("2d"),c=e.width/2,s=e.height/2,l=r.createRadialGradient(c,s,o,c,s,a);l.addColorStop(t.colorStops[0]/100,"rgba(".concat(n.slice(0,4).join(","),")")),l.addColorStop(t.colorStops[1]/100,"rgba(".concat(n.slice(4,8).join(","),")")),r.fillStyle=l,r.fillRect(0,0,e.width,e.height)}},{key:"drawLinearGradient",value:function(e,t){var n=t.colors,i=e.getContext("2d"),o=e.width/2,a=e.height/2,r=i.createLinearGradient(o,a,o,e.height);r.addColorStop(t.colorStops[0]/100,"rgba(".concat(n.slice(0,4).join(","),")")),r.addColorStop(t.colorStops[1]/100,"rgba(".concat(n.slice(4,8).join(","),")")),i.fillStyle=r,i.fillRect(0,0,e.width,e.height)}},{key:"takeSnapshot",value:function(e,t,n,i,o,a){var r=this,c=a.imageType,l=a.imageQuality,p=a.copyrightEnabled,u=a.crop,d=document.createElement("canvas");d.width=e,d.height=t,"radial"===n.gradientType?this.drawRadialGradient(d,n):"linear"===n.gradientType&&this.drawLinearGradient(d,n);var g=this.engineService.getCanvas(),h=[],f=(d.height>g.height||d.width>g.width?this.canvasToImageWithResize(d):this.canvasToImage(d,u)).pipe(Object(K.a)((function(){return d})));h.push(f);var b=[],v=this.labelsService.getLabelContainer();return o&&v&&b.push(v.nativeElement),b.push.apply(b,s(i)),h.push.apply(h,s(b.map((function(n){return(n instanceof HTMLCanvasElement?Object($.a)(n):Io.elementToCanvas(n,!0)).pipe(Object(oa.a)((function(n){return Io.fitCanvas(n,{width:e,height:t})})))})))),Object(ia.a)(h).pipe(Object(aa.a)(),Object(K.a)((function(e){return Io.combineCanvasElements(e)})),Object(oa.a)((function(e){return p?r.writeLogoToCanvas(e,a):Object($.a)(e)})),Object(oa.a)((function(e){return Io.canvasToBlob(e,c,l)})))}},{key:"writeLogoToCanvas",value:function(e,t){var n=this;return this.getLogoImage(t.copyrightImagePath).pipe(Object(K.a)((function(i){var o=i.width,a=i.height,r=e.width,c=e.height;.1*r>o&&(a=a/o*(o=.1*r));var s=n.getLogoPosition(r,c,o,a,t),l=s.xOffset,p=s.yOffset;return e.getContext("2d").drawImage(i,l,p,o,a),e})),Object(G.a)((function(){return Object($.a)(e)})))}},{key:"getLogoImage",value:function(e){return new he.a((function(t){var n=new Image;n.onload=function(){t.next(n),t.complete()},n.onerror=function(){return t.error()},n.src=e}))}},{key:"getLogoPosition",value:function(e,t,n,i,o){var a,r,c=o.copyrightPosition,s=o.copyrightOffset;switch(c.x){case"right":a=e-n;break;case"center":a=e/2-n/2;break;default:a=0}switch(c.y){case"bottom":r=t-i;break;case"center":r=t/2-i/2;break;default:r=0}return{xOffset:a+s.x,yOffset:r+s.y}}}]),e}()).\u0275fac=function(e){return new(e||ua)(_.Zb(Nt),_.Zb(wi),_.Zb(L.g))},ua.\u0275prov=_.Lb({token:ua,factory:ua.\u0275fac,providedIn:"root"}),ua),ha=function e(){m(this,e),this[da]=!0};da=immer.immerable;var fa,ba,va={colors:[245,245,245,1,245,245,245,1],gradientType:"radial",colorStops:[0,100]},ma={small:{width:256,height:256},medium:{width:512,height:512},large:{width:1024,height:1024}},ya=function e(){m(this,e),this.firstTime=0,this.lastTime=1},xa=((fa=function(){function e(){m(this,e)}return v(e,[{key:"getChapterLocalTimerange",value:function(e){var t=Human.timeline.activeRoot._chapters.find((function(t){return t.id===e}));return Object(Y.plainToClass)(ya,t.timeRange)}},{key:"mapGlobalTimeToLocal",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Human.timeline.activeRoot.mapGlobalTime(e,t);return n.time<0&&(n.time=0),n}},{key:"mapLocalTimeToGlobal",value:function(e,t){var n=Human.timeline.activeRoot._chapters.find((function(t){return t.id===e}));return Human.timeline.activeRoot.mapBranchTime(n,t)}},{key:"isChapterAnimated",value:function(e){return e.timelineMap.filter((function(e){return"dummy"!==Object(Oe.get)(e,"data.timeline")&&"dummy"!==Object(Oe.get)(e,"data.timeline.id")&&"dummy"!==Object(Oe.get)(e,"data.timeline.id.id")})).length>0}},{key:"isChapterLooped",value:function(e){return!0===Object(Oe.get)(e,"loop")||-1===Object(Oe.get)(e,"ui.play.count")}},{key:"scrub",value:function(e){Human.timeline.scrub({time:e.time,borderCondition:{which:e.which?e.which:"first",direction:"forward"}})}},{key:"getTimeFrame",value:function(){return Human.timeline.getTimeFrame()}},{key:"getTime",value:function(){return Human.timeline.time}},{key:"isPlaying",value:function(){return Human.timeline.playing}},{key:"hasChapterFinished",value:function(e){var t=this.getChapterLocalTimerange(e);return this.mapGlobalTimeToLocal(Human.timeline.time).time===t.lastTime}},{key:"play",value:function(e){this.playParams=Object.keys(e).reduce((function(e,t){return void 0===e[t]&&delete e[t],e}),Object.assign({},e)),Human.timeline.play(this.playParams)}},{key:"rewind",value:function(e){var t=this.mapLocalTimeToGlobal(e,0);this.scrub({time:t,which:"second"})}},{key:"unpause",value:function(e){this.hasChapterFinished(e)&&this.rewind(e),Human.timeline.unpause()}},{key:"pause",value:function(){Human.timeline.pause()}}]),e}()).\u0275fac=function(e){return new(e||fa)},fa.\u0275prov=_.Lb({token:fa,factory:fa.\u0275fac,providedIn:"root"}),fa);!function(e){var t=/(\s*[\d\.]+\s*,){2,15}\s*[\d\.]+\s*/g;function n(e){for(var t=0;t<3;t++)if(parseFloat(""+e[t])>1)return!0;return!1}function i(e){var t=document.createElement("div");t.style.backgroundColor=e,document.documentElement.appendChild(t);var n=window.getComputedStyle(t).backgroundColor.replace(/\s/g,"");return window.document.documentElement.removeChild(t),n}function o(e){var t=e.slice(0,4);3===t.length&&t.push(1);for(var n=0;n<4;n++)t[n]=parseFloat(""+t[n]),t[n]<0&&(t[n]=0),t[n]>255&&(t[n]=255);return t[3]>1&&(t[3]=1),t}function a(e){var n;if(Array.isArray(e))n=o(e);else if("string"==typeof e){var a=e.match(t);a?n=o(a[0].split(",")):(a=i(e).match(t))&&(n=o(a[0].split(",")))}return n}function r(e){var t=a(e);if(!t)throw new TypeError("Invalid color input.");var i=c(t);return{1:n(t)?i:t,255:n(t)?t:i}}function c(e){for(var t=n(e),i=[],o=0;o<3;o++){var a=t?e[o]/255:255*e[o];a=t?Math.round(100*a)/100:Math.round(a),i.push(a)}return 4===e.length&&i.push(e[3]),i}function l(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e=e.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,(function(e,t,n,i){return[t,t,n,n,i,i].join("")})).replace(/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,(function(e,t,n,i){return[t,n,i,"ff"].join("")}));var n=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e),i=parseInt(n[1],16),o=parseInt(n[2],16),a=parseInt(n[3],16),r=parseInt(n[4],16)/255;if(t){var c=d([i,o,a]);return[c[0],c[1],c[2],r]}return[i,o,a,r]}function p(e){var t=u(e,3),n=t[0],i=t[1],o=t[2];return Math.sqrt(n*n*.299+i*i*.587+o*o*.114)}function d(e){return e.map((function(e){return e/255}))}function g(e){return e.map((function(e){return Math.round(255*e)}))}function h(e){return"#"+e.map((function(e){var t=e.toString(16);return t.length%2?"0"+t:t})).join("")}e.is255=n,e.isLight=function(e,t){return t||(t=s(e)),(p(e)+p(t))/2>140.25},e.getComputedColor=i,e.convertChannels=o,e.convert=a,e.getColor=r,e.getColors=function(e){var n=[];if("string"==typeof e){var i=e.match(t);i&&(e=i.join(",")),e=e.split(",")}if(Array.isArray(e))if(Array.isArray(e[0])&&Array.isArray(e[1]))n=e;else if(e.length<=2)n=1===e.length?e.concat(e):e;else{var o=Math.floor(e.length/2);n=e.length>4?[e.slice(0,o),e.slice(o)]:[e,e]}return n.map((function(e){return r(e)}))},e.scaleColor=c,e.hexToRgba=l,e.hexToRgb=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=l(e,t);return[n[0],n[1],n[2]]},e.rgbToHex=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return h(t?g(e):e)},e.rgbToHSP=p,e.rgbaToHex=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e[0],i=e[1],o=e[2],a=255*e[3];return h(t?[].concat(s(g([n,i,o])),[a]):[n,i,o,a])},e.rgbToDecimal=d,e.rgbFromDecimal=g}(ba||(ba={}));var wa,ka,Oa,Ca,Sa,_a,ja,Pa=h("5+WD"),Ma=function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r},Ia=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},za={imageType:bn.JPEG,crop:"original",copyrightEnabled:!1,copyrightImagePath:"assets/images/powered-by-biodigital-color.svg",copyrightPosition:{x:"left",y:"bottom"},copyrightOffset:{x:12,y:-12},imageQuality:1},Ta={loading:!1,chapters:[],chaptersViewed:[],selectedChapter:null,isChapterAnimated:!1,thumbnails:new Map,patches:[],inversePatches:[]},Ua=((ka=wa=function(){function e(t,n,i,o,a){m(this,e),this.chapterService=t,this.snapshotService=n,this.store=i,this.animationService=o,this.engineService=a}return v(e,[{key:"setChapters",value:function(e,t){e.patchState(immer.produce(e.getState(),(function(e){e.chapters=t.chapters})))}},{key:"SetChapterCameraAction",value:function(e,t){e.patchState(immer.produce(e.getState(),(function(e){e.chapters.find((function(e){return e.id===t.chapterId})).camera.action=t.cameraAction})))}},{key:"setChapterUI",value:function(e,t){e.patchState(immer.produce(e.getState(),(function(e){e.chapters.find((function(e){return e.id===t.chapterId})).ui=t.ui})))}},{key:"setChapterInfo",value:function(e,t){e.patchState(immer.produce(e.getState(),(function(e){e.chapters.find((function(e){return e.id===t.chapterId})).info=t.info})))}},{key:"setChapterLegend",value:function(e,t){e.patchState(immer.produce(e.getState(),(function(e){e.chapters.find((function(e){return e.id===t.chapterId})).legend=t.legend})))}},{key:"addToChapterLegend",value:function(e,t){e.patchState(immer.produce(e.getState(),(function(e){e.chapters.find((function(e){return e.id===t.chapterId})).legend.push(t.legend)})))}},{key:"ReorderChapters",value:function(e,t){e.patchState(immer.produce(e.getState(),(function(e){Object(Pa.c)(e.chapters,t.previousIndex,t.currentIndex)})));var n=e.getState().chapters.map((function(e){return e.id}));e.dispatch(new no.ReorderQuestions(n))}},{key:"SetChapterReadyState",value:function(e,t){var n=immer.produce(e.getState(),(function(e){if(t.chapterId){var n=e.chapters.find((function(e){return e.id===t.chapterId}));n&&(n.readyState=Object.assign(Object.assign({},n.readyState),t.readyState))}}));e.patchState(n)}},{key:"SetChapterPostProcessing",value:function(e,t){e.patchState(immer.produce(e.getState(),(function(e){var n=e.chapters.find((function(e){return e.id===t.chapterId})),i=n.properties||{};n.customData=Object.assign(Object.assign({},n.customData?n.customData:{}),{postprocess:t.effects}),n.properties=Object.assign(Object.assign({},i),t.properties)})))}},{key:"SetChapterTransitions",value:function(e,t){e.patchState(immer.produce(e.getState(),(function(e){var n=e.chapters.find((function(e){return e.id===t.chapterId}));n.transitions=n.transitions||{},n.transitions[t.key]=t.transition})))}},{key:"SetChapterTransparencyMode",value:function(e,t){e.patchState(immer.produce(e.getState(),(function(e){e.chapters.find((function(e){return e.id===t.chapterId})).transparencyMode=t.transparencyMode})))}},{key:"applyChapterPatch",value:function(e,t){var n=immer.applyPatches(e.getState(),t.patches);e.patchState(immer.produce(n,(function(e){e.patches=[],e.inversePatches=[]})))}},{key:"setChapterClippingPlane",value:function(e,t){var n=this,i=u(immer.produceWithPatches(e.getState(),(function(e){var i=e.chapters.find((function(e){return e.id===t.chapterId}));i.clippingPlanes.clips=t.clips,i.clippingPlanes.enabled=t.enabled,i.clippingPlanes.boundary=i.clippingPlanes.boundary||JSON.parse(JSON.stringify(n.engineService.getSceneBoundary()))})),3),o=i[0],a=i[1],r=i[2],c=immer.produce(o,(function(e){var t,n;(t=e.patches).push.apply(t,s(a)),(n=e.inversePatches).push.apply(n,s(r))}));t.record&&e.dispatch(new ui.SavePatches([{forward:c.patches,inverse:s(c.inversePatches).reverse(),patchAction:vn}])),e.patchState(t.record?immer.produce(c,(function(e){e.patches=[],e.inversePatches=[]})):c)}},{key:"setChapterBackground",value:function(e,t){e.patchState(immer.produce(e.getState(),(function(e){e.chapters.find((function(e){return e.id===t.chapterId})).background=t.background})))}},{key:"setAllChaptersBackground",value:function(e,t){e.patchState(immer.produce(e.getState(),(function(e){e.chapters.forEach((function(e){e.background=t.background}))})))}},{key:"resetSelectedChapterBackground",value:function(e,t){var n=e.getState().selectedChapter;this.store.dispatch(new En(n,va))}},{key:"setSelectedChapterBackground",value:function(e,t){var n=t.background,i=e.getState().selectedChapter;this.store.dispatch(new En(i,n))}},{key:"selectChapter",value:function(e,t){if(t.chapter){this.store.dispatch([new pi.UpdateNodesChecked(!1),new pi.UpdateNodeSelected]);var n=this.animationService.isChapterAnimated(t.chapter);this.store.dispatch(new Te(!!t.chapter));var i=immer.produce(e.getState(),(function(e){e.chaptersViewed.some((function(e){return t.chapter.id===e}))||e.chaptersViewed.push(t.chapter.id),e.selectedChapter=t.chapter?t.chapter.id:null,e.isChapterAnimated=n}));e.patchState(i)}}},{key:"selectChapterById",value:function(e,t){var n=t.chapterId;this.store.dispatch(new Te(!0)),e.patchState({selectedChapter:n})}},{key:"duplicateChapter",value:function(e,t){var n=t.chapter,i=this.chapterService.copyChapter(n,t.chapterId),o=e.getState().chapters.length;this.chapterService.addChapterToEngine(Object(Oe.cloneDeep)(i),o),e.patchState(immer.produce(e.getState(),(function(e){e.chapters.push(i)}))),e.dispatch(new no.CopyQuestions(n.id,i.id)),e.dispatch(new Ho(n,i)),e.dispatch(new Qn(n,i))}},{key:"copyThumbnail",value:function(e,t){if(t.sourceChapter){var n=e.getState().thumbnails,i=immer.produce(e.getState(),(function(e){var i=n.get(t.sourceChapter.id),o=new ha;o.storyId=i.storyId,o.chapterId=i.chapterId,o.urls={small:i.urls.small.replace(t.sourceChapter.id,t.targetChapter.id),large:i.urls.large.replace(t.sourceChapter.id,t.targetChapter.id)},o.snapshot=i.snapshot?i.snapshot:i.urls.large,e.thumbnails.set(t.targetChapter.id,o)}));e.patchState(i)}else e.dispatch(new qn(t.targetChapter.id,bn.JPEG,92,ma.medium,"square"))}},{key:"nextChapter",value:function(e,t){var n=e.getState().chapters,i=this.chapterService.getCurrentChapterId(),o=0;(o=n.findIndex((function(e){return e.id===i})))<n.length-1&&o++,e.dispatch(new kn(n[o]))}},{key:"previousChapter",value:function(e,t){var n=e.getState().chapters,i=this.chapterService.getCurrentChapterId(),o=0;(o=n.findIndex((function(e){return e.id===i})))>0&&o--,e.dispatch(new kn(n[o]))}},{key:"lastChapter",value:function(e,t){var n=e.getState().chapters;e.dispatch(new kn(n[n.length-1]))}},{key:"firstChapter",value:function(e,t){var n=e.getState().chapters;e.dispatch(new kn(n[0]))}},{key:"removeChapter",value:function(e,t){var n=e.getState(),i=n.chapters,o=n.selectedChapter;if(1!==i.length){this.chapterService.removeChapterFromEngine(t.chapter);var a=i.findIndex((function(e){return e.id===t.chapter.id}));e.patchState(immer.produce(e.getState(),(function(e){e.chapters.splice(a,1)}))),t.chapter.id===o&&(a===i.length-1&&a--,e.dispatch(new kn(i[a]))),e.dispatch(new qo(t.chapter))}}},{key:"resetStoryChaptersState",value:function(e,t){e.setState(Ta)}},{key:"registerChapterThumbnails",value:function(e,t){e.patchState(immer.produce(e.getState(),(function(e){e.thumbnails=new Map(t.thumbnails)})))}},{key:"takeChapterPicture",value:function(e,t){var n,i=this,o=t.chapterId,a=t.includeLabels,r=t.includeCopyright,c=t.dimensions,s=t.imageType,l=t.imageQuality,p=t.crop,u=t.layers,d=c||ma.large,g=d.width,h=d.height,f=this.store.selectSnapshot(wa.getSelectedChapterBackground);switch(s){case bn.PNG:n=f||va;break;case bn.JPEG:default:n=f&&!ai.isTransparent(f)?f:va}var b=f.colors.slice(0,3),v=ba.isLight(b),m=Object.assign(Object.assign({},za),{crop:p,imageType:s,imageQuality:l,copyrightEnabled:r,copyrightImagePath:v?"assets/images/powered-by-biodigital-color.svg":"assets/images/powered-by-biodigital-white.svg"});setTimeout((function(){i.snapshotService.takeSnapshot(g,h,n,u,a,m).subscribe((function(t){e.dispatch(new Wn(o,t,d))}))}))}},{key:"takeChapterPictureSuccess",value:function(e,t){e.patchState(immer.produce(e.getState(),(function(e){var n=e.thumbnails.get(t.chapterId)||new ha;n.snapshot=URL.createObjectURL(t.blob),e.thumbnails.set(t.chapterId,n)})))}},{key:"RecordCamera",value:function(e,t){e.patchState(immer.produce(e.getState(),(function(e){e.chapters.find((function(e){return e.id===t.chapterId})).camera.location=t.camera})))}},{key:"setChapterCurrentLayersIndexPosition",value:function(e,t){var n=u(immer.produceWithPatches(e.getState(),(function(e){var n=e.chapters.find((function(e){return e.id===t.chapterId})).visibilityLayers.current;n.index=t.index,n.position=t.position})),3),i=n[0],o=n[1],a=n[2],r=immer.produce(i,(function(e){var t,n;(t=e.patches).push.apply(t,s(o)),(n=e.inversePatches).push.apply(n,s(a))}));e.patchState(r),t.record&&e.dispatch(new ui.SavePatches([{forward:r.patches,inverse:r.inversePatches,patchAction:vn}]))}},{key:"setChapterMedia",value:function(e,t){e.patchState(immer.produce(e.getState(),(function(e){e.chapters.find((function(e){return e.id===t.chapterId})).media=t.media})))}},{key:"setChapterContentBlocks",value:function(e,t){t.contentBlocks=[].concat(s(t.contentBlocks.filter((function(e){return e.type===ro.Ticker}))),s(t.contentBlocks.filter((function(e){return e.type!==ro.Ticker})))),e.patchState(immer.produce(e.getState(),(function(e){e.chapters.find((function(e){return e.id===t.chapterId})).contentBlocks=t.contentBlocks})))}}],[{key:"getStoryChapters",value:function(e){return e.chapters}},{key:"getChaptersViewed",value:function(e){return e.chaptersViewed}},{key:"getChapter",value:function(e){return Object(L.h)([wa],(function(t){return t.chapters.find((function(t){return t.id===e}))}))}},{key:"getSelectedChapterId",value:function(e){return e.selectedChapter}},{key:"getSelectedChapter",value:function(e){return e.chapters.find((function(t){return t.id===e.selectedChapter}))||null}},{key:"getNextChapter",value:function(e){var t=1+wa.getSelectedChapterIndex(e);return e.chapters[t]}},{key:"getPreviousChapter",value:function(e){var t=-1+wa.getSelectedChapterIndex(e);return e.chapters[t]}},{key:"getSelectedChapterIndex",value:function(e){return e.chapters.findIndex((function(t){return t.id===e.selectedChapter}))}},{key:"getSelectedChapterTitle",value:function(e){return e.chapters.find((function(t){return t.id===e.selectedChapter})).info.displayName}},{key:"getChapterCount",value:function(e){return e.chapters.length}},{key:"getRegisteredThumbnails",value:function(e){return e.thumbnails}},{key:"getIsChapterAnimated",value:function(e){return e.isChapterAnimated}},{key:"getSelectedChapterReadyState",value:function(e){var t=e.chapters,n=e.selectedChapter,i=wa.findChapter(t,n);return Object(Oe.get)(i,"readyState")}},{key:"getChaptersLoaded",value:function(e){return{count:e.chapters.length,modelChapters:e.chapters.filter((function(e){return e.readyState.model})),animationChapters:e.chapters.filter((function(e){return e.readyState.animation}))}}},{key:"getAllChaptersModelsReady",value:function(e){return e.chapters.length>0&&e.chapters.every((function(e){return e.readyState.model}))}},{key:"getAllChaptersAnimationsReady",value:function(e){return e.chapters.length>0&&e.chapters.every((function(e){return e.readyState.animation}))}},{key:"getSelectedChapterBackground",value:function(e){var t=e.chapters,n=e.selectedChapter,i=wa.findChapter(t,n);return Object(Oe.get)(i,"background")||va}},{key:"getAllChaptersBackground",value:function(e){return e.chapters.map((function(e){return Object(Oe.get)(e,"background")}))}},{key:"getSelectedChapterAudio",value:function(e){var t=e.chapters.find((function(t){return t.id===e.selectedChapter}));return t&&t.media?Object.values(t.media).filter((function(e){return"audio"===e.data.streamType}))[0]:null}},{key:"getSelectedChapterLegend",value:function(e){var t=e.chapters,n=e.selectedChapter,i=wa.findChapter(t,n);return Object(Oe.get)(i,"legend")||[]}},{key:"getSelectedChapterClippingPlanes",value:function(e){var t=e.chapters,n=e.selectedChapter,i=wa.findChapter(t,n);return Object(Oe.get)(i,"clippingPlanes")}},{key:"getChapterCamera",value:function(e){var t=e.chapters,n=e.selectedChapter,i=wa.findChapter(t,n);return Object(Oe.get)(i,"camera.location")}},{key:"findChapter",value:function(e,t){return e.find((function(e){return e.id===t}))}},{key:"getAllChaptersCurrentLayers",value:function(e){return e.chapters.map((function(e){return Object(Oe.get)(e,"visibilityLayers.current.layers",[])}))}},{key:"getSelectedChapterSrcLayers",value:function(e){var t=e.chapters,n=e.selectedChapter,i=wa.findChapter(t,n);return Object(Oe.get)(i,"visibilityLayers.src.layers",[])}},{key:"getSelectedChapterCurrentLayers",value:function(e){var t=e.chapters,n=e.selectedChapter,i=wa.findChapter(t,n);return Object(Oe.get)(i,"visibilityLayers.current.layers",[])}},{key:"getSelectedChapterCurrentLayersIndex",value:function(e){var t=e.chapters,n=e.selectedChapter,i=wa.findChapter(t,n);return Object(Oe.get)(i,"visibilityLayers.current.index")}},{key:"getSelectedChapterCurrentLayersPosition",value:function(e){var t=e.chapters,n=e.selectedChapter,i=wa.findChapter(t,n);return Object(Oe.get)(i,"visibilityLayers.current.position")}},{key:"getSelectedChapterContentBlocks",value:function(e){var t=e.chapters,n=e.selectedChapter,i=wa.findChapter(t,n);return Object(Oe.get)(i,"contentBlocks",[])}}]),e}()).\u0275fac=function(e){return new(e||ka)(_.Zb(Do),_.Zb(ga),_.Zb(L.g),_.Zb(xa),_.Zb(Nt))},ka.\u0275prov=_.Lb({token:ka,factory:ka.\u0275fac}),Ma([Object(L.a)(Cn),Ia("design:type",Function),Ia("design:paramtypes",[Object,Cn]),Ia("design:returntype",void 0)],ka.prototype,"setChapters",null),Ma([Object(L.a)(Sn),Ia("design:type",Function),Ia("design:paramtypes",[Object,Sn]),Ia("design:returntype",void 0)],ka.prototype,"SetChapterCameraAction",null),Ma([Object(L.a)(_n),Ia("design:type",Function),Ia("design:paramtypes",[Object,_n]),Ia("design:returntype",void 0)],ka.prototype,"setChapterUI",null),Ma([Object(L.a)(jn),Ia("design:type",Function),Ia("design:paramtypes",[Object,jn]),Ia("design:returntype",void 0)],ka.prototype,"setChapterInfo",null),Ma([Object(L.a)(Pn),Ia("design:type",Function),Ia("design:paramtypes",[Object,Pn]),Ia("design:returntype",void 0)],ka.prototype,"setChapterLegend",null),Ma([Object(L.a)(Mn),Ia("design:type",Function),Ia("design:paramtypes",[Object,Mn]),Ia("design:returntype",void 0)],ka.prototype,"addToChapterLegend",null),Ma([Object(L.a)(In),Ia("design:type",Function),Ia("design:paramtypes",[Object,In]),Ia("design:returntype",void 0)],ka.prototype,"ReorderChapters",null),Ma([Object(L.a)(zn),Ia("design:type",Function),Ia("design:paramtypes",[Object,zn]),Ia("design:returntype",void 0)],ka.prototype,"SetChapterReadyState",null),Ma([Object(L.a)(Tn),Ia("design:type",Function),Ia("design:paramtypes",[Object,Tn]),Ia("design:returntype",void 0)],ka.prototype,"SetChapterPostProcessing",null),Ma([Object(L.a)(Un),Ia("design:type",Function),Ia("design:paramtypes",[Object,Un]),Ia("design:returntype",void 0)],ka.prototype,"SetChapterTransitions",null),Ma([Object(L.a)(Ln),Ia("design:type",Function),Ia("design:paramtypes",[Object,Ln]),Ia("design:returntype",void 0)],ka.prototype,"SetChapterTransparencyMode",null),Ma([Object(L.a)(vn),Ia("design:type",Function),Ia("design:paramtypes",[Object,vn]),Ia("design:returntype",void 0)],ka.prototype,"applyChapterPatch",null),Ma([Object(L.a)(Dn),Ia("design:type",Function),Ia("design:paramtypes",[Object,Dn]),Ia("design:returntype",void 0)],ka.prototype,"setChapterClippingPlane",null),Ma([Object(L.a)(En),Ia("design:type",Function),Ia("design:paramtypes",[Object,En]),Ia("design:returntype",void 0)],ka.prototype,"setChapterBackground",null),Ma([Object(L.a)(Fn),Ia("design:type",Function),Ia("design:paramtypes",[Object,Fn]),Ia("design:returntype",void 0)],ka.prototype,"setAllChaptersBackground",null),Ma([Object(L.a)(An),Ia("design:type",Function),Ia("design:paramtypes",[Object,An]),Ia("design:returntype",void 0)],ka.prototype,"resetSelectedChapterBackground",null),Ma([Object(L.a)(Rn),Ia("design:type",Function),Ia("design:paramtypes",[Object,Object]),Ia("design:returntype",void 0)],ka.prototype,"setSelectedChapterBackground",null),Ma([Object(L.a)(kn),Ia("design:type",Function),Ia("design:paramtypes",[Object,kn]),Ia("design:returntype",void 0)],ka.prototype,"selectChapter",null),Ma([Object(L.a)(On),Ia("design:type",Function),Ia("design:paramtypes",[Object,Object]),Ia("design:returntype",void 0)],ka.prototype,"selectChapterById",null),Ma([Object(L.a)(Nn),Ia("design:type",Function),Ia("design:paramtypes",[Object,Nn]),Ia("design:returntype",void 0)],ka.prototype,"duplicateChapter",null),Ma([Object(L.a)(Qn),Ia("design:type",Function),Ia("design:paramtypes",[Object,Qn]),Ia("design:returntype",void 0)],ka.prototype,"copyThumbnail",null),Ma([Object(L.a)(mn),Ia("design:type",Function),Ia("design:paramtypes",[Object,mn]),Ia("design:returntype",void 0)],ka.prototype,"nextChapter",null),Ma([Object(L.a)(yn),Ia("design:type",Function),Ia("design:paramtypes",[Object,yn]),Ia("design:returntype",void 0)],ka.prototype,"previousChapter",null),Ma([Object(L.a)(wn),Ia("design:type",Function),Ia("design:paramtypes",[Object,wn]),Ia("design:returntype",void 0)],ka.prototype,"lastChapter",null),Ma([Object(L.a)(xn),Ia("design:type",Function),Ia("design:paramtypes",[Object,wn]),Ia("design:returntype",void 0)],ka.prototype,"firstChapter",null),Ma([Object(L.a)(Vn),Ia("design:type",Function),Ia("design:paramtypes",[Object,Vn]),Ia("design:returntype",void 0)],ka.prototype,"removeChapter",null),Ma([Object(L.a)(Hn),Ia("design:type",Function),Ia("design:paramtypes",[Object,Hn]),Ia("design:returntype",void 0)],ka.prototype,"resetStoryChaptersState",null),Ma([Object(L.a)(Bn),Ia("design:type",Function),Ia("design:paramtypes",[Object,Bn]),Ia("design:returntype",void 0)],ka.prototype,"registerChapterThumbnails",null),Ma([Object(L.a)(qn),Ia("design:type",Function),Ia("design:paramtypes",[Object,qn]),Ia("design:returntype",void 0)],ka.prototype,"takeChapterPicture",null),Ma([Object(L.a)(Wn),Ia("design:type",Function),Ia("design:paramtypes",[Object,Wn]),Ia("design:returntype",void 0)],ka.prototype,"takeChapterPictureSuccess",null),Ma([Object(L.a)($n),Ia("design:type",Function),Ia("design:paramtypes",[Object,$n]),Ia("design:returntype",void 0)],ka.prototype,"RecordCamera",null),Ma([Object(L.a)(Kn),Ia("design:type",Function),Ia("design:paramtypes",[Object,Kn]),Ia("design:returntype",void 0)],ka.prototype,"setChapterCurrentLayersIndexPosition",null),Ma([Object(L.a)(Gn),Ia("design:type",Function),Ia("design:paramtypes",[Object,Gn]),Ia("design:returntype",void 0)],ka.prototype,"setChapterMedia",null),Ma([Object(L.a)(Zn),Ia("design:type",Function),Ia("design:paramtypes",[Object,Zn]),Ia("design:returntype",void 0)],ka.prototype,"setChapterContentBlocks",null),Ma([Object(L.e)(),Ia("design:type",Function),Ia("design:paramtypes",[fn]),Ia("design:returntype",void 0)],ka,"getStoryChapters",null),Ma([Object(L.e)(),Ia("design:type",Function),Ia("design:paramtypes",[fn]),Ia("design:returntype",void 0)],ka,"getChaptersViewed",null),Ma([Object(L.e)(),Ia("design:type",Function),Ia("design:paramtypes",[fn]),Ia("design:returntype",void 0)],ka,"getSelectedChapterId",null),Ma([Object(L.e)(),Ia("design:type",Function),Ia("design:paramtypes",[fn]),Ia("design:returntype",void 0)],ka,"getSelectedChapter",null),Ma([Object(L.e)(),Ia("design:type",Function),Ia("design:paramtypes",[fn]),Ia("design:returntype",void 0)],ka,"getNextChapter",null),Ma([Object(L.e)(),Ia("design:type",Function),Ia("design:paramtypes",[fn]),Ia("design:returntype",void 0)],ka,"getPreviousChapter",null),Ma([Object(L.e)(),Ia("design:type",Function),Ia("design:paramtypes",[fn]),Ia("design:returntype",void 0)],ka,"getSelectedChapterIndex",null),Ma([Object(L.e)(),Ia("design:type",Function),Ia("design:paramtypes",[fn]),Ia("design:returntype",void 0)],ka,"getSelectedChapterTitle",null),Ma([Object(L.e)(),Ia("design:type",Function),Ia("design:paramtypes",[fn]),Ia("design:returntype",void 0)],ka,"getChapterCount",null),Ma([Object(L.e)(),Ia("design:type",Function),Ia("design:paramtypes",[fn]),Ia("design:returntype",void 0)],ka,"getRegisteredThumbnails",null),Ma([Object(L.e)(),Ia("design:type",Function),Ia("design:paramtypes",[fn]),Ia("design:returntype",void 0)],ka,"getIsChapterAnimated",null),Ma([Object(L.e)(),Ia("design:type",Function),Ia("design:paramtypes",[fn]),Ia("design:returntype",void 0)],ka,"getSelectedChapterReadyState",null),Ma([Object(L.e)(),Ia("design:type",Function),Ia("design:paramtypes",[fn]),Ia("design:returntype",void 0)],ka,"getChaptersLoaded",null),Ma([Object(L.e)(),Ia("design:type",Function),Ia("design:paramtypes",[fn]),Ia("design:returntype",void 0)],ka,"getAllChaptersModelsReady",null),Ma([Object(L.e)(),Ia("design:type",Function),Ia("design:paramtypes",[fn]),Ia("design:returntype",void 0)],ka,"getAllChaptersAnimationsReady",null),Ma([Object(L.e)(),Ia("design:type",Function),Ia("design:paramtypes",[fn]),Ia("design:returntype",void 0)],ka,"getSelectedChapterBackground",null),Ma([Object(L.e)(),Ia("design:type",Function),Ia("design:paramtypes",[fn]),Ia("design:returntype",void 0)],ka,"getAllChaptersBackground",null),Ma([Object(L.e)(),Ia("design:type",Function),Ia("design:paramtypes",[fn]),Ia("design:returntype",void 0)],ka,"getSelectedChapterAudio",null),Ma([Object(L.e)(),Ia("design:type",Function),Ia("design:paramtypes",[fn]),Ia("design:returntype",void 0)],ka,"getSelectedChapterLegend",null),Ma([Object(L.e)(),Ia("design:type",Function),Ia("design:paramtypes",[fn]),Ia("design:returntype",void 0)],ka,"getSelectedChapterClippingPlanes",null),Ma([Object(L.e)(),Ia("design:type",Function),Ia("design:paramtypes",[fn]),Ia("design:returntype",void 0)],ka,"getChapterCamera",null),Ma([Object(L.e)(),Ia("design:type",Function),Ia("design:paramtypes",[fn]),Ia("design:returntype",Array)],ka,"getAllChaptersCurrentLayers",null),Ma([Object(L.e)(),Ia("design:type",Function),Ia("design:paramtypes",[fn]),Ia("design:returntype",Array)],ka,"getSelectedChapterSrcLayers",null),Ma([Object(L.e)(),Ia("design:type",Function),Ia("design:paramtypes",[fn]),Ia("design:returntype",Array)],ka,"getSelectedChapterCurrentLayers",null),Ma([Object(L.e)(),Ia("design:type",Function),Ia("design:paramtypes",[fn]),Ia("design:returntype",Number)],ka,"getSelectedChapterCurrentLayersIndex",null),Ma([Object(L.e)(),Ia("design:type",Function),Ia("design:paramtypes",[fn]),Ia("design:returntype",Number)],ka,"getSelectedChapterCurrentLayersPosition",null),Ma([Object(L.e)(),Ia("design:type",Function),Ia("design:paramtypes",[fn]),Ia("design:returntype",Array)],ka,"getSelectedChapterContentBlocks",null),ka=wa=Ma([Object(L.f)({name:"storyChapters",defaults:Ta})],ka)),La=function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r},Da=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Ea={storedCameras:{},cameraMotion:new gn,panMode:"rotate",zoomed:!1,lockCamera:!1,cameraFlyTo:void 0},Fa=((Ca=Oa=function(){function e(t,n){m(this,e),this.cameraService=t,this.store=n}return v(e,[{key:"storeCamera",value:function(e,t){var n=t.camera||this.cameraService.getCamera(),i=e.getState().storedCameras;i[t.id]=Object.assign({},n),e.patchState({storedCameras:Object.assign({},i)})}},{key:"clearCamera",value:function(e,t){var n=e.getState().storedCameras;delete n[t.id],e.patchState({storedCameras:Object.assign({},n)})}},{key:"setCameraFlyTo",value:function(e,t){e.patchState(immer.produce(e.getState(),(function(e){e.cameraFlyTo=t.camera})))}},{key:"applyCameraPatch",value:function(e,t){var n=immer.applyPatches(e.getState(),t.patches);e.patchState(n);var i=void 0===n.cameraFlyTo?this.store.selectSnapshot(Ua.getChapterCamera):n.cameraFlyTo;e.dispatch(new Wt(i,!0,1))}},{key:"moveCamera",value:function(e,t){e.patchState({cameraMotion:Object.assign({},t.cameraMotion)})}},{key:"resetCamera",value:function(e,t){return this.cameraService.resetCamera().pipe(Object(hn.a)((function(){e.patchState({cameraMotion:new gn})})))}},{key:"zoomCamera",value:function(e,t){var n=e.getState().cameraMotion;n.zoom=t.value,e.patchState({cameraMotion:Object.assign({},n)})}},{key:"panCameraX",value:function(e,t){var n=e.getState().cameraMotion;n.panX=t.value,e.patchState({cameraMotion:Object.assign({},n)})}},{key:"panCameraY",value:function(e,t){var n=e.getState().cameraMotion;n.panY=t.value,e.patchState({cameraMotion:Object.assign({},n)})}},{key:"rotateCameraX",value:function(e,t){var n=e.getState().cameraMotion;e.patchState({cameraMotion:Object.assign(Object.assign({},n),{rotateX:t.value})})}},{key:"rotateCameraY",value:function(e,t){var n=e.getState().cameraMotion;n.rotateY=t.value,e.patchState({cameraMotion:Object.assign({},n)})}},{key:"SetCameraMode",value:function(e,t){e.patchState({panMode:t.mode})}},{key:"setZoomed",value:function(e,t){e.patchState({zoomed:t.zoomed})}},{key:"lockCamera",value:function(e,t){e.patchState({lockCamera:t.lock})}}],[{key:"getStoredCamera",value:function(e){return Object(L.h)([Oa],(function(t){return t.storedCameras[e]||null}))}},{key:"getCameraMotion",value:function(e){return e.cameraMotion}},{key:"getPanMode",value:function(e){return e.panMode}},{key:"getZoomed",value:function(e){return e.zoomed}},{key:"getLockCamera",value:function(e){return e.lockCamera}}]),e}()).\u0275fac=function(e){return new(e||Ca)(_.Zb(dn),_.Zb(L.g))},Ca.\u0275prov=_.Lb({token:Ca,factory:Ca.\u0275fac}),La([Object(L.a)(qt),Da("design:type",Function),Da("design:paramtypes",[Object,qt]),Da("design:returntype",void 0)],Ca.prototype,"storeCamera",null),La([Object(L.a)(Qt),Da("design:type",Function),Da("design:paramtypes",[Object,Qt]),Da("design:returntype",void 0)],Ca.prototype,"clearCamera",null),La([Object(L.a)(sn),Da("design:type",Function),Da("design:paramtypes",[Object,sn]),Da("design:returntype",void 0)],Ca.prototype,"setCameraFlyTo",null),La([Object(L.a)(ln),Da("design:type",Function),Da("design:paramtypes",[Object,ln]),Da("design:returntype",void 0)],Ca.prototype,"applyCameraPatch",null),La([Object(L.a)(Kt),Da("design:type",Function),Da("design:paramtypes",[Object,Kt]),Da("design:returntype",void 0)],Ca.prototype,"moveCamera",null),La([Object(L.a)(Gt),Da("design:type",Function),Da("design:paramtypes",[Object,Gt]),Da("design:returntype",void 0)],Ca.prototype,"resetCamera",null),La([Object(L.a)(Zt),Da("design:type",Function),Da("design:paramtypes",[Object,Zt]),Da("design:returntype",void 0)],Ca.prototype,"zoomCamera",null),La([Object(L.a)(Xt),Da("design:type",Function),Da("design:paramtypes",[Object,Xt]),Da("design:returntype",void 0)],Ca.prototype,"panCameraX",null),La([Object(L.a)(Yt),Da("design:type",Function),Da("design:paramtypes",[Object,Yt]),Da("design:returntype",void 0)],Ca.prototype,"panCameraY",null),La([Object(L.a)(tn),Da("design:type",Function),Da("design:paramtypes",[Object,tn]),Da("design:returntype",void 0)],Ca.prototype,"rotateCameraX",null),La([Object(L.a)(nn),Da("design:type",Function),Da("design:paramtypes",[Object,nn]),Da("design:returntype",void 0)],Ca.prototype,"rotateCameraY",null),La([Object(L.a)(an),Da("design:type",Function),Da("design:paramtypes",[Object,an]),Da("design:returntype",void 0)],Ca.prototype,"SetCameraMode",null),La([Object(L.a)(rn),Da("design:type",Function),Da("design:paramtypes",[Object,rn]),Da("design:returntype",void 0)],Ca.prototype,"setZoomed",null),La([Object(L.a)(cn),Da("design:type",Function),Da("design:paramtypes",[Object,cn]),Da("design:returntype",void 0)],Ca.prototype,"lockCamera",null),La([Object(L.e)(),Da("design:type",Function),Da("design:paramtypes",[Bt]),Da("design:returntype",void 0)],Ca,"getCameraMotion",null),La([Object(L.e)(),Da("design:type",Function),Da("design:paramtypes",[Bt]),Da("design:returntype",void 0)],Ca,"getPanMode",null),La([Object(L.e)(),Da("design:type",Function),Da("design:paramtypes",[Bt]),Da("design:returntype",void 0)],Ca,"getZoomed",null),La([Object(L.e)(),Da("design:type",Function),Da("design:paramtypes",[Bt]),Da("design:returntype",void 0)],Ca,"getLockCamera",null),Ca=Oa=La([Object(L.f)({name:"engineCamera",defaults:Ea})],Ca)),Aa=function(e){return e.Select="Select",e.Hide="Hide",e.Paint="Paint",e.Label="Label",e.Isolate="Isolate",e.Fade="Fade",e.Position="Position",e.Quiz="Quiz",e}({}),Ra=function(e){return e.Capture="capture",e.DoNotCaptureShowMessage="do_not_capture_show_message",e.DoNotCapture="do_not_capture",e}({}),Na=h("z6cu"),Va=((Sa=function(){function e(t){m(this,e),this.http=t,this.wikiCache=new Map}return v(e,[{key:"getWikiText",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(n&&this.wikiCache.has(e)){var i=this.wikiCache.get(e);return Object($.a)(i)}return z.offline?Object($.a)(""):this.http.get("/search/wiki?name="+e).pipe(Object(K.a)((function(e){return e.description})),Object(G.a)((function(e){return 404===e.status?Object($.a)(""):Object(Na.a)(e)})),Object(hn.a)((function(n){return t.wikiCache.set(e,n)})))}}]),e}()).\u0275fac=function(e){return new(e||Sa)(_.Zb(W.b))},Sa.\u0275prov=_.Lb({token:Sa,factory:Sa.\u0275fac,providedIn:"root"}),Sa),Ha=function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r},Ba=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Qa=new Vt(0,0,0,0,Ht.Hidden),qa=((ja=_a=function(){function e(t,n,i,o,a){m(this,e),this.store=t,this.graphService=n,this.engineService=i,this.wikiService=o,this.animationService=a}return v(e,[{key:"load",value:function(e,t){e.dispatch(new je("engine"))}},{key:"loadSuccess",value:function(e,t){(0,e.patchState)({engine:t.result})}},{key:"setReady",value:function(e,t){e.patchState({ready:t.ready})}},{key:"setDisplay",value:function(e,t){e.patchState({display:t.display})}},{key:"setZoomViaScrollAllowed",value:function(e,t){e.patchState({scrollMode:t.scrollMode})}},{key:"setVisible",value:function(e,t){e.patchState({visible:t.visible})}},{key:"setEnginePosition",value:function(e,t){e.patchState({enginePosition:Object.assign(Object.assign({},t.position),{right:t.position.left+t.position.width,bottom:t.position.top+t.position.height})})}},{key:"resetEnginePosition",value:function(e,t){e.patchState({enginePosition:Qa})}},{key:"setChapter",value:function(e,t){e.patchState({chapter:t.chapterId})}},{key:"setChapterInit",value:function(e,t){e.patchState({chapterInit:t.chapterInit})}},{key:"setActiveTool",value:function(e,t){e.patchState({activeTool:t.tool})}},{key:"setGraph",value:function(e,t){e.patchState({viewGraph:Object.assign({},t.graph)})}},{key:"clearGraph",value:function(e,t){e.patchState({viewGraph:{nodes:{},successors:{},predecessors:{},roots:{}}})}},{key:"setXrayMode",value:function(e,t){e.patchState({xrayModeEnabled:t.enabled})}},{key:"centerCameraOnVisible",value:function(e,t){var n=this.engineService.getVisibleLeaves(),i=this.engineService.getBoundaryFromObjects(n),o=this.engineService.getCameraLookAt();o.look={x:(i.xmin+i.xmax)/2,y:(i.ymin+i.ymax)/2,z:(i.zmin+i.zmax)/2},Human.renderer.camera.fly.flyTo(o)}},{key:"toggleProgressBar",value:function(e,t){e.patchState({showProgressBar:t.show})}},{key:"toggleCameraBar",value:function(e,t){e.patchState({showCameraBar:t.show})}},{key:"toggleLabels",value:function(e,t){var n=null!=t.show?t.show:!e.getState().showLabels;e.patchState({showLabels:n})}},{key:"synchronizeVisibleNodes",value:function(e,t){var n=this,i=e.getState().viewGraph,o=this.stateMapToNodeIds(i,t.leafVisibilityState),a={};o.forEach((function(e){var i=n.engineService.getLeafObjects(e).reduce((function(e,n){return e||t.nodes[n].shown}),!1);a[e]={shown:i}})),this.graphService.synchronize(Object.assign({},i),{shown:"trueWins"},a),e.patchState({viewGraph:Object.assign({},i)})}},{key:"synchronizeRenderableNodes",value:function(e,t){var n=e.getState().viewGraph,i=this.stateMapToNodeIds(n,t.leafRenderableState),o={};i.forEach((function(e){o[e]={renderable:!0}})),this.graphService.synchronize(n,{renderable:"falseWins"},o)}},{key:"synchronizePickableNodes",value:function(e,t){var n=this,i=e.getState().viewGraph,o=this.stateMapToNodeIds(i,t.leafPickableState),a={};o.forEach((function(e){var t=n.engineService.getLeafObjects(e).reduce((function(e,t){return e||Human.scene.objects[t].pickable}),!1);a[e]={pickable:t}})),this.graphService.synchronize(i,{pickable:"trueWins"},a),e.patchState({viewGraph:Object.assign({},i)})}},{key:"playChapterAnimation",value:function(e,t){var n=this.store.selectSnapshot(Ua.getSelectedChapter),i=Object(Oe.get)(n,"ui.play.count",0);this.animationService.play({startChapterId:n.id,loop:-1===i,numChapters:1,queue:!1}),e.getState().animationPlaying||this.animationService.pause()}},{key:"toggleAnimation",value:function(e,t){var n=this.store.selectSnapshot(Ua.getSelectedChapterId);t.play?this.animationService.unpause(n):this.animationService.pause()}},{key:"setAnimationPlaying",value:function(e,t){e.patchState({animationPlaying:t.playing})}},{key:"setPlaybackSpeed",value:function(e,t){e.patchState({playbackSpeed:t.speed})}},{key:"playAudio",value:function(e,t){e.patchState({playAudio:t.play})}},{key:"setAutoplay",value:function(e,t){e.patchState({autoplay:t.enable})}},{key:"setObjectLayerOrder",value:function(e,t){var n=this,i=e.getState().viewGraph,o=isNaN(t.layer)?0:t.layer,a=[];t.nodes.forEach((function(e){var t=n.graphService.getDescendants(i,e.id,!0);a=a.concat(t)})),a.forEach((function(e){n.engineService.setObjectLayer(e,o),n.graphService.setState(i,e,{layer:o})})),e.patchState({viewGraph:Object.assign({},i)})}},{key:"setObjectDisplayName",value:function(e,t){var n=Human.scene.objects[t.nodeId];n&&(n.displayName=t.displayName)}},{key:"autoSortObjectLayers",value:function(e,t){var n=this,i=e.getState().viewGraph,o=0,a=Human.scene.getEnabledLeaves(),r=this.engineService.getObjectLayerValues(a);Object.keys(r).map((function(e){return parseInt(e,10)})).sort((function(e,t){return e-t})).forEach((function(e){r[e].sort((function(e,t){return t.value-e.value})).forEach((function(e){var t=20*o;n.engineService.setObjectLayer(e.nodeId,t),n.graphService.setState(i,e.nodeId,{layer:t}),o++}))})),e.patchState({viewGraph:Object.assign({},i)})}},{key:"resetObjectLayers",value:function(e,t){var n=this,i=e.getState().viewGraph;Human.scene.getEnabledLeaves().forEach((function(e){n.engineService.setObjectLayer(e,0),n.graphService.setState(i,e,{layer:0})})),e.patchState({viewGraph:Object.assign({},i)})}},{key:"setPostProcessingEffects",value:function(e,t){var n=t.effects;this.engineService.setPostProcessingFeatures(n)}},{key:"setProperties",value:function(e,t){var n=t.properties;this.engineService.setProperties(Object.assign({},n))}},{key:"setTransparencyMode",value:function(e,t){var n=t.mode;this.engineService.setTransparencyMode(n)}},{key:"expandNode",value:function(e,t){var n=this.store.selectSnapshot(_a.getViewGraph);ye.getAncestors(n,t.node.id,!0).forEach((function(e){n.nodes[e].boolState.expanded=!0})),this.store.dispatch(new De(n))}},{key:"collapseNode",value:function(e,t){var n=this.store.selectSnapshot(_a.getViewGraph);n.nodes[t.node.id].boolState.expanded=!1,this.store.dispatch(new De(n))}},{key:"hoverNode",value:function(e,t){e.patchState({hoveredNode:t.node})}},{key:"setLabelEditNode",value:function(e,t){e.patchState({labelEditNode:t.node})}},{key:"queryNodeInfo",value:function(e,t){var n=t.node;e.patchState({queryingWiki:!0}),this.wikiService.getWikiText(n.label).pipe(Object(ae.a)((function(){return e.patchState({queryingWiki:!1})}))).subscribe((function(t){return e.dispatch(new yt(n,t))}),(function(){return e.dispatch(new xt(n))}))}},{key:"queryNodeInfoSuccess",value:function(e,t){var n=t.node,i=t.description;e.dispatch(new vt(n,i))}},{key:"setNodeInfo",value:function(e,t){var n=t.node,i=t.description,o=this.store.selectSnapshot(_a.getViewGraph),a=o.nodes[n.id];a&&(a.description=i,this.store.dispatch(new De(o)))}},{key:"setContextMenu",value:function(e,t){e.patchState({contextmenu:{node:t.node,hit:t.hit}})}},{key:"stateMapToNodeIds",value:function(e,t){var n=this,i=Object.keys(t).map((function(t){return n.engineService.getNode(e,t)})).filter((function(e){return!!e})).map((function(e){return e.id}));return new Set(i)}}],[{key:"getEngine",value:function(e){return e.engine}},{key:"getReady",value:function(e){return e.ready}},{key:"getDisplay",value:function(e){return e.display}},{key:"getScrollMode",value:function(e){return e.scrollMode}},{key:"getVisible",value:function(e){return e.visible}},{key:"getViewGraph",value:function(e){return e.viewGraph}},{key:"getViewGraphNode",value:function(e){return function(t){return e.viewGraph.nodes[t]}}},{key:"getEnginePosition",value:function(e){return e.enginePosition}},{key:"getChapter",value:function(e){return e.chapter}},{key:"getActiveTool",value:function(e){return e.activeTool}},{key:"getShowCameraBar",value:function(e){return e.showCameraBar}},{key:"getShowProgressBar",value:function(e){return e.showProgressBar}},{key:"getShowLabels",value:function(e){return e.showLabels}},{key:"getChapterInit",value:function(e){return e.chapterInit}},{key:"getAnimationPlaying",value:function(e){return e.animationPlaying}},{key:"getPlayAudio",value:function(e){return e.playAudio}},{key:"getAutoplay",value:function(e){return e.autoplay}},{key:"getXrayModeEnabled",value:function(e){return e.xrayModeEnabled}},{key:"getHoveredNode",value:function(e){return e.hoveredNode}},{key:"getLabelEditNode",value:function(e){return e.labelEditNode}},{key:"getQuerying",value:function(e){return e.queryingWiki}},{key:"getContextmenu",value:function(e){return e.contextmenu}},{key:"getPlaybackSpeed",value:function(e){return e.playbackSpeed}}]),e}()).\u0275fac=function(e){return new(e||ja)(_.Zb(L.g),_.Zb(St),_.Zb(Nt),_.Zb(Va),_.Zb(xa))},ja.\u0275prov=_.Lb({token:ja,factory:ja.\u0275fac}),Ha([Object(L.a)(_e),Ba("design:type",Function),Ba("design:paramtypes",[Object,_e]),Ba("design:returntype",void 0)],ja.prototype,"load",null),Ha([Object(L.a)(je),Ba("design:type",Function),Ba("design:paramtypes",[Object,je]),Ba("design:returntype",void 0)],ja.prototype,"loadSuccess",null),Ha([Object(L.a)(Pe),Ba("design:type",Function),Ba("design:paramtypes",[Object,Pe]),Ba("design:returntype",void 0)],ja.prototype,"setReady",null),Ha([Object(L.a)(Me),Ba("design:type",Function),Ba("design:paramtypes",[Object,Me]),Ba("design:returntype",void 0)],ja.prototype,"setDisplay",null),Ha([Object(L.a)(Ie),Ba("design:type",Function),Ba("design:paramtypes",[Object,Ie]),Ba("design:returntype",void 0)],ja.prototype,"setZoomViaScrollAllowed",null),Ha([Object(L.a)(Te),Ba("design:type",Function),Ba("design:paramtypes",[Object,Te]),Ba("design:returntype",void 0)],ja.prototype,"setVisible",null),Ha([Object(L.a)(st),Ba("design:type",Function),Ba("design:paramtypes",[Object,st]),Ba("design:returntype",void 0)],ja.prototype,"setEnginePosition",null),Ha([Object(L.a)(lt),Ba("design:type",Function),Ba("design:paramtypes",[Object,lt]),Ba("design:returntype",void 0)],ja.prototype,"resetEnginePosition",null),Ha([Object(L.a)(Ae),Ba("design:type",Function),Ba("design:paramtypes",[Object,Ae]),Ba("design:returntype",void 0)],ja.prototype,"setChapter",null),Ha([Object(L.a)(Re),Ba("design:type",Function),Ba("design:paramtypes",[Object,Re]),Ba("design:returntype",void 0)],ja.prototype,"setChapterInit",null),Ha([Object(L.a)(Ze),Ba("design:type",Function),Ba("design:paramtypes",[Object,Ze]),Ba("design:returntype",void 0)],ja.prototype,"setActiveTool",null),Ha([Object(L.a)(De),Ba("design:type",Function),Ba("design:paramtypes",[Object,De]),Ba("design:returntype",void 0)],ja.prototype,"setGraph",null),Ha([Object(L.a)(Ee),Ba("design:type",Function),Ba("design:paramtypes",[Object,De]),Ba("design:returntype",void 0)],ja.prototype,"clearGraph",null),Ha([Object(L.a)(Fe),Ba("design:type",Function),Ba("design:paramtypes",[Object,Fe]),Ba("design:returntype",void 0)],ja.prototype,"setXrayMode",null),Ha([Object(L.a)(Be),Ba("design:type",Function),Ba("design:paramtypes",[Object,Be]),Ba("design:returntype",void 0)],ja.prototype,"centerCameraOnVisible",null),Ha([Object(L.a)(Ke),Ba("design:type",Function),Ba("design:paramtypes",[Object,Ke]),Ba("design:returntype",void 0)],ja.prototype,"toggleProgressBar",null),Ha([Object(L.a)($e),Ba("design:type",Function),Ba("design:paramtypes",[Object,$e]),Ba("design:returntype",void 0)],ja.prototype,"toggleCameraBar",null),Ha([Object(L.a)(Ge),Ba("design:type",Function),Ba("design:paramtypes",[Object,Ge]),Ba("design:returntype",void 0)],ja.prototype,"toggleLabels",null),Ha([Object(L.a)(Qe),Ba("design:type",Function),Ba("design:paramtypes",[Object,Qe]),Ba("design:returntype",void 0)],ja.prototype,"synchronizeVisibleNodes",null),Ha([Object(L.a)(qe),Ba("design:type",Function),Ba("design:paramtypes",[Object,qe]),Ba("design:returntype",void 0)],ja.prototype,"synchronizeRenderableNodes",null),Ha([Object(L.a)(We),Ba("design:type",Function),Ba("design:paramtypes",[Object,We]),Ba("design:returntype",void 0)],ja.prototype,"synchronizePickableNodes",null),Ha([Object(L.a)(Je),Ba("design:type",Function),Ba("design:paramtypes",[Object,Je]),Ba("design:returntype",void 0)],ja.prototype,"playChapterAnimation",null),Ha([Object(L.a)(Xe),Ba("design:type",Function),Ba("design:paramtypes",[Object,Xe]),Ba("design:returntype",void 0)],ja.prototype,"toggleAnimation",null),Ha([Object(L.a)(Ye),Ba("design:type",Function),Ba("design:paramtypes",[Object,Ye]),Ba("design:returntype",void 0)],ja.prototype,"setAnimationPlaying",null),Ha([Object(L.a)(et),Ba("design:type",Function),Ba("design:paramtypes",[Object,et]),Ba("design:returntype",void 0)],ja.prototype,"setPlaybackSpeed",null),Ha([Object(L.a)(tt),Ba("design:type",Function),Ba("design:paramtypes",[Object,tt]),Ba("design:returntype",void 0)],ja.prototype,"playAudio",null),Ha([Object(L.a)(it),Ba("design:type",Function),Ba("design:paramtypes",[Object,it]),Ba("design:returntype",void 0)],ja.prototype,"setAutoplay",null),Ha([Object(L.a)(ot),Ba("design:type",Function),Ba("design:paramtypes",[Object,ot]),Ba("design:returntype",void 0)],ja.prototype,"setObjectLayerOrder",null),Ha([Object(L.a)(at),Ba("design:type",Function),Ba("design:paramtypes",[Object,at]),Ba("design:returntype",void 0)],ja.prototype,"setObjectDisplayName",null),Ha([Object(L.a)(rt),Ba("design:type",Function),Ba("design:paramtypes",[Object,rt]),Ba("design:returntype",void 0)],ja.prototype,"autoSortObjectLayers",null),Ha([Object(L.a)(ct),Ba("design:type",Function),Ba("design:paramtypes",[Object,ct]),Ba("design:returntype",void 0)],ja.prototype,"resetObjectLayers",null),Ha([Object(L.a)(pt),Ba("design:type",Function),Ba("design:paramtypes",[Object,pt]),Ba("design:returntype",void 0)],ja.prototype,"setPostProcessingEffects",null),Ha([Object(L.a)(ut),Ba("design:type",Function),Ba("design:paramtypes",[Object,ut]),Ba("design:returntype",void 0)],ja.prototype,"setProperties",null),Ha([Object(L.a)(dt),Ba("design:type",Function),Ba("design:paramtypes",[Object,dt]),Ba("design:returntype",void 0)],ja.prototype,"setTransparencyMode",null),Ha([Object(L.a)(gt),Ba("design:type",Function),Ba("design:paramtypes",[Object,gt]),Ba("design:returntype",void 0)],ja.prototype,"expandNode",null),Ha([Object(L.a)(ht),Ba("design:type",Function),Ba("design:paramtypes",[Object,ht]),Ba("design:returntype",void 0)],ja.prototype,"collapseNode",null),Ha([Object(L.a)(ft),Ba("design:type",Function),Ba("design:paramtypes",[Object,ft]),Ba("design:returntype",void 0)],ja.prototype,"hoverNode",null),Ha([Object(L.a)(bt),Ba("design:type",Function),Ba("design:paramtypes",[Object,bt]),Ba("design:returntype",void 0)],ja.prototype,"setLabelEditNode",null),Ha([Object(L.a)(mt),Ba("design:type",Function),Ba("design:paramtypes",[Object,mt]),Ba("design:returntype",void 0)],ja.prototype,"queryNodeInfo",null),Ha([Object(L.a)(yt),Ba("design:type",Function),Ba("design:paramtypes",[Object,yt]),Ba("design:returntype",void 0)],ja.prototype,"queryNodeInfoSuccess",null),Ha([Object(L.a)(vt),Ba("design:type",Function),Ba("design:paramtypes",[Object,vt]),Ba("design:returntype",void 0)],ja.prototype,"setNodeInfo",null),Ha([Object(L.a)(Ve),Ba("design:type",Function),Ba("design:paramtypes",[Object,Ve]),Ba("design:returntype",void 0)],ja.prototype,"setContextMenu",null),Ha([Object(L.e)(),Ba("design:type",Function),Ba("design:paramtypes",[wt]),Ba("design:returntype",void 0)],ja,"getEngine",null),Ha([Object(L.e)(),Ba("design:type",Function),Ba("design:paramtypes",[wt]),Ba("design:returntype",void 0)],ja,"getReady",null),Ha([Object(L.e)(),Ba("design:type",Function),Ba("design:paramtypes",[wt]),Ba("design:returntype",void 0)],ja,"getDisplay",null),Ha([Object(L.e)(),Ba("design:type",Function),Ba("design:paramtypes",[wt]),Ba("design:returntype",void 0)],ja,"getScrollMode",null),Ha([Object(L.e)(),Ba("design:type",Function),Ba("design:paramtypes",[wt]),Ba("design:returntype",void 0)],ja,"getVisible",null),Ha([Object(L.e)(),Ba("design:type",Function),Ba("design:paramtypes",[wt]),Ba("design:returntype",void 0)],ja,"getViewGraph",null),Ha([Object(L.e)(),Ba("design:type",Function),Ba("design:paramtypes",[wt]),Ba("design:returntype",void 0)],ja,"getViewGraphNode",null),Ha([Object(L.e)(),Ba("design:type",Function),Ba("design:paramtypes",[wt]),Ba("design:returntype",void 0)],ja,"getEnginePosition",null),Ha([Object(L.e)(),Ba("design:type",Function),Ba("design:paramtypes",[wt]),Ba("design:returntype",void 0)],ja,"getChapter",null),Ha([Object(L.e)(),Ba("design:type",Function),Ba("design:paramtypes",[wt]),Ba("design:returntype",void 0)],ja,"getActiveTool",null),Ha([Object(L.e)(),Ba("design:type",Function),Ba("design:paramtypes",[wt]),Ba("design:returntype",void 0)],ja,"getShowCameraBar",null),Ha([Object(L.e)(),Ba("design:type",Function),Ba("design:paramtypes",[wt]),Ba("design:returntype",void 0)],ja,"getShowProgressBar",null),Ha([Object(L.e)(),Ba("design:type",Function),Ba("design:paramtypes",[wt]),Ba("design:returntype",void 0)],ja,"getShowLabels",null),Ha([Object(L.e)(),Ba("design:type",Function),Ba("design:paramtypes",[wt]),Ba("design:returntype",void 0)],ja,"getChapterInit",null),Ha([Object(L.e)(),Ba("design:type",Function),Ba("design:paramtypes",[wt]),Ba("design:returntype",void 0)],ja,"getAnimationPlaying",null),Ha([Object(L.e)(),Ba("design:type",Function),Ba("design:paramtypes",[wt]),Ba("design:returntype",void 0)],ja,"getPlayAudio",null),Ha([Object(L.e)(),Ba("design:type",Function),Ba("design:paramtypes",[wt]),Ba("design:returntype",void 0)],ja,"getAutoplay",null),Ha([Object(L.e)(),Ba("design:type",Function),Ba("design:paramtypes",[wt]),Ba("design:returntype",void 0)],ja,"getXrayModeEnabled",null),Ha([Object(L.e)(),Ba("design:type",Function),Ba("design:paramtypes",[wt]),Ba("design:returntype",void 0)],ja,"getHoveredNode",null),Ha([Object(L.e)(),Ba("design:type",Function),Ba("design:paramtypes",[wt]),Ba("design:returntype",void 0)],ja,"getLabelEditNode",null),Ha([Object(L.e)(),Ba("design:type",Function),Ba("design:paramtypes",[wt]),Ba("design:returntype",void 0)],ja,"getQuerying",null),Ha([Object(L.e)(),Ba("design:type",Function),Ba("design:paramtypes",[wt]),Ba("design:returntype",void 0)],ja,"getContextmenu",null),Ha([Object(L.e)(),Ba("design:type",Function),Ba("design:paramtypes",[wt]),Ba("design:returntype",void 0)],ja,"getPlaybackSpeed",null),ja=_a=Ha([Object(L.f)({name:"engine",defaults:{loading:!1,ready:!1,viewGraph:{nodes:{},successors:{},predecessors:{},roots:{}},hoveredNode:void 0,labelEditNode:void 0,queryingWiki:!1,engine:"",chapter:"",chapterInit:{id:"",init:!1,camera:!1,annotations:!1,graph:!1,properties:!1,particles:!1,clips:!1,postprocessing:!1,transparency:!1},showProgressBar:!0,showCameraBar:!0,showLabels:!0,activeTool:Aa.Select,animationPlaying:!0,autoplay:!0,playAudio:!1,display:!0,visible:!0,scrollMode:Ra.Capture,playbackSpeed:1,xrayModeEnabled:!1,contextmenu:{node:null,hit:null}},children:[Fa]})],ja)),Wa=h("2Vo4"),$a=h("VRyK"),Ka=h("itXk"),Ga=h("xgIS"),Za=h("Kj3r"),Ja=h("/uUt"),Xa=h("OsX3"),Ya=h("3UWI"),er=h("Zy1z"),tr=function e(){m(this,e)},nr=function e(){m(this,e)},ir=function e(){m(this,e)},or=h("ofXK"),ar=h("2Yyj"),rr=h.n(ar),cr=h("Kd/A"),sr=h.n(cr),lr=h("Hfs6"),pr=h.n(lr),ur=h("VLs4"),dr=h.n(ur),gr=h("1IWC"),hr=h.n(gr),fr=h("Paii"),br=h.n(fr),vr=h("vT00"),mr={title:"English",lang:"en",country:"us",id:"en-US"},yr=[mr,{title:"Espa\xf1ol",lang:"es",country:"es",id:"es-ES"},{title:"\u4e2d\u6587(\u7b80\u4f53)",lang:"zh",country:"cn",id:"zh-CN"},{title:"Fran\xe7ais",lang:"fr",country:"fr",id:"fr-FR"},{title:"Deutsch",lang:"de",country:"de",id:"de-DE"},{title:"Italiano",lang:"it",country:"it",id:"it-IT"},{title:"\u65e5\u672c\u8a9e",lang:"ja",country:"ja",id:"ja"},{title:"Portugu\xeas",lang:"pt",country:"pt",id:"pt-PT"}];function xr(){var e="";try{e=localStorage.getItem("locale")}catch(t){}return(yr.find((function(t){return t.id===e}))||mr).id}[rr.a,sr.a,pr.a,dr.a,hr.a,br.a,h.n(vr).a].forEach((function(e){Object(or.x)(e)}));var wr,kr,Or,Cr=((Or=function(){function e(){m(this,e)}return v(e,null,[{key:"forRoot",value:function(){return{ngModule:e,providers:[{provide:_.w,useFactory:xr}]}}}]),e}()).\u0275mod=_.Nb({type:Or}),Or.\u0275inj=_.Mb({factory:function(e){return new(e||Or)},imports:[[or.c]]}),Or),Sr=((kr=function e(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:mr.lang,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];m(this,e),this.id=t,this.type=n,this.lang=i,this.preview=o}).type="[Story] Load Current Story",kr),_r=function(){var e=function e(t){m(this,e),this.story=t};return e.type="[Story] Replace the Story",e}(),jr=function(){var e=function e(t){m(this,e),this.id=t};return e.type="[Story] Set the Story ID",e}(),Pr=function(){var e=function e(t){m(this,e),this.displayName=t};return e.type="[Story] Set Story Text",e}(),Mr=function(){var e=function e(t){m(this,e),this.tags=t};return e.type="[Story] Set Story Tags",e}(),Ir=function(){var e=function e(t,n,i){m(this,e),this.id=t,this.type=n,this.reset=i};return e.type="[Story] Set Incoming Story Id",e}(),zr=function(){var e=function e(){m(this,e)};return e.type="[Story] Load Story Chunk",e}(),Tr=function(){var e=function e(t){m(this,e),this.chapterId=t};return e.type="[Story] Reorder Load Chunks",e}(),Ur=function(){var e=function e(t){m(this,e),this.chunk=t};return e.type="[Story] Load Story Chunk Success",e}(),Lr=function(){var e=function e(t,n,i,o){m(this,e),this.id=t,this.story=n,this.type=i,this.chapterIdx=o};return e.type="[Story] Build Story In Engine From Story Model",e}(),Dr=function(){var e=function e(t,n,i){m(this,e),this.story=t,this.id=n,this.type=i};return e.type="[Story] Load Success",e}(),Er=function(){var e=function e(t,n){m(this,e),this.id=t,this.type=n};return e.type="[Story] Load Fail",e}(),Fr=((wr=function e(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:mr.lang;m(this,e),this.id=t,this.type=n,this.lang=i}).type="[Story] Import",wr),Ar=function(){var e=function e(t,n,i){m(this,e),this.story=t,this.id=n,this.type=i};return e.type="[Story] Import Success",e}(),Rr=function(){var e=function e(){m(this,e)};return e.type="[Story] Clear",e}(),Nr=function(){var e=function e(){m(this,e)};return e.type="[Story] Synchronize Chapters",e}(),Vr=function(){var e=function e(){m(this,e)};return e.type="[Story] Human Ready (Web)",e}(),Hr=function(){var e=function e(){m(this,e)};return e.type="[Story] Human Ready (SDK)",e}(),Br=h("cp0P"),Qr=function e(){m(this,e)};function qr(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return function(){return new Promise((function(t){e.apply(void 0,n.concat([function(){t()}]))}))}}var Wr,$r,Kr,Gr,Zr,Jr=((Wr=function(){function e(){m(this,e)}return v(e,[{key:"getOnlyText",value:function(e){return e.map((function(e){switch(e.type){case ro.Markdown:return e.markdown}})).join("")}}]),e}()).\u0275fac=function(e){return new(e||Wr)},Wr.\u0275prov=_.Lb({token:Wr,factory:Wr.\u0275fac,providedIn:"root"}),Wr),Xr=["reflections","lights"],Yr=["material","geometry","transform"],ec=["tweens","morph"],tc=(($r=function(){function e(t,n,i,o){m(this,e),this.http=t,this.engineService=n,this.chapterService=i,this.contentBlocksService=o}return v(e,[{key:"getShownObjectsFromChapter",value:function(e){var t=[];return Object.entries(e.synchronization).forEach((function(e){var n=u(e,2),i=n[0];n[1].shown&&t.push(i)})),t}},{key:"getChapterLoadChunks",value:function(e,t,n){var i=this.getShownObjectsFromChapter(t),o=new nr;return o.activate=!1,o.chapterId=t.id,o.objects=i,o.storyId=e,o.assetTypes=[].concat(Yr,ec,Xr),o.readyState={model:!0,animation:!0},[o]}},{key:"getOnDemandLoadChunks",value:function(e,t){var n=this,i=[];return Human.timeline.rootTimelines[e]._chapters.forEach((function(o){var a=n.getChapterLoadChunks(e,o,t);i=o.id===t.targetChapterId?[].concat(s(a),s(i)):[].concat(s(i),s(a))})),i}},{key:"getChapterIndex",value:function(e,t){return Human.timeline.rootTimelines[e]?Human.timeline.rootTimelines[e]._chapters.findIndex((function(e){return e.id===t})):-1}},{key:"getStory",value:function(e,t){var n,i=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"en",a=t===P.Bookmark?this.getBookmark(e):this.getContent(e);return"en"===o?a:a.pipe(Object(oa.a)((function(a){return n=a,i.getStoryTranslation(e,t,o)}))).pipe(Object(K.a)((function(e){return i.translateStory(n,e)})),Object(G.a)((function(){return a})))}},{key:"getContentRoot",value:function(){return!0===z.offline?"undefined"==typeof localBaseDirectory?"":localBaseDirectory:"/"}},{key:"getContent",value:function(e){return this.http.get(this.getContentRoot()+"content/modules/".concat(e,".json")).pipe(Object(K.a)((function(e){return e})))}},{key:"getBookmark",value:function(e){return this.http.get("/search/bookmarks/data",{params:{be:e}}).pipe(Object(K.a)((function(e){return e.bookmark})))}},{key:"getLoadConfig",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=new ir;return n.chapterAssetBundle=!0,n.targetChapterId=Human.timeline.rootTimelines[e]._chapters[t].id,n.targetChapterConfig={global:{clipping:!0,graph:!0,camera:!0,properties:!0,transparencyMode:!0,postprocess:!0},static:{labels:!0},dynamic:{timeline:!0,particles:!0}},n.sortBy="chapter",n}},{key:"buildStory",value:function(e,t,n){Human.events.fire("modules.fetch.start",e),Human.modules.moduleData[e]=t;var i=Object.assign({},t);return i.moduleId=e,new he.a((function(t){Human.modules.create(e,i,(function(){Human.modules.load(e,Object.values(Human.scene.rootObjects),[].concat(Xr),(function(){Human.modules.activate(e,0,{},(function(){t.next(!0),t.complete()}))}))}))}))}},{key:"getStoryChapters",value:function(e,t){var n=this,i=Human.modules.moduleData[e];return Human.timeline.rootTimelines[e]._chapters.map((function(e,o){return n.chapterService.fromHumanChapter(i,t,e,o)}))}},{key:"getStoryLoadChunks",value:function(e,t){return this.getOnDemandLoadChunks(e,t).map((function(e){return Object.assign(Object.assign({},e),{chunkId:Ut.idWithPrefix("chunk")})}))}},{key:"loadStoryChunk",value:function(e,t){var n=e.objects.map((function(e){return Human.scene.objects[e]}));e.storyId?Human.modules.load(e.storyId,n,e.assetTypes,(function(){t()})):this.engineService.loadGraphObject(e.objects[0]).subscribe((function(){t()}))}},{key:"unloadStory",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=(e?[e]:Object.keys(Human.modules.modules)).map((function(e){return t.hardDeleteStory(e,n)}));return new he.a((function(e){i.length?Object(Br.a)(i).subscribe((function(){e.next(!0),e.complete()})):(e.next(!0),e.complete())}))}},{key:"createLoadObjectChunk",value:function(e){var t=new nr;return t.assetTypes=[].concat(Yr,ec),t.objects=[e],t}},{key:"hardDeleteStory",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=(e in Human.modules.modules?Human.modules.modules[e].sceneGraph:[]).map((function(e){return Human.scene.objects[e.objectId]})).filter((function(e){return!!e})),i=Object(Oe.flatten)(n.map((function(e){return e.getLeafObjects()}))),o=qr(Human.modules.deactivate,e,{}),a=qr(Human.modules.unload,e,i,["geometries","morphs","reflections","tweens","lights","materials","transforms"]),r=qr(Human.modules.destroy,e);return new he.a((function(n){(Human.timeline.activeRoot&&Human.timeline.activeRoot.id===e?o():Promise.resolve({})).then((function(){return t?a():Promise.resolve({})})).then((function(){return r()})).then((function(){return n.next(),void n.complete()}))}))}},{key:"getStoryTranslation",value:function(e,t,n){return this.http.get(t===P.Bookmark?"/search/bookmarks/tr/".concat(n,"/").concat(e):"/tr/".concat(n,"/").concat(e,".json")).pipe(Object(K.a)((function(e){return Object(Y.plainToClass)(Qr,e)})))}},{key:"getStoryType",value:function(e){return e.indexOf("/")>=0?P.Module:P.Bookmark}},{key:"translateStory",value:function(e,t){var n=this,i=e.chapters||[],o=e.sceneGraph||[],a=t.objects||{},r=t.chapters||[];return e.displayName=t.displayName||e.displayName,e.description=t.description||e.description,o.forEach((function(e){(e.objects||[]).forEach((function(e){n.translateObject(e,a)}))})),i.forEach((function(e,t){var i=r[t];if(i){n.translateMetaInfo(e,i);var o=i.annotations||[];(e.annotations||[]).forEach((function(e,t){var i=o[t];i&&n.translateMetaInfo(e,i)}));var a=i.hotspots||[];(e.hotspots||[]).forEach((function(e,t){var i=a[t];i&&n.translateMetaInfo(e,i)}))}})),e}},{key:"translateMetaInfo",value:function(e,t){var n=t.title,i=t.description;e.hasOwnProperty("displayName")&&(e.displayName=n),e.hasOwnProperty("title")&&(e.title=n),e.hasOwnProperty("description")&&(e.description=i)}},{key:"translateObject",value:function(e,t){var n=this,i=t[e.objectId];i&&(e.displayName=i);var o=e.objects;o&&o.forEach((function(e){n.translateObject(e,t)}))}},{key:"exportWrittenContent",value:function(e,t,n){var i=[];return i.push("\n".concat(e.displayName,"\n    ")),t.forEach((function(e,t){i.push("\n---\n\n# Chapter ".concat(t+1,": ").concat(e.info.displayName||"-No Title-","\n\n").concat(e.info.description||"-No Description-","\n      ")),e.legend.length&&(i.push("\n## Legend\n"),e.legend.forEach((function(e){i.push("\n* ".concat(e.label," (").concat(ba.rgbToHex(e.colors,!0),")\n"))})));var o=n.filter((function(t){return t.chapterId===e.id}));o.length&&(i.push("\n## Labels\n"),o.forEach((function(e){i.push("\n* ".concat(e.title,"\n")),e.description&&i.push("\n  > ".concat(e.description,"\n"))})))})),i.join("")}},{key:"exportQuizKey",value:function(e){var t=this,n=[];return e.forEach((function(e,i){switch(n.push("\n# QUESTION ".concat(i+1," (").concat(so[e.type],")\n\n## PROMPT\n").concat(t.contentBlocksService.getOnlyText(e.questionPrompt),"\n      ")),e.type){case co.MultipleChoice:e.data.options.forEach((function(t,i){n.push("\n## ANSWER ".concat(i+1," ").concat(e.data.correctAnswer===t.value?"- CORRECT":"","\n").concat(t.label,"\n            "))}));break;case co.SelectAnatomy:n.push("\n## ANSWERS\n          "),e.data.correctAnswer.forEach((function(e,t){n.push("\n".concat(e,"\n            "))}));break;case co.LabelAnatomy:e.data.options.forEach((function(e,t){n.push("\n## ANSWER ".concat(t+1,"\n").concat(e.label.title,"\n            "))}))}t.contentBlocksService.getOnlyText(e.explanation).length&&n.push("\n  \n## EXPLANATION\n".concat(t.contentBlocksService.getOnlyText(e.explanation),"\n        ")),n.push("\n\n\n      ")})),n.join("")}}]),e}()).\u0275fac=function(e){return new(e||$r)(_.Zb(W.b),_.Zb(Nt),_.Zb(Do),_.Zb(Jr))},$r.\u0275prov=_.Lb({token:$r,factory:$r.\u0275fac,providedIn:"root"}),$r);function nc(e,t,n){var i=function(e,t){var n,i={},o=c(e);try{for(o.s();!(n=o.n()).done;)for(var a=n.value,r=Object.keys(t[a]),s=0,l=r;s<l.length;s++){i[l[s]]=!1}}catch(p){o.e(p)}finally{o.f()}return i}(t,n);return e.map((function(e){return Object.assign(Object.assign({},e),{showObjects:Object.assign(Object.assign({},e.showObjects),i),selectObjects:Object.assign(Object.assign({},e.selectObjects),i),pickThroughObjects:Object.assign(Object.assign({},e.pickThroughObjects),i)})}))}function ic(e){return e.split("/").length>1?P.Module:P.Bookmark}function oc(e,t){return e.map((function(e){if(!Object(Oe.isEmpty)(e.lights))return e;var n={libraries:s(t),lights:[]};return Object.assign(Object.assign({},e),{lights:n})}))}function ac(e,t){return e.customData&&e.customData.particleSystems?e.customData.particleSystems.reduce((function(e,n){var i=Ti.getParticleIdRoot(n.id);return e[i]=Ti.generateParticleId(i,t),e}),{}):{}}function rc(e,t){return e.customData&&e.customData.particleSystems?e.customData.particleSystems.map((function(e){var n=Ti.getParticleIdRoot(e.id);return Object.assign(Object.assign({},e),{id:t[n]})})):[]}function cc(e,t){return e.map((function(e){return e.customData&&e.customData.particleSystems&&(e.customData.particleSystems=e.customData.particleSystems.map((function(e){return t[Ti.getParticleIdRoot(e)]}))),e}))}function sc(e,t){return e.map((function(e){return e.id})).reduce((function(n,i){return e.some((function(e){return e.id===i&&Object(Oe.get)(e,"customData.particleSystems",[]).length>0}))&&(n[i]=t),n}),{})}(Kr||(Kr={})).generateThumbnailUrls=function(e){return e.reduce((function(e,t){var n=t.originalChapterId,i=t.newChapterId,o=t.originalStoryId,a="/thumbs/".concat(P.Bookmark===ic(o)?"bookmarks":"modules","/").concat(o.replace(".json","")),r=new ha;return r.storyId=o,r.chapterId=n,r.urls={small:"".concat(a,"/small/chapters/").concat(n,".jpg"),large:"".concat(a,"/large/chapters/").concat(n,".jpg")},e.set(i,r),e}),new Map)};var lc=function e(){m(this,e)},pc=function e(){m(this,e)},uc=function e(){m(this,e)};function dc(e,t){return{showObjects:Object(Oe.mapKeys)(e.showObjects,(function(e,n){return Zr.renamespaceValue(n,t)})),selectObjects:Object(Oe.mapKeys)(e.selectObjects,(function(e,n){return Zr.renamespaceValue(n,t)})),pickThroughObjects:Object(Oe.mapKeys)(e.pickThroughObjects,(function(e,n){return Zr.renamespaceValue(n,t)})),synchronization:Object(Oe.mapKeys)(e.synchronization,(function(e,n){return Zr.renamespaceValue(n,t)}))}}function gc(e,t){return(e||[]).map((function(e){return Object.assign(Object.assign({},e),{objectId:Zr.renamespaceValue(e.objectId,t),states:e.states.map((function(e){return Object.assign(Object.assign({},e),{errands:(n=e.errands,n.map((function(e){return e.type===fi.flyToChapter||e.type===fi.flyToObject?Object.assign(Object.assign({},e),{value:Zr.renamespaceValue(e.value,t)}):e})))});var n}))})}))}function hc(e,t){return(e||[]).map((function(e){return e.data.timeline=t[e.data.timeline]||e.data.timeline,e}))}function fc(e,t){return(e||[]).map((function(e){return e.objectId&&(e.objectId=Zr.renamespaceValue(e.objectId,t)),e}))}function bc(e,t){return e?{xray:Object(Oe.mapKeys)(e.xray,(function(e,n){return Zr.renamespaceValue(n,t)})),highlight:Object(Oe.mapKeys)(e.highlight,(function(e,n){return Zr.renamespaceValue(n,t)}))}:{}}function vc(e,t){var n=function(e,t){return"string"==typeof e?[t[e]||e]:e.map((function(e){return t[e]||e}))}(e.stateId,t),i=e.assetLibraries.tweens.map((function(e){return Zr.renamespaceValue(e,t)})),o=e.assetLibraries.reflections.map((function(e){return Zr.renamespaceValue(e,t)})),a=Object(Oe.mapValues)(e.reflections,(function(e,n){return Zr.renamespaceValue(e,t)})),r=function(e,t){return e.map((function(e){return Object.assign(Object.assign(Object.assign({},e),dc(e,t)),{colorRecipeObjects:bc(e.colorRecipeObjects,t),timelineMap:hc(e.timelineMap,t),labels:gc(e.labels,t),hotspots:fc(e.hotspots,t)})}))}(e.chapters,t),s=function e(t,n){var i,o=c(t);try{var a=function(){var t=i.value;["objectId","displayName","geometryId","morphId","materialId"].forEach((function(e){t[e]&&(t[e]=Zr.renamespaceValue(t[e],n))})),e(t.objects||[],n)};for(o.s();!(i=o.n()).done;)a()}catch(r){o.e(r)}finally{o.f()}return t}(e.sceneGraph,t);return Object.assign(Object.assign(Object.assign(Object.assign({},e),{stateId:n}),dc(e,t)),{assetLibraries:Object.assign(Object.assign({},e.assetLibraries),{tweens:i,reflections:o}),reflections:a,chapters:r,sceneGraph:s})}!function(e){function t(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;["x","y","z"].forEach((function(n){void 0!==e[n]&&Math.abs(e[n]-t)<1e-4&&delete e[n]}))}function n(e){["translate","rotate","pivot"].forEach((function(n){void 0!==e[n]&&(t(e[n]),0===Object.keys(e[n]).length&&delete e[n])})),void 0!==e.scale&&(t(e.scale,1),0===Object.keys(e.scale).length&&delete e.scale)}function i(e,t){["backfaces","displayName","layer"].forEach((function(n){e[n]&&(t[n]=e[n])}))}function o(e,t){var i=new pc;i.translate=JSON.parse(JSON.stringify(e.translate)),i.rotate=JSON.parse(JSON.stringify(e.rotate)),i.scale=JSON.parse(JSON.stringify(e.scale)),i.pivot=JSON.parse(JSON.stringify(e.pivot)),n(i),Object.entries(i).forEach((function(e){var n=u(e,2),i=n[0],o=n[1];t[i]=JSON.parse(JSON.stringify(o))})),t.transformId&&delete t.transformId}function a(e,t){var n=["geometryId","morphId","materialId"],i=[];return e.renderables&&e.renderables.forEach((function(e){var t=new lc;n.forEach((function(n){e[n]&&(t[n]=e[n])})),e.layer&&(t.layer=e.layer),i.push(t)})),1===i.length?t=Object.assign(Object.assign({},t),i[0]):i.length>1&&(t.renderables=i),t}e.filterTransformProperties=n,e.serializeObjectProperties=i,e.serializeTransformData=o,e.serializeRenderables=a,e.serializeHumanObject=function e(t,n){if(n[t.objectId])return null;var r=new uc;return r.objectId=t.objectId,i(t,r),t.transformId?r.transformId=t.transformId:o(t,r),r=a(t,r),t.objects&&t.objects.length&&(r.objects=[]),t.objects.forEach((function(t){var i=e(t,n);null!==i&&r.objects.push(i)}),this),r}}(Gr||(Gr={})),function(e){function t(e,t){var n=Object.entries(t);return n.sort((function(e,t){return e[0].length===t[0].length?0:e[0].length<t[0].length?1:-1})),n.reduce((function(e,t){var n=u(t,2),i=n[0],o=n[1];if(e.startsWith(i)){var a=new RegExp("^"+i);e=e.replace(a,o)}return e}),e||"")}e.renamespaceValue=t,e.renamespaceKeys=function(e,n){return Object.entries(e).reduce((function(e,i){var o=u(i,2),a=o[0],r=o[1];return e[t(a,n)]=r,e}),{})},e.renamespaceAssetLibrary=function(e,n,i){if(!i)return e;var o=e.tweens.map((function(e){return t(e,n)})),a=e.reflections.map((function(e){return t(e,n)}));return Object.assign(Object.assign({},e),{tweens:o,reflections:a})},e.renamespaceReflections=function(e,n,i){return i?Object(Oe.mapValues)(e,(function(e){return t(e,n)})):e}}(Zr||(Zr={}));var mc,yc,xc,wc,kc,Oc,Cc=function e(){m(this,e)},Sc=function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r},_c=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},jc={enableContextLabel:{enable:!0,enableInfo:!0,enableActions:!0},loading:!1,labelsCollapsed:!1,labelsCollapsedMode:Eo.None,labelScale:null,labels:[],contextLabel:null,selectedLabel:null,draggable:{pin:!0,tag:!0}},Pc=((xc=mc=function(){function e(t,n){m(this,e),this.store=t,this.labelsService=n}return v(e,[{key:"PatchLabels",value:function(e,t){var n=immer.applyPatches(e.getState(),t.patches);e.patchState(n)}},{key:"setLabelOffset",value:function(e,t){var n=u(immer.produceWithPatches(e.getState(),(function(e){var n=e.labels.find((function(e){return e.id===t.labelId}));n&&(n.offset=t.offset)})),3),i=n[0],o=n[1],a=n[2];e.patchState(i),this.savePatches(o,a)}},{key:"setLabels",value:function(e,t){e.patchState(immer.produce(e.getState(),(function(e){e.labels=t.labels})))}},{key:"setLabel",value:function(e,t){var n=u(immer.produceWithPatches(e.getState(),(function(e){e.labels=e.labels.map((function(e){return e.id===t.label.id?t.label:e}))})),3),i=n[0],o=n[1],a=n[2];e.patchState(i),t.record&&this.savePatches(o,a)}},{key:"setLabelStates",value:function(e,t){var n=u(immer.produceWithPatches(e.getState(),(function(e){e.labels.find((function(e){return e.id===t.id})).states=t.states})),3),i=n[0],o=n[1],a=n[2];e.patchState(i),this.savePatches(o,a)}},{key:"setLabelScale",value:function(e,t){e.patchState({labelScale:t.scale})}},{key:"addLabel",value:function(e,t){var n=u(immer.produceWithPatches(e.getState(),(function(e){var n=t.label.id||Ut.idWithPrefix("label"),i=Object.assign(Object.assign({},t.label),{id:n});e.labels.push(i)})),3),i=n[0],o=n[1],a=n[2];e.patchState(i),this.savePatches(o,a)}},{key:"addContextLabel",value:function(e,t){var n=immer.produce(e.getState(),(function(e){e.contextLabel=Object.assign(Object.assign({},t.label),{id:"context-label"})}));e.patchState(n)}},{key:"copyLabels",value:function(e,t){var n=e.getState().labels,i=n.filter((function(e){return e.chapterId===t.sourceChapter.id})).map((function(e){return Object.assign(Object.assign({},Object(Oe.cloneDeep)(e)),{id:Ut.idWithPrefix("label"),chapterId:t.targetChapter.id})}));e.patchState({labels:[].concat(s(n),s(i))})}},{key:"removeLabel",value:function(e,t){var n=u(immer.produceWithPatches(e.getState(),(function(e){e.labels=e.labels.filter((function(e){return e.id!==t.label.id}))})),3),i=n[0],o=n[1],a=n[2];e.patchState(i),Human.scene.markers.delete(t.label.id),this.savePatches(o,a)}},{key:"removeContextLabel",value:function(e,t){var n=immer.produce(e.getState(),(function(e){e.contextLabel=void 0}));Human.scene.markers.delete("context-label"),e.patchState(n)}},{key:"removeAllChapterLabels",value:function(e,t){var n=immer.produceWithPatches(e.getState(),(function(e){var n=u(Object(Oe.partition)(e.labels,(function(e){return e.chapterId!==t.chapter.id})),2),i=n[0];n[1].forEach((function(e){return Human.scene.markers.delete(e.id)})),e.labels=i})),i=u(n,3),o=i[0],a=i[1],r=i[2];e.patchState(o),this.savePatches(a,r)}},{key:"selectLabel",value:function(e,t){e.patchState({selectedLabel:t.label?t.label.id:null})}},{key:"resetLabels",value:function(e,t){var n=e.getState();Human.scene.markers.delete("context-label"),n.labels.forEach((function(e){Human.scene.markers.delete(e.id)})),e.setState(immer.produce(e.getState(),(function(e){})))}},{key:"convertLabels",value:function(e,t){var n=u(immer.produceWithPatches(e.getState(),(function(e){t.labels.forEach((function(n){var i=e.labels.findIndex((function(e){return e.id===n.id}));e.labels[i]=Object.assign(Object.assign({},e.labels[i]),t.fields)}))})),3),i=n[0],o=n[1],a=n[2];e.setState(Object.assign({},i)),this.savePatches(o,a)}},{key:"enableContextLabel",value:function(e,t){e.patchState({enableContextLabel:Object.assign({},t)})}},{key:"setLabelsShown",value:function(e,t){var n=t.labels,i=t.shown,o=e.getState().labels.map((function(e){var t=n.some((function(t){return t.id===e.id}));return Object.assign(Object.assign({},e),{shown:t?i:e.shown})}));e.patchState({labels:s(o)})}},{key:"setAllLabelsShown",value:function(e,t){var n=t.show,i=e.getState().labels;e.dispatch(new Yo(i,n))}},{key:"setLabelsCollapsed",value:function(e,t){var n=t.collapsed,i=t.collapsedMode;e.patchState({labelsCollapsed:n,labelsCollapsedMode:i})}},{key:"setLabelsDraggable",value:function(e,t){e.patchState({draggable:Object.assign({},t.draggable)})}},{key:"savePatches",value:function(e,t){this.store.dispatch(new ui.SavePatches([{forward:e,inverse:t,patchAction:Fo}]))}}],[{key:"getLabels",value:function(e){return e.labels}},{key:"getLabelsCollapsed",value:function(e){return e.labelsCollapsed}},{key:"getLabelsCollapsedMode",value:function(e){return e.labelsCollapsedMode}},{key:"getSelectedLabelId",value:function(e){return e.selectedLabel}},{key:"getSelectedLabel",value:function(e){return e.labels.find((function(t){return t.id===e.selectedLabel}))||null}},{key:"getContextLabel",value:function(e){return e.contextLabel}},{key:"getChapterLabels",value:function(e,t){return e.labels.filter((function(e){return e.chapterId===t.selectedChapter}))}},{key:"getChapterSequentialLabels",value:function(e){return Object(L.h)([mc,Ua],(function(t,n){return t.labels.filter((function(t){return t.chapterId===n.selectedChapter&&t.pinType===Jn.Sequential&&t.sequentialType===e}))}))}},{key:"getLabelSequence",value:function(e){return Object(L.h)([mc,mc.getChapterSequentialLabels(Yn.Alphabetical),mc.getChapterSequentialLabels(Yn.Numerical)],(function(t,n,i){if(e.pinType!==Jn.Sequential)return null;switch(e.sequentialType){case Yn.Alphabetical:var o=n.findIndex((function(t){return t.id===e.id}));return"ABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(o);case Yn.Numerical:return i.findIndex((function(t){return t.id===e.id}))+1}}))}},{key:"getEnableContextLabel",value:function(e){return e.enableContextLabel.enable}},{key:"getEnableContextLabelInfo",value:function(e){return e.enableContextLabel.enableInfo}},{key:"getEnableContextLabelActions",value:function(e){return e.enableContextLabel.enableActions}},{key:"getLabelsDraggable",value:function(e){return e.draggable}},{key:"getLabelScale",value:function(e){return e.labelScale}}]),e}()).\u0275fac=function(e){return new(e||xc)(_.Zb(L.g),_.Zb(wi))},xc.\u0275prov=_.Lb({token:xc,factory:xc.\u0275fac}),Sc([Object(L.a)(Fo),_c("design:type",Function),_c("design:paramtypes",[Object,Fo]),_c("design:returntype",void 0)],xc.prototype,"PatchLabels",null),Sc([Object(L.a)(Ao),_c("design:type",Function),_c("design:paramtypes",[Object,Ao]),_c("design:returntype",void 0)],xc.prototype,"setLabelOffset",null),Sc([Object(L.a)(Ro),_c("design:type",Function),_c("design:paramtypes",[Object,Ro]),_c("design:returntype",void 0)],xc.prototype,"setLabels",null),Sc([Object(L.a)(Wo),_c("design:type",Function),_c("design:paramtypes",[Object,Wo]),_c("design:returntype",void 0)],xc.prototype,"setLabel",null),Sc([Object(L.a)($o),_c("design:type",Function),_c("design:paramtypes",[Object,$o]),_c("design:returntype",void 0)],xc.prototype,"setLabelStates",null),Sc([Object(L.a)(Ko),_c("design:type",Function),_c("design:paramtypes",[Object,Ko]),_c("design:returntype",void 0)],xc.prototype,"setLabelScale",null),Sc([Object(L.a)(No),_c("design:type",Function),_c("design:paramtypes",[Object,No]),_c("design:returntype",void 0)],xc.prototype,"addLabel",null),Sc([Object(L.a)(Vo),_c("design:type",Function),_c("design:paramtypes",[Object,Vo]),_c("design:returntype",void 0)],xc.prototype,"addContextLabel",null),Sc([Object(L.a)(Ho),_c("design:type",Function),_c("design:paramtypes",[Object,Ho]),_c("design:returntype",void 0)],xc.prototype,"copyLabels",null),Sc([Object(L.a)(Bo),_c("design:type",Function),_c("design:paramtypes",[Object,Bo]),_c("design:returntype",void 0)],xc.prototype,"removeLabel",null),Sc([Object(L.a)(Qo),_c("design:type",Function),_c("design:paramtypes",[Object,Qo]),_c("design:returntype",void 0)],xc.prototype,"removeContextLabel",null),Sc([Object(L.a)(qo),_c("design:type",Function),_c("design:paramtypes",[Object,qo]),_c("design:returntype",void 0)],xc.prototype,"removeAllChapterLabels",null),Sc([Object(L.a)(Go),_c("design:type",Function),_c("design:paramtypes",[Object,Go]),_c("design:returntype",void 0)],xc.prototype,"selectLabel",null),Sc([Object(L.a)(Zo),_c("design:type",Function),_c("design:paramtypes",[Object,Zo]),_c("design:returntype",void 0)],xc.prototype,"resetLabels",null),Sc([Object(L.a)(Jo),_c("design:type",Function),_c("design:paramtypes",[Object,Jo]),_c("design:returntype",void 0)],xc.prototype,"convertLabels",null),Sc([Object(L.a)(Xo),_c("design:type",Function),_c("design:paramtypes",[Object,Xo]),_c("design:returntype",void 0)],xc.prototype,"enableContextLabel",null),Sc([Object(L.a)(Yo),_c("design:type",Function),_c("design:paramtypes",[Object,Yo]),_c("design:returntype",void 0)],xc.prototype,"setLabelsShown",null),Sc([Object(L.a)(ea),_c("design:type",Function),_c("design:paramtypes",[Object,ea]),_c("design:returntype",void 0)],xc.prototype,"setAllLabelsShown",null),Sc([Object(L.a)(ta),_c("design:type",Function),_c("design:paramtypes",[Object,ta]),_c("design:returntype",void 0)],xc.prototype,"setLabelsCollapsed",null),Sc([Object(L.a)(na),_c("design:type",Function),_c("design:paramtypes",[Object,na]),_c("design:returntype",void 0)],xc.prototype,"setLabelsDraggable",null),Sc([Object(L.e)(),_c("design:type",Function),_c("design:paramtypes",[Cc]),_c("design:returntype",void 0)],xc,"getLabels",null),Sc([Object(L.e)(),_c("design:type",Function),_c("design:paramtypes",[Cc]),_c("design:returntype",void 0)],xc,"getLabelsCollapsed",null),Sc([Object(L.e)(),_c("design:type",Function),_c("design:paramtypes",[Cc]),_c("design:returntype",void 0)],xc,"getLabelsCollapsedMode",null),Sc([Object(L.e)(),_c("design:type",Function),_c("design:paramtypes",[Cc]),_c("design:returntype",void 0)],xc,"getSelectedLabelId",null),Sc([Object(L.e)(),_c("design:type",Function),_c("design:paramtypes",[Cc]),_c("design:returntype",void 0)],xc,"getSelectedLabel",null),Sc([Object(L.e)(),_c("design:type",Function),_c("design:paramtypes",[Cc]),_c("design:returntype",void 0)],xc,"getContextLabel",null),Sc([Object(L.e)([Ua]),_c("design:type",Function),_c("design:paramtypes",[Cc,fn]),_c("design:returntype",void 0)],xc,"getChapterLabels",null),Sc([Object(L.e)(),_c("design:type",Function),_c("design:paramtypes",[Cc]),_c("design:returntype",void 0)],xc,"getEnableContextLabel",null),Sc([Object(L.e)(),_c("design:type",Function),_c("design:paramtypes",[Cc]),_c("design:returntype",void 0)],xc,"getEnableContextLabelInfo",null),Sc([Object(L.e)(),_c("design:type",Function),_c("design:paramtypes",[Cc]),_c("design:returntype",void 0)],xc,"getEnableContextLabelActions",null),Sc([Object(L.e)(),_c("design:type",Function),_c("design:paramtypes",[Cc]),_c("design:returntype",void 0)],xc,"getLabelsDraggable",null),Sc([Object(L.e)(),_c("design:type",Function),_c("design:paramtypes",[Cc]),_c("design:returntype",void 0)],xc,"getLabelScale",null),xc=mc=Sc([Object(L.f)({name:"labels",defaults:jc})],xc)),Mc=((yc=function(){function e(t,n,i,o,a){m(this,e),this.store=t,this.engineService=n,this.chapterSerializer=i,this.animationService=o,this.chapterService=a}return v(e,[{key:"serializeUI",value:function(e){var t=Object.assign({},e.ui);return e.chapters.length>1&&(t.scrubber=!1,t.playPause=!1,t.tour={chapters:!0}),t}},{key:"serializeAnimation",value:function(e){return this.animationService.isChapterAnimated(e)?{startTime:e.timelineMap[0].start,loop:!1!==e.loop,numChapters:1}:{}}},{key:"getClippedObjects",value:function(){return 0===Human.renderer.clip.getActiveClips().length?{}:Human.scene.getLeaves().reduce((function(e,t){return Human.scene.objects[t].culledByClip&&(e[t]=!0),e}),{})}},{key:"generateTrimObjectMap",value:function(e,t){var n=this.engineService.getSceneGraph(Human.scene.rootObjects),i={};t.graph.hidden&&(i=Object.assign(Object.assign({},i),this.engineService.queryShownObjects(e,n,!0)));var o={};for(var a in i)o[a]=!i[a];var r=t.graph.clipped?this.getClippedObjects():{};return Object.assign(Object.assign({},o),r)}},{key:"serialize",value:function(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0,r=arguments.length>5?arguments[5]:void 0,c=Object(Oe.cloneDeep)(o),s=this.generateTrimObjectMap(a,t);c.sceneGraph=function(e,t){var n=[];return Object.entries(e).forEach((function(e){var i=u(e,2),o=(i[0],i[1]),a=Gr.serializeHumanObject(o,t);null!==a&&n.push(a)}),this),n}(Human.scene.rootObjects,s);var l=ye.createGraphFromSrc(c.sceneGraph,"objectId","objects",new Ot(Human.scene.colorRecipes.getRecipes())),p=this.store.selectSnapshot(Pc.getLabels);c.chapters=a.map((function(t){return n.chapterSerializer.serializeChapter(l,t,e,p,r)})),c.ui=this.serializeUI(c),c.animation=this.serializeAnimation(a[0]),c.customData=Object.assign(Object.assign({},c.customData),{particleSystems:this.store.selectSnapshot(ao.getParticleSystemsList)});var d=this.store.selectSnapshot(So.getAllQuestions),g=this.store.selectSnapshot(So.getQuizSettings);g&&d.length>0?c.quizSettings=g:delete c.quizSettings,c.tweenParticleLookup=this.store.selectSnapshot(ao.getTweenParticleLookup);var h=a.reduce((function(e,t){return e.concat(n.chapterService.getChapterTweenStates(t))}),[]);c.assetLibraries.tweens=c.assetLibraries.tweens.filter((function(e){var t=n.getStateId(e);return h.indexOf(t)>=0}));var f=a.reduce((function(e,t){return e.concat(n.chapterService.getChapterLightLibraries(t))}),[]);c.assetLibraries.lights=Array.from(new Set(f));var b=this.getReflectionLibraries(c.reflections),v=a.reduce((function(e,t){return e.concat(n.chapterService.getChapterReflectionLibraries(t))}),[]);c.assetLibraries.reflections=Array.from(new Set(b.concat(v)));var m=[].concat.apply([],Object.values(c.assetLibraries)),y=this.getSceneGraphStateIds(c.sceneGraph);return c.stateId=Array.from(new Set(m.map(this.getStateId).concat(y))),{story:i?vc(c,e):c}}},{key:"getReflectionLibraries",value:function(e){return e=e||{},Object.values(e).map((function(e){var t=e.split(".");return[t[0],t[1]].join("/")}))}},{key:"getSceneGraphStateIds",value:function(e){return e.map((function(e){return e.objectId.split("-")[0]}))}},{key:"getStateId",value:function(e){return e.split("/")[0]}}]),e}()).\u0275fac=function(e){return new(e||yc)(_.Zb(L.g),_.Zb(Nt),_.Zb(jo),_.Zb(xa),_.Zb(Do))},yc.\u0275prov=_.Lb({token:yc,factory:yc.\u0275fac,providedIn:"root"}),yc),Ic=function e(){m(this,e),this.graph={hidden:!1,clipped:!1,disabled:!1,transparent:!1}},zc=function(e){return e.WidgetOptions="widgetOptions",e.SnapshotOptions="snapshotOptions",e.Locale="locale",e.GroupRestriction="GroupRestriction",e.UserAppId="userAppId",e.RememberMeEmail="rememberMeEmail",e.LabelConversionSeen="labelConversionSeen",e.DefaultGroupEdit="defaultGroupEdit",e.DefaultCollectionId="defaultCollectionId",e.InternetExplorerWarning="internetExplorerWarning",e.GettingStartedTutorial="gettingStartedTutorial",e.AutoCapture="autoCapture",e.SystemMessage="systemMessage",e.Preview="preview",e.ExploreRedesignMessage="exploreRedesignMessage",e.Iphone12Warning="iphone12Warning",e}({}),Tc=function(e){return e.UserMessagesSeen="userMessagesSeen",e.PreviewSize="previewSize",e}({}),Uc=function(){function e(){m(this,e),this._data={}}return v(e,[{key:"keys",get:function(){return Object.keys(this._data)}},{key:"length",get:function(){return this.keys.length}},{key:"clear",value:function(){this._data={}}},{key:"getItem",value:function(e){return this._data[e]}},{key:"key",value:function(e){return this.keys[e]}},{key:"removeItem",value:function(e){delete this._data[e]}},{key:"setItem",value:function(e,t){this._data[e]=t}}]),e}(),Lc=((wc=function(){function e(){m(this,e),this._localStorage=this.getStorage("localStorage"),this._sessionStorage=this.getStorage("sessionStorage")}return v(e,[{key:"getLocalItem",value:function(e){return this._localStorage.getItem(""+e)}},{key:"getLocalJSON",value:function(e){var t=this.getLocalItem(e);return t?JSON.parse(t):null}},{key:"setLocalItem",value:function(e,t){var n="object"==typeof t?JSON.stringify(t):""+t;try{return this._localStorage.setItem(""+e,n),!0}catch(i){return!1}}},{key:"removeLocalItem",value:function(e){this._localStorage.removeItem(""+e)}},{key:"getSessionItem",value:function(e){var t=this._sessionStorage.getItem(""+e);return t?JSON.parse(t):null}},{key:"setSessionItem",value:function(e,t){var n=JSON.stringify(t);try{return this._sessionStorage.setItem(""+e,n),!0}catch(i){return!1}}},{key:"removeSessionItem",value:function(e){this._sessionStorage.removeItem(""+e)}},{key:"clearStorage",value:function(){this.clearLocalStorage(),this.clearSessionStorage()}},{key:"clearLocalStorage",value:function(){this._localStorage.clear()}},{key:"clearSessionStorage",value:function(){this._sessionStorage.clear()}},{key:"getStorage",value:function(e){try{return window[e]||new Uc}catch(t){return new Uc}}}]),e}()).\u0275fac=function(e){return new(e||wc)},wc.\u0275prov=_.Lb({token:wc,factory:wc.\u0275fac,providedIn:"root"}),wc),Dc=h("3E0/"),Ec=function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r},Fc=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Ac={loading:!1,incoming:{id:void 0,type:void 0},storyId:void 0,storyType:void 0,loadingChunk:null,loadChunks:[],loadChunksRemaining:[],thumbnailLookup:[]},Rc=((Oc=kc=function(){function e(t,n,i,o,a){m(this,e),this.store=t,this.storyService=n,this.engineService=i,this.serializeModuleService=o,this.storageService=a}return v(e,[{key:"setStoryText",value:function(e,t){var n=e.getState().story;n&&e.patchState({story:Object.assign(Object.assign({},n),{displayName:t.displayName})})}},{key:"setStoryTags",value:function(e,t){var n=t.tags,i=e.getState().story;i&&e.patchState({story:Object.assign(Object.assign({},i),{tags:n})})}},{key:"setStory",value:function(e,t){e.patchState({story:t.story})}},{key:"SetStoryId",value:function(e,t){e.patchState({storyId:t.id})}},{key:"setIncomingStory",value:function(e,t){var n=e.getState(),i=t.id,o=t.type,a=t.reset;i!==n.storyId||a?e.patchState({incoming:{id:i,type:o}}):a&&e.dispatch(new Lr(t.id,n.story,t.type))}},{key:"loadStory",value:function(e,t){(t.preview?Object($.a)(this.storageService.getLocalJSON(zc.Preview)):this.storyService.getStory(t.id,t.type,t.lang)).subscribe((function(n){e.dispatch(new Dr(n,t.id,t.type))}),(function(){e.dispatch(new Er(t.id,t.type))}))}},{key:"loadStorySuccess",value:function(e,t){this.storyService.unloadStory(null).pipe(Object(Dc.a)(0)).subscribe((function(){e.dispatch(new Lr(t.id,t.story,t.type))}))}},{key:"buildStoryWorkflow",value:function(e,t,n,i){var o=this,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:new Map;this.storyService.buildStory(t,n,!0).subscribe((function(c){var l=o.storyService.getStoryChapters(t,i),p=[];l.forEach((function(e){p=[].concat(s(p),s(e.labels))}));var u=o.storyService.getLoadConfig(t,a),d=o.storyService.getStoryLoadChunks(t,u);e.patchState({storyId:t,story:n,loadChunks:d,loadChunksRemaining:d,incoming:{id:void 0,type:void 0}});var g=o.engineService.getSceneGraph(Human.scene.rootObjects),h=l.reduce((function(e,t){return e[t.id]=function(e,t,n,i){return Object.keys(e.nodes).reduce((function(o,a){return o[a]=function(o){var a=Yi(e,o,t)||Xi(e,o,t),r=function e(t,n,i){switch(i[n]){case!0:return!1;case!1:return!0;case void 0:var o=ye.getAncestor(t,n);return!o||e(t,o,i)}}(e,o,n);return{objectId:o,checked:!1,selected:!1,paint:function e(t,n,i){if(i[n]&&("tintColor"in(o=i[n])||"opacity"in o||"brightness"in o||"saturation"in o||"contrast"in o))return Ui.fromEngine(new Ji(i[n]));var o,a=ye.getAncestor(t,n);return a?e(t,a,i):Vi.recipe}(e,o,i),pickable:r,shown:a,shownSetByTween:!1}}(a),o}),{})}(g,t.showObjects,t.pickThroughObjects,t.synchronization),e}),{});e.dispatch(new pi.InitNodeState(h)),e.dispatch(new pi.SetActiveChapter(l[a].id)),e.dispatch(new Cn(l)),e.dispatch(new Bn(r)),e.dispatch(new Ro(p)),e.dispatch(new kn(l[a]));var f=Object(Oe.get)(n,"tweenParticleLookup",{}),b=Object(Oe.get)(n,"customData.particleSystems",[]),v=l.reduce((function(e,t){return e[t.id]=Object(Oe.get)(t,"customData.particleSystems",[]),e}),{});e.dispatch(new Ii.SetParticleState(b,v,f)),e.dispatch(new no.ResetQuizState),n.quizSettings&&e.dispatch(new no.SetQuizSettings(n.quizSettings));var m=lo(l);e.dispatch(new no.SetQuestions(m)),e.dispatch(new Hr),e.dispatch(new zr)}))}},{key:"importStorySuccess",value:function(e,t){var n=this,i=e.getState(),o=i.storyType,a=i.storyId,r=new Ic,l=this.store.selectSnapshot(kc.getStory),p=this.store.selectSnapshot(Ua.getStoryChapters),d=Co.makeChapterIdMap(p,!1),g=this.serializeModuleService.serialize({},r,!1,l,p,d).story,h=function(e,t,n,i){var o,a,r,l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:P.Bookmark,p=arguments.length>5&&void 0!==arguments[5]?arguments[5]:Ut.idWithPrefix,d=function(e,t){var n=function(e){return void 0!==e.objectId},i=u(Object(Oe.partition)(e,n),2),o=i[0],a=i[1],r=u(Object(Oe.partition)(t,n),2),l=r[0],p=function(e,t){return t.reduce((function(t,n){var i,o=c(e);try{for(o.s();!(i=o.n()).done;){var a=i.value;Object(Oe.isEqual)(a,n)||t.push(n)}}catch(r){o.e(r)}finally{o.f()}return t}),e)}(a,r[1]),d=function(e,t){var n=e.reduce((function(e,t){return e[t.objectId]=t,e}),{}),i=t.reduce((function(e,t){if(void 0===e.nodes[t.objectId])return e.nodes[t.objectId]=t,e;if(!Object(Oe.isEqual)(t,e.nodes[t.objectId])){var n=function(e,t){var n={},i={};return{root:function e(t,o){if(t.objectId!==o.objectId)return n[o.objectId]=!0,[t,o];if(void 0===t.objects&&o.objects){var a,r=c(o.objects);try{for(r.s();!(a=r.n()).done;){var s=a.value;n[s.objectId]=!0}}catch(x){r.e(x)}finally{r.f()}return[Object.assign({},o)]}if(t.objects&&void 0===o.objects){var l,p=c(t.objects);try{for(p.s();!(l=p.n()).done;){var u=l.value;i[u.objectId]=!0}}catch(x){p.e(x)}finally{p.f()}return[Object.assign({},t)]}if(void 0===t.objects&&void 0===o.objects)return[Object.assign({},t)];var d,g=[],h=c(t.objects);try{var f=function(){var t=d.value,n=o.objects.find((function(e){return e.objectId===t.objectId}));n?g.push(e(t,n)):(i[t.objectId]=!0,g.push(t))};for(h.s();!(d=h.n()).done;)f()}catch(x){h.e(x)}finally{h.f()}var b,v=c(o.objects);try{var m=function(){var e=b.value;t.objects.find((function(t){return t.objectId===e.objectId}))||(n[e.objectId]=!0,g.push(e))};for(v.s();!(b=v.n()).done;)m()}catch(x){v.e(x)}finally{v.f()}var y=Object.assign({},t);return y.objects=Object(Oe.flatten)(g),[y]}(e,t),objectIdsUniqueToNew:n,objectIdsUniqueToOriginal:i}}(e.nodes[t.objectId],t);e.nodes[t.objectId]=n.root[0],e.graphsMerged.push(t.objectId),e.objectIdsUniqueToNew[t.objectId]=n.objectIdsUniqueToNew,e.objectIdsUniqueToOriginal[t.objectId]=n.objectIdsUniqueToOriginal}return e}),{nodes:n,graphsMerged:[],objectIdsUniqueToNew:{},objectIdsUniqueToOriginal:{}});return{newSceneGraph:Object.keys(i.nodes).reduce((function(e,t){return e.push(i.nodes[t]),e}),[]),graphsMerged:i.graphsMerged,objectIdsUniqueToNew:i.objectIdsUniqueToNew,objectIdsUniqueToOriginal:i.objectIdsUniqueToOriginal}}(o,l),g=d.newSceneGraph,h=d.graphsMerged,f=d.objectIdsUniqueToNew,b=d.objectIdsUniqueToOriginal;return{sceneGraph:[].concat(s(p),s(g)),graphsMerged:h,objectIdsUniqueToNew:f,objectIdsUniqueToOriginal:b}}(e.sceneGraph,n.sceneGraph),g=d.sceneGraph,h=d.graphsMerged,f=d.objectIdsUniqueToNew,b=d.objectIdsUniqueToOriginal,v=(o=e.assetLibraries,a=n.assetLibraries,{lights:(r=function(e,t){return Object(Oe.uniq)([].concat(s(e),s(t)))})(o.lights,a.lights),tweens:r(o.tweens,a.tweens),reflections:r(o.reflections,a.reflections)}),m=function(e,t,n,i){e=e||{},t=t||{};var o=function(e,t){return t.includes("/")?t:"".concat(function(e){return ic(e)===P.Bookmark?e:e.split("/").pop()}(e),"/").concat(t)};return Object.assign(Object.assign({},Object(Oe.mapKeys)(e,(function(e,t){return o(n,t)}))),Object(Oe.mapKeys)(t,(function(e,t){return o(i,t)})))}(e.reflections,n.reflections,t,i),y=function(e,t,n){e=e||{},t=t||{};var i=Object.keys(t).reduce((function(e,i){var o=n("color-recipe-"+i);return e.newColorRecipeIds[i]=o,e.colorRecipes[o]=t[i],e}),{colorRecipes:{},newColorRecipeIds:{}});return{colorRecipes:Object.assign(Object.assign({},e),i.colorRecipes),newColorRecipeIds:i.newColorRecipeIds}}(e.colorRecipes,n.colorRecipes,p),x=y.colorRecipes,w=y.newColorRecipeIds,k=oc(e.chapters,e.assetLibraries.lights),O=oc(n.chapters,n.assetLibraries.lights),C=function(e,t,n,i,o){var a=ac(e,o),r=ac(t,o),c=[].concat(s(rc(e,a)),s(rc(t,r))),l=cc(n,a),p=cc(i,r),u=Object.assign(Object.assign({},sc(l,a)),sc(p,r));return{mergedParticles:c,currentChapters:l,importedChapters:p,tweenParticleLookup:Object(Oe.pickBy)(u,(function(e,t){return!Object(Oe.isEmpty)(e)}))}}(e,n,nc(k,h,f),nc(O,h,b).map((function(e){return Object.assign(Object.assign({},e),{id:p("chapter")})})),p),S=function(e,t){return e.map((function(e){if(Object(Oe.isEmpty)(e.colorRecipeObjects))return e;var n=Object.keys(e.colorRecipeObjects).reduce((function(n,i){return n[t[i]]=e.colorRecipeObjects[i],n}),{});return e.colorRecipeObjects=n,e}))}(C.importedChapters,w),_=[].concat(s(C.currentChapters),s(S)),j=Object.assign(Object.assign({},e.customData),{particleSystems:C.mergedParticles}),M="module"===l?e.tags:[];return Object.assign(Object.assign({},e),{assetLibraries:v,chapters:_,sceneGraph:g,customData:j,tags:M,reflections:m,colorRecipes:x,stateId:Object(Oe.uniq)([].concat(s(e.stateId),s(n.stateId))),tweenParticleLookup:C.tweenParticleLookup})}(g,a,t.story,t.id,z.exportType),f=g.chapters.map((function(e,t){return{newChapterId:e.id,originalChapterId:e.id,originalStoryId:a}})),b=(i.thumbnailLookup||[]).concat(t.story.chapters.map((function(e,n){return{newChapterId:h.chapters[g.chapters.length+n].id,originalChapterId:e.id,originalStoryId:t.id}})));e.patchState({thumbnailLookup:b});var v=Kr.generateThumbnailUrls([].concat(s(f),s(b))),m=this.store.selectSnapshot(Ua.getRegisteredThumbnails),y=new Map(s(m).filter((function(e){return e[1].snapshot}))),x=new Map([].concat(s(v),s(y)));this.storyService.unloadStory(null,!0).subscribe((function(){n.buildStoryWorkflow(e,a,h,o,h.chapters.length-1,x)}))}},{key:"buildStory",value:function(e,t){var n=t.story.chapters.map((function(e,n){return{newChapterId:e.id,originalChapterId:e.id,originalStoryId:t.id}})),i=Kr.generateThumbnailUrls(n);this.buildStoryWorkflow(e,t.id,t.story,t.type,t.chapterIdx||0,i)}},{key:"loadStoryChunk",value:function(e){var t=e.getState().loadChunksRemaining[0];t&&(e.patchState({loadingChunk:t}),this.storyService.loadStoryChunk(t,(function(){e.dispatch([new Ur(t),new zr])})))}},{key:"reorderLoadChunks",value:function(e,t){var n=e.getState().loadChunksRemaining,i=u(Object(Oe.partition)(n,(function(e){return e.chapterId===t.chapterId})),2),o=i[0],a=i[1];e.patchState({loadChunksRemaining:[].concat(s(o),s(a))})}},{key:"loadStoryChunkSuccess",value:function(e,t){var n=e.getState().loadChunksRemaining.filter((function(e){return e.chunkId!==t.chunk.chunkId}));e.patchState({loadingChunk:null,loadChunksRemaining:n}),e.dispatch(new zn(t.chunk.chapterId,t.chunk.readyState))}},{key:"synchronizeChapters",value:function(e){var t=this.store.selectSnapshot(Ua.getStoryChapters),n=e.getState().story;e.patchState({story:Object.assign(Object.assign({},n),{chapters:s(t)})})}},{key:"importStory",value:function(e,t){this.storyService.getStory(t.id,t.type,t.lang).subscribe((function(n){e.dispatch(new Ar(n,t.id,t.type))}))}},{key:"resetStory",value:function(e){e.setState(Ac)}}],[{key:"getStory",value:function(e){return e.story}},{key:"getStoryId",value:function(e){return e.storyId}},{key:"getLoadingChunk",value:function(e){return e.loadingChunk}},{key:"getLoadChunks",value:function(e){return e.loadChunks}},{key:"getLoadChunksRemaining",value:function(e){return e.loadChunksRemaining}},{key:"getStoryInfo",value:function(e){return{id:e.storyId,type:e.storyType}}},{key:"getIncomingStoryInfo",value:function(e){return e.incoming}},{key:"getStoryTags",value:function(e){return Object(Oe.get)(e,"story.tags",[])}}]),e}()).\u0275fac=function(e){return new(e||Oc)(_.Zb(L.g),_.Zb(tc),_.Zb(Nt),_.Zb(Mc),_.Zb(Lc))},Oc.\u0275prov=_.Lb({token:Oc,factory:Oc.\u0275fac}),Ec([Object(L.a)(Pr),Fc("design:type",Function),Fc("design:paramtypes",[Object,Pr]),Fc("design:returntype",void 0)],Oc.prototype,"setStoryText",null),Ec([Object(L.a)(Mr),Fc("design:type",Function),Fc("design:paramtypes",[Object,Mr]),Fc("design:returntype",void 0)],Oc.prototype,"setStoryTags",null),Ec([Object(L.a)(_r),Fc("design:type",Function),Fc("design:paramtypes",[Object,_r]),Fc("design:returntype",void 0)],Oc.prototype,"setStory",null),Ec([Object(L.a)(jr),Fc("design:type",Function),Fc("design:paramtypes",[Object,jr]),Fc("design:returntype",void 0)],Oc.prototype,"SetStoryId",null),Ec([Object(L.a)(Ir),Fc("design:type",Function),Fc("design:paramtypes",[Object,Ir]),Fc("design:returntype",void 0)],Oc.prototype,"setIncomingStory",null),Ec([Object(L.a)(Sr),Fc("design:type",Function),Fc("design:paramtypes",[Object,Sr]),Fc("design:returntype",void 0)],Oc.prototype,"loadStory",null),Ec([Object(L.a)(Dr),Fc("design:type",Function),Fc("design:paramtypes",[Object,Dr]),Fc("design:returntype",void 0)],Oc.prototype,"loadStorySuccess",null),Ec([Object(L.a)(Ar),Fc("design:type",Function),Fc("design:paramtypes",[Object,Ar]),Fc("design:returntype",void 0)],Oc.prototype,"importStorySuccess",null),Ec([Object(L.a)(Lr),Fc("design:type",Function),Fc("design:paramtypes",[Object,Lr]),Fc("design:returntype",void 0)],Oc.prototype,"buildStory",null),Ec([Object(L.a)(zr),Fc("design:type",Function),Fc("design:paramtypes",[Object]),Fc("design:returntype",void 0)],Oc.prototype,"loadStoryChunk",null),Ec([Object(L.a)(Tr),Fc("design:type",Function),Fc("design:paramtypes",[Object,Tr]),Fc("design:returntype",void 0)],Oc.prototype,"reorderLoadChunks",null),Ec([Object(L.a)(Ur),Fc("design:type",Function),Fc("design:paramtypes",[Object,Ur]),Fc("design:returntype",void 0)],Oc.prototype,"loadStoryChunkSuccess",null),Ec([Object(L.a)(Nr),Fc("design:type",Function),Fc("design:paramtypes",[Object]),Fc("design:returntype",void 0)],Oc.prototype,"synchronizeChapters",null),Ec([Object(L.a)(Fr),Fc("design:type",Function),Fc("design:paramtypes",[Object,Fr]),Fc("design:returntype",void 0)],Oc.prototype,"importStory",null),Ec([Object(L.a)(Rr),Fc("design:type",Function),Fc("design:paramtypes",[Object]),Fc("design:returntype",void 0)],Oc.prototype,"resetStory",null),Ec([Object(L.e)(),Fc("design:type",Function),Fc("design:paramtypes",[tr]),Fc("design:returntype",void 0)],Oc,"getStory",null),Ec([Object(L.e)(),Fc("design:type",Function),Fc("design:paramtypes",[tr]),Fc("design:returntype",void 0)],Oc,"getStoryId",null),Ec([Object(L.e)(),Fc("design:type",Function),Fc("design:paramtypes",[tr]),Fc("design:returntype",void 0)],Oc,"getLoadingChunk",null),Ec([Object(L.e)(),Fc("design:type",Function),Fc("design:paramtypes",[tr]),Fc("design:returntype",void 0)],Oc,"getLoadChunks",null),Ec([Object(L.e)(),Fc("design:type",Function),Fc("design:paramtypes",[tr]),Fc("design:returntype",void 0)],Oc,"getLoadChunksRemaining",null),Ec([Object(L.e)(),Fc("design:type",Function),Fc("design:paramtypes",[tr]),Fc("design:returntype",void 0)],Oc,"getStoryInfo",null),Ec([Object(L.e)(),Fc("design:type",Function),Fc("design:paramtypes",[tr]),Fc("design:returntype",void 0)],Oc,"getIncomingStoryInfo",null),Ec([Object(L.e)(),Fc("design:type",Function),Fc("design:paramtypes",[tr]),Fc("design:returntype",void 0)],Oc,"getStoryTags",null),Oc=kc=Ec([Object(L.f)({name:"story",defaults:Ac})],Oc)),Nc=function(){var e=function e(t,n){m(this,e),this.storyLoadProgress=t,this.chunkLoadProgress=n};return e.type="[Engine Progress] set progress",e}();function Vc(e,t){return e.dispatch(new Fe(!1)),t.fireEvent(Lt.SceneXrayDisabled,void 0),!0}var Hc,Bc=h("yLV6"),Qc=function(){function e(t){m(this,e),this.ngUnsubsribe=new ge.a,this.store=t,this.listenForParticleChanges(),this.listenForLookupChanges()}return v(e,[{key:"destroy",value:function(){this.ngUnsubsribe.next(),this.ngUnsubsribe.complete()}},{key:"listenForLookupChanges",value:function(){var e=this;this.store.select(ao.getTweenParticleLookup).pipe(Object(fe.a)(this.ngUnsubsribe)).subscribe((function(t){Object(Oe.isEmpty)(t)||zi.refreshEngineLookup(e.store.selectSnapshot(Rc.getStoryId),t)}))}},{key:"listenForParticleChanges",value:function(){var e=this,t=this.store.select(ao.getParticleSystems),n=this.store.select(ao.getVisisbleParticleSystems);Object($a.a)(t,n).pipe(Object(fe.a)(this.ngUnsubsribe)).subscribe((function(){var t=e.store.selectSnapshot(Ua.getSelectedChapterId),n=e.store.selectSnapshot(ao.particleSystemsForChapter(t)),i=e.store.selectSnapshot(ao.getVisibleParticleSystesmForChapter(t)),o=n.filter((function(e){return i.includes(e.id)}));e.setEngineParticles(o)}))}},{key:"setEngineParticles",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];Human.particles.disableAll(),Human.particles.resetAll();var t=JSON.parse(JSON.stringify(e));Human.particles.parse(t,(function(){e.forEach((function(e){Human.particles.enable(e.id)})),null!=Human.timeline.activeRoot&&(Human.timeline.activeRoot._nowBranch.particleSystems=e.map((function(e){return e.id})))}))}}]),e}();(Hc||(Hc={})).getColorRecipe=function(e,t){var n=e.scene.objects[t];if(n instanceof e.scene.Object){var i=n.getProperties();return{tintColor:Object(Oe.get)(i,"tintColor")?i.tintColor:[1,1,1],brightness:i.brightness,saturation:i.saturation,contrast:i.contrast,opacity:i.opacity}}return null};var qc,Wc,$c,Kc,Gc=((qc=function(){function e(t,n,i){m(this,e),this.store=t,this.graphService=n,this.engineService=i,this.highlightDisabled=!1}return v(e,[{key:"colorObject",value:function(e,t){var n=t.tintColor,i=t.saturation,o=t.brightness,a=t.contrast,r=t.opacity,c=Human.scene.objects[e];c instanceof Human.scene.Object&&(Object(Oe.isNil)(n)||c.setTintColor(n),Object(Oe.isNil)(i)||c.setSaturation(i),Object(Oe.isNil)(o)||c.setBrightness(o),Object(Oe.isNil)(a)||c.setContrast(a),Object(Oe.isNil)(r)||c.setOpacity(r))}},{key:"getColor",value:function(e){return Hc.getColorRecipe(Human,e)}},{key:"uncolorObject",value:function(e){var t=Human.scene.objects[e];t instanceof Human.scene.Object&&(t.clearColorModifiers(),t.clearOpacityModifiers())}},{key:"unpaint",value:function(e){var t=this,n=this.store.selectSnapshot(qa.getViewGraph);this.graphService.getLeafDescendants(n,e.id).forEach((function(e){t.engineService.getObjects(e).forEach((function(e){var t=Human.scene.objects[e];t instanceof Human.scene.Object&&(t.clearColorModProperties(),t.clearOpacityModProperties())}))}))}},{key:"paint",value:function(e,t){var n=this,i=this.store.selectSnapshot(qa.getViewGraph),o=Ui.toEngine(t);this.graphService.getLeafDescendants(i,e).forEach((function(e){n.engineService.getObjects(e).forEach((function(e){n.colorObject(e,o)}))}))}},{key:"highlight",value:function(e,t){var n=this;if(!1===this.highlightDisabled||!1===t){var i=this.store.selectSnapshot(qa.getViewGraph);this.graphService.getLeafDescendants(i,e).forEach((function(e){n.engineService.getObjects(e).forEach((function(e){var n=Human.scene.objects[e];n instanceof Human.scene.Object&&n.setHighlight(t)}))}))}}},{key:"xRay",value:function(e,t){Human.scene.objects[e.id].setXRay(t)}},{key:"paintAll",value:function(e,t){var n=this;e.forEach((function(e){return n.paint(e,t)}))}},{key:"unpaintAll",value:function(e){var t=this;e.forEach((function(e){t.unpaint(e)}))}},{key:"highlightAll",value:function(e,t){var n=this;e.forEach((function(e){return n.highlight(e,t)}))}},{key:"disableHighlight",value:function(){this.highlightDisabled=!0}},{key:"enableHighlight",value:function(){this.highlightDisabled=!1}},{key:"setHighlightColor",value:function(e){Human.renderer.highlightColor=s(e)}}]),e}()).\u0275fac=function(e){return new(e||qc)(_.Zb(L.g),_.Zb(St),_.Zb(Nt))},qc.\u0275prov=_.Lb({token:qc,factory:qc.\u0275fac,providedIn:"root"}),qc),Zc=function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r},Jc=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Xc=((Wc=function(){function e(t){m(this,e),this.store=t,this.currentLayers=[],this.nodesLayerIndex=0,this.objectsLayerIndex=0,this.nodeChapterOpacities={}}return v(e,[{key:"initObservables",value:function(){var e=this;this.selectedChapterId$.pipe(Object(be.a)((function(e){return!Object(Oe.isNil)(e)}))).subscribe((function(t){e.selectedChapterId=t,e.updateNodeChapterOpacities()})),this.selectedChapterCurrentLayers$.subscribe((function(t){e.currentLayers=t,e.nodesLayerIndex=e.objectsLayerIndex=e.store.selectSnapshot(Ua.getSelectedChapterCurrentLayersIndex)})),Object(Ka.b)(this.selectedChapterCurrentLayersIndex$,this.selectedChapterCurrentLayersPosition$).pipe(Object(be.a)((function(e){var t=u(e,2),n=t[0],i=t[1];return!Object(Oe.isNil)(n)&&!Object(Oe.isNil)(i)}))).subscribe((function(t){var n=u(t,2),i=n[0],o=n[1];e.synchronizeScene(i,o,!0)}))}},{key:"recordLayerIndexPosition",value:function(e,t){this.store.dispatch(new Kn(this.selectedChapterId,e,t,!0))}},{key:"synchronizeScene",value:function(e,t,n){this.updateLayerIndex(e,this.currentLayers,n),this.updateLayerPosition(t,this.currentLayers,n)}},{key:"fractionToIndex",value:function(e){var t=this.getThreshold(),n=Math.floor(e/t);return Math.min(this.currentLayers.length-2,n)}},{key:"fractionToPosition",value:function(e,t){var n=this.getThreshold();return Math.max(0,Math.min((e-n*t)/n,1))}},{key:"indexPositionToFraction",value:function(e,t){var n=this.getThreshold();return e*n+t*n}},{key:"getThreshold",value:function(){return this.currentLayers.length>1?1/(this.currentLayers.length-1):1}},{key:"getCurrentLayerIndexProp",value:function(e){return e?"nodesLayerIndex":"objectsLayerIndex"}},{key:"updateLayerIndex",value:function(e,t,n){var i=this.getCurrentLayerIndexProp(n);e!==this[i]&&(this.restoreLayers(e,this[i],t,n),n&&(this.nodesLayerIndex=e),this.objectsLayerIndex=e)}},{key:"updateLayerPosition",value:function(e,t,n){var i=this.getCurrentLayerIndexProp(n);this.setObjectsOpacity(t[this[i]].objectIds,1-e)}},{key:"restoreLayers",value:function(e,t,n,i){for(var o=(e-t)/Math.abs(e-t),a=[],r=t;r!==e;)a=a.concat(n[r].objectIds),r+=o;var c=-1===o;this.setObjectsOpacity(a,1===o?0:1),i?this.setNodesShown(a,c):this.setObjectsShown(a,c),-1===o&&(i?this.setNodesShown(n[e].objectIds,!0):this.setObjectsShown(n[e].objectIds,!0))}},{key:"setObjectsOpacity",value:function(e,t){for(var n=0;n<e.length;n++){var i=e[n],o=this.nodeChapterOpacities[i],a=void 0;this.isFresnelOpacity(o)?((a=o.slice())[0]=t*o[0],a[1]=t*o[1]):a=t*o,Human.scene.objects[i].setOpacity(a)}}},{key:"updateNodeChapterOpacities",value:function(){var e=this,t=this.store.selectSnapshot(Fi.getAllNodeState)[this.selectedChapterId];this.nodeChapterOpacities={},Object.entries(t).forEach((function(t){var n=u(t,2),i=n[0],o=n[1];if(e.nodeChapterOpacities[i]=1,o.paint&&o.paint.hasOwnProperty("opacity")){var a=Ui.toEngine(o.paint);(e.isFresnelOpacity(a.opacity)||e.isScalarOpacity(a.opacity))&&(e.nodeChapterOpacities[i]=a.opacity)}}))}},{key:"isScalarOpacity",value:function(e){return"number"==typeof e}},{key:"isFresnelOpacity",value:function(e){return Array.isArray(e)}},{key:"setObjectsShown",value:function(e,t){for(var n={},i=0;i<e.length;i++)n[e[i]]=t;Human.scene.setEnabledObjects({objects:n})}},{key:"setNodesShown",value:function(e,t){this.store.dispatch(new pi.UpdateNodesShown(t,e,void 0,!1))}}]),e}()).\u0275fac=function(e){return new(e||Wc)(_.Zb(L.g))},Wc.\u0275prov=_.Lb({token:Wc,factory:Wc.\u0275fac,providedIn:"root"}),Zc([Object(L.d)(Ua.getSelectedChapterCurrentLayers),Jc("design:type",he.a)],Wc.prototype,"selectedChapterCurrentLayers$",void 0),Zc([Object(L.d)(Ua.getSelectedChapterCurrentLayersIndex),Jc("design:type",he.a)],Wc.prototype,"selectedChapterCurrentLayersIndex$",void 0),Zc([Object(L.d)(Ua.getSelectedChapterCurrentLayersPosition),Jc("design:type",he.a)],Wc.prototype,"selectedChapterCurrentLayersPosition$",void 0),Zc([Object(L.d)(Ua.getSelectedChapterId),Jc("design:type",he.a)],Wc.prototype,"selectedChapterId$",void 0),Wc),Yc=h("HlzF"),es=new RegExp("^/media/audio/(.*)/.*$"),ts=(($c=function(){function e(){m(this,e),this.audioPlayers=new Map}return v(e,[{key:"createAudioUploadEvent",value:function(e){return{type:"uploadFile",url:"/ws/media/audio/upload",method:"POST",file:e}}},{key:"getAudioClip",value:function(e){return Object.entries(e).find((function(e){var t=u(e,2);return t[0],"audio"===t[1].data.streamType}))||[void 0,void 0]}},{key:"createAudioClip",value:function(e,t){var n=Human.timeline.branchTimelines[e.id],i=this.getAudioUUID(t);return[i,{data:{clipId:i,streamType:"audio",alternatives:["m4a"],fullUrl:t,time1:n.timeRange.firstTime,time2:n.timeRange.lastTime}}]}},{key:"getAudioClipUrl",value:function(e){var t=u(this.getAudioClip(e),2),n=(t[0],t[1]);return n?n.data.fullUrl:""}},{key:"getAudioSrc",value:function(e){return e.match("/media/audio")||(e="/content/states/"+e),e}},{key:"getAudioPlayer",value:function(e){return this.audioPlayers.get(e)}},{key:"addAudioPlayer",value:function(e){this.removeAudioPlayer(e),e=this.getAudioSrc(e);var t=new Yc.Howl({src:[e]});return this.audioPlayers.set(e,t),t}},{key:"removeAudioPlayer",value:function(e){var t=this.audioPlayers.get(e);t&&(t.unload(),this.audioPlayers.delete(e))}},{key:"stopAudio",value:function(){this.audioPlayers.forEach((function(e){e.stop()}))}},{key:"getAudioUUID",value:function(e){return e.match(es)[1]}}]),e}()).\u0275fac=function(e){return new(e||$c)},$c.\u0275prov=_.Lb({token:$c,factory:$c.\u0275fac,providedIn:"root"}),$c),ns=function(e){return e.Hide="hide",e.Show="show",e.Collapse="collapse",e}({}),is=function(e){return e.None="none",e.Small="small",e.Full="full",e}({}),os=function(e){return e.None="none",e.Circle="circle",e.Bar="bar",e}({}),as=z.application===j.Viewer?os.Bar:os.Circle,rs=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ns.Hide,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];m(this,e),this.status=t,this.enable=n},cs=h("qpAl"),ss=h.n(cs);!function(e){function t(e){o()&&(e||(e=document.body),ss.a.prefixed("requestFullscreen",e)())}function n(){o()&&ss.a.prefixed("exitFullscreen",document)()}function i(){return ss.a.fullscreen&&ss.a.prefixed("fullscreenEnabled",document)}function o(){return!!i()||(console.warn("Fullscreen is not enabled"),!1)}function a(){return ss.a.prefixed("fullscreenElement",document)}e.toggleFullscreen=function(e){null===a()?t(e):n()},e.requestFullscreen=t,e.exitFullscreen=n,e.canFullscreen=i,e.checkFullscreenSupport=o,e.getFullscreenElement=a,e.isFullscreen=function(){return null!=a()},e.onFullscreenChange=function(){var e="mozfullscreenchange webkitfullscreenchange MSFullscreenChange fullscreenchange".split(" ").map((function(e){return Object(Ga.a)(document.body,e)}));return Object($a.a).apply(void 0,s(e))}}(Kc||(Kc={}));var ls,ps,us,ds=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},gs=function(e){return e.Light="light",e.Dark="dark",e.Themed="themed",e}({}),hs=((ls=function(){function e(t,n){m(this,e),this.store=t,this.graphService=n,this.theme=gs.Dark,this.ngUnsubscribe=new ge.a}return v(e,[{key:"ngOnInit",value:function(){var e=this;this.store.select(Fi.getCheckedNodes).pipe(Object(be.a)((function(e){return 1===e.length})),Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){setTimeout((function(){e.scrollNodeIntoView(t[0])}))}))}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"scrollNodeIntoView",value:function(e){var t=this.graphService.sanitizeNodeID(e.objectId),n=document.querySelector("[data-id=".concat(t,"]"));n&&"scrollBehavior"in document.documentElement.style&&n.scrollIntoView({behavior:"smooth",block:"nearest"})}}]),e}()).\u0275fac=function(e){return new(e||ls)(_.Pb(L.g),_.Pb(St))},ls.\u0275cmp=_.Jb({type:ls,selectors:[["app-tree"]],inputs:{theme:"theme",searchGraph:"searchGraph"},decls:2,vars:4,consts:[[3,"theme","graph"]],template:function(e,t){1&e&&(_.Qb(0,"app-tree-group",0),_.hc(1,"async")),2&e&&_.lc("theme",t.theme)("graph",t.searchGraph?t.searchGraph:_.ic(1,2,t.viewGraph$))},styles:[""]}),function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);a>3&&r&&Object.defineProperty(t,n,r)}([Object(L.d)(qa.getViewGraph),ds("design:type",he.a)],ls.prototype,"viewGraph$",void 0),ls),fs=h("C9yA"),bs=h("vxfF"),vs=function e(){m(this,e)},ms=function(){var e=function e(t){m(this,e),this.view=t};return e.type="[Edit] Set view",e}(),ys=function(){var e=function e(){m(this,e)};return e.type="[Edit] Next view",e}(),xs=function(){var e=function e(){m(this,e)};return e.type="[Edit] Previous view",e}(),ws=function(){var e=function e(t){m(this,e),this.show=t};return e.type="[Edit] Show columns",e}(),ks=function(){var e=function e(t,n){m(this,e),this.column=t,this.show=n};return e.type="[Edit] Show column",e}(),Os=function(){var e=function e(){m(this,e)};return e.type="[Edit] Reset",e}(),Cs=function(){var e=function e(t){m(this,e),this.layerOrderMode=t};return e.type="[Edit] Set Layer Order Mode",e}(),Ss=function(){var e=function e(t){m(this,e),this.show=t};return e.type="[Edit] Show Tree Node Ids",e}(),_s=function(){var e=function e(t){m(this,e),this.size=t};return e.type="[Edit] Set Canvas Size",e}(),js=function(){var e=function e(t){m(this,e),this.enable=t};return e.type="[Edit] Auto Capture",e}(),Ps=function(e){return e.Chapter="chapter",e.Label="label",e.Paint="paint",e.Position="position",e.Quiz="quiz",e}({}),Ms=function e(){m(this,e)},Is=function(){var e=function e(t){m(this,e),this.colorRecipe=t};return e.type="[Edit Paint] Set Color Recipe",e}(),zs=function(){var e=function e(t){m(this,e),this.brushMode=t};return e.type="[Edit Paint] Set Paint Brush Mode",e}(),Ts=function(){var e=function e(){m(this,e)};return e.type="[Edit Paint] Clear Color Recipe",e}(),Us=function(){var e=function e(){m(this,e)};return e.type="[Edit Paint] Reset Paint",e}(),Ls=function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r},Ds=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Es={colorRecipe:Bi.recipe,brushMode:(ps={},ps[ps.Modify=0]="Modify",ps[ps.Replace=1]="Replace",ps).Modify},Fs=((us=function(){function e(){m(this,e)}return v(e,[{key:"setColorRecipe",value:function(e,t){var n=t.colorRecipe;e.patchState({colorRecipe:n})}},{key:"setBrushMode",value:function(e,t){e.patchState({brushMode:t.brushMode})}},{key:"clearColorRecipe",value:function(e,t){e.patchState({colorRecipe:null})}},{key:"resetPaint",value:function(e,t){e.setState(Es)}}],[{key:"getColorRecipe",value:function(e){return e.colorRecipe}},{key:"getPaintBrushMode",value:function(e){return e.brushMode}}]),e}()).\u0275fac=function(e){return new(e||us)},us.\u0275prov=_.Lb({token:us,factory:us.\u0275fac}),Ls([Object(L.a)(Is),Ds("design:type",Function),Ds("design:paramtypes",[Object,Is]),Ds("design:returntype",void 0)],us.prototype,"setColorRecipe",null),Ls([Object(L.a)(zs),Ds("design:type",Function),Ds("design:paramtypes",[Object,zs]),Ds("design:returntype",void 0)],us.prototype,"setBrushMode",null),Ls([Object(L.a)(Ts),Ds("design:type",Function),Ds("design:paramtypes",[Object,Ts]),Ds("design:returntype",void 0)],us.prototype,"clearColorRecipe",null),Ls([Object(L.a)(Us),Ds("design:type",Function),Ds("design:paramtypes",[Object,Us]),Ds("design:returntype",void 0)],us.prototype,"resetPaint",null),Ls([Object(L.e)(),Ds("design:type",Function),Ds("design:paramtypes",[Ms]),Ds("design:returntype",void 0)],us,"getColorRecipe",null),Ls([Object(L.e)(),Ds("design:type",Function),Ds("design:paramtypes",[Ms]),Ds("design:returntype",void 0)],us,"getPaintBrushMode",null),us=Ls([Object(L.f)({name:"editPaint",defaults:Es})],us)),As=function e(t,n,i){m(this,e),this.label=t,this.width=n,this.height=i},Rs=new As("Don't Resize",-1,-1);new As("Common (Mobile)",360,640),new As("Common (Minimum)",300,300),new As("Common (Publish Default)",700,550),new As("iPhone X",375,812),new As("iPad (Portrait)",768,1024),new As("iPad (Landscape)",1024,768);var Ns,Vs,Hs,Bs,Qs,qs,Ws=function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r},$s=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Ks={view:Ps.Chapter,showColumns:!0,showLeftColumn:!0,showRightColumn:!0,showHeader:!0,showFooter:!0,autoCapture:z.application!==j.Loft,record:!0,layerOrderMode:!1,showTreeNodeIds:!1,canvasSize:Rs,canvasSettings:{emulateDrawer:!0,emulateColumn:!0}},Gs=((Bs=function(){function e(t){m(this,e),this.storageService=t}return v(e,[{key:"SetLayerOrderMode",value:function(e,t){e.patchState({layerOrderMode:t.layerOrderMode})}},{key:"ShowTreeNodeIds",value:function(e,t){var n=null!=t.show?t.show:!e.getState().showTreeNodeIds;e.patchState({showTreeNodeIds:n})}},{key:"setView",value:function(e,t){e.patchState({view:t.view})}},{key:"nextView",value:function(e,t){var n=e.getState().view,i=Object.values(Ps),o=i[i.indexOf(n)+1]||i[0];e.patchState({view:o})}},{key:"previousView",value:function(e,t){var n=e.getState().view,i=Object.values(Ps),o=i[i.indexOf(n)-1]||i[i.length-1];e.patchState({view:o})}},{key:"showColumns",value:function(e,t){e.patchState({showColumns:t.show})}},{key:"showColumn",value:function(e,t){switch(t.column){case"left":e.patchState({showLeftColumn:t.show});break;case"right":e.patchState({showRightColumn:t.show});break;case"header":e.patchState({showHeader:t.show});break;case"footer":e.patchState({showFooter:t.show})}}},{key:"resetEditPage",value:function(e,t){e.setState(Ks),e.dispatch(new Us)}},{key:"setCanvasSize",value:function(e,t){e.patchState({canvasSize:t.size})}},{key:"autoCapture",value:function(e,t){e.patchState({autoCapture:t.enable}),z.application===j.Studio&&this.storageService.setLocalItem(zc.AutoCapture,t.enable)}},{key:"ngxsOnInit",value:function(e){var t=this;setTimeout((function(){t.initAutoCapture(e)}))}},{key:"initAutoCapture",value:function(e){if(z.application===j.Studio){var t=this.storageService.getLocalJSON(zc.AutoCapture);"boolean"==typeof t&&e.patchState({autoCapture:t})}}}],[{key:"getView",value:function(e){return e.view}},{key:"getShowColumns",value:function(e){return e.showColumns}},{key:"getShowLeftColumn",value:function(e){return e.showLeftColumn}},{key:"getShowRightColumn",value:function(e){return e.showRightColumn}},{key:"getShowHeader",value:function(e){return e.showHeader}},{key:"getShowFooter",value:function(e){return e.showFooter}},{key:"getRecord",value:function(e){return e.record}},{key:"getLayerOrderMode",value:function(e){return e.layerOrderMode}},{key:"getShowTreeNodeIds",value:function(e){return e.showTreeNodeIds}},{key:"getCanvasSize",value:function(e){return e.canvasSize}},{key:"getCanvasSettings",value:function(e){return e.canvasSettings}},{key:"getAutoCapture",value:function(e){return e.autoCapture}}]),e}()).\u0275fac=function(e){return new(e||Bs)(_.Zb(Lc))},Bs.\u0275prov=_.Lb({token:Bs,factory:Bs.\u0275fac}),Ws([Object(L.a)(Cs),$s("design:type",Function),$s("design:paramtypes",[Object,Cs]),$s("design:returntype",void 0)],Bs.prototype,"SetLayerOrderMode",null),Ws([Object(L.a)(Ss),$s("design:type",Function),$s("design:paramtypes",[Object,Ss]),$s("design:returntype",void 0)],Bs.prototype,"ShowTreeNodeIds",null),Ws([Object(L.a)(ms),$s("design:type",Function),$s("design:paramtypes",[Object,ms]),$s("design:returntype",void 0)],Bs.prototype,"setView",null),Ws([Object(L.a)(ys),$s("design:type",Function),$s("design:paramtypes",[Object,ys]),$s("design:returntype",void 0)],Bs.prototype,"nextView",null),Ws([Object(L.a)(xs),$s("design:type",Function),$s("design:paramtypes",[Object,ys]),$s("design:returntype",void 0)],Bs.prototype,"previousView",null),Ws([Object(L.a)(ws),$s("design:type",Function),$s("design:paramtypes",[Object,ws]),$s("design:returntype",void 0)],Bs.prototype,"showColumns",null),Ws([Object(L.a)(ks),$s("design:type",Function),$s("design:paramtypes",[Object,ks]),$s("design:returntype",void 0)],Bs.prototype,"showColumn",null),Ws([Object(L.a)(Os),$s("design:type",Function),$s("design:paramtypes",[Object,Os]),$s("design:returntype",void 0)],Bs.prototype,"resetEditPage",null),Ws([Object(L.a)(_s),$s("design:type",Function),$s("design:paramtypes",[Object,_s]),$s("design:returntype",void 0)],Bs.prototype,"setCanvasSize",null),Ws([Object(L.a)(js),$s("design:type",Function),$s("design:paramtypes",[Object,js]),$s("design:returntype",void 0)],Bs.prototype,"autoCapture",null),Ws([Object(L.e)(),$s("design:type",Function),$s("design:paramtypes",[vs]),$s("design:returntype",void 0)],Bs,"getView",null),Ws([Object(L.e)(),$s("design:type",Function),$s("design:paramtypes",[vs]),$s("design:returntype",void 0)],Bs,"getShowColumns",null),Ws([Object(L.e)(),$s("design:type",Function),$s("design:paramtypes",[vs]),$s("design:returntype",void 0)],Bs,"getShowLeftColumn",null),Ws([Object(L.e)(),$s("design:type",Function),$s("design:paramtypes",[vs]),$s("design:returntype",void 0)],Bs,"getShowRightColumn",null),Ws([Object(L.e)(),$s("design:type",Function),$s("design:paramtypes",[vs]),$s("design:returntype",void 0)],Bs,"getShowHeader",null),Ws([Object(L.e)(),$s("design:type",Function),$s("design:paramtypes",[vs]),$s("design:returntype",void 0)],Bs,"getShowFooter",null),Ws([Object(L.e)(),$s("design:type",Function),$s("design:paramtypes",[vs]),$s("design:returntype",void 0)],Bs,"getRecord",null),Ws([Object(L.e)(),$s("design:type",Function),$s("design:paramtypes",[vs]),$s("design:returntype",void 0)],Bs,"getLayerOrderMode",null),Ws([Object(L.e)(),$s("design:type",Function),$s("design:paramtypes",[vs]),$s("design:returntype",void 0)],Bs,"getShowTreeNodeIds",null),Ws([Object(L.e)(),$s("design:type",Function),$s("design:paramtypes",[vs]),$s("design:returntype",void 0)],Bs,"getCanvasSize",null),Ws([Object(L.e)(),$s("design:type",Function),$s("design:paramtypes",[vs]),$s("design:returntype",void 0)],Bs,"getCanvasSettings",null),Ws([Object(L.e)(),$s("design:type",Function),$s("design:paramtypes",[vs]),$s("design:returntype",void 0)],Bs,"getAutoCapture",null),Bs=Ws([Object(L.f)({name:"edit",defaults:Ks,children:[Fs]})],Bs)),Zs=((Hs=function(){function e(){m(this,e)}return v(e,[{key:"onClick",value:function(e){e.stopPropagation(),e.stopImmediatePropagation()}}]),e}()).\u0275fac=function(e){return new(e||Hs)},Hs.\u0275dir=_.Kb({type:Hs,selectors:[["","appEventFence",""]],hostBindings:function(e,t){1&e&&_.cc("click",(function(e){return t.onClick(e,e.target)}))}}),Hs),Js=((Vs=function(){function e(){m(this,e)}return v(e,[{key:"iconClass",get:function(){var e="fas fa-"+this.icon;return this.size&&(e+=" fa-"+this.size),e}},{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||Vs)},Vs.\u0275cmp=_.Jb({type:Vs,selectors:[["app-icon"]],inputs:{icon:"icon",size:"size"},decls:1,vars:1,consts:[[3,"ngClass"]],template:function(e,t){1&e&&_.Qb(0,"i",0),2&e&&_.lc("ngClass",t.iconClass)},directives:[or.i],styles:[""],encapsulation:2,changeDetection:0}),Vs),Xs=((Ns=function(){function e(t){m(this,e),this.engineService=t}return v(e,[{key:"getClipboardAPISupport",value:function(){return"clipboard"in navigator}},{key:"getClipboardAPI",value:function(){return navigator.clipboard}},{key:"copyToClipboard",value:function(e,t){var n=this;if(!0===z.native||z.platform===I.SDK)return new he.a((function(i){n.engineService.fireEvent(Lt.NativeShare,{type:t,value:e}),i.next(!0),i.complete()}));if(this.getClipboardAPISupport()){var i=this.getClipboardAPI();return new he.a((function(t){i.writeText(e).then((function(){t.next(!0),t.complete()})).catch((function(e){t.next(!1),t.complete()}))}))}return Object($.a)(!1)}},{key:"copyInputFieldValue",value:function(e){e.select();var t=!1;try{t=document.execCommand("copy")}catch(n){t=!1}return t}}]),e}()).\u0275fac=function(e){return new(e||Ns)(_.Zb(Nt))},Ns.\u0275prov=_.Lb({token:Ns,factory:Ns.\u0275fac,providedIn:"root"}),Ns),Ys=h("dNgK"),el=["app-button",""],tl=function(e,t,n,i,o,a,r,c,s,l,p,u,d,g,h,f,b,v,m,y,x,w){return{"app-button--xsmall":e,"app-button--small":t,"app-button--medium":n,"app-button--large":i,"app-button--flat":o,"app-button--default":a,"app-button--primary":r,"app-button--info":c,"app-button--outline":s,"app-button--text":l,"app-button--light":p,"app-button--dark":u,"app-button--themed":d,"app-button--circle":g,"app-button--rounded":h,"app-button--square":f,"app-button--selected":b,"app-button--uppercase":v,"app-button--disabled":m,"app-button--no-border":y,"app-button--expanded":x,"app-button--left":w}},nl=["*"],il=function(e){return e.XSmall="xsmall",e.Small="small",e.Medium="medium",e.Large="large",e}({}),ol=function(e){return e.Default="default",e.Flat="flat",e.Primary="primary",e.Info="info",e.Outline="outline",e.Text="text",e}({}),al=function(e){return e.Default="default",e.Circle="circle",e.Rounded="rounded",e.Square="square",e}({}),rl=function(e){return e.Dark="dark",e.Light="light",e.Themed="themed",e}({}),cl=function(e){return e.Left="left",e.Center="center",e}({}),sl=((Qs=function(){function e(){m(this,e),this.buttonSize=il.Medium,this.buttonType=ol.Default,this.buttonTheme=rl.Dark,this.buttonShape=al.Default,this.buttonAlign=cl.Center,this.uppercase=!0,this.selected=!1,this.expanded=!1,this.bordered=!0}return v(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||Qs)},Qs.\u0275cmp=_.Jb({type:Qs,selectors:[["button","app-button",""],["a","app-button",""]],hostVars:1,hostBindings:function(e,t){2&e&&_.Yb("disabled",t.disabled)},inputs:{buttonSize:"buttonSize",buttonType:"buttonType",buttonTheme:"buttonTheme",buttonShape:"buttonShape",buttonAlign:"buttonAlign",uppercase:"uppercase",selected:"selected",expanded:"expanded",disabled:"disabled",bordered:"bordered"},attrs:el,ngContentSelectors:nl,decls:3,vars:24,consts:[[1,"app-button",3,"ngClass"],[1,"app-button__container"]],template:function(e,t){1&e&&(_.kc(),_.Vb(0,"div",0),_.Vb(1,"div",1),_.jc(2),_.Ub(),_.Ub()),2&e&&_.lc("ngClass",_.tc(1,tl,["xsmall"==t.buttonSize,"small"==t.buttonSize,"medium"==t.buttonSize,"large"==t.buttonSize,"flat"==t.buttonType,"default"==t.buttonType,"primary"==t.buttonType,"info"==t.buttonType,"outline"==t.buttonType,"text"==t.buttonType,"light"==t.buttonTheme,"dark"==t.buttonTheme,"themed"==t.buttonTheme,"circle"==t.buttonShape,"rounded"==t.buttonShape,"square"==t.buttonShape,t.selected,t.uppercase,t.disabled,!t.bordered,t.expanded,"left"===t.buttonAlign]))},directives:[or.i],styles:['.text-8{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-header{font-weight:700}.text--code{font-family:Courier New,Courier,monospace}.text-uppercase{text-transform:uppercase}.text-xlight{font-weight:200}.text-light{font-weight:300}.text-medium{font-weight:500}.text-semibold{font-weight:600}.text-bold{font-weight:700}.text-underline{text-decoration:underline}.text-italic{font-style:italic}.text-bright{color:#fff}.text-dim{color:#96a8c0}.text-error{color:#ed4758}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.text-ellipsis{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link,.text-link:visited{color:inherit;cursor:pointer}.text-link:not(.text-underline),.text-link:visited:not(.text-underline){text-decoration:none}.text-success{color:#38de38}.text-danger{color:#de3838}.text-info{color:#0060c4}.text-nowrap{white-space:nowrap}.text-pre-line{white-space:pre-line}a[app-button],button[app-button]{border-color:transparent;background:none;border-width:0;padding:0;margin:0;outline:0 none}a[app-button]:not([disabled]):hover,button[app-button]:not([disabled]):hover{cursor:pointer}a[app-button]:focus .app-button--themed,button[app-button]:focus .app-button--themed{background:#f1f4fa;outline:none}.app-button{font-size:12px;letter-spacing:.3px;line-height:1.4em;align-items:center;border-radius:4px;display:flex;font-family:Inter UI,sans-serif;justify-content:center;padding:0 16px;position:relative;text-align:center;transition:background-color .12s;width:100%}.app-button:after{content:" ";background-color:#283853;border-radius:4px;display:block;position:absolute;left:0;top:0;bottom:0;right:0;opacity:0;z-index:1;transition:opacity .06s}.app-button:not(.app-button--disabled):hover:after{opacity:.7}.app-button__container{position:relative;z-index:2;width:100%}.app-button--uppercase{text-transform:uppercase}.app-button--expanded{display:flex;flex:1}.app-button--xsmall{height:24px;min-width:24px;padding:0 8px;font-size:10px;letter-spacing:.25px;line-height:1.4em}.app-button--small{height:32px;min-width:32px;padding:0 12px}.app-button--medium,.app-button--small{font-size:12px;letter-spacing:.3px;line-height:1.4em}.app-button--medium{height:36px;min-width:36px;padding:0 16px}.app-button--large{height:48px;min-width:48px;padding:0 16px;font-size:14px;letter-spacing:.35px;line-height:1.4em}.app-button--no-border,.app-button--no-border:after{border-radius:0!important}.app-button--left{text-align:left}.app-button--themed{color:#374a68;color:var(--app-button-color)}.app-button--themed:hover{color:#1c2a3f;color:var(--app-button-color--hover)}.app-button--themed:after{background-color:#d7e0ea;background-color:var(--app-button-bg--hover)}.app-button--dark{color:#d7e0ea}.app-button--dark:hover{color:#fff}.app-button--dark:after{background-color:#283853}.app-button--dark.app-button--flat{background:#374a68}.app-button--dark.app-button--default{background:transparent}.app-button--dark.app-button--outline{background:transparent;border:1px solid #374a68;transition:border-color .12s}.app-button--dark.app-button--outline:hover{border-color:#96a8c0}.app-button--dark.app-button--outline:hover:after{background-color:transparent;display:none}.app-button--dark.app-button--text{background:transparent;color:#d7e0ea}.app-button--dark.app-button--text:hover{color:#fff}.app-button--dark.app-button--text:hover:after{display:none}.app-button--dark.app-button--selected{background-color:#1c5ab9;color:#fff}.app-button--dark.app-button--selected:hover:after{display:none}.app-button--light{color:#283853}.app-button--light:hover{color:#1c2a3f}.app-button--light:after{background-color:#96a8c0}.app-button--light:not(.app-button--disabled):hover:after{opacity:.6}.app-button--light.app-button--flat{background:#d7e0ea;font-weight:500}.app-button--light.app-button--flat.app-button--selected{background-color:#96a8c0}.app-button--light.app-button--default{background:transparent;color:#131c2a}.app-button--light.app-button--default:not(.app-button--disabled):hover:after{opacity:.2}.app-button--light.app-button--outline{background:transparent;border:1px solid #96a8c0;color:#283853;transition:border-color .12s}.app-button--light.app-button--outline:after{display:none}.app-button--light.app-button--outline:hover{background:rgba(55,74,104,.05);border-color:#374a68;color:#1c2a3f}.app-button--light.app-button--outline:hover:after{background-color:transparent}.app-button--light.app-button--selected{background-color:#eaeff5}.app-button--light.app-button--selected:hover:after{display:none}.app-button--light.app-button--text{color:#283853}.app-button--light.app-button--text:hover{color:#1c2a3f}.app-button--light.app-button--text:hover:after{display:none}.app-button.app-button--primary{background:#de3838;color:#fff}.app-button.app-button--primary:after{background:#f9fafd}.app-button.app-button--primary:hover:after{opacity:.1}.app-button.app-button--info{background:#2d72dc;color:#fff}.app-button.app-button--info:after{background:#f9fafd}.app-button.app-button--info:hover:after{opacity:.1}.app-button--selected{background-color:#1c5ab9}.app-button--disabled{opacity:.5}.app-button--circle{border-radius:50%}.app-button--circle.app-button--xsmall{width:24px}.app-button--circle.app-button--small{width:32px;padding:0 6px}.app-button--circle.app-button--medium{width:36px;padding:0 8px}.app-button--circle.app-button--large{width:48px}.app-button--circle:after{border-radius:50%}.app-button--square{padding:0}.app-button--square.app-button--xsmall{width:24px;height:24px}.app-button--square.app-button--small{width:32px;height:32px}.app-button--square.app-button--medium{width:36px;height:36px}.app-button--square.app-button--large{width:48px;height:48px}.app-button--rounded,.app-button--rounded:after{border-radius:18px}'],encapsulation:2,changeDetection:0}),Qs),ll=h("STbY"),pl=function(e){return e.All="all",e.iOS="ios",e.Android="android",e}({}),ul=((qs=function(){function e(t,n,i){m(this,e),this.templateRef=t,this.viewContainer=n,this.router=i,this._appFlagApplicationMode="include"}return v(e,[{key:"appFlagApplication",get:function(){return this._appFlagApplication},set:function(e){this._appFlagApplication=e}},{key:"appFlagApplicationMode",get:function(){return this._appFlagApplicationMode},set:function(e){this._appFlagApplicationMode=e}},{key:"appFlagApplicationPage",get:function(){return this._appFlagApplicationPage},set:function(e){this._appFlagApplicationPage=e}},{key:"appFlagApplicationPlatform",get:function(){return this._appFlagApplicationPlatform},set:function(e){this._appFlagApplicationPlatform=e}},{key:"appFlagApplicationNative",get:function(){return this._appFlagApplicationNative},set:function(e){this._appFlagApplicationNative=e}},{key:"ngOnInit",value:function(){this.update()}},{key:"update",value:function(){var e,t=!1,n=!1,i=!1,o=!1;if(""===this.appFlagApplication?t=!0:Array.isArray(this.appFlagApplication)?t=this.appFlagApplication.some((function(e){return e===z.application})):"string"==typeof this.appFlagApplication&&(t=this.appFlagApplication===z.application),null==this.appFlagApplicationPage)n=!0;else{var a=this.router.url;Array.isArray(this.appFlagApplicationPage)?n=this.appFlagApplicationPage.some((function(e){return a.indexOf(e)>=0})):"string"==typeof this.appFlagApplicationPage&&(n=a.indexOf(this.appFlagApplicationPage)>=0)}if(null==this.appFlagApplicationPlatform)i=!0;else{var r=z.platform;Array.isArray(this.appFlagApplicationPlatform)?i=this.appFlagApplicationPlatform.some((function(e){return r.indexOf(e)>=0})):"string"==typeof this.appFlagApplicationPlatform&&(i=r.indexOf(this.appFlagApplicationPlatform)>=0)}null==this.appFlagApplicationNative?o=!0:(o=z.native,(Array.isArray(this.appFlagApplicationNative)?this.appFlagApplicationNative:[this.appFlagApplicationNative]).includes(pl.iOS)&&(o=z.native&&void 0!==window.webkit)),(e=t&&n&&i&&o)&&"include"===this.appFlagApplicationMode||!e&&"exclude"===this.appFlagApplicationMode?this.viewContainer.createEmbeddedView(this.templateRef):this.viewContainer.clear()}}]),e}()).\u0275fac=function(e){return new(e||qs)(_.Pb(_.O),_.Pb(_.S),_.Pb(we.e))},qs.\u0275dir=_.Kb({type:qs,selectors:[["","appFlagApplication",""]],inputs:{appFlagApplication:"appFlagApplication",appFlagApplicationMode:"appFlagApplicationMode",appFlagApplicationPage:"appFlagApplicationPage",appFlagApplicationPlatform:"appFlagApplicationPlatform",appFlagApplicationNative:"appFlagApplicationNative"}}),qs),dl=h("f0Cb"),gl=["nodeActionsTrigger"];function hl(e,t){if(1&e&&(_.Tb(0),_.Vb(1,"button",31),_.Mc(2,"Select"),_.Ub(),_.Qb(3,"mat-divider"),_.Sb()),2&e){_.gc();var n=_.vc(21);_.Db(1),_.lc("matMenuTriggerFor",n)}}function fl(e,t){if(1&e){var n=_.Wb();_.Vb(0,"button",32),_.cc("click",(function(){_.zc(n);var e=_.gc();return e.toggleVisible(e.node,!0)})),_.Mc(1,"Show"),_.Ub()}}function bl(e,t){if(1&e){var n=_.Wb();_.Vb(0,"button",33),_.cc("click",(function(){_.zc(n);var e=_.gc();return e.toggleVisible(e.node,!1)})),_.Mc(1,"Hide"),_.Ub()}}function vl(e,t){if(1&e&&(_.Tb(0),_.Qb(1,"mat-divider"),_.Vb(2,"button",34),_.Mc(3,"Pickable / Unpickable"),_.Ub(),_.Sb()),2&e){_.gc();var n=_.vc(40);_.Db(2),_.lc("matMenuTriggerFor",n)}}function ml(e,t){if(1&e){var n=_.Wb();_.Tb(0),_.Qb(1,"mat-divider"),_.Vb(2,"button",35),_.cc("click",(function(){_.zc(n);var e=_.gc();return e.editNodeLabel(e.node)})),_.Mc(3,"Edit Object Name"),_.Ub(),_.Sb()}}function yl(e,t){if(1&e&&(_.Tb(0),_.Qb(1,"mat-divider"),_.Vb(2,"button",36),_.Mc(3,"Copy"),_.Ub(),_.Sb()),2&e){_.gc();var n=_.vc(47);_.Db(2),_.lc("matMenuTriggerFor",n)}}function xl(e,t){if(1&e){var n=_.Wb();_.Vb(0,"button",37),_.cc("click",(function(){_.zc(n);var e=_.gc();return e.toggleVisible(e.node,!0)})),_.Mc(1,"Show This"),_.Ub()}}function wl(e,t){if(1&e){var n=_.Wb();_.Vb(0,"button",38),_.cc("click",(function(){_.zc(n);var e=_.gc();return e.toggleVisible(e.node,!1)})),_.Mc(1,"Hide This"),_.Ub()}}function kl(e,t){if(1&e){var n=_.Wb();_.Vb(0,"button",39),_.cc("click",(function(){_.zc(n);var e=_.gc();return e.togglePickable(e.node,!1)})),_.Mc(1,"Make Unpickable"),_.Ub()}}function Ol(e,t){if(1&e){var n=_.Wb();_.Vb(0,"button",40),_.cc("click",(function(){_.zc(n);var e=_.gc();return e.togglePickable(e.node,!0)})),_.Mc(1,"Make Pickable"),_.Ub()}}var Cl,Sl,_l=((Sl=function(){function e(t,n,i,o,a,r,c){m(this,e),this.store=t,this.graphService=n,this.changeDetectorRef=i,this.clipboardService=o,this.snackbar=a,this.cameraService=r,this.engineService=c,this.application=j,this.shortId="",this.theme="dark",this.eventCategory="",this.nodeActionsClosed=new _.p}return v(e,[{key:"node",get:function(){return this._node},set:function(e){this._node=e;var t=this.node.id.split("-");this.shortId=2===t.length?t[1]:t[0]}},{key:"ngOnInit",value:function(){}},{key:"isNodeChecked",value:function(e){return this.store.selectSnapshot(Fi.getNodes)[e].checked}},{key:"isNodeShown",value:function(e){return this.store.selectSnapshot(Fi.getNodes)[e].shown}},{key:"checkNode",value:function(e,t){var n=void 0===t?!this.isNodeChecked(e.id):t;this.store.dispatch(new pi.UpdateNodesChecked(n,[e.id]))}},{key:"checkInverse",value:function(e){this.store.dispatch(new pi.UpdateNodesChecked(!0)),this.store.dispatch(new pi.UpdateNodesChecked(!1,[e.id]))}},{key:"setCheckedNodes",value:function(e,t){this.store.dispatch(new pi.UpdateNodesChecked(!1));var n=void 0===t?!this.isNodeChecked(e.id):t;this.store.dispatch(new pi.UpdateNodesChecked(n,[e.id]))}},{key:"flyToNode",value:function(e){this.store.dispatch(new He(e.id))}},{key:"hideNode",value:function(e){this.store.dispatch(new pi.UpdateNodesShown(!1,[e.id]))}},{key:"hideInverse",value:function(e){var t=this.store.selectSnapshot(qa.getViewGraph),n=this.graphService.getAllLeafDescendants(t,[e.id]),i=this.graphService.getInverseSelection(t,[e.id]),o={};n.forEach((function(e){o[e]=!0})),i.forEach((function(e){o[e]=!1}));var a=new pi.UpdateNodesShown(void 0,void 0,o),r=Ci(this.store.selectSnapshot(Fi),a);this.store.dispatch(new pi.ApplyPatch(r.patches));var c,s,l,p=this.engineService.getObjectBoundary(e.id),d=this.cameraService.cameraAfterFlyTo(p),g=new sn(d),h=(c=this.store.selectSnapshot(Fa),s=g,{nextState:(l=u(immer.produceWithPatches(c,(function(e){e.cameraFlyTo=s.camera})),3))[0],patches:l[1],inversePatches:l[2]});this.store.dispatch(new ln(h.patches)),this.store.dispatch(new pi.UpdateNodeSelected),this.store.dispatch(new pi.UpdateNodesChecked(!1)),this.store.dispatch(new ui.SavePatches([{forward:r.patches,inverse:r.inversePatches,patchAction:pi.ApplyPatch},{forward:h.patches,inverse:h.inversePatches,patchAction:ln}]))}},{key:"showNode",value:function(e){this.store.dispatch(new pi.UpdateNodesShown(!0,[e.id])),this.changeDetectorRef.markForCheck()}},{key:"toggleVisible",value:function(e,t){var n=void 0===t?this.isNodeShown(e.id):t;this.store.dispatch(new pi.UpdateNodesShown(n,[e.id])),this.changeDetectorRef.markForCheck()}},{key:"togglePickable",value:function(e,t){this.store.dispatch(new pi.UpdateNodesPickable(t,[e.id])),this.changeDetectorRef.markForCheck()}},{key:"makeEverythingElseUnpickale",value:function(e){this.store.dispatch(new pi.UpdateNodesPickable(!1)),this.store.dispatch(new pi.UpdateNodesPickable(!0,[e.id]))}},{key:"fadeInverseNodes",value:function(e){var t=this.store.selectSnapshot(qa.getViewGraph),n=this.graphService.getInverseSelection(t,[e.id]),i=this.graphService.getNodes(t,n);this.store.dispatch(new pi.UpdateNodesPaint(Gi.recipe,i.map((function(e){return e.id}))))}},{key:"fadeNode",value:function(e){this.store.dispatch(new pi.UpdateNodesPaint(Gi.recipe,[e.id]))}},{key:"editNodeLabel",value:function(e){this.store.dispatch(new bt(e))}},{key:"copy",value:function(e){var t=this;this.clipboardService.copyToClipboard(e,"text").subscribe((function(){t.snackbar.open("Copied ".concat(e," to clipboard."))}))}},{key:"onMenuClosed",value:function(){this.nodeActionsClosed.emit()}}]),e}()).\u0275fac=function(e){return new(e||Sl)(_.Pb(L.g),_.Pb(St),_.Pb(_.i),_.Pb(Xs),_.Pb(Ys.b),_.Pb(dn),_.Pb(Nt))},Sl.\u0275cmp=_.Jb({type:Sl,selectors:[["app-node-actions"]],viewQuery:function(e,t){var n;1&e&&_.Gc(gl,!0),2&e&&_.uc(n=_.dc())&&(t.nodeActionsTrigger=n.first)},inputs:{node:"node",theme:"theme",eventCategory:"eventCategory"},outputs:{nodeActionsClosed:"nodeActionsClosed"},decls:55,vars:21,consts:[[3,"gaCategory"],["app-button","","data-test","nodeActionsTrigger","buttonSize","xsmall",3,"buttonTheme","matMenuTriggerFor","menuClosed"],["nodeActionsTrigger","matMenuTrigger"],["icon","ellipsis-v"],[3,"overlapTrigger"],["nodeActions","matMenu"],[4,"appFlagApplication","appFlagApplicationPage","appFlagApplicationMode"],["gaEvent","","gaAction","Clicked Show","mat-menu-item","","data-test","nodeActionsShow",3,"click",4,"ngIf"],["gaEvent","","gaAction","Clicked Hide","mat-menu-item","","data-test","nodeActionsHide",3,"click",4,"ngIf"],["gaEvent","","gaAction","Clicked Isolate","mat-menu-item","","data-test","nodeActionsIsolate",3,"click"],["data-test","nodeActionsFadeTrigger","mat-menu-item","",3,"matMenuTriggerFor"],[4,"appFlagApplication"],["gaEvent","","gaAction","Clicked Fly To","mat-menu-item","","data-test","nodeActionsFlyTo",3,"click"],["selectActions","matMenu"],["gaEvent","","gaAction","Clicked Select This","mat-menu-item","","data-test","nodeActionsSelectThis",3,"click"],["gaEvent","","gaAction","Clicked Select Everything Else","mat-menu-item","","data-test","nodeActionsSelectEverythingElse",3,"click"],["fadeActions","matMenu"],["gaEvent","","gaAction","Clicked Fade This","mat-menu-item","","data-test","nodeActionsFadeThis",3,"click"],["gaEvent","","gaAction","Clicked Fade Everything Else","mat-menu-item","","data-test","nodeActionsFadeEverythingElse",3,"click"],["showHideActions","matMenu"],["gaEvent","","gaAction","Clicked Show This","mat-menu-item","","data-test","nodeActionsShowThis",3,"click",4,"ngIf"],["gaEvent","","gaAction","Clicked Hide This","mat-menu-item","","data-test","nodeActionsShowEverythingElse",3,"click",4,"ngIf"],["gaEvent","","gaAction","Clicked Hide Everything Else","mat-menu-item","",3,"click"],["pickableActions","matMenu"],["gaEvent","","gaAction","Clicked Make Unpickable","mat-menu-item","","data-test","nodeActionsPickable",3,"click",4,"ngIf"],["gaEvent","","gaAction","Clicked Make Pickable","mat-menu-item","","data-test","nodeActionsUnpickable",3,"click",4,"ngIf"],["gaEvent","","gaAction","Clicked Make Everything Else Unpickable","mat-menu-item","","data-test","nodeActionsEverythingElseUnpickable",3,"click"],["copyActions","matMenu"],["gaEvent","","gaAction","Clicked Copy Short ID","mat-menu-item","","data-test","nodeActionsCopyShortID",3,"click"],["gaEvent","","gaAction","Clicked Copy Full ID","mat-menu-item","","data-test","nodeActionsCopyFullID",3,"click"],["gaEvent","","gaAction","Clicked Copy Display Name","mat-menu-item","","data-test","nodeActionsCopyDisplayName",3,"click"],["mat-menu-item","",3,"matMenuTriggerFor"],["gaEvent","","gaAction","Clicked Show","mat-menu-item","","data-test","nodeActionsShow",3,"click"],["gaEvent","","gaAction","Clicked Hide","mat-menu-item","","data-test","nodeActionsHide",3,"click"],["mat-menu-item","","data-test","nodeActionsPickableTrigger",3,"matMenuTriggerFor"],["gaEvent","","gaAction","Clicked Edit Object Name","mat-menu-item","","data-test","nodeActionsEditName",3,"click"],["mat-menu-item","","data-test","nodeActionsCopyTrigger",3,"matMenuTriggerFor"],["gaEvent","","gaAction","Clicked Show This","mat-menu-item","","data-test","nodeActionsShowThis",3,"click"],["gaEvent","","gaAction","Clicked Hide This","mat-menu-item","","data-test","nodeActionsShowEverythingElse",3,"click"],["gaEvent","","gaAction","Clicked Make Unpickable","mat-menu-item","","data-test","nodeActionsPickable",3,"click"],["gaEvent","","gaAction","Clicked Make Pickable","mat-menu-item","","data-test","nodeActionsUnpickable",3,"click"]],template:function(e,t){if(1&e&&(_.Tb(0,0),_.Vb(1,"button",1,2),_.cc("menuClosed",(function(){return t.onMenuClosed()})),_.Qb(3,"app-icon",3),_.Ub(),_.Vb(4,"mat-menu",4,5),_.Kc(6,hl,4,1,"ng-container",6),_.Kc(7,fl,2,0,"button",7),_.Kc(8,bl,2,0,"button",8),_.Vb(9,"button",9),_.cc("click",(function(){return t.hideInverse(t.node)})),_.Mc(10,"Isolate"),_.Ub(),_.Qb(11,"mat-divider"),_.Vb(12,"button",10),_.Mc(13,"Fade"),_.Ub(),_.Kc(14,vl,4,1,"ng-container",11),_.Qb(15,"mat-divider"),_.Vb(16,"button",12),_.cc("click",(function(){return t.flyToNode(t.node)})),_.Mc(17,"Fly To"),_.Ub(),_.Kc(18,ml,4,0,"ng-container",6),_.Kc(19,yl,4,1,"ng-container",6),_.Ub(),_.Vb(20,"mat-menu",null,13),_.Vb(22,"button",14),_.cc("click",(function(){return t.checkNode(t.node,!0)})),_.Mc(23,"Select This"),_.Ub(),_.Vb(24,"button",15),_.cc("click",(function(){return t.checkInverse(t.node)})),_.Mc(25,"Select Everything Else"),_.Ub(),_.Ub(),_.Vb(26,"mat-menu",null,16),_.Vb(28,"button",17),_.cc("click",(function(){return t.fadeNode(t.node)})),_.Mc(29,"Fade This"),_.Ub(),_.Vb(30,"button",18),_.cc("click",(function(){return t.fadeInverseNodes(t.node)})),_.Mc(31,"Fade Everything Else"),_.Ub(),_.Ub(),_.Vb(32,"mat-menu",null,19),_.Kc(34,xl,2,0,"button",20),_.Kc(35,wl,2,0,"button",21),_.Qb(36,"mat-divider"),_.Vb(37,"button",22),_.cc("click",(function(){return t.hideInverse(t.node)})),_.Mc(38,"Hide Everything Else"),_.Ub(),_.Ub(),_.Vb(39,"mat-menu",null,23),_.Kc(41,kl,2,0,"button",24),_.Kc(42,Ol,2,0,"button",25),_.Qb(43,"mat-divider"),_.Vb(44,"button",26),_.cc("click",(function(){return t.makeEverythingElseUnpickale(t.node)})),_.Mc(45,"Make Everything Else Unpickable"),_.Ub(),_.Ub(),_.Vb(46,"mat-menu",null,27),_.Vb(48,"button",28),_.cc("click",(function(){return t.copy(t.shortId)})),_.Mc(49,"Copy Short ID"),_.Ub(),_.Vb(50,"button",29),_.cc("click",(function(){return t.copy(t.node.id)})),_.Mc(51,"Copy Full ID"),_.Ub(),_.Qb(52,"mat-divider"),_.Vb(53,"button",30),_.cc("click",(function(){return t.copy(t.node.label)})),_.Mc(54,"Copy Display Name"),_.Ub(),_.Ub(),_.Sb()),2&e){var n=_.vc(5),i=_.vc(27);_.lc("gaCategory",t.eventCategory),_.Db(1),_.lc("buttonTheme",t.theme)("matMenuTriggerFor",n),_.Db(3),_.lc("overlapTrigger",!0),_.Db(2),_.lc("appFlagApplication",t.application.All)("appFlagApplicationPage","/edit")("appFlagApplicationMode","include"),_.Db(1),_.lc("ngIf",!t.node.boolState.shown),_.Db(1),_.lc("ngIf",t.node.boolState.shown),_.Db(4),_.lc("matMenuTriggerFor",i),_.Db(2),_.lc("appFlagApplication",t.application.Loft),_.Db(4),_.lc("appFlagApplication",t.application.Loft)("appFlagApplicationPage","/edit")("appFlagApplicationMode","include"),_.Db(1),_.lc("appFlagApplication",t.application.Loft)("appFlagApplicationPage","/edit")("appFlagApplicationMode","include"),_.Db(15),_.lc("ngIf",!t.node.boolState.shown),_.Db(1),_.lc("ngIf",t.node.boolState.shown),_.Db(6),_.lc("ngIf",t.node.boolState.pickable),_.Db(1),_.lc("ngIf",!t.node.boolState.pickable)}},directives:[ke.a,sl,ll.d,Js,ll.a,ul,or.l,ke.b,ll.b,dl.a],styles:[""],changeDetection:0}),Sl),jl=((Cl=function(){function e(t){m(this,e),this.el=t}return v(e,[{key:"ngAfterContentInit",value:function(){var e=this;window.matchMedia("(hover: hover)").matches&&setTimeout((function(){e.el.nativeElement.focus()}),0)}}]),e}()).\u0275fac=function(e){return new(e||Cl)(_.Pb(_.m))},Cl.\u0275dir=_.Kb({type:Cl,selectors:[["input","appAutoFocus",""]]}),Cl),Pl=function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r},Ml=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function Il(e,t){if(1&e){var n=_.Wb();_.Vb(0,"div",9),_.cc("click",(function(){_.zc(n);var e=_.gc();return e.handleExpandClick(e.node,e.node.boolState.expanded)})),_.Qb(1,"app-icon",10),_.Ub()}if(2&e){var i=_.gc();_.Hb("tree-node__expand--open",i.node.boolState.expanded)}}function zl(e,t){if(1&e&&(_.Vb(0,"div",15),_.Mc(1),_.Ub()),2&e){var n=_.gc(2);_.Db(1),_.Oc(" ",n.shortId," ")}}var Tl=function(e){return{"tree-node__label--padded":e}};function Ul(e,t){if(1&e){var n=_.Wb();_.Vb(0,"div",11),_.cc("dblclick",(function(){return _.zc(n),_.gc().setEditLabelMode(!0)})),_.Vb(1,"div",12),_.Kc(2,zl,2,1,"div",13),_.hc(3,"async"),_.Vb(4,"div",14),_.Mc(5),_.Ub(),_.Ub(),_.Ub()}if(2&e){var i=_.gc();_.lc("ngClass",_.oc(5,Tl,!i.hasChildren&&i.nested)),_.Db(2),_.lc("ngIf",_.ic(3,3,i.showTreeNodeIds$)),_.Db(3),_.Oc(" ",i.node.label," ")}}function Ll(e,t){if(1&e){var n=_.Wb();_.Vb(0,"input",16),_.cc("blur",(function(e){return _.zc(n),_.gc().handleObjectLabel(e)}))("keyup",(function(e){return _.zc(n),_.gc().handleObjectLabel(e)})),_.Ub()}if(2&e){var i=_.gc();_.lc("value",i.node.label)}}function Dl(e,t){if(1&e){var n=_.Wb();_.Vb(0,"input",17),_.cc("change",(function(e){_.zc(n);var t=_.gc();return t.handleLayerOrder(e,t.node)})),_.Ub()}if(2&e){var i=_.gc();_.lc("value",i.node.numState.layer)}}var El,Fl=function(e,t,n,i,o){return{"tree-node--light":e,"tree-node--themed":t,"tree-node--hidden":n,"tree-node--selected":i,"tree-node--unpickable":o}},Al=((El=function(){function e(t,n,i,o,a){m(this,e),this.store=t,this.graphService=n,this.engineService=i,this.router=o,this.changeDetection=a,this.treeTheme=gs,this.isLoft="module"===z.exportType,this.nested=!0,this.theme=gs.Dark,this.checked=!1,this.hasChildren=!1,this.editLabelMode=!1,this.sanitizedID="",this.parentId="",this.shortId="",this.ngUnsubscribe=new ge.a}return v(e,[{key:"node",get:function(){return this._node},set:function(e){this._node=e,this.sanitizedID=this.graphService.sanitizeNodeID(this.node.id),this.checked=this.isNodeChecked(this.node.id);var t=this.node.id.split("-");2===t.length?(this.parentId=t[0],this.shortId=t[1]):(this.shortId=t[0],this.parentId=""),this.shortId=this.shortId.replace(/_/g," "),this.nested&&(this.hasChildren=ye.getSuccessors(this.graph,this.node.id).length>0),this.changeDetection.markForCheck()}},{key:"isNodeChecked",value:function(e){return this.store.selectSnapshot(Fi.getNodes)[e].checked}},{key:"isNodeShown",value:function(e){return this.store.selectSnapshot(Fi.getNodes)[e].shown}},{key:"ngOnInit",value:function(){var e=this;this.checkedNodesIds$.pipe(Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){e.checked=t.some((function(t){return t===e.node.id})),e.changeDetection.markForCheck()})),this.labelEditNode$.pipe(Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){e.editLabelMode=t===e.node})),this.isEditMode=this.router.url.indexOf("/edit")>=0}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"handleExpandClick",value:function(e,t){this.store.dispatch(t?new ht(e):new gt(e))}},{key:"handleNodeClick",value:function(e,t){e.shiftKey?this.checkNode(t):(this.setCheckedNodes(t),this.isFlyToNodeEnabled(t)&&this.store.dispatch(new He(t.id)),this.handleExpandClick(t,!t.boolState.expanded))}},{key:"toggleVisible",value:function(e,t){var n=void 0===t?!this.isNodeShown(e.id):t;this.store.dispatch(new pi.UpdateNodesShown(n,[e.id])),this.changeDetection.markForCheck()}},{key:"handleLayerOrder",value:function(e,t){var n=parseInt(e.target.value,10);this.setLayerOrder(t,n)}},{key:"checkNode",value:function(e,t){var n=void 0===t?!this.isNodeChecked(e.id):t;this.store.dispatch(new pi.UpdateNodesChecked(n,[e.id]))}},{key:"setCheckedNodes",value:function(e,t){this.store.dispatch(new pi.UpdateNodesChecked(!1));var n=void 0===t?!this.isNodeChecked(e.id):t;this.store.dispatch(new pi.UpdateNodesChecked(n,[e.id]))}},{key:"setLayerOrder",value:function(e,t){this.store.dispatch(new ot([e],t)),this.changeDetection.markForCheck()}},{key:"handleObjectLabel",value:function(e){var t=e.target;e instanceof KeyboardEvent?("enter"===e.key.toLowerCase()&&(this.setLabel(t.value),this.setEditLabelMode(!1)),"escape"===e.key.toLowerCase()&&this.setEditLabelMode(!1)):e instanceof FocusEvent&&"blur"===e.type&&(this.setLabel(t.value),this.setEditLabelMode(!1))}},{key:"setLabel",value:function(e){this.node.label=e,this.store.dispatch(new at(this.node.id,e))}},{key:"setEditLabelMode",value:function(e){z.application===j.Loft&&this.isEditMode&&this.store.dispatch(new bt(e?this.node:null))}},{key:"isFlyToNodeEnabled",value:function(e){return!this.isEditMode&&(e.boolState.shown||this.engineService.getObjectLoaded(e.id))}}]),e}()).\u0275fac=function(e){return new(e||El)(_.Pb(L.g),_.Pb(St),_.Pb(Nt),_.Pb(we.e),_.Pb(_.i))},El.\u0275cmp=_.Jb({type:El,selectors:[["app-tree-nested-node"]],inputs:{graph:"graph",node:"node",nested:"nested",theme:"theme"},decls:10,vars:17,consts:[["gaCategory","Search Node","data-test","treeNode","tabindex","0",1,"tree-node",3,"ngClass","keyup.enter","click"],["appEventFence","","class","tree-node__expand","data-test","treeNodeExpand",3,"tree-node__expand--open","click",4,"ngIf"],["class","tree-node__label",3,"ngClass","dblclick",4,"ngIf"],["type","text","appEventFence","","appAutoFocus","","data-test","treeNodeEditLabel","class","input",3,"value","blur","keyup",4,"ngIf"],["appEventFence","","type","text","data-test","treeNodeLayerOrder","class","input input--small tree-node__layer-order",3,"value","change",4,"ngIf"],["gaEvent","","gaAction","Clicked Toggle (Eye Icon)","data-test","treeNodeVisible","appEventFence","",1,"tree-node__visible",3,"gaLabel","click"],["icon","eye","data-test","treeNodeVisibleTrue","size","xs",1,"tree-node__eye"],["icon","eye-slash","data-test","treeNodeVisibleFalse","size","xs",1,"tree-node__eye-slash"],["eventCategory","Search Node","appEventFence","",3,"theme","node"],["appEventFence","","data-test","treeNodeExpand",1,"tree-node__expand",3,"click"],["icon","caret-right"],[1,"tree-node__label",3,"ngClass","dblclick"],[1,"flex","flex-column"],["data-test","treeNodeId","class","text-10 text-uppercase","style","opacity: 0.7;",4,"ngIf"],["data-test","treeNodeLabel"],["data-test","treeNodeId",1,"text-10","text-uppercase",2,"opacity","0.7"],["type","text","appEventFence","","appAutoFocus","","data-test","treeNodeEditLabel",1,"input",3,"value","blur","keyup"],["appEventFence","","type","text","data-test","treeNodeLayerOrder",1,"input","input--small","tree-node__layer-order",3,"value","change"]],template:function(e,t){1&e&&(_.Vb(0,"div",0),_.cc("keyup.enter",(function(e){return t.handleNodeClick(e,t.node)}))("click",(function(e){return t.handleNodeClick(e,t.node)})),_.Kc(1,Il,2,2,"div",1),_.Kc(2,Ul,6,7,"div",2),_.Kc(3,Ll,1,1,"input",3),_.Kc(4,Dl,1,1,"input",4),_.hc(5,"async"),_.Vb(6,"div",5),_.cc("click",(function(){return t.toggleVisible(t.node)})),_.Qb(7,"app-icon",6),_.Qb(8,"app-icon",7),_.Ub(),_.Qb(9,"app-node-actions",8),_.Ub()),2&e&&(_.lc("ngClass",_.sc(11,Fl,t.theme===t.treeTheme.Light,t.theme===t.treeTheme.Themed,!t.node.boolState.shown,t.checked,!t.node.boolState.pickable&&t.isLoft)),_.Eb("data-id",t.sanitizedID),_.Db(1),_.lc("ngIf",t.nested&&t.hasChildren),_.Db(1),_.lc("ngIf",!t.editLabelMode),_.Db(1),_.lc("ngIf",t.editLabelMode),_.Db(1),_.lc("ngIf",_.ic(5,9,t.layerOrderMode$)),_.Db(2),_.lc("gaLabel",t.node.boolState.shown?"Hide":"Show"),_.Db(3),_.lc("theme",t.theme)("node",t.node))},directives:[ke.a,or.i,or.l,ke.b,Zs,Js,_l,jl],pipes:[or.b],styles:[".text-8{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-header{font-weight:700}.text--code{font-family:Courier New,Courier,monospace}.text-uppercase{text-transform:uppercase}.text-xlight{font-weight:200}.text-light{font-weight:300}.text-medium{font-weight:500}.text-semibold{font-weight:600}.text-bold{font-weight:700}.text-underline{text-decoration:underline}.text-italic{font-style:italic}.text-bright{color:#fff}.text-dim{color:#96a8c0}.text-error{color:#ed4758}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.text-ellipsis{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link,.text-link:visited{color:inherit;cursor:pointer}.text-link:not(.text-underline),.text-link:visited:not(.text-underline){text-decoration:none}.text-success{color:#38de38}.text-danger{color:#de3838}.text-info{color:#0060c4}.text-nowrap{white-space:nowrap}.text-pre-line{white-space:pre-line}:host{display:block}.tree-node{margin:4px 0;display:flex;align-items:center;height:100%;border-radius:4px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;min-width:200px;transition:background-color .12s}.tree-node--themed{padding-right:12px;border-radius:2px;border-left:var(--tree-node-border)}.tree-node--themed:focus{background:#f1f4fa;outline:none}.tree-node--themed .tree-node__label{color:#131c2a;color:var(--tree-node-color);font-size:13px;letter-spacing:.325px;line-height:1.4em}.tree-node--themed.tree-node--selected{border-left:4px solid #2d72dc;background-color:#f1f5fc;background:var(--tree-node-bg--selected);border-left:var(--tree-node-border--selected)}.tree-node--themed.tree-node--selected .tree-node__actions,.tree-node--themed.tree-node--selected .tree-node__label{color:#131c2a;color:var(--tree-node-color--selected)}.tree-node--themed.tree-node--selected .tree-node__actions,.tree-node--themed.tree-node--selected .tree-node__expand,.tree-node--themed.tree-node--selected .tree-node__visible{background-color:#f1f5fc;color:#131c2a;background-color:var(--tree-node-button-bg--selected);color:var(--tree-node-button-color--selected)}.tree-node--themed.tree-node--unpickable{border:1px dashed #d7e0ea}.tree-node--themed.tree-node--hidden .tree-node__label{color:#96a8c0;color:var(--tree-node-color--hidden)}.tree-node--themed .tree-node__actions,.tree-node--themed .tree-node__expand,.tree-node--themed .tree-node__visible{background-color:transparent;background-color:var(--tree-node-button-bg);color:#96a8c0;color:var(--tree-node-button-color);border-radius:4px}.tree-node--light .tree-node__label{color:#283853;font-weight:400;font-size:14px;line-height:1.33em}.tree-node--light.tree-node--selected .tree-node__actions,.tree-node--light.tree-node--selected .tree-node__expand,.tree-node--light.tree-node--selected .tree-node__label,.tree-node--light.tree-node--selected .tree-node__visible{color:#fff}.tree-node--light.tree-node--unpickable{border:1px dashed #d7e0ea}.tree-node--light.tree-node--hidden .tree-node__label{color:#96a8c0;font-weight:300}.tree-node--light .tree-node__actions,.tree-node--light .tree-node__expand,.tree-node--light .tree-node__visible{color:#6a82a4;border-radius:4px}.tree-node--selected{background-color:#2d72dc}.tree-node--selected .tree-node__label{color:#fff}.tree-node--unpickable{border:1px dashed #6a82a4}.tree-node--hidden .tree-node__actions,.tree-node--hidden .tree-node__expand,.tree-node--hidden .tree-node__label,.tree-node--hidden .tree-node__visible,.tree-node.tree-node--hidden.tree-node--selected .tree-node__actions,.tree-node.tree-node--hidden.tree-node--selected .tree-node__expand,.tree-node.tree-node--hidden.tree-node--selected .tree-node__label,.tree-node.tree-node--hidden.tree-node--selected .tree-node__visible{color:#96a8c0}.tree-node--hidden .tree-node__visible,.tree-node.tree-node--hidden.tree-node--selected .tree-node__visible{visibility:visible}.tree-node__label{font-size:12px;letter-spacing:.3px;line-height:1.4em;letter-spacing:.5px;font-weight:400;line-height:1.3em;color:#d7e0ea;padding:8px 4px 8px 12px;display:flex;align-items:center;flex:1 1 100%;min-height:28px}.tree-node__label--padded{padding-left:32px}.tree-node__expand i{transition:transform .12s}.tree-node__expand--open app-icon{transform:rotate(45deg)}.tree-node .tree-node__expand+.tree-node__label{margin-left:-8px}.tree-node__actions,.tree-node__expand,.tree-node__visible{border-radius:4px;color:#d7e0ea;display:flex;flex:0 0 30px;height:30px;justify-content:center;align-items:center}.tree-node__layer-order{font-size:10px;flex:0 0 56px;min-height:28px;height:28px;padding:4px;margin:2px;text-align:center}.tree-node .tree-node__eye,.tree-node .tree-node__eye-slash{display:none}.tree-node.tree-node--hidden .tree-node__eye-slash,.tree-node:not(.tree-node--hidden) .tree-node__eye{display:inline}@media (hover:hover){.tree-node__actions,.tree-node__visible{visibility:hidden}.tree-node:hover{cursor:pointer}.tree-node:hover .tree-node__actions,.tree-node:hover .tree-node__visible{visibility:visible}.tree-node:hover .tree-node__label{color:#fff}.tree-node--themed:hover{cursor:pointer;background:var(--tree-node-bg--hover)}.tree-node--themed:hover .tree-node__label{color:#131c2a;color:var(--tree-node-color--hover)}.tree-node--themed.tree-node--selected:hover{background-color:#f1f5fc;background-color:var(--tree-node-bg--selected)}.tree-node--themed.tree-node--selected .tree-node__actions:hover,.tree-node--themed.tree-node--selected .tree-node__expand:hover,.tree-node--themed.tree-node--selected .tree-node__visible:hover{background-color:var(--tree-node-button-bg--hover);color:var(--tree-node-button-color--hover)}.tree-node--themed .tree-node__actions:hover,.tree-node--themed .tree-node__expand:hover,.tree-node--themed .tree-node__visible:hover{background-color:transparent;color:inherit;background-color:var(--tree-node-button-bg--hover);color:var(--tree-node-button-color--hover)}.tree-node--light:hover{background:rgba(234,239,245,.5)}.tree-node--light:hover .tree-node__label{color:#131c2a}.tree-node--light.tree-node--selected:hover{background:#2d72dc}.tree-node--light.tree-node--selected .tree-node__actions:hover,.tree-node--light.tree-node--selected .tree-node__expand:hover,.tree-node--light.tree-node--selected .tree-node__visible:hover{color:#f9fafd}.tree-node--light .tree-node__actions:hover,.tree-node--light .tree-node__expand:hover,.tree-node--light .tree-node__visible:hover{background-color:#eaeff5;color:#131c2a}.tree-node__actions:hover,.tree-node__expand:hover,.tree-node__visible:hover{background-color:#1c2a3f;color:#fff;cursor:pointer}.tree-node--selected .tree-node__actions:hover,.tree-node--selected .tree-node__expand:hover,.tree-node--selected .tree-node__visible:hover{background-color:#2d72dc}.tree-node .tree-node__eye,.tree-node .tree-node__eye-slash{display:none}.tree-node.tree-node--hidden .tree-node__eye-slash,.tree-node:hover:not(.tree-node--hidden) .tree-node__eye{display:inline}}"],encapsulation:2,changeDetection:0}),Pl([Object(L.d)(Fi.getCheckedNodeIds),Ml("design:type",he.a)],El.prototype,"checkedNodesIds$",void 0),Pl([Object(L.d)(Gs.getLayerOrderMode),Ml("design:type",he.a)],El.prototype,"layerOrderMode$",void 0),Pl([Object(L.d)(qa.getLabelEditNode),Ml("design:type",he.a)],El.prototype,"labelEditNode$",void 0),Pl([Object(L.d)(Gs.getShowTreeNodeIds),Ml("design:type",he.a)],El.prototype,"showTreeNodeIds$",void 0),El);function Rl(e,t){1&e&&(_.Vb(0,"div",4),_.Mc(1," No results "),_.Ub())}function Nl(e,t){if(1&e&&(_.Vb(0,"div",5),_.Qb(1,"app-tree",6),_.Ub()),2&e){var n=_.gc();_.Db(1),_.lc("theme",n.theme)("searchGraph",n.searchGraph)}}function Vl(e,t){if(1&e&&(_.Vb(0,"div"),_.Qb(1,"app-tree-nested-node",9),_.Ub()),2&e){var n=t.$implicit,i=_.gc(2);_.Db(1),_.lc("theme",i.theme)("nested",!1)("node",n)("graph",i.prunedViewGraph)}}function Hl(e,t){if(1&e&&(_.Vb(0,"cdk-virtual-scroll-viewport",7),_.Kc(1,Vl,2,4,"div",8),_.Ub()),2&e){var n=_.gc();_.Hc("height",n.searchHeight,"px"),_.lc("itemSize",64),_.Db(1),_.lc("cdkVirtualForOf",n.searchResults)("cdkVirtualForTrackBy",n.trackTreeNode)}}var Bl,Ql,ql,Wl=function(e){return e[e.List=0]="List",e[e.Tree=1]="Tree",e}({}),$l=((Bl=function(){function e(t,n,i,o,a){m(this,e),this.renderer=t,this.changeDetectorRef=n,this.elementRef=i,this.engineService=o,this.store=a,this._query="",this._displayMode=Wl.List,this.displayModeChange=new _.p,this.theme=gs.Dark,this.treeSearchDisplayMode=Wl,this.searchResults=[],this.searchHeight=0,this.ngUnsubscribe=new ge.a}return v(e,[{key:"query",get:function(){return this._query},set:function(e){this._query=e||"",this.handleQueryChange()}},{key:"displayMode",get:function(){return this._displayMode},set:function(e){null!=e&&(this._displayMode=e,this.handleQueryChange(),this.displayModeChange.emit(this.displayMode))}},{key:"viewGraph",get:function(){return this._viewGraph},set:function(e){this._viewGraph=e,this.leafNodes=this.engineService.getLeaves(),this.buildPrunedViewGraph(this.displayMode),this.handleQueryChange(),this.changeDetectorRef.markForCheck()}},{key:"ngOnInit",value:function(){}},{key:"buildPrunedViewGraph",value:function(e){var t=this.store.selectSnapshot(Ua.getSelectedChapter),n=this.engineService.createViewGraph(t.showObjects,!0);this.prunedViewGraph=n}},{key:"ngAfterViewInit",value:function(){var e=this;this.renderer.listen("window","resize",(function(t){e.resize()}))}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"handleQueryChange",value:function(){var e=this.search(this._query,this.displayMode===Wl.List?this.prunedViewGraph:this.viewGraph);this.displayMode===Wl.Tree&&(this.searchGraph=function(e,t){return t.reduce((function(t,n){return function e(t,n,i){ye.addNode(t,n);var o=ye.getAncestor(i,n.id);if(o){var a=t.successors[o]||[];return a.push(n.id),t.successors[o]=Object(Oe.uniq)(a),t.predecessors[n.id]=o,e(t,ye.getNode(i,o),i)}return ye.addRootNode(t,n),t}(t,n,e)}),{nodes:{},successors:{},predecessors:{},roots:{}})}(this.viewGraph,e)),this.searchResults=e,this.resize()}},{key:"resize",value:function(){var e=this;this.getSearchHeight().pipe(Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){e.searchHeight=t,e.changeDetectorRef.markForCheck()}))}},{key:"getSearchHeight",value:function(){var e=this;return new he.a((function(t){setTimeout((function(){var n=e.elementRef.nativeElement.offsetHeight;null!=n&&(t.next(n),t.complete())}))}))}},{key:"search",value:function(e,t){return void 0===t?[]:(e=Object(fs.remove)(e.toLowerCase()),Object.values(t.nodes).filter((function(t){return 0===e.length||Object(fs.remove)(t.label.toLowerCase()).indexOf(e)>=0})).sort((function(e,t){return e.label.localeCompare(t.label)})))}},{key:"trackTreeNode",value:function(e,t){return t.id}}]),e}()).\u0275fac=function(e){return new(e||Bl)(_.Pb(_.H),_.Pb(_.i),_.Pb(_.m),_.Pb(Nt),_.Pb(L.g))},Bl.\u0275cmp=_.Jb({type:Bl,selectors:[["app-tree-search"]],inputs:{query:"query",displayMode:"displayMode",viewGraph:"viewGraph",theme:"theme"},outputs:{displayModeChange:"displayModeChange"},decls:4,vars:3,consts:[[1,"tree-search"],["class","tree-search__empty",4,"ngIf"],["class","pr-3 pv-3",4,"ngIf"],["class","pv-3",3,"itemSize","height",4,"ngIf"],[1,"tree-search__empty"],[1,"pr-3","pv-3"],[1,"tree-search__tree",3,"theme","searchGraph"],[1,"pv-3",3,"itemSize"],[4,"cdkVirtualFor","cdkVirtualForOf","cdkVirtualForTrackBy"],[1,"mr-3",2,"height","64px",3,"theme","nested","node","graph"]],template:function(e,t){1&e&&(_.Vb(0,"div",0),_.Kc(1,Rl,2,0,"div",1),_.Kc(2,Nl,2,2,"div",2),_.Kc(3,Hl,2,5,"cdk-virtual-scroll-viewport",3),_.Ub()),2&e&&(_.Db(1),_.lc("ngIf",0===t.searchResults.length),_.Db(1),_.lc("ngIf",t.displayMode===t.treeSearchDisplayMode.Tree),_.Db(1),_.lc("ngIf",t.displayMode===t.treeSearchDisplayMode.List))},directives:[or.l,hs,bs.e,bs.a,bs.d,Al],styles:[".text-8{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-header{font-weight:700}.text--code{font-family:Courier New,Courier,monospace}.text-uppercase{text-transform:uppercase}.text-xlight{font-weight:200}.text-light{font-weight:300}.text-medium{font-weight:500}.text-semibold{font-weight:600}.text-bold{font-weight:700}.text-underline{text-decoration:underline}.text-italic{font-style:italic}.text-bright{color:#fff}.text-dim{color:#96a8c0}.text-error{color:#ed4758}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.text-ellipsis{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link,.text-link:visited{color:inherit;cursor:pointer}.text-link:not(.text-underline),.text-link:visited:not(.text-underline){text-decoration:none}.text-success{color:#38de38}.text-danger{color:#de3838}.text-info{color:#0060c4}.text-nowrap{white-space:nowrap}.text-pre-line{white-space:pre-line}.tree-search{display:flex;flex-direction:column;flex:1 1 auto;height:100%}.tree-search__tree{flex-grow:1;width:100%}.tree-search__empty{font-size:14px;letter-spacing:.35px;line-height:1.4em;padding:12px;font-style:italic;margin-top:12px}.tree-search cdk-virtual-scroll-viewport{flex:1 1 auto}.tree-search cdk-virtual-scroll-viewport .cdk-virtual-scroll-content-wrapper{padding-right:12px}"],encapsulation:2,changeDetection:0}),Bl),Kl=function(e){return e.Play="play",e.Button="button",e.Hand="hand",e}({}),Gl=function(e){return e[e.OnDemand=0]="OnDemand",e[e.Interact=1]="Interact",e[e.Loader=2]="Loader",e[e.Tutorial=3]="Tutorial",e[e.Whiteboard=4]="Whiteboard",e[e.Help=5]="Help",e}({}),Zl=function(e){return e[e.Text=0]="Text",e[e.Paint=1]="Paint",e[e.Erase=2]="Erase",e}({}),Jl=[4,8,12,16,24,32],Xl=function(e){return e.slice(0).reverse().map((function(e){return{label:""+e,size:e}}))},Yl=Xl(Jl),ep=Xl([8,12,16,20,24,32]),tp=Xl(Jl),np=[].concat(s(Zi.map((function(e){var t=e.label,n=e.recipe,i=Array.isArray(n.tintColor)?n.tintColor:[1,1,1];return{label:t,color:ba.rgbToHex(i,!0)}}))),[{label:"White",color:"#ffffff"}]),ip=Yl[4],op=np[0],ap=ep[3],rp=tp[4],cp=function(e){return e.Mouse="mouse",e.Touch="touch",e}({}),sp=function(e){return e[e.Default=0]="Default",e.DrawerOnly="drawer",e}({}),lp=function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r},pp=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},up=function e(){m(this,e)},dp={audio:new rs,camera:new rs(ns.Show,!0),chapterList:new rs(ns.Show,!1),column:new rs,description:new rs,drawer:new(function(e){t(o,e);var n=i(o);function o(){var e,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return m(this,o),(e=n.call(this)).isExpandedInitially=t,e}return o}(rs)),fullscreen:new rs,help:new rs,labels:new rs,labelInfo:new rs,labelList:new rs(ns.Show,!1),loader:new(function(e){t(o,e);var n=i(o);function o(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:as;return m(this,o),(e=n.call(this)).template=t,e}return o}(rs)),logo:new(function(e){t(o,e);var n=i(o);function o(){var e,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return m(this,o),(e=n.call(this)).isHyperLink=t,e}return o}(rs)),media:new(function(e){t(o,e);var n=i(o);function o(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:is.Small;return m(this,o),(e=n.call(this)).template=t,e}return o}(rs)),menu:new rs,nodeInfo:new rs(ns.Hide,!1),pagination:new rs,presenter:new rs(ns.Hide,!1),reset:new rs,search:new rs,quiz:new rs,titleOnly:new rs,toolbar:new rs,tools:new rs,anatomyLabels:new rs,tutorial:new rs(ns.Hide,!1),internetExplorerWarning:new rs,legend:new rs,undo:new rs,whiteboard:new rs,visibilityLayers:new rs,contextActions:new rs,toggleLabels:new rs},gp={canFullscreen:!1,canHover:!1,canTouch:!1,drawerCoversContent:!1,fullscreenActive:!1,help:{tab:ve.Basics},initialUI:dp,inputEnabled:!0,inputMode:cp.Mouse,interactType:Kl.Play,onDemand:!1,layout:sp.Default,labelsBreakpoint:480,menuOpen:!1,multiPickModeEnabled:!1,openWindows:[Gl.Loader],presentationActive:!1,searchDisplayMode:Wl.Tree,showNodeInfo:!1,tutorial:{pageSize:0,pageIndex:-1},tutorialSeen:!0,ui:dp,usePrintImage:!1,whiteboard:{enabled:!1,hasPaint:!1,hasText:!1,brushSize:ip.size,brushColor:op.color,textSize:ap.size,eraserSize:rp.size,annotateMode:Zl.Paint}},hp=((ql=Ql=function(){function e(t){m(this,e),this.storageService=t}return v(e,[{key:"setUI",value:function(e,t){var n=e.getState().ui;e.patchState({ui:Object.assign(Object.assign({},n),t.ui)})}},{key:"setInitialUI",value:function(e,t){e.patchState({initialUI:t.ui})}},{key:"setInputEnabled",value:function(e,t){e.patchState({inputEnabled:t.enabled})}},{key:"setCanHover",value:function(e,t){e.patchState({canHover:t.canHover})}},{key:"setCanTouch",value:function(e,t){e.patchState({canTouch:t.canTouch})}},{key:"setCanFullscreen",value:function(e,t){e.patchState({canFullscreen:t.canFullscreen})}},{key:"setSearchDisplayMode",value:function(e,t){e.patchState({searchDisplayMode:t.mode})}},{key:"toggleNodeInfo",value:function(e,t){e.patchState({showNodeInfo:t.show})}},{key:"togglePresentation",value:function(e,t){e.patchState({presentationActive:t.active})}},{key:"toggleHelp",value:function(e,t){e.patchState({help:{tab:t.tab}})}},{key:"setLoaderType",value:function(e,t){e.patchState({interactType:t.interactType})}},{key:"setOnDemand",value:function(e,t){e.patchState({onDemand:t.onDemand})}},{key:"setInputMode",value:function(e,t){var n=t.inputMode;e.patchState({inputMode:n})}},{key:"SetLayout",value:function(e,t){e.patchState({layout:t.layout})}},{key:"setTutorial",value:function(e,t){var n=e.getState().tutorial;e.patchState({tutorial:Object.assign(Object.assign({},n),t.tutorial)})}},{key:"startTutorial",value:function(e,t){e.patchState({tutorial:Object.assign(Object.assign({},e.getState().tutorial),{pageIndex:t.intro?-1:0})}),e.dispatch(new S.TutorialSeen(!0))}},{key:"tutorialSeen",value:function(e,t){this.storageService.setLocalItem(zc.GettingStartedTutorial,t.seen),e.patchState({tutorialSeen:t.seen})}},{key:"tutorialPrevious",value:function(e,t){var n=e.getState().tutorial,i=Math.max(n.pageIndex-1,0);e.dispatch(new S.SetTutorial(Object.assign(Object.assign({},n),{pageIndex:i})))}},{key:"tutorialNext",value:function(e,t){var n=e.getState().tutorial,i=Math.min(n.pageIndex+1,n.pageSize-1);e.dispatch(new S.SetTutorial(Object.assign(Object.assign({},n),{pageIndex:i})))}},{key:"setWhiteboardEnabled",value:function(e,t){var n=t.enabled;e.patchState({whiteboard:Object.assign(Object.assign({},e.getState().whiteboard),{enabled:n})})}},{key:"setWhiteboardBrushSize",value:function(e,t){var n=t.brushSize;e.patchState({whiteboard:Object.assign(Object.assign({},e.getState().whiteboard),{brushSize:n})})}},{key:"setWhiteboardTextSize",value:function(e,t){var n=t.size;e.patchState({whiteboard:Object.assign(Object.assign({},e.getState().whiteboard),{textSize:n})})}},{key:"setWhiteboardEraserSize",value:function(e,t){var n=t.eraserSize;e.patchState({whiteboard:Object.assign(Object.assign({},e.getState().whiteboard),{eraserSize:n})})}},{key:"setWhiteboardAnnotateMode",value:function(e,t){var n=t.mode;e.patchState({whiteboard:Object.assign(Object.assign({},e.getState().whiteboard),{annotateMode:n})})}},{key:"setWhiteboardBrushColor",value:function(e,t){var n=t.brushColor;e.patchState({whiteboard:Object.assign(Object.assign({},e.getState().whiteboard),{brushColor:n})})}},{key:"setWhiteboardHasPaint",value:function(e,t){var n=t.hasPaint;e.patchState({whiteboard:Object.assign(Object.assign({},e.getState().whiteboard),{hasPaint:n})})}},{key:"setWhiteboardHasText",value:function(e,t){var n=t.hasText;e.patchState({whiteboard:Object.assign(Object.assign({},e.getState().whiteboard),{hasText:n})})}},{key:"setMultiPickModeEnabled",value:function(e,t){e.patchState({multiPickModeEnabled:t.enabled})}},{key:"setLabelBreakpoint",value:function(e,t){e.patchState({labelsBreakpoint:t.labelsBreakpoint})}},{key:"setUsePrintImage",value:function(e,t){e.patchState({usePrintImage:t.usePrintImage})}},{key:"setWindows",value:function(e,t){e.patchState({openWindows:t.windows})}},{key:"openWindow",value:function(e,t){var n=e.getState().openWindows;n.indexOf(t.window)<0&&e.patchState({openWindows:[t.window].concat(s(n))})}},{key:"closeWindow",value:function(e,t){var n=e.getState().openWindows;null!=t.window?n=n.filter((function(e){return e!==t.window})):n.shift(),e.patchState({openWindows:s(n)})}},{key:"toggleWindow",value:function(e,t){var n=e.getState().openWindows.indexOf(t.window)>=0;e.dispatch((null!=t.show?t.show:!n)?new S.OpenWindow(t.window):new S.CloseWindow(t.window))}},{key:"toggleMenu",value:function(e,t){e.patchState({menuOpen:t.open})}},{key:"ngxsOnInit",value:function(e){Kc.onFullscreenChange().subscribe((function(t){e.patchState({fullscreenActive:Kc.isFullscreen()})})),e.patchState({tutorialSeen:this.storageService.getLocalJSON(zc.GettingStartedTutorial)||!1})}}],[{key:"getUI",value:function(e){return e.ui}},{key:"getInitialUI",value:function(e){return e.initialUI}},{key:"getLabelsBreakpoint",value:function(e){return e.labelsBreakpoint}},{key:"getInputEnabled",value:function(e){return e.inputEnabled}},{key:"getFullscreenActive",value:function(e){return e.fullscreenActive}},{key:"getPresentationActive",value:function(e){return e.presentationActive}},{key:"getDrawerCoversContent",value:function(e){return e.drawerCoversContent}},{key:"getShowNodeInfo",value:function(e){return e.showNodeInfo}},{key:"getInteractType",value:function(e){return e.interactType}},{key:"getOnDemand",value:function(e){return e.onDemand}},{key:"getLayout",value:function(e){return e.layout}},{key:"getInputMode",value:function(e){return e.inputMode}},{key:"getShowHelpTab",value:function(e){return e.help.tab}},{key:"getTutorial",value:function(e){return e.tutorial}},{key:"getTutorialSeen",value:function(e){return e.tutorialSeen}},{key:"getWhiteboardEnabled",value:function(e){return e.whiteboard.enabled}},{key:"getWhiteboardBrushSize",value:function(e){return e.whiteboard.brushSize}},{key:"getWhiteboardTextSize",value:function(e){return e.whiteboard.textSize}},{key:"getWhiteboardEraserSize",value:function(e){return e.whiteboard.eraserSize}},{key:"getWhiteboardAnnotateMode",value:function(e){return e.whiteboard.annotateMode}},{key:"getWhiteboardBrushColor",value:function(e){return e.whiteboard.brushColor}},{key:"getWhiteboardHasPaint",value:function(e){return e.whiteboard.hasPaint}},{key:"getWhiteboardHasText",value:function(e){return e.whiteboard.hasText}},{key:"getCanTouch",value:function(e){return e.canTouch}},{key:"getCanHover",value:function(e){return e.canHover}},{key:"getMultiPickModeEnabled",value:function(e){return e.multiPickModeEnabled}},{key:"getSearchDisplayMode",value:function(e){return e.searchDisplayMode}},{key:"getUsePrintImage",value:function(e){return e.usePrintImage}},{key:"getOpenWindow",value:function(e){return e.openWindows.length>0?e.openWindows.sort()[0]:null}},{key:"getMenuOpen",value:function(e){return e.menuOpen}},{key:"shouldWindowOpen",value:function(e){return Object(L.h)([Ql],(function(t){return t.openWindows.indexOf(e)>=0}))}}]),e}()).\u0275fac=function(e){return new(e||ql)(_.Zb(Lc))},ql.\u0275prov=_.Lb({token:ql,factory:ql.\u0275fac}),lp([Object(L.a)(S.SetUI),pp("design:type",Function),pp("design:paramtypes",[Object,S.SetUI]),pp("design:returntype",void 0)],ql.prototype,"setUI",null),lp([Object(L.a)(S.SetInitialUI),pp("design:type",Function),pp("design:paramtypes",[Object,S.SetInitialUI]),pp("design:returntype",void 0)],ql.prototype,"setInitialUI",null),lp([Object(L.a)(S.SetInputEnabled),pp("design:type",Function),pp("design:paramtypes",[Object,S.SetInputEnabled]),pp("design:returntype",void 0)],ql.prototype,"setInputEnabled",null),lp([Object(L.a)(S.SetCanHover),pp("design:type",Function),pp("design:paramtypes",[Object,S.SetCanHover]),pp("design:returntype",void 0)],ql.prototype,"setCanHover",null),lp([Object(L.a)(S.SetCanTouch),pp("design:type",Function),pp("design:paramtypes",[Object,S.SetCanTouch]),pp("design:returntype",void 0)],ql.prototype,"setCanTouch",null),lp([Object(L.a)(S.SetCanFullscreen),pp("design:type",Function),pp("design:paramtypes",[Object,S.SetCanFullscreen]),pp("design:returntype",void 0)],ql.prototype,"setCanFullscreen",null),lp([Object(L.a)(S.SetSearchDisplayMode),pp("design:type",Function),pp("design:paramtypes",[Object,S.SetSearchDisplayMode]),pp("design:returntype",void 0)],ql.prototype,"setSearchDisplayMode",null),lp([Object(L.a)(S.ToggleNodeInfo),pp("design:type",Function),pp("design:paramtypes",[Object,S.ToggleNodeInfo]),pp("design:returntype",void 0)],ql.prototype,"toggleNodeInfo",null),lp([Object(L.a)(S.TogglePresentation),pp("design:type",Function),pp("design:paramtypes",[Object,S.TogglePresentation]),pp("design:returntype",void 0)],ql.prototype,"togglePresentation",null),lp([Object(L.a)(S.ToggleHelpTab),pp("design:type",Function),pp("design:paramtypes",[Object,S.ToggleHelpTab]),pp("design:returntype",void 0)],ql.prototype,"toggleHelp",null),lp([Object(L.a)(S.SetInteractType),pp("design:type",Function),pp("design:paramtypes",[Object,S.SetInteractType]),pp("design:returntype",void 0)],ql.prototype,"setLoaderType",null),lp([Object(L.a)(S.SetOnDemand),pp("design:type",Function),pp("design:paramtypes",[Object,S.SetOnDemand]),pp("design:returntype",void 0)],ql.prototype,"setOnDemand",null),lp([Object(L.a)(S.SetInputMode),pp("design:type",Function),pp("design:paramtypes",[Object,S.SetInputMode]),pp("design:returntype",void 0)],ql.prototype,"setInputMode",null),lp([Object(L.a)(S.SetLayout),pp("design:type",Function),pp("design:paramtypes",[Object,S.SetLayout]),pp("design:returntype",void 0)],ql.prototype,"SetLayout",null),lp([Object(L.a)(S.SetTutorial),pp("design:type",Function),pp("design:paramtypes",[Object,S.SetTutorial]),pp("design:returntype",void 0)],ql.prototype,"setTutorial",null),lp([Object(L.a)(S.StartTutorial),pp("design:type",Function),pp("design:paramtypes",[Object,S.StartTutorial]),pp("design:returntype",void 0)],ql.prototype,"startTutorial",null),lp([Object(L.a)(S.TutorialSeen),pp("design:type",Function),pp("design:paramtypes",[Object,S.TutorialSeen]),pp("design:returntype",void 0)],ql.prototype,"tutorialSeen",null),lp([Object(L.a)(S.TutorialPrevious),pp("design:type",Function),pp("design:paramtypes",[Object,S.TutorialPrevious]),pp("design:returntype",void 0)],ql.prototype,"tutorialPrevious",null),lp([Object(L.a)(S.TutorialNext),pp("design:type",Function),pp("design:paramtypes",[Object,S.TutorialNext]),pp("design:returntype",void 0)],ql.prototype,"tutorialNext",null),lp([Object(L.a)(S.SetWhiteboardEnabled),pp("design:type",Function),pp("design:paramtypes",[Object,S.SetWhiteboardEnabled]),pp("design:returntype",void 0)],ql.prototype,"setWhiteboardEnabled",null),lp([Object(L.a)(S.SetWhiteboardBrushSize),pp("design:type",Function),pp("design:paramtypes",[Object,S.SetWhiteboardBrushSize]),pp("design:returntype",void 0)],ql.prototype,"setWhiteboardBrushSize",null),lp([Object(L.a)(S.SetWhiteboardTextSize),pp("design:type",Function),pp("design:paramtypes",[Object,S.SetWhiteboardTextSize]),pp("design:returntype",void 0)],ql.prototype,"setWhiteboardTextSize",null),lp([Object(L.a)(S.SetWhiteboardEraserSize),pp("design:type",Function),pp("design:paramtypes",[Object,S.SetWhiteboardEraserSize]),pp("design:returntype",void 0)],ql.prototype,"setWhiteboardEraserSize",null),lp([Object(L.a)(S.SetWhiteboardAnnotateMode),pp("design:type",Function),pp("design:paramtypes",[Object,S.SetWhiteboardAnnotateMode]),pp("design:returntype",void 0)],ql.prototype,"setWhiteboardAnnotateMode",null),lp([Object(L.a)(S.SetWhiteboardBrushColor),pp("design:type",Function),pp("design:paramtypes",[Object,S.SetWhiteboardBrushColor]),pp("design:returntype",void 0)],ql.prototype,"setWhiteboardBrushColor",null),lp([Object(L.a)(S.SetWhiteboardHasPaint),pp("design:type",Function),pp("design:paramtypes",[Object,S.SetWhiteboardHasPaint]),pp("design:returntype",void 0)],ql.prototype,"setWhiteboardHasPaint",null),lp([Object(L.a)(S.SetWhiteboardHasText),pp("design:type",Function),pp("design:paramtypes",[Object,S.SetWhiteboardHasText]),pp("design:returntype",void 0)],ql.prototype,"setWhiteboardHasText",null),lp([Object(L.a)(S.SetMultiPickModeEnabled),pp("design:type",Function),pp("design:paramtypes",[Object,S.SetMultiPickModeEnabled]),pp("design:returntype",void 0)],ql.prototype,"setMultiPickModeEnabled",null),lp([Object(L.a)(S.SetLabelBreakpoint),pp("design:type",Function),pp("design:paramtypes",[Object,S.SetLabelBreakpoint]),pp("design:returntype",void 0)],ql.prototype,"setLabelBreakpoint",null),lp([Object(L.a)(S.SetUsePrintImage),pp("design:type",Function),pp("design:paramtypes",[Object,S.SetUsePrintImage]),pp("design:returntype",void 0)],ql.prototype,"setUsePrintImage",null),lp([Object(L.a)(S.SetWindows),pp("design:type",Function),pp("design:paramtypes",[Object,S.SetWindows]),pp("design:returntype",void 0)],ql.prototype,"setWindows",null),lp([Object(L.a)(S.OpenWindow),pp("design:type",Function),pp("design:paramtypes",[Object,S.OpenWindow]),pp("design:returntype",void 0)],ql.prototype,"openWindow",null),lp([Object(L.a)(S.CloseWindow),pp("design:type",Function),pp("design:paramtypes",[Object,S.CloseWindow]),pp("design:returntype",void 0)],ql.prototype,"closeWindow",null),lp([Object(L.a)(S.ToggleWindow),pp("design:type",Function),pp("design:paramtypes",[Object,S.ToggleWindow]),pp("design:returntype",void 0)],ql.prototype,"toggleWindow",null),lp([Object(L.a)(S.ToggleMenu),pp("design:type",Function),pp("design:paramtypes",[Object,S.ToggleMenu]),pp("design:returntype",void 0)],ql.prototype,"toggleMenu",null),lp([Object(L.e)(),pp("design:type",Function),pp("design:paramtypes",[up]),pp("design:returntype",void 0)],ql,"getUI",null),lp([Object(L.e)(),pp("design:type",Function),pp("design:paramtypes",[up]),pp("design:returntype",void 0)],ql,"getInitialUI",null),lp([Object(L.e)(),pp("design:type",Function),pp("design:paramtypes",[up]),pp("design:returntype",void 0)],ql,"getLabelsBreakpoint",null),lp([Object(L.e)(),pp("design:type",Function),pp("design:paramtypes",[up]),pp("design:returntype",void 0)],ql,"getInputEnabled",null),lp([Object(L.e)(),pp("design:type",Function),pp("design:paramtypes",[up]),pp("design:returntype",void 0)],ql,"getFullscreenActive",null),lp([Object(L.e)(),pp("design:type",Function),pp("design:paramtypes",[up]),pp("design:returntype",void 0)],ql,"getPresentationActive",null),lp([Object(L.e)(),pp("design:type",Function),pp("design:paramtypes",[up]),pp("design:returntype",void 0)],ql,"getDrawerCoversContent",null),lp([Object(L.e)(),pp("design:type",Function),pp("design:paramtypes",[up]),pp("design:returntype",void 0)],ql,"getShowNodeInfo",null),lp([Object(L.e)(),pp("design:type",Function),pp("design:paramtypes",[up]),pp("design:returntype",void 0)],ql,"getInteractType",null),lp([Object(L.e)(),pp("design:type",Function),pp("design:paramtypes",[up]),pp("design:returntype",void 0)],ql,"getOnDemand",null),lp([Object(L.e)(),pp("design:type",Function),pp("design:paramtypes",[up]),pp("design:returntype",void 0)],ql,"getLayout",null),lp([Object(L.e)(),pp("design:type",Function),pp("design:paramtypes",[up]),pp("design:returntype",void 0)],ql,"getInputMode",null),lp([Object(L.e)(),pp("design:type",Function),pp("design:paramtypes",[up]),pp("design:returntype",void 0)],ql,"getShowHelpTab",null),lp([Object(L.e)(),pp("design:type",Function),pp("design:paramtypes",[up]),pp("design:returntype",void 0)],ql,"getTutorial",null),lp([Object(L.e)(),pp("design:type",Function),pp("design:paramtypes",[up]),pp("design:returntype",void 0)],ql,"getTutorialSeen",null),lp([Object(L.e)(),pp("design:type",Function),pp("design:paramtypes",[up]),pp("design:returntype",void 0)],ql,"getWhiteboardEnabled",null),lp([Object(L.e)(),pp("design:type",Function),pp("design:paramtypes",[up]),pp("design:returntype",void 0)],ql,"getWhiteboardBrushSize",null),lp([Object(L.e)(),pp("design:type",Function),pp("design:paramtypes",[up]),pp("design:returntype",void 0)],ql,"getWhiteboardTextSize",null),lp([Object(L.e)(),pp("design:type",Function),pp("design:paramtypes",[up]),pp("design:returntype",void 0)],ql,"getWhiteboardEraserSize",null),lp([Object(L.e)(),pp("design:type",Function),pp("design:paramtypes",[up]),pp("design:returntype",void 0)],ql,"getWhiteboardAnnotateMode",null),lp([Object(L.e)(),pp("design:type",Function),pp("design:paramtypes",[up]),pp("design:returntype",void 0)],ql,"getWhiteboardBrushColor",null),lp([Object(L.e)(),pp("design:type",Function),pp("design:paramtypes",[up]),pp("design:returntype",void 0)],ql,"getWhiteboardHasPaint",null),lp([Object(L.e)(),pp("design:type",Function),pp("design:paramtypes",[up]),pp("design:returntype",void 0)],ql,"getWhiteboardHasText",null),lp([Object(L.e)(),pp("design:type",Function),pp("design:paramtypes",[up]),pp("design:returntype",void 0)],ql,"getCanTouch",null),lp([Object(L.e)(),pp("design:type",Function),pp("design:paramtypes",[up]),pp("design:returntype",void 0)],ql,"getCanHover",null),lp([Object(L.e)(),pp("design:type",Function),pp("design:paramtypes",[up]),pp("design:returntype",void 0)],ql,"getMultiPickModeEnabled",null),lp([Object(L.e)(),pp("design:type",Function),pp("design:paramtypes",[up]),pp("design:returntype",void 0)],ql,"getSearchDisplayMode",null),lp([Object(L.e)(),pp("design:type",Function),pp("design:paramtypes",[up]),pp("design:returntype",void 0)],ql,"getUsePrintImage",null),lp([Object(L.e)(),pp("design:type",Function),pp("design:paramtypes",[up]),pp("design:returntype",void 0)],ql,"getOpenWindow",null),lp([Object(L.e)(),pp("design:type",Function),pp("design:paramtypes",[up]),pp("design:returntype",void 0)],ql,"getMenuOpen",null),ql=Ql=lp([Object(L.f)({name:"view",defaults:gp})],ql)),fp=h("R0Ic"),bp=h("IzEk"),vp=function(e){return e[e.Content=0]="Content",e[e.Label=1]="Label",e[e.Tools=2]="Tools",e[e.Search=3]="Search",e[e.Help=4]="Help",e[e.NodeInfo=5]="NodeInfo",e[e.LabelInfo=6]="LabelInfo",e}({}),mp=["ui-bd.class","ui-play-pause","ui-camera-mode","ui-center","ui-cross-section","ui-dissect","ui-fs","ui-tools-display","ui-tree","ui-zoom","ui-zoom-in","ui-zoom-out","ui-pan","ui-share","ui-keys","ui-slider","o","background.color-stops","background.gradient-type","dd","dn","image-display","imageDisplay","imageSrc","pre","referrer"];function yp(e){var t=e.id,n=e.s,i=e.m,o=e.be,a=e.b,r="";if(t)r=t;else if(o)r=o;else if(a){var c=parseInt(a,10);r=Number.isNaN(c)?"":function(e){for(var t,n,i=[],o=e;o>0;){var a;n=o,o=(a=u([Math.floor(n/62),n%62],2))[0],t=a[1],i.unshift("0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz"[t])}return i.join("")}(c)}else i&&(r=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"male";return e.includes("/")?e:"production/".concat(t,"Adult/").concat(e)}(i,"female"===n?"female":"male"));return r.replace(/\.json$/,"")}function xp(e){return yp(e).includes("/")?"module":"bookmark"}var wp={type:function(e){return xp(e)},id:function(e){return yp(e)},background:function(e){return e.bgstd||e["background.colors"]||e.background}};function kp(e){return 3===e.length?{x:e[0],y:e[1],z:e[2]}:null}var Op={camera:function(e){var t=e.split(",").map((function(e){return parseFloat(e)}));if(t.length%3==0&&!t.some((function(e){return Number.isNaN(e)}))){var n=t.slice(0,3),i=t.slice(3,6),o=t.slice(6,9);return{eye:kp(n),look:kp(i),up:kp(o)}}return null},background:function(e){var t=ba.getColors(e);if(t){var n=[].concat(s(t[0][255]),s(t[1][255]));return new ai(n,"radial",[0,100])}return null}};function Cp(e){var t,n=function(e){var t=Object.keys(e),n=t.filter((function(e){return mp.includes(e)}));if(n.length>0){var i=['The following URL parameters have been deprecated: "'.concat(n.join('", "'),'"'),"Please contact support@biodigital.com for more information."];console.warn(i.join("\n"))}return t.reduce((function(e,t){return mp.includes(t)&&delete e[t],e}),e)}(e);return function(e){var t=function(e){if(e){var t=e.toLowerCase();if("true"===t)return!0;if("false"===t)return!1;if(!isNaN(Number(t)))return Number(t)}return e};return Object.keys(e).reduce((function(n,i){var o=(Op[i]||t)(e[i]);return"load-rotate"===i&&isNaN(Number(o))||(n[i]=o),n}),{})}((t=n,Object.keys(wp).filter((function(e){return void 0===t[e]})).reduce((function(e,n){var i=(0,wp[n])(t);return void 0!==i&&(e[n]=i),e}),t)))}var Sp,_p,jp=((Sp=function(){function e(t){m(this,e),this.store=t}return v(e,[{key:"chapterHasTransition",value:function(e,t){var n=t?"transitions.pre":"transitions.post",i=Object(Oe.get)(e,n);return!!i&&(t?i.onPrevious:i.onNext)}},{key:"searchChapterTransitions",value:function(e,t,n){var i=this,o=s(n),a=o.findIndex((function(t){return t.id===e})),r=o.findIndex((function(e){return e.id===t})),c=r<a;if(c&&(a=(o=o.reverse()).findIndex((function(t){return t.id===e})),r=o.findIndex((function(e){return e.id===t}))),a<0||r<0||a===r)return null;var l=o.slice(a,r).find((function(e){return i.chapterHasTransition(e,c)}));return l?c?l.transitions.pre:l.transitions.post:null}}]),e}()).\u0275fac=function(e){return new(e||Sp)(_.Zb(L.g))},Sp.\u0275prov=_.Lb({token:Sp,factory:Sp.\u0275fac,providedIn:"root"}),Sp),Pp=function(e){return e.JumpTo="jumpTo",e.FlyTo="flyTo",e}({});!function(e){var t=function e(t){m(this,e),this.breakpoint=t};t.type="[View] Set Breakpoint",e.SetBreakpoint=t}(_p||(_p={}));var Mp,Ip,zp,Tp,Up=function(e){return e[e.XSmall=0]="XSmall",e[e.Small=1]="Small",e[e.Medium=2]="Medium",e[e.Large=3]="Large",e[e.XLarge=4]="XLarge",e}({}),Lp=h("0MNC"),Dp=function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r},Ep=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Fp=function e(){m(this,e)},Ap=((Mp=function(){function e(t,n){m(this,e),this.breakpointObserver=t,this.store=n}return v(e,[{key:"setBreakpoint",value:function(e,t){e.patchState({breakpoint:t.breakpoint})}},{key:"ngxsOnInit",value:function(e){var t=this.breakpointObserver.observe(["(max-width: 374px)"]),n=this.breakpointObserver.observe(["(max-width: 599px)"]),i=this.breakpointObserver.observe(["(max-width: 959px)"]),o=this.breakpointObserver.observe(["(max-width: 1439px)"]),a=this.breakpointObserver.observe(["(min-width: 1440px)"]);Object(Ka.b)(t,n,i,o,a).pipe(Object(K.a)((function(e){var t=u(e,5),n=t[0],i=t[1],o=t[2],a=t[3],r=t[4];return n.matches?Up.XSmall:i.matches?Up.Small:o.matches?Up.Medium:a.matches?Up.Large:r.matches?Up.XLarge:null})),Object(Ja.a)(),Object(be.a)((function(e){return null!=e}))).subscribe((function(t){e.dispatch(new _p.SetBreakpoint(t))}))}}],[{key:"getBreakpoint",value:function(e){return e.breakpoint}},{key:"getBreakpointLabel",value:function(e){return["(max-width: 374px)","(max-width: 599px)","(max-width: 959px)","(max-width: 1439px)","(min-width: 1440px)"][e.breakpoint]}}]),e}()).\u0275fac=function(e){return new(e||Mp)(_.Zb(Lp.a),_.Zb(L.g))},Mp.\u0275prov=_.Lb({token:Mp,factory:Mp.\u0275fac}),Dp([Object(L.a)(_p.SetBreakpoint),Ep("design:type",Function),Ep("design:paramtypes",[Object,_p.SetBreakpoint]),Ep("design:returntype",void 0)],Mp.prototype,"setBreakpoint",null),Dp([Object(L.e)(),Ep("design:type",Function),Ep("design:paramtypes",[Fp]),Ep("design:returntype",void 0)],Mp,"getBreakpoint",null),Dp([Object(L.e)(),Ep("design:type",Function),Ep("design:paramtypes",[Fp]),Ep("design:returntype",void 0)],Mp,"getBreakpointLabel",null),Mp=Dp([Object(L.f)({name:"breakpoint",defaults:{breakpoint:null}})],Mp)),Rp=function(e){return e.Column="column",e.ColumnToggle="column-toggle",e.Drawer="drawer",e.TitleOnly="title-only",e.Tools="tools",e.Toolbar="toolbar",e.Camera="camera",e.Media="media",e.Mediabar="mediabar",e.Reset="reset",e.Audio="audio",e.Menu="menu",e.Pagination="pagination",e.Fullscreen="fullscreen",e.Help="help",e.Description="description",e.NodeInfo="nodeInfo",e.Search="search",e.Presenter="presenter",e.Logo="logo",e.LabelList="labelList",e.ChapterList="chapterList",e.AnatomyLabels="anatomyLabels",e.Labels="labels",e.Tutorial="tutorial",e.InternetExplorerWarning="internetExplorerWarning",e.Layout="layout",e.Legend="legend",e.Loader="loader",e.Undo="undo",e.Whiteboard="whiteboard",e.VisibilityLayers="visibilityLayers",e.ContextActions="contextActions",e.ToggleLabels="toggleLabels",e}({}),Np=function(e){return e.Drawer="drawer",e.Column="column",e}({}),Vp=((zp=function(){function e(t,n){m(this,e),this.store=t,this.chapterService=n,this.ui=null,this.breakpoint=null}return v(e,[{key:"getBase",value:function(){return{ui:this.store.selectSnapshot(hp.getUI),layout:this.store.selectSnapshot(hp.getLayout),breakpoint:this.store.selectSnapshot(Ap.getBreakpoint),hideUI:this.isUIHidden()}}},{key:"isUIHidden",value:function(){var e=this.store.selectSnapshot(hp.getOpenWindow),t=this.store.selectSnapshot(Ua.getSelectedChapterIndex),n=this.store.selectSnapshot(hp.getUI);return e===Gl.Loader&&t<=0&&n.loader.template===os.Circle||e===Gl.OnDemand||e===Gl.Interact||e===Gl.Tutorial||e===Gl.Whiteboard}},{key:"isDrawerVisible",value:function(){var e=this.getBase(),t=e.hideUI,n=e.ui,i=e.layout;return!t&&(i===sp.DrawerOnly||this.getLayoutFromWindowSize()===Np.Drawer)&&(z.application!==j.Viewer||n.drawer.enable&&"none"!==this.getVisibleContent()||n.nodeInfo.status===ns.Show||n.labelInfo.status===ns.Show)}},{key:"isColumnVisible",value:function(){var e=this.getBase(),t=e.hideUI,n=e.layout,i=e.ui;return!t&&n!==sp.DrawerOnly&&i.column.status!==ns.Collapse&&this.getLayoutFromWindowSize()===Np.Column&&i.column.enable&&"full"===this.getVisibleContent()}},{key:"isColumnToggleVisible",value:function(){var e=this.getBase(),t=e.hideUI,n=e.layout,i=e.ui;if(t)return!1;if(this.store.selectSnapshot(So.getQuizModeActive))return!1;switch(n){case sp.Default:if(this.getLayoutFromWindowSize()!==Np.Column)return!1;break;case sp.DrawerOnly:return!1}return i.column.enable&&"full"===this.getVisibleContent()}},{key:"isTitleOnlyVisible",value:function(){var e=this.getBase(),t=e.hideUI,n=e.ui,i=e.breakpoint;return!t&&!(i<Up.Large)&&n.titleOnly.enable&&"titleOnly"===this.getVisibleContent()}},{key:"isToolsVisible",value:function(){return!this.getBase().hideUI&&this.isUIVisible(Rp.Tools)}},{key:"isToolbarVisible",value:function(){var e=this.getBase(),t=e.hideUI,n=e.ui;return!t&&n.toolbar.enable}},{key:"isLogoVisible",value:function(){var e=this.getBase().ui;return this.store.selectSnapshot(hp.getOpenWindow)!==Gl.OnDemand&&e.logo.enable}},{key:"isCameraVisible",value:function(){var e=this.getBase(),t=e.hideUI,n=e.ui;return!t&&n.camera.enable}},{key:"isPaginationVisible",value:function(){var e=this.getBase(),t=e.hideUI,n=e.ui;return!t&&!(this.store.selectSnapshot(Ua.getChapterCount)<=1)&&n.pagination.enable}},{key:"isMediaVisible",value:function(){var e=this.getBase(),t=e.hideUI,n=e.ui;return!t&&this.store.selectSnapshot(Ua.getIsChapterAnimated)&&n.media.enable}},{key:"isMediabarVisible",value:function(){if(this.getBase().hideUI)return!1;var e=this.isMediaVisible(),t=this.isAudioVisible();return e||t}},{key:"isMenuVisible",value:function(){var e=this.getBase(),t=e.hideUI,n=e.ui;return!t&&(n.fullscreen.enable||n.help.enable||n.search.enable||n.tools.enable||n.whiteboard.enable||n.tutorial.enable)&&n.menu.enable}},{key:"isNodeInfoColumnVisible",value:function(){var e=this.getBase(),t=e.hideUI,n=e.ui,i=e.breakpoint;return!t&&(!!(i>=Up.Large&&this.isUIVisible(Rp.NodeInfo))||(i<Up.Large?!n.drawer.enable&&this.isUIVisible(Rp.NodeInfo):void 0))}},{key:"isNodeInfoVisible",value:function(e){var t=this.getBase(),n=t.hideUI,i=t.breakpoint;return!n&&(i>=Up.Large&&e===Np.Column||i<Up.Large&&e===Np.Drawer)&&this.isUIVisible(Rp.NodeInfo)}},{key:"isAudioVisible",value:function(){var e=this.getBase().ui,t=null!=this.store.selectSnapshot(Ua.getSelectedChapterAudio);return e.audio.enable&&t}},{key:"isSearchColumnVisible",value:function(){return!this.getBase().hideUI&&this.isUIVisible(Rp.Search)}},{key:"isUndoVisible",value:function(){var e=this.getBase(),t=e.hideUI,n=e.ui;return!t&&n.undo.enable}},{key:"isVisibilityLayersVisible",value:function(){var e=this.getBase(),t=e.hideUI,n=e.ui;if(t)return!1;var i=n.visibilityLayers.enable,o=this.store.selectSnapshot(Ua.getSelectedChapterCurrentLayers);return i&&this.chapterService.hasVisibilityLayers(o)}},{key:"isVisible",value:function(e){switch(e){case Rp.Audio:return this.isAudioVisible();case Rp.Camera:return this.isCameraVisible();case Rp.Column:return this.isColumnVisible();case Rp.ColumnToggle:return this.isColumnToggleVisible();case Rp.Drawer:return this.isDrawerVisible();case Rp.Logo:return this.isLogoVisible();case Rp.Media:return this.isMediaVisible();case Rp.Mediabar:return this.isMediabarVisible();case Rp.Menu:return this.isMenuVisible();case Rp.Pagination:return this.isPaginationVisible();case Rp.Search:return this.isSearchColumnVisible();case Rp.TitleOnly:return this.isTitleOnlyVisible();case Rp.Tools:return this.isToolsVisible();case Rp.Toolbar:return this.isToolbarVisible();case Rp.Undo:return this.isUndoVisible();case Rp.VisibilityLayers:return this.isVisibilityLayersVisible();default:return this.isUIVisible(e)}}},{key:"isUIVisible",value:function(e){var t=this.getBase(),n=t.hideUI,i=t.ui;return i[e]?!n&&i[e].enable&&i[e].status!==ns.Hide:(console.warn("Attempting to check visibility of a non-existent element: ${element}"),!1)}},{key:"isUIEnabled",value:function(e){return this.getBase().ui[e].enable}},{key:"getVisibleContent",value:function(){var e=this.getBase().ui,t=this.store.selectSnapshot(Pc.getChapterLabels),n=this.store.selectSnapshot(Ua.getSelectedChapter),i=Object(Oe.get)(n,"info.description"),o=Object(Oe.get)(n,"info.displayName"),a=Object(Oe.get)(n,"legend",[]),r=Object(Oe.get)(n,"contentBlocks",[]).length,c=e.labelList.enable&&t.length>0,s=null!=i&&Object(Oe.trim)(i).length>0,l=null!=o&&Object(Oe.trim)(o).length>0,p=e.legend.enable&&a.length>0,u=this.store.selectSnapshot(So.getQuizModeActive);return c||s||p||u||r?"full":l?"titleOnly":"none"}},{key:"getLayoutFromWindowSize",value:function(){var e=document.body.getBoundingClientRect(),t=e.width,n=e.height,i=t/n>=1?"landscape":"portrait",o=this.getBase().breakpoint;return"portrait"===i?Np.Drawer:o>=Up.Large||n<=384+(z.application===j.Viewer?0:56)&&t>=708?Np.Column:Np.Drawer}}]),e}()).\u0275fac=function(e){return new(e||zp)(_.Zb(L.g),_.Zb(Do))},zp.\u0275prov=_.Lb({token:zp,factory:zp.\u0275fac,providedIn:"root"}),zp),Hp=function(){var e=function e(t){m(this,e),this.query=t};return e.type="[Bookmarks] Load",e}(),Bp=function(){var e=function e(t){m(this,e),this.organizationId=t};return e.type="[Bookmarks] Load Organization Bookmarks",e}(),Qp=function(){var e=function e(t,n){m(this,e),this.organizationId=t,this.collectionId=n};return e.type="[Bookmarks] Load Collection Bookmarks",e}(),qp=function(){var e=function e(t,n){m(this,e),this.id=t,this.type=n};return e.type="[Bookmarks] Select Bookmark",e}(),Wp=function(){var e=function e(t){m(this,e),this.bookmark=t};return e.type="[Bookmarks] Select Bookmark Success",e}(),$p=function(){var e=function e(t){m(this,e),this.result=t};return e.type="[Bookmarks] Load Success",e}(),Kp=function(){var e=function e(t){m(this,e),this.bookmarkId=t};return e.type="[Bookmarks] Delete Bookmark",e}(),Gp=function(){var e=function e(t){m(this,e),this.bookmarkId=t};return e.type="[Bookmarks] Bookmark Delete Success",e}(),Zp=function(){var e=function e(t,n){m(this,e),this.bookmarkId=t,this.message=n};return e.type="[Bookmarks] Bookmark Delete Fail",e}(),Jp=function(){var e=function e(t,n){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];m(this,e),this.bookmarkEntry=t,this.inplace=n,this.includeIndex=i};return e.type="[Bookmarks] Save Bookmark",e}(),Xp=function(){var e=function e(t,n,i){m(this,e),this.bookmark=t,this.story=n,this.method=i};return e.type="[Bookmarks] Bookmark Saved",e}(),Yp=function(){var e=function e(t){m(this,e),this.bookmarkEntry=t};return e.type="[Bookmarks] Bookmark Save Failed",e}(),eu=function(){var e=function e(){m(this,e)};return e.type="[Bookmarks] Cancel Save Bookmark",e}(),tu=function(){var e=function e(t){m(this,e),this.bookmark=t};return e.type="[Bookmarks] Delete Favorite",e}(),nu=function(){var e=function e(t){m(this,e),this.bookmarkId=t};return e.type="[Bookmarks] Delete Favorite Success",e}(),iu=function(){var e=function e(t){m(this,e),this.bookmarkId=t};return e.type="[Bookmarks] Delete Favorite Failed",e}(),ou=function(){var e=function e(t,n,i,o,a){m(this,e),this.method=t,this.bookmarkId=n,this.bookmarkEntry=i,this.thumbnails=o,this.chapterIdMap=a};return e.type="[Bookmarks] Save Bookmark Thumbnails",e}(),au=function(){var e=function e(){m(this,e)};return e.type="[Bookmarks] Reset",e}(),ru=function(){var e=function e(){m(this,e)};return e.type="[Bookmarks] Clear Bookmarks",e}(),cu=function(){var e=function e(t){m(this,e),this.sort=t};return e.type="[Bookmarks] Sort",e}(),su=function(){var e=function e(t,n){m(this,e),this.id=t,this.checked=n};return e.type="[Bookmarks] Check Bookmark",e}(),lu=function(){var e=function e(t){m(this,e),this.ids=t};return e.type="[Bookmarks] Set Checked Bookmarks",e}(),pu=function(){var e=function e(t,n,i,o,a,r){m(this,e),this.bookmarks=t,this.widgetURL=n,this.userLanguage=i,this.userApp=o,this.widgetOptions=a,this.offlineEnabled=r};return e.type="[Bookmarks] Export Bookmarks",e}(),uu=function(){var e=function e(t){m(this,e),this.bookmarks=t};return e.type="[Bookmarks] Export Bookmarks Success",e}(),du=function(){var e=function e(t){m(this,e),this.bookmarks=t};return e.type="[Bookmarks] Export Bookmarks Error",e}(),gu=function(){var e=function e(t,n,i){m(this,e),this.bookmark=t,this.addCollection=n,this.removeCollection=i};return e.type="[Bookmarks] Update Bookmark Collection",e}(),hu=function(){var e=function e(t,n,i){m(this,e),this.bookmark=t,this.addCollection=n,this.removeCollection=i};return e.type="[Bookmarks] Update Bookmark Collection Success",e}(),fu=function(){var e=function e(t,n,i){m(this,e),this.bookmark=t,this.addCollection=n,this.removeCollection=i};return e.type="[Bookmarks] Update Bookmark Collection Error",e}(),bu=function(){var e=function e(t,n){m(this,e),this.bookmark=t,this.collection=n};return e.type="[Bookmarks] Add Bookmark Collection Success",e}(),vu=function(){var e=function e(t,n){m(this,e),this.bookmark=t,this.collection=n};return e.type="[Bookmarks] Add Bookmark Collection Error",e}(),mu=function(){var e=function e(t,n){m(this,e),this.bookmark=t,this.collection=n};return e.type="[Bookmarks] Remove Bookmark Collection Success",e}(),yu=function(){var e=function e(t,n){m(this,e),this.bookmark=t,this.collection=n};return e.type="[Bookmarks] Remove Bookmark Collection Error",e}(),xu=((Ip=function e(t,n,i){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:mr.lang,a=arguments.length>4?arguments[4]:void 0,r=arguments.length>5?arguments[5]:void 0;m(this,e),this.id=t,this.title=n,this.type=i,this.lang=o,this.groupAccess=a,this.collection=r}).type="[Bookmarks] Copy Bookmark",Ip),wu=function(){var e=function e(t,n,i){m(this,e),this.newId=t,this.sourceId=n,this.newBookmark=i};return e.type="[Bookmarks] Copy Bookmark Success",e}(),ku=function(){var e=function e(t,n){m(this,e),this.id=t,this.error=n};return e.type="[Bookmarks] Copy Bookmark Failure",e}(),Ou=function(){var e=function e(){m(this,e)};return e.type="[Bookmarks] Cancel Copy Bookmark",e}(),Cu=function(){var e=function e(t){m(this,e),this.title=t};return e.type="[Bookmarks] Set Bookmark Text",e}(),Su=function(){var e=function e(t){m(this,e),this.category=t};return e.type="[Bookmarks] Set Selected Category",e}();!function(e){var t=function e(t){m(this,e),this.theme=t};t.type="[Layout] Set Theme",e.SetTheme=t;var n=function e(t){m(this,e),this.sidenav=t};n.type="[Layout] Set Sidenav",e.SetSidenav=n;var i=function e(t){m(this,e),this.open=t};i.type="[Layout] Toggle Sidenav",e.ToggleSidenav=i;var o=function e(t){m(this,e),this.siteHeaderType=t};o.type="[Layout] Set Header",e.SetHeader=o;var a=function e(){m(this,e)};a.type="[Layout] Reset",e.ResetLayout=a}(Tp||(Tp={}));var _u,ju,Pu=function e(){m(this,e)},Mu=function(e){return e.Light="theme-light",e.Dark="theme-dark",e}({}),Iu=function(e){return e[e.Application=0]="Application",e[e.Search=1]="Search",e[e.View=2]="View",e[e.Hide=3]="Hide",e}({}),zu=function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r},Tu=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Uu={theme:Mu.Light,sidenav:{enabled:!0,open:!1},siteHeader:Iu.Application},Lu=((_u=function(){function e(){m(this,e)}return v(e,[{key:"setTheme",value:function(e,t){(0,e.patchState)({theme:t.theme})}},{key:"setHeader",value:function(e,t){e.patchState({siteHeader:t.siteHeaderType})}},{key:"setSidenav",value:function(e,t){e.patchState({sidenav:Object.assign({},t.sidenav)})}},{key:"toggleSidenav",value:function(e,t){var n=e.getState().sidenav;e.patchState({sidenav:Object.assign(Object.assign({},n),{open:t.open})})}},{key:"resetLayout",value:function(e,t){e.setState(Uu)}}],[{key:"getTheme",value:function(e){return e.theme}},{key:"getSidenav",value:function(e){return e.sidenav}},{key:"getSiteHeader",value:function(e){return e.siteHeader}}]),e}()).\u0275fac=function(e){return new(e||_u)},_u.\u0275prov=_.Lb({token:_u,factory:_u.\u0275fac}),zu([Object(L.a)(Tp.SetTheme),Tu("design:type",Function),Tu("design:paramtypes",[Object,Tp.SetTheme]),Tu("design:returntype",void 0)],_u.prototype,"setTheme",null),zu([Object(L.a)(Tp.SetHeader),Tu("design:type",Function),Tu("design:paramtypes",[Object,Tp.SetHeader]),Tu("design:returntype",void 0)],_u.prototype,"setHeader",null),zu([Object(L.a)(Tp.SetSidenav),Tu("design:type",Function),Tu("design:paramtypes",[Object,Tp.SetSidenav]),Tu("design:returntype",void 0)],_u.prototype,"setSidenav",null),zu([Object(L.a)(Tp.ToggleSidenav),Tu("design:type",Function),Tu("design:paramtypes",[Object,Tp.ToggleSidenav]),Tu("design:returntype",void 0)],_u.prototype,"toggleSidenav",null),zu([Object(L.a)(Tp.ResetLayout),Tu("design:type",Function),Tu("design:paramtypes",[Object,Tp.ResetLayout]),Tu("design:returntype",void 0)],_u.prototype,"resetLayout",null),zu([Object(L.e)(),Tu("design:type",Function),Tu("design:paramtypes",[Pu]),Tu("design:returntype",void 0)],_u,"getTheme",null),zu([Object(L.e)(),Tu("design:type",Function),Tu("design:paramtypes",[Pu]),Tu("design:returntype",void 0)],_u,"getSidenav",null),zu([Object(L.e)(),Tu("design:type",Function),Tu("design:paramtypes",[Pu]),Tu("design:returntype",void 0)],_u,"getSiteHeader",null),_u=zu([Object(L.f)({name:"layout",defaults:Uu})],_u)),Du=gp.ui,Eu=function e(){m(this,e)},Fu=function(e,t){return void 0===e?t:e};function Au(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return!!t.some((function(e){return!0===e}))||!t.some((function(e){return!1===e}))&&void 0}function Ru(e,t,n){return Object.values(is).indexOf(n)>=0?n:!1===e?is.None:null!=t?t?is.Full:is.Small:null}function Nu(e){return Object.values(os).includes(e)?e:null}!function(e){function t(e){var t;return p(t={},Rp.Loader,e?as:os.None),p(t,Rp.Column,e),p(t,Rp.Drawer,e),p(t,Rp.Tools,e),p(t,Rp.Toolbar,e),p(t,Rp.Fullscreen,e),p(t,Rp.Help,e),p(t,Rp.Camera,e),p(t,Rp.Search,e),p(t,Rp.Presenter,e),p(t,Rp.Menu,e),p(t,Rp.Audio,e),p(t,Rp.Pagination,e),p(t,Rp.NodeInfo,e),p(t,Rp.Labels,null),p(t,Rp.LabelList,e),p(t,Rp.ChapterList,e),p(t,Rp.Media,e?is.Full:is.None),p(t,Rp.TitleOnly,e),p(t,Rp.Undo,e),p(t,"all",e),p(t,"drawerExpandedInitially",null),p(t,"logoIsHyperLink",null),p(t,Rp.AnatomyLabels,null),p(t,Rp.Logo,!0),p(t,Rp.Tutorial,null),p(t,Rp.InternetExplorerWarning,!0),p(t,Rp.Legend,!0),p(t,Rp.Whiteboard,e),p(t,Rp.VisibilityLayers,e),p(t,Rp.ContextActions,e),p(t,Rp.ToggleLabels,!0),t}function n(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return null==t?e:Object(Oe.uniq)([].concat(s(Object.keys(e)),s(Object.keys(t)))).reduce((function(i,o){return i[o]=null==e[o]||n&&null!=t[o]?t[o]:e[o],i}),new Eu)}e.convertAPIUIConfigToUIConfig=function(e){var i,o=null!=e.all?t(e.all):new Eu;return n((p(i={all:e.all},Rp.Loader,Nu(e.loader)),p(i,Rp.Help,Au(e.help,e.help)),p(i,Rp.Tools,Au(e.tools,e.tools)),p(i,Rp.Layout,e.layout),p(i,Rp.Toolbar,e.toolbar),p(i,Rp.Fullscreen,Au(e.fullscreen,e.fullscreen)),p(i,Rp.Search,Au(e.objectTree,e.search)),p(i,Rp.Audio,e.audio),p(i,Rp.Media,Ru(e.playPause,Au(e.scrubber,e["scrubber.chapters"]),e.media)),p(i,Rp.Camera,Au(e.nav,e.cameraMode,e.center,e.zoomIn,e.zoomOut,e.nav)),p(i,Rp.Pagination,Au(e.tour,e["tour.chapters"])),p(i,Rp.Column,Au(e.info,e.info)),p(i,Rp.Drawer,Au(e.info,e.info)),p(i,Rp.TitleOnly,Au(e.info,e.info)),p(i,Rp.LabelList,e.labelList),p(i,Rp.ChapterList,e.chapterList),p(i,Rp.NodeInfo,e.anatomyDescriptions),p(i,Rp.Legend,e.legend),p(i,Rp.Menu,e.menu),p(i,Rp.InternetExplorerWarning,void 0),p(i,Rp.Labels,void 0),p(i,Rp.Logo,void 0),p(i,Rp.Presenter,void 0),p(i,"logoIsHyperLink",void 0),p(i,"drawerExpandedInitially",void 0),p(i,Rp.Tutorial,void 0),p(i,Rp.AnatomyLabels,Au(e.anatomyLabels,e.anatomyLabels)),p(i,Rp.Undo,Au(e.reset,e.undo)),p(i,Rp.Whiteboard,e.whiteboard),p(i,Rp.VisibilityLayers,e.visibilityLayers),p(i,Rp.ContextActions,e.contextActions),p(i,Rp.ToggleLabels,void 0),i),o)},e.convertUrlUIConfigToUIConfig=function(e){var i,o=null!=e["ui-all"]?t(e["ui-all"]):new Eu;return n((p(i={},Rp.Layout,e["ui-layout"]),p(i,Rp.Loader,Nu(e["ui-loader"])),p(i,Rp.NodeInfo,e["ui-anatomy-descriptions"]),p(i,Rp.Tools,e["ui-tools"]),p(i,Rp.Toolbar,e["ui-toolbar"]),p(i,Rp.Media,Ru(null,Au(e["ui-scrubber"],e["ui-scrubber.chapters"],e["ui-scrubber.tour"]),e["ui-media-controls"])),p(i,Rp.Audio,e["ui-audio"]),p(i,Rp.Fullscreen,e["ui-fullscreen"]),p(i,Rp.Help,e["ui-help"]),p(i,Rp.Camera,e["ui-nav"]),p(i,Rp.Presenter,e["ui-presenter"]),p(i,Rp.Menu,e["ui-menu"]),p(i,Rp.Pagination,e["ui-tour"]),p(i,Rp.Search,Au(e["ui-search"],e["ui-object-tree"])),p(i,Rp.Column,Au(e["ui-info"],e["ui-panel"])),p(i,Rp.Drawer,Au(e["ui-info"],e["ui-panel"])),p(i,Rp.Description,Au(e["ui-info"])),p(i,Rp.TitleOnly,Au(e["ui-info"])),p(i,Rp.Logo,Au(e["ui-bd"],e["ui-logo"])),p(i,"logoIsHyperLink",Au(e["ui-bd.link"],e["ui-logo.islink"])),p(i,Rp.Labels,e["ui-labels"]),p(i,Rp.LabelList,e["ui-label-list"]),p(i,Rp.ChapterList,e["ui-chapter-list"]),p(i,Rp.InternetExplorerWarning,e["ie-warning"]),p(i,"all",e["ui-all"]),p(i,"drawerExpandedInitially",e["ui-info-expand"]),p(i,Rp.AnatomyLabels,Au(e["ui-anatomy-labels"])),p(i,Rp.Tutorial,Au(e["ui-tutorial"])),p(i,Rp.Legend,Au(e["ui-legend"])),p(i,Rp.Undo,Au(e["ui-undo"],e["ui-reset"])),p(i,Rp.Whiteboard,Au(e["ui-whiteboard"])),p(i,Rp.VisibilityLayers,Au(e["ui-visibility-layers"],e["ui-layers"])),p(i,Rp.ContextActions,Au(e["ui-context-actions"])),p(i,Rp.ToggleLabels,void 0),i),o)},e.chapterUItoUIConfig=function(e){if(!e||!e.config)return null;var t=new Eu;return t[Rp.Column]=e.config.info,t[Rp.Drawer]=e.config.info,t[Rp.Fullscreen]=e.config.fullscreen,t[Rp.Search]=e.config.objectTree,t[Rp.Camera]=e.config.nav,t[Rp.Loader]=Nu(e.config.loader),t[Rp.Whiteboard]=e.config.whiteboard,t[Rp.VisibilityLayers]=e.config.visibilityLayers,t[Rp.ContextActions]=e.config.contextActions,t[Rp.Media]=Ru(e.config.playPause,e.config.scrubber,e.config.mediaControls),t},e.generateUIAllConfig=t,e.generateQuizUIConfig=function(){var e=new Eu;return e.search=!1,e.pagination=!1,e.labelList=!1,e.labels=!1,e.anatomyLabels=!1,e.nodeInfo=!1,e.toggleLabels=!1,e.legend=!1,e.chapterList=!1,e},e.mergeUIConfigs=n,e.createLayoutFromConfig=function(e,t){var n=JSON.parse(JSON.stringify(e));return n.loader.enable=Fu(t[Rp.Loader]!==os.None,Du.loader.enable),null!=t[Rp.Loader]&&(n.loader.template=t[Rp.Loader]),n.nodeInfo.enable=Fu(t[Rp.NodeInfo],Du.nodeInfo.enable),n.pagination.enable=Fu(t[Rp.Pagination],Du.pagination.enable),n.drawer.isExpandedInitially=Fu(t.drawerExpandedInitially,Du.drawer.isExpandedInitially),n.tools.enable=Fu(t[Rp.Tools],Du.tools.enable),n.toolbar.enable=Fu(t[Rp.Toolbar],Du.toolbar.enable),n.media.enable=Fu(t[Rp.Media]!==is.None,Du.media.enable),n.media.template=t[Rp.Media],n.fullscreen.enable=Fu(t[Rp.Fullscreen],Du.fullscreen.enable),n.help.enable=Fu(t[Rp.Help],Du.help.enable),n.description.enable=Fu(t[Rp.Description],Du.description.enable),n.titleOnly.enable=Fu(t[Rp.TitleOnly],Du.titleOnly.enable),n.camera.enable=Fu(t[Rp.Camera],Du.camera.enable),n.search.enable=Fu(t[Rp.Search],Du.search.enable),n.presenter.enable=Fu(t[Rp.Presenter],Du.presenter.enable),n.menu.enable=Fu(t[Rp.Menu],Du.menu.enable),n.logo.enable=Fu(t[Rp.Logo],Du.logo.enable),n.logo.isHyperLink=Fu(t.logoIsHyperLink,Du.logo.isHyperLink),n.internetExplorerWarning.enable=Fu(t.internetExplorerWarning,Du.internetExplorerWarning.enable),n.undo.enable=Fu(t[Rp.Undo],Du.undo.enable),n.labels.enable=Fu(t[Rp.Labels],Du.labels.enable),n.labelList.enable=Fu(t[Rp.LabelList],Du.labelList.enable),n.chapterList.enable=Fu(t[Rp.ChapterList],Du.chapterList.enable),n.audio.enable=Fu(t[Rp.Audio],Du.audio.enable),n.reset.enable=Fu(t[Rp.Reset],Du.reset.enable),n.column.enable=Fu(t[Rp.Column],Du.column.enable),n.drawer.enable=Fu(t[Rp.Drawer],Du.drawer.enable),n.anatomyLabels.enable=Fu(t[Rp.AnatomyLabels],Du.anatomyLabels.enable),n.tutorial.enable=Fu(t[Rp.Tutorial],Du.tutorial.enable),n.whiteboard.enable=Fu(t[Rp.Whiteboard],Du.whiteboard.enable),n.visibilityLayers.enable=Fu(t[Rp.VisibilityLayers],Du.visibilityLayers.enable),n.contextActions.enable=Fu(t[Rp.ContextActions],Du.contextActions.enable),n.toggleLabels.enable=Fu(t[Rp.ToggleLabels],Du.toggleLabels.enable),n},e.getScrollSetting=function(e){return e["disable-scroll"]?Ra.DoNotCapture:e["disable-scroll.alert"]||e["disable-scroll.overlay"]?Ra.DoNotCaptureShowMessage:Ra.Capture},e.getUsePrintImage=function(e){return!0===e["ui-print-image"]},e.getInteractType=function(e,t,n){var i=e["initial.play"]||e.initial||e["initial.button"]||e["initial.hand"]||e["initial.hand-hint"]||t;return{interactType:function(){switch(!0){case e.initial:case e["initial.button"]:return Kl.Button;case e["initial.hand"]:case e["initial.hand-hint"]:return Kl.Hand;case e["initial.play"]:return Kl.Play;default:return n}}(),isInteractActive:i}},e.getOnDemand=function(e){return!1===e["auto-load"]}}(ju||(ju={}));var Vu,Hu=function(e,t,n,i){return new(n||(n=Promise))((function(o,a){function r(e){try{s(i.next(e))}catch(t){a(t)}}function c(e){try{s(i.throw(e))}catch(t){a(t)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,c)}s((i=i.apply(e,t||[])).next())}))},Bu=((Vu=function(){function e(t,n,i,o,a,r){m(this,e),this.store=t,this.location=n,this.transitionService=i,this.engineService=o,this.layoutService=a,this.pendoService=r}return v(e,[{key:"initStory",value:function(e,t,n){var i=this;this.store.dispatch(new Ir(e,t,!0)),z.application!==j.Viewer&&"preview"!==e&&this.store.dispatch(new qp(e,t));var o=this.store.select(qa.getReady),a=this.store.select(Rc.getIncomingStoryInfo),r="preview"===e;Object(Ka.b)([o,a]).pipe(Object(be.a)((function(e){var t=u(e,2),n=t[0],i=t[1];return n&&!!i.id})),Object(bp.a)(1)).subscribe((function(){i.store.dispatch(new kn),i.store.dispatch(new Sr(e,t,n,r))}))}},{key:"nextChapter",value:function(e){var t=this.store.selectSnapshot(Ua.getSelectedChapterIndex),n=this.store.selectSnapshot(Ua.getStoryChapters);this.pendoService.trackSingle(Ce.DiscoveredChapterNav,{source:e,breakpoint:this.store.selectSnapshot(Ap.getBreakpointLabel)});var i=n[t+1];i&&this.selectChapter(i)}},{key:"previousChapter",value:function(e){var t=this.store.selectSnapshot(Ua.getSelectedChapterIndex),n=this.store.selectSnapshot(Ua.getStoryChapters);this.pendoService.trackSingle(Ce.DiscoveredChapterNav,{source:e,breakpoint:this.store.selectSnapshot(Ap.getBreakpointLabel)});var i=n[t-1];i&&this.selectChapter(i)}},{key:"selectChapter",value:function(e){return Hu(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,i,o,a;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=this.store.selectSnapshot(Ua.getSelectedChapterId),i=e.id,o=this.store.selectSnapshot(Ua.getStoryChapters),a=this.transitionService.searchChapterTransitions(n,i,o),this.pendoService.trackSingle(Ce.DiscoveredChapterNav,{source:"Chapter List",breakpoint:this.store.selectSnapshot(Ap.getBreakpointLabel)}),t.t0=a,!t.t0){t.next=6;break}return t.next=6,this.chapterTransition(a);case 6:this.store.dispatch([new Tr(e.id),new kn(e)]);case 7:case"end":return t.stop()}}),t,this)})))}},{key:"chapterTransition",value:function(e){var t=this;return new Promise((function(n){e.camera&&t.store.dispatch(new Wt(e.camera,!0,e.duration)),e.fadeColor&&t.store.dispatch(new Ue(e.fadeColor,e.duration)),setTimeout((function(){n(!0)}),1e3*e.duration)}))}},{key:"hideSelectedStructures",value:function(){var e=this.store.selectSnapshot(Fi.getCheckedNodeIds);this.store.dispatch(new pi.UpdateNodesShown(!1,e))}},{key:"selectTool",value:function(e){this.store.dispatch(new Ze(e))}},{key:"toggleColumn",value:function(e){var t=this.store.selectSnapshot(hp.getUI);t.column.status=(e=null==e?!(t.column.status===ns.Show):e)?ns.Show:ns.Collapse,this.store.dispatch(new S.SetUI(t))}},{key:"togglePresentation",value:function(){this.store.selectSnapshot(hp.getPresentationActive)?this.stopPresentation():this.startPresentation()}},{key:"startPresentation",value:function(){this.store.dispatch(new S.TogglePresentation(!0))}},{key:"stopPresentation",value:function(){this.store.dispatch(new S.TogglePresentation(!1))}},{key:"toggleHelp",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ve.Basics;this.store.dispatch(new S.ToggleWindow(Gl.Help,e)),this.store.dispatch(new S.ToggleHelpTab(t))}},{key:"toggleInteract",value:function(e){this.store.dispatch(new S.ToggleWindow(Gl.Interact,e))}},{key:"toggleOnDemand",value:function(e){this.store.dispatch(new S.SetOnDemand(e)),this.store.dispatch(new S.ToggleWindow(Gl.OnDemand,e))}},{key:"toggleTutorial",value:function(e){this.store.dispatch(new S.ToggleWindow(Gl.Tutorial,e)),e&&this.store.dispatch(new S.StartTutorial(!0))}},{key:"toggleWhiteboard",value:function(e){this.store.dispatch(new S.ToggleWindow(Gl.Whiteboard,e)),e&&(this.store.dispatch(new Xe(!1)),this.store.dispatch(new S.SetWhiteboardEnabled(!0)))}},{key:"toggleLabels",value:function(e){this.store.dispatch(new Ge(e))}},{key:"toggleSearch",value:function(e){this.store.selectSnapshot(Ap.getBreakpoint);var t=this.store.selectSnapshot(hp.getUI);t.search.status=(e=null==e?!(t.search.status===ns.Show):e)?ns.Show:ns.Hide,e&&(t.nodeInfo.status=ns.Hide),this.store.dispatch(new S.SetUI(t))}},{key:"toggleNodeInfo",value:function(e){this.toggleInfoLayout("nodeInfo",e)}},{key:"toggleLabelInfo",value:function(e){this.toggleInfoLayout("labelInfo",e)}},{key:"toggleInfoLayout",value:function(e,t){var n=this.store.selectSnapshot(hp.getUI);(t=null==t?n[e].status===ns.Hide:t)?(n[e].status=ns.Show,["nodeInfo","labelInfo"].filter((function(t){return t!==e})).forEach((function(e){return n[e].status=ns.Hide}))):n[e].status=ns.Hide,this.store.dispatch(new S.SetUI(n))}},{key:"delegateNodeClick",value:function(e,t){if(this.clearSelectedLabel(),e||t.srcEvent.shiftKey)if(t.srcEvent.shiftKey||this.store.selectSnapshot(hp.getMultiPickModeEnabled))this.checkNode(e);else switch(this.store.selectSnapshot(qa.getActiveTool)){case Aa.Hide:this.hideNode(e);break;case Aa.Select:this.selectNode(e);break;case Aa.Isolate:this.isolateNode(e);break;case Aa.Fade:this.fadeNode(e)}else this.clearSelectedNodes()}},{key:"clearSelectedLabel",value:function(){this.store.dispatch(new Go)}},{key:"clearSelectedNodes",value:function(){this.store.dispatch(new pi.UpdateNodeSelected),this.store.dispatch(new pi.UpdateNodesChecked(!1))}},{key:"checkNode",value:function(e,t){void 0!==e&&(null==t&&(t=this.store.selectSnapshot(Fi.getNodes)[e.id].checked),this.store.dispatch(new pi.UpdateNodesChecked(!t,[e.id])),this.store.dispatch(new pi.UpdateNodeSelected(e.id)))}},{key:"fadeNode",value:function(e){this.store.dispatch(new pi.UpdateNodesPaint(Gi.recipe,[e.id]))}},{key:"isolateNode",value:function(e){this.store.dispatch(new pi.UpdateNodesShown(!1)),this.store.dispatch(new pi.UpdateNodesShown(!0,[e.id]))}},{key:"selectNode",value:function(e){var t=!this.store.selectSnapshot(Fi.getNodes)[e.id].checked;this.store.dispatch(new pi.UpdateNodesChecked(!1)),t&&(this.store.dispatch(new pi.UpdateNodesChecked(!0,[e.id])),this.store.dispatch(new pi.UpdateNodeSelected(e.id))),this.store.dispatch(new gt(e)),this.store.dispatch(new mt(e))}},{key:"hideNode",value:function(e){this.store.dispatch(new pi.UpdateNodesShown(!1,[e.id])),this.store.dispatch(new pi.UpdateNodesChecked(!1))}},{key:"selectLabel",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e.objectId,i=e.states;this.store.dispatch(new Go(e)),t&&n&&0===i.length&&this.store.dispatch(new He(n,!0))}},{key:"initChapter",value:function(e){return Hu(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=this.engineService.createViewGraph({},!1),this.store.dispatch(new De(n)),this.store.dispatch(new Wt(e.camera.location,e.camera.action===Pp.FlyTo));case 2:case"end":return t.stop()}}),t,this)})))}},{key:"playChapterFromStart",value:function(){this.store.dispatch(new nt)}},{key:"resetCamera",value:function(){var e=this.store.selectSnapshot(Ua.getSelectedChapter);e&&this.store.dispatch(new Wt(e.camera.location))}},{key:"resetChapter",value:function(){this.resetCamera();var e=this.store.selectSnapshot(Ua.getSelectedChapterId);this.store.dispatch(new ui.UndoAll(e)),this.store.dispatch(new pi.UpdateNodesChecked(!1)),this.store.dispatch(new Qo)}},{key:"resetLayout",value:function(){var e=this.store.selectSnapshot(hp).ui;this.layoutService.isUIHidden()?Object.keys(e).forEach((function(t){e[t].status=ns.Hide})):(Object.keys(e).forEach((function(t){e[t].status=ns.Show})),e.search.status=ns.Hide,e.tools.status=ns.Hide,e.nodeInfo.status=ns.Hide,e.labelInfo.status=ns.Hide,e.media.status=ns.Hide,e.visibilityLayers.status=ns.Hide),this.store.dispatch(new S.SetUI(e))}},{key:"undo",value:function(){this.store.dispatch(new ui.Undo(this.store.selectSnapshot(Ua.getSelectedChapterId)))}},{key:"redo",value:function(){this.store.dispatch(new ui.Redo(this.store.selectSnapshot(Ua.getSelectedChapterId)))}},{key:"toggleAnimation",value:function(){var e=!this.store.selectSnapshot(qa.getAnimationPlaying);this.store.dispatch(new Xe(e))}},{key:"toggleAudio",value:function(){var e=this.store.selectSnapshot(qa.getPlayAudio);this.store.dispatch(new tt(!e))}},{key:"toggleToolbar",value:function(e){var t=this.store.selectSnapshot(hp.getUI);t.media.status=ns.Hide,t.tools.status=ns.Hide,t.toolbar.status=ns.Hide,t.visibilityLayers.status=ns.Hide,t[e].status=ns.Show,this.store.dispatch(new S.SetUI(t))}},{key:"normalizeQueryParams",value:function(e){var t=Object.assign({},e);return{id:yp(t),type:xp(t),lang:e.lang}}},{key:"sanitizeRouteId",value:function(e){return e=e.replace(/\.json$/,""),this.location.replaceState("view","?id="+e),e}},{key:"openInNewTab",value:function(){var e=window.document.location.href;window.open(e)}},{key:"getComputedTransform",value:function(e){var t=getComputedStyle(e).transform.replace("matrix3d","").replace("matrix","").replace("(","").replace(")","").split(",").map((function(e){return e.trim()})).map((function(e){return parseInt(e,10)})),n=16===t.length?t[12]:t[4],i=16===t.length?t[13]:t[5];return Number.isNaN(n)||Number.isNaN(i)?null:{x:n,y:i}}},{key:"getVH",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=this.store.selectSnapshot(Lu.getSiteHeader);return.01*(window.innerHeight-(e&&t!==Iu.Hide?56:0))}},{key:"inferDrawerMode",value:function(e){var t=vp.Content;return e.nodeInfo.status===ns.Show?t=vp.NodeInfo:e.labelInfo.status===ns.Show&&(t=vp.LabelInfo),t}},{key:"setUI",value:function(e){var t,n=null!==(t=e.baseUIConfig)&&void 0!==t?t:new Eu;n=ju.mergeUIConfigs(n,e.apiUIConfig),n=ju.mergeUIConfigs(n,e.urlUIConfig),n=ju.mergeUIConfigs(n,e.chapterUIConfig),e.quizUIConfig&&(n=ju.mergeUIConfigs(n,e.quizUIConfig,!0));var i=this.store.selectSnapshot(hp.getUI),o=ju.createLayoutFromConfig(i,n);this.store.dispatch(new S.SetUI(o))}}]),e}()).\u0275fac=function(e){return new(e||Vu)(_.Zb(L.g),_.Zb(or.g),_.Zb(jp),_.Zb(Nt),_.Zb(Vp),_.Zb(Se))},Vu.\u0275prov=_.Lb({token:Vu,factory:Vu.\u0275fac,providedIn:"root"}),Vu);function Qu(e,t){1&e&&_.Qb(0,"img",9)}function qu(e,t){1&e&&_.Qb(0,"img",9)}function Wu(e,t){1&e&&_.Qb(0,"img",10)}function $u(e,t){1&e&&_.Qb(0,"img",11)}function Ku(e,t){if(1&e&&(_.Tb(0),_.Kc(1,Qu,1,0,"img",6),_.Kc(2,qu,1,0,"img",6),_.Kc(3,Wu,1,0,"img",7),_.Kc(4,$u,1,0,"img",8),_.Sb()),2&e){var n=_.gc();_.Db(1),_.lc("ngIf",n.label.pinType==n.labelPinType.Default),_.Db(1),_.lc("ngIf",n.label.pinType==n.labelPinType.Sequential),_.Db(1),_.lc("ngIf",n.label.pinType===n.labelPinType.Plus||n.label.pinType===n.labelPinType.PlusMinus&&!n.selected),_.Db(1),_.lc("ngIf",n.label.pinType===n.labelPinType.Minus||n.label.pinType===n.labelPinType.PlusMinus&&n.selected)}}function Gu(e,t){1&e&&_.Qb(0,"img",15)}function Zu(e,t){1&e&&_.Qb(0,"img",15)}function Ju(e,t){1&e&&_.Qb(0,"img",16)}function Xu(e,t){1&e&&_.Qb(0,"img",17)}function Yu(e,t){if(1&e&&(_.Kc(0,Gu,1,0,"img",12),_.Kc(1,Zu,1,0,"img",12),_.Kc(2,Ju,1,0,"img",13),_.Kc(3,Xu,1,0,"img",14)),2&e){var n=_.gc();_.lc("ngIf",n.label.pinType==n.labelPinType.Default),_.Db(1),_.lc("ngIf",n.label.pinType==n.labelPinType.Sequential),_.Db(1),_.lc("ngIf",n.label.pinType===n.labelPinType.Plus||n.label.pinType===n.labelPinType.PlusMinus&&!n.selected),_.Db(1),_.lc("ngIf",n.label.pinType===n.labelPinType.Minus||n.label.pinType===n.labelPinType.PlusMinus&&n.selected)}}var ed=function(e,t){return{"label-pin__text--white":e,"label-pin__text--black":t}};function td(e,t){if(1&e&&(_.Tb(0),_.Vb(1,"div",18),_.Mc(2),_.Ub(),_.Sb()),2&e){var n=_.gc();_.Db(1),_.lc("ngClass",_.pc(2,ed,n.labelTheme===n.labelThemeEnum.StudioNext,n.labelTheme===n.labelThemeEnum.Annotation)),_.Db(1),_.Oc(" ",n.sequence," ")}}var nd,id=function(e,t,n,i){return{"label-pin--light":e,"label-pin--dark":t,"label-pin--none":n,"label-pin--selected":i}},od=((nd=function e(){m(this,e),this.labelPinType=Jn,this.labelThemeEnum=Xn,this.labelTheme=Xn.StudioNext,this.selected=!1}).\u0275fac=function(e){return new(e||nd)},nd.\u0275cmp=_.Jb({type:nd,selectors:[["app-label-pin"]],inputs:{label:"label",labelTheme:"labelTheme",selected:"selected",sequence:"sequence"},decls:7,vars:9,consts:[[1,"label-pin",3,"ngClass"],["pin",""],[4,"ngIf","ngIfElse"],["lightPins",""],[4,"ngIf"],[1,"label__glow"],["draggable","false","alt","","src","./assets/images/labels/circle-dark.svg","class","label-pin__image",4,"ngIf"],["draggable","false","alt","","src","./assets/images/labels/circle-plus-dark.svg","class","label-pin__image",4,"ngIf"],["draggable","false","alt","","src","./assets/images/labels/circle-minus-dark.svg","class","label-pin__image",4,"ngIf"],["draggable","false","alt","","src","./assets/images/labels/circle-dark.svg",1,"label-pin__image"],["draggable","false","alt","","src","./assets/images/labels/circle-plus-dark.svg",1,"label-pin__image"],["draggable","false","alt","","src","./assets/images/labels/circle-minus-dark.svg",1,"label-pin__image"],["draggable","false","alt","","src","./assets/images/labels/circle.svg","class","label-pin__image",4,"ngIf"],["draggable","false","alt","","src","./assets/images/labels/circle-plus.svg","class","label-pin__image",4,"ngIf"],["draggable","false","alt","","src","./assets/images/labels/circle-minus.svg","class","label-pin__image",4,"ngIf"],["draggable","false","alt","","src","./assets/images/labels/circle.svg",1,"label-pin__image"],["draggable","false","alt","","src","./assets/images/labels/circle-plus.svg",1,"label-pin__image"],["draggable","false","alt","","src","./assets/images/labels/circle-minus.svg",1,"label-pin__image"],[1,"label-pin__text",3,"ngClass"]],template:function(e,t){if(1&e&&(_.Vb(0,"div",0,1),_.Kc(2,Ku,5,4,"ng-container",2),_.Kc(3,Yu,4,4,"ng-template",null,3,_.Lc),_.Kc(5,td,3,5,"ng-container",4),_.Qb(6,"div",5),_.Ub()),2&e){var n=_.vc(4);_.lc("ngClass",_.rc(4,id,t.labelTheme===t.labelThemeEnum.StudioNext,t.labelTheme===t.labelThemeEnum.Annotation,t.label.pinType===t.labelPinType.None,t.selected)),_.Db(2),_.lc("ngIf",t.labelTheme===t.labelThemeEnum.Annotation)("ngIfElse",n),_.Db(3),_.lc("ngIf",t.label.pinType===t.labelPinType.Sequential)}},directives:[or.i,or.l],styles:['.label-pin[_ngcontent-%COMP%]{display:inline-flex;align-items:center;justify-content:center;position:relative;transition:background-color .12s;z-index:10}.label-pin__text[_ngcontent-%COMP%]{display:flex;z-index:10;justify-content:center;align-items:center;font-size:10px!important;color:#101823}.label-pin[_ngcontent-%COMP%]:before, .label-pin__text[_ngcontent-%COMP%]{position:absolute;left:0;top:0;width:100%;height:100%}.label-pin[_ngcontent-%COMP%]:before{content:" ";background-color:transparent;border:2px solid transparent;border-radius:50%;box-sizing:border-box;display:block;z-index:-2}.label-pin--light.label-pin--selected[_ngcontent-%COMP%]:before{background-color:#fff;border-color:#2d72dc;box-shadow:0 0 0 1px rgba(45,114,220,.7)}.label-pin--light.label-pin[_ngcontent-%COMP%]   .label-pin__text[_ngcontent-%COMP%]{color:#101823}.label-pin--dark.label-pin[_ngcontent-%COMP%]:before{background-color:rgba(0,0,0,.75)}.label-pin--dark.label-pin--selected[_ngcontent-%COMP%]:after, .label-pin--dark.label-pin--selected[_ngcontent-%COMP%]:before{background-color:#2d72dc}.label-pin--dark.label-pin[_ngcontent-%COMP%]   .label-pin__text[_ngcontent-%COMP%]{color:#fff}.label-pin--none.label-pin[_ngcontent-%COMP%]{display:none}'],changeDetection:0}),nd),ad=function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r},rd=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},cd=["labelContainerEl"],sd=["labelEl"],ld=["wire"],pd=["tag"],ud=["pin"],dd=["title"];function gd(e,t){1&e&&(_.Vb(0,"div",18),_.Qb(1,"app-icon",19),_.Ub())}var hd=function(e){return{"label__body--collapse":e}};function fd(e,t){if(1&e&&(_.Vb(0,"div",20),_.jc(1,3),_.Ub()),2&e){var n=_.gc();_.lc("ngClass",_.oc(1,hd,n.isCollapsed||n.descriptionCollapsed))}}var bd,vd=[[["","label-header",""]],[["","label-actions",""]],[["","label-more",""]],[["","label-body",""]]],md=function(e,t,n,i,o,a,r,c,s,l){return{"label--selected":e,"label--glow":t,"label--annotation":n,"label--classic":i,"label--invert":o,"label--studio":a,"label--context":r,"label--screenshot-mode":c,"label--auto-fit":s,"label--opaque":l}},yd=function(e){return{"label__wire--collapse":e}},xd=function(e,t,n,i){return{"label__tag--collapse":e,"label__tag--collapsible":t,"label__tag--floating":n,"label__tag--draggable":i}},wd=["[label-header]","[label-actions]","[label-more]","[label-body]"],kd=((bd=function(){function e(t,n,i,o,a,r,c){m(this,e),this.renderer=t,this.labelsService=n,this.engineService=i,this.cameraService=o,this.store=a,this.actions=r,this.changeDetection=c,this.labelPinType=Jn,this.labelSequentialType=Yn,this.labelUpdated=new _.p,this.offsetUpdated=new _.p,this.pinClicked=new _.p,this.tagClicked=new _.p,this.displayUpdated=new _.p,this.positionUpdated=new _.p,this.hoverStart=new _.p,this.hoverEnd=new _.p,this.labelOffsetUpdated=new _.p,this.fit="fixed",this.opaque=!1,this.scale=1,this.isCollapsed=!1,this.tagCollapsed=!1,this.theme="classic",this.pinDraggable=!0,this.tagDraggable=!0,this.enginePosition=null,this.isBackgroundDark=!1,this.pinDragging=!1,this.screenshotMode=!1,this.hammerManagers=[],this.displayUpdated$=new ge.a,this.positionUpdated$=new ge.a,this.ngUnsubscribe=new ge.a}return v(e,[{key:"label",get:function(){return this._label},set:function(e){var t=Object(Oe.isEmpty)(e),n=Object(Oe.isEmpty)(this.label);t&&!n?(this._label=Object.assign({},e),this.destroyLabel()):t||(this._label=Object.assign({},e),this.initLabel(this.label))}},{key:"ngOnInit",value:function(){this.initListeners()}},{key:"ngAfterViewInit",value:function(){this.bindTagEvents(),this.bindPinEvents(),this.bindHoverEvents()}},{key:"ngOnDestroy",value:function(){this.destroyLabel(),this.emitDisplayUpdated({id:this.label.id,inView:!1,shown:!1,objectShown:this.objectShown}),this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"destroyLabel",value:function(){this.hammerManagers.forEach((function(e){return e.destroy})),this.hammerManagers=[],this.deleteMarker(this.marker)}},{key:"initListeners",value:function(){var e=this;this.enginePosition$.pipe(Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){e.enginePosition=t})),this.engineService.getEvent(Lt.SceneMarkersUpdated).pipe(Object(be.a)((function(){return null!=e.label&&null!=e.enginePosition})),Object(fe.a)(this.ngUnsubscribe)).subscribe((function(){e.setCanvasPos()})),this.displayUpdated$.pipe(Object(Ja.a)((function(e,t){return Object(Oe.isEqual)(e,t)})),Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){e.displayUpdated.next(t)})),this.positionUpdated$.pipe(Object(Ja.a)((function(e,t){return Object(Oe.isEqual)(e,t)})),Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){e.positionUpdated.next({positionUpdate:t,onCanvas:e.isOnCanvas()})})),this.background$.pipe(Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){var n=t.colors.slice(0,3),i=t.colors.slice(4,7);e.isBackgroundDark=!ba.isLight(n,i),e.changeDetection.markForCheck()})),this.actions.pipe(Object(L.j)(qn),Object(fe.a)(this.ngUnsubscribe)).subscribe((function(){e.screenshotMode=!0,e.changeDetection.detectChanges()})),this.actions.pipe(Object(L.i)(Wn),Object(fe.a)(this.ngUnsubscribe)).subscribe((function(){e.screenshotMode=!1,e.changeDetection.markForCheck()}))}},{key:"bindTagEvents",value:function(){var e=this,t=new Bc(this.tagRef.nativeElement,{domEvents:!0});t.get("pan").set({direction:Bc.DIRECTION_ALL,threshold:3}),t.on("pan",(function(t){if(e.tagDraggable){t.srcEvent.stopPropagation(),e.cachedTagOffset||(e.cachedTagOffset=e.label.offset);var n=[e.cachedTagOffset[0]+t.deltaX,e.cachedTagOffset[1]+t.deltaY];e.label.offset=n,t.isFinal&&(e.cachedTagOffset=null,e.offsetUpdated.next({labelId:e.label.id,offset:n}))}})),t.on("tap",(function(t){t.srcEvent.preventDefault(),t.srcEvent.stopPropagation(),e.tagClicked.next(t)})),this.hammerManagers.push(t)}},{key:"bindPinEvents",value:function(){var e=this,t=new Bc(this.pinRef.nativeElement);t.get("pan").set({direction:Bc.DIRECTION_ALL,threshold:4}),t.on("pan",(function(t){if(e.pinDraggable){t.srcEvent.stopPropagation(),e.pinDragging=!0;var n=t.changedPointers[0],i=n.layerX,o=n.layerY;if(i-=16,o-=16,e.marker&&e.deleteMarker(e.marker),e.renderer.setStyle(e.labelContainerRef.nativeElement,"transform","translate(".concat(i,"px, ").concat(o,"px)")),t.isFinal){e.pinDragging=!1;var a=Object.assign({},e.label),r=Human.renderer.pick.pick({canvasPos:[i,o],rayPick:!0}),c="string"==typeof r.objectId;c&&(a.dir=e.cameraService.getDirection(r),a.objectId=r.objectId,a.barycentric=[r.barycentric[0],r.barycentric[1],r.barycentric[2]],a.pos=[r.worldPos[0],r.worldPos[1],r.worldPos[2]],a.primitiveIndex=r.primitiveIndex),e.labelUpdated.next({label:a,shouldPreserve:c})}}})),t.on("tap",(function(t){t.srcEvent.preventDefault(),t.srcEvent.stopImmediatePropagation(),e.pinClicked.next(t)})),this.hammerManagers.push(t)}},{key:"bindHoverEvents",value:function(){var e=this,t=this.labelRef.nativeElement;this.renderer.listen(t,"mouseenter",(function(){e.hoverStart.next({labelId:e.label.id})})),this.renderer.listen(t,"mouseleave",(function(){e.hoverEnd.next({labelId:e.label.id})}))}},{key:"initLabel",value:function(e){this.initMarker(e),this.ensureObjectId(e),this.initObjectSubscription(e)}},{key:"initMarker",value:function(e){this.marker&&this.deleteMarker(this.marker),this.marker=Human.scene.markers.create({id:e.id,pos:e.pos,dir:e.dir,objectId:e.objectId,primitiveIndex:e.primitiveIndex,barycentric:e.barycentric,renderableIndex:e.renderableIndex||0})}},{key:"checkLabelDisplay",value:function(){return{id:this.label.id,shown:this.label.shown,inView:this.isOnCanvas(),objectShown:!0}}},{key:"ensureObjectId",value:function(e){if(!e.objectId){var t=Human.renderer.pick.pick({canvasPos:[this.marker.canvasPos[0],this.marker.canvasPos[1]],rayPick:!0});t.objectId&&(e.objectId=t.objectId,e.states.forEach((function(e){e.errands.forEach((function(e){e.type===fi.flyToObject&&(e.value=t.objectId)}))})),this.labelUpdated.next({label:e,shouldPreserve:void 0}))}}},{key:"initObjectSubscription",value:function(e){var t=this;this.object$&&this.object$.unsubscribe(),e.objectId&&(this.object$=this.store.select(qa.getViewGraphNode).pipe(Object(K.a)((function(t){return t(e.objectId)})),Object(be.a)((function(e){return!!e})),Object(fe.a)(this.ngUnsubscribe)).subscribe((function(e){t.objectShown=e.boolState.shown})))}},{key:"deleteMarker",value:function(e){Human.scene.markers.delete(e.id),this.marker=null}},{key:"setCanvasPos",value:function(){if(!this.pinDragging&&this.marker){this.depth=-this.marker.viewPos[2];var e=this.isOccluded(),t=this.isOcclusionIgnored(),n=this.isOnCanvas(),i=e&&!t,o=void 0===this.objectShown?n&&!i:n&&this.objectShown&&!i;o!==this.shown&&(this.shown=o,this.setDisplay(o)),this.setElementPosition(),this.setElementScale(),this.setTagPosition(),this.setWirePosition();var a=this.marker.canvasPos,r=a[0],c=a[1];this.positionUpdated$.next({id:this.label.id,canvasPos:{x:r,y:c},occluded:i})}}},{key:"isOcclusionIgnored",value:function(){return this.selected||!this.label.occludable}},{key:"isOccluded",value:function(){return this.depth<0||this.marker.occluded}},{key:"isOnCanvas",value:function(){var e=this.labelsService.getLabelContainer().nativeElement,t=e.offsetWidth,n=e.offsetHeight,i=u(this.marker.canvasPos,2),o=i[0],a=i[1];return o>0&&a>0&&o<t&&a<n}},{key:"setDisplay",value:function(e){this.renderer.setStyle(this.labelRef.nativeElement,"visibility",e?"visible":"hidden"),this.emitDisplayUpdated({id:this.label.id,inView:this.isOnCanvas(),shown:e,objectShown:this.objectShown})}},{key:"setOpacity",value:function(e){var t=1;e?(this.marker.viewAngle>=80&&(t=Math.max(1-(this.marker.viewAngle-80)/20*1,0)),this.renderer.setStyle(this.labelContainerRef.nativeElement,"opacity",t)):this.renderer.setStyle(this.labelContainerRef.nativeElement,"opacity",1)}},{key:"setElementPosition",value:function(){var e=this.marker.canvasPos;this.renderer.setStyle(this.labelContainerRef.nativeElement,"transform","translate(".concat(e[0],"px, ").concat(e[1],"px)"))}},{key:"setElementScale",value:function(){if(!this.scale){var e=this.store.selectSnapshot(qa.getEnginePosition).width;this.scale=e>1440?e/1440:1}var t=32*this.scale-32;this.renderer.setStyle(this.labelRef.nativeElement,"transform-origin","top left"),this.renderer.setStyle(this.labelRef.nativeElement,"transform","translate(-".concat(t/2,"px, -").concat(t/2,"px) scale(").concat(this.scale,", ").concat(this.scale,")"))}},{key:"setTagPosition",value:function(){var e=this.label.offset,t=this.tagRef.nativeElement.offsetWidth;switch(this.label.offset[0]>0?"left":"right"){case"left":this.renderer.setStyle(this.tagRef.nativeElement,"transform","translate(".concat(16+e[0],"px, ").concat(e[1],"px)"));break;case"right":this.renderer.setStyle(this.tagRef.nativeElement,"transform","translate(".concat(16+e[0]-t,"px, ").concat(e[1],"px)"))}}},{key:"setWirePosition",value:function(){var e=u(this.label.offset,2),t=e[0],n=e[1];switch(this.label.theme){case Xn.Annotation:case Xn.Classic:n+=this.titleRef.nativeElement.offsetHeight-16-2}var i=Math.sqrt(t*t+n*n);this.renderer.setStyle(this.wireRef.nativeElement,"width",i+"px"),this.renderer.setStyle(this.wireRef.nativeElement,"transform","rotate(".concat(Math.atan2(n,t),"rad)"))}},{key:"emitDisplayUpdated",value:function(e){"context-label"!==this.label.id&&null!=e.inView&&null!=e.shown&&this.displayUpdated$.next(e)}}]),e}()).\u0275fac=function(e){return new(e||bd)(_.Pb(_.H),_.Pb(wi),_.Pb(Nt),_.Pb(dn),_.Pb(L.g),_.Pb(L.b),_.Pb(_.i))},bd.\u0275cmp=_.Jb({type:bd,selectors:[["app-generic-label"]],viewQuery:function(e,t){var n;1&e&&(_.Gc(cd,!0),_.Gc(sd,!0),_.Gc(ld,!0),_.Gc(pd,!0),_.Gc(ud,!0),_.Gc(dd,!0)),2&e&&(_.uc(n=_.dc())&&(t.labelContainerRef=n.first),_.uc(n=_.dc())&&(t.labelRef=n.first),_.uc(n=_.dc())&&(t.wireRef=n.first),_.uc(n=_.dc())&&(t.tagRef=n.first),_.uc(n=_.dc())&&(t.pinRef=n.first),_.uc(n=_.dc())&&(t.titleRef=n.first))},inputs:{fit:"fit",opaque:"opaque",scale:"scale",sequence:"sequence",hasContent:"hasContent",label:"label",isCollapsed:"isCollapsed",descriptionCollapsed:"descriptionCollapsed",tagCollapsed:"tagCollapsed",selected:"selected",theme:"theme",pinDraggable:"pinDraggable",tagDraggable:"tagDraggable"},outputs:{labelUpdated:"labelUpdated",offsetUpdated:"offsetUpdated",pinClicked:"pinClicked",tagClicked:"tagClicked",displayUpdated:"displayUpdated",positionUpdated:"positionUpdated",hoverStart:"hoverStart",hoverEnd:"hoverEnd",labelOffsetUpdated:"labelOffsetUpdated"},ngContentSelectors:wd,decls:21,vars:27,consts:[["data-test","labelContainer","aria-hidden","true",1,"label-container"],["labelContainerEl",""],["data-test","labelElement",1,"label",3,"ngClass"],["labelEl",""],[1,"label__pin"],["pin",""],[3,"label","labelTheme","selected","sequence"],[1,"label__glow"],[1,"label__wire",3,"ngClass"],["wire",""],[1,"label__tag",3,"ngClass"],["tag",""],[1,"label__header"],["data-test","labelTitle",1,"label__title"],["title",""],["class","label__more",4,"ngIf"],["appEventFence","",1,"label__actions"],["class","label__body",3,"ngClass",4,"ngIf"],[1,"label__more"],["icon","caret-right"],[1,"label__body",3,"ngClass"]],template:function(e,t){1&e&&(_.kc(vd),_.Vb(0,"div",0,1),_.Vb(2,"div",2,3),_.Vb(4,"div",4,5),_.Qb(6,"app-label-pin",6),_.Qb(7,"div",7),_.Ub(),_.Qb(8,"div",8,9),_.Vb(10,"div",10,11),_.Vb(12,"div",12),_.Vb(13,"div",13,14),_.jc(15),_.Ub(),_.Kc(16,gd,2,0,"div",15),_.Vb(17,"div",16),_.jc(18,1),_.Ub(),_.Ub(),_.Kc(19,fd,2,3,"div",17),_.jc(20,2),_.Ub(),_.Ub(),_.Ub()),2&e&&(_.Db(2),_.lc("ngClass",_.tc(9,md,[t.selected,t.label.pinGlow,"annotation"===t.label.theme,"classic"===t.label.theme,t.isBackgroundDark,"studioNext"===t.label.theme,"context"===t.label.theme,t.screenshotMode,"auto"===t.fit,t.opaque])),_.Db(4),_.lc("label",t.label)("labelTheme",t.label.theme)("selected",t.selected)("sequence",t.sequence),_.Db(2),_.lc("ngClass",_.oc(20,yd,t.isCollapsed||t.tagCollapsed||t.label.hideWire)),_.Db(2),_.lc("ngClass",_.rc(22,xd,t.isCollapsed||t.tagCollapsed,t.label.collapseDescription,t.label.hideWire,t.tagDraggable)),_.Db(6),_.lc("ngIf",t.hasContent&&t.label.collapseDescription),_.Db(3),_.lc("ngIf",t.hasContent))},directives:[or.i,od,or.l,Zs,Js],styles:[".text-8[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase[_ngcontent-%COMP%]{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase[_ngcontent-%COMP%]{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase[_ngcontent-%COMP%]{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase[_ngcontent-%COMP%]{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-header[_ngcontent-%COMP%]{font-weight:700}.text--code[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.text-xlight[_ngcontent-%COMP%]{font-weight:200}.text-light[_ngcontent-%COMP%]{font-weight:300}.text-medium[_ngcontent-%COMP%]{font-weight:500}.text-semibold[_ngcontent-%COMP%]{font-weight:600}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-underline[_ngcontent-%COMP%]{text-decoration:underline}.text-italic[_ngcontent-%COMP%]{font-style:italic}.text-bright[_ngcontent-%COMP%]{color:#fff}.text-dim[_ngcontent-%COMP%]{color:#96a8c0}.text-error[_ngcontent-%COMP%]{color:#ed4758}.text-left[_ngcontent-%COMP%]{text-align:left}.text-center[_ngcontent-%COMP%]{text-align:center}.text-right[_ngcontent-%COMP%]{text-align:right}.text-ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link[_ngcontent-%COMP%], .text-link[_ngcontent-%COMP%]:visited{color:inherit;cursor:pointer}.text-link[_ngcontent-%COMP%]:not(.text-underline), .text-link[_ngcontent-%COMP%]:visited:not(.text-underline){text-decoration:none}.text-success[_ngcontent-%COMP%]{color:#38de38}.text-danger[_ngcontent-%COMP%]{color:#de3838}.text-info[_ngcontent-%COMP%]{color:#0060c4}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.text-pre-line[_ngcontent-%COMP%]{white-space:pre-line}@-webkit-keyframes fadeIn{0%{display:none;opacity:0}1%{display:block;opacity:0}to{opacity:1;display:block}}@keyframes fadeIn{0%{display:none;opacity:0}1%{display:block;opacity:0}to{opacity:1;display:block}}@-webkit-keyframes fadeOut{0%{display:block;opacity:1}99%{opacity:0}to{opacity:0;display:none}}@keyframes fadeOut{0%{display:block;opacity:1}99%{opacity:0}to{opacity:0;display:none}}@-webkit-keyframes glow{0%{box-shadow:0 0 0 hsla(0,0%,100%,.5)}50%{box-shadow:0 0 8px 2px hsla(0,0%,100%,.5)}to{box-shadow:0 0 0 hsla(0,0%,100%,.5)}}@keyframes glow{0%{box-shadow:0 0 0 hsla(0,0%,100%,.5)}50%{box-shadow:0 0 8px 2px hsla(0,0%,100%,.5)}to{box-shadow:0 0 0 hsla(0,0%,100%,.5)}}@-webkit-keyframes classic-glow{0%{transform:scale(.5)}10%{transform:scale(.5)}50%{transform:scale(1)}90%{transform:scale(.5)}to{transform:scale(.5)}}@keyframes classic-glow{0%{transform:scale(.5)}10%{transform:scale(.5)}50%{transform:scale(1)}90%{transform:scale(.5)}to{transform:scale(.5)}}.label-container[_ngcontent-%COMP%], [_nghost-%COMP%]{display:block;position:absolute;z-index:10;width:160px;pointer-events:all;pointer-events:none}.label-container[_ngcontent-%COMP%]:hover, [_nghost-%COMP%]:hover{z-index:11}.label-container[_ngcontent-%COMP%]{left:-16px;top:-16px}.label[_ngcontent-%COMP%]{display:block;overflow:visible;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;justify-content:center;align-items:center;height:32px}.label--screenshot-mode[_ngcontent-%COMP%]   .label__pin[_ngcontent-%COMP%]:after, .label--screenshot-mode[_ngcontent-%COMP%]   .label__pin[_ngcontent-%COMP%]:before, .label--screenshot-mode[_ngcontent-%COMP%]   .label__tag[_ngcontent-%COMP%]{box-shadow:none!important}.label--screenshot-mode[_ngcontent-%COMP%]   .label__more[_ngcontent-%COMP%]{display:none!important}.label--auto-fit[_ngcontent-%COMP%]   .label__tag[_ngcontent-%COMP%]{min-width:-webkit-max-content;min-width:-moz-max-content;min-width:max-content;padding:0!important}.label--auto-fit[_ngcontent-%COMP%]   .label__body[_ngcontent-%COMP%]{padding:0!important}.label__glow[_ngcontent-%COMP%]{display:none;position:absolute;width:32px;height:32px;border-radius:50%;z-index:0;top:0;left:0}.label--selected[_ngcontent-%COMP%]   .label__more[_ngcontent-%COMP%]{transform:rotate(45deg)}.label__more[_ngcontent-%COMP%]{color:#374a68;display:none;flex:0 0 16px;height:16px;transition:transform .15s ease-in-out}.label__more[_ngcontent-%COMP%], .label__pin[_ngcontent-%COMP%]{align-items:center;justify-content:center}.label__pin[_ngcontent-%COMP%]{display:flex;width:32px;height:32px;border-radius:50%;position:absolute;pointer-events:all;transition:background-color .12s;z-index:10}.label__pin[_ngcontent-%COMP%]:hover{cursor:pointer}.label__pin--draggable[_ngcontent-%COMP%]:hover{cursor:-webkit-grab;cursor:grab}.label__pin--draggable[_ngcontent-%COMP%]:active{cursor:-webkit-grabbing;cursor:grabbing}.label__wire[_ngcontent-%COMP%]{position:absolute;top:16px;left:16px;height:0;transform-origin:0 100%;pointer-events:none;z-index:1}.label__wire--collapse[_ngcontent-%COMP%]{display:none}.label__tag[_ngcontent-%COMP%]{display:inline-block;left:16px;top:0;z-index:10;max-width:160px;pointer-events:all}.label__tag[_ngcontent-%COMP%]:hover{cursor:pointer}.label__tag--draggable[_ngcontent-%COMP%]:hover{cursor:-webkit-grab;cursor:grab}.label__tag--draggable[_ngcontent-%COMP%]:active{cursor:-webkit-grabbing;cursor:grabbing}.label__tag--collapse[_ngcontent-%COMP%]{display:none}.label__header[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.label__title[_ngcontent-%COMP%]{line-height:1.4em;line-height:140%;align-self:center}.label__body[_ngcontent-%COMP%], .label__title[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px}.label__body[_ngcontent-%COMP%]{line-height:1.4em}.label__body--collapse[_ngcontent-%COMP%]{display:none}.label__icon[_ngcontent-%COMP%]{margin:0 -4px 0 4px}.label__actions[_ngcontent-%COMP%]{padding-left:4px}.label--studio.label--glow[_ngcontent-%COMP%]   .label__glow[_ngcontent-%COMP%]{background-color:hsla(0,0%,100%,.3);display:block;-webkit-animation:classic-glow 4s infinite;animation:classic-glow 4s infinite}.label--studio.label--opaque[_ngcontent-%COMP%]   .label__tag[_ngcontent-%COMP%]{background-color:hsla(0,0%,100%,.85)!important}.label--studio.label.label--selected[_ngcontent-%COMP%]   .label__wire[_ngcontent-%COMP%]{border-color:#2d72dc}.label--studio.label.label--selected[_ngcontent-%COMP%]   .label__tag[_ngcontent-%COMP%]{background-color:#fff;border-color:#2d72dc;box-shadow:0 0 0 1px rgba(45,114,220,.7)}.label--studio.label.label--selected[_ngcontent-%COMP%]   .label__title[_ngcontent-%COMP%]{font-weight:600}.label--studio.label[_ngcontent-%COMP%]   .label__wire[_ngcontent-%COMP%]{border-top:1px solid rgba(16,24,35,.5)}.label--studio.label[_ngcontent-%COMP%]   .label__wire--collapse[_ngcontent-%COMP%]{display:none}.label--studio.label[_ngcontent-%COMP%]   .label__tag[_ngcontent-%COMP%]{background:hsla(0,0%,100%,.55);border:1px solid rgba(16,24,35,.5);box-shadow:0 0 24px rgba(16,24,35,.1);padding:4px 8px;border-radius:4px}.label--studio.label[_ngcontent-%COMP%]   .label__tag[_ngcontent-%COMP%]:hover{background:hsla(0,0%,100%,.8)}.label--studio.label[_ngcontent-%COMP%]   .label__title[_ngcontent-%COMP%]{color:#101823;flex:1 1 auto}.label--studio.label[_ngcontent-%COMP%]   .label__body[_ngcontent-%COMP%]{color:#374a68;overflow-x:hidden;padding-top:4px}.label--studio.label[_ngcontent-%COMP%]   .label__body[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{font-weight:700}.label--studio.label[_ngcontent-%COMP%]   .label__body[_ngcontent-%COMP%]   em[_ngcontent-%COMP%]{font-style:italic}.label--studio.label[_ngcontent-%COMP%]   .label__more[_ngcontent-%COMP%]{display:flex}.label--studio.label.label--invert[_ngcontent-%COMP%]   .label__wire[_ngcontent-%COMP%]{border-color:hsla(0,0%,100%,.5)}.label--annotation.label--glow[_ngcontent-%COMP%]   .label__glow[_ngcontent-%COMP%]{background-color:hsla(0,0%,100%,.25);display:block;-webkit-animation:classic-glow 4s infinite;animation:classic-glow 4s infinite;top:-1px;left:-1px}.label--annotation.label--none[_ngcontent-%COMP%]{display:none}.label--annotation.label[_ngcontent-%COMP%]   .label__wire[_ngcontent-%COMP%]{border-top:1px solid #666}.label--annotation.label[_ngcontent-%COMP%]   .label__tag[_ngcontent-%COMP%]{text-shadow:0 0 2px hsla(0,0%,100%,.5);min-width:10px;color:#eee}.label--annotation.label[_ngcontent-%COMP%]   .label__tag--collapsible[_ngcontent-%COMP%]   .label__more[_ngcontent-%COMP%]{display:flex;color:#000}.label--annotation.label[_ngcontent-%COMP%]   .label__tag--floating[_ngcontent-%COMP%]   .label__header[_ngcontent-%COMP%]{border-bottom:none}.label--annotation.label[_ngcontent-%COMP%]   .label__header[_ngcontent-%COMP%]{border-bottom:1px solid #666}.label--annotation.label[_ngcontent-%COMP%]   .label__title[_ngcontent-%COMP%]{font-weight:600;min-height:18px;width:100%;padding-bottom:4px;margin-bottom:-2px;color:#000}.label--annotation.label[_ngcontent-%COMP%]   .label__body[_ngcontent-%COMP%]{padding-top:4px;color:#333}.label--annotation.label.label--invert.label[_ngcontent-%COMP%]{text-shadow:0 0 2px rgba(0,0,0,.6)}.label--annotation.label.label--invert.label[_ngcontent-%COMP%]   .label__wire[_ngcontent-%COMP%]{border-color:#eee}.label--annotation.label.label--invert.label[_ngcontent-%COMP%]   .label__tag[_ngcontent-%COMP%]{text-shadow:none}.label--annotation.label.label--invert.label[_ngcontent-%COMP%]   .label__tag--collapsible[_ngcontent-%COMP%]   .label__more[_ngcontent-%COMP%]{display:flex;color:#fff}.label--annotation.label.label--invert.label[_ngcontent-%COMP%]   .label__title[_ngcontent-%COMP%]{color:#fff}.label--annotation.label.label--invert.label[_ngcontent-%COMP%]   .label__header[_ngcontent-%COMP%]{border-color:#eee}.label--annotation.label.label--invert.label[_ngcontent-%COMP%]   .label__body[_ngcontent-%COMP%]{color:#eee}.label--classic.label--glow[_ngcontent-%COMP%]   .label__glow[_ngcontent-%COMP%]{background-color:rgba(0,0,0,.2);display:block;-webkit-animation:classic-glow 4s infinite;animation:classic-glow 4s infinite}.label--classic.label[_ngcontent-%COMP%]   .label__wire[_ngcontent-%COMP%]{border-top:1px solid #666}.label--classic.label[_ngcontent-%COMP%]   .label__tag[_ngcontent-%COMP%]{min-width:10px;color:#eee}.label--classic.label[_ngcontent-%COMP%]   .label__title[_ngcontent-%COMP%]{border-bottom:1px solid #666;min-height:18px;width:100%;padding-bottom:4px;color:#000}.label--classic.label[_ngcontent-%COMP%]   .label__body[_ngcontent-%COMP%]{padding-top:4px;color:#333}.label--context.label[_ngcontent-%COMP%]{pointer-events:none}.label--context.label--glow[_ngcontent-%COMP%]   .label__glow[_ngcontent-%COMP%]{background-color:hsla(0,0%,100%,.3);display:block;-webkit-animation:classic-glow 4s infinite;animation:classic-glow 4s infinite}.label--context.label[_ngcontent-%COMP%]   .label__pin[_ngcontent-%COMP%], .label--context.label[_ngcontent-%COMP%]   .label__wire[_ngcontent-%COMP%]{display:none}.label--context.label[_ngcontent-%COMP%]   .label__tag[_ngcontent-%COMP%]{background:hsla(0,0%,100%,.7);border:1px solid rgba(16,24,35,.5);box-shadow:0 0 24px rgba(16,24,35,.1);padding:4px 8px;border-radius:4px}.label--context.label[_ngcontent-%COMP%]   .label__tag[_ngcontent-%COMP%]:hover{background:hsla(0,0%,100%,.8);cursor:-webkit-grab;cursor:grab}.label--context.label[_ngcontent-%COMP%]   .label__title[_ngcontent-%COMP%]{font-weight:600;color:#101823}.label--context.label[_ngcontent-%COMP%]   .label__body[_ngcontent-%COMP%]{margin-top:8px;border-top:1px solid #eaeff5;color:#101823;overflow-x:hidden;padding-top:8px}.label--context.label[_ngcontent-%COMP%]   .label__body[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{font-weight:700}.label--context.label[_ngcontent-%COMP%]   .label__body[_ngcontent-%COMP%]   em[_ngcontent-%COMP%]{font-style:italic}"],changeDetection:0}),ad([Object(L.d)(qa.getEnginePosition),rd("design:type",he.a)],bd.prototype,"enginePosition$",void 0),ad([Object(L.d)(Ua.getSelectedChapterBackground),rd("design:type",he.a)],bd.prototype,"background$",void 0),bd),Od=h("lR5k"),Cd=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function Sd(e,t){if(1&e&&_.Qb(0,"app-node-actions",7),2&e){var n=_.gc(2);_.lc("node",n.node)}}function _d(e,t){if(1&e&&(_.Vb(0,"div",5),_.jc(1),_.Kc(2,Sd,1,1,"app-node-actions",6),_.Ub()),2&e){var n=_.gc();_.Db(2),_.lc("ngIf",n.enableActions)}}function jd(e,t){if(1&e){var n=_.Wb();_.Vb(0,"a",10),_.cc("click",(function(){return _.zc(n),_.gc(2).handleReadMoreClick()})),_.Mc(1,"Read More..."),_.Ub()}2&e&&_.lc("@show",void 0)}function Pd(e,t){if(1&e&&(_.Tb(0,8),_.Kc(1,jd,2,1,"a",9),_.Sb()),2&e){var n=_.gc();_.Db(1),_.lc("ngIf",n.node&&n.node.description)}}var Md,Id=["*"],zd=((Md=function(){function e(t,n,i,o,a){m(this,e),this.store=t,this.actions=n,this.engineService=i,this.viewService=o,this.changeDetectorRef=a,this.ngUnsubscribe=new ge.a}return v(e,[{key:"label",get:function(){return this._label},set:function(e){this._label=e,this.setLabelNode()}},{key:"ngOnInit",value:function(){this.initInfoListeners()}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"setLabelNode",value:function(){var e=Object(Oe.get)(this.label,"objectId");if(e){var t=this.store.selectSnapshot(qa.getViewGraph);this.node=this.engineService.getNode(t,e)}else this.node=null;this.changeDetectorRef.markForCheck()}},{key:"initInfoListeners",value:function(){var e=this;this.actions.pipe(Object(L.i)(vt),Object(fe.a)(this.ngUnsubscribe)).subscribe((function(){e.setLabelNode()}))}},{key:"handleReadMoreClick",value:function(){this.node&&this.viewService.toggleNodeInfo(!0)}}]),e}()).\u0275fac=function(e){return new(e||Md)(_.Pb(L.g),_.Pb(L.b),_.Pb(Nt),_.Pb(Bu),_.Pb(_.i))},Md.\u0275cmp=_.Jb({type:Md,selectors:[["app-context-label"]],inputs:{label:"label",enableInfo:"enableInfo",enableActions:"enableActions"},ngContentSelectors:Id,decls:6,vars:6,consts:[[1,"context-label",3,"label"],["label-header","",1,"html",3,"innerHTML"],["title",""],["class","context-label__actions","label-actions","",4,"ngIf"],["label-more","",4,"ngIf"],["label-actions","",1,"context-label__actions"],["eventCategory","Context Node","theme","light",3,"node",4,"ngIf"],["eventCategory","Context Node","theme","light",3,"node"],["label-more",""],["class","context-label__more",3,"click",4,"ngIf"],[1,"context-label__more",3,"click"]],template:function(e,t){1&e&&(_.kc(),_.Vb(0,"app-generic-label",0),_.Qb(1,"div",1,2),_.hc(3,"markdown"),_.Kc(4,_d,3,1,"div",3),_.Kc(5,Pd,2,1,"ng-container",4),_.Ub()),2&e&&(_.lc("label",t.label),_.Db(1),_.lc("innerHTML",_.ic(3,4,t.label.title),_.Ac),_.Db(3),_.lc("ngIf",t.node),_.Db(1),_.lc("ngIf",t.enableInfo))},directives:[kd,or.l,_l],pipes:[Od.b],styles:[".text-8[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase[_ngcontent-%COMP%]{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase[_ngcontent-%COMP%]{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase[_ngcontent-%COMP%]{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase[_ngcontent-%COMP%]{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-header[_ngcontent-%COMP%]{font-weight:700}.text--code[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.text-xlight[_ngcontent-%COMP%]{font-weight:200}.text-light[_ngcontent-%COMP%]{font-weight:300}.text-medium[_ngcontent-%COMP%]{font-weight:500}.text-semibold[_ngcontent-%COMP%]{font-weight:600}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-underline[_ngcontent-%COMP%]{text-decoration:underline}.text-italic[_ngcontent-%COMP%]{font-style:italic}.text-bright[_ngcontent-%COMP%]{color:#fff}.text-dim[_ngcontent-%COMP%]{color:#96a8c0}.text-error[_ngcontent-%COMP%]{color:#ed4758}.text-left[_ngcontent-%COMP%]{text-align:left}.text-center[_ngcontent-%COMP%]{text-align:center}.text-right[_ngcontent-%COMP%]{text-align:right}.text-ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link[_ngcontent-%COMP%], .text-link[_ngcontent-%COMP%]:visited{color:inherit;cursor:pointer}.text-link[_ngcontent-%COMP%]:not(.text-underline), .text-link[_ngcontent-%COMP%]:visited:not(.text-underline){text-decoration:none}.text-success[_ngcontent-%COMP%]{color:#38de38}.text-danger[_ngcontent-%COMP%]{color:#de3838}.text-info[_ngcontent-%COMP%]{color:#0060c4}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.text-pre-line[_ngcontent-%COMP%]{white-space:pre-line}.context-label__actions[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center}.context-label__action[_ngcontent-%COMP%]{cursor:pointer}.context-label__action--selected[_ngcontent-%COMP%]{color:#0060c4}.context-label__more[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em;cursor:pointer;display:block;line-height:24px;overflow:hidden}.context-label__more[_ngcontent-%COMP%]:hover{text-decoration:underline}"],data:{animation:[Object(fp.n)("show",[Object(fp.m)(":enter",[Object(fp.j)([Object(fp.l)({height:"0"}),Object(fp.e)("125ms ease-in-out",Object(fp.l)({height:"*"}))])])])]},changeDetection:0}),function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);a>3&&r&&Object.defineProperty(t,n,r)}([Object(L.d)(qa.getQuerying),Cd("design:type",he.a)],Md.prototype,"querying$",void 0),Md),Td=function(e){return e.Normal="normal",e.Compact="compact",e}({}),Ud=function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r},Ld=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Dd=["image"],Ed=["imagePre"],Fd=["imagePost"],Ad=["imageContainer"];function Rd(e,t){if(1&e&&(_.Qb(0,"span",8),_.hc(1,"markdown")),2&e){var n=_.gc();_.lc("innerHTML",_.ic(1,1,n.label),_.Ac)}}function Nd(e,t){if(1&e&&_.Qb(0,"img",9,10),2&e){var n=_.gc();_.lc("src",n.imageUrl,_.Cc)}}function Vd(e,t){if(1&e&&_.Qb(0,"img",11,12),2&e){var n=_.gc();_.lc("src",n.imageUrl,_.Cc)}}var Hd,Bd=((Hd=function(){function e(t,n,i){m(this,e),this.renderer=t,this.engineService=n,this.animationService=i,this.ngUnsubscribe=new ge.a,this.loopImage=!1}return v(e,[{key:"ngOnInit",value:function(){this.initChapterListener(),this.initTimelineListener()}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"initChapterListener",value:function(){var e=this;this.selectedChapterId$.pipe(Object(be.a)((function(e){return null!=e})),Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){e.timerange=e.animationService.getChapterLocalTimerange(t)}))}},{key:"initTimelineListener",value:function(){var e=this;Object($a.a)(this.engineService.getEvent(Lt.TimelineScrubbed),this.engineService.getEvent(Lt.TimelinePlaying)).pipe(Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){var n=e.getChapterPercent(t.time);e.moveImage(n)}))}},{key:"moveImage",value:function(e){var t=this.image.nativeElement.getBoundingClientRect().width;this.renderer.setStyle(this.imageContainer.nativeElement,"transform","translate(".concat(e/100*-t,"px, 0)")),this.loopImage&&(this.renderer.setStyle(this.imagePre.nativeElement,"transform","translate(".concat(-t,"px, 0)")),this.renderer.setStyle(this.imagePost.nativeElement,"transform","translate(".concat(t,"px, 0)")))}},{key:"getChapterPercent",value:function(e){var t=this.timerange,n=t.firstTime,i=t.lastTime,o=this.animationService.mapGlobalTimeToLocal(e).time;return Math.max(n,Math.min(o,i))/i*100}}]),e}()).\u0275fac=function(e){return new(e||Hd)(_.Pb(_.H),_.Pb(Nt),_.Pb(xa))},Hd.\u0275cmp=_.Jb({type:Hd,selectors:[["app-ticker-block-item"]],viewQuery:function(e,t){var n;1&e&&(_.Gc(Dd,!0),_.Rc(Ed,!0),_.Rc(Fd,!0),_.Gc(Ad,!0)),2&e&&(_.uc(n=_.dc())&&(t.image=n.first),_.uc(n=_.dc())&&(t.imagePre=n.first),_.uc(n=_.dc())&&(t.imagePost=n.first),_.uc(n=_.dc())&&(t.imageContainer=n.first))},inputs:{label:"label",imageUrl:"imageUrl",loopImage:"loopImage"},decls:8,vars:4,consts:[[1,"ticker-block-item"],["class","ticker-block-item__label html",3,"innerHTML",4,"ngIf"],[1,"ticker-block__image-container"],["imageContainer",""],["class","ticker-block-item__image ticker-block-item__image--pre",3,"src",4,"ngIf"],["class","ticker-block-item__image ticker-block-item__image--post",3,"src",4,"ngIf"],[1,"ticker-block-item__image",3,"src"],["image",""],[1,"ticker-block-item__label","html",3,"innerHTML"],[1,"ticker-block-item__image","ticker-block-item__image--pre",3,"src"],["imagePre",""],[1,"ticker-block-item__image","ticker-block-item__image--post",3,"src"],["imagePost",""]],template:function(e,t){1&e&&(_.Vb(0,"div",0),_.Kc(1,Rd,2,3,"span",1),_.Vb(2,"div",2,3),_.Kc(4,Nd,2,1,"img",4),_.Kc(5,Vd,2,1,"img",5),_.Qb(6,"img",6,7),_.Ub(),_.Ub()),2&e&&(_.Db(1),_.lc("ngIf",t.label),_.Db(3),_.lc("ngIf",t.loopImage),_.Db(1),_.lc("ngIf",t.loopImage),_.Db(1),_.lc("src",t.imageUrl,_.Cc))},directives:[or.l],pipes:[Od.b],styles:['.ticker-block-item[_ngcontent-%COMP%]{background:#f9fafd;background:linear-gradient(90deg,#f9fafd 20%,hsla(0,0%,100%,0) 40%,#fff 60%,#f9fafd 80%);overflow:hidden;padding-left:50%;position:relative}.ticker-block-item[_ngcontent-%COMP%]:hover   .ticker-block-item__label[_ngcontent-%COMP%]{background:hsla(0,0%,100%,.9)}.ticker-block-item[_ngcontent-%COMP%]:after{content:"";display:block;position:absolute;left:50%;top:0;height:100%;width:1px;background:red;box-shadow:0 0 0 4px rgba(255,0,0,.2);z-index:10}.ticker-block-item__label[_ngcontent-%COMP%]{position:absolute;z-index:10;left:4px;top:4px;border-radius:8px;padding:2px 6px;font-size:12px;border:1px solid rgba(16,24,35,.5);background:hsla(0,0%,100%,.55)}.ticker-block-item__image-container[_ngcontent-%COMP%]{position:relative}.ticker-block-item__image[_ngcontent-%COMP%]{display:block}.ticker-block-item__image--post[_ngcontent-%COMP%], .ticker-block-item__image--pre[_ngcontent-%COMP%]{position:absolute;top:0;left:0}'],changeDetection:0}),Ud([Object(L.d)(qa.getAnimationPlaying),Ld("design:type",he.a)],Hd.prototype,"animationPlaying$",void 0),Ud([Object(L.d)(Ua.getSelectedChapterId),Ld("design:type",he.a)],Hd.prototype,"selectedChapterId$",void 0),Hd);function Qd(e,t){if(1&e&&_.Qb(0,"app-ticker-block-item",3),2&e){var n=t.$implicit,i=_.gc(2);_.lc("imageUrl",n.urls.default)("label",n.caption)("loopImage",i.tickerBlock.loopImage)}}function qd(e,t){if(1&e&&(_.Vb(0,"div",1),_.Kc(1,Qd,1,3,"app-ticker-block-item",2),_.Ub()),2&e){var n=_.gc();_.Db(1),_.lc("ngForOf",n.tickerBlock.images)}}var Wd,$d,Kd,Gd=((Kd=function(){function e(){m(this,e),this.ngUnsubscribe=new ge.a}return v(e,[{key:"ngOnInit",value:function(){}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}}]),e}()).\u0275fac=function(e){return new(e||Kd)},Kd.\u0275cmp=_.Jb({type:Kd,selectors:[["app-ticker-block"]],inputs:{tickerBlock:"tickerBlock"},decls:1,vars:1,consts:[["class","ticker-block",4,"ngIf"],[1,"ticker-block"],[3,"imageUrl","label","loopImage",4,"ngFor","ngForOf"],[3,"imageUrl","label","loopImage"]],template:function(e,t){1&e&&_.Kc(0,qd,2,1,"div",0),2&e&&_.lc("ngIf",t.tickerBlock)},directives:[or.l,or.k,Bd],styles:[""],changeDetection:0}),Kd),Zd=(($d=function(){function e(t,n){m(this,e),this.domSanitizer=t,this.markdownService=n}return v(e,[{key:"html",set:function(e){this.safeHTML=this.domSanitizer.bypassSecurityTrustHtml(e||"")}},{key:"markdownText",set:function(e){this.html=this.markdownService.compile(e,!0)}},{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||$d)(_.Pb(T.b),_.Pb(Od.c))},$d.\u0275cmp=_.Jb({type:$d,selectors:[["app-html"]],inputs:{html:"html",markdownText:"markdownText"},decls:1,vars:1,consts:[[1,"html",3,"innerHTML"]],template:function(e,t){1&e&&_.Qb(0,"div",0),2&e&&_.lc("innerHTML",t.safeHTML,_.Ac)},styles:[""],encapsulation:2,changeDetection:0}),$d),Jd=((Wd=function(){function e(){m(this,e),this.layout=Td.Normal}return v(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||Wd)},Wd.\u0275cmp=_.Jb({type:Wd,selectors:[["app-markdown-block"]],inputs:{markdownBlock:"markdownBlock",layout:"layout"},decls:2,vars:1,consts:[[1,"markdown-block"],[3,"markdownText"]],template:function(e,t){1&e&&(_.Vb(0,"div",0),_.Qb(1,"app-html",1),_.Ub()),2&e&&(_.Db(1),_.lc("markdownText",t.markdownBlock.markdown))},directives:[Zd],styles:[""],encapsulation:2,changeDetection:0}),Wd),Xd=h("0IaG");function Yd(e,t){if(1&e&&_.Qb(0,"app-icon",5),2&e){var n=_.gc();_.lc("icon",n.icon)}}function eg(e,t){if(1&e&&_.Qb(0,"span",6),2&e){var n=_.gc();_.Hc("background-image","url("+n.src+")")}}function tg(e,t){if(1&e&&(_.Vb(0,"div",7),_.Mc(1),_.Ub()),2&e){var n=_.gc();_.Db(1),_.Oc(" ",n.label," ")}}var ng,ig=function(e,t,n,i,o,a,r,c,s,l,p,u,d){return{"pin-button--selected":e,"pin-button--disabled":t,"pin-button--small":n,"pin-button--medium":i,"pin-button--large":o,"pin-button--ghost":a,"pin-button--primary":r,"pin-button--secondary":c,"pin-button--outline":s,"pin-button--floating":l,"pin-button--dark":p,"pin-button--row":u,"pin-button--fill":d}},og=["*"],ag=((ng=function(){function e(){m(this,e),this.selectable=!1,this.size="medium",this.buttonType="default",this.direction="column",this.fill=!1,this._selected=!1,this.disabled=!1,this.selectedChange=new _.p}return v(e,[{key:"selected",get:function(){return this._selected},set:function(e){this._selected=e,this.selectedChange=new _.p}},{key:"ngOnInit",value:function(){}},{key:"handleClick",value:function(){this.disabled||this.selectable&&(this.selected=!this.selected)}}]),e}()).\u0275fac=function(e){return new(e||ng)},ng.\u0275cmp=_.Jb({type:ng,selectors:[["app-pin-button"],["button","app-pin-button",""]],inputs:{icon:"icon",src:"src",description:"description",label:"label",selectable:"selectable",size:"size",buttonType:"buttonType",direction:"direction",fill:"fill",selected:"selected",disabled:"disabled"},outputs:{selectedChange:"selectedChange"},ngContentSelectors:og,decls:6,vars:18,consts:[[1,"pin-button",3,"ngClass","click"],[1,"pin-button__pin"],["style","font-size: 14px !important",3,"icon",4,"ngIf"],["class","pin-button__image",3,"backgroundImage",4,"ngIf"],["class","pin-button__label",4,"ngIf"],[2,"font-size","14px !important",3,"icon"],[1,"pin-button__image"],[1,"pin-button__label"]],template:function(e,t){1&e&&(_.kc(),_.Vb(0,"div",0),_.cc("click",(function(){return t.handleClick()})),_.Vb(1,"div",1),_.Kc(2,Yd,1,1,"app-icon",2),_.Kc(3,eg,1,2,"span",3),_.jc(4),_.Ub(),_.Kc(5,tg,2,1,"div",4),_.Ub()),2&e&&(_.lc("ngClass",_.tc(4,ig,[t.selected,t.disabled,"small"===t.size,"medium"===t.size,"large"===t.size,"ghost"===t.buttonType,"primary"===t.buttonType,"secondary"===t.buttonType,"outline"===t.buttonType,"floating"===t.buttonType,"dark"===t.buttonType,"row"===t.direction,t.fill])),_.Db(2),_.lc("ngIf",t.icon),_.Db(1),_.lc("ngIf",t.src),_.Db(2),_.lc("ngIf",t.label))},directives:[or.i,or.l,Js],styles:[".text-8{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-header{font-weight:700}.text--code{font-family:Courier New,Courier,monospace}.text-uppercase{text-transform:uppercase}.text-xlight{font-weight:200}.text-light{font-weight:300}.text-medium{font-weight:500}.text-semibold{font-weight:600}.text-bold{font-weight:700}.text-underline{text-decoration:underline}.text-italic{font-style:italic}.text-bright{color:#fff}.text-dim{color:#96a8c0}.text-error{color:#ed4758}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.text-ellipsis{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link,.text-link:visited{color:inherit;cursor:pointer}.text-link:not(.text-underline),.text-link:visited:not(.text-underline){text-decoration:none}.text-success{color:#38de38}.text-danger{color:#de3838}.text-info{color:#0060c4}.text-nowrap{white-space:nowrap}.text-pre-line{white-space:pre-line}button[app-pin-button]{border-color:transparent;background:none;border-width:0;padding:0;outline:none;margin:0;pointer-events:all}button[app-pin-button]::-moz-focus-inner{border:0}button[app-pin-button]:not([disabled]):hover{cursor:pointer}button[app-pin-button]:focus :not(.pin-button--selected) .pin-button__pin{background:#f1f4fa;outline:none}button[app-pin-button]:focus :not(.pin-button--selected).pin-button--dark .pin-button__pin{background-color:#6a82a4!important}button[app-pin-button][disabled]{pointer-events:none}.pin-button{display:inline-flex;flex-flow:column;align-items:center;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-tap-highlight-color:rgba(0,0,0,0);-webkit-tap-highlight-color:transparent}.pin-button:hover{cursor:pointer}.pin-button:hover:not(.pin-button--selected):not(.pin-button--disabled) .pin-button__pin{background:rgba(215,224,234,.6);background:var(--pin-button-pin-background--hover)}.pin-button:not(.pin-button--selected):active:hover .pin-button__pin{background:#d7e0ea;background:var(--pin-button-pin-background--active)}.pin-button--selected .pin-button__pin{background-color:#2d72dc;background-color:var(--pin-button-pin-background--selected);color:#fff;color:var(--pin-button-pin-color--selected)}.pin-button--selected .pin-button__label{color:#2d72dc;color:var(--pin-button-label-color--selected);font-weight:600}.pin-button--small .pin-button__pin{border-radius:14px;min-width:28px;height:28px}.pin-button--small .pin-button__label{margin-top:0}.pin-button--large .pin-button__pin{font-size:20px;letter-spacing:.5px;line-height:1.4em}.pin-button--row{flex-direction:row}.pin-button--row .pin-button__label{margin:0 0 0 4px}.pin-button--ghost:not(.pin-button--selected) .pin-button__pin{background:transparent}.pin-button--outline:not(.pin-button--selected) .pin-button__pin{background:transparent;border:var(--pin-button-pin-border)}.pin-button--primary .pin-button__pin{background:var(--pin-button-pin-background--primary);color:var(--pin-button-pin-color--primary)}.pin-button--primary:not(.pin-button--selected):not(.pin-button--disabled) .pin-button__pin{background:#de3838;color:#fff;background:var(--pin-button-pin-background--primary)!important;color:var(--pin-button-pin-color--primary)!important}.pin-button--primary:not(.pin-button--selected):not(.pin-button--disabled):hover .pin-button__pin{background:#e24e4e;background:var(--pin-button-pin-background--primary-hover)!important}.pin-button--secondary .pin-button__pin{background:#0060c4;color:#fff;background:var(--pin-button-pin-background--secondary);color:var(--pin-button-pin-color--secondary)}.pin-button--secondary:not(.pin-button--selected):not(.pin-button--disabled) .pin-button__pin{background:#0060c4;color:#fff;background:var(--pin-button-pin-background--secondary)!important;color:var(--pin-button-pin-color--secondary)!important}.pin-button--secondary:not(.pin-button--selected):not(.pin-button--disabled):hover .pin-button__pin{background:#006cde;background:var(--pin-button-pin-background--secondary-hover)!important}.pin-button--disabled{opacity:.2}.pin-button--disabled:hover{cursor:auto}.pin-button--fill{width:100%;height:100%}.pin-button--fill .pin-button__pin{width:100%;height:100%;border-radius:50%}.pin-button--floating .pin-button__pin{background-color:#fff;background-color:var(--pin-button-pin-background--floating)}.pin-button--dark .pin-button__pin,.pin-button--floating .pin-button__pin{box-shadow:1px -1px 2px 0 rgba(28,42,63,.1),0 1px 2px 0 rgba(28,42,63,.3);box-shadow:var(--pin-button-shadow)}.pin-button--dark .pin-button__pin{color:#f9fafd;color:var(--pin-button-pin-color--dark);background-color:#1c2a3f!important;background-color:var(--pin-button-pin-background--dark)!important}.pin-button__pin{border-radius:20px;display:flex;font-size:12px;float:left;min-width:40px;height:40px;align-items:center;justify-content:center;position:relative;background-color:#eaeff5;color:#1c2a3f;background-color:var(--pin-button-pin-background);color:var(--pin-button-pin-color);transition:background-color 125ms}.pin-button__label{font-size:10px;letter-spacing:.25px;line-height:1.4em;color:#1c2a3f;color:var(--pin-button-label-color);padding:2px 0 4px}.pin-button__image{width:100%;height:100%;background-size:50%;background-repeat:no-repeat;background-position:50%}"],encapsulation:2,changeDetection:0}),ng),rg=h("Qu3c");function cg(e,t){if(1&e&&(_.Vb(0,"div",3),_.Mc(1),_.Ub()),2&e){var n=_.gc();_.Db(1),_.Oc(" ",n.label," ")}}var sg,lg=function(e,t,n){return[e,t,n]},pg=function(e){return e.Small="small",e.Medium="medium",e.Large="large",e.Huge="huge",e}({}),ug=function(e){return e.Horizontal="horizontal",e.Vertical="vertical",e}({}),dg=function(e){return e.Inline="inline",e.Block="block",e.Fill="fill",e}({}),gg=((sg=function(){function e(){m(this,e),this.size=pg.Medium,this.label="",this.direction=ug.Horizontal,this.render=dg.Fill}return v(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||sg)},sg.\u0275cmp=_.Jb({type:sg,selectors:[["app-spinner"]],inputs:{size:"size",label:"label",direction:"direction",render:"render"},decls:3,vars:6,consts:[[1,"spinner","spinner--horizontal",3,"ngClass"],[1,"spinner__circle"],["class","spinner__label",4,"ngIf"],[1,"spinner__label"]],template:function(e,t){1&e&&(_.Vb(0,"div",0),_.Qb(1,"div",1),_.Kc(2,cg,2,1,"div",2),_.Ub()),2&e&&(_.lc("ngClass",_.qc(2,lg,"spinner--"+t.size,"spinner--"+t.render,"spinner--"+t.direction)),_.Db(2),_.lc("ngIf",t.label.length))},directives:[or.i,or.l],styles:['@-webkit-keyframes spinner{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}@keyframes spinner{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}.spinner[_ngcontent-%COMP%]{display:inline-flex;justify-content:center;align-items:center}.spinner--small[_ngcontent-%COMP%]   .spinner__circle[_ngcontent-%COMP%], .spinner--small[_ngcontent-%COMP%]   .spinner__circle[_ngcontent-%COMP%]:after{width:11px;height:11px}.spinner--small[_ngcontent-%COMP%]   .spinner__label[_ngcontent-%COMP%]{font-size:10px}.spinner--medium[_ngcontent-%COMP%]   .spinner__circle[_ngcontent-%COMP%], .spinner--medium[_ngcontent-%COMP%]   .spinner__circle[_ngcontent-%COMP%]:after{width:14px;height:14px}.spinner--medium[_ngcontent-%COMP%]   .spinner__label[_ngcontent-%COMP%]{font-size:10px}.spinner--large[_ngcontent-%COMP%]   .spinner__circle[_ngcontent-%COMP%], .spinner--large[_ngcontent-%COMP%]   .spinner__circle[_ngcontent-%COMP%]:after{width:28px;height:28px}.spinner--large[_ngcontent-%COMP%]   .spinner__label[_ngcontent-%COMP%]{font-size:14px}.spinner--huge[_ngcontent-%COMP%]   .spinner__circle[_ngcontent-%COMP%], .spinner--huge[_ngcontent-%COMP%]   .spinner__circle[_ngcontent-%COMP%]:after{width:44px;height:44px}.spinner--huge[_ngcontent-%COMP%]   .spinner__label[_ngcontent-%COMP%]{font-size:16px}.spinner--horizontal[_ngcontent-%COMP%]{flex-direction:row}.spinner--vertical[_ngcontent-%COMP%]{align-items:center;flex-direction:column}.spinner--vertical[_ngcontent-%COMP%]   .spinner__label[_ngcontent-%COMP%]{padding:8px 0 0}.spinner--inline[_ngcontent-%COMP%]{display:inline-flex}.spinner--block[_ngcontent-%COMP%]{display:flex}.spinner--fill[_ngcontent-%COMP%]{display:flex;height:100%}.spinner__circle[_ngcontent-%COMP%]{width:14px;height:14px;border-radius:50%;border:2px solid rgba(16,24,35,.1);position:relative}.spinner__circle[_ngcontent-%COMP%]:after{-webkit-animation:spinner .4s linear infinite;animation:spinner .4s linear infinite;content:" ";border-radius:50%;border-color:hsla(0,0%,100%,.2) rgba(16,24,35,.2) transparent transparent;border-style:solid;border-width:2px;box-sizing:border-box;position:absolute;display:block;width:14px;height:14px;top:-2px;left:-2px}.spinner__label[_ngcontent-%COMP%]{padding-left:8px;font-size:14px;text-transform:uppercase}.theme-dark[_nghost-%COMP%]   .spinner__label[_ngcontent-%COMP%], .theme-dark   [_nghost-%COMP%]   .spinner__label[_ngcontent-%COMP%]{color:hsla(0,0%,100%,.2)}.theme-light[_nghost-%COMP%]   .spinner__label[_ngcontent-%COMP%], .theme-light   [_nghost-%COMP%]   .spinner__label[_ngcontent-%COMP%]{color:rgba(16,24,35,.2)}'],changeDetection:0}),sg);function hg(e,t){1&e&&(_.Vb(0,"div",4),_.Qb(1,"app-spinner",5),_.Ub())}var fg,bg,vg=((fg=function(){function e(t,n,i){m(this,e),this.dialogRef=t,this.data=n,this.changeRef=i,this.config=n}return v(e,[{key:"ngOnInit",value:function(){}},{key:"handleCloseClick",value:function(){this.dialogRef.close()}},{key:"handleImageLoaded",value:function(){this.imageLoaded=!0,this.changeRef.markForCheck()}}]),e}()).\u0275fac=function(e){return new(e||fg)(_.Pb(Xd.g),_.Pb(Xd.a),_.Pb(_.i))},fg.\u0275cmp=_.Jb({type:fg,selectors:[["app-image-dialog"]],decls:4,vars:4,consts:[[1,"dialog",3,"click"],["class","dialog__loading flex flex-column p-8",4,"ngIf"],[1,"dialog__image",3,"src","title","alt","load"],["app-pin-button","","buttonType","dark","size","large","icon","times","aria-label","Close","matTooltip","Close","matTooltipPosition","left",1,"dialog__close"],[1,"dialog__loading","flex","flex-column","p-8"],["size","huge"]],template:function(e,t){1&e&&(_.Vb(0,"div",0),_.cc("click",(function(){return t.handleCloseClick()})),_.Kc(1,hg,2,0,"div",1),_.Vb(2,"img",2),_.cc("load",(function(){return t.handleImageLoaded()})),_.Ub(),_.Qb(3,"button",3),_.Ub()),2&e&&(_.Db(1),_.lc("ngIf",!t.imageLoaded),_.Db(1),_.lc("src",t.config.src,_.Cc)("title",t.config.title||"")("alt",t.config.alt||""))},directives:[or.l,ag,rg.c,gg],styles:[".dialog[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%;width:100%}.dialog__loading[_ngcontent-%COMP%]{position:absolute}.dialog__image[_ngcontent-%COMP%]{max-width:100%;max-height:100vh}.dialog__close[_ngcontent-%COMP%]{position:fixed;top:24px;right:24px}"],changeDetection:0}),fg),mg=function(e){return e.ClipboardDialog="ClipboardDialog",e.WelcomeTourDialog="WelcomeTourDialog",e.JoinDomainDialog="JoinDomainDialog",e.NpsSurveyDialog="NpsSurveyDialog",e.ConfirmDialog="ConfirmDialog",e.LimitDialog="LimitDialog",e.UpgradeDialog="UpgradeDialog",e.BuyDialog="BuyDialog",e.ProfileDialog="ProfileDialog",e.SaveModuleDialog="SaveModuleDialog",e.SaveBookmarkDialog="SaveBookmarkDialog",e.SaveAsBookmarkDialog="SaveAsBookmarkDialog",e.ManageDialog="ManageDialog",e.BookmarkAccessDialog="BookmarkAccessDialog",e.GroupRestrictionDialog="GroupRestrictionDialog",e.PremiumContentDialog="PremiumContentDialog",e.AboutDialog="AboutDialog",e.ImportDialog="ImportDialog",e.AddTeamModelDialog="AddTeamModelDialog",e.ImageDialog="ImageDialog",e.QuizSettingsDialog="QuizSettingsDialog",e}({}),yg=["imageView"],xg=((bg=function(){function e(t){m(this,e),this.dialog=t,this.fit="normal",this.fullscreenEnabled=!1}return v(e,[{key:"ngOnInit",value:function(){}},{key:"handleFullscreen",value:function(e){this.dialog.open(vg,{id:mg.ImageDialog,backdropClass:"bd-dialog-backdrop",panelClass:"bd-dialog-panel",disableClose:!1,data:{src:this.fullscreenSrc||this.src,alt:this.alt||""}}),e.stopPropagation()}}]),e}()).\u0275fac=function(e){return new(e||bg)(_.Pb(Xd.b))},bg.\u0275cmp=_.Jb({type:bg,selectors:[["app-image-view"]],viewQuery:function(e,t){var n;1&e&&_.Gc(yg,!0),2&e&&_.uc(n=_.dc())&&(t.imageView=n.first)},inputs:{fit:"fit",fitSize:"fitSize",src:"src",fullscreenSrc:"fullscreenSrc",alt:"alt"},decls:5,vars:8,consts:[[1,"image-view"],["imageView",""],[1,"image-view__image",3,"src","alt"],["role","button","matTooltip","Expand",1,"image-view__overlay",3,"click"],["icon","expand-alt",1,"image-view__icon"]],template:function(e,t){1&e&&(_.Vb(0,"div",0,1),_.Qb(2,"img",2),_.Vb(3,"div",3),_.cc("click",(function(e){return t.handleFullscreen(e)})),_.Qb(4,"app-icon",4),_.Ub(),_.Ub()),2&e&&(_.Hb("image-view--auto-fit","auto"===t.fit),_.Db(2),_.Hc("max-width","auto"===t.fit&&t.fitSize?t.fitSize+"px":"100%")("max-height","auto"===t.fit&&t.fitSize?t.fitSize+"px":"100%"),_.lc("src",t.src,_.Cc)("alt",t.alt))},directives:[rg.c,Js],styles:[".image-view[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:inherit;position:relative;background-color:#f9fafd}.image-view__image[_ngcontent-%COMP%]{width:auto;height:auto}.image-view--auto-fit[_ngcontent-%COMP%]   .image-view__image[_ngcontent-%COMP%]{max-width:100%;height:auto}.image-view__overlay[_ngcontent-%COMP%]{background:rgba(28,42,63,.3);color:#fff;display:flex;flex-direction:row;align-items:center;justify-content:center;padding:8px;position:absolute;top:0;bottom:0;left:0;right:0;opacity:0;transition:opacity .25s}.image-view__icon[_ngcontent-%COMP%]{text-shadow:0 0 2px rgba(0,0,0,.6)}.image-view[_ngcontent-%COMP%]:hover{cursor:pointer}.image-view[_ngcontent-%COMP%]:hover   .image-view__overlay[_ngcontent-%COMP%]{opacity:1}"],changeDetection:0}),bg);function wg(e,t){if(1&e&&(_.Vb(0,"div",6),_.Qb(1,"app-image-view",7),_.Ub()),2&e){var n=_.gc(2);_.Db(1),_.lc("src",n.currentImage.urls.small)("fullscreenSrc",n.currentImage.urls.default)("alt",n.currentImage.alt)("fit",n.fit)("fitSize",n.fitSize)}}function kg(e,t){if(1&e&&_.Qb(0,"app-html",8),2&e){var n=_.gc(2);_.lc("markdownText",n.currentImage.caption)}}function Og(e,t){if(1&e){var n=_.Wb();_.Vb(0,"div",9),_.Vb(1,"button",10),_.cc("click",(function(){return _.zc(n),_.gc(2).handlePrevClick()})),_.Ub(),_.Vb(2,"button",11),_.cc("click",(function(){return _.zc(n),_.gc(2).handleNextClick()})),_.Ub(),_.Ub()}}function Cg(e,t){if(1&e&&(_.Vb(0,"div",1),_.Vb(1,"div",2),_.Kc(2,wg,2,5,"div",3),_.Kc(3,kg,1,1,"app-html",4),_.Kc(4,Og,3,0,"div",5),_.Ub(),_.Ub()),2&e){var n=_.gc();_.Hb("images-block--slideshow",n.images&&n.images.length>1),_.Db(2),_.lc("ngIf",n.currentImage.urls),_.Db(1),_.lc("ngIf",n.currentImage.caption),_.Db(1),_.lc("ngIf",n.images.length>1)}}var Sg,_g=((Sg=function(){function e(){m(this,e),this.layout=Td.Normal}return v(e,[{key:"imagesBlock",get:function(){return this._imagesBlock},set:function(e){this._imagesBlock=e;var t=Object(Oe.get)(e,"images",[]);t.length&&(this.images=t,this.currentImage=this.images[0])}},{key:"fit",get:function(){return"compact"===this.layout?"auto":"normal"}},{key:"fitSize",get:function(){return"compact"===this.layout?100:void 0}},{key:"ngOnInit",value:function(){}},{key:"handlePrevClick",value:function(){var e=this.getCurrentImageIndex();--e<0&&(e=this.images.length-1),this.currentImage=this.images[e]}},{key:"handleNextClick",value:function(){var e=this.getCurrentImageIndex();++e>=this.images.length&&(e=0),this.currentImage=this.images[e]}},{key:"getCurrentImageIndex",value:function(){return this.images.indexOf(this.currentImage)}}]),e}()).\u0275fac=function(e){return new(e||Sg)},Sg.\u0275cmp=_.Jb({type:Sg,selectors:[["app-images-block"]],inputs:{imagesBlock:"imagesBlock",layout:"layout"},decls:1,vars:1,consts:[["class","images-block",3,"images-block--slideshow",4,"ngIf"],[1,"images-block"],[1,"images-block__content"],["class","images-block__image-container",4,"ngIf"],["class","images-block__caption",3,"markdownText",4,"ngIf"],["class","images-block__actions",4,"ngIf"],[1,"images-block__image-container"],[1,"images-block__image-view",3,"src","fullscreenSrc","alt","fit","fitSize"],[1,"images-block__caption",3,"markdownText"],[1,"images-block__actions"],["gaEvent","","gaAction","Clicked Previous Image","app-pin-button","","icon","chevron-left","size","small","buttonType","ghost","matTooltip","Previous Image",3,"click"],["gaEvent","","gaAction","Clicked Next Image","app-pin-button","","icon","chevron-right","size","small","buttonType","ghost","matTooltip","Next Image",3,"click"]],template:function(e,t){1&e&&_.Kc(0,Cg,5,5,"div",0),2&e&&_.lc("ngIf",t.currentImage)},directives:[or.l,xg,Zd,ag,rg.c],styles:[".images-block__header{display:flex;align-items:center;justify-content:space-between;margin-bottom:16px}.images-block__label{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase;color:var(--view-panel-color);font-weight:600;display:flex;align-items:center;min-height:28px}.images-block__image-container{display:flex;justify-content:center;background-color:#f9fafd;margin-bottom:12px}.images-block__image-view{display:flex;height:100%}.images-block__caption{font-size:12px}.images-block__actions{display:flex;justify-content:flex-end;margin-top:14px}.images-block--slideshow .images-block__image-container{height:200px}"],encapsulation:2,changeDetection:0}),Sg);function jg(e,t){if(1&e&&_.Qb(0,"app-ticker-block",6),2&e){var n=_.gc().$implicit;_.lc("tickerBlock",n)}}function Pg(e,t){if(1&e&&_.Qb(0,"app-markdown-block",7),2&e){var n=_.gc().$implicit,i=_.gc(2);_.lc("markdownBlock",n)("layout",i.layout)}}function Mg(e,t){if(1&e&&_.Qb(0,"app-images-block",8),2&e){var n=_.gc().$implicit,i=_.gc(2);_.lc("imagesBlock",n)("layout",i.layout)}}function Ig(e,t){if(1&e&&(_.Vb(0,"div"),_.Tb(1,2),_.Kc(2,jg,1,1,"app-ticker-block",3),_.Kc(3,Pg,1,2,"app-markdown-block",4),_.Kc(4,Mg,1,2,"app-images-block",5),_.Sb(),_.Ub()),2&e){var n=t.$implicit;_.Hb("mv-2",t.index>0),_.Db(1),_.lc("ngSwitch",n.type),_.Db(1),_.lc("ngSwitchCase","ticker"),_.Db(1),_.lc("ngSwitchCase","markdown"),_.Db(1),_.lc("ngSwitchCase","images")}}function zg(e,t){if(1&e&&(_.Tb(0),_.Kc(1,Ig,5,6,"div",1),_.Sb()),2&e){var n=_.gc();_.Db(1),_.lc("ngForOf",n.contentBlocks)}}var Tg,Ug=((Tg=function(){function e(){m(this,e),this._contentBlocks=[],this.layout=Td.Normal,this.include=[],this.exclude=[]}return v(e,[{key:"contentBlocks",get:function(){var e=this;return this._contentBlocks.filter((function(t){return!e.include.length||e.include.includes(t.type)})).filter((function(t){return!e.exclude.length||!e.exclude.includes(t.type)}))},set:function(e){this._contentBlocks=e}},{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||Tg)},Tg.\u0275cmp=_.Jb({type:Tg,selectors:[["app-content-blocks"]],inputs:{contentBlocks:"contentBlocks",layout:"layout",include:"include",exclude:"exclude"},decls:1,vars:1,consts:[[4,"ngIf"],[3,"mv-2",4,"ngFor","ngForOf"],[3,"ngSwitch"],[3,"tickerBlock",4,"ngSwitchCase"],[3,"markdownBlock","layout",4,"ngSwitchCase"],[3,"imagesBlock","layout",4,"ngSwitchCase"],[3,"tickerBlock"],[3,"markdownBlock","layout"],[3,"imagesBlock","layout"]],template:function(e,t){1&e&&_.Kc(0,zg,2,1,"ng-container",0),2&e&&_.lc("ngIf",t.contentBlocks.length>0)},directives:[or.l,or.k,or.n,or.o,Gd,Jd,_g],styles:[""],encapsulation:2,changeDetection:0}),Tg),Lg=function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r},Dg=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function Eg(e,t){if(1&e&&(_.Vb(0,"div",6),_.Qb(1,"app-content-blocks",7),_.Ub()),2&e){var n=_.gc();_.Db(1),_.lc("contentBlocks",n.label.contentBlocks)("layout","compact")}}function Fg(e,t){if(1&e&&(_.Qb(0,"div",8),_.hc(1,"markdown")),2&e){var n=_.gc();_.lc("innerHTML",_.ic(1,1,n.label.description),_.Ac)}}var Ag,Rg,Ng,Vg=((Ag=function(){function e(t,n,i,o){m(this,e),this.store=t,this.labelsService=n,this.engineService=i,this.changeDetectorRef=o,this.emitEvents=!0,this.collapsedMode=Eo.None,this.collapsed=!1,this.pinDraggable=!1,this.tagDraggable=!1,this.descriptionCollapsed=!1,this.tagCollapsed=!1,this.ngUnsubscribe=new ge.a}return v(e,[{key:"isCollapsed",get:function(){if(this.collapsedMode===Eo.Toggle){var e=this.store.selectSnapshot(Pc.getSelectedLabelId)===this.label.id;return this.collapsed&&!e}return this.collapsed}},{key:"hasContent",get:function(){return this.labelsService.hasContent(this.label)}},{key:"ngOnInit",value:function(){var e=this;this.selectedLabel$.pipe(Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){return e.handleLabelSelected(t)})),this.store.select(Pc.getChapterLabels).pipe(Object(fe.a)(this.ngUnsubscribe),Object(Za.a)(100)).subscribe((function(){e.sequence=e.store.selectSnapshot(Pc.getLabelSequence(e.label)),e.changeDetectorRef.markForCheck()})),this.descriptionCollapsed=this.label.collapseDescription,this.tagCollapsed=this.label.hideTag}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"handleLabelUpdated",value:function(e){var t=e.label,n=e.shouldPreserve;this.store.dispatch(new Wo(t,n))}},{key:"handleOffsetUpdated",value:function(e){var t=e.labelId,n=e.offset;this.store.dispatch(new Ao(t,n))}},{key:"handlePinClicked",value:function(e){this.selectLabel()}},{key:"handleTagClicked",value:function(e){this.selectLabel()}},{key:"selectLabel",value:function(){var e=this.store.selectSnapshot(Pc.getSelectedLabel);this.store.dispatch(new Go(e&&e.id===this.label.id?null:this.label)),this.emitEngineEvent(Lt.HotspotsPicked,{id:this.label.id}),this.emitEngineEvent(Lt.LabelsPicked,{labelId:this.label.id})}},{key:"emitEngineEvent",value:function(e,t){this.emitEvents&&this.engineService.fireEvent(e,t)}},{key:"handleDisplayUpdated",value:function(e){this.emitEngineEvent(Lt.HotspotsDisplayUpdated,e)}},{key:"handlePositionUpdated",value:function(e){this.emitEngineEvent(Lt.HotspotsPositionUpdated,e.positionUpdate),this.emitEngineEvent(Lt.LabelsMoved,{labelId:e.positionUpdate.id,canvasPosition:[e.positionUpdate.canvasPos.x,e.positionUpdate.canvasPos.y],occluded:e.positionUpdate.occluded||!e.onCanvas})}},{key:"handleHoverStart",value:function(e){this.emitEngineEvent(Lt.HotspotsEntered,{id:e.labelId}),this.emitEngineEvent(Lt.LabelsEntered,{labelId:e.labelId})}},{key:"handleHoverEnd",value:function(e){this.emitEngineEvent(Lt.HotspotsLeft,{id:e.labelId}),this.emitEngineEvent(Lt.LabelsLeft,{labelId:e.labelId})}},{key:"handleLabelSelected",value:function(e){var t=this,n=e&&e.id===this.label.id,i=Object(Oe.get)(e,"states[1].errands"),o=this.store.selectSnapshot(Fa.getLockCamera);n&&i&&!o&&i.forEach((function(e){switch(e.type){case fi.flyToObject:t.store.dispatch(new He(e.value));break;case fi.flyToCamera:t.store.dispatch(new Wt(e.value))}t.store.dispatch(new rn(!0))})),this.tagCollapsed=!(this.label.title||this.hasContent)||(this.label.expandTag&&this.label.hideTag?!n:this.label.hideTag),this.descriptionCollapsed=this.label.showDescription&&this.label.collapseDescription?!n:this.label.collapseDescription}}]),e}()).\u0275fac=function(e){return new(e||Ag)(_.Pb(L.g),_.Pb(wi),_.Pb(Nt),_.Pb(_.i))},Ag.\u0275cmp=_.Jb({type:Ag,selectors:[["app-story-label"]],inputs:{label:"label",emitEvents:"emitEvents",collapsedMode:"collapsedMode",collapsed:"collapsed",pinDraggable:"pinDraggable",tagDraggable:"tagDraggable"},decls:9,vars:18,consts:[[3,"label","selected","scale","sequence","isCollapsed","tagCollapsed","pinDraggable","tagDraggable","descriptionCollapsed","hasContent","labelUpdated","offsetUpdated","tagClicked","pinClicked","displayUpdated","positionUpdated","hoverStart","hoverEnd"],["label-header","",1,"html",3,"innerHTML"],["title",""],["label-body","",1,"html"],["class","mv-1","appEventFence","",4,"ngIf"],["data-test","labelDescription",3,"innerHTML",4,"ngIf"],["appEventFence","",1,"mv-1"],[3,"contentBlocks","layout"],["data-test","labelDescription",3,"innerHTML"]],template:function(e,t){var n;(1&e&&(_.Vb(0,"app-generic-label",0),_.cc("labelUpdated",(function(e){return t.handleLabelUpdated(e)}))("offsetUpdated",(function(e){return t.handleOffsetUpdated(e)}))("tagClicked",(function(e){return t.handleTagClicked(e)}))("pinClicked",(function(e){return t.handlePinClicked(e)}))("displayUpdated",(function(e){return t.handleDisplayUpdated(e)}))("positionUpdated",(function(e){return t.handlePositionUpdated(e)}))("hoverStart",(function(e){return t.handleHoverStart(e)}))("hoverEnd",(function(e){return t.handleHoverEnd(e)})),_.hc(1,"async"),_.hc(2,"async"),_.Qb(3,"div",1,2),_.hc(5,"markdown"),_.Vb(6,"div",3),_.Kc(7,Eg,2,2,"div",4),_.Kc(8,Fg,2,3,"div",5),_.Ub(),_.Ub()),2&e)&&(_.lc("label",t.label)("selected",(null==(n=_.ic(1,12,t.selectedLabel$))?null:n.id)===t.label.id)("scale",_.ic(2,14,t.labelScale$))("sequence",t.sequence)("isCollapsed",t.isCollapsed)("tagCollapsed",t.tagCollapsed)("pinDraggable",t.tagDraggable)("descriptionCollapsed",t.descriptionCollapsed)("hasContent",t.hasContent),_.Db(3),_.lc("innerHTML",_.ic(5,16,t.label.title),_.Ac),_.Db(4),_.lc("ngIf",t.label.contentBlocks),_.Db(1),_.lc("ngIf",t.label.description))},directives:[kd,or.l,Zs,Ug],pipes:[or.b,Od.b],styles:[""],changeDetection:0}),Lg([Object(L.d)(Pc.getLabelScale),Dg("design:type",he.a)],Ag.prototype,"labelScale$",void 0),Lg([Object(L.d)(Pc.getSelectedLabel),Dg("design:type",he.a)],Ag.prototype,"selectedLabel$",void 0),Ag),Hg=h("3Pt+"),Bg=((Ng=function(){function e(t){m(this,e),this.controlContainer=t}return v(e,[{key:"control",get:function(){return this.formControl||this.controlContainer.control.get(this.formControlName)}},{key:"registerOnTouched",value:function(e){this.formControlDirective.valueAccessor.registerOnTouched(e)}},{key:"registerOnChange",value:function(e){this.formControlDirective.valueAccessor.registerOnChange(e)}},{key:"writeValue",value:function(e){this.formControlDirective.valueAccessor.writeValue(e)}},{key:"setDisabledState",value:function(e){this.formControlDirective.valueAccessor.setDisabledState(e)}}]),e}()).\u0275fac=function(e){return new(e||Ng)(_.Pb(Hg.b))},Ng.\u0275cmp=_.Jb({type:Ng,selectors:[["app-base-accessor-control"]],viewQuery:function(e,t){var n;1&e&&_.Gc(Hg.f,!0),2&e&&_.uc(n=_.dc())&&(t.formControlDirective=n.first)},inputs:{formControl:"formControl",formControlName:"formControlName"},decls:0,vars:0,template:function(e,t){},encapsulation:2}),Ng),Qg=((Rg=function(){function e(){m(this,e)}return v(e,[{key:"value",get:function(){return this._value},set:function(e){Object(Oe.isEqual)(this._value,e)||(this._value=e,this.setFormValues(e),this.onChange(e))}},{key:"onChange",value:function(e){}},{key:"onTouched",value:function(){}},{key:"registerOnTouched",value:function(e){this.onTouched=e}},{key:"registerOnChange",value:function(e){this.onChange=e}},{key:"writeValue",value:function(e){this.value=e}},{key:"setDisabledState",value:function(e){this.disabled=e}}]),e}()).\u0275fac=function(e){return new(e||Rg)},Rg.\u0275cmp=_.Jb({type:Rg,selectors:[["app-abstract-input-control"]],inputs:{value:"value",disabled:"disabled"},decls:0,vars:0,template:function(e,t){},encapsulation:2}),Rg);function qg(e,t){if(1&e&&(_.Vb(0,"option",9),_.Mc(1),_.Ub()),2&e){var n=t.$implicit;_.lc("value",n.value),_.Db(1),_.Oc(" ",n.label.title," ")}}function Wg(e,t){if(1&e&&(_.Vb(0,"select",6),_.Vb(1,"option",7),_.Mc(2,"Select"),_.Ub(),_.Kc(3,qg,2,2,"option",8),_.Ub()),2&e){var n=_.gc();_.Db(3),_.lc("ngForOf",n.options)}}var $g,Kg=(($g=function(n){t(a,n);var o=i(a);function a(e,t){var n;return m(this,a),(n=o.call(this)).formBuilder=e,n.changeRef=t,n.outline=!0,n.valueChange=new _.p,n.ngUnsubscribe=new ge.a,n.form=n.formBuilder.group({value:[""]}),n.valueControl=n.form.get("value"),n}return v(a,[{key:"options",get:function(){return this._options},set:function(e){var t=Object(Oe.clone)(e);this._options=t.sort((function(e,t){return e.label.title.localeCompare(t.label.title)})),this.changeRef.markForCheck()}},{key:"ngOnInit",value:function(){this.initFormListeners()}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"initFormListeners",value:function(){var e=this;this.form.valueChanges.pipe(Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){var n=t.value;e.writeValue(n),e.valueChange.next(n)}))}},{key:"setDisabledState",value:function(t){e(r(a.prototype),"setDisabledState",this).call(this,t),t?this.form.disable():this.form.enable(),this.changeRef.markForCheck()}},{key:"setFormValues",value:function(e){this.valueControl.setValue(e),this.changeRef.markForCheck()}},{key:"getSelectedOption",value:function(){var e=this.valueControl.value;return this.options.find((function(t){return t.value===e}))}}]),a}(Qg)).\u0275fac=function(e){return new(e||$g)(_.Pb(Hg.d),_.Pb(_.i))},$g.\u0275cmp=_.Jb({type:$g,selectors:[["app-quiz-label-anatomy-select"]],inputs:{options:"options",outline:"outline"},outputs:{valueChange:"valueChange"},features:[_.Cb([{provide:Hg.k,useExisting:Object(_.W)((function(){return $g})),multi:!0}]),_.Ab],decls:7,vars:5,consts:[[1,"label",3,"formGroup"],[1,"label__select-label","flex","text-12"],[1,"flex","justify-between","p-2",2,"flex","1"],[1,"mr-2"],["icon","caret-down","size","lg"],["class","input label__select","placeholder","Select Option","formControlName","value","data-test","quizLabelSelect",4,"ngIf"],["placeholder","Select Option","formControlName","value","data-test","quizLabelSelect",1,"input","label__select"],["value","","data-test","questionAnswerOption"],["class","label__option","data-test","questionAnswerOption",3,"value",4,"ngFor","ngForOf"],["data-test","questionAnswerOption",1,"label__option",3,"value"]],template:function(e,t){var n;(1&e&&(_.Vb(0,"div",0),_.Vb(1,"label",1),_.Vb(2,"div",2),_.Vb(3,"div",3),_.Mc(4),_.Ub(),_.Qb(5,"app-icon",4),_.Ub(),_.Kc(6,Wg,4,1,"select",5),_.Ub(),_.Ub()),2&e)&&(_.Hb("label--empty",""===t.valueControl.value),_.lc("formGroup",t.form),_.Db(4),_.Nc((null==(n=t.getSelectedOption())||null==n.label?null:n.label.title)||"Select"),_.Db(2),_.lc("ngIf",!t.disabled))},directives:[Hg.n,Hg.h,Js,or.l,Hg.r,Hg.m,Hg.g,Hg.p,Hg.s,or.k],styles:[".label[_ngcontent-%COMP%]{overflow:hidden}.label__select-label[_ngcontent-%COMP%]{color:#101823;position:relative}.label__select[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;opacity:.01}.label--empty[_ngcontent-%COMP%]   .label__select-label[_ngcontent-%COMP%]{color:#96a8c0}"],changeDetection:0}),$g);function Gg(e,t){1&e&&_.Qb(0,"app-icon",8)}function Zg(e,t){1&e&&_.Qb(0,"app-icon",9)}function Jg(e,t){if(1&e&&(_.Vb(0,"div",4),_.Kc(1,Gg,1,0,"app-icon",5),_.Kc(2,Zg,1,0,"app-icon",6),_.Vb(3,"div",7),_.Mc(4),_.Ub(),_.Ub()),2&e){var n,i=_.gc();_.lc("ngSwitch",i.correct),_.Db(1),_.lc("ngSwitchCase",!0),_.Db(1),_.lc("ngSwitchCase",!1),_.Db(2),_.Oc(" ",null==(n=i.getSelectedLabel(i.options,i.control.value))?null:n.title," ")}}var Xg,Yg=((Xg=function(e){t(o,e);var n=i(o);function o(){var e;return m(this,o),(e=n.apply(this,arguments)).sequence=0,e.labelUpdated=new _.p,e}return v(o,[{key:"ngOnInit",value:function(){}},{key:"handleLabelUpdated",value:function(e){this.labelUpdated.next(e.label)}},{key:"handleOffsetUpdated",value:function(e){this.labelUpdated.next(Object.assign(Object.assign({},this.option.label),{offset:e.offset}))}},{key:"getSelectedLabel",value:function(e,t){var n=this.options.find((function(e){return e.value===t}));return n?n.label:void 0}}]),o}(Bg)).\u0275fac=function(e){return eh(e||Xg)},Xg.\u0275cmp=_.Jb({type:Xg,selectors:[["app-quiz-label"]],inputs:{sequence:"sequence",collapsed:"collapsed",options:"options",option:"option",correct:"correct",mode:"mode"},outputs:{labelUpdated:"labelUpdated"},features:[_.Cb([{provide:Hg.k,useExisting:Object(_.W)((function(){return Xg})),multi:!0}]),_.Ab],decls:4,vars:14,consts:[[1,"label","theme-light",3,"label","fit","opaque","pinDraggable","tagDraggable","isCollapsed","descriptionCollapsed","hasContent","sequence","labelUpdated","offsetUpdated"],["label-body","",1,"label__body"],[3,"outline","hidden","options","formControl"],["class","label__summary flex items-start",3,"ngSwitch",4,"ngIf"],[1,"label__summary","flex","items-start",3,"ngSwitch"],["class","label__icon label__icon--correct","style","font-size: 16px","icon","check-circle",4,"ngSwitchCase"],["class","label__icon label__icon--incorrect","style","font-size: 16px","icon","times-circle",4,"ngSwitchCase"],[1,"pl-2","text-12","text-semibold"],["icon","check-circle",1,"label__icon","label__icon--correct",2,"font-size","16px"],["icon","times-circle",1,"label__icon","label__icon--incorrect",2,"font-size","16px"]],template:function(e,t){1&e&&(_.Vb(0,"app-generic-label",0),_.cc("labelUpdated",(function(e){return t.handleLabelUpdated(e)}))("offsetUpdated",(function(e){return t.handleOffsetUpdated(e)})),_.Vb(1,"div",1),_.Qb(2,"app-quiz-label-anatomy-select",2),_.Kc(3,Jg,5,4,"div",3),_.Ub(),_.Ub()),2&e&&(_.lc("label",t.option.label)("fit","summary"===t.mode?"fixed":"auto")("opaque",!0)("pinDraggable","edit"===t.mode)("tagDraggable","edit"===t.mode)("isCollapsed",t.collapsed)("descriptionCollapsed",!1)("hasContent",!0)("sequence",t.sequence),_.Db(2),_.lc("outline",!1)("hidden","summary"===t.mode)("options",t.options)("formControl",t.control),_.Db(1),_.lc("ngIf","summary"===t.mode))},directives:[kd,Kg,Hg.m,Hg.f,or.l,or.n,or.o,Js],styles:[".label__body[_ngcontent-%COMP%]{color:#101823;min-width:160px;max-width:200px}.label__icon[_ngcontent-%COMP%]{position:relative;flex:0 0 20px;justify-content:center}.label__icon--correct[_ngcontent-%COMP%]{color:#73b676}.label__icon--incorrect[_ngcontent-%COMP%]{color:#cb4039}"],changeDetection:0}),Xg),eh=_.Xb(Yg),th=function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r},nh=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function ih(e,t){if(1&e){var n=_.Wb();_.Tb(0),_.Vb(1,"app-quiz-label",3),_.cc("labelUpdated",(function(e){_.zc(n);var i=t.index;return _.gc().handleLabelUpdated(e,i)})),_.hc(2,"async"),_.hc(3,"async"),_.hc(4,"async"),_.hc(5,"async"),_.Ub(),_.Sb()}if(2&e){var i=t.$implicit,o=t.index,a=_.gc();_.Db(1),_.lc("mode",a.mode)("formControl",i)("option",_.ic(2,7,a.quizLabels$)[o])("options",_.ic(3,9,a.quizLabels$))("sequence",o+1)("correct",a.isCorrect(_.ic(4,11,a.quizLabels$)[o],a.activeSubmitted,o))("collapsed",_.ic(5,13,a.labelsCollapsed$))}}var oh,ah=((oh=function(){function e(t,n,i,o){m(this,e),this.store=t,this.formBuilder=n,this.changeRef=i,this.router=o,this.ngUnsubscribe=new ge.a,this.mode="edit",this.form=this.formBuilder.group({options:this.formBuilder.array([])}),this.optionsArray=this.form.get("options")}return v(e,[{key:"ngOnInit",value:function(){this.initFormListeners(),this.initQuizSubmissionListeners()}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"initFormListeners",value:function(){var e=this;this.quizLabels$.pipe(Object(Ja.a)((function(e,t){var n=e.map((function(e){return e.value})),i=t.map((function(e){return e.value}));return Object(Oe.isEqual)(n,i)})),Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){var n=e.store.selectSnapshot(So.getQuizModeActive);e.buildFormOptions(t,n),e.changeRef.markForCheck()})),Object(Ka.b)([this.quizModeActive$,this.quizLabels$]).pipe(Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){var n=u(t,1)[0];e.setFormEnabled(n),e.changeRef.markForCheck()}))}},{key:"initQuizSubmissionListeners",value:function(){var e=this;this.activeSubmission$.pipe(Object(be.a)((function(e){return!Object(Oe.isNil)(e)&&!Object(Oe.isNil)(e.answer)&&Array.isArray(e.answer)})),Object(Ja.a)((function(e,t){return Object(Oe.isEqual)(e,t)})),Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){var n=e.form.value.options,i=t.answer;Object(Oe.isEqual)(n,i)||(e.form.patchValue({options:i},{emitEvent:!1,onlySelf:!0}),e.changeRef.markForCheck())})),this.form.valueChanges.pipe(Object(Ja.a)((function(e,t){return Object(Oe.isEqual)(e,t)})),Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){var n=e.store.selectSnapshot(So.getActiveQuestionId),i=e.store.selectSnapshot(So.getActiveSubmission),o=Object(Oe.isNil)(i)?[]:i.answer,a=t.options;e.store.selectSnapshot(So.getAllSubmissions).some((function(e){return e.questionId===n}))||(Object(Oe.isEqual)(a,o)||e.store.dispatch(new no.SetActiveSubmission({questionId:n,answer:a})),e.changeRef.markForCheck())})),Object(Ka.b)([this.quizModeActive$,this.allSubmissions$]).subscribe((function(t){var n=u(t,2),i=n[0],o=n[1],a=e.store.selectSnapshot(So.getActiveQuestionId);e.activeSubmitted=o.find((function(e){return e.questionId===a}));var r=e.router.url.includes("/edit");e.mode=r?"edit":i&&!Object(Oe.isNil)(e.activeSubmitted)?"summary":"view",e.changeRef.markForCheck()}))}},{key:"isCorrect",value:function(e,t,n){if(!Object(Oe.isNil)(t))return t.answer[n]===e.value}},{key:"handleLabelUpdated",value:function(e,t){var n=this.store.selectSnapshot(So.getActiveQuestion);n.data.options[t].label=e,this.store.dispatch(new no.SetQuestion(n))}},{key:"buildFormOptions",value:function(e,t){var n=this;this.optionsArray.clear(),e.forEach((function(e){n.optionsArray.push(n.formBuilder.control(t?"":e.value))}))}},{key:"setFormEnabled",value:function(e){e?this.optionsArray.enable():this.optionsArray.disable()}}]),e}()).\u0275fac=function(e){return new(e||oh)(_.Pb(L.g),_.Pb(Hg.d),_.Pb(_.i),_.Pb(we.e))},oh.\u0275cmp=_.Jb({type:oh,selectors:[["app-quiz-labels"]],decls:3,vars:2,consts:[["data-test","quizLabelsElement",3,"formGroup"],["formArrayName","options"],[4,"ngFor","ngForOf"],["data-test","appQuizLabel",3,"mode","formControl","option","options","sequence","correct","collapsed","labelUpdated"]],template:function(e,t){1&e&&(_.Vb(0,"div",0),_.Vb(1,"div",1),_.Kc(2,ih,6,15,"ng-container",2),_.Ub(),_.Ub()),2&e&&(_.lc("formGroup",t.form),_.Db(2),_.lc("ngForOf",t.optionsArray.controls))},directives:[Hg.n,Hg.h,Hg.c,or.k,Yg,Hg.m,Hg.f],pipes:[or.b],styles:[""],changeDetection:0}),th([Object(L.d)(Pc.getLabelsCollapsed),nh("design:type",he.a)],oh.prototype,"labelsCollapsed$",void 0),th([Object(L.d)(So.getActiveQuestionLabels),nh("design:type",he.a)],oh.prototype,"quizLabels$",void 0),th([Object(L.d)(So.getQuizModeActive),nh("design:type",he.a)],oh.prototype,"quizModeActive$",void 0),th([Object(L.d)(So.getAllSubmissions),nh("design:type",he.a)],oh.prototype,"allSubmissions$",void 0),th([Object(L.d)(So.getActiveSubmission),nh("design:type",he.a)],oh.prototype,"activeSubmission$",void 0),oh),rh=function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r},ch=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function sh(e,t){if(1&e&&(_.Qb(0,"app-context-label",5),_.hc(1,"async"),_.hc(2,"async"),_.hc(3,"async"),_.hc(4,"async"),_.hc(5,"async")),2&e){var n=_.gc(3),i=null,o=null;_.lc("label",_.ic(1,3,n.contextLabel$))("enableInfo",_.ic(2,5,n.enableContextLabelInfo$)&&(null==(i=_.ic(3,7,n.layout$))?null:i.nodeInfo.enable))("enableActions",_.ic(4,9,n.enableContextLabelActions$)&&(null==(o=_.ic(5,11,n.layout$))?null:o.contextActions.enable))}}function lh(e,t){if(1&e&&(_.Tb(0),_.Qb(1,"app-story-label",6),_.hc(2,"async"),_.hc(3,"async"),_.hc(4,"async"),_.hc(5,"async"),_.Sb()),2&e){var n,i,o=t.$implicit,a=_.gc(3);_.Db(1),_.Hb("labels__label--hidden",!o.shown),_.lc("pinDraggable",null==(n=_.ic(2,7,a.draggable$))?null:n.pin)("tagDraggable",null==(i=_.ic(3,9,a.draggable$))?null:i.tag)("label",o)("collapsed",_.ic(4,11,a.labelsCollapsed$))("collapsedMode",_.ic(5,13,a.labelsCollapsedMode$))}}function ph(e,t){if(1&e&&(_.Tb(0),_.Kc(1,sh,6,13,"app-context-label",3),_.hc(2,"async"),_.hc(3,"async"),_.Kc(4,lh,6,15,"ng-container",4),_.hc(5,"async"),_.Sb()),2&e){var n=_.gc(2);_.Db(1),_.lc("ngIf",_.ic(2,3,n.enableContextLabel$)&&_.ic(3,5,n.contextLabel$)),_.Db(3),_.lc("ngForOf",_.ic(5,7,n.labels$))("ngForTrackBy",n.trackLabel)}}function uh(e,t){1&e&&(_.Tb(0),_.Qb(1,"app-quiz-labels"),_.Sb())}function dh(e,t){if(1&e&&(_.Vb(0,"div",1),_.Kc(1,ph,6,9,"ng-container",2),_.hc(2,"async"),_.Kc(3,uh,2,0,"ng-container",2),_.Ub()),2&e){var n=_.gc();_.Db(1),_.lc("ngIf",_.ic(2,2,n.showLabels$)),_.Db(2),_.lc("ngIf",n.showQuizLabels)}}var gh,hh=((gh=function(){function e(t,n,i,o,a,r,c,s){m(this,e),this.store=t,this.action$=n,this.router=i,this.engineService=o,this.cameraService=a,this.changeDetector=r,this.labelsService=c,this.elRef=s,this.interactive=!1,this.showQuizLabels=!1,this.ngUnsubscribe=new ge.a}return v(e,[{key:"ngOnInit",value:function(){this.bindEngineEvents(),this.bindApplicationEvents(),this.labelsService.setLabelContainer(this.elRef)}},{key:"ngOnDestroy",value:function(){this.labelsService.setLabelContainer(null),this.changeDetector.detach(),this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"bindApplicationEvents",value:function(){var e=this;this.action$.pipe(Object(L.j)(Ne),Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){e.handleClickNode(t)})),this.labels$.pipe(Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){e.changeDetector.markForCheck()})),this.selectedLabel$.pipe(Object(be.a)((function(e){return null==e})),Object(fe.a)(this.ngUnsubscribe)).subscribe((function(){var t=e.store.selectSnapshot(Fa.getZoomed),n=e.store.selectSnapshot(Fa.getLockCamera);t&&!n&&e.resetCamera()})),Object(Ka.b)([this.activeTool$,this.activeQuestion$]).pipe(Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){var n=u(t,2),i=n[0],o=n[1],a=e.router.url.indexOf("/edit")>=0,r=Object(Oe.get)(o,"type")===co.LabelAnatomy;e.showQuizLabels=a?i===Aa.Quiz&&r:r,e.changeDetector.markForCheck()})),this.store.select(Ua.getSelectedChapterReadyState).pipe(Object(be.a)((function(e){return null!=e})),Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){e.interactive=t.model,e.changeDetector.markForCheck()}))}},{key:"bindEngineEvents",value:function(){var e=this;this.action$.pipe(Object(L.j)(Ge,ea),Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){e.engineService.fireEvent(t.show?Lt.LabelsEnabled:Lt.LabelsDisabled,null)})),this.action$.pipe(Object(L.j)(No),Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){e.engineService.fireEvent(Lt.LabelsCreated,t.label)})),this.action$.pipe(Object(L.j)(Wo),Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){e.engineService.fireEvent(Lt.LabelsUpdated,t.label)})),this.action$.pipe(Object(L.j)(Yo),Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){t.labels.forEach((function(n){e.engineService.fireEvent(t.shown?Lt.LabelsShown:Lt.LabelsHidden,{labelId:n.id})}))})),this.action$.pipe(Object(L.j)(Bo),Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){e.engineService.fireEvent(Lt.LabelsDestroyed,t.label)}))}},{key:"handleClickNode",value:function(e){var t=this,n=this.store.selectSnapshot(qa.getActiveTool);null!=e.node?n===Aa.Label?this.addLabel(e.hit,e.node):setTimeout((function(){t.toggleContextLabel(e.hit,e.node)})):(this.store.dispatch(new Go(null)),this.store.dispatch(new Qo))}},{key:"addLabel",value:function(e,t){var n=this.cameraService.getDirection(e),i=this.getLabelDefaults(e.objectId),o=i.hideWire?20:32;i.title=t.label,i.offset=[o,0],i.objectId=e.objectId,i.barycentric=[e.barycentric[0],e.barycentric[1],e.barycentric[2]],i.pos=[e.worldPos[0],e.worldPos[1],e.worldPos[2]],i.primitiveIndex=e.primitiveIndex,i.renderableIndex=e.renderableIndex||0,i.dir=n,i.chapterId=this.store.selectSnapshot(Ua.getSelectedChapter).id,i.occludable=!0,i.shown=!0,this.store.dispatch(new No(i)),this.store.dispatch(new Go(i))}},{key:"toggleContextLabel",value:function(e,t){if(this.store.selectSnapshot(Fi.getCheckedNodeIds).some((function(e){return e===t.id}))){var n=this.cameraService.getDirection(e),i=this.labelsService.makeDefaultStudioLabel();i.theme=Xn.Context,i.title=t.label,i.offset=[32,0],i.objectId=e.objectId,i.barycentric=[e.barycentric[0],e.barycentric[1],e.barycentric[2]],i.pos=[e.worldPos[0],e.worldPos[1],e.worldPos[2]],i.primitiveIndex=e.primitiveIndex,i.dir=n,i.occludable=!1,this.store.dispatch(new Vo(i))}else this.store.dispatch(new Qo)}},{key:"getLabelDefaults",value:function(e){var t=this.store.selectSnapshot(Pc.getSelectedLabel);if(null==t){var n=this.store.selectSnapshot(Pc.getChapterLabels);n&&0!==n.length||(n=this.store.selectSnapshot(Pc.getLabels)),n.length&&(t=Object(Oe.cloneDeep)(n[n.length-1]))}if(null!=t){var i=this.labelsService.makeDefaultStudioLabel();switch(i.hideWire=t.hideWire,i.pinGlow=t.pinGlow,i.pinType=t.pinType,i.theme=t.theme,i.sequentialType=t.sequentialType,i.states[0].errands[0]=new yi,Object(Oe.get)(t,"states[1].errands[0].type")){case fi.flyToObject:case fi.flyToCamera:i.states[1].errands[0]=new bi(e)}return i}var o=this.labelsService.makeDefaultStudioLabel();return o.states[0].errands[0]=new yi,o.states[1].errands[0]=new bi(e),o}},{key:"trackLabel",value:function(e,t){var n=t.id,i=t.shown,o=t.theme;return"".concat(n).concat(i).concat(o)}},{key:"resetCamera",value:function(){var e=this.store.selectSnapshot(Ua.getSelectedChapter);Object(Oe.get)(e,"camera.location")&&this.store.dispatch(new Wt(e.camera.location))}}]),e}()).\u0275fac=function(e){return new(e||gh)(_.Pb(L.g),_.Pb(L.b),_.Pb(we.e),_.Pb(Nt),_.Pb(dn),_.Pb(_.i),_.Pb(wi),_.Pb(_.m))},gh.\u0275cmp=_.Jb({type:gh,selectors:[["app-labels"]],decls:1,vars:1,consts:[["class","labels","data-test","labelsElement",4,"ngIf"],["data-test","labelsElement",1,"labels"],[4,"ngIf"],[3,"label","enableInfo","enableActions",4,"ngIf"],[4,"ngFor","ngForOf","ngForTrackBy"],[3,"label","enableInfo","enableActions"],["data-test","appStoryLabel",1,"labels__label",3,"pinDraggable","tagDraggable","label","collapsed","collapsedMode"]],template:function(e,t){1&e&&_.Kc(0,dh,4,4,"div",0),2&e&&_.lc("ngIf",t.interactive)},directives:[or.l,or.k,zd,Vg,ah],pipes:[or.b],styles:["[_nghost-%COMP%]{position:relative}.labels[_ngcontent-%COMP%], [_nghost-%COMP%]{width:100%;height:100%;display:block}.labels[_ngcontent-%COMP%]{position:absolute;left:0;top:0;z-index:2;pointer-events:none}.labels__label--hidden[_ngcontent-%COMP%]{display:none}"],changeDetection:0}),rh([Object(L.d)(hp.getUI),ch("design:type",he.a)],gh.prototype,"layout$",void 0),rh([Object(L.d)(Pc.getChapterLabels),ch("design:type",he.a)],gh.prototype,"labels$",void 0),rh([Object(L.d)(So.getQuizModeActive),ch("design:type",he.a)],gh.prototype,"quizModeActive$",void 0),rh([Object(L.d)(qa.getActiveTool),ch("design:type",he.a)],gh.prototype,"activeTool$",void 0),rh([Object(L.d)(So.getActiveQuestion),ch("design:type",he.a)],gh.prototype,"activeQuestion$",void 0),rh([Object(L.d)(Ua.getSelectedChapter),ch("design:type",he.a)],gh.prototype,"selectedChapter$",void 0),rh([Object(L.d)(Pc.getSelectedLabel),ch("design:type",he.a)],gh.prototype,"selectedLabel$",void 0),rh([Object(L.d)(Pc.getLabelsCollapsed),ch("design:type",he.a)],gh.prototype,"labelsCollapsed$",void 0),rh([Object(L.d)(Pc.getLabelsCollapsedMode),ch("design:type",he.a)],gh.prototype,"labelsCollapsedMode$",void 0),rh([Object(L.d)(Pc.getContextLabel),ch("design:type",he.a)],gh.prototype,"contextLabel$",void 0),rh([Object(L.d)(qa.getShowLabels),ch("design:type",he.a)],gh.prototype,"showLabels$",void 0),rh([Object(L.d)(Fa.getZoomed),ch("design:type",he.a)],gh.prototype,"zoomed$",void 0),rh([Object(L.d)(Pc.getEnableContextLabel),ch("design:type",he.a)],gh.prototype,"enableContextLabel$",void 0),rh([Object(L.d)(Pc.getEnableContextLabelInfo),ch("design:type",he.a)],gh.prototype,"enableContextLabelInfo$",void 0),rh([Object(L.d)(Pc.getEnableContextLabelActions),ch("design:type",he.a)],gh.prototype,"enableContextLabelActions$",void 0),rh([Object(L.d)(Pc.getLabelsDraggable),ch("design:type",he.a)],gh.prototype,"draggable$",void 0),gh);function fh(e,t){if(1&e){var n=_.Wb();_.Vb(0,"div",1),_.cc("@show.done",(function(){return _.zc(n),_.gc().onShowDone()})),_.Vb(1,"div",2),_.Mc(2," Use control + scroll to zoom "),_.Ub(),_.Ub()}2&e&&_.lc("@show",void 0)}var bh,vh,mh,yh,xh,wh,kh,Oh=((bh=function(){function e(t,n){m(this,e),this.actions=t,this.changeDetectorRef=n,this.ngUnsubscribe=new ge.a,this.show=!1}return v(e,[{key:"ngOnInit",value:function(){var e=this;this.actions.pipe(Object(L.j)(ze),Object(fe.a)(this.ngUnsubscribe)).subscribe((function(){e.show=!0,e.changeDetectorRef.markForCheck()}))}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"onShowDone",value:function(){this.show=!1}}]),e}()).\u0275fac=function(e){return new(e||bh)(_.Pb(L.b),_.Pb(_.i))},bh.\u0275cmp=_.Jb({type:bh,selectors:[["app-engine-scroll"]],decls:1,vars:1,consts:[["class","engine-scroll","data-test","engineScroll",4,"ngIf"],["data-test","engineScroll",1,"engine-scroll"],[1,"engine-scroll__label"]],template:function(e,t){1&e&&_.Kc(0,fh,3,1,"div",0),2&e&&_.lc("ngIf",t.show)},directives:[or.l],styles:[".text-8[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase[_ngcontent-%COMP%]{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase[_ngcontent-%COMP%]{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase[_ngcontent-%COMP%]{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase[_ngcontent-%COMP%]{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-header[_ngcontent-%COMP%]{font-weight:700}.text--code[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.text-xlight[_ngcontent-%COMP%]{font-weight:200}.text-light[_ngcontent-%COMP%]{font-weight:300}.text-medium[_ngcontent-%COMP%]{font-weight:500}.text-semibold[_ngcontent-%COMP%]{font-weight:600}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-underline[_ngcontent-%COMP%]{text-decoration:underline}.text-italic[_ngcontent-%COMP%]{font-style:italic}.text-bright[_ngcontent-%COMP%]{color:#fff}.text-dim[_ngcontent-%COMP%]{color:#96a8c0}.text-error[_ngcontent-%COMP%]{color:#ed4758}.text-left[_ngcontent-%COMP%]{text-align:left}.text-center[_ngcontent-%COMP%]{text-align:center}.text-right[_ngcontent-%COMP%]{text-align:right}.text-ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link[_ngcontent-%COMP%], .text-link[_ngcontent-%COMP%]:visited{color:inherit;cursor:pointer}.text-link[_ngcontent-%COMP%]:not(.text-underline), .text-link[_ngcontent-%COMP%]:visited:not(.text-underline){text-decoration:none}.text-success[_ngcontent-%COMP%]{color:#38de38}.text-danger[_ngcontent-%COMP%]{color:#de3838}.text-info[_ngcontent-%COMP%]{color:#0060c4}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.text-pre-line[_ngcontent-%COMP%]{white-space:pre-line}.engine-scroll[_ngcontent-%COMP%]{display:flex;position:absolute;justify-content:center;align-items:center;top:0;bottom:0;left:0;right:0;z-index:10000;opacity:0;pointer-events:none}.engine-scroll__label[_ngcontent-%COMP%]{background:rgba(16,24,35,.5);font-size:16px;letter-spacing:.4px;line-height:1.4em;color:#fff;font-weight:600;padding:24px 32px;border-radius:40px}"],data:{animation:[Object(fp.n)("show",[Object(fp.m)(":enter",[Object(fp.j)([Object(fp.l)({opacity:"*"}),Object(fp.e)("500ms ease-in-out",Object(fp.l)({opacity:1})),Object(fp.e)("500ms 2000ms ease-in-out",Object(fp.l)({opacity:0}))])])])]},changeDetection:0}),bh),Ch=function(e,t){return{backgroundColor:e,duration:t}},Sh=function(e,t){return{value:e,params:t}},_h=Object(fp.g)([Object(fp.l)({opacity:"0",backgroundColor:"*"}),Object(fp.j)([Object(fp.e)("{{ duration }}ms {{ easing }}",Object(fp.l)({opacity:1,backgroundColor:"{{ backgroundColor }}"})),Object(fp.e)("250ms 500ms ease-in",Object(fp.l)({opacity:0}))])],{params:{duration:2e3,backgroundColor:"#ffffff",easing:"ease-out"}}),jh=((mh=function(){function e(t,n,i){m(this,e),this.actions=t,this.changeDetectorRef=n,this.store=i,this.color="#FFFFFF",this.duration=2e3,this.isVisible=!1,this.ngUnsubscribe=new ge.a}return v(e,[{key:"ngOnInit",value:function(){this.initFadeListener()}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"initFadeListener",value:function(){var e=this;this.actions.pipe(Object(L.j)(Ue),Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){e.fadeIn(t.color,t.duration)}))}},{key:"handleFadeComplete",value:function(){this.store.dispatch(new Le),this.isVisible=!1,this.changeDetectorRef.markForCheck()}},{key:"fadeIn",value:function(e,t){this.isVisible=!0,this.color=e,this.duration=1e3*t,this.changeDetectorRef.markForCheck()}}]),e}()).\u0275fac=function(e){return new(e||mh)(_.Pb(L.b),_.Pb(_.i),_.Pb(L.g))},mh.\u0275cmp=_.Jb({type:mh,selectors:[["app-engine-fade"]],decls:1,vars:7,consts:[[1,"engine-fade"]],template:function(e,t){1&e&&(_.Vb(0,"div",0),_.cc("@fade.done",(function(){return t.handleFadeComplete()})),_.Ub()),2&e&&_.lc("@fade",_.pc(4,Sh,t.isVisible,_.pc(1,Ch,t.color,t.duration)))},styles:[".engine-fade{pointer-events:none;display:block;position:absolute;left:0;right:0;top:0;bottom:0;z-index:10000}"],encapsulation:2,data:{animation:[Object(fp.n)("fade",[Object(fp.m)("* => true",Object(fp.o)(_h))])]},changeDetection:0}),mh),Ph=((vh=function(){function e(t){m(this,e),this.store=t}return v(e,[{key:"ngOnInit",value:function(){}},{key:"ngAfterViewInit",value:function(){this.nodeActionsComponent.nodeActionsTrigger.openMenu()}},{key:"onNodeActionsClosed",value:function(){this.store.dispatch(new Ve(null,null))}},{key:"getNodeActionsStyles",value:function(){return{"left.px":this.hit?this.hit.canvasPos[0]:0,"top.px":this.hit?this.hit.canvasPos[1]:0}}}]),e}()).\u0275fac=function(e){return new(e||vh)(_.Pb(L.g))},vh.\u0275cmp=_.Jb({type:vh,selectors:[["app-engine-contextmenu"]],viewQuery:function(e,t){var n;1&e&&_.Gc(_l,!0),2&e&&_.uc(n=_.dc())&&(t.nodeActionsComponent=n.first)},inputs:{node:"node",hit:"hit"},decls:2,vars:2,consts:[[1,"contextmenu"],["eventCategory","Context Node","theme","light",1,"contextmenu__node-actions",3,"ngStyle","node","nodeActionsClosed"]],template:function(e,t){1&e&&(_.Vb(0,"div",0),_.Vb(1,"app-node-actions",1),_.cc("nodeActionsClosed",(function(){return t.onNodeActionsClosed()})),_.Ub(),_.Ub()),2&e&&(_.Db(1),_.lc("ngStyle",t.getNodeActionsStyles())("node",t.node))},directives:[_l,or.m],styles:[".contextmenu[_ngcontent-%COMP%]{left:0;top:0;width:100%;height:100%;display:block;z-index:2}.contextmenu[_ngcontent-%COMP%], .contextmenu__node-actions[_ngcontent-%COMP%]{position:absolute}"]}),vh),Mh=function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r},Ih=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},zh={storyLoadProgress:0,chunkLoadProgress:0},Th=((yh=function(){function e(t){m(this,e),this.store=t}return v(e,[{key:"setProgress",value:function(e,t){e.patchState({storyLoadProgress:t.storyLoadProgress,chunkLoadProgress:t.chunkLoadProgress})}}],[{key:"getStoryLoadProgress",value:function(e){return e.storyLoadProgress}},{key:"getChunkLoadProgress",value:function(e){return e.chunkLoadProgress}}]),e}()).\u0275fac=function(e){return new(e||yh)(_.Zb(L.g))},yh.\u0275prov=_.Lb({token:yh,factory:yh.\u0275fac}),Mh([Object(L.a)(Nc),Ih("design:type",Function),Ih("design:paramtypes",[Object,Nc]),Ih("design:returntype",void 0)],yh.prototype,"setProgress",null),Mh([Object(L.e)(),Ih("design:type",Function),Ih("design:paramtypes",[Object]),Ih("design:returntype",void 0)],yh,"getStoryLoadProgress",null),Mh([Object(L.e)(),Ih("design:type",Function),Ih("design:paramtypes",[Object]),Ih("design:returntype",void 0)],yh,"getChunkLoadProgress",null),yh=Mh([Object(L.f)({name:"engineProgress",defaults:zh})],yh)),Uh=function(e){return{"progress__bar--complete":e}},Lh=function(e){return{width:e}},Dh=((kh=function(){function e(t,n){m(this,e),this.router=t,this.changeDetector=n,this.total=100,this._value=0,this.percentWidth=0,this.ngUnsubscribe=new ge.a}return v(e,[{key:"value",get:function(){return this._value},set:function(e){this._value=e,this.percentWidth=this.value/this.total*100,this.changeDetector.markForCheck()}},{key:"ngOnInit",value:function(){var e=this;this.router.events.pipe(Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){t instanceof we.d&&(e.value=0)}))}},{key:"ngOnDestroy",value:function(){this.changeDetector.detach(),this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}}]),e}()).\u0275fac=function(e){return new(e||kh)(_.Pb(we.e),_.Pb(_.i))},kh.\u0275cmp=_.Jb({type:kh,selectors:[["app-progress"]],inputs:{total:"total",value:"value"},decls:2,vars:6,consts:[[1,"progress"],[1,"progress__bar",3,"ngClass","ngStyle"]],template:function(e,t){1&e&&(_.Vb(0,"div",0),_.Qb(1,"div",1),_.Ub()),2&e&&(_.Db(1),_.lc("ngClass",_.oc(2,Uh,100===t.percentWidth))("ngStyle",_.oc(4,Lh,t.percentWidth+"%")))},directives:[or.i,or.m],styles:["@-webkit-keyframes progressSuccess{0%{width:100%!important;background:#38de38}50%{opacity:1;background:#38de38}to{opacity:0}}@keyframes progressSuccess{0%{width:100%!important;background:#38de38}50%{opacity:1;background:#38de38}to{opacity:0}}.progress[_ngcontent-%COMP%]{border-radius:0 1px 1px 0;display:flex;align-items:center;height:4px;width:100%}.progress__bar[_ngcontent-%COMP%]{background:#de3838;height:100%;width:0}.progress__bar--complete[_ngcontent-%COMP%]{-webkit-animation:progressSuccess 2s linear forwards;animation:progressSuccess 2s linear forwards}"],changeDetection:0}),kh),Eh=((wh=function(){function e(t,n){m(this,e),this.store=t,this.changeDetectorRef=n,this.ngUnsubscribe=new ge.a,this.storyLoadProgress=0}return v(e,[{key:"ngOnInit",value:function(){var e=this,t=this.store.select(Th.getChunkLoadProgress),n=this.store.select(Rc.getLoadingChunk);Object(Ka.b)(t,n).pipe(Object(be.a)((function(){var t=e.store.selectSnapshot(Rc.getLoadChunks);return null!==t&&t.length>0})),Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){var n=u(t,2),i=n[0],o=n[1],a=null!==o&&o.chapterId===e.store.selectSnapshot(Ua.getSelectedChapterId);e.storyLoadProgress=a?i:1,e.changeDetectorRef.markForCheck()}))}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}}]),e}()).\u0275fac=function(e){return new(e||wh)(_.Pb(L.g),_.Pb(_.i))},wh.\u0275cmp=_.Jb({type:wh,selectors:[["app-engine-progress"]],decls:1,vars:2,consts:[["data-test","engineProgress",1,"engine-progress",3,"value","total"]],template:function(e,t){1&e&&_.Qb(0,"app-progress",0),2&e&&_.lc("value",t.storyLoadProgress)("total",1)},directives:[Dh],styles:[".engine-progress[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;z-index:2;pointer-events:none}"],changeDetection:0}),wh),Fh=((xh=function(){function e(t,n){m(this,e),this.engineService=t,this.changeDetectionRef=n,this.camera={x:0,y:0,z:0,dist:0}}return v(e,[{key:"ngOnInit",value:function(){this.initCameraListener()}},{key:"initCameraListener",value:function(){var e=this;this.engineService.getEvent(Lt.CameraUpdated).pipe(Object(Ya.a)(50)).subscribe((function(t){e.camera={x:t.eye.x.toFixed(0),y:t.eye.y.toFixed(0),z:t.eye.z.toFixed(0),dist:t.dist.toFixed(0)},e.changeDetectionRef.markForCheck()}))}}]),e}()).\u0275fac=function(e){return new(e||xh)(_.Pb(Nt),_.Pb(_.i))},xh.\u0275cmp=_.Jb({type:xh,selectors:[["app-engine-camera-position"]],decls:2,vars:4,consts:[[1,"engine-camera-position"]],template:function(e,t){1&e&&(_.Vb(0,"div",0),_.Mc(1),_.Ub()),2&e&&(_.Db(1),_.Qc(" X:",null==t.camera?null:t.camera.x," Y:",null==t.camera?null:t.camera.y," Z:",null==t.camera?null:t.camera.z," Dist:",null==t.camera?null:t.camera.dist,"\n"))},styles:[".engine-camera-position[_ngcontent-%COMP%]{position:absolute;top:8px;right:8px;color:#fff;font-size:10px;text-shadow:0 0 2px rgba(0,0,0,.8);z-index:10}"],changeDetection:0}),xh),Ah=function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r},Rh=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Nh=["engine"],Vh=["engineCanvas"],Hh=["engineAnnotations"];function Bh(e,t){if(1&e&&_.Qb(0,"app-engine-contextmenu",10),2&e){var n=_.gc();_.lc("node",n.contextmenuNode)("hit",n.contextmenuHit)}}function Qh(e,t){1&e&&_.Qb(0,"div",11)}function qh(e,t){1&e&&_.Qb(0,"app-engine-progress",12)}function Wh(e,t){1&e&&(_.Tb(0),_.Qb(1,"app-engine-camera-position"),_.Sb())}var $h,Kh,Gh,Zh,Jh=function(e){return e[e.Pan=.4]="Pan",e[e.PanSlow=.04]="PanSlow",e[e.Zoom=5]="Zoom",e[e.ZoomSlow=1]="ZoomSlow",e[e.Rotate=.3]="Rotate",e[e.RotateSlow=.03]="RotateSlow",e}({}),Xh=function(e){return e[e.Rotate=6]="Rotate",e[e.Pan=1.75]="Pan",e[e.Zoom=2.5]="Zoom",e}({}),Yh=function(e){return e[e.Zoom=-6]="Zoom",e[e.TrackZoom=.5]="TrackZoom",e[e.Pan=1.25]="Pan",e[e.Rotate=1.5]="Rotate",e[e.Friction=.85]="Friction",e[e.ZoomFriction=.85]="ZoomFriction",e[e.FrictionThreshold=.002]="FrictionThreshold",e}({}),ef=function(e){return e.Hide="engine--cursor-hide",e.Label="engine--cursor-label",e.Paint="engine--cursor-paint",e.Crosshair="engine--cursor-crosshair",e.Default="",e}({}),tf=function(e){return e[e.None=0]="None",e[e.Left=1]="Left",e[e.Right=2]="Right",e[e.LeftAndRight=4]="LeftAndRight",e}({}),nf=(($h=function(){function e(t,n,i,o,a,r,c,s,l){m(this,e),this.actions=t,this.cameraService=n,this.changeDetecton=i,this.engineService=o,this.paintService=a,this.visibilityLayersService=r,this.mediaService=c,this.renderer=s,this.store=l,this.flyCamera=!0,this.chapterActivating=!1,this.visible=!1,this.application=j,this.cursorClass=ef.Default,this.ngUnsubscribe=new ge.a,this.display=!1,this.engineVisible=!0,this.background=new Wa.a(null),this.ctrlPressed=!1,this.scrollType=null,this.scrollTimeout=null,this.pinchTicks=0,this.progress="0",this.deltaTime=window.performance.now(),this.pinchMode="",this.inputEnabled=!0,z.application===j.Loft&&h.e(6).then(h.t.bind(null,"16wW",7)).then((function(e){window.pako=e}))}return v(e,[{key:"wheel",value:function(e){var t=this.store.selectSnapshot(qa.getScrollMode),n=this.ctrlPressed;t!==Ra.DoNotCaptureShowMessage||n||this.store.dispatch(new ze(!0)),(t===Ra.Capture||n)&&(e.preventDefault(),this.handleWheel(e))}},{key:"contextmenu",value:function(e){this.handleContextMenu(e)}},{key:"mouseout",value:function(){this.handleMouseOut()}},{key:"convertToLeafStateMap",value:function(e,t){var n={};return Object.entries(t).forEach((function(t){var i=u(t,2),o=i[0],a=i[1];n[o]={},n[o][e]=a})),n}},{key:"ngOnInit",value:function(){this.particleStateListener=new Qc(this.store),this.bindEngineEvents(),this.bindApplicationEvents(),this.bindChapterChangeEvents(),this.bindCameraEvents(),this.bindToolEvents(),this.bindMouseEvents(),this.bindKeyEvents(),this.bindHumanInteractions(),this.initChangeListener(),this.initChapterAudio(),this.initBackgroundListener(),this.initPlaybackSpeedListener(),Human.properties.set({assetDomain:z.assetDomain}),Human.workers.setPath("/engine/studio/workers"),Human.init.init()}},{key:"ngOnDestroy",value:function(){this.changeDetecton.detach(),this.particleStateListener.destroy(),this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"initEventListeners",value:function(){}},{key:"bindEngineEvents",value:function(){var e=this;this.engineService.getEvent(Lt.Loaded).pipe(Object(fe.a)(this.ngUnsubscribe)).subscribe((function(){e.store.dispatch(new Pe(!0))})),this.engineService.getEvent(Lt.TimelineChaptersActivateStart).pipe(Object(fe.a)(this.ngUnsubscribe)).subscribe((function(){e.chapterActivating=!0})),this.engineService.getEvent(Lt.TimelineChaptersActivateFinish).pipe(Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){e.chapterActivating=!1;var n=Human.timeline.activeRoot._nowBranch,i={id:n.id,init:!0,camera:n.initializedCamera,annotations:n.initializedAnnotations,graph:n.initializedGraph,properties:n.initializedProperties,particles:n.initializedParticles,clips:n.initializedClippingPlanes,postprocessing:n.initializedPostprocess,transparency:n.initializedTransparencyMode};e.store.dispatch(new Ae(t.chapterId)),e.store.dispatch(new Re(i))})),this.engineService.getEvent(Lt.TimelineChaptersActivated).pipe(Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){e.engineService.fireEvent(Lt.LabelsChapterInfo,e.store.selectSnapshot(Pc.getChapterLabels))})),Object($a.a)(this.engineService.getEvent(Lt.TimelinePlayed),this.engineService.getEvent(Lt.TimelinePaused)).pipe(Object(fe.a)(this.ngUnsubscribe),Object(be.a)((function(){return null!=e.store.selectSnapshot(Ua.getSelectedChapterId)})),Object(Za.a)(50),Object(K.a)((function(){return Human.timeline.playing}))).subscribe((function(t){e.store.dispatch(new Ye(t))})),this.engineService.getEvent(Lt.Tick).pipe(Object(fe.a)(this.ngUnsubscribe)).subscribe((function(){e.visible&&(e.inputEnabled&&e.handleMouseInputEngineTick(),e.handleCameraTick(),e.deltaTime=window.performance.now())})),this.engineService.getEvent(Lt.TweenVisibilityUpdate).pipe(Object(Ja.a)((function(e,t){return JSON.stringify(e)===JSON.stringify(t)})),Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){var n=Object.keys(t).filter((function(e){return!0===t[e]})),i=Object.keys(t).filter((function(e){return!1===t[e]}));n.length>0&&e.store.dispatch(new pi.UpdateNodesShown(!0,n,void 0,!1,!0)),i.length>0&&e.store.dispatch(new pi.UpdateNodesShown(!1,i,void 0,!1,!0))})),this.engineService.getEvent(Lt.SceneObjectRenderable).pipe(Object(Xa.a)(1e3),Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){if(t.length){var n={};t.forEach((function(e){n[e.objectId]={renderable:!0}})),e.store.dispatch(new qe(n))}})),this.engineService.getEvent(Lt.AssetsLoadProgress).pipe(Object(Ya.a)(100),Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){var n=Math.max(1,e.store.selectSnapshot(Rc.getLoadChunks).length),i=e.store.selectSnapshot(Rc.getLoadChunksRemaining).length,o=n-i,a=t.receivedAssets/t.requestedAssets,r=1/n,c=0===i?1:a*r+o*r;e.progress=c.toFixed(2),e.changeDetecton.markForCheck(),e.store.dispatch(new Nc(c,a))})),this.actions.pipe(Object(L.i)(Ur),Object(fe.a)(this.ngUnsubscribe)).subscribe((function(){0===e.store.selectSnapshot(Rc.getLoadChunksRemaining).length&&(e.store.dispatch(new Nc(1,1)),e.engineService.enableRender())}))}},{key:"bindApplicationEvents",value:function(){var e=this;this.enginePosition$.pipe(Object(be.a)((function(e){return null!=e})),Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){e.repositionEngine(t)})),this.store.select(qa.getXrayModeEnabled).pipe(Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){var n=e.store.selectSnapshot(Fi.getCheckedNodes),i=e.store.selectSnapshot(Fi.getNodes);!1===t?(Object.keys(i||[]).forEach((function(t){e.paintService.paint(t,i[t].paint)})),n.forEach((function(t){return e.paintService.highlight(t.objectId,!0)}))):(e.paintService.paintAll(Object.keys(i),Gi.recipe),e.paintService.paintAll(n.map((function(e){return e.objectId})),Vi.recipe))})),this.actions.pipe(Object(L.j)(nt),Object(fe.a)(this.ngUnsubscribe)).subscribe((function(){e.playChapterFromStart()})),this.engineDisplay$.pipe(Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){e.display=t,e.changeDetecton.markForCheck()})),this.engineVisible$.pipe(Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){e.engineVisible=t,e.changeDetecton.markForCheck()})),this.visibilityLayersService.initObservables(),this.contextmenu$.pipe(Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){e.contextmenuNode=t.node,e.contextmenuHit=t.hit,e.changeDetecton.markForCheck()}))}},{key:"bindChapterChangeEvents",value:function(){var e=this;this.selectedChapter$.pipe(Object(be.a)((function(e){return null!=e})),Object(er.a)(),Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){var n=u(t,2),i=n[0],o=n[1];i.id!==o.id&&(e.store.dispatch(new pi.SetActiveChapter(o.id)),Vc(e.store,e.engineService),Human.timeline.scrub({chapterId:o.id}),e.store.dispatch(new sn(void 0)))})),this.clippingPlanes$.pipe(Object(be.a)((function(e){return void 0!==e})),Object(fe.a)(this.ngUnsubscribe)).subscribe((function(e){var t=Object.values(e.clips).filter((function(e){return e.enabled}));Human.renderer.clip.reset(),t.forEach((function(t){return Human.renderer.clip.setClip(Object.assign({boundary:e.boundary},t))}))})),Object(Ka.b)(this.selectedChapterId$,this.readyState$,this.autoplay$).pipe(Object(be.a)((function(e){var t=u(e,3),n=t[0],i=t[1],o=t[2];return!Object(Oe.isNil)(n)&&!Object(Oe.isNil)(i)&&!Object(Oe.isNil)(o)})),Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){var n=u(t,3),i=n[1],o=n[2],a=Object(Oe.get)(i,"animation",!1),r=e.store.selectSnapshot(Ua.getSelectedChapter),c=Object(Oe.get)(r,"ui.play.autoplay",!0),s=a&&o&&c;e.store.dispatch(new Je(r,!s)),e.store.dispatch(new Xe(s))}))}},{key:"bindCameraEvents",value:function(){var e=this;this.actions.pipe(Object(L.j)(Wt),Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){t.animate?e.flyToPoint(t.camera,t.animationDuration):e.jumpToPoint(t.camera)})),this.actions.pipe(Object(L.j)(en),Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){e.cameraService.panCameraStatic(t.x,t.y,t.z)})),this.actions.pipe(Object(L.j)(on),Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){e.cameraService.rotateCameraStatic(t.x,t.y)})),this.actions.pipe(Object(L.j)(Jt),Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){e.cameraService.setHumanZoomFactor(t.value)})),this.actions.pipe(Object(L.j)(He),Object(be.a)((function(e){return!!e.objectId})),Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){t.animate?e.flyToObject(t.objectId,t.animationDuration):e.jumpToObject(t.objectId)}))}},{key:"bindToolEvents",value:function(){var e=this;this.activeTool$.pipe(Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){switch(Object.values(ef).forEach((function(t){t&&e.renderer.removeClass(e.engineElement.nativeElement,t)})),t){case Aa.Hide:e.renderer.addClass(e.engineElement.nativeElement,ef.Hide);break;case Aa.Label:e.renderer.addClass(e.engineElement.nativeElement,ef.Label);break;case Aa.Paint:e.renderer.addClass(e.engineElement.nativeElement,ef.Paint);break;case Aa.Quiz:e.renderer.addClass(e.engineElement.nativeElement,ef.Crosshair)}}))}},{key:"bindMouseEvents",value:function(){var e=this;this.mouseMove$=Object(Ga.a)(this.engineElement.nativeElement,"mousemove"),this.mouseMove$.pipe(Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){e.handleMousePan(t)})),this.mouseMove$.pipe(Object(Za.a)(10),Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){e.handleMouseHover(t)})),this.mouseLeave$=Object(Ga.a)(this.engineElement.nativeElement,"mouseleave"),this.mouseLeave$.pipe(Object(Za.a)(10),Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){e.handleMouseLeave()}))}},{key:"bindKeyEvents",value:function(){var e,t=this,n=["w","a","s","d","e","c","=","-","+","_","arrowleft","arrowright","arrowup","arrowdown","shiftKey"].reduce((function(e,t){return e[t]=!1,e}),{}),i=new Wa.a(n);this.renderer.listen(window,"keydown",(function(e){var t;if(!(e.repeat||e.metaKey||e.ctrlKey)){var n=e.target.nodeName.toLowerCase();["input","textarea","select","option"].indexOf(n)>=0||i.next(Object.assign(Object.assign({},i.value),(p(t={},e.key.toLowerCase(),!0),p(t,"shiftKey",e.shiftKey),p(t,"hasMomentum",!1),t)))}})),this.renderer.listen(window,"keyup",(function(n){var o,a;n.key&&(1===Object.values(e).filter((function(e){return!0===e})).length?(t.applyMotion(e,!0),i.next(Object.assign(Object.assign({},i.value),(p(o={},n.key.toLowerCase(),!1),p(o,"shiftKey",n.shiftKey),p(o,"hasMomentum",!1===e.shiftKey),o)))):i.next(Object.assign(Object.assign({},i.value),(p(a={},n.key.toLowerCase(),!1),p(a,"shiftKey",n.shiftKey),p(a,"hasMomentum",!1),a))))})),i.pipe(Object(be.a)((function(){return t.inputEnabled})),Object(fe.a)(this.ngUnsubscribe)).subscribe((function(n){e=n,!1===n.hasMomentum&&t.applyMotion(n,!1)})),this.renderer.listen(window,"keydown",(function(e){"Control"===e.key&&(t.ctrlPressed=!0)})),this.renderer.listen(window,"keyup",(function(e){"Control"===e.key&&(t.ctrlPressed=!1)}))}},{key:"applyMotion",value:function(e,t){var n=new gn,i=e.shiftKey?Jh.ZoomSlow:Jh.Zoom,o=e.shiftKey?Jh.PanSlow:Jh.Pan,a=e.shiftKey?Jh.RotateSlow:Jh.Rotate;n.zoom+=e.c||e["-"]||e._?i:0,n.zoom-=e.e||e["="]||e["+"]?i:0,n.panX-=e.d?o:0,n.panX+=e.a?o:0,n.panY+=e.w?o:0,n.panY-=e.s?o:0,n.rotateX-=e.arrowright?a:0,n.rotateX+=e.arrowleft?a:0,n.rotateY+=e.arrowup?a:0,n.rotateY-=e.arrowdown?a:0,n.applyFriction=t,this.store.dispatch(new Kt(n))}},{key:"initChangeListener",value:function(){var e=this;this.store.select(Fi.getPatches).pipe(Object(be.a)((function(e){return e.length>0})),Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){var n=t.reduce((function(e,t){var n=t.path[t.path.length-1];return void 0!==e[n]&&e[n].push(t),e}),{shown:[],checked:[],paint:[],pickable:[]}),i=function(e){return n[e].reduce((function(e,t){return e[t.path[2]]=t.value,e}),{})},o=i("checked"),a=i("shown"),r=i("paint"),c=i("pickable");if(!Object(Oe.isEmpty)(a)){var s=e.store.selectSnapshot(Fi.getNodes),l=Object.values(s).reduce((function(e,t){return e[t.objectId]=t.shown,e}),{});e.engineService.setNodesVisible(l);var p=e.convertToLeafStateMap("shown",l);e.store.dispatch(new Qe(p,s))}if(!Object(Oe.isEmpty)(o)){e.engineService.fireEvent(Lt.SceneObjectsSelected,{selectedObjectsUpdate:o});var d=e.store.selectSnapshot(qa.getXrayModeEnabled)?function(t,n){return e.paintService.paint(t,!0===n?Vi.recipe:Gi.recipe)}:function(t,n){return e.paintService.highlight(t,n)};Object.entries(o).forEach((function(e){var t=u(e,2),n=t[0],i=t[1];d(n,i)}))}if(!Object(Oe.isEmpty)(r))for(var g=0,h=Object.entries(r);g<h.length;g++){var f=u(h[g],2),b=f[0],v=f[1];e.paintService.colorObject(b,Ui.toEngine(v))}if(!Object(Oe.isEmpty)(c)){var m=e.store.selectSnapshot(Fi.getNodes),y=Object.values(m).reduce((function(e,t){return e[t.objectId]=t.pickable,e}),{});e.engineService.setNodesPickable(y),e.store.dispatch(new We(e.convertToLeafStateMap("pickable",y),m))}}))}},{key:"initChapterAudio",value:function(){var e=this;Object(Ka.b)(this.selectedChapterId$,this.playAudio$).pipe(Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){var n=u(t,2),i=(n[0],n[1]);e.playAudio(i)}))}},{key:"initBackgroundListener",value:function(){var e=this;Object(Ka.b)([this.background$,this.engineDisplay$,this.engineVisible$]).pipe(Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){var n=u(t,3),i=n[0],o=n[1],a=n[2];e.renderer.setStyle(e.engineElement.nativeElement,"background-image",ai.toCSS(i)),e.isBackgroundCheckered(i)?e.renderer.addClass(e.engineElement.nativeElement,"engine--checkered"):e.renderer.removeClass(e.engineElement.nativeElement,"engine--checkered"),e.renderer.setStyle(e.engineElement.nativeElement,"display",o?"block":"none"),e.renderer.setStyle(e.engineElement.nativeElement,"opacity",a?1:0)}))}},{key:"initPlaybackSpeedListener",value:function(){this.store.select(qa.getPlaybackSpeed).pipe(Object(fe.a)(this.ngUnsubscribe)).subscribe((function(e){Human.timeline.scale=e}))}},{key:"repositionEngine",value:function(e){this.renderer.setStyle(this.engineElement.nativeElement,"left",e.left+"px"),this.renderer.setStyle(this.engineElement.nativeElement,"top",e.top+"px"),this.renderer.setStyle(this.engineElement.nativeElement,"width",e.width+"px"),this.renderer.setStyle(this.engineElement.nativeElement,"height",e.height+"px"),this.renderer.setStyle(this.engineElement.nativeElement,"zIndex",""+e.visibility),this.renderer.setStyle(this.engineElement.nativeElement,"visibility",e.visibility===Ht.Shown?"visible":"hidden"),this.visible=e.visibility===Ht.Shown,Human.renderer.resize()}},{key:"bindHumanInteractions",value:function(){var e=this,t=new Bc.Manager(this.engineCanvasElement.nativeElement);t.add(new Bc.Tap({event:"doubletap",taps:2,posThreshold:50})),t.add(new Bc.Tap({event:"singletap"})),t.add(new Bc.Pan({event:"pan",pointers:0})),t.add(new Bc.Pinch({event:"pinch"})),t.add(new Bc.Press({time:500})),t.on("singletap",(function(t){e.handleTap(t)})),t.on("doubletap",(function(t){e.handleDoubleTap(t)})),t.on("press",(function(t){t.preventDefault(),t.srcEvent.stopImmediatePropagation(),e.handlePress(t)})),t.on("pan",(function(t){t.preventDefault(),e.handlePan(t)})),t.on("panstart",(function(t){e.handlePanStart(t)})),t.on("panend",(function(t){e.handlePanEnd(t)})),t.on("pinchend",(function(t){e.handlePinchEnd(t)}));var n=0,i=0;t.on("pinchstart",(function(t){n=t.scale,t.deltaX,t.deltaY,e.pinchMode=""})),t.on("pinchmove",(function(t){if(!(e.pinchTicks>0)){var o=Math.abs(t.deltaX)>60||Math.abs(t.deltaY)>60,a=t.scale>1.25||t.scale<.75;e.pinchMode?("pan"===e.pinchMode&&a&&!o&&(e.pinchMode="pinch"),"pinch"===e.pinchMode&&o&&!a&&(e.pinchMode="pan")):e.pinchMode=a?"pinch":"pan";var r=t.scale-n;n=t.scale;var c=i;i=0===r?0:r>0?1:-1,e.cameraService.setCameraPan(t.velocityX*Yh.Pan,t.velocityY*Yh.Pan),i+c!==0&&e.cameraService.setHumanZoom(r*Yh.Zoom)}}))}},{key:"handleMouseHover",value:function(e){if(e.buttons===tf.None){var t=e.offsetX,n=e.offsetY,i=Human.renderer.pick.pick(t,n);if(i.objectId){var o=this.store.selectSnapshot(qa.getViewGraph),a=this.engineService.getNode(o,i.objectId),r=this.store.selectSnapshot(qa.getHoveredNode);r&&r.id===a.id||this.store.dispatch(new ft(a,i))}else null!=this.store.selectSnapshot(qa.getHoveredNode)&&this.store.dispatch(new ft(null))}}},{key:"handleMouseLeave",value:function(){this.store.dispatch(new ft(null))}},{key:"handleMousePan",value:function(e){if(2===e.buttons||4===e.buttons){var t=e.movementX,n=e.movementY;t/=16,n/=16,this.cameraService.setCameraPan(t,n)}}},{key:"handleMouseOut",value:function(){this.store.dispatch(new ft(null))}},{key:"handleWheel",value:function(e){var t=this,n=0;switch(e.deltaMode){case 0:null===this.scrollType&&(this.scrollType=Math.abs(e.deltaY)<10?"trackpad":"wheel"),n="trackpad"===this.scrollType?e.deltaY*Yh.TrackZoom:Math.sign(e.deltaY)*Xh.Zoom;break;default:this.scrollType="wheel",n=e.deltaY*Xh.Zoom}clearTimeout(this.scrollTimeout),this.scrollTimeout=setTimeout((function(){t.scrollType=null}),500),Math.abs(n)>40&&(n=40*Math.sign(n)),"trackpad"===this.scrollType?this.cameraService.setCameraZoom(n):this.zoomWithVelocity(n)}},{key:"zoomWithVelocity",value:function(e){var t=this;this.cameraService.setCameraZoom(e),requestAnimationFrame((function(){e*=.85,Math.abs(e)>1&&t.zoomWithVelocity(e)}))}},{key:"handleContextMenu",value:function(e){e.preventDefault();var t=e.offsetX,n=e.offsetY,i=this.getHit(t,n),o=this.getNodeFromHit(i);this.store.dispatch(new Ve(o,i))}},{key:"handlePanStart",value:function(e){}},{key:"handlePanEnd",value:function(e){var t=this.store.selectSnapshot(Fa.getCameraMotion);if(!(this.pinchTicks>0||t.panX===e.velocityX&&t.panY===e.velocityY)){var n=this.store.selectSnapshot(Fa.getPanMode);e.srcEvent.shiftKey||"pan"===n?(t.panX=e.velocityX*Yh.Pan,t.panY=e.velocityY*Yh.Pan):(t.rotateX=e.velocityX*Yh.Rotate,t.rotateY=e.velocityY*Yh.Rotate),t.applyFriction=!0,this.store.dispatch(new Kt(t))}}},{key:"handlePinchEnd",value:function(e){var t=this.store.selectSnapshot(Fa.getCameraMotion);if("pan"===this.pinchMode)t.panX=e.velocityX*Yh.Pan,t.panY=e.velocityY*Yh.Pan;else{var n=e.velocity>0?1:-1;t.zoom=Math.sqrt(e.velocityX*e.velocityX+e.velocityY*e.velocityY)*-n*Yh.Zoom}t.applyFriction=!0,this.store.dispatch(new Kt(t)),this.pinchTicks=10}},{key:"handleTap",value:function(e){var t=this.getOffset(e),n=t.offsetX,i=t.offsetY,o=this.getHit(n,i),a=this.getNodeFromHit(o);this.store.dispatch(new Ne(a,e,o))}},{key:"handleDoubleTap",value:function(e){var t=this.getOffset(e),n=t.offsetX,i=t.offsetY,o=this.getHit(n,i),a=this.getNodeFromHit(o);a&&this.store.dispatch(new He(a.id))}},{key:"handlePress",value:function(e){var t=this.getOffset(e),n=t.offsetX,i=t.offsetY,o=this.getHit(n,i),a=this.getNodeFromHit(o);a&&this.store.dispatch(new He(a.id))}},{key:"handlePan",value:function(e){if(!(this.pinchTicks>0)){var t=this.store.selectSnapshot(Fa.getPanMode),n=e.velocityX,i=e.velocityY;e.srcEvent.shiftKey||"pan"===t?this.cameraService.setCameraPan(n*Yh.Pan,i*Yh.Pan):this.cameraService.setCameraRotation(n*Yh.Rotate,i*Yh.Rotate)}}},{key:"handleMouseInputEngineTick",value:function(){var e=this.cameraService.tickCameraRotation(),t=this.cameraService.tickCameraPan(),n=this.cameraService.tickCameraZoom(),i=Math.min(15,(window.performance.now()-this.deltaTime)/16.666666666666668);if((e.vx||e.vy)&&this.cameraService.rotateCameraStatic(0!==e.vx?i*e.vx*Xh.Rotate:0,0!==e.vy?i*e.vy*Xh.Rotate:0),t.x||t.y){var o=Math.max(Human.renderer.camera.lookDistance/80,.01);this.cameraService.panCameraStatic(i*t.x*o*Xh.Pan,i*t.y*o*Xh.Pan,i*t.z*o*Xh.Pan)}0!==n&&this.cameraService.setHumanZoom(i*n*Xh.Zoom)}},{key:"handleCameraTick",value:function(){this.pinchTicks>0&&this.pinchTicks--,this.applyFriction();var e=this.store.selectSnapshot(Fa.getCameraMotion);this.cameraService.setCameraPan(e.panX,e.panY),this.cameraService.setCameraRotation(e.rotateX,e.rotateY),this.cameraService.setCameraZoom(e.zoom)}},{key:"getFriction",value:function(e){if(0===e)return 0;var t=(window.performance.now()-this.deltaTime)/16.666666666666668,n=e*Math.max(0,Yh.Friction+.1*(1-t));return Math.abs(n)<Yh.FrictionThreshold&&(n=0),n}},{key:"applyFriction",value:function(){var e=this.store.selectSnapshot(Fa.getCameraMotion);!0===e.applyFriction&&(e.rotateX=this.getFriction(e.rotateX),e.rotateY=this.getFriction(e.rotateY),e.panX=this.getFriction(e.panX),e.panY=this.getFriction(e.panY),e.zoom=this.getFriction(e.zoom),0===e.rotateX&&0===e.rotateY&&0===e.panX&&0===e.panY&&0===e.zoom&&(e.applyFriction=!1),this.store.dispatch(new Kt(e)))}},{key:"flyToObject",value:function(e,t){Human.renderer.camera.fly.flyTo({objectId:e,animationDuration:t})}},{key:"jumpToObject",value:function(e){Human.renderer.camera.fly.jumpTo({objectId:e})}},{key:"flyToPoint",value:function(e,t){var n=this;Human.renderer.camera.fly.flyTo(Object.assign(Object.assign({},e),{animationDuration:t}),(function(){n.store.dispatch(new $t)}))}},{key:"jumpToPoint",value:function(e){Human.renderer.camera.fly.jumpTo(e)}},{key:"getNodeFromHit",value:function(e){var t;if(e.objectId){var n=this.store.selectSnapshot(qa.getViewGraph);t=this.engineService.getNode(n,e.objectId)}return t}},{key:"getHit",value:function(e,t){return Human.renderer.pick.pick(e,t,{rayPick:!0})}},{key:"getOffset",value:function(e){var t=0,n=0;e.center?(t=e.center.x,n=e.center.y):(t=e.clientX,n=e.clientY);var i=this.engineElement.nativeElement.getBoundingClientRect();return{offsetX:t-i.left,offsetY:n-i.top}}},{key:"playAudio",value:function(e){e=Object(Oe.isNil)(e)?this.store.selectSnapshot(qa.getPlayAudio):e,this.mediaService.stopAudio();var t=this.store.selectSnapshot(Ua.getSelectedChapterAudio),n=Object(Oe.get)(t,"data.fullUrl");if(n){var i=this.mediaService.getAudioPlayer(n);i||(i=this.mediaService.addAudioPlayer(n)),e?i.play():i.stop()}}},{key:"playChapterFromStart",value:function(){var e=this.store.selectSnapshot(Ua.getSelectedChapter);this.playAudio(),this.store.dispatch(new Je(e)),this.store.dispatch(new Xe(!0))}},{key:"isTransparentBackground",value:function(e){return!!e&&ai.isTransparent(this.background.getValue())}},{key:"isBackgroundCheckered",value:function(e){return z.application!==j.Viewer&&this.isTransparentBackground(e)}}]),e}()).\u0275fac=function(e){return new(e||$h)(_.Pb(L.b),_.Pb(dn),_.Pb(_.i),_.Pb(Nt),_.Pb(Gc),_.Pb(Xc),_.Pb(ts),_.Pb(_.H),_.Pb(L.g))},$h.\u0275cmp=_.Jb({type:$h,selectors:[["app-engine"]],viewQuery:function(e,t){var n;1&e&&(_.Gc(Nh,!0),_.Gc(Vh,!0),_.Gc(Hh,!0)),2&e&&(_.uc(n=_.dc())&&(t.engineElement=n.first),_.uc(n=_.dc())&&(t.engineCanvasElement=n.first),_.uc(n=_.dc())&&(t.engineAnnotationsElement=n.first))},hostBindings:function(e,t){1&e&&_.cc("wheel",(function(e){return t.wheel(e)}))("contextmenu",(function(e){return t.contextmenu(e)}))("mouseout",(function(e){return t.mouseout(e)}))},inputs:{inputEnabled:"inputEnabled"},decls:14,vars:7,consts:[["id","container","data-test","engine","role","main",1,"engine"],["engine",""],["id","theCanvas","data-test","engineCanvas",1,"engine__canvas"],["engineCanvas",""],["id","annotationCanvas",1,"engine__annotations"],["engineAnnotations",""],[3,"node","hit",4,"ngIf"],["data-test","engineInputBlocker","class","engine__input-blocking",4,"ngIf"],["data-test","engineProgressBar",4,"ngIf"],[4,"appFlagApplication"],[3,"node","hit"],["data-test","engineInputBlocker",1,"engine__input-blocking"],["data-test","engineProgressBar"]],template:function(e,t){1&e&&(_.Vb(0,"div",0,1),_.Qb(2,"canvas",2,3),_.Qb(4,"canvas",4,5),_.Qb(6,"app-labels"),_.Kc(7,Bh,1,2,"app-engine-contextmenu",6),_.Kc(8,Qh,1,0,"div",7),_.Kc(9,qh,1,0,"app-engine-progress",8),_.hc(10,"async"),_.Qb(11,"app-engine-scroll"),_.Qb(12,"app-engine-fade"),_.Kc(13,Wh,2,0,"ng-container",9),_.Ub()),2&e&&(_.Eb("data-progress",t.progress),_.Db(7),_.lc("ngIf",t.contextmenuNode),_.Db(1),_.lc("ngIf",!t.inputEnabled),_.Db(1),_.lc("ngIf",_.ic(10,5,t.showProgressBar$)),_.Db(4),_.lc("appFlagApplication",t.application.Loft))},directives:[hh,or.l,Oh,jh,ul,Ph,Eh,Fh],pipes:[or.b],styles:[".engine[_ngcontent-%COMP%]{-webkit-tap-highlight-color:rgba(0,0,0,0);-webkit-tap-highlight-color:transparent;position:fixed;width:100vw;height:100vh;overflow:hidden;visibility:hidden;z-index:-1;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.engine__canvas[_ngcontent-%COMP%]{display:block;position:absolute;width:100%;height:100%;z-index:1}.engine__annotations[_ngcontent-%COMP%]{display:none}.engine--cursor-paint[_ngcontent-%COMP%]:hover{cursor:url(/assets/images/cursor-paint.png) 7 20,pointer}.engine--cursor-hide[_ngcontent-%COMP%]:hover{cursor:url(/assets/images/cursor-hide.png) 7 20,pointer}.engine--cursor-label[_ngcontent-%COMP%]:hover{cursor:url(/assets/images/cursor-label.png) 7 20,pointer}.engine--cursor-crosshair[_ngcontent-%COMP%]:hover{cursor:crosshair}.engine--checkered[_ngcontent-%COMP%]{background-color:#fff;background-size:24px 24px;background-position:0 0,12px 12px;background-image:linear-gradient(45deg,#d7e0ea 25%,transparent 0,transparent 75%,#d7e0ea 0,#d7e0ea),linear-gradient(45deg,#d7e0ea 25%,transparent 0,transparent 75%,#d7e0ea 0,#d7e0ea)}.engine__controls[_ngcontent-%COMP%]{position:absolute;right:16px;bottom:16px;z-index:2}.engine__progress[_ngcontent-%COMP%]{position:absolute;top:0;left:0;right:0;z-index:2}.engine__progress--hide[_ngcontent-%COMP%]{display:none}.engine__input-blocking[_ngcontent-%COMP%]{position:absolute;top:0;left:0;right:0;bottom:0;z-index:3}@media (max-width:768px){.engine__controls[_ngcontent-%COMP%]{bottom:96px}}"],changeDetection:0}),Ah([Object(L.d)(qa.getReady),Rh("design:type",he.a)],$h.prototype,"ready$",void 0),Ah([Object(L.d)(qa.getViewGraph),Rh("design:type",he.a)],$h.prototype,"viewGraph$",void 0),Ah([Object(L.d)(qa.getEnginePosition),Rh("design:type",he.a)],$h.prototype,"enginePosition$",void 0),Ah([Object(L.d)(qa.getHoveredNode),Rh("design:type",he.a)],$h.prototype,"hoveredNode$",void 0),Ah([Object(L.d)(qa.getChapter),Rh("design:type",he.a)],$h.prototype,"chapter$",void 0),Ah([Object(L.d)(qa.getChapterInit),Rh("design:type",he.a)],$h.prototype,"chapterInit$",void 0),Ah([Object(L.d)(Fi.getCheckedNodes),Rh("design:type",he.a)],$h.prototype,"checkedNodes$",void 0),Ah([Object(L.d)(qa.getActiveTool),Rh("design:type",he.a)],$h.prototype,"activeTool$",void 0),Ah([Object(L.d)(qa.getAnimationPlaying),Rh("design:type",he.a)],$h.prototype,"animationPlaying$",void 0),Ah([Object(L.d)(qa.getAutoplay),Rh("design:type",he.a)],$h.prototype,"autoplay$",void 0),Ah([Object(L.d)(qa.getPlayAudio),Rh("design:type",he.a)],$h.prototype,"playAudio$",void 0),Ah([Object(L.d)(qa.getDisplay),Rh("design:type",he.a)],$h.prototype,"engineDisplay$",void 0),Ah([Object(L.d)(qa.getVisible),Rh("design:type",he.a)],$h.prototype,"engineVisible$",void 0),Ah([Object(L.d)(qa.getShowProgressBar),Rh("design:type",he.a)],$h.prototype,"showProgressBar$",void 0),Ah([Object(L.d)(qa.getContextmenu),Rh("design:type",he.a)],$h.prototype,"contextmenu$",void 0),Ah([Object(L.d)(Ua.getSelectedChapter),Rh("design:type",he.a)],$h.prototype,"selectedChapter$",void 0),Ah([Object(L.d)(Ua.getSelectedChapterId),Rh("design:type",he.a)],$h.prototype,"selectedChapterId$",void 0),Ah([Object(L.d)(Ua.getSelectedChapterReadyState),Rh("design:type",he.a)],$h.prototype,"readyState$",void 0),Ah([Object(L.d)(Ua.getSelectedChapterClippingPlanes),Rh("design:type",he.a)],$h.prototype,"clippingPlanes$",void 0),Ah([Object(L.d)(Fa.getCameraMotion),Rh("design:type",he.a)],$h.prototype,"cameraMotion$",void 0),Ah([Object(L.d)(Ua.getSelectedChapterBackground),Rh("design:type",he.a)],$h.prototype,"background$",void 0),$h),of=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},af=((Kh=function(){function e(t,n,i,o){m(this,e),this.store=t,this.router=n,this.ga=i,this.pendoService=o,this.title="Biodigital Human",this.ngUnsubscribe=new ge.a}return v(e,[{key:"onClick",value:function(e){this.pendoService.trackSingle("First Click")}},{key:"ngOnInit",value:function(){this.initPendo(),this.initPageAnalytics(),this.initInputObserver()}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"initPendo",value:function(){this.pendoService.appendScript(),this.pendoService.initialize({visitor:{id:""},account:{}})}},{key:"initInputObserver",value:function(){var e=this;this.inputEnabled$.pipe(Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){e.store.dispatch(new S.SetInputEnabled(t))}))}},{key:"initPageAnalytics",value:function(){var e=this;this.router.events.pipe(Object(be.a)((function(e){return e instanceof we.c})),Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){e.ga.pageView(t.urlAfterRedirects)}))}}]),e}()).\u0275fac=function(e){return new(e||Kh)(_.Pb(L.g),_.Pb(we.e),_.Pb(ke.c),_.Pb(Se))},Kh.\u0275cmp=_.Jb({type:Kh,selectors:[["app-root"]],hostBindings:function(e,t){1&e&&_.cc("click",(function(e){return t.onClick(e)}),!1,_.xc)},decls:3,vars:3,consts:[[3,"inputEnabled"]],template:function(e,t){1&e&&(_.Qb(0,"app-engine",0),_.hc(1,"async"),_.Qb(2,"router-outlet")),2&e&&_.lc("inputEnabled",_.ic(1,1,t.inputEnabled$))},directives:[nf,we.g],pipes:[or.b],styles:[""],changeDetection:0}),function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);a>3&&r&&Object.defineProperty(t,n,r)}([Object(L.d)(de.getInputEnabled),of("design:type",he.a)],Kh.prototype,"inputEnabled$",void 0),Kh),rf=h("imBb"),cf=h("7sSR"),sf=function(e){return e[e.Main=0]="Main",e[e.Media=1]="Media",e[e.Tools=2]="Tools",e[e.Whiteboard=3]="Whiteboard",e[e.VisibilityLayers=4]="VisibilityLayers",e[e.Empty=5]="Empty",e}({}),lf=((Gh=function(){function e(t,n,i){m(this,e),this.store=t,this.engineService=n,this.viewService=i}return v(e,[{key:"startQuiz",value:function(){this.viewService.toggleColumn(!0),this.store.dispatch(new no.SetQuizActive(!0));var e=this.store.selectSnapshot(So.getAllQuestions)[0].id;this.store.dispatch(new no.SetActiveQuestion(e))}},{key:"resetQuiz",value:function(){this.store.dispatch(new no.SetQuizActive(!1)),this.store.dispatch(new no.SetActiveSubmission(void 0)),this.store.dispatch(new no.ClearSubmissions),this.store.dispatch(new no.SetQuizLifecycle(ho.Question))}},{key:"exitQuiz",value:function(){var e=this;this.resetQuiz(),setTimeout((function(){e.store.dispatch(new Wt(e.store.selectSnapshot(Ua.getChapterCamera),!1))}))}},{key:"submitQuestion",value:function(e,t){var n=this.store.selectSnapshot(So.getAllQuestions).find((function(t){return t.id===e})),i=this.store.selectSnapshot(So),o=i.launchMode,a=i.quizSettings;this.store.dispatch(new no.SubmitQuestionAnswer({questionId:n.id,answer:t})),this.store.dispatch(new no.SetActiveSubmission({questionId:n.id,answer:t})),this.engineService.fireEvent(Lt.QuizAnswerSubmitted,{questionId:n.id,answer:t}),o===vo.Learning&&n.type!==co.Instructions&&!1!==a.showExplanation?this.store.dispatch(new no.SetQuizLifecycle(ho.Explanation)):this.nextQuestion()}},{key:"nextQuestion",value:function(){this.store.selectSnapshot(So.hasQuestionRemaining)?(this.store.dispatch(new no.SetQuizLifecycle(ho.Question)),this.store.dispatch(new no.NextQuestion)):(this.store.dispatch(new no.SetQuizLifecycle(ho.Review)),this.engineService.fireEvent(Lt.QuizCompleted,!0))}}]),e}()).\u0275fac=function(e){return new(e||Gh)(_.Zb(L.g),_.Zb(Nt),_.Zb(Bu))},Gh.\u0275prov=_.Lb({token:Gh,factory:Gh.\u0275fac,providedIn:"root"}),Gh);function pf(e){if(null==e)return"";var t=new RegExp(/[^a-zA-Z0-9_]/,"gi");return e.replace(t,"_")}!function(e){e.normalize=function(e){return(""+(e||"")).replace(/&#(\d+);/g,(function(e,t){return String.fromCharCode(t)})).replace(/(&.+;)/gi,(function(e,t){return String.fromCharCode(e.charCodeAt(0))}))},e.prettyPrint=function(e){return(""+(e||"")).trim().replace(/([A-Z])/g," $1").replace(/^./,(function(e){return e.toUpperCase()})).trim()},e.parseEmails=function(e){return e.split(",").map((function(e){return e.trim()})).filter((function(e){return!!e}))},e.validateEmail=function(e){return/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/.test(e)}}(Zh||(Zh={}));var uf,df=h("wf0l"),gf=((uf=function(){function e(){m(this,e)}return v(e,[{key:"transform",value:function(e,t){return pf(e)}}]),e}()).\u0275fac=function(e){return new(e||uf)},uf.\u0275pipe=_.Ob({name:"elementID",type:uf,pure:!0}),uf),hf=function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r},ff=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},bf=["chapterList"],vf=function(e,t){return{"view-chapters__item--viewed":e,"view-chapters__item--selected":t}};function mf(e,t){if(1&e){var n=_.Wb();_.Vb(0,"li",3),_.cc("click",(function(){_.zc(n);var e=t.$implicit;return _.gc().handleChapterClick(e)}))("keyup.enter",(function(){_.zc(n);var e=t.$implicit;return _.gc().handleChapterClick(e)})),_.hc(1,"async"),_.hc(2,"elementID"),_.hc(3,"async"),_.Vb(4,"div",4),_.Mc(5),_.Ub(),_.Vb(6,"div",5),_.Mc(7),_.Ub(),_.Qb(8,"div",6),_.Ub()}if(2&e){var i,o=t.$implicit,a=t.index,r=_.gc();_.lc("gaLabel","Chapter "+(a+1)+" of "+(null==(i=_.ic(1,8,r.chapters$))?null:i.length))("ngClass",_.pc(14,vf,r.isViewed(o.id),o.id===_.ic(3,12,r.selectedChapterId$))),_.Eb("aria-label",o.info.displayName)("data-chapter-id",_.ic(2,10,o.id)),_.Db(5),_.Oc("",a+1,"."),_.Db(2),_.Nc(o.info.displayName),_.Db(1),_.lc("defaultImage",r.defaultImage)("lazyLoad",r.getChapterThumb(o.id))}}var yf,xf=((yf=function(){function e(t,n,i){m(this,e),this.store=t,this.viewService=n,this.changeDetectorRef=i,this.defaultImage="/assets/images/view-chapter-thumbnail-placeholder.png",this.autoscroll=!0,this.ngUnsubscribe=new ge.a,this.nextChapter=null}return v(e,[{key:"ngOnInit",value:function(){this.initChaptersObserver()}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"ngAfterViewInit",value:function(){this.initScrollObserver()}},{key:"initChaptersObserver",value:function(){var e=this;Object(Ka.b)([this.store.select(Ua.getStoryChapters),this.store.select(Ua.getSelectedChapterIndex)]).pipe(Object(Ya.a)(300),Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){var n=u(t,2),i=n[0],o=n[1]+1;e.nextChapter=o>=i.length?null:i[o],e.changeDetectorRef.markForCheck()}))}},{key:"initScrollObserver",value:function(){var e=this;this.selectedChapterId$.pipe(Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){e.scrollChapterIntoView(t)}))}},{key:"handleChapterClick",value:function(e){this.viewService.selectChapter(e)}},{key:"getChapterThumb",value:function(e){var t=this.store.selectSnapshot(Ua.getRegisteredThumbnails).get(e);return t?t.snapshot||t.urls.small:""}},{key:"scrollChapterIntoView",value:function(e){var t=pf(e);if(t){var n=this.chapterList.nativeElement.querySelector("[data-chapter-id=".concat(t,"]"));n&&this.autoscroll&&"scrollBehavior"in document.documentElement.style&&n.scrollIntoView({behavior:"auto",block:"nearest"})}}},{key:"isViewed",value:function(e){return this.store.selectSnapshot(Ua.getChaptersViewed).some((function(t){return t===e}))}}]),e}()).\u0275fac=function(e){return new(e||yf)(_.Pb(L.g),_.Pb(Bu),_.Pb(_.i))},yf.\u0275cmp=_.Jb({type:yf,selectors:[["app-view-chapters"]],viewQuery:function(e,t){var n;1&e&&_.Rc(bf,!0),2&e&&_.uc(n=_.dc())&&(t.chapterList=n.first)},inputs:{defaultImage:"defaultImage",autoscroll:"autoscroll"},decls:6,vars:6,consts:[["aria-label","Chapters","role","navigation","gaCategory","View Chapter List",1,"view-chapters",3,"hidden"],["chapterList",""],["gaEvent","","gaAction","Clicked Chapter","role","button","class","view-chapters__item","tabindex","0",3,"gaLabel","ngClass","click","keyup.enter",4,"ngFor","ngForOf"],["gaEvent","","gaAction","Clicked Chapter","role","button","tabindex","0",1,"view-chapters__item",3,"gaLabel","ngClass","click","keyup.enter"],[1,"view-chapters__index"],[1,"view-chapters__title"],[1,"view-chapters__thumb",3,"defaultImage","lazyLoad"]],template:function(e,t){var n;(1&e&&(_.Vb(0,"nav",0,1),_.hc(2,"async"),_.Vb(3,"ol"),_.Kc(4,mf,9,17,"li",2),_.hc(5,"async"),_.Ub(),_.Ub()),2&e)&&(_.lc("hidden",1===(null==(n=_.ic(2,2,t.chapters$))?null:n.length)),_.Db(4),_.lc("ngForOf",_.ic(5,4,t.chapters$)))},directives:[ke.a,or.k,ke.b,or.i,df.a],pipes:[or.b,gf],styles:[".text-8{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-header{font-weight:700}.text--code{font-family:Courier New,Courier,monospace}.text-uppercase{text-transform:uppercase}.text-xlight{font-weight:200}.text-light{font-weight:300}.text-medium{font-weight:500}.text-semibold{font-weight:600}.text-bold{font-weight:700}.text-underline{text-decoration:underline}.text-italic{font-style:italic}.text-bright{color:#fff}.text-dim{color:#96a8c0}.text-error{color:#ed4758}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.text-ellipsis{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link,.text-link:visited{color:inherit;cursor:pointer}.text-link:not(.text-underline),.text-link:visited:not(.text-underline){text-decoration:none}.text-success{color:#38de38}.text-danger{color:#de3838}.text-info{color:#0060c4}.text-nowrap{white-space:nowrap}.text-pre-line{white-space:pre-line}.view-chapters{max-height:320px;overflow:auto}.view-chapters__header{border-top:var(--view-chapters-border);display:flex;align-items:center;padding:16px 0;margin-top:16px}.view-chapters__next{font-size:14px;letter-spacing:.35px;line-height:1.4em;font-style:italic;padding:8px;border-radius:4px;flex-grow:1}.view-chapters__next:hover{background:var(--view-chapters-bg--hover);color:var(--view-chapters-color--hover);cursor:pointer}.view-chapters__toggle{justify-content:flex-end;flex-shrink:1;text-align:right;margin-left:4px}.view-chapters__item{font-size:14px;letter-spacing:.35px;line-height:1.4em;display:flex;padding:8px;margin:4px;border-radius:2px;border-left:4px solid transparent;background-color:transparent;color:#131c2a;border-left:var(--view-chapters-border);background-color:var(--view-chapters-bg);color:var(--view-chapters-color);transition:background-color 125ms,color 125ms,border 125ms}.view-chapters__item:hover{cursor:pointer;background:var(--view-chapters-bg--hover)}.view-chapters__item:focus{background:#f1f4fa;outline:none}.view-chapters__item--selected{border-left:4px solid #2d72dc;background-color:#f1f5fc;background:var(--view-chapters-bg--selected);border-left:var(--view-chapters-border--selected)}.view-chapters__index{display:flex;flex:0 0 32px;justify-content:center}.view-chapters__thumb{background-color:#f9fafd;background-color:var(--view-chapters-thumb-bg);border-radius:4px;background-repeat:no-repeat;flex:0 0 56px;height:56px;width:56px;transition:border-color .1s}.view-chapters__title{word-wrap:break-word;overflow-wrap:break-word;display:flex;flex:1 1 auto;padding-right:4px}.view-chapters__thumb{background-size:cover}"],encapsulation:2,changeDetection:0}),hf([Object(L.d)(Ua.getStoryChapters),ff("design:type",he.a)],yf.prototype,"chapters$",void 0),hf([Object(L.d)(Ua.getSelectedChapterId),ff("design:type",he.a)],yf.prototype,"selectedChapterId$",void 0),hf([Object(L.d)(Ua.getSelectedChapterIndex),ff("design:type",he.a)],yf.prototype,"selectedChapterIndex$",void 0),hf([Object(L.d)(Ua.getRegisteredThumbnails),ff("design:type",he.a)],yf.prototype,"thumbnails$",void 0),hf([Object(L.d)(Ua.getChaptersViewed),ff("design:type",he.a)],yf.prototype,"chaptersViewed$",void 0),yf),wf=h("rDax"),kf=function(){function e(t,n,i){var o=this;m(this,e),this.overlay=t,this.content=n,this.data=i,this.afterClosed=new ge.a,this.afterClosed$=this.afterClosed.asObservable(),t.backdropClick().subscribe((function(){return o._close("backdropClick",i)}))}return v(e,[{key:"close",value:function(e){this._close("close",e)}},{key:"_close",value:function(e,t){this.overlay.dispose(),this.afterClosed.next({type:e,data:t}),this.afterClosed.complete()}}]),e}(),Of=h("+rOU");function Cf(e,t){if(1&e&&_.Qb(0,"div",4),2&e){var n=_.gc();_.lc("innerHTML",n.content,_.Ac)}}function Sf(e,t){1&e&&_.Rb(0)}function _f(e,t){if(1&e&&(_.Tb(0),_.Kc(1,Sf,1,0,"ng-container",5),_.Sb()),2&e){var n=_.gc();_.Db(1),_.lc("ngTemplateOutlet",n.content)("ngTemplateOutletContext",n.context)}}function jf(e,t){1&e&&_.Rb(0)}function Pf(e,t){if(1&e&&(_.Tb(0),_.Kc(1,jf,1,0,"ng-container",6),_.Sb()),2&e){var n=_.gc();_.Db(1),_.lc("ngComponentOutlet",n.content)}}var Mf,If,zf,Tf=((Mf=function(){function e(t){m(this,e),this.popupRef=t,this.renderMethod="component"}return v(e,[{key:"ngOnInit",value:function(){this.content=this.popupRef.content,"string"==typeof this.content?this.renderMethod="text":this.content instanceof _.O&&(this.renderMethod="template",this.context={close:this.popupRef.close.bind(this.popupRef)})}}]),e}()).\u0275fac=function(e){return new(e||Mf)(_.Pb(kf))},Mf.\u0275cmp=_.Jb({type:Mf,selectors:[["app-popup"]],decls:5,vars:4,consts:[[1,"popup"],[3,"ngSwitch"],[3,"innerHTML",4,"ngSwitchCase"],[4,"ngSwitchCase"],[3,"innerHTML"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[4,"ngComponentOutlet"]],template:function(e,t){1&e&&(_.Vb(0,"div",0),_.Tb(1,1),_.Kc(2,Cf,1,1,"div",2),_.Kc(3,_f,2,2,"ng-container",3),_.Kc(4,Pf,2,1,"ng-container",3),_.Sb(),_.Ub()),2&e&&(_.Db(1),_.lc("ngSwitch",t.renderMethod),_.Db(1),_.lc("ngSwitchCase","text"),_.Db(1),_.lc("ngSwitchCase","template"),_.Db(1),_.lc("ngSwitchCase","component"))},directives:[or.n,or.o,or.q,or.j],styles:["[_nghost-%COMP%]{width:100%;height:100%}.popup[_ngcontent-%COMP%]{background:#fff;border-radius:4px;padding:8px;overflow-y:auto;box-shadow:1px -1px 2px 0 rgba(28,42,63,.1),0 1px 2px 0 rgba(28,42,63,.3)}"],changeDetection:0}),Mf),Uf=function(e){return e.Above="above",e.Below="below",e.Left="left",e.Right="right",e}({}),Lf=(p(y={},Uf.Above,{originX:"center",originY:"top",overlayX:"center",overlayY:"bottom",offsetY:-12}),p(y,Uf.Below,{originX:"center",originY:"bottom",overlayX:"center",overlayY:"top",offsetY:12}),p(y,Uf.Left,{originX:"start",originY:"center",overlayX:"end",overlayY:"center",offsetX:-12}),p(y,Uf.Right,{originX:"end",originY:"center",overlayX:"start",overlayY:"center",offsetX:12}),y),Df=((zf=function(){function e(t,n){m(this,e),this.overlay=t,this.injector=n}return v(e,[{key:"open",value:function(e){var t=e.origin,n=e.content,i=e.data,o=e.width,a=e.height,r=this.overlay.create(this.getOverlayConfig({origin:t,width:o,height:a})),c=new kf(r,n,i),s=this.createInjector(c,this.injector);return r.attach(new Of.c(Tf,null,s)),c}},{key:"createInjector",value:function(e,t){var n=new WeakMap([[kf,e]]);return new Of.e(t,n)}},{key:"getPositionStrategy",value:function(e,t){return this.overlay.position().flexibleConnectedTo(e).withPositions(this.getPositions(t))}},{key:"getOverlayConfig",value:function(e){var t=e.origin,n=e.width,i=e.height;return new wf.d({width:n,height:i,hasBackdrop:!0,backdropClass:"popup-scrim",positionStrategy:this.getOverlayPosition(t),scrollStrategy:this.overlay.scrollStrategies.reposition()})}},{key:"getOverlayPosition",value:function(e,t){return t=t||[Uf.Above,Uf.Below,Uf.Left,Uf.Right],this.overlay.position().flexibleConnectedTo(e).withPositions(this.getPositions(t)).withPush(!0)}},{key:"getPositions",value:function(e){return e.map((function(e){return Lf[e]}))}}]),e}()).\u0275fac=function(e){return new(e||zf)(_.Zb(wf.c),_.Zb(_.t))},zf.\u0275prov=_.Lb({token:zf,factory:zf.\u0275fac,providedIn:"root"}),zf),Ef=((If=function(){function e(){m(this,e)}return v(e,[{key:"transform",value:function(e,t){return Zh.normalize(""+(e||""))}}]),e}()).\u0275fac=function(e){return new(e||If)},If.\u0275pipe=_.Ob({name:"textNormalize",type:If,pure:!0}),If),Ff=function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r},Af=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Rf=["audio"],Nf=["title"],Vf=function(e){return{"view-description__story-title--large":e}};function Hf(e,t){if(1&e&&(_.Vb(0,"div",6),_.Mc(1),_.Ub()),2&e){var n=_.gc();_.lc("ngClass",_.oc(2,Vf,!n.chapterTitle)),_.Db(1),_.Oc(" ",n.storyTitle," ")}}function Bf(e,t){if(1&e&&(_.Vb(0,"span"),_.Mc(1),_.hc(2,"async"),_.Ub()),2&e){var n=_.gc();_.Db(1),_.Oc("",_.ic(2,1,n.chapterIndex$)+1,".")}}function Qf(e,t){1&e&&_.Qb(0,"app-icon",7)}var qf,Wf=function(e,t,n){return{"view-title--clickable":e,"view-title--center":t,"view-title--large":n}},$f=((qf=function(){function e(t,n,i,o){m(this,e),this.layoutService=t,this.changeDetectorRef=n,this.popupService=i,this.store=o,this._isPopulated=!1,this.isPopulatedChange=new _.p,this._menuEnabled=!0,this.viewLayout=Rp,this.ngUnsubscribe=new ge.a,this.storyTitle="",this.chapterTitle="",this.chapterAudio=null}return v(e,[{key:"isPopulated",get:function(){return this._isPopulated},set:function(e){this._isPopulated=e,this.isPopulatedChange.emit(this.isPopulated)}},{key:"menuEnabled",get:function(){return this._menuEnabled},set:function(e){this._menuEnabled=e}},{key:"ngOnInit",value:function(){this.initContentListener(),this.initLayoutListener(),this.initChapterListener()}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"isEnabled",value:function(e){return this.layoutService.isUIEnabled(e)}},{key:"initContentListener",value:function(){var e=this;Object(Ka.b)(this.story$,this.chapter$).pipe(Object(be.a)((function(e){var t=u(e,2),n=t[0];return null!=t[1]&&null!=n})),Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){var n=u(t,2),i=n[0],o=n[1];e.chapterTitle=Zh.normalize(o.info.displayName),e.storyTitle=z.application!==j.Viewer?Zh.normalize(i.displayName):"",e.chapterTitle=Zh.normalize(o.info.displayName),e.isPopulated=!!e.chapterTitle||!!e.storyTitle}))}},{key:"initLayoutListener",value:function(){var e=this;this.layout$.pipe(Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){e.changeDetectorRef.markForCheck()}))}},{key:"initChapterListener",value:function(){var e=this;this.store.select(Ua.getSelectedChapterIndex).pipe(Object(fe.a)(this.ngUnsubscribe)).subscribe((function(){e.chaptersPopup&&e.chaptersPopup.close()}))}},{key:"handleAudioPlayClick",value:function(){this.audio.playing?this.audio.pause():this.audio.play()}},{key:"handleTitleClick",value:function(){var e=this;this.menuEnabled&&(this.chaptersPopup?this.chaptersPopup.close():(this.chaptersPopup=this.popupService.open({origin:this.title.nativeElement,content:xf,width:"300px"}),this.chaptersPopup.afterClosed$.pipe(Object(fe.a)(this.ngUnsubscribe),Object(bp.a)(1)).subscribe((function(t){e.chaptersPopup=null}))))}}]),e}()).\u0275fac=function(e){return new(e||qf)(_.Pb(Vp),_.Pb(_.i),_.Pb(Df),_.Pb(L.g))},qf.\u0275cmp=_.Jb({type:qf,selectors:[["app-view-title"]],viewQuery:function(e,t){var n;1&e&&(_.Rc(Rf,!0),_.Rc(Nf,!0)),2&e&&(_.uc(n=_.dc())&&(t.audio=n.first),_.uc(n=_.dc())&&(t.title=n.first))},inputs:{size:"size",alignTitle:"alignTitle",isPopulated:"isPopulated",menuEnabled:"menuEnabled"},outputs:{isPopulatedChange:"isPopulatedChange"},features:[_.Cb([Df])],decls:11,vars:17,consts:[[1,"view-title",3,"ngClass","click"],["title",""],["class","view-title__story",3,"ngClass",4,"ngIf"],[1,"view-title__chapter"],[4,"ngIf"],["icon","caret-down",4,"ngIf"],[1,"view-title__story",3,"ngClass"],["icon","caret-down"]],template:function(e,t){1&e&&(_.Vb(0,"header",0,1),_.cc("click",(function(){return t.handleTitleClick()})),_.hc(2,"async"),_.Kc(3,Hf,2,4,"div",2),_.Vb(4,"h1",3),_.Kc(5,Bf,3,3,"span",4),_.hc(6,"async"),_.Mc(7),_.hc(8,"textNormalize"),_.Kc(9,Qf,1,0,"app-icon",5),_.hc(10,"async"),_.Ub(),_.Ub()),2&e&&(_.lc("ngClass",_.qc(13,Wf,_.ic(2,5,t.chapterCount$)>1&&t.menuEnabled,"center"===t.alignTitle,"large"===t.size)),_.Db(3),_.lc("ngIf",t.storyTitle&&t.storyTitle!=t.chapterTitle),_.Db(2),_.lc("ngIf",_.ic(6,7,t.chapterCount$)>1&&t.menuEnabled),_.Db(2),_.Oc(" ",_.ic(8,9,t.chapterTitle)," "),_.Db(2),_.lc("ngIf",_.ic(10,11,t.chapterCount$)>1&&t.menuEnabled))},directives:[or.i,or.l,Js],pipes:[or.b,Ef],styles:[".text-8{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-header{font-weight:700}.text--code{font-family:Courier New,Courier,monospace}.text-uppercase{text-transform:uppercase}.text-xlight{font-weight:200}.text-light{font-weight:300}.text-medium{font-weight:500}.text-semibold{font-weight:600}.text-bold{font-weight:700}.text-underline{text-decoration:underline}.text-italic{font-style:italic}.text-bright{color:#fff}.text-dim{color:#96a8c0}.text-error{color:#ed4758}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.text-ellipsis{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link,.text-link:visited{color:inherit;cursor:pointer}.text-link:not(.text-underline),.text-link:visited:not(.text-underline){text-decoration:none}.text-success{color:#38de38}.text-danger{color:#de3838}.text-info{color:#0060c4}.text-nowrap{white-space:nowrap}.text-pre-line{white-space:pre-line}.view-title{font-size:14px;letter-spacing:.35px;line-height:1.4em;word-wrap:break-word;overflow-wrap:break-word;border-radius:4px;padding:4px;margin:0 -4px;transition:background-color 125ms}.view-title--center{text-align:center}.view-title--large{font-size:18px;letter-spacing:.45px;line-height:1.4em}.view-title--clickable:hover{background-color:var(--view-title-background--hover);cursor:pointer}.view-title__story{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase;word-wrap:break-word;overflow-wrap:break-word;font-weight:600;color:var(--view-description-secondary-color)}.view-title__chapter{font-weight:600;color:var(--view-title-color)}"],encapsulation:2,changeDetection:0}),Ff([Object(L.d)(Rc.getStory),Af("design:type",he.a)],qf.prototype,"story$",void 0),Ff([Object(L.d)(Ua.getSelectedChapter),Af("design:type",he.a)],qf.prototype,"chapter$",void 0),Ff([Object(L.d)(Ua.getChapterCount),Af("design:type",he.a)],qf.prototype,"chapterCount$",void 0),Ff([Object(L.d)(Ua.getSelectedChapterIndex),Af("design:type",he.a)],qf.prototype,"chapterIndex$",void 0),Ff([Object(L.d)(Ua.getSelectedChapterAudio),Af("design:type",he.a)],qf.prototype,"selectedChapterAudio$",void 0),Ff([Object(L.d)(hp.getUI),Af("design:type",he.a)],qf.prototype,"layout$",void 0),qf);function Kf(e,t){if(1&e&&(_.Vb(0,"div",2),_.Vb(1,"div",3),_.Mc(2),_.Ub(),_.jc(3,1,["class","view-panel__actions","actions",""]),_.Ub()),2&e){var n=_.gc();_.Db(2),_.Oc(" ",n.label," ")}}var Gf,Zf=["*",[["","actions",""]]],Jf=function(e,t){return{"view-panel--padding-none":e,"view-panel--padding-dense":t}},Xf=["*","[actions]"],Yf=((Gf=function(){function e(){m(this,e),this.label="",this.showHeader=!0,this.padding="normal"}return v(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||Gf)},Gf.\u0275cmp=_.Jb({type:Gf,selectors:[["app-view-panel"]],inputs:{label:"label",showHeader:"showHeader",padding:"padding"},ngContentSelectors:Xf,decls:3,vars:5,consts:[[1,"view-panel",3,"ngClass"],["class","view-panel__header",4,"ngIf"],[1,"view-panel__header"],[1,"view-panel__label"]],template:function(e,t){1&e&&(_.kc(Zf),_.Vb(0,"div",0),_.Kc(1,Kf,4,1,"div",1),_.jc(2),_.Ub()),2&e&&(_.lc("ngClass",_.pc(2,Jf,"none"===t.padding,"dense"===t.padding)),_.Db(1),_.lc("ngIf",t.showHeader))},directives:[or.i,or.l],styles:[".text-8{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-header{font-weight:700}.text--code{font-family:Courier New,Courier,monospace}.text-uppercase{text-transform:uppercase}.text-xlight{font-weight:200}.text-light{font-weight:300}.text-medium{font-weight:500}.text-semibold{font-weight:600}.text-bold{font-weight:700}.text-underline{text-decoration:underline}.text-italic{font-style:italic}.text-bright{color:#fff}.text-dim{color:#96a8c0}.text-error{color:#ed4758}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.text-ellipsis{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link,.text-link:visited{color:inherit;cursor:pointer}.text-link:not(.text-underline),.text-link:visited:not(.text-underline){text-decoration:none}.text-success{color:#38de38}.text-danger{color:#de3838}.text-info{color:#0060c4}.text-nowrap{white-space:nowrap}.text-pre-line{white-space:pre-line}.view-panel{padding:0 0 32px;margin-bottom:16px;border-bottom:var(--view-panel-border)}.view-panel--padding-none{padding:0;margin:0}.view-panel--padding-dense{padding:0 0 8px;margin:0 0 8px}.view-panel__label{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase;color:var(--view-panel-color);font-weight:600;display:flex;align-items:center;min-height:28px}.view-panel__header{display:flex;flex-direction:row;align-items:flex-start;justify-content:space-between;margin-bottom:16px}"],encapsulation:2,changeDetection:0}),Gf),eb=function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r},tb=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},nb=["audio"];function ib(e,t){if(1&e&&(_.Vb(0,"div",3),_.Qb(1,"app-html",4),_.Ub()),2&e){var n=_.gc();_.Db(1),_.lc("markdownText",n.chapterDescription)}}var ob,ab=function(e,t){return{"view-description--layout-column":e,"view-description--layout-drawer":t}},rb=((ob=function(){function e(t,n,i){m(this,e),this.viewService=t,this.layoutService=n,this.changeDetectorRef=i,this.viewLayout=Rp,this.ngUnsubscribe=new ge.a,this.storyTitle="",this.chapterTitle="",this.chapterDescription="",this.chapterAudio=null,this.layout=Np.Drawer,this._isPopulated=!1,this.isPopulatedChange=new _.p}return v(e,[{key:"isPopulated",get:function(){return this._isPopulated},set:function(e){this._isPopulated=e,this.isPopulatedChange.emit(this.isPopulated)}},{key:"ngOnInit",value:function(){this.initContentListener(),this.initLayoutListener()}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"isEnabled",value:function(e){return this.layoutService.isUIEnabled(e)}},{key:"initContentListener",value:function(){var e=this;Object(Ka.b)(this.story$,this.chapter$).pipe(Object(be.a)((function(e){var t=u(e,2),n=t[0],i=t[1];return null!=n&&null!=i})),Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){var n=u(t,2),i=n[0],o=n[1];e.storyTitle=z.application!==j.Viewer?Zh.normalize(i.displayName):"",e.chapterTitle=Zh.normalize(o.info.displayName),e.chapterDescription=Object(Oe.trim)(o.info.description),e.isPopulated=""!==e.storyTitle||!!e.chapterTitle||!!e.chapterDescription}))}},{key:"initLayoutListener",value:function(){var e=this;this.layout$.pipe(Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){e.changeDetectorRef.markForCheck()}))}}]),e}()).\u0275fac=function(e){return new(e||ob)(_.Pb(Bu),_.Pb(Vp),_.Pb(_.i))},ob.\u0275cmp=_.Jb({type:ob,selectors:[["app-view-description"]],viewQuery:function(e,t){var n;1&e&&_.Rc(nb,!0),2&e&&_.uc(n=_.dc())&&(t.audio=n.first)},inputs:{layout:"layout",isPopulated:"isPopulated"},outputs:{isPopulatedChange:"isPopulatedChange"},decls:4,vars:5,consts:[[1,"view-description",3,"ngClass"],[1,"view-description__inner"],["class","view-description__body",4,"ngIf"],[1,"view-description__body"],[3,"markdownText"]],template:function(e,t){1&e&&(_.Vb(0,"div",0),_.Vb(1,"div",1),_.Vb(2,"article"),_.Kc(3,ib,2,1,"div",2),_.Ub(),_.Ub(),_.Ub()),2&e&&(_.lc("ngClass",_.pc(2,ab,"column"===t.layout,"drawer"===t.layout)),_.Db(3),_.lc("ngIf",t.chapterDescription))},directives:[or.i,or.l,Zd],styles:[".text-8{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-header{font-weight:700}.text--code{font-family:Courier New,Courier,monospace}.text-uppercase{text-transform:uppercase}.text-xlight{font-weight:200}.text-light{font-weight:300}.text-medium{font-weight:500}.text-semibold{font-weight:600}.text-bold{font-weight:700}.text-underline{text-decoration:underline}.text-italic{font-style:italic}.text-bright{color:#fff}.text-dim{color:#96a8c0}.text-error{color:#ed4758}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.text-ellipsis{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link,.text-link:visited{color:inherit;cursor:pointer}.text-link:not(.text-underline),.text-link:visited:not(.text-underline){text-decoration:none}.text-success{color:#38de38}.text-danger{color:#de3838}.text-info{color:#0060c4}.text-nowrap{white-space:nowrap}.text-pre-line{white-space:pre-line}.view-description{color:var(--view-description-primary-color);display:flex;flex-direction:column;justify-content:left}.view-description--layout-column .view-description__chapter-title{font-size:18px;letter-spacing:.45px;line-height:1.4em}.view-description--layout-column .view-description__body{padding-top:12px}.view-description--layout-drawer .view-description__story-title{text-align:center}.view-description--layout-drawer .view-description__story-title--large{font-size:14px;letter-spacing:.35px;line-height:1.4em}.view-description--layout-drawer .view-description__body{padding-top:4px}.view-description__inner{flex:1 0 auto}.view-description__story-title{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase;word-wrap:break-word;overflow-wrap:break-word;flex-grow:1;font-weight:600;color:var(--view-description-secondary-color)}.view-description__story-title--large{font-size:18px;letter-spacing:.45px;line-height:1.4em;text-transform:none}.view-description__body{font-size:14px;letter-spacing:.35px;line-height:1.4em;word-wrap:break-word;overflow-wrap:break-word;padding-top:8px;color:var(--view-description-secondary-color)}"],encapsulation:2,changeDetection:0}),eb([Object(L.d)(Rc.getStory),tb("design:type",he.a)],ob.prototype,"story$",void 0),eb([Object(L.d)(Ua.getSelectedChapter),tb("design:type",he.a)],ob.prototype,"chapter$",void 0),eb([Object(L.d)(Ua.getSelectedChapterIndex),tb("design:type",he.a)],ob.prototype,"chapterIndex$",void 0),eb([Object(L.d)(Ua.getChapterCount),tb("design:type",he.a)],ob.prototype,"chapterCount$",void 0),eb([Object(L.d)(hp.getUI),tb("design:type",he.a)],ob.prototype,"layout$",void 0),ob);function cb(e,t){if(1&e&&(_.Vb(0,"div",6),_.Mc(1),_.Ub()),2&e){var n=_.gc().$implicit;_.Db(1),_.Nc(n.description)}}function sb(e,t){if(1&e&&(_.Vb(0,"li",2),_.Qb(1,"div",3),_.Vb(2,"div",4),_.Vb(3,"div"),_.Mc(4),_.Ub(),_.Kc(5,cb,2,1,"div",5),_.Ub(),_.Ub()),2&e){var n=t.$implicit,i=_.gc();_.Db(1),_.Hc("background-color",i.getComputedColor(n.colors)),_.Db(3),_.Nc(n.label),_.Db(1),_.lc("ngIf",n.description)}}var lb,pb=((lb=function(){function e(){m(this,e)}return v(e,[{key:"ngOnInit",value:function(){}},{key:"getComputedColor",value:function(e){return ba.rgbToHex(e,!0)}}]),e}()).\u0275fac=function(e){return new(e||lb)},lb.\u0275cmp=_.Jb({type:lb,selectors:[["app-view-legend"]],inputs:{legend:"legend"},decls:2,vars:1,consts:[["aria-label","Legend",1,"view-legend"],["class","view-legend__item","tabindex","0",4,"ngFor","ngForOf"],["tabindex","0",1,"view-legend__item"],[1,"view-legend__color","mh-2"],[1,"view-legend__content","text-14"],["class","mv-2",4,"ngIf"],[1,"mv-2"]],template:function(e,t){1&e&&(_.Vb(0,"ul",0),_.Kc(1,sb,6,4,"li",1),_.Ub()),2&e&&(_.Db(1),_.lc("ngForOf",t.legend))},directives:[or.k,or.l],styles:['.view-legend{display:flex;flex-direction:column}.view-legend__item{padding:8px 0;display:flex;flex-direction:row;justify-content:flex-start;align-items:flex-start}.view-legend__content{display:flex;flex-direction:column}.view-legend__color{content:" ";display:block;flex:0 0 16px;width:16px;height:16px;border-radius:50%}.view-legend__color:after{content:" "}'],encapsulation:2,changeDetection:0}),lb),ub=function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r},db=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},gb=function(e){return{"view-labels__item--selected":e}};function hb(e,t){if(1&e){var n=_.Wb();_.Vb(0,"li",2),_.cc("click",(function(){_.zc(n);var e=t.$implicit;return _.gc().handleLabelClick(e)}))("keyup.enter",(function(){_.zc(n);var e=t.$implicit;return _.gc().handleLabelClick(e)})),_.hc(1,"async"),_.Vb(2,"div",3),_.Vb(3,"div",4),_.Qb(4,"app-label-pin",5),_.Ub(),_.Ub(),_.Vb(5,"div",6),_.Qb(6,"div",7),_.hc(7,"markdown"),_.Ub(),_.Ub()}if(2&e){var i,o=t.$implicit,a=_.gc();_.lc("ngClass",_.oc(8,gb,(null==(i=_.ic(1,4,a.selectedLabel$))?null:i.id)===o.id)),_.Eb("aria-label",o.title),_.Db(4),_.lc("label",o),_.Db(2),_.lc("innerHTML",_.ic(7,6,o.title),_.Ac)}}var fb,bb=((fb=function(){function e(t,n){m(this,e),this.viewService=t,this.store=n,this.labelPinType=Jn,this.labelSequentialtype=Yn}return v(e,[{key:"ngOnInit",value:function(){}},{key:"getLabelSequence",value:function(e){return this.store.selectSnapshot(Pc.getLabelSequence(e))}},{key:"handleLabelClick",value:function(e){this.viewService.selectLabel(e,!0)}}]),e}()).\u0275fac=function(e){return new(e||fb)(_.Pb(Bu),_.Pb(L.g))},fb.\u0275cmp=_.Jb({type:fb,selectors:[["app-view-labels"]],decls:3,vars:3,consts:[["role","complementary","aria-label","Labels",1,"view-labels"],["role","button","class","view-labels__item","tabindex","0",3,"ngClass","click","keyup.enter",4,"ngFor","ngForOf"],["role","button","tabindex","0",1,"view-labels__item",3,"ngClass","click","keyup.enter"],[1,"view-labels__pre"],[1,"view-labels__pin"],[3,"label"],[1,"view-labels__body"],[1,"view-labels__title","html",3,"innerHTML"]],template:function(e,t){1&e&&(_.Vb(0,"ul",0),_.Kc(1,hb,8,10,"li",1),_.hc(2,"async"),_.Ub()),2&e&&(_.Db(1),_.lc("ngForOf",_.ic(2,1,t.labels$)))},directives:[or.k,or.i,od],pipes:[or.b,Od.b],styles:[".text-8{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-header{font-weight:700}.text--code{font-family:Courier New,Courier,monospace}.text-uppercase{text-transform:uppercase}.text-xlight{font-weight:200}.text-light{font-weight:300}.text-medium{font-weight:500}.text-semibold{font-weight:600}.text-bold{font-weight:700}.text-underline{text-decoration:underline}.text-italic{font-style:italic}.text-bright{color:#fff}.text-dim{color:#96a8c0}.text-error{color:#ed4758}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.text-ellipsis{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link,.text-link:visited{color:inherit;cursor:pointer}.text-link:not(.text-underline),.text-link:visited:not(.text-underline){text-decoration:none}.text-success{color:#38de38}.text-danger{color:#de3838}.text-info{color:#0060c4}.text-nowrap{white-space:nowrap}.text-pre-line{white-space:pre-line}.view-labels__item{border-left:4px solid transparent;border-left:var(--view-labels-border);border-radius:2px;display:flex;padding:12px 8px;margin-bottom:4px;cursor:pointer;transition:background-color 125ms,color 125ms,border 125ms}.view-labels__item:focus{background:#f1f4fa;outline:none}.view-labels__item:hover{background:#f1f5fc;background:var(--view-labels-bg--hover)}.view-labels__item--selected{background:#f1f5fc;border-left:4px solid #2d72dc;background:var(--view-labels-bg--selected);border-left:var(--view-labels-border--selected)}.view-labels__pre{flex:0 0 32px;display:flex;justify-content:center;position:relative}.view-labels__pin{display:flex;align-items:center;justify-content:center;position:absolute}.view-labels__description,.view-labels__title{font-size:14px;letter-spacing:.35px;line-height:1.4em}.view-labels__description{color:#374a68;color:var(--view-labels-description-color);padding-top:4px}.view-labels__label{position:absolute;font-size:10px;top:3px}"],encapsulation:2,changeDetection:0}),ub([Object(L.d)(Pc.getChapterLabels),db("design:type",he.a)],fb.prototype,"labels$",void 0),ub([Object(L.d)(Pc.getSelectedLabel),db("design:type",he.a)],fb.prototype,"selectedLabel$",void 0),fb),vb=function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r},mb=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function yb(e,t){if(1&e&&(_.Vb(0,"div"),_.Qb(1,"app-content-blocks",7),_.hc(2,"async"),_.Ub()),2&e){var n=_.gc(2);_.Db(1),_.lc("contentBlocks",_.ic(2,2,n.contentBlocks$))("include",n.contentBlockTypes.Ticker)}}function xb(e,t){if(1&e&&(_.Vb(0,"div"),_.Qb(1,"app-content-blocks",8),_.hc(2,"async"),_.Ub()),2&e){var n=_.gc(2);_.Db(1),_.lc("contentBlocks",_.ic(2,2,n.contentBlocks$))("exclude",n.contentBlockTypes.Ticker)}}function wb(e,t){if(1&e){var n=_.Wb();_.Vb(0,"app-view-panel",4),_.Kc(1,yb,3,4,"div",5),_.hc(2,"async"),_.Vb(3,"app-view-description",6),_.cc("isPopulatedChange",(function(e){return _.zc(n),_.gc().isPopulated=e})),_.Ub(),_.Kc(4,xb,3,4,"div",5),_.hc(5,"async"),_.Ub()}if(2&e){var i,o,a=_.gc();_.lc("showHeader",!1)("hidden",!a.isPopulated),_.Db(1),_.lc("ngIf",(null==(i=_.ic(2,6,a.contentBlocks$))?null:i.length)>0),_.Db(2),_.lc("isPopulated",a.isPopulated)("layout",a.layout),_.Db(1),_.lc("ngIf",(null==(o=_.ic(5,8,a.contentBlocks$))?null:o.length)>0)}}function kb(e,t){if(1&e&&(_.Vb(0,"app-view-panel",9),_.Qb(1,"app-view-legend",10),_.hc(2,"async"),_.Ub()),2&e){var n=_.gc();_.Db(1),_.lc("legend",_.ic(2,1,n.chapter$).legend)}}function Ob(e,t){if(1&e){var n=_.Wb();_.Vb(0,"div",13),_.Vb(1,"button",14),_.cc("click",(function(){return _.zc(n),_.gc(2).handlePrevClick()})),_.Ub(),_.Vb(2,"button",15),_.cc("click",(function(){return _.zc(n),_.gc(2).handleNextClick()})),_.Ub(),_.Ub()}}function Cb(e,t){if(1&e&&(_.Vb(0,"app-view-panel",11),_.Kc(1,Ob,3,0,"div",12),_.hc(2,"async"),_.Qb(3,"app-view-labels"),_.Ub()),2&e){var n,i=_.gc();_.Db(1),_.lc("ngIf",(null==(n=_.ic(2,1,i.labels$))?null:n.length)>1)}}var Sb,_b=((Sb=function(){function e(t,n,i,o){m(this,e),this.store=t,this.viewService=n,this.layoutService=i,this.changeDetectorRef=o,this.ngUnsubscribe=new ge.a,this.layout=Np.Column,this.viewLayout=Rp,this.isPopulated=!0,this.descriptionVisible=!1,this.legendVisible=!1,this.labelListVisible=!1,this.contentBlockTypes=ro}return v(e,[{key:"ngOnInit",value:function(){var e=this;this.store.select(hp.getUI).pipe(Object(fe.a)(this.ngUnsubscribe)).subscribe((function(){e.descriptionVisible=e.isVisible(Rp.Description),e.legendVisible=e.isVisible(Rp.Legend),e.labelListVisible=e.isVisible(Rp.LabelList),e.changeDetectorRef.markForCheck()}))}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"isVisible",value:function(e){return this.layoutService.isUIVisible(e)}},{key:"isEnabled",value:function(e){return this.layoutService.isUIEnabled(e)}},{key:"handlePrevClick",value:function(){this.selectLabel(-1)}},{key:"handleNextClick",value:function(){this.selectLabel(1)}},{key:"selectLabel",value:function(e){var t=this.store.selectSnapshot(Pc.getChapterLabels),n=t.length,i=this.store.selectSnapshot(Pc.getSelectedLabelId),o=t.findIndex((function(e){return e.id===i})),a=t[((-1!==o?o+e:0)%n+n)%n];a&&this.viewService.selectLabel(a,!0)}}]),e}()).\u0275fac=function(e){return new(e||Sb)(_.Pb(L.g),_.Pb(Bu),_.Pb(Vp),_.Pb(_.i))},Sb.\u0275cmp=_.Jb({type:Sb,selectors:[["app-view-content-mode"]],inputs:{layout:"layout"},decls:7,vars:9,consts:[["gaCategory","View Information Panel",1,"view-content-mode"],[3,"showHeader","hidden",4,"ngIf"],["label","Legend",4,"ngIf"],["label","Labels",4,"ngIf"],[3,"showHeader","hidden"],[4,"ngIf"],[3,"isPopulated","layout","isPopulatedChange"],[3,"contentBlocks","include"],[3,"contentBlocks","exclude"],["label","Legend"],[3,"legend"],["label","Labels"],["actions","","class","flex",4,"ngIf"],["actions","",1,"flex"],["gaEvent","","gaAction","Clicked Previous Label","app-pin-button","","icon","chevron-left","size","small","buttonType","ghost","matTooltip","Previous Label",3,"click"],["gaEvent","","gaAction","Clicked Next Label","app-pin-button","","icon","chevron-right","size","small","buttonType","ghost","matTooltip","Next Label",3,"click"]],template:function(e,t){if(1&e&&(_.Vb(0,"div",0),_.Kc(1,wb,6,10,"app-view-panel",1),_.Kc(2,kb,3,3,"app-view-panel",2),_.hc(3,"async"),_.hc(4,"async"),_.Kc(5,Cb,4,3,"app-view-panel",3),_.hc(6,"async"),_.Ub()),2&e){var n,i=null;_.Db(1),_.lc("ngIf",t.descriptionVisible),_.Db(1),_.lc("ngIf",(null==(i=_.ic(3,3,t.chapter$))?null:i.legend)&&(null==(i=_.ic(4,5,t.chapter$))?null:i.legend.length)>0&&t.legendVisible),_.Db(3),_.lc("ngIf",(null==(n=_.ic(6,7,t.labels$))?null:n.length)&&t.labelListVisible)}},directives:[ke.a,or.l,Yf,rb,Ug,pb,bb,ag,ke.b,rg.c],pipes:[or.b],styles:[".view-content-mode[_ngcontent-%COMP%]{padding-bottom:24px}"],changeDetection:0}),vb([Object(L.d)(Ua.getStoryChapters),mb("design:type",he.a)],Sb.prototype,"chapters$",void 0),vb([Object(L.d)(Ua.getSelectedChapter),mb("design:type",he.a)],Sb.prototype,"chapter$",void 0),vb([Object(L.d)(Ua.getSelectedChapterContentBlocks),mb("design:type",he.a)],Sb.prototype,"contentBlocks$",void 0),vb([Object(L.d)(Pc.getChapterLabels),mb("design:type",he.a)],Sb.prototype,"labels$",void 0),Sb);function jb(e,t){if(1&e&&(_.Vb(0,"span"),_.Mc(1),_.Ub()),2&e){var n=_.gc();_.Db(1),_.Oc(" of ",n.total,"")}}var Pb,Mb,Ib,zb=((Pb=function(){function e(){m(this,e),this.index=0,this.total=0}return v(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||Pb)},Pb.\u0275cmp=_.Jb({type:Pb,selectors:[["app-view-quiz-progress"]],inputs:{index:"index",total:"total"},decls:4,vars:2,consts:[["data-test","quizProgress",1,"view-quiz-progress"],[1,"text-semibold"],[4,"ngIf"]],template:function(e,t){1&e&&(_.Vb(0,"div",0),_.Vb(1,"span",1),_.Mc(2),_.Ub(),_.Kc(3,jb,2,1,"span",2),_.Ub()),2&e&&(_.Db(2),_.Oc("Question ",t.index+1,""),_.Db(1),_.lc("ngIf",t.total>1))},directives:[or.l],styles:[".text-8[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase[_ngcontent-%COMP%]{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase[_ngcontent-%COMP%]{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase[_ngcontent-%COMP%]{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase[_ngcontent-%COMP%]{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-header[_ngcontent-%COMP%]{font-weight:700}.text--code[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.text-xlight[_ngcontent-%COMP%]{font-weight:200}.text-light[_ngcontent-%COMP%]{font-weight:300}.text-medium[_ngcontent-%COMP%]{font-weight:500}.text-semibold[_ngcontent-%COMP%]{font-weight:600}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-underline[_ngcontent-%COMP%]{text-decoration:underline}.text-italic[_ngcontent-%COMP%]{font-style:italic}.text-bright[_ngcontent-%COMP%]{color:#fff}.text-dim[_ngcontent-%COMP%]{color:#96a8c0}.text-error[_ngcontent-%COMP%]{color:#ed4758}.text-left[_ngcontent-%COMP%]{text-align:left}.text-center[_ngcontent-%COMP%]{text-align:center}.text-right[_ngcontent-%COMP%]{text-align:right}.text-ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link[_ngcontent-%COMP%], .text-link[_ngcontent-%COMP%]:visited{color:inherit;cursor:pointer}.text-link[_ngcontent-%COMP%]:not(.text-underline), .text-link[_ngcontent-%COMP%]:visited:not(.text-underline){text-decoration:none}.text-success[_ngcontent-%COMP%]{color:#38de38}.text-danger[_ngcontent-%COMP%]{color:#de3838}.text-info[_ngcontent-%COMP%]{color:#0060c4}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.text-pre-line[_ngcontent-%COMP%]{white-space:pre-line}.view-quiz-progress[_ngcontent-%COMP%]{color:#374a68;font-size:12px;letter-spacing:.3px;line-height:1.4em}"],changeDetection:0}),Pb),Tb=h("QibW"),Ub=[[["app-list-item"]]],Lb=["app-list-item"],Db=function(e){return e.Default="default",e.Commafied="commafied",e.flat="flat",e.inline="inline",e}({}),Eb=((Mb=function(){function e(){m(this,e),this.listType=Db.Default}return v(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||Mb)},Mb.\u0275cmp=_.Jb({type:Mb,selectors:[["app-list"]],inputs:{listType:"listType"},ngContentSelectors:Lb,decls:2,vars:1,consts:[[1,"list",3,"ngClass"]],template:function(e,t){1&e&&(_.kc(Ub),_.Vb(0,"div",0),_.jc(1),_.Ub()),2&e&&_.lc("ngClass","list--"+t.listType)},directives:[or.i],styles:['.list{display:flex;flex-direction:column}.list--default app-list-item{display:list-item;margin-left:16px;list-style-type:disc}.list--commafied{align-items:center;display:flex;flex-direction:row;flex-wrap:wrap;padding:0 4px 4px 0}.list--commafied app-list-item:not(:last-child):after{content:", ";float:right;padding-right:4px}.list--flat app-list-item:not(:last-child){margin-bottom:4px}.list--inline{display:inline-flex;align-items:center;display:flex;flex-direction:row;flex-wrap:wrap}.list--inline app-list-item{margin:0 8px 4px 0}.list__item{display:block}'],encapsulation:2,changeDetection:0}),Mb),Fb=["*"],Ab=((Ib=function(){function e(){m(this,e)}return v(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||Ib)},Ib.\u0275cmp=_.Jb({type:Ib,selectors:[["app-list-item"]],ngContentSelectors:Fb,decls:1,vars:0,template:function(e,t){1&e&&(_.kc(),_.jc(0))},styles:[""],encapsulation:2,changeDetection:0}),Ib);function Rb(e,t){if(1&e&&(_.Vb(0,"app-list-item"),_.Vb(1,"div",1),_.Mc(2),_.Ub(),_.Ub()),2&e){var n=t.$implicit;_.Db(1),_.Eb("data-id",n.id),_.Db(1),_.Nc(n.label)}}var Nb,Vb,Hb=((Vb=function(){function e(t,n,i){m(this,e),this.store=t,this.graphService=n,this.changeRef=i}return v(e,[{key:"objectIds",get:function(){return this._objectIds},set:function(e){this._objectIds=e;var t=this.store.selectSnapshot(qa.getViewGraph);this.nodes=this.graphService.getNodes(t,e),this.changeRef.markForCheck()}},{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||Vb)(_.Pb(L.g),_.Pb(St),_.Pb(_.i))},Vb.\u0275cmp=_.Jb({type:Vb,selectors:[["app-view-quiz-object-tree"]],inputs:{objectIds:"objectIds"},decls:2,vars:1,consts:[[4,"ngFor","ngForOf"],[1,"text-14","text-medium","mv-1"]],template:function(e,t){1&e&&(_.Vb(0,"app-list"),_.Kc(1,Rb,3,2,"app-list-item",0),_.Ub()),2&e&&(_.Db(1),_.lc("ngForOf",t.nodes))},directives:[Eb,or.k,Ab],styles:[""],changeDetection:0}),Vb),Bb=((Nb=function(){function e(){m(this,e)}return v(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||Nb)},Nb.\u0275cmp=_.Jb({type:Nb,selectors:[["app-view-quiz-answer-number"]],inputs:{number:"number"},decls:3,vars:1,consts:[[1,"number","text-10","text-medium"]],template:function(e,t){1&e&&(_.Vb(0,"div",0),_.Vb(1,"div"),_.Mc(2),_.Ub(),_.Ub()),2&e&&(_.Db(2),_.Nc(t.number))},styles:[".number[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:20px;height:20px;color:#131c2a;border:1px solid rgba(55,74,104,.5);border-radius:50%}"],changeDetection:0}),Nb),Qb=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function qb(e,t){if(1&e&&(_.Vb(0,"div",3),_.Vb(1,"div",4),_.Qb(2,"app-view-quiz-answer-number",5),_.Ub(),_.Vb(3,"div",6),_.Qb(4,"app-quiz-label-anatomy-select",7),_.Ub(),_.Ub()),2&e){var n=t.index,i=_.gc();_.Db(2),_.lc("number",n+1),_.Db(2),_.lc("options",i.options)("formControlName",n)}}var Wb,$b=((Wb=function(){function e(t){m(this,e),this.formBuilder=t,this.valueChange=new _.p,this.ngUnsubscribe=new ge.a,this._options=[],this.form=this.formBuilder.group({options:this.formBuilder.array([])}),this.optionsArray=this.form.get("options")}return v(e,[{key:"options",get:function(){return this._options},set:function(e){Object(Oe.isEqual)(e,this._options)||(this._options=e,this.buildFormOptions(e))}},{key:"ngOnInit",value:function(){this.initFormListeners(),this.init()}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"initFormListeners",value:function(){var e=this;this.form.valueChanges.pipe(Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){var n=t.options;e.valueChange.next(n)}))}},{key:"init",value:function(){var e=this;this.activeSubmission$.pipe(Object(be.a)((function(e){return!Object(Oe.isNil)(e)&&!Object(Oe.isNil)(e.answer)})),Object(er.a)(),Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){var n=u(t,2),i=n[0],o=n[1],a=function(e,t,n){var i=t.findIndex((function(t,n){var i=e[n];return!Object(Oe.isEqual)(i,t)})),o=t[i];return t.map((function(e,t){return Object(Oe.isEqual)(o,e)&&t!==i?"":e}))}(i.answer||[],o.answer||[]);Object(Oe.isEqual)(o,a)||e.form.patchValue({options:a||[]})})),this.activeSubmission$.pipe(Object(be.a)((function(e){return!Object(Oe.isNil)(e)&&!Object(Oe.isNil)(e.answer)&&Array.isArray(e.answer)})),Object(Ja.a)((function(e,t){return Object(Oe.isEqual)(e,t)})),Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){var n=e.form.value.options,i=t.answer;Object(Oe.isEqual)(n,i)||e.form.patchValue({options:i},{emitEvent:!1,onlySelf:!0})}))}},{key:"buildFormOptions",value:function(e){var t=this;this.optionsArray.clear(),e.forEach((function(){t.optionsArray.push(t.formBuilder.control(""))})),this.optionsArray.setValue(e.map((function(){return""})))}}]),e}()).\u0275fac=function(e){return new(e||Wb)(_.Pb(Hg.d))},Wb.\u0275cmp=_.Jb({type:Wb,selectors:[["app-view-quiz-label-anatomy"]],inputs:{options:"options"},outputs:{valueChange:"valueChange"},decls:3,vars:2,consts:[[1,"options",3,"formGroup"],["formArrayName","options"],["class","options__item mb-4","data-test","questionAnswer",4,"ngFor","ngForOf"],["data-test","questionAnswer",1,"options__item","mb-4"],[1,"mr-2"],[3,"number"],[1,"options__item-select"],[3,"options","formControlName"]],template:function(e,t){1&e&&(_.Vb(0,"div",0),_.Vb(1,"div",1),_.Kc(2,qb,5,3,"div",2),_.Ub(),_.Ub()),2&e&&(_.lc("formGroup",t.form),_.Db(2),_.lc("ngForOf",t.options))},directives:[Hg.n,Hg.h,Hg.c,or.k,Bb,Kg,Hg.m,Hg.g],styles:[".options__item[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center}.options__item-select[_ngcontent-%COMP%]{border:1px solid #96a8c0;border-radius:4px;flex:1 1 auto}"],changeDetection:0}),function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);a>3&&r&&Object.defineProperty(t,n,r)}([Object(L.d)(So.getActiveSubmission),Qb("design:type",he.a)],Wb.prototype,"activeSubmission$",void 0),Wb),Kb=function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r},Gb=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function Zb(e,t){if(1&e&&(_.Vb(0,"mat-radio-button",8),_.Mc(1),_.Ub()),2&e){var n=t.$implicit;_.lc("value",n.value),_.Db(1),_.Oc(" ",n.label," ")}}function Jb(e,t){if(1&e){var n=_.Wb();_.Vb(0,"div"),_.Vb(1,"mat-radio-group",6),_.cc("change",(function(e){return _.zc(n),_.gc(2).handleMultipleChoiceChange(e)})),_.Kc(2,Zb,2,2,"mat-radio-button",7),_.Ub(),_.Ub()}if(2&e){var i=_.gc(2);_.Db(2),_.lc("ngForOf",i.question.data.options)}}function Xb(e,t){if(1&e&&(_.Vb(0,"div",10),_.Qb(1,"app-view-quiz-object-tree",11),_.Ub()),2&e){var n=_.gc(3);_.Db(1),_.lc("objectIds",n.question.data.correctAnswer)}}function Yb(e,t){if(1&e&&(_.Vb(0,"div"),_.Kc(1,Xb,2,1,"div",9),_.Ub()),2&e){var n=_.gc(2);_.Db(1),_.lc("ngIf",n.question.data.showAnswerList)}}function ev(e,t){if(1&e){var n=_.Wb();_.Vb(0,"div"),_.Vb(1,"app-view-quiz-label-anatomy",12),_.cc("valueChange",(function(e){return _.zc(n),_.gc(2).handleLabelAnatomyChanges(e)})),_.Ub(),_.Ub()}if(2&e){var i=_.gc(2);_.Db(1),_.lc("options",i.question.data.options)}}function tv(e,t){if(1&e&&(_.Vb(0,"div",1),_.Vb(1,"div",2),_.Qb(2,"app-content-blocks",3),_.Ub(),_.Vb(3,"div",4),_.Kc(4,Jb,3,1,"div",5),_.Kc(5,Yb,2,1,"div",5),_.Kc(6,ev,2,1,"div",5),_.Ub(),_.Ub()),2&e){var n=_.gc();_.Db(2),_.lc("contentBlocks",n.question.questionPrompt),_.Db(1),_.lc("ngSwitch",n.question.type),_.Db(1),_.lc("ngSwitchCase",n.QuestionType.MultipleChoice),_.Db(1),_.lc("ngSwitchCase",n.QuestionType.SelectAnatomy),_.Db(1),_.lc("ngSwitchCase",n.QuestionType.LabelAnatomy)}}var nv,iv=((nv=function(){function e(t){m(this,e),this.changeRef=t,this.disabled=!1,this.QuestionType=co,this.ngUnsubscribe=new ge.a}return v(e,[{key:"question",get:function(){return this._question},set:function(e){this._question=e,this.initQuestionListeners()}},{key:"value",get:function(){return this._value},set:function(e){this._value=e,this.onChange(e)}},{key:"handleMultipleChoiceChange",value:function(e){this.writeValue(e.value)}},{key:"handleLabelAnatomyChanges",value:function(e){this.writeValue(e)}},{key:"ngOnInit",value:function(){}},{key:"initQuestionListeners",value:function(){switch(this.question.type){case co.SelectAnatomy:this.initSelectAnatomyListeners();break;case co.Instructions:this.initInstructions()}}},{key:"initSelectAnatomyListeners",value:function(){var e=this;this.checkedNodesIds$.pipe(Object(Ja.a)((function(e,t){return Object(Oe.isEqual)(e,t)})),Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){e.writeValue(t),e.changeRef.markForCheck()}))}},{key:"initInstructions",value:function(){var e=this;setTimeout((function(){e.writeValue("-"),e.changeRef.markForCheck()}))}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"onChange",value:function(e){}},{key:"onTouched",value:function(){}},{key:"registerOnTouched",value:function(e){this.onTouched=e}},{key:"registerOnChange",value:function(e){this.onChange=e}},{key:"writeValue",value:function(e){this.value=e}},{key:"setDisabledState",value:function(e){this.disabled=e}}]),e}()).\u0275fac=function(e){return new(e||nv)(_.Pb(_.i))},nv.\u0275cmp=_.Jb({type:nv,selectors:[["app-view-quiz-question"]],inputs:{question:"question",value:"value"},features:[_.Cb([{provide:Hg.k,useExisting:Object(_.W)((function(){return nv})),multi:!0}])],decls:1,vars:1,consts:[["class","view-quiz-question text-14 mb-8","data-test","question",4,"ngIf"],["data-test","question",1,"view-quiz-question","text-14","mb-8"],["data-test","questionPrompt",1,"view-quiz-question__prompt","mb-4"],[3,"contentBlocks"],[3,"ngSwitch"],[4,"ngSwitchCase"],[1,"flex","flex-column",3,"change"],["data-test","questionAnswer","class","view-quiz-question__option",3,"value",4,"ngFor","ngForOf"],["data-test","questionAnswer",1,"view-quiz-question__option",3,"value"],["class","ml-3",4,"ngIf"],[1,"ml-3"],[3,"objectIds"],[3,"options","valueChange"]],template:function(e,t){1&e&&_.Kc(0,tv,7,5,"div",0),2&e&&_.lc("ngIf",t.question)},directives:[or.l,Ug,or.n,or.o,Tb.b,or.k,Tb.a,Hb,$b],styles:[".text-8{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-header{font-weight:700}.text--code{font-family:Courier New,Courier,monospace}.text-uppercase{text-transform:uppercase}.text-xlight{font-weight:200}.text-light{font-weight:300}.text-medium{font-weight:500}.text-semibold{font-weight:600}.text-bold{font-weight:700}.text-underline{text-decoration:underline}.text-italic{font-style:italic}.text-bright{color:#fff}.text-dim{color:#96a8c0}.text-error{color:#ed4758}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.text-ellipsis{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link,.text-link:visited{color:inherit;cursor:pointer}.text-link:not(.text-underline),.text-link:visited:not(.text-underline){text-decoration:none}.text-success{color:#38de38}.text-danger{color:#de3838}.text-info{color:#0060c4}.text-nowrap{white-space:nowrap}.text-pre-line{white-space:pre-line}.view-quiz-question__option{font-size:14px;letter-spacing:.35px;line-height:1.4em;padding:12px 0 12px 12px}.view-quiz-question__option,.view-quiz-question__option>*{white-space:normal!important}.view-quiz-question__option .mat-radio-label{align-items:flex-start!important}.view-quiz-question__option .mat-radio-label-content{padding-left:12px!important}"],encapsulation:2,changeDetection:0}),Kb([Object(L.d)(Fi.getCheckedNodeIds),Gb("design:type",he.a)],nv.prototype,"checkedNodesIds$",void 0),Kb([Object(L.d)(So.getActiveSubmission),Gb("design:type",he.a)],nv.prototype,"activeSubmission$",void 0),nv);function ov(e,t){1&e&&_.Qb(0,"app-icon",6)}function av(e,t){1&e&&_.Qb(0,"app-icon",7)}function rv(e,t){1&e&&(_.Vb(0,"span",8),_.Qb(1,"span",9),_.Ub())}var cv,sv=["*"],lv=((cv=function(){function e(){m(this,e)}return v(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||cv)},cv.\u0275cmp=_.Jb({type:cv,selectors:[["app-view-quiz-answer-option"]],inputs:{correct:"correct"},ngContentSelectors:sv,decls:7,vars:7,consts:[["data-test","answerOptionContainer",1,"option"],[1,"flex","relative",3,"ngSwitch"],["class","option__icon option__icon--correct","style","font-size: 20px","icon","check-circle",4,"ngSwitchCase"],["class","option__icon option__icon--incorrect","style","font-size: 20px","icon","times-circle",4,"ngSwitchCase"],["class","option__icon",4,"ngSwitchDefault"],[1,"pl-2"],["icon","check-circle",1,"option__icon","option__icon--correct",2,"font-size","20px"],["icon","times-circle",1,"option__icon","option__icon--incorrect",2,"font-size","20px"],[1,"option__icon"],[1,"mat-radio-outer-circle"]],template:function(e,t){1&e&&(_.kc(),_.Vb(0,"div",0),_.Vb(1,"div",1),_.Kc(2,ov,1,0,"app-icon",2),_.Kc(3,av,1,0,"app-icon",3),_.Kc(4,rv,2,0,"span",4),_.Vb(5,"div",5),_.jc(6),_.Ub(),_.Ub(),_.Ub()),2&e&&(_.Hb("option--correct",!0===t.correct)("option--incorrect",!1===t.correct),_.Db(1),_.lc("ngSwitch",t.correct),_.Db(1),_.lc("ngSwitchCase",!0),_.Db(1),_.lc("ngSwitchCase",!1))},directives:[or.n,or.o,or.p,Js],styles:[".text-8[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase[_ngcontent-%COMP%]{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase[_ngcontent-%COMP%]{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase[_ngcontent-%COMP%]{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase[_ngcontent-%COMP%]{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-header[_ngcontent-%COMP%]{font-weight:700}.text--code[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.text-xlight[_ngcontent-%COMP%]{font-weight:200}.text-light[_ngcontent-%COMP%]{font-weight:300}.text-medium[_ngcontent-%COMP%]{font-weight:500}.text-semibold[_ngcontent-%COMP%]{font-weight:600}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-underline[_ngcontent-%COMP%]{text-decoration:underline}.text-italic[_ngcontent-%COMP%]{font-style:italic}.text-bright[_ngcontent-%COMP%]{color:#fff}.text-dim[_ngcontent-%COMP%]{color:#96a8c0}.text-error[_ngcontent-%COMP%]{color:#ed4758}.text-left[_ngcontent-%COMP%]{text-align:left}.text-center[_ngcontent-%COMP%]{text-align:center}.text-right[_ngcontent-%COMP%]{text-align:right}.text-ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link[_ngcontent-%COMP%], .text-link[_ngcontent-%COMP%]:visited{color:inherit;cursor:pointer}.text-link[_ngcontent-%COMP%]:not(.text-underline), .text-link[_ngcontent-%COMP%]:visited:not(.text-underline){text-decoration:none}.text-success[_ngcontent-%COMP%]{color:#38de38}.text-danger[_ngcontent-%COMP%]{color:#de3838}.text-info[_ngcontent-%COMP%]{color:#0060c4}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.text-pre-line[_ngcontent-%COMP%]{white-space:pre-line}.option[_ngcontent-%COMP%]{padding:12px;border-radius:4px;margin-bottom:8px;color:#131c2a}.option--correct[_ngcontent-%COMP%]{border:1px solid #73b676;background-color:#eaf8ec}.option--incorrect[_ngcontent-%COMP%]{border:1px solid #cb4039;background-color:#f6dada}.option__icon[_ngcontent-%COMP%]{position:relative;flex:0 0 20px;justify-content:center}.option__icon--correct[_ngcontent-%COMP%]{color:#73b676}.option__icon--incorrect[_ngcontent-%COMP%]{color:#cb4039}"],changeDetection:0}),cv);function pv(e,t){if(1&e&&(_.Vb(0,"div"),_.Vb(1,"app-view-quiz-answer-option",1),_.Vb(2,"div",2),_.Mc(3),_.Ub(),_.Ub(),_.Ub()),2&e){var n=t.$implicit,i=_.gc();_.Db(1),_.lc("correct",i.isOptionAnswerCorrect(i.question,n.value,i.answer)),_.Db(2),_.Oc(" ",n.label," ")}}var uv,dv=((uv=function(){function e(){m(this,e)}return v(e,[{key:"ngOnInit",value:function(){}},{key:"isOptionAnswerCorrect",value:function(e,t,n){var i=po(e,[t]);return t===n[0]||i?i:void 0}}]),e}()).\u0275fac=function(e){return new(e||uv)},uv.\u0275cmp=_.Jb({type:uv,selectors:[["app-view-quiz-multiple-choice-answer"]],inputs:{question:"question",answer:"answer",summary:"summary"},decls:1,vars:1,consts:[[4,"ngFor","ngForOf"],[3,"correct"],[1,"text-semibold"]],template:function(e,t){1&e&&_.Kc(0,pv,4,2,"div",0),2&e&&_.lc("ngForOf",t.question.data.options)},directives:[or.k,lv],styles:[""],changeDetection:0}),uv);function gv(e,t){if(1&e){var n=_.Wb();_.Vb(0,"div",7),_.Vb(1,"button",8),_.cc("click",(function(){_.zc(n);var e=_.gc();return e.handleSelectedObjectsClick(e.answer)})),_.Mc(2,"Highlight My Answer"),_.Ub(),_.Vb(3,"button",9),_.cc("click",(function(){_.zc(n);var e=_.gc();return e.handleCorrectObjectsClick(e.question.data.correctAnswer)})),_.Mc(4,"Highlight Correct Answer"),_.Ub(),_.Ub()}}var hv,fv=((hv=function(){function e(t){m(this,e),this.store=t}return v(e,[{key:"isCorrect",get:function(){return po(this.question,this.answer)}},{key:"ngOnInit",value:function(){}},{key:"handleSelectedObjectsClick",value:function(e){this.setSelectedObjects(e)}},{key:"handleCorrectObjectsClick",value:function(e){this.setSelectedObjects(e)}},{key:"setSelectedObjects",value:function(e){var t=e.filter((function(e){return e&&""!==e}));this.store.dispatch(new pi.UpdateNodesChecked(!1)),this.store.dispatch(new pi.UpdateNodesChecked(!0,t))}}]),e}()).\u0275fac=function(e){return new(e||hv)(_.Pb(L.g))},hv.\u0275cmp=_.Jb({type:hv,selectors:[["app-view-quiz-select-anatomy-answer"]],inputs:{question:"question",answer:"answer",summary:"summary"},decls:11,vars:5,consts:[[1,"mb-8","ml-3"],[3,"objectIds"],[3,"correct"],["selectAnatomyAnswer",""],[1,"flex","flex-column","text-semibold"],[1,"mt-2","ml-2"],["class","mt-4",4,"ngIf"],[1,"mt-4"],["buttonType","outline","buttonTheme","light","app-button","","data-test","highlightUserAnswers",1,"w-100","mv-2",3,"click"],["buttonType","outline","buttonTheme","light","app-button","","data-test","highlightCorrectAnswers",1,"w-100","mv-2",3,"click"]],template:function(e,t){if(1&e&&(_.Vb(0,"div"),_.Vb(1,"div",0),_.Qb(2,"app-view-quiz-object-tree",1),_.Ub(),_.Vb(3,"app-view-quiz-answer-option",2,3),_.Vb(5,"div",4),_.Vb(6,"div"),_.Mc(7),_.Ub(),_.Vb(8,"div",5),_.Qb(9,"app-view-quiz-object-tree",1),_.Ub(),_.Ub(),_.Ub(),_.Kc(10,gv,5,0,"div",6),_.Ub()),2&e){var n=_.vc(4);_.Db(2),_.lc("objectIds",t.question.data.correctAnswer),_.Db(1),_.lc("correct",t.isCorrect),_.Db(4),_.Oc(" ",n.correct?"Correct":"Incorrect","! You selected: "),_.Db(2),_.lc("objectIds",t.answer),_.Db(1),_.lc("ngIf",!t.summary&&!t.isCorrect)}},directives:[Hb,lv,or.l,sl],styles:[""],changeDetection:0}),hv);function bv(e,t){if(1&e&&(_.Vb(0,"div",9),_.Mc(1),_.Ub()),2&e){var n=_.gc().$implicit;_.Db(1),_.Oc(" ",n.label.title," ")}}function vv(e,t){if(1&e&&(_.Vb(0,"div"),_.Mc(1," You selected "),_.Vb(2,"em",9),_.Mc(3),_.Ub(),_.Mc(4,". "),_.Ub(),_.Vb(5,"div",10),_.Mc(6," This is the "),_.Vb(7,"em",9),_.Mc(8),_.Ub(),_.Mc(9,". "),_.Ub()),2&e){var n=_.gc(),i=n.index,o=n.$implicit,a=_.gc();_.Db(3),_.Nc(a.getSelectedUserOption(i).label.title),_.Db(5),_.Nc(o.label.title)}}function mv(e,t){if(1&e&&(_.Vb(0,"div",1),_.Vb(1,"div",2),_.Qb(2,"app-view-quiz-answer-number",3),_.Ub(),_.Vb(3,"div",4),_.Vb(4,"app-view-quiz-answer-option",5,6),_.Kc(6,bv,2,1,"div",7),_.Kc(7,vv,10,2,"ng-template",null,8,_.Lc),_.Ub(),_.Ub(),_.Ub()),2&e){var n=t.index,i=_.vc(5),o=_.vc(8),a=_.gc();_.Db(2),_.lc("number",n+1),_.Db(2),_.lc("correct",a.isOptionAnswerCorrect(n)),_.Db(2),_.lc("ngIf",i.correct)("ngIfElse",o)}}var yv,xv=((yv=function(){function e(){m(this,e)}return v(e,[{key:"ngOnInit",value:function(){}},{key:"isOptionAnswerCorrect",value:function(e){return this.answer[e]===this.question.data.correctAnswer[e]}},{key:"getSelectedUserOption",value:function(e){var t=this.answer[e];return this.question.data.options.find((function(e){return e.value===t}))}}]),e}()).\u0275fac=function(e){return new(e||yv)},yv.\u0275cmp=_.Jb({type:yv,selectors:[["app-view-quiz-label-anatomy-answer"]],inputs:{question:"question",answer:"answer",summary:"summary"},decls:1,vars:1,consts:[["class","answers",4,"ngFor","ngForOf"],[1,"answers"],[1,"mt-2","mr-2"],[3,"number"],[1,"answers__option"],[3,"correct"],["answerOption",""],["class","text-semibold",4,"ngIf","ngIfElse"],["falseBlock",""],[1,"text-semibold"],[1,"mt-1"]],template:function(e,t){1&e&&_.Kc(0,mv,9,4,"div",0),2&e&&_.lc("ngForOf",t.question.data.options)},directives:[or.k,Bb,lv,or.l],styles:[".answers[_ngcontent-%COMP%]{display:flex;flex-direction:row}.answers__option[_ngcontent-%COMP%]{flex:1 1 auto}"],changeDetection:0}),yv);function wv(e,t){if(1&e&&(_.Vb(0,"div",7),_.Mc(1),_.Ub()),2&e){var n=_.gc();_.Db(1),_.Oc("",n.questionNumber,".")}}function kv(e,t){if(1&e&&(_.Vb(0,"div"),_.Qb(1,"app-view-quiz-multiple-choice-answer",8),_.Ub()),2&e){var n=_.gc();_.Db(1),_.lc("question",n.question)("answer",n.answer)("summary",n.summary)}}function Ov(e,t){if(1&e&&(_.Vb(0,"div"),_.Qb(1,"app-view-quiz-select-anatomy-answer",8),_.Ub()),2&e){var n=_.gc();_.Db(1),_.lc("question",n.question)("answer",n.answer)("summary",n.summary)}}function Cv(e,t){if(1&e&&(_.Vb(0,"div"),_.Qb(1,"app-view-quiz-label-anatomy-answer",8),_.Ub()),2&e){var n=_.gc();_.Db(1),_.lc("question",n.question)("answer",n.answer)("summary",n.summary)}}var Sv,_v,jv=((Sv=function(){function e(t){m(this,e),this.store=t,this.QuestionType=co}return v(e,[{key:"ngOnInit",value:function(){this.initAnswerConfig()}},{key:"initAnswerConfig",value:function(){var e=this.question.type;this.store.dispatch(new no.SetQuizPickMode(e===co.SelectAnatomy?"none":"single"))}}]),e}()).\u0275fac=function(e){return new(e||Sv)(_.Pb(L.g))},Sv.\u0275cmp=_.Jb({type:Sv,selectors:[["app-view-quiz-answer"]],inputs:{question:"question",questionNumber:"questionNumber",answer:"answer",summary:"summary"},decls:11,vars:7,consts:[["data-test","answer",1,"answer"],[1,"answer__prompt"],["class","mr-1",4,"ngIf"],[3,"contentBlocks"],[3,"ngSwitch"],[4,"ngSwitchCase"],[1,"answer__explanation"],[1,"mr-1"],[3,"question","answer","summary"]],template:function(e,t){1&e&&(_.Vb(0,"div",0),_.Vb(1,"div",1),_.Kc(2,wv,2,1,"div",2),_.Vb(3,"div"),_.Qb(4,"app-content-blocks",3),_.Ub(),_.Ub(),_.Vb(5,"div",4),_.Kc(6,kv,2,3,"div",5),_.Kc(7,Ov,2,3,"div",5),_.Kc(8,Cv,2,3,"div",5),_.Ub(),_.Vb(9,"div",6),_.Qb(10,"app-content-blocks",3),_.Ub(),_.Ub()),2&e&&(_.Db(2),_.lc("ngIf",t.questionNumber),_.Db(2),_.lc("contentBlocks",t.question.questionPrompt),_.Db(1),_.lc("ngSwitch",t.question.type),_.Db(1),_.lc("ngSwitchCase",t.QuestionType.MultipleChoice),_.Db(1),_.lc("ngSwitchCase",t.QuestionType.SelectAnatomy),_.Db(1),_.lc("ngSwitchCase",t.QuestionType.LabelAnatomy),_.Db(2),_.lc("contentBlocks",t.question.explanation))},directives:[or.l,Ug,or.n,or.o,dv,fv,xv],styles:[".text-8[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase[_ngcontent-%COMP%]{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase[_ngcontent-%COMP%]{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase[_ngcontent-%COMP%]{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase[_ngcontent-%COMP%]{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-header[_ngcontent-%COMP%]{font-weight:700}.text--code[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.text-xlight[_ngcontent-%COMP%]{font-weight:200}.text-light[_ngcontent-%COMP%]{font-weight:300}.text-medium[_ngcontent-%COMP%]{font-weight:500}.text-semibold[_ngcontent-%COMP%]{font-weight:600}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-underline[_ngcontent-%COMP%]{text-decoration:underline}.text-italic[_ngcontent-%COMP%]{font-style:italic}.text-bright[_ngcontent-%COMP%]{color:#fff}.text-dim[_ngcontent-%COMP%]{color:#96a8c0}.text-error[_ngcontent-%COMP%]{color:#ed4758}.text-left[_ngcontent-%COMP%]{text-align:left}.text-center[_ngcontent-%COMP%]{text-align:center}.text-right[_ngcontent-%COMP%]{text-align:right}.text-ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link[_ngcontent-%COMP%], .text-link[_ngcontent-%COMP%]:visited{color:inherit;cursor:pointer}.text-link[_ngcontent-%COMP%]:not(.text-underline), .text-link[_ngcontent-%COMP%]:visited:not(.text-underline){text-decoration:none}.text-success[_ngcontent-%COMP%]{color:#38de38}.text-danger[_ngcontent-%COMP%]{color:#de3838}.text-info[_ngcontent-%COMP%]{color:#0060c4}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.text-pre-line[_ngcontent-%COMP%]{white-space:pre-line}.answer[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.answer__prompt[_ngcontent-%COMP%]{display:flex;padding-bottom:16px}.answer__explanation[_ngcontent-%COMP%]{padding-top:24px}"],changeDetection:0}),Sv),Pv=["progressCircle"],Mv=((_v=function(){function e(t,n){m(this,e),this.renderer=t,this.changeRef=n,this._size="medium",this._progress=0,this.strokeWidth=8,this.diameter=120}return v(e,[{key:"size",get:function(){return this._size},set:function(e){this._size=e,this.updateCircle()}},{key:"progress",get:function(){return this._progress},set:function(e){this._progress=e,this.updateCircle()}},{key:"ngOnInit",value:function(){}},{key:"ngAfterViewInit",value:function(){this.updateCircle()}},{key:"updateCircle",value:function(){switch(this.size){case"small":this.strokeWidth=4,this.diameter=60;break;case"medium":this.strokeWidth=8,this.diameter=120;break;case"large":this.strokeWidth=16,this.diameter=240}if(this.progressCircleRef){var e=2*this.progressCircleRef.nativeElement.r.baseVal.value*Math.PI,t=e-this.progress/100*e;this.renderer.setStyle(this.progressCircleRef.nativeElement,"strokeDasharray","".concat(e," ").concat(e)),this.renderer.setStyle(this.progressCircleRef.nativeElement,"strokeDashoffset",""+t)}this.changeRef.markForCheck()}}]),e}()).\u0275fac=function(e){return new(e||_v)(_.Pb(_.H),_.Pb(_.i))},_v.\u0275cmp=_.Jb({type:_v,selectors:[["app-progress-circle"]],viewQuery:function(e,t){var n;1&e&&_.Gc(Pv,!0),2&e&&_.uc(n=_.dc())&&(t.progressCircleRef=n.first)},inputs:{size:"size",progress:"progress"},decls:8,vars:19,consts:[["data-test","progress",1,"progress"],[1,"progress__ring-bg"],["stroke","#F9FAFD","fill","transparent",1,"progress__circle"],[1,"progress__ring"],["stroke","#5BB96F","fill","transparent",1,"progress__circle"],["progressCircle",""],["data-test","progressPercentage",1,"progress__label","text-semibold"]],template:function(e,t){1&e&&(_.Vb(0,"div",0),_.fc(),_.Vb(1,"svg",1),_.Qb(2,"circle",2),_.Ub(),_.Vb(3,"svg",3),_.Qb(4,"circle",4,5),_.Ub(),_.ec(),_.Vb(6,"div",6),_.Mc(7),_.Ub(),_.Ub()),2&e&&(_.Hb("progress--small","small"===t.size)("progress--medium","medium"===t.size)("progress--large","large"===t.size),_.Db(1),_.Eb("width",t.diameter)("height",t.diameter),_.Db(1),_.Eb("stroke-width",t.strokeWidth)("r",t.diameter/2-2*t.strokeWidth)("cx",t.diameter/2)("cy",t.diameter/2),_.Db(1),_.Eb("width",t.diameter)("height",t.diameter),_.Db(1),_.Eb("stroke-width",t.strokeWidth)("r",t.diameter/2-2*t.strokeWidth)("cx",t.diameter/2)("cy",t.diameter/2),_.Db(3),_.Oc(" ",t.progress,"% "))},styles:[".text-8[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase[_ngcontent-%COMP%]{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase[_ngcontent-%COMP%]{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase[_ngcontent-%COMP%]{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase[_ngcontent-%COMP%]{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-header[_ngcontent-%COMP%]{font-weight:700}.text--code[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.text-xlight[_ngcontent-%COMP%]{font-weight:200}.text-light[_ngcontent-%COMP%]{font-weight:300}.text-medium[_ngcontent-%COMP%]{font-weight:500}.text-semibold[_ngcontent-%COMP%]{font-weight:600}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-underline[_ngcontent-%COMP%]{text-decoration:underline}.text-italic[_ngcontent-%COMP%]{font-style:italic}.text-bright[_ngcontent-%COMP%]{color:#fff}.text-dim[_ngcontent-%COMP%]{color:#96a8c0}.text-error[_ngcontent-%COMP%]{color:#ed4758}.text-left[_ngcontent-%COMP%]{text-align:left}.text-center[_ngcontent-%COMP%]{text-align:center}.text-right[_ngcontent-%COMP%]{text-align:right}.text-ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link[_ngcontent-%COMP%], .text-link[_ngcontent-%COMP%]:visited{color:inherit;cursor:pointer}.text-link[_ngcontent-%COMP%]:not(.text-underline), .text-link[_ngcontent-%COMP%]:visited:not(.text-underline){text-decoration:none}.text-success[_ngcontent-%COMP%]{color:#38de38}.text-danger[_ngcontent-%COMP%]{color:#de3838}.text-info[_ngcontent-%COMP%]{color:#0060c4}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.text-pre-line[_ngcontent-%COMP%]{white-space:pre-line}.progress[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;justify-content:center}.progress__ring[_ngcontent-%COMP%]{position:absolute;z-index:1}.progress__circle[_ngcontent-%COMP%]{transition:stroke-dashoffset .35s;transform:rotate(-90deg);transform-origin:50% 50%}.progress__label[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);z-index:2}.progress--small[_ngcontent-%COMP%]   .progress__label[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.progress--medium[_ngcontent-%COMP%]   .progress__label[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.progress--large[_ngcontent-%COMP%]   .progress__label[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}"],changeDetection:0}),_v),Iv=function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r},zv=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function Tv(e,t){if(1&e&&(_.Vb(0,"div",13),_.Qb(1,"app-view-quiz-answer",14),_.Ub()),2&e){var n=t.$implicit,i=t.index,o=_.gc(3);_.Db(1),_.lc("question",n)("questionNumber",i+1)("answer",null==o.quizScore?null:o.quizScore.questionAnswers[n.id])("summary",!0)}}function Uv(e,t){if(1&e&&(_.Vb(0,"div",11),_.Kc(1,Tv,2,4,"div",12),_.Ub()),2&e){var n=_.gc(2);_.Db(1),_.lc("ngForOf",n.questions)}}function Lv(e,t){if(1&e&&(_.Tb(0),_.Vb(1,"div",6),_.Qb(2,"app-progress-circle",7),_.Vb(3,"div",8),_.Mc(4," Quiz Complete "),_.Ub(),_.Vb(5,"div",9),_.Mc(6),_.Ub(),_.Ub(),_.Kc(7,Uv,2,1,"div",10),_.Sb()),2&e){var n=_.gc();_.Db(2),_.lc("progress",null==n.quizScore?null:n.quizScore.score),_.Db(4),_.Pc(" You answered ",null==n.quizScore?null:n.quizScore.correctTotal," of ",null==n.quizScore?null:n.quizScore.scorableTotal," questions correctly. "),_.Db(1),_.lc("ngIf",n.showExplanationEnabled&&n.showExplanation)}}function Dv(e,t){if(1&e){var n=_.Wb();_.Vb(0,"button",15),_.cc("click",(function(){return _.zc(n),_.gc().handleToggleSummaryClick()})),_.Mc(1),_.Ub()}if(2&e){var i=_.gc();_.Db(1),_.Oc(" ",i.showExplanation?"Hide Summary":"Show Summary"," ")}}function Ev(e,t){if(1&e){var n=_.Wb();_.Vb(0,"button",16),_.cc("click",(function(){return _.zc(n),_.gc().handleRestartClick()})),_.Mc(1," Take Again "),_.Ub()}}function Fv(e,t){if(1&e){var n=_.Wb();_.Vb(0,"button",17),_.cc("click",(function(){return _.zc(n),_.gc().handleExitClick()})),_.Mc(1," Back to View "),_.Ub()}}var Av,Rv=((Av=function(){function e(t,n,i){m(this,e),this.store=t,this.changeRef=n,this.quizService=i,this.questions=[],this.showSummaryEnabled=!1,this.showExplanationEnabled=!1,this.showExplanation=!1,this.ngUnsubscribe=new ge.a}return v(e,[{key:"ngOnInit",value:function(){this.initReviewListeners()}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"initReviewListeners",value:function(){var e=this;Object(Ka.b)([this.questions$,this.submissions$]).pipe(Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){var n=u(t,2),i=n[0],o=n[1];e.questions=i,e.quizScore=uo(i,o),e.changeRef.markForCheck()})),this.quizSettings$.pipe(Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){var n=t.showSummary,i=t.showExplanation;e.showSummaryEnabled=!1!==n,e.showExplanationEnabled=!1!==i,e.changeRef.markForCheck()}))}},{key:"handleToggleSummaryClick",value:function(){this.showExplanation=!this.showExplanation,this.changeRef.markForCheck()}},{key:"handleRestartClick",value:function(){var e=this;this.quizService.resetQuiz(),setTimeout((function(){e.quizService.startQuiz()}))}},{key:"handleExitClick",value:function(){this.quizService.exitQuiz()}}]),e}()).\u0275fac=function(e){return new(e||Av)(_.Pb(L.g),_.Pb(_.i),_.Pb(lf))},Av.\u0275cmp=_.Jb({type:Av,selectors:[["app-view-quiz-review"]],decls:8,vars:8,consts:[["data-test","quizReview",1,"review"],[4,"ngIf"],[1,"review__actions"],["class","w-100","app-button","","buttonType","outline","buttonTheme","light","data-test","quizToggleSummaryButton",3,"click",4,"ngIf"],["class","mt-8 w-100","app-button","","buttonType","info","buttonTheme","light","data-test","quizTakeAgainButton",3,"click",4,"ngIf"],["class","mt-3 w-100","app-button","","buttonType","info","buttonTheme","light","data-test","quizExitButton",3,"click",4,"ngIf"],["data-test","quizSummary",1,"text-center"],["size","medium",3,"progress"],[1,"mt-8","text-18","text-semibold"],[1,"mv-4","text-14","text-medium"],["class","review__summary mb-4","data-test","quizExplanation",4,"ngIf"],["data-test","quizExplanation",1,"review__summary","mb-4"],["class","mv-6",4,"ngFor","ngForOf"],[1,"mv-6"],[3,"question","questionNumber","answer","summary"],["app-button","","buttonType","outline","buttonTheme","light","data-test","quizToggleSummaryButton",1,"w-100",3,"click"],["app-button","","buttonType","info","buttonTheme","light","data-test","quizTakeAgainButton",1,"mt-8","w-100",3,"click"],["app-button","","buttonType","info","buttonTheme","light","data-test","quizExitButton",1,"mt-3","w-100",3,"click"]],template:function(e,t){1&e&&(_.Vb(0,"div",0),_.Kc(1,Lv,8,4,"ng-container",1),_.Vb(2,"div",2),_.Kc(3,Dv,2,1,"button",3),_.Kc(4,Ev,2,0,"button",4),_.hc(5,"async"),_.Kc(6,Fv,2,0,"button",5),_.hc(7,"async"),_.Ub(),_.Ub()),2&e&&(_.Db(1),_.lc("ngIf",t.showSummaryEnabled),_.Db(2),_.lc("ngIf",t.showSummaryEnabled&&t.showExplanationEnabled),_.Db(1),_.lc("ngIf",!_.ic(5,4,t.quizLocked$)),_.Db(2),_.lc("ngIf",!_.ic(7,6,t.quizLocked$)))},directives:[or.l,Mv,or.k,jv,sl],pipes:[or.b],styles:[".review__summary[_ngcontent-%COMP%]{background-color:#f9fafd;padding:4px 12px}"],changeDetection:0}),Iv([Object(L.d)(So.getAllQuestions),zv("design:type",he.a)],Av.prototype,"questions$",void 0),Iv([Object(L.d)(So.getAllSubmissions),zv("design:type",he.a)],Av.prototype,"submissions$",void 0),Iv([Object(L.d)(So.getQuizSettings),zv("design:type",he.a)],Av.prototype,"quizSettings$",void 0),Iv([Object(L.d)(So.getQuizModeLocked),zv("design:type",he.a)],Av.prototype,"quizLocked$",void 0),Av),Nv=function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r},Vv=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function Hv(e,t){if(1&e){var n=_.Wb();_.Vb(0,"button",9),_.cc("click",(function(){return _.zc(n),_.gc(2).handleExitClick()})),_.Vb(1,"span",10),_.Mc(2,"Exit Quiz"),_.Ub(),_.Ub()}}function Bv(e,t){if(1&e&&(_.Qb(0,"app-view-quiz-progress",11),_.hc(1,"async"),_.hc(2,"async")),2&e){var n=_.gc(2);_.lc("index",_.ic(1,2,n.questionIndex$))("total",_.ic(2,4,n.questionTotal$))}}function Qv(e,t){if(1&e&&(_.Vb(0,"div",4),_.Vb(1,"div",5),_.Vb(2,"h1",6),_.Mc(3,"Quiz"),_.Ub(),_.Kc(4,Hv,3,0,"button",7),_.hc(5,"async"),_.Ub(),_.Kc(6,Bv,3,6,"app-view-quiz-progress",8),_.hc(7,"async"),_.hc(8,"async"),_.Ub()),2&e){var n,i=_.gc();_.Db(4),_.lc("ngIf",!_.ic(5,2,i.quizLocked$)),_.Db(2),_.lc("ngIf",(null==(n=_.ic(7,4,i.quizSettings$))?null:n.showProgress)&&_.ic(8,6,i.lifecycle$)!==i.Lifecycle.Review)}}function qv(e,t){if(1&e&&(_.Qb(0,"app-view-quiz-question",15),_.hc(1,"async")),2&e){var n=_.gc(2);_.lc("question",_.ic(1,1,n.question$))}}function Wv(e,t){if(1&e&&(_.Vb(0,"div"),_.Mc(1),_.hc(2,"async"),_.Ub()),2&e){var n,i=_.gc(3);_.Db(1),_.Oc(" ",(null==(n=_.ic(2,1,i.question$))?null:n.nextLabel)||i.defaultNextButtonNext," ")}}function $v(e,t){1&e&&(_.Vb(0,"div"),_.Mc(1,"Submit"),_.Ub())}function Kv(e,t){if(1&e&&(_.Vb(0,"button",16),_.Vb(1,"div",17),_.hc(2,"async"),_.Kc(3,Wv,3,3,"div",18),_.Kc(4,$v,2,0,"div",19),_.Ub(),_.Ub()),2&e){var n,i=_.gc(2);_.lc("disabled",!i.form.valid),_.Db(1),_.lc("ngSwitch",null==(n=_.ic(2,3,i.question$))?null:n.type),_.Db(2),_.lc("ngSwitchCase",i.quizQuestionType.Instructions)}}function Gv(e,t){if(1&e){var n=_.Wb();_.Vb(0,"form",12),_.cc("submit",(function(){return _.zc(n),_.gc().handleSubmit()})),_.Kc(1,qv,2,3,"app-view-quiz-question",13),_.hc(2,"async"),_.Kc(3,Kv,5,5,"button",14),_.hc(4,"async"),_.hc(5,"async"),_.Ub()}if(2&e){var i,o=_.gc();_.lc("formGroup",o.form),_.Db(1),_.lc("ngIf",_.ic(2,3,o.question$)),_.Db(2),_.lc("ngIf",(null==(i=_.ic(4,5,o.quizSettings$))?null:i.showSubmit)&&_.ic(5,7,o.lifecycle$)===o.Lifecycle.Question)}}function Zv(e,t){if(1&e){var n=_.Wb();_.Vb(0,"button",24),_.cc("click",(function(){return _.zc(n),_.gc(2).nextQuestion()})),_.Mc(1),_.hc(2,"async"),_.Ub()}if(2&e){var i,o=_.gc(2);_.Db(1),_.Oc(" ",(null==(i=_.ic(2,1,o.question$))?null:i.nextLabel)||o.defaultNextButtonNext," ")}}function Jv(e,t){if(1&e){var n=_.Wb();_.Vb(0,"button",25),_.cc("click",(function(){return _.zc(n),_.gc(2).handleViewSummaryClick()})),_.Mc(1," See Results "),_.Ub()}}function Xv(e,t){if(1&e&&(_.Tb(0),_.Vb(1,"div",20),_.Qb(2,"app-view-quiz-answer",21),_.hc(3,"async"),_.hc(4,"async"),_.Ub(),_.Tb(5,17),_.hc(6,"async"),_.Kc(7,Zv,3,3,"button",22),_.Kc(8,Jv,2,0,"button",23),_.Sb(),_.Sb()),2&e){var n=_.gc();_.Db(2),_.lc("question",_.ic(3,5,n.question$))("answer",_.ic(4,7,n.submission$).answer)("summary",!1),_.Db(3),_.lc("ngSwitch",_.ic(6,9,n.hasQuestionsRemaining$)),_.Db(2),_.lc("ngSwitchCase",!0)}}function Yv(e,t){1&e&&(_.Tb(0),_.Qb(1,"app-view-quiz-review"),_.Sb())}var em,tm=((em=function(){function e(t,n,i,o,a,r){m(this,e),this.store=t,this.actions=n,this.formBuilder=i,this.viewService=o,this.engineService=a,this.quizService=r,this.defaultNextButtonNext="Next Question",this.showHeader=!0,this.Lifecycle=ho,this.quizQuestionType=co,this.sceneConfigStash={},this.ngUnsubscribe=new ge.a}return v(e,[{key:"ngOnInit",value:function(){if(!this.store.selectSnapshot(So.getActiveQuestionId)){var e=this.store.selectSnapshot(So).questions[0].id;this.store.dispatch(new no.SetActiveQuestion(e))}this.store.dispatch(new no.SetQuizLifecycle(ho.Question)),this.form=this.formBuilder.group({question:new Hg.e("",this.getQuizValidation())}),this.initQuestionObserver(),this.initAnswerObserver(),this.initEngineInteractionObserver(),this.engineService.fireEvent(Lt.QuizEntered,!0)}},{key:"ngOnDestroy",value:function(){var e=this;Object.entries(this.sceneConfigStash).forEach((function(t){var n=u(t,2),i=n[0],o=n[1];e.store.dispatch(new En(i,o.background))})),this.engineService.fireEvent(Lt.QuizExited,!0),this.viewService.selectTool(Aa.Select),this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"answer",get:function(){var e=this.form.get("question").value;return Array.isArray(e)?e:[e]}},{key:"initQuestionObserver",value:function(){var e=this;this.question$.pipe(Object(fe.a)(this.ngUnsubscribe),Object(be.a)((function(e){return void 0!==e}))).subscribe((function(t){var n=e.store.selectSnapshot(Ua.getSelectedChapterId);t.chapterId!==n&&e.store.dispatch(new On(t.chapterId)),e.form.reset(),e.setSceneConfig(t),e.store.dispatch(new no.SetActiveSubmission(void 0)),t.type===co.Instructions&&e.form.get("question").setValue("-"),e.engineService.fireEvent(Lt.QuizQuestionLoaded,t)}))}},{key:"initAnswerObserver",value:function(){var e=this;this.form.get("question").valueChanges.pipe(Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){var n=e.store.selectSnapshot(So.getActiveQuestion),i=e.store.selectSnapshot(So.getActiveSubmission);void 0!==n&&(e.store.selectSnapshot(So.getAllSubmissions).some((function(e){return e.questionId===n.id}))||(i&&Object(Oe.isEqual)(i.answer,t)||e.store.dispatch(new no.SetActiveSubmission({questionId:n.id,answer:t})),Object(Oe.isNil)(t)||e.engineService.fireEvent(Lt.QuizAnswerSelected,{questionId:n.id,answerId:t})))}))}},{key:"initEngineInteractionObserver",value:function(){var e=this;this.viewService.selectTool(Aa.Quiz),this.store.dispatch(new no.SetQuizPickMode("single")),this.actions.pipe(Object(L.j)(Ne),Object(be.a)((function(t){var n=t.node,i=t.event;return!Object(Oe.isNil)(n)&&e.store.selectSnapshot(qa.getActiveTool)===Aa.Quiz&&!i.srcEvent.shiftKey}))).pipe(Object(be.a)((function(){return"none"!==e.store.selectSnapshot(So.getPickMode)})),Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){"single"===e.store.selectSnapshot(So.getPickMode)&&e.viewService.clearSelectedNodes();var n=Object(Oe.get)(t,"hit.objectId");if(n){var i=e.store.selectSnapshot(Fi.getCheckedNodeIds).includes(n);e.store.dispatch(new pi.UpdateNodesChecked(!i,[n]))}})),this.question$.pipe(Object(Ja.a)((function(e,t){return Object(Oe.get)(e,"id")===Object(Oe.get)(t,"id")})),Object(be.a)((function(e){return!Object(Oe.isNil)(e)}))).pipe(Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){var n=t.type,i=t.data;e.viewService.clearSelectedNodes(),e.store.dispatch(new no.SetQuizPickMode(n===co.SelectAnatomy&&i.correctAnswer.length>1?"multi":"single"))}))}},{key:"handleSubmit",value:function(){var e=this.store.selectSnapshot(So.getActiveQuestion);(this.form.valid||e.type===co.Instructions)&&this.quizService.submitQuestion(e.id,this.answer)}},{key:"handleViewSummaryClick",value:function(){this.viewSummary()}},{key:"handleExitClick",value:function(){this.quizService.exitQuiz()}},{key:"nextQuestion",value:function(){this.quizService.nextQuestion()}},{key:"viewSummary",value:function(){this.store.dispatch(new no.SetQuizLifecycle(ho.Review)),this.engineService.fireEvent(Lt.QuizCompleted,!0)}},{key:"setSceneConfig",value:function(e){var t=this,n=(null==e?void 0:e.sceneConfig)||{},i=n.camera,o=n.background,a=this.store.selectSnapshot(Ua.getChapter(e.chapterId));i&&(this.setStash(e.chapterId,{camera:a.camera.location}),setTimeout((function(){t.store.dispatch(new Wt(i.location,!0,1))}))),o&&(this.setStash(e.chapterId,{background:a.background}),this.store.dispatch(new En(e.chapterId,o)))}},{key:"setStash",value:function(e,t){this.sceneConfigStash[e]=Object.assign(Object.assign({},this.sceneConfigStash[e]||{}),t)}},{key:"getQuizValidation",value:function(){var e=this;return function(t){var n=t.value,i=Array.isArray(n)?n:[n],o=function(e){switch(Object(Oe.get)(e,"type","")){case co.MultipleChoice:var t=Object(Oe.get)(e,"data.correctAnswer","");return t&&""!==t;case co.SelectAnatomy:case co.LabelAnatomy:return Object(Oe.get)(e,"data.correctAnswer",[]).length>0;default:return!0}}(e.store.selectSnapshot(So.getActiveQuestion)),a=i.some((function(e){return Object(Oe.isNil)(e)||""===e}));return o&&a?{invalidValues:a}:null}}}]),e}()).\u0275fac=function(e){return new(e||em)(_.Pb(L.g),_.Pb(L.b),_.Pb(Hg.d),_.Pb(Bu),_.Pb(Nt),_.Pb(lf))},em.\u0275cmp=_.Jb({type:em,selectors:[["app-view-quiz"]],inputs:{showHeader:"showHeader"},decls:8,vars:10,consts:[["data-test","quiz",1,"view-quiz"],["class","pb-2 mb-4 view-quiz__header",4,"ngIf"],[3,"formGroup","submit",4,"ngIf"],[4,"ngIf"],[1,"pb-2","mb-4","view-quiz__header"],[1,"flex"],[1,"text-20","text-semibold","flex-grow"],["app-pin-button","","icon","times","size","small",3,"click",4,"ngIf"],["class","mt-3",3,"index","total",4,"ngIf"],["app-pin-button","","icon","times","size","small",3,"click"],[1,"visually-hidden"],[1,"mt-3",3,"index","total"],[3,"formGroup","submit"],["formControlName","question",3,"question",4,"ngIf"],["app-button","","class","w-100","buttonType","info","data-test","questionSubmit",3,"disabled",4,"ngIf"],["formControlName","question",3,"question"],["app-button","","buttonType","info","data-test","questionSubmit",1,"w-100",3,"disabled"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[1,"mb-8"],[3,"question","answer","summary"],["app-button","","buttonType","info","class","w-100","data-test","questionNextButton",3,"click",4,"ngSwitchCase"],["data-test","quizViewSummaryButton","app-button","","buttonType","info","class","w-100",3,"click",4,"ngSwitchDefault"],["app-button","","buttonType","info","data-test","questionNextButton",1,"w-100",3,"click"],["data-test","quizViewSummaryButton","app-button","","buttonType","info",1,"w-100",3,"click"]],template:function(e,t){1&e&&(_.Vb(0,"div",0),_.Kc(1,Qv,9,8,"div",1),_.Kc(2,Gv,6,9,"form",2),_.hc(3,"async"),_.Kc(4,Xv,9,11,"ng-container",3),_.hc(5,"async"),_.Kc(6,Yv,2,0,"ng-container",3),_.hc(7,"async"),_.Ub()),2&e&&(_.Db(1),_.lc("ngIf",t.showHeader),_.Db(1),_.lc("ngIf",_.ic(3,4,t.lifecycle$)===t.Lifecycle.Question),_.Db(2),_.lc("ngIf",_.ic(5,6,t.lifecycle$)===t.Lifecycle.Explanation),_.Db(2),_.lc("ngIf",_.ic(7,8,t.lifecycle$)===t.Lifecycle.Review))},directives:[or.l,ag,zb,Hg.t,Hg.n,Hg.h,iv,Hg.m,Hg.g,sl,or.n,or.o,or.p,jv,Rv],pipes:[or.b],styles:[".view-quiz__header[_ngcontent-%COMP%]{border-bottom:1px solid #eaeff5}"],changeDetection:0}),Nv([Object(L.d)(So.getActiveQuestion),Vv("design:type",he.a)],em.prototype,"question$",void 0),Nv([Object(L.d)(So.getActiveQuestionIndex),Vv("design:type",he.a)],em.prototype,"questionIndex$",void 0),Nv([Object(L.d)(So.getQuestionTotal),Vv("design:type",he.a)],em.prototype,"questionTotal$",void 0),Nv([Object(L.d)(So.getCorrectAnswerTotal),Vv("design:type",he.a)],em.prototype,"correctAnswerTotal$",void 0),Nv([Object(L.d)(So.hasQuestionRemaining),Vv("design:type",he.a)],em.prototype,"hasQuestionsRemaining$",void 0),Nv([Object(L.d)(So.getQuizSettings),Vv("design:type",he.a)],em.prototype,"quizSettings$",void 0),Nv([Object(L.d)(So.getLifecycle),Vv("design:type",he.a)],em.prototype,"lifecycle$",void 0),Nv([Object(L.d)(So.getQuizModeLocked),Vv("design:type",he.a)],em.prototype,"quizLocked$",void 0),Nv([Object(L.d)(So.getActiveSubmission),Vv("design:type",he.a)],em.prototype,"submission$",void 0),em),nm=function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r},im=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},om=["viewDrawer"],am=["viewDrawerOuter"];function rm(e,t){1&e&&_.Qb(0,"app-icon",17)}function cm(e,t){1&e&&_.Qb(0,"app-icon",18)}function sm(e,t){if(1&e&&(_.Vb(0,"div",19),_.Qb(1,"app-content-blocks",20),_.hc(2,"async"),_.Ub()),2&e){var n,i=_.gc(2);_.Db(1),_.lc("contentBlocks",null==(n=_.ic(2,2,i.selectedLabel$))?null:n.contentBlocks)("layout","compact")}}function lm(e,t){if(1&e){var n=_.Wb();_.Tb(0),_.Vb(1,"div",6),_.cc("click",(function(){return _.zc(n),_.gc().handleToggleClick()})),_.Vb(2,"div",7),_.cc("click",(function(){return _.zc(n),_.gc().handleLabelBack()})),_.Qb(3,"app-icon",8),_.Ub(),_.Vb(4,"div",9),_.Qb(5,"app-html",10),_.hc(6,"async"),_.Ub(),_.Vb(7,"div",11),_.Kc(8,rm,1,0,"app-icon",12),_.Kc(9,cm,1,0,"app-icon",13),_.Ub(),_.Ub(),_.Kc(10,sm,3,4,"div",14),_.hc(11,"async"),_.Vb(12,"div",15),_.Qb(13,"app-html",16),_.hc(14,"async"),_.Ub(),_.Sb()}if(2&e){var i,o,a,r=_.gc();_.Db(5),_.lc("markdownText",null==(i=_.ic(6,5,r.selectedLabel$))?null:i.title),_.Db(3),_.lc("ngIf",!r.open),_.Db(1),_.lc("ngIf",r.open),_.Db(1),_.lc("ngIf",null==(o=_.ic(11,7,r.selectedLabel$))?null:o.contentBlocks),_.Db(3),_.lc("markdownText",null==(a=_.ic(14,9,r.selectedLabel$))?null:a.description)}}function pm(e,t){1&e&&(_.Tb(0),_.Qb(1,"app-view-title",24),_.Sb()),2&e&&(_.Db(1),_.lc("menuEnabled",!1))}function um(e,t){if(1&e){var n=_.Wb();_.Vb(0,"div",29),_.cc("click",(function(){return _.zc(n),_.gc(3).handleExitQuiz()})),_.Qb(1,"app-icon",30),_.Ub()}}function dm(e,t){if(1&e&&(_.Vb(0,"span",31),_.Vb(1,"span",32),_.Mc(2),_.hc(3,"async"),_.Ub(),_.Mc(4),_.hc(5,"async"),_.Ub()),2&e){var n=_.gc(3);_.Db(2),_.Oc("Question ",_.ic(3,2,n.activeQuestionIndex$)+1,""),_.Db(2),_.Oc(" of ",_.ic(5,4,n.questionTotal$)," ")}}function gm(e,t){if(1&e&&(_.Tb(0),_.Kc(1,um,2,0,"div",25),_.hc(2,"async"),_.Vb(3,"div",9),_.Vb(4,"div",26),_.Vb(5,"span",27),_.Mc(6,"Quiz"),_.Ub(),_.Kc(7,dm,6,6,"span",28),_.hc(8,"async"),_.hc(9,"async"),_.Ub(),_.Ub(),_.Sb()),2&e){var n,i=_.gc(2);_.Db(1),_.lc("ngIf",!_.ic(2,2,i.quizLocked$)),_.Db(6),_.lc("ngIf",(null==(n=_.ic(8,4,i.quizSettings$))?null:n.showProgress)&&_.ic(9,6,i.questionRemaining$)>0)}}function hm(e,t){1&e&&_.Qb(0,"app-icon",17)}function fm(e,t){1&e&&_.Qb(0,"app-icon",18)}function bm(e,t){if(1&e&&(_.Vb(0,"div",11),_.Kc(1,hm,1,0,"app-icon",12),_.Kc(2,fm,1,0,"app-icon",13),_.Ub()),2&e){var n=_.gc(2);_.Db(1),_.lc("ngIf",!n.open),_.Db(1),_.lc("ngIf",n.open)}}function vm(e,t){1&e&&_.Qb(0,"app-view-content-mode",34)}function mm(e,t){if(1&e&&(_.Tb(0),_.Kc(1,vm,1,0,"app-view-content-mode",33),_.Sb()),2&e){var n=_.gc(2);_.Db(1),_.lc("ngIf",n.expandable)}}function ym(e,t){1&e&&_.Qb(0,"app-view-quiz",35),2&e&&_.lc("showHeader",!1)}function xm(e,t){if(1&e){var n=_.Wb();_.Tb(0),_.Vb(1,"div",6),_.cc("click",(function(){return _.zc(n),_.gc().handleToggleClick()})),_.Kc(2,pm,2,1,"ng-container",21),_.hc(3,"async"),_.Kc(4,gm,10,8,"ng-container",21),_.hc(5,"async"),_.Kc(6,bm,3,2,"div",22),_.Ub(),_.Vb(7,"div",15),_.Kc(8,mm,2,1,"ng-container",21),_.hc(9,"async"),_.Kc(10,ym,1,1,"app-view-quiz",23),_.hc(11,"async"),_.Ub(),_.Sb()}if(2&e){var i=_.gc();_.Db(2),_.lc("ngIf",!_.ic(3,5,i.quizModeActive$)),_.Db(2),_.lc("ngIf",_.ic(5,7,i.quizModeActive$)),_.Db(2),_.lc("ngIf",i.expandable),_.Db(2),_.lc("ngIf",!_.ic(9,9,i.quizModeActive$)),_.Db(2),_.lc("ngIf",_.ic(11,11,i.quizModeActive$))}}var wm,km,Om,Cm=function(e,t,n,i){return{"view-drawer--closed":e,"view-drawer--active":t,"view-drawer--scrollable":n,"view-drawer--fixed":i}},Sm=((wm=function(){function e(t,n,i,o,a,r){m(this,e),this.renderer=t,this.changeDetectorRef=n,this.viewService=i,this.quizService=o,this.store=a,this.layoutService=r,this.offsetYChange=new _.p,this.breakpoints={minimumDrawer:{velocity:1/0,point:0},halfDrawer:{velocity:1,point:0}},this.ngUnsubscribe=new ge.a,this.viewMode=vp,this.viewToolsMode=sf,this.mode=vp.Content,this.open=!1}return v(e,[{key:"expandable",get:function(){return"full"===this.layoutService.getVisibleContent()||this.mode===vp.LabelInfo||this.mode===vp.NodeInfo||this.open}},{key:"ngOnInit",value:function(){this.initWindowSizeObserver(),this.initLayoutObserver(),this.initQuizObserver()}},{key:"ngAfterViewInit",value:function(){this.refresh(this.store.selectSnapshot(hp.getUI).drawer.isExpandedInitially)}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"initWindowSizeObserver",value:function(){var e=this;Object(ia.a)(Object(Ga.a)(window,"resize"),Object(Ga.a)(window,"orientationchange")).pipe(Object(Dc.a)(0),Object(fe.a)(this.ngUnsubscribe)).subscribe((function(){e.refresh(!1)}))}},{key:"initLayoutObserver",value:function(){var e=this;this.layout$.pipe(Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){e.updateMode(t)}))}},{key:"initQuizObserver",value:function(){var e=this,t=this.selectedChapterReady$.pipe(Object(K.a)((function(e){return e&&e.model})),Object(be.a)((function(e){return e})),Object(Za.a)(300));Object(Ka.b)([t,this.quizModeActive$]).pipe(Object(be.a)((function(e){var t=u(e,2),n=t[0],i=t[1];return n&&i})),Object(fe.a)(this.ngUnsubscribe)).subscribe((function(){setTimeout((function(){e.toggleDrawer(!0),e.changeDetectorRef.markForCheck()}))}))}},{key:"updateViewHeight",value:function(){var e=this.viewService.getVH(z.application!==j.Viewer);this.viewDrawer.nativeElement.style.setProperty("--vh",e+"px")}},{key:"updateStops",value:function(){var e=window.innerHeight,t=this.store.selectSnapshot(Lu.getSiteHeader)===Iu.Hide?0:56;this.breakpoints.minimumDrawer.point=-64,this.breakpoints.halfDrawer.point=Math.floor(-.5*(e-t))}},{key:"updateMode",value:function(e){this.mode=this.viewService.inferDrawerMode(e),this.changeDetectorRef.markForCheck()}},{key:"resetDrawerPosition",value:function(e){var t=this;setTimeout((function(){t.slideDrawerToPoint(e?t.breakpoints.halfDrawer.point:t.breakpoints.minimumDrawer.point),t.open=e,t.changeDetectorRef.markForCheck()}))}},{key:"refresh",value:function(e){var t=this;setTimeout((function(){t.updateViewHeight(),t.updateStops(),t.resetDrawerPosition(e)}))}},{key:"handleToggleClick",value:function(){this.expandable&&this.toggleDrawer()}},{key:"handleDrawerKeydown",value:function(e){"ArrowDown"!==e.key&&"ArrowUp"!==e.key||e.stopPropagation()}},{key:"handleLabelBack",value:function(){this.viewService.clearSelectedLabel()}},{key:"toggleDrawer",value:function(e){null==e&&(e=!this.open),this.slideDrawerToPoint((e?this.breakpoints.halfDrawer:this.breakpoints.minimumDrawer).point),this.open=e,this.open?this.viewDrawerOuter.nativeElement.focus():this.viewDrawerOuter.nativeElement.blur()}},{key:"handleExitQuiz",value:function(){this.quizService.exitQuiz()}},{key:"slideDrawerToPoint",value:function(e){this.renderer.setStyle(this.viewDrawer.nativeElement,"transform","translate3d(0, ".concat(e,"px, 0)")),this.offsetYChange.emit(e)}},{key:"getDrawerY",value:function(){if(this.viewDrawer){var e=this.viewService.getComputedTransform(this.viewDrawer.nativeElement);return e?e.y:null}return null}}]),e}()).\u0275fac=function(e){return new(e||wm)(_.Pb(_.H),_.Pb(_.i),_.Pb(Bu),_.Pb(lf),_.Pb(L.g),_.Pb(Vp))},wm.\u0275cmp=_.Jb({type:wm,selectors:[["app-view-drawer"]],viewQuery:function(e,t){var n;1&e&&(_.Rc(om,!0),_.Rc(am,!0)),2&e&&(_.uc(n=_.dc())&&(t.viewDrawer=n.first),_.uc(n=_.dc())&&(t.viewDrawerOuter=n.first))},inputs:{expandable:"expandable"},outputs:{offsetYChange:"offsetYChange"},decls:7,vars:10,consts:[[1,"view-drawer",3,"ngClass"],["viewDrawer",""],["role","region","aria-label","Chapter Description",1,"view-drawer__outer",3,"keydown"],["viewDrawerOuter",""],[1,"view-drawer__inner",3,"ngSwitch"],[4,"ngSwitchCase"],[1,"view-drawer__header",2,"height","64px",3,"click"],[1,"view-drawer__button","view-drawer__button--left",3,"click"],["icon","arrow-left"],[1,"view-drawer__title"],[1,"text-semibold","text-14",3,"markdownText"],[1,"view-drawer__button","view-drawer__button--right"],["icon","caret-up",4,"ngIf"],["icon","caret-down",4,"ngIf"],["class","mv-1","appEventFence","",4,"ngIf"],[1,"view-drawer__content"],[1,"text-14",3,"markdownText"],["icon","caret-up"],["icon","caret-down"],["appEventFence","",1,"mv-1"],[3,"contentBlocks","layout"],[4,"ngIf"],["class","view-drawer__button view-drawer__button--right",4,"ngIf"],[3,"showHeader",4,"ngIf"],["alignTitle","center","size","medium",1,"view-drawer__title",3,"menuEnabled"],["class","view-drawer__button view-drawer__button--left","role","button","appEventFence","",3,"click",4,"ngIf"],[1,"flex","flex-column","text-center"],[1,"text-11","text-semibold","text-uppercase"],["class","text-14",4,"ngIf"],["role","button","appEventFence","",1,"view-drawer__button","view-drawer__button--left",3,"click"],["icon","times"],[1,"text-14"],[1,"text-semibold"],["layout","drawer",4,"ngIf"],["layout","drawer"],[3,"showHeader"]],template:function(e,t){1&e&&(_.Vb(0,"div",0,1),_.Vb(2,"div",2,3),_.cc("keydown",(function(e){return t.handleDrawerKeydown(e)})),_.Vb(4,"div",4),_.Kc(5,lm,15,11,"ng-container",5),_.Kc(6,xm,12,13,"ng-container",5),_.Ub(),_.Ub(),_.Ub()),2&e&&(_.lc("ngClass",_.rc(5,Cm,!t.open,t.open,t.open,!t.expandable)),_.Db(2),_.Eb("tabindex",t.open?0:-1),_.Db(2),_.lc("ngSwitch",t.mode),_.Db(1),_.lc("ngSwitchCase",t.viewMode.LabelInfo),_.Db(1),_.lc("ngSwitchCase",t.viewMode.Content))},directives:[or.i,or.n,or.o,Js,Zd,or.l,Zs,Ug,$f,_b,tm],pipes:[or.b],styles:[".text-8{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-header{font-weight:700}.text--code{font-family:Courier New,Courier,monospace}.text-uppercase{text-transform:uppercase}.text-xlight{font-weight:200}.text-light{font-weight:300}.text-medium{font-weight:500}.text-semibold{font-weight:600}.text-bold{font-weight:700}.text-underline{text-decoration:underline}.text-italic{font-style:italic}.text-bright{color:#fff}.text-dim{color:#96a8c0}.text-error{color:#ed4758}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.text-ellipsis{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link,.text-link:visited{color:inherit;cursor:pointer}.text-link:not(.text-underline),.text-link:visited:not(.text-underline){text-decoration:none}.text-success{color:#38de38}.text-danger{color:#de3838}.text-info{color:#0060c4}.text-nowrap{white-space:nowrap}.text-pre-line{white-space:pre-line}.view-drawer{border-top:rgba(234,239,245,.8);box-shadow:0 -1px 0 0 rgba(28,42,63,.16);background:hsla(0,0%,100%,.8);color:#131c2a;border-top:var(--view-drawer-border);box-shadow:var(--view-drawer-shadow);color:var(--view-drawer-color);left:0;min-height:100vh;right:0;position:absolute;z-index:20;top:100vh;top:calc(var(--vh, 1vh) * 100);transform:translate3d(0,-56px,0);transition:transform .3s}.view-drawer--animate{transition:background-color 1s ease-in-out}.view-drawer--active{background-color:#fff;background-color:var(--view-drawer-background--active)}.view-drawer--closed{background-color:#fff;background-color:var(--view-drawer-background--closed)}.view-drawer--scrollable{min-height:0}.view-drawer--scrollable .view-drawer__outer{height:50vh;height:calc(var(--vh, 1vh) * 50);overflow-y:scroll}.view-drawer--fixed{height:56px;overflow:hidden}.view-drawer--fixed .view-drawer__inner{height:56px;padding:0 16px}.view-drawer--fixed .view-drawer__content{justify-content:center;padding-top:0}.view-drawer__header{position:relative}.view-drawer__header,.view-drawer__title{height:64px;display:flex;justify-content:center;align-items:center}.view-drawer__title{flex-grow:1;margin:0 64px;padding:0 8px}.view-drawer__button{border:1px solid rgba(0,0,0,.1);border-radius:50%;height:40px;width:40px;display:flex;align-items:center;justify-content:center;position:absolute;transition:background-color border-color 125ms 125ms}.view-drawer__button:hover{cursor:pointer;border-color:transparent;background:rgba(215,224,234,.6)}.view-drawer__button--left{border-right:1px solid rgba(0,0,0,.1);left:16px}.view-drawer__button--right{border-left:1px solid rgba(0,0,0,.1);right:16px}.view-drawer__inner{position:relative}.view-drawer__outer{outline:none}.view-drawer__content{display:flex;flex:1 1 100%;flex-direction:column;max-width:600px;min-height:56px;margin:0 auto;padding:8px 16px 48px}"],encapsulation:2,changeDetection:0}),nm([Object(L.d)(hp.getUI),im("design:type",he.a)],wm.prototype,"layout$",void 0),nm([Object(L.d)(Ua.getSelectedChapterReadyState),im("design:type",he.a)],wm.prototype,"selectedChapterReady$",void 0),nm([Object(L.d)(Ua.getSelectedChapterIndex),im("design:type",he.a)],wm.prototype,"chapterIndex$",void 0),nm([Object(L.d)(Ua.getChapterCount),im("design:type",he.a)],wm.prototype,"chapterCount$",void 0),nm([Object(L.d)(Pc.getSelectedLabel),im("design:type",he.a)],wm.prototype,"selectedLabel$",void 0),nm([Object(L.d)(So.getQuizModeActive),im("design:type",he.a)],wm.prototype,"quizModeActive$",void 0),nm([Object(L.d)(So.getActiveQuestionIndex),im("design:type",he.a)],wm.prototype,"activeQuestionIndex$",void 0),nm([Object(L.d)(So.getQuestionTotal),im("design:type",he.a)],wm.prototype,"questionTotal$",void 0),nm([Object(L.d)(So.getQuestionsRemaining),im("design:type",he.a)],wm.prototype,"questionRemaining$",void 0),nm([Object(L.d)(So.getQuizSettings),im("design:type",he.a)],wm.prototype,"quizSettings$",void 0),nm([Object(L.d)(So.getQuizModeLocked),im("design:type",he.a)],wm.prototype,"quizLocked$",void 0),wm),_m=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";m(this,e),this.body=t,this.action=n},jm=["viewColumn"],Pm=[[["","view-column-header",""]],"*"],Mm=function(e,t,n){return{"view-column--unpadded":e,"view-column--left":t,"view-column--right":n}},Im=["[view-column-header]","*"],zm=((km=function(){function e(){m(this,e),this.unpadded=!1,this.placement="left"}return v(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||km)},km.\u0275cmp=_.Jb({type:km,selectors:[["app-view-column"]],viewQuery:function(e,t){var n;1&e&&_.Rc(jm,!0),2&e&&_.uc(n=_.dc())&&(t.viewColumn=n.first)},inputs:{unpadded:"unpadded",placement:"placement"},ngContentSelectors:Im,decls:7,vars:5,consts:[[1,"view-column",3,"ngClass"],["viewColumn",""],[1,"view-column__inner"],[1,"view-column__header"],[1,"view-column__body"]],template:function(e,t){1&e&&(_.kc(Pm),_.Vb(0,"div",0,1),_.Vb(2,"div",2),_.Vb(3,"div",3),_.jc(4),_.Ub(),_.Vb(5,"div",4),_.jc(6,1),_.Ub(),_.Ub(),_.Ub()),2&e&&_.lc("ngClass",_.qc(1,Mm,t.unpadded,"left"===t.placement,"right"===t.placement))},directives:[or.i],styles:[".view-column[_ngcontent-%COMP%]{pointer-events:auto;background:#fff;box-shadow:1px -1px 2px 0 rgba(28,42,63,.1),0 1px 2px 0 rgba(28,42,63,.3);color:#131c2a;background:var(--view-column-background);box-shadow:var(--view-column-toggle-shadow);color:var(--view-column-color);width:320px;height:100%;position:absolute;z-index:30}.view-column--left[_ngcontent-%COMP%]{left:0}.view-column--right[_ngcontent-%COMP%]{right:0;box-shadow:0 -1px 24px rgba(0,0,0,.4)}.view-column--unpadded[_ngcontent-%COMP%]   .view-column__body[_ngcontent-%COMP%]{padding:0}.view-column__inner[_ngcontent-%COMP%]{background:#fff;border-right:1px solid #eaeff5;background:var(--view-column-background);border-right:var(--view-column-border);display:flex;flex-direction:column;height:100%;width:320px;position:absolute;left:0;z-index:10}.view-column__header[_ngcontent-%COMP%]{flex-shrink:1;background:var(--view-column-background)}.view-column__header[_ngcontent-%COMP%]:empty{display:none}.view-column__body[_ngcontent-%COMP%]{overflow-y:auto;flex-grow:1;height:100%;padding:16px 12px}"],changeDetection:0}),km),Tm=["*"],Um=((Om=function(){function e(){m(this,e)}return v(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||Om)},Om.\u0275cmp=_.Jb({type:Om,selectors:[["app-view-list-container"],["","app-view-list-container",""]],ngContentSelectors:Tm,decls:2,vars:0,consts:[[1,"view-list-container"]],template:function(e,t){1&e&&(_.kc(),_.Vb(0,"div",0),_.jc(1),_.Ub())},styles:[".view-list-container{display:flex;flex-direction:column}"],encapsulation:2,changeDetection:0}),Om),Lm=function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r},Dm=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Em=function(e,t,n,i){return{"view-logo--full-color":e,"view-logo--full-white":t,"view-logo--small-color":n,"view-logo--small-white":i}};function Fm(e,t){if(1&e&&(_.Tb(0),_.Qb(1,"a",1),_.Sb()),2&e){var n=_.gc();_.Db(1),_.lc("ngClass",_.rc(1,Em,"color"===n.logoColor&&"full"===n.logoSize,"white"===n.logoColor&&"full"===n.logoSize,"color"===n.logoColor&&"small"===n.logoSize,"white"===n.logoColor&&"small"===n.logoSize))}}function Am(e,t){if(1&e&&(_.Tb(0),_.Qb(1,"span",2),_.Sb()),2&e){var n=_.gc();_.Db(1),_.lc("ngClass",_.rc(1,Em,"color"===n.logoColor&&"full"===n.logoSize,"white"===n.logoColor&&"full"===n.logoSize,"color"===n.logoColor&&"small"===n.logoSize,"white"===n.logoColor&&"small"===n.logoSize))}}var Rm,Nm,Vm=((Rm=function(){function e(){m(this,e),this.logoSize="full",this.logoColor="color",this.isLight=!0,this.breakpoint=Up,this.ngUnsubscribe=new ge.a}return v(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||Rm)},Rm.\u0275cmp=_.Jb({type:Rm,selectors:[["app-view-logo"]],inputs:{logoSize:"logoSize",logoColor:"logoColor"},decls:4,vars:6,consts:[[4,"ngIf"],["href","https://www.biodigital.com","target","_blank","tabindex","-1","title","Powered by Biodigital",1,"view-logo",3,"ngClass"],[1,"view-logo",3,"ngClass"]],template:function(e,t){var n,i;(1&e&&(_.Kc(0,Fm,2,6,"ng-container",0),_.hc(1,"async"),_.Kc(2,Am,2,6,"ng-container",0),_.hc(3,"async")),2&e)&&(_.lc("ngIf",null==(n=_.ic(1,2,t.layout$))?null:n.logo.isHyperLink),_.Db(2),_.lc("ngIf",!(null!=(i=_.ic(3,4,t.layout$))&&i.logo.isHyperLink)))},directives:[or.l,or.i],pipes:[or.b],styles:["[_nghost-%COMP%]{display:flex;height:52px;align-items:center}.view-logo--small-color[_ngcontent-%COMP%]{width:28px;height:44px;background:url(logo-color.svg) 50% no-repeat}.view-logo--full-color[_ngcontent-%COMP%]{width:120px;height:32px;background:url(powered-by-biodigital-color.svg) 50% no-repeat}.view-logo--small-white[_ngcontent-%COMP%]{width:28px;height:44px;background:url(logo-white.svg) 50% no-repeat}.view-logo--full-white[_ngcontent-%COMP%]{width:120px;height:32px;background:url(powered-by-biodigital-white.svg) 50% no-repeat}.view-logo[_ngcontent-%COMP%]:not([hidden]){display:flex}.view-logo[href][_ngcontent-%COMP%]:hover{cursor:pointer}"],changeDetection:0}),Lm([Object(L.d)(hp.getUI),Dm("design:type",he.a)],Rm.prototype,"layout$",void 0),Lm([Object(L.d)(Ua.getSelectedChapterBackground),Dm("design:type",he.a)],Rm.prototype,"background$",void 0),Lm([Object(L.d)(Ap.getBreakpoint),Dm("design:type",he.a)],Rm.prototype,"breakpoint$",void 0),Rm),Hm=function(e){return{"view-list-item--selected":e}},Bm=["*"],Qm=((Nm=function(){function e(){m(this,e),this.selected=!1}return v(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||Nm)},Nm.\u0275cmp=_.Jb({type:Nm,selectors:[["app-view-list-item"],["","app-view-list-item",""]],inputs:{selected:"selected"},ngContentSelectors:Bm,decls:2,vars:3,consts:[[1,"view-list-item",3,"ngClass"]],template:function(e,t){1&e&&(_.kc(),_.Vb(0,"div",0),_.jc(1),_.Ub()),2&e&&_.lc("ngClass",_.oc(1,Hm,t.selected))},directives:[or.i],styles:['.text-8{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-header{font-weight:700}.text--code{font-family:Courier New,Courier,monospace}.text-uppercase{text-transform:uppercase}.text-xlight{font-weight:200}.text-light{font-weight:300}.text-medium{font-weight:500}.text-semibold{font-weight:600}.text-bold{font-weight:700}.text-underline{text-decoration:underline}.text-italic{font-style:italic}.text-bright{color:#fff}.text-dim{color:#96a8c0}.text-error{color:#ed4758}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.text-ellipsis{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link,.text-link:visited{color:inherit;cursor:pointer}.text-link:not(.text-underline),.text-link:visited:not(.text-underline){text-decoration:none}.text-success{color:#38de38}.text-danger{color:#de3838}.text-info{color:#0060c4}.text-nowrap{white-space:nowrap}.text-pre-line{white-space:pre-line}.button{font-size:12px;letter-spacing:.3px;line-height:1.4em;align-items:center;background:none;border-color:transparent;border-radius:4px;border-width:0;color:inherit;display:flex;font-family:Inter UI,sans-serif;justify-content:center;margin:0;outline:0 none;padding:0 16px;position:relative;text-align:center;text-decoration:none;transition:background-color .12s;width:100%}.button:not([disabled]):hover{cursor:pointer}.button:focus .button--themed{background:#f1f4fa;outline:none}.button:after{content:" ";background-color:#283853;border-radius:4px;display:block;position:absolute;left:0;top:0;bottom:0;right:0;opacity:0;z-index:1;transition:opacity .06s}.button:not(.button--disabled):hover:after{opacity:.7}.button__container{position:relative;z-index:2;width:100%}.button--uppercase{text-transform:uppercase}.button--expanded{display:flex;flex:1}.button--xsmall{height:24px;min-width:24px;padding:0 8px;font-size:10px;letter-spacing:.25px;line-height:1.4em}.button--small{height:32px;min-width:32px;padding:0 12px}.button--medium,.button--small{font-size:12px;letter-spacing:.3px;line-height:1.4em}.button--medium{height:36px;min-width:36px;padding:0 16px}.button--large{height:48px;min-width:48px;padding:0 16px;font-size:14px;letter-spacing:.35px;line-height:1.4em}.button--no-border,.button--no-border:after{border-radius:0!important}.button--left{text-align:left}.button--themed{color:#374a68;color:var(--button-color)}.button--themed:hover{color:#1c2a3f;color:var(--button-color--hover)}.button--themed:after{background-color:#d7e0ea;background-color:var(--button-bg--hover)}.button--dark{color:#d7e0ea}.button--dark:hover{color:#fff}.button--dark:after{background-color:#283853}.button--dark.button--flat{background:#374a68}.button--dark.button--default{background:transparent}.button--dark.button--outline{background:transparent;border:1px solid #374a68;transition:border-color .12s}.button--dark.button--outline:hover{border-color:#96a8c0}.button--dark.button--outline:hover:after{background-color:transparent;display:none}.button--dark.button--text{background:transparent;color:#d7e0ea}.button--dark.button--text:hover{color:#fff}.button--dark.button--text:hover:after{display:none}.button--dark.button--selected{background-color:#1c5ab9;color:#fff}.button--dark.button--selected:hover:after{display:none}.button--light{color:#283853}.button--light:hover{color:#1c2a3f}.button--light:after{background-color:#96a8c0}.button--light:not(.button--disabled):hover:after{opacity:.6}.button--light.button--flat{background:#d7e0ea;font-weight:500}.button--light.button--flat.button--selected{background-color:#96a8c0}.button--light.button--default{background:transparent;color:#131c2a}.button--light.button--default:not(.button--disabled):hover:after{opacity:.2}.button--light.button--outline{background:transparent;border:1px solid #96a8c0;color:#283853;transition:border-color .12s}.button--light.button--outline:after{display:none}.button--light.button--outline:hover{background:rgba(55,74,104,.05);border-color:#374a68;color:#1c2a3f}.button--light.button--outline:hover:after{background-color:transparent}.button--light.button--selected{background-color:#eaeff5}.button--light.button--selected:hover:after{display:none}.button--light.button--text{color:#283853}.button--light.button--text:hover{color:#1c2a3f}.button--light.button--text:hover:after{display:none}.button--primary{background:#de3838;color:#fff}.button--primary:after{background:#f9fafd}.button--primary:hover:after{opacity:.1}.button--info{background:#3892dc;color:#fff}.button--info:after{background:#f9fafd}.button--info:hover:after{opacity:.1}.button--selected{background-color:#1c5ab9}.button--disabled{opacity:.5}.button--circle{border-radius:50%}.button--circle.button--xsmall{width:24px}.button--circle.button--small{width:32px;padding:0 6px}.button--circle.button--medium{width:36px;padding:0 8px}.button--circle.button--large{width:48px}.button--circle:after{border-radius:50%}.button--rounded,.button--rounded:after{border-radius:18px}[app-view-list-item]{border-color:transparent;background:none;border-width:0;padding:0;outline:none;margin:0;pointer-events:all;display:flex;width:100%}[app-view-list-item]::-moz-focus-inner{border:0}[app-view-list-item]:not([disabled]):hover{cursor:pointer}.view-list-item{font-size:14px;letter-spacing:.35px;line-height:1.4em;display:flex;flex-grow:1;flex-direction:row;padding:12px;border-radius:2px;border-left:4px solid transparent;background-color:transparent;color:#131c2a;border-left:var(--view-chapters-border);background-color:var(--view-chapters-bg);color:var(--view-chapters-color);transition:background-color 125ms,color 125ms,border 125ms}.view-list-item:hover{cursor:pointer;background:var(--view-chapters-bg--hover)}.view-list-item:focus{background:#f1f4fa;outline:none}.view-list-item--selected{border-left:4px solid #2d72dc;background-color:#f1f5fc;background:var(--view-chapters-bg--selected);border-left:var(--view-chapters-border--selected)}.view-list-item__index{display:flex;flex:0 0 32px;justify-content:center}.view-list-item__title{word-wrap:break-word;overflow-wrap:break-word;display:flex;flex:1 1 auto;padding-right:4px}.view-list-item__thumb{background-color:#f9fafd;background-color:var(--view-chapters-thumb-bg);background-size:cover;border-radius:4px;background-repeat:no-repeat;flex:0 0 56px;height:56px;width:56px;transition:border-color .1s}'],encapsulation:2,changeDetection:0}),Nm),qm=function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r},Wm=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function $m(e,t){if(1&e){var n=_.Wb();_.Vb(0,"div",2),_.cc("click",(function(){return _.zc(n),_.gc().handleCloseClick()})),_.Ub()}}function Km(e,t){1&e&&(_.Vb(0,"span",15),_.Mc(1,"(On)"),_.Ub())}function Gm(e,t){1&e&&(_.Vb(0,"span",15),_.Mc(1,"(Off)"),_.Ub())}function Zm(e,t){if(1&e){var n=_.Wb();_.Vb(0,"app-view-column",3),_.Vb(1,"nav",4),_.Vb(2,"app-view-panel",5),_.Qb(3,"app-view-logo"),_.Ub(),_.Vb(4,"app-view-panel",5),_.Vb(5,"button",6),_.cc("click",(function(){return _.zc(n),_.gc().handleCloseClick()})),_.Mc(6," Close "),_.Ub(),_.Ub(),_.Vb(7,"app-view-panel",5),_.Vb(8,"button",6),_.cc("click",(function(){return _.zc(n),_.gc().handleToggleToolbar("tools")})),_.Qb(9,"app-icon",7),_.Mc(10," Open Explore Tools "),_.Ub(),_.Vb(11,"button",6),_.cc("click",(function(){return _.zc(n),_.gc().handleToggleToolbar("media")})),_.Qb(12,"app-icon",8),_.Mc(13," Open Media Controls "),_.Ub(),_.Vb(14,"button",6),_.cc("click",(function(){return _.zc(n),_.gc().handleSearchClick()})),_.Qb(15,"app-icon",9),_.Mc(16," Search Anatomy "),_.Ub(),_.Ub(),_.Vb(17,"app-view-panel",5),_.Vb(18,"button",6),_.cc("click",(function(){return _.zc(n),_.gc().handleFullscreenClick()})),_.Qb(19,"app-icon",10),_.Mc(20," Enter Fullscreen "),_.Ub(),_.Ub(),_.Vb(21,"app-view-panel",5),_.Vb(22,"button",6),_.cc("click",(function(){return _.zc(n),_.gc().handleToggleLabelsClick()})),_.Qb(23,"app-icon",11),_.Vb(24,"span",12),_.Mc(25,"Toggle Labels"),_.Ub(),_.Kc(26,Km,2,0,"span",13),_.hc(27,"async"),_.Kc(28,Gm,2,0,"span",13),_.hc(29,"async"),_.Ub(),_.Ub(),_.Vb(30,"app-view-panel",5),_.Vb(31,"button",14),_.cc("click",(function(){return _.zc(n),_.gc().handleTutorialClick()})),_.hc(32,"async"),_.Mc(33," Launch Tutorial "),_.Ub(),_.Vb(34,"button",6),_.cc("click",(function(){return _.zc(n),_.gc().handleHelpBasicsClick()})),_.Mc(35,"3D Navigation Basics"),_.Ub(),_.Vb(36,"button",6),_.cc("click",(function(){return _.zc(n),_.gc().handleHelpShortcutsClick()})),_.Mc(37,"Keyboard Shortcuts"),_.Ub(),_.Ub(),_.Ub(),_.Ub()}if(2&e){var i,o=_.gc();_.lc("@slideInOut",void 0),_.Db(2),_.lc("showHeader",!1),_.Db(2),_.lc("showHeader",!1),_.Db(3),_.lc("showHeader",!1),_.Db(10),_.lc("showHeader",!1),_.Db(4),_.lc("showHeader",!1),_.Db(5),_.lc("ngIf",_.ic(27,10,o.showLabels$)),_.Db(2),_.lc("ngIf",!_.ic(29,12,o.showLabels$)),_.Db(2),_.lc("showHeader",!1),_.Db(1),_.lc("disabled",!(null!=(i=_.ic(32,14,o.selectedChapterReady$))&&i.model))}}var Jm,Xm=((Jm=function(){function e(t,n){m(this,e),this.store=t,this.viewService=n}return v(e,[{key:"ngOnInit",value:function(){}},{key:"handleCloseClick",value:function(){this.store.dispatch(new S.ToggleMenu(!1))}},{key:"handleToggleLabelsClick",value:function(){this.viewService.toggleLabels()}},{key:"handleFullscreenClick",value:function(){this.handleCloseClick(),Kc.toggleFullscreen()}},{key:"handleNewTabClick",value:function(){this.handleCloseClick(),this.viewService.openInNewTab()}},{key:"handleSearchClick",value:function(){this.handleCloseClick(),this.viewService.toggleSearch()}},{key:"handleTutorialClick",value:function(){this.handleCloseClick(),this.viewService.toggleTutorial(!0)}},{key:"handleHelpBasicsClick",value:function(){this.handleCloseClick(),this.viewService.toggleHelp(!0,ve.Basics)}},{key:"handleHelpShortcutsClick",value:function(){this.handleCloseClick(),this.viewService.toggleHelp(!0,ve.Shortcuts)}},{key:"handleToggleToolbar",value:function(e){this.handleCloseClick();var t=this.store.selectSnapshot(hp.getUI);t.media.status=ns.Hide,t.tools.status=ns.Hide,t.toolbar.status=ns.Hide,t[e].status=ns.Show,this.store.dispatch(new S.SetUI(t))}}]),e}()).\u0275fac=function(e){return new(e||Jm)(_.Pb(L.g),_.Pb(Bu))},Jm.\u0275cmp=_.Jb({type:Jm,selectors:[["app-view-menu-column"]],decls:4,vars:6,consts:[["class","view-menu-scrim",3,"click",4,"ngIf"],["placement","right","class","view-menu-column",4,"ngIf"],[1,"view-menu-scrim",3,"click"],["placement","right",1,"view-menu-column"],["app-view-list-container",""],["padding","dense",3,"showHeader"],["app-view-list-item","",3,"click"],["icon","pen",1,"mr-3"],["icon","play",1,"mr-3"],["icon","search",1,"mr-3"],["icon","expand",1,"mr-3"],["icon","tag",1,"mr-3"],[1,"mr-3"],["class","text-dim",4,"ngIf"],["app-view-list-item","",3,"disabled","click"],[1,"text-dim"]],template:function(e,t){1&e&&(_.Kc(0,$m,1,0,"div",0),_.hc(1,"async"),_.Kc(2,Zm,38,16,"app-view-column",1),_.hc(3,"async")),2&e&&(_.lc("ngIf",_.ic(1,2,t.menuOpen$)),_.Db(2),_.lc("ngIf",_.ic(3,4,t.menuOpen$)))},directives:[or.l,zm,Um,Yf,Vm,Qm,Js],pipes:[or.b],styles:[".view-menu-column[_ngcontent-%COMP%]{position:absolute;top:0;right:0;z-index:10000;height:100%}.view-menu-scrim[_ngcontent-%COMP%]{background:rgba(0,0,0,.2);display:flex;position:fixed;justify-content:center;align-items:center;top:0;bottom:0;left:0;right:0;transition:background-color .25s,opacity .25s;z-index:10000}.view-menu-scrim[_ngcontent-%COMP%]:hover{opacity:1;cursor:pointer;background:var(--view-loader-scrim-bg--hover)}"],data:{animation:[Object(fp.n)("slideInOut",[Object(fp.m)(":enter",[Object(fp.l)({transform:"translateX(320px)"}),Object(fp.e)("200ms ease-out",Object(fp.l)({transform:"*"}))]),Object(fp.m)(":leave",[Object(fp.e)("200ms",Object(fp.l)({transform:"translateX(320px)"}))])])]},changeDetection:0}),qm([Object(L.d)(Ua.getSelectedChapterReadyState),Wm("design:type",he.a)],Jm.prototype,"selectedChapterReady$",void 0),qm([Object(L.d)(hp.getMenuOpen),Wm("design:type",he.a)],Jm.prototype,"menuOpen$",void 0),qm([Object(L.d)(hp.getCanTouch),Wm("design:type",he.a)],Jm.prototype,"canTouch$",void 0),qm([Object(L.d)(qa.getShowLabels),Wm("design:type",he.a)],Jm.prototype,"showLabels$",void 0),Jm),Ym=function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r},ey=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function ty(e,t){if(1&e){var n=_.Wb();_.Vb(0,"div",1),_.cc("click",(function(){return _.zc(n),_.gc().handleToggle()}))("keyup.enter",(function(){return _.zc(n),_.gc().handleToggle()})),_.Qb(1,"app-icon",2),_.Ub()}if(2&e){var i=_.gc();_.lc("@show",void 0)("gaLabel",i.isIn?"Show":"Hide"),_.Db(1),_.lc("icon",i.isIn?"caret-right":"caret-left")}}var ny,iy,oy,ay=((ny=function(){function e(t,n,i,o){m(this,e),this.viewService=t,this.layoutService=n,this.changeDetectorRef=i,this.store=o,this.ngUnsubscribe=new ge.a,this.isIn=!1,this.columnToggleVisible=!1}return v(e,[{key:"ngOnInit",value:function(){var e=this;Object(Ka.b)(this.chapter$,this.layout$).pipe(Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){var n=u(t,2),i=(n[0],n[1]);e.isIn=i.column.status===ns.Collapse,e.columnToggleVisible=e.layoutService.isVisible(Rp.ColumnToggle),e.changeDetectorRef.markForCheck()}))}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"isVisible",value:function(){return this.layoutService.isVisible(Rp.ColumnToggle)}},{key:"handleToggle",value:function(){this.viewService.toggleColumn(),this.viewService.toggleSearch(!1),this.viewService.toggleNodeInfo(!1),this.viewService.toggleLabelInfo(!1),this.changeDetectorRef.markForCheck()}}]),e}()).\u0275fac=function(e){return new(e||ny)(_.Pb(Bu),_.Pb(Vp),_.Pb(_.i),_.Pb(L.g))},ny.\u0275cmp=_.Jb({type:ny,selectors:[["app-view-column-toggle"]],decls:1,vars:1,consts:[["class","view-column-toggle","gaEvent","","gaCategory","View Information Panel","gaAction","Clicked Toggle Column","role","button","aria-label","Toggle Column","tabindex","0","matTooltip","Toggle Column","matTooltipPosition","right",3,"gaLabel","click","keyup.enter",4,"ngIf"],["gaEvent","","gaCategory","View Information Panel","gaAction","Clicked Toggle Column","role","button","aria-label","Toggle Column","tabindex","0","matTooltip","Toggle Column","matTooltipPosition","right",1,"view-column-toggle",3,"gaLabel","click","keyup.enter"],[3,"icon"]],template:function(e,t){1&e&&_.Kc(0,ty,2,3,"div",0),2&e&&_.lc("ngIf",t.columnToggleVisible)},directives:[or.l,ke.b,ke.a,rg.c,Js],styles:[".view-column-toggle{background:#fff;color:#131c2a;box-shadow:1px -1px 2px 0 rgba(28,42,63,.1),0 1px 2px 0 rgba(28,42,63,.3);background:var(--view-column-toggle-background);box-shadow:var(--view-column-toggle-shadow);color:var(--view-column-toggle-color);border-radius:0 4px 4px 0;display:flex;justify-content:center;align-items:center;width:24px;height:48px}.view-column-toggle:hover{background-color:#131c2a;background-color:var(--view-column-toggle-background--hover);cursor:pointer}"],encapsulation:2,data:{animation:[Object(fp.n)("show",[Object(fp.m)(":enter",[Object(fp.l)({opacity:0,transform:"translateX(-32px)"}),Object(fp.e)("300ms ease-in-out",Object(fp.l)({opacity:1,transform:"*"}))]),Object(fp.m)(":leave",[Object(fp.e)("300ms ease-in-out",Object(fp.l)({transform:"translateX(-32px)",opacity:0}))])])]},changeDetection:0}),Ym([Object(L.d)(hp.getUI),ey("design:type",he.a)],ny.prototype,"layout$",void 0),Ym([Object(L.d)(Ua.getSelectedChapter),ey("design:type",he.a)],ny.prototype,"chapter$",void 0),ny);function ry(e,t){if(1&e&&(_.Vb(0,"div",6),_.Vb(1,"div",7),_.Qb(2,"app-icon",8),_.Ub(),_.Ub()),2&e){var n=_.gc(2);_.Db(2),_.lc("icon",n.icon)}}function cy(e,t){if(1&e){var n=_.Wb();_.Vb(0,"div",1),_.Kc(1,ry,3,1,"div",2),_.Vb(2,"div",3),_.jc(3),_.Ub(),_.Vb(4,"button",4),_.cc("click",(function(){return _.zc(n),_.gc().handleDismissClicked()})),_.Qb(5,"app-icon",5),_.Ub(),_.Ub()}if(2&e){var i=_.gc();_.Hb("toggle--message","message"===i.type)("toggle--error","error"===i.type)("toggle--notification","notification"===i.type)("toggle--warning","warning"===i.type)("toggle--rounded","rounded"===i.toggleStyle)("toggle--light","light"===i.theme)("toggle--dark","dark"===i.theme),_.lc("@show",void 0),_.Db(1),_.lc("ngIf",i.icon)}}(oy=iy||(iy={})).slideTransition=Object(fp.g)([Object(fp.l)({transform:"translateY({{ from }}%)",opacity:0}),Object(fp.e)("{{ duration }}ms ease-out",Object(fp.l)({transform:"translateY({{ to }})",opacity:1}))]),oy.fadeIn=Object(fp.g)([Object(fp.l)({opacity:0}),Object(fp.e)("{{ duration }}ms ease-out",Object(fp.l)({opacity:1}))]),oy.fadeOut=Object(fp.g)([Object(fp.l)({opacity:"*"}),Object(fp.e)("{{ duration }}ms ease-in",Object(fp.l)({opacity:0}))]);var sy,ly=["*"],py=((sy=function(){function e(t){m(this,e),this.changeRef=t,this.type="message",this.theme="light",this.showDelay=0,this.hideDelay=5e3,this.dismiss=!1,this.toggleStyle="rounded",this.handleDismiss=new ge.a,this._shown=!0,this.shownSubject=new ge.a,this.ngUnsubscribe=new ge.a}return v(e,[{key:"shown",get:function(){return this._shown},set:function(e){this._shown!==e&&(this._shown=e,this.shownSubject.next(e),this.changeRef.markForCheck())}},{key:"ngOnInit",value:function(){this.initViewShownListeners()}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"handleDismissClicked",value:function(){this.handleDismiss.next()}},{key:"initViewShownListeners",value:function(){var e=this;this.shownSubject.pipe(Object(Za.a)(this.hideDelay),Object(be.a)((function(e){return e})),Object(fe.a)(this.ngUnsubscribe)).subscribe((function(){e._shown=!1,e.changeRef.markForCheck()}))}}]),e}()).\u0275fac=function(e){return new(e||sy)(_.Pb(_.i))},sy.\u0275cmp=_.Jb({type:sy,selectors:[["app-message-toggle"]],inputs:{type:"type",theme:"theme",icon:"icon",showDelay:"showDelay",hideDelay:"hideDelay",dismiss:"dismiss",toggleStyle:"toggleStyle",shown:"shown"},outputs:{handleDismiss:"handleDismiss"},ngContentSelectors:ly,decls:1,vars:1,consts:[["class","toggle flex flex-row items-start",3,"toggle--message","toggle--error","toggle--notification","toggle--warning","toggle--rounded","toggle--light","toggle--dark",4,"ngIf"],[1,"toggle","flex","flex-row","items-start"],["class","mr-3",4,"ngIf"],[1,"toggle__content"],[1,"toggle__icon","toggle__dismiss",3,"click"],["icon","times"],[1,"mr-3"],[1,"toggle__icon"],[3,"icon"]],template:function(e,t){1&e&&(_.kc(),_.Kc(0,cy,6,16,"div",0)),2&e&&_.lc("ngIf",t.shown)},directives:[or.l,Js],styles:[".text-8{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-header{font-weight:700}.text--code{font-family:Courier New,Courier,monospace}.text-uppercase{text-transform:uppercase}.text-xlight{font-weight:200}.text-light{font-weight:300}.text-medium{font-weight:500}.text-semibold{font-weight:600}.text-bold{font-weight:700}.text-underline{text-decoration:underline}.text-italic{font-style:italic}.text-bright{color:#fff}.text-dim{color:#96a8c0}.text-error{color:#ed4758}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.text-ellipsis{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link,.text-link:visited{color:inherit;cursor:pointer}.text-link:not(.text-underline),.text-link:visited:not(.text-underline){text-decoration:none}.text-success{color:#38de38}.text-danger{color:#de3838}.text-info{color:#0060c4}.text-nowrap{white-space:nowrap}.text-pre-line{white-space:pre-line}:root{--message-toggle-color:#cadcf7;--message-toggle-background-color:#1c5ab9;--message-toggle-icon-color:#a6c6f8}.toggle{padding:16px;box-sizing:border-box;font-size:13px;letter-spacing:.325px;line-height:1.4em;color:var(--message-toggle-color);background-color:var(--message-toggle-background-color)}.toggle--rounded{border-radius:4px}.toggle__icon{display:flex;flex-direction:column;align-items:center;justify-content:center;color:#fff;font-size:16px;letter-spacing:.4px;line-height:1.4em;background:none;border:none;color:var(--message-toggle-icon-color)}.toggle__content{padding:0 2px;word-break:break-word;flex:1 1 auto}.toggle__dismiss{color:var(--message-toggle-color)}.toggle.toggle--message{--message-toggle-color:#33703c;--message-toggle-background-color:#eaf8ec;--message-toggle-icon-color:#47a75e}.toggle.toggle--notification{--message-toggle-color:#1b355f;--message-toggle-background-color:#d8eefd;--message-toggle-icon-color:blue-60}.toggle.toggle--warning{--message-toggle-color:#8b4e0c;--message-toggle-background-color:#fbf2e4;--message-toggle-icon-color:#eaac1a}.toggle.toggle--error{--message-toggle-color:#7e2525;--message-toggle-background-color:#f6dada;--message-toggle-icon-color:#cb4039}.toggle--dark.toggle--message{--message-toggle-color:#fff;--message-toggle-background-color:#47a75e;--message-toggle-icon-color:#fff}.toggle--dark.toggle--notification{--message-toggle-color:#fff;--message-toggle-background-color:#1c5ab9;--message-toggle-icon-color:#fff}.toggle--dark.toggle--warning{--message-toggle-color:#76430a;--message-toggle-background-color:#f7e7a1;--message-toggle-icon-color:#76430a}.toggle--dark.toggle--error{--message-toggle-color:#fff;--message-toggle-background-color:#cb4039;--message-toggle-icon-color:#fff}"],encapsulation:2,data:{animation:[Object(fp.n)("show",[Object(fp.m)(":enter",[Object(fp.o)(iy.fadeIn,{params:{duration:300}})]),Object(fp.m)(":leave",[Object(fp.o)(iy.fadeOut,{params:{duration:300}})])])]},changeDetection:0}),sy);function uy(e,t){if(1&e){var n=_.Wb();_.Vb(0,"div",1),_.Vb(1,"app-message-toggle",2),_.cc("handleDismiss",(function(){return _.zc(n),_.gc().handleDismiss()})),_.Vb(2,"div"),_.Mc(3," This model appears to be performing slowly on your device. For an optimal experience, please switch to a different device or try another model. "),_.Ub(),_.Ub(),_.Ub()}2&e&&(_.Db(1),_.lc("dismiss",!0))}var dy,gy,hy,fy,by,vy=[],my=((fy=function(){function e(t,n){m(this,e),this.storageService=t,this.changeRef=n,this.shown=!1,this.sampling=!1}return v(e,[{key:"ngOnInit",value:function(){this.storageService.getLocalItem(zc.Iphone12Warning)||this.testDevices()}},{key:"ngOnDestroy",value:function(){this.sampling=!1}},{key:"testDevices",value:function(){var e=window.matchMedia("only screen and (device-width: 390px) and (device-height: 844px) and (-webkit-device-pixel-ratio: 3)"),t=window.matchMedia("only screen and (device-width: 428px) and (device-height: 926px) and (-webkit-device-pixel-ratio: 3)"),n=window.matchMedia("only screen and (device-width: 820px) and (device-height: 1180px) and (-webkit-device-pixel-ratio: 2)"),i=e.matches||t.matches||n.matches,o=/iPhone|iPad/.test(navigator.userAgent),a=/OS\s14/.test(navigator.userAgent);i&&o&&a&&this.startFrameSampling()}},{key:"startFrameSampling",value:function(){var e=this;this.sampling=!0,dy=0,gy=Date.now(),requestAnimationFrame((function t(){e.frame()?(e.shown=!0,e.changeRef.markForCheck()):e.sampling&&requestAnimationFrame(t)}))}},{key:"frame",value:function(){dy++;var e=Date.now();if(e>=gy+500){var t=Math.floor(500*dy/(e-gy)*2);if(vy.push(t),vy.length>3&&vy.shift(),3===vy.length&&(vy[0]+vy[1]+vy[2])/3<10)return!0;gy=e,dy=0}}},{key:"handleDismiss",value:function(){this.shown=!1,this.changeRef.markForCheck(),this.storageService.setLocalItem(zc.Iphone12Warning,!0)}}]),e}()).\u0275fac=function(e){return new(e||fy)(_.Pb(Lc),_.Pb(_.i))},fy.\u0275cmp=_.Jb({type:fy,selectors:[["app-view-iphone12-warning"]],decls:1,vars:1,consts:[["class","warning",4,"ngIf"],[1,"warning"],["type","warning","toggleStyle","flat","icon","info-circle",3,"dismiss","handleDismiss"]],template:function(e,t){1&e&&_.Kc(0,uy,4,1,"div",0),2&e&&_.lc("ngIf",t.shown)},directives:[or.l,py],styles:[".warning[_ngcontent-%COMP%]{position:fixed;top:0;left:0;right:0;z-index:1002}.warning__text[_ngcontent-%COMP%]{text-align:center;flex:1}"],changeDetection:0}),fy),yy=((hy=function(){function e(){m(this,e)}return v(e,[{key:"onClick",value:function(e,t){t.select()}}]),e}()).\u0275fac=function(e){return new(e||hy)},hy.\u0275dir=_.Kb({type:hy,selectors:[["","appSelectOnFocus",""]],hostBindings:function(e,t){1&e&&_.cc("click",(function(e){return t.onClick(e,e.target)}))}}),hy),xy=function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r},wy=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},ky=["searchInput"],Oy=function(e){return{"view-search__action--selected":e}},Cy=((by=function(){function e(t,n,i){m(this,e),this.viewService=t,this.engineService=n,this.store=i,this.ngUnsubscribe=new ge.a,this.query="",this.treeTheme=gs,this.treeSearchDisplayMode=Wl}return v(e,[{key:"ngOnInit",value:function(){this.initViewGraphSubscription()}},{key:"initViewGraphSubscription",value:function(){var e=this;this.store.select(Ua.getSelectedChapterId).pipe(Object(be.a)((function(e){return null!=e})),Object(Ja.a)(),Object(fe.a)(this.ngUnsubscribe)).subscribe((function(){e.store.dispatch(new De(e.engineService.createViewGraph({},!1)))}))}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"handleSearchKeyup",value:function(e,t){"Escape"===e.key&&(this.handleExitClick(),this.searchInput.nativeElement.blur()),this.query=t}},{key:"handleExitClick",value:function(){this.query="",this.viewService.toggleSearch(!1)}},{key:"toggleDisplayMode",value:function(){var e=this.store.selectSnapshot(hp.getSearchDisplayMode);e=e===Wl.List?Wl.Tree:Wl.List,this.setDisplayMode(e)}},{key:"setDisplayMode",value:function(e){this.store.dispatch(new S.SetSearchDisplayMode(e))}},{key:"handleTreeButtonClick",value:function(){this.setDisplayMode(Wl.Tree)}},{key:"handleListButtonClick",value:function(){this.setDisplayMode(Wl.List)}}]),e}()).\u0275fac=function(e){return new(e||by)(_.Pb(Bu),_.Pb(Nt),_.Pb(L.g))},by.\u0275cmp=_.Jb({type:by,selectors:[["app-view-search"]],viewQuery:function(e,t){var n;1&e&&_.Rc(ky,!0),2&e&&_.uc(n=_.dc())&&(t.searchInput=n.first)},decls:23,vars:23,consts:[["gaCategory","View Search",1,"view-search"],[1,"view-search__header"],[1,"view-search__actions-row"],[1,"view-search__actions"],["gaEvent","","gaAction","Clicked Anatomy Tree","type","button","aria-label","Switch to Anatomy Tree",1,"view-search__action",3,"ngClass","matTooltip","click"],["aria-hidden","true",1,"view-search__action-icon",3,"icon"],["gaEvent","","gaAction","Clicked Anatomy List","type","button","aria-label","Switch to Anatomy List",1,"view-search__action",3,"ngClass","matTooltip","click"],["gaEvent","","gaAction","Clicked Exit","type","button","matTooltip","Close Search","aria-label","Close Search",1,"view-search__exit",3,"click"],["icon","times"],[1,"view-search__input-row"],[1,"view-search__input-container"],["icon","search",1,"view-search__input-icon"],["appAutoFocus","","appSelectOnFocus","","role","search","type","text","aria-label","Search Anatomy","placeholder","Search Anatomy",1,"view-search__input",3,"value","keyup"],["searchInput",""],[1,"view-search__body"],[3,"displayMode","theme","query","viewGraph"]],template:function(e,t){if(1&e){var n=_.Wb();_.Vb(0,"div",0),_.Vb(1,"div",1),_.Vb(2,"div",2),_.Vb(3,"div",3),_.Vb(4,"button",4),_.cc("click",(function(){return t.handleTreeButtonClick()})),_.hc(5,"async"),_.Qb(6,"app-icon",5),_.Mc(7,"Tree "),_.Ub(),_.Vb(8,"button",6),_.cc("click",(function(){return t.handleListButtonClick()})),_.hc(9,"async"),_.Qb(10,"app-icon",5),_.Mc(11,"List "),_.Ub(),_.Ub(),_.Vb(12,"button",7),_.cc("click",(function(){return t.handleExitClick()})),_.Qb(13,"app-icon",8),_.Ub(),_.Ub(),_.Vb(14,"div",9),_.Vb(15,"div",10),_.Qb(16,"app-icon",11),_.Vb(17,"input",12,13),_.cc("keyup",(function(e){_.zc(n);var i=_.vc(18);return t.handleSearchKeyup(e,i.value)})),_.Ub(),_.Ub(),_.Ub(),_.Ub(),_.Vb(19,"div",14),_.Qb(20,"app-tree-search",15),_.hc(21,"async"),_.hc(22,"async"),_.Ub(),_.Ub()}2&e&&(_.Db(4),_.lc("ngClass",_.oc(19,Oy,_.ic(5,11,t.searchDisplayMode$)===t.treeSearchDisplayMode.Tree))("matTooltip","Switch to Anatomy Tree"),_.Db(2),_.lc("icon","sitemap"),_.Db(2),_.lc("ngClass",_.oc(21,Oy,_.ic(9,13,t.searchDisplayMode$)===t.treeSearchDisplayMode.List))("matTooltip","Switch to Anatomy List"),_.Db(2),_.lc("icon","list"),_.Db(7),_.lc("value",t.query),_.Db(3),_.lc("displayMode",_.ic(21,15,t.searchDisplayMode$))("theme",t.treeTheme.Themed)("query",t.query)("viewGraph",_.ic(22,17,t.viewGraph$)))},directives:[ke.a,ke.b,or.i,rg.c,Js,jl,yy,$l],pipes:[or.b],styles:[".view-search{display:flex;flex-direction:column;height:100%}@-webkit-keyframes appear{0%{background-color:transparent}}@keyframes appear{0%{background-color:transparent}}.view-search__header{flex:0 0 auto;flex-direction:column;display:flex;-webkit-animation:appear .25s ease-out;animation:appear .25s ease-out}.view-search__actions-row{flex:0 0 auto;display:flex;padding:0 12px;justify-content:space-between;align-items:center;border-bottom:1px solid var(--view-search-border-color)}.view-search__actions{display:flex;height:56px;flex:1;justify-content:space-between}.view-search__action{text-transform:uppercase;background:transparent;display:flex;align-items:center;justify-content:center;border:0;border-bottom:4px solid transparent;color:#374a68;color:var(--view-search-tab-color);cursor:pointer;width:49%;outline:none;padding-top:4px}.view-search__action:hover:not(.view-search__action--selected){color:#131c2a;border-bottom-color:#d7e0ea;color:var(--view-search-tab-hover-color);border-bottom-color:var(--view-search-tab-hover-border)}.view-search__action--selected{color:#131c2a;border-bottom-color:#2d72dc;color:var(--view-search-tab-active-color);border-bottom-color:var(--view-search-tab-active-border)}.view-search__action-icon{margin-right:8px}.view-search__exit{display:flex;align-items:center;justify-content:center;border:0;border-radius:50%;color:#374a68;background-color:#d7e0ea;color:var(--view-search-exit-color);background-color:var(--view-search-exit-bg);opacity:.8;cursor:pointer;width:28px;height:28px;margin-left:12px;outline:none}.view-search__input-row{flex:0 0 auto;display:flex;padding:12px}.view-search__input-container{background-color:#fff;background-color:var(--view-search-input-bg);border:1px solid var(--view-search-border-color);display:flex;flex-grow:1;border-radius:4px}.view-search__input-icon{background:0 0;display:flex;align-items:center;justify-content:center;color:#96a8c0;color:var(--view-search-inactive-color);width:36px;height:36px;outline:0}.view-search__input{color:#131c2a;color:var(--view-search-active-color);background:transparent;border:1px solid transparent;outline:none;flex:1 0 auto;padding:8px 12px 8px 0;font-size:13px}.view-search__input::-ms-clear{display:none}.view-search__input::-moz-placeholder{color:#96a8c0;color:var(--view-search-inactive-color)}.view-search__input:-ms-input-placeholder{color:#96a8c0;color:var(--view-search-inactive-color)}.view-search__input::placeholder{color:#96a8c0;color:var(--view-search-inactive-color)}.view-search__body{flex:1 1 100%;overflow-y:scroll;padding-left:12px}.view-search__input{font-family:Inter UI,Font Awesome\\ 5 Pro!important}@media not all and (min-resolution:0.001dpcm){@supports (-webkit-appearance:none){.view-search__input{font-size:16px;padding:4px 8px;width:0}}}"],encapsulation:2,changeDetection:0}),xy([Object(L.d)(qa.getViewGraph),wy("design:type",he.a)],by.prototype,"viewGraph$",void 0),xy([Object(L.d)(hp.getSearchDisplayMode),wy("design:type",he.a)],by.prototype,"searchDisplayMode$",void 0),by),Sy=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function _y(e,t){if(1&e){var n=_.Wb();_.Vb(0,"button",6),_.cc("click",(function(){return _.zc(n),_.gc().handleCloseClick()})),_.Ub()}}function jy(e,t){if(1&e&&_.Qb(0,"div",7),2&e){var n=_.gc();_.Hb("text-italic",!(null!=n.node&&n.node.description)),_.lc("innerHTML",n.formatHTML((null==n.node?null:n.node.description)||"No description available"),_.Ac)}}function Py(e,t){1&e&&(_.Vb(0,"div",8),_.Mc(1," Source: "),_.Vb(2,"span",9),_.Mc(3,"Wikipedia"),_.Ub(),_.Ub())}var My,Iy=function(e,t){return{"view-node-description--layout-column":e,"view-node-description--layout-drawer":t}},zy=((My=function(){function e(t,n,i){m(this,e),this.store=t,this.actions=n,this.changeRef=i,this.layout=Np.Drawer,this.showClose=!0,this.isOpen=!1,this.ngUnsubscribe=new ge.a}return v(e,[{key:"ngOnInit",value:function(){var e=this;this.initInfoListeners(),this.store.select(Fi.getSelectedNode).pipe(Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){void 0!==t&&(e.node=e.store.selectSnapshot(qa.getViewGraphNode)(t.objectId))}))}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"handleHideClick",value:function(e){this.store.dispatch(new pi.UpdateNodesShown(!1,[e.id]))}},{key:"handleCloseClick",value:function(){var e=this.store.selectSnapshot(hp.getUI);e.nodeInfo.status=ns.Hide,this.store.dispatch(new S.SetUI(e))}},{key:"initInfoListeners",value:function(){var e=this;this.actions.pipe(Object(L.i)(yt,xt,vt),Object(fe.a)(this.ngUnsubscribe)).subscribe((function(){e.isOpen=!0,e.changeRef.markForCheck()}))}},{key:"formatHTML",value:function(e){return e.trim().replace(new RegExp("\r?\n","g"),"<br><br>")}}]),e}()).\u0275fac=function(e){return new(e||My)(_.Pb(L.g),_.Pb(L.b),_.Pb(_.i))},My.\u0275cmp=_.Jb({type:My,selectors:[["app-view-node-description"]],inputs:{layout:"layout",showClose:"showClose"},decls:8,vars:10,consts:[[1,"view-node-description",3,"ngClass"],[1,"view-node-description__header"],["app-pin-button","","size","small","icon","arrow-left","class","mr-1 mt-1",3,"click",4,"ngIf"],[1,"view-node-description__title"],["class","view-node-description__body",3,"text-italic","innerHTML",4,"ngIf"],["class","view-node-description__attribution",4,"ngIf"],["app-pin-button","","size","small","icon","arrow-left",1,"mr-1","mt-1",3,"click"],[1,"view-node-description__body",3,"innerHTML"],[1,"view-node-description__attribution"],[1,"text-italic"]],template:function(e,t){1&e&&(_.Vb(0,"div",0),_.Vb(1,"div",1),_.Kc(2,_y,1,0,"button",2),_.Vb(3,"div",3),_.Mc(4),_.Ub(),_.Ub(),_.Kc(5,jy,1,3,"div",4),_.hc(6,"async"),_.Kc(7,Py,4,0,"div",5),_.Ub()),2&e&&(_.lc("ngClass",_.pc(7,Iy,"column"===t.layout,"drawer"===t.layout)),_.Db(2),_.lc("ngIf",t.showClose),_.Db(2),_.Nc(null==t.node?null:t.node.label),_.Db(1),_.lc("ngIf",!_.ic(6,5,t.querying$)),_.Db(2),_.lc("ngIf",null==t.node?null:t.node.description))},directives:[or.i,or.l,ag],pipes:[or.b],styles:[".text-8{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-header{font-weight:700}.text--code{font-family:Courier New,Courier,monospace}.text-uppercase{text-transform:uppercase}.text-xlight{font-weight:200}.text-light{font-weight:300}.text-medium{font-weight:500}.text-semibold{font-weight:600}.text-bold{font-weight:700}.text-underline{text-decoration:underline}.text-italic{font-style:italic}.text-bright{color:#fff}.text-dim{color:#96a8c0}.text-error{color:#ed4758}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.text-ellipsis{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link,.text-link:visited{color:inherit;cursor:pointer}.text-link:not(.text-underline),.text-link:visited:not(.text-underline){text-decoration:none}.text-success{color:#38de38}.text-danger{color:#de3838}.text-info{color:#0060c4}.text-nowrap{white-space:nowrap}.text-pre-line{white-space:pre-line}.view-node-description{display:flex;flex-direction:column}.view-node-description--layout-drawer .view-node-description__body{margin-top:8px}.view-node-description--layout-column .view-node-description__body{margin-top:4px}.view-node-description__header{display:flex}.view-node-description__title{font-size:18px;letter-spacing:.45px;line-height:1.4em;flex:1 1 auto;font-weight:600;align-self:center}.view-node-description--layout-drawer .view-node-description__title,.view-node-description__body{font-size:14px;letter-spacing:.35px;line-height:1.4em}.view-node-description__attribution,.view-node-description__body{color:var(--view-description-secondary-color)}.view-node-description__attribution{margin-top:16px;font-size:12px;letter-spacing:.3px;line-height:1.4em}.view-node-description__actions{cursor:pointer;outline:none;border:none;background:transparent;padding:4px 8px}"],encapsulation:2,changeDetection:0}),function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);a>3&&r&&Object.defineProperty(t,n,r)}([Object(L.d)(qa.getQuerying),Sy("design:type",he.a)],My.prototype,"querying$",void 0),My),Ty=function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r},Uy=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function Ly(e,t){1&e&&(_.Tb(0),_.Qb(1,"app-view-title"),_.Qb(2,"app-view-content-mode",6),_.Sb())}function Dy(e,t){1&e&&_.Qb(0,"app-view-quiz")}function Ey(e,t){if(1&e&&(_.Vb(0,"app-view-column",3),_.Tb(1,4),_.Kc(2,Ly,3,0,"ng-container",5),_.hc(3,"async"),_.Kc(4,Dy,1,0,"app-view-quiz",5),_.hc(5,"async"),_.Sb(),_.Ub()),2&e){var n=_.gc();_.lc("@slideInOut",void 0),_.Db(2),_.lc("ngIf",!_.ic(3,3,n.quizModeActive$)),_.Db(2),_.lc("ngIf",_.ic(5,5,n.quizModeActive$))}}function Fy(e,t){1&e&&(_.Vb(0,"app-view-column",7),_.Qb(1,"app-view-search"),_.Ub()),2&e&&_.lc("unpadded",!0)("@slideInOut",void 0)}function Ay(e,t){1&e&&(_.Vb(0,"app-view-column",3),_.Qb(1,"app-view-node-description",6),_.Ub()),2&e&&_.lc("@slideInOut",void 0)}var Ry,Ny=function(){return{"view-column-container--header-offset":!0}},Vy=((Ry=function(){function e(t,n,i){m(this,e),this.viewService=t,this.layoutService=n,this.changeDetectorRef=i,this.ngUnsubscribe=new ge.a,this.viewLayout=Rp,this.application=j,this.columnVisible=!1,this.searchVisible=!1,this.nodeInfoVisible=!1}return v(e,[{key:"ngOnInit",value:function(){this.initLayoutObserver()}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"initLayoutObserver",value:function(){var e=this;Object(Ka.b)(this.layout$,this.chapter$).pipe(Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){var n;f(n=t)||l(n)||g(n)||d(),e.columnVisible=e.layoutService.isVisible(Rp.Column),e.searchVisible=e.layoutService.isVisible(Rp.Search),e.nodeInfoVisible=e.layoutService.isVisible(Rp.NodeInfo),e.changeDetectorRef.markForCheck()}))}},{key:"handleSearchClick",value:function(){this.viewService.toggleSearch(!0)}}]),e}()).\u0275fac=function(e){return new(e||Ry)(_.Pb(Bu),_.Pb(Vp),_.Pb(_.i))},Ry.\u0275cmp=_.Jb({type:Ry,selectors:[["app-view-column-container"]],decls:4,vars:5,consts:[[1,"view-column-container",3,"ngClass"],["class","view-column-container__inner",4,"ngIf"],["class","view-column-container__inner",3,"unpadded",4,"ngIf"],[1,"view-column-container__inner"],["view-column-body",""],[4,"ngIf"],["layout","column"],[1,"view-column-container__inner",3,"unpadded"]],template:function(e,t){1&e&&(_.Vb(0,"div",0),_.Kc(1,Ey,6,7,"app-view-column",1),_.Kc(2,Fy,2,2,"app-view-column",2),_.Kc(3,Ay,2,1,"app-view-column",1),_.Ub()),2&e&&(_.lc("ngClass",_.nc(4,Ny)),_.Db(1),_.lc("ngIf",t.columnVisible),_.Db(1),_.lc("ngIf",t.searchVisible),_.Db(1),_.lc("ngIf",t.nodeInfoVisible))},directives:[or.i,or.l,zm,$f,_b,tm,Cy,zy],pipes:[or.b],styles:[".view-column-container{pointer-events:none;height:100%;width:320px;position:absolute;left:0;top:0;z-index:30}.view-column-container app-view-column{position:absolute;left:0;top:0;height:100%;z-index:40}"],encapsulation:2,data:{animation:[Object(fp.n)("slideInOut",[Object(fp.m)(":enter",[Object(fp.l)({transform:"translateX(-320px)"}),Object(fp.e)("300ms ease-in-out",Object(fp.l)({transform:"*"}))]),Object(fp.m)(":leave",[Object(fp.e)("300ms ease-in-out",Object(fp.l)({transform:"translateX(-320px)"}))])])]},changeDetection:0}),Ty([Object(L.d)(Ua.getSelectedChapter),Uy("design:type",he.a)],Ry.prototype,"chapter$",void 0),Ty([Object(L.d)(hp.getUI),Uy("design:type",he.a)],Ry.prototype,"layout$",void 0),Ty([Object(L.d)(So.getQuizModeActive),Uy("design:type",he.a)],Ry.prototype,"quizModeActive$",void 0),Ry);function Hy(e,t){if(1&e){var n=_.Wb();_.Vb(0,"button",7),_.cc("click",(function(){return _.zc(n),_.gc(2).handleActionClick()})),_.Mc(1),_.Ub()}if(2&e){var i=_.gc(2);_.Db(1),_.Oc(" ",i.notification.action," ")}}function By(e,t){if(1&e){var n=_.Wb();_.Vb(0,"div",1),_.Vb(1,"div",2),_.Vb(2,"div",3),_.Mc(3),_.Ub(),_.Vb(4,"button",4),_.cc("click",(function(){return _.zc(n),_.gc().handleCloseClick()})),_.Qb(5,"app-icon",5),_.Ub(),_.Ub(),_.Kc(6,Hy,2,1,"button",6),_.Ub()}if(2&e){var i=_.gc();_.lc("@show",void 0),_.Db(3),_.Oc(" ",i.notification.body," "),_.Db(3),_.lc("ngIf",i.notification.action)}}var Qy,qy,Wy,$y=((Qy=function(){function e(){m(this,e),this.closeClick=new _.p}return v(e,[{key:"ngOnInit",value:function(){}},{key:"handleActionClick",value:function(){this.close(this.notification.action)}},{key:"handleCloseClick",value:function(){this.close()}},{key:"close",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.notification=null,this.closeClick.emit({action:e,data:this.notification})}}]),e}()).\u0275fac=function(e){return new(e||Qy)},Qy.\u0275cmp=_.Jb({type:Qy,selectors:[["app-notification"]],inputs:{notification:"notification"},outputs:{closeClick:"closeClick"},decls:1,vars:1,consts:[["class","notification",4,"ngIf"],[1,"notification"],[1,"flex"],[1,"notification__body","flex-grow"],["type","button",1,"notification__button","notification__button--close",3,"click"],["icon","times"],["class","notification__button notification__button--full","type","button",3,"click",4,"ngIf"],["type","button",1,"notification__button","notification__button--full",3,"click"]],template:function(e,t){1&e&&_.Kc(0,By,7,3,"div",0),2&e&&_.lc("ngIf",t.notification)},directives:[or.l,Js],styles:[".text-8{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-header{font-weight:700}.text--code{font-family:Courier New,Courier,monospace}.text-uppercase{text-transform:uppercase}.text-xlight{font-weight:200}.text-light{font-weight:300}.text-medium{font-weight:500}.text-semibold{font-weight:600}.text-bold{font-weight:700}.text-underline{text-decoration:underline}.text-italic{font-style:italic}.text-bright{color:#fff}.text-dim{color:#96a8c0}.text-error{color:#ed4758}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.text-ellipsis{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link,.text-link:visited{color:inherit;cursor:pointer}.text-link:not(.text-underline),.text-link:visited:not(.text-underline){text-decoration:none}.text-success{color:#38de38}.text-danger{color:#de3838}.text-info{color:#0060c4}.text-nowrap{white-space:nowrap}.text-pre-line{white-space:pre-line}.notification{font-size:12px;letter-spacing:.3px;line-height:1.4em;background:#2d72dc;width:320px;border-radius:4px;box-shadow:0 2px 4px rgba(0,0,0,.08),0 4px 6px rgba(0,0,0,.12)}.notification__body{color:#fff;padding:16px}.notification__button{align-items:center;justify-content:center;background:#2d72dc;border:0;color:#fff;display:flex;font-weight:600;height:36px;font-size:12px;letter-spacing:.3px;line-height:1.4em}.notification__button:hover{background-color:#4381e0;cursor:pointer}.notification__button--close{border-radius:0 4px 0 4px;flex:0 0 36px;height:36px}.notification__button--full{border-radius:0 0 4px 4px;border-top:1px solid hsla(0,0%,100%,.2);justify-content:left;padding:0 16px;text-overflow:ellipsis;white-space:nowrap;width:100%}"],encapsulation:2,data:{animation:[Object(fp.n)("show",[Object(fp.m)(":enter",[Object(fp.o)(iy.fadeIn,{params:{duration:300}})])])]},changeDetection:0}),Qy),Ky=function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r},Gy=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Zy={stacksForChapter:{}},Jy=((Wy=function(){function e(t){m(this,e),this.store=t}return v(e,[{key:"reset",value:function(e,t){e.patchState(immer.produce(e.getState(),(function(e){e.stacksForChapter={}})))}},{key:"undoAll",value:function(e,t){var n=e.getState();if(void 0!==n.stacksForChapter[t.chapterId]){var i=s(n.stacksForChapter[t.chapterId].undoStack).reverse(),o=i.flat().reduce((function(e,t){return void 0===e[t.patchAction]&&(e[t.patchAction]={action:t.patchAction,patches:[]}),e[t.patchAction].patches=[].concat(s(e[t.patchAction].patches),s(t.inverse)),e}),{});Object.keys(o).forEach((function(t){e.dispatch(new o[t].action(o[t].patches))}));var a=immer.produce(n,(function(e){e.stacksForChapter[t.chapterId].undoStack=[],e.stacksForChapter[t.chapterId].redoStack=i}));e.patchState(a)}}},{key:"preserveState",value:function(e,t){var n=this.store.selectSnapshot(Ua.getSelectedChapterId),i=immer.produce(e.getState(),(function(e){0!==t.patches.length&&(t.patches.some((function(e){return 0===e.forward.length}))&&t.patches.some((function(e){return 0===e.inverse.length}))||(void 0===e.stacksForChapter[n]&&(e.stacksForChapter[n]={redoStack:[],undoStack:[]}),e.stacksForChapter[n].redoStack=[],e.stacksForChapter[n].undoStack.push(t.patches)))}));e.patchState(i)}},{key:"redo",value:function(e,t){var n=e.getState(),i=Object(Oe.get)(n.stacksForChapter[t.chapterId],"redoStack",[]);if(0!==i.length){var o=i[i.length-1],a=immer.produce(n,(function(e){e.stacksForChapter[t.chapterId].redoStack.pop(),e.stacksForChapter[t.chapterId].undoStack.push(o)}));e.patchState(a),o.forEach((function(t){e.dispatch(new t.patchAction(t.forward))}))}}},{key:"undo",value:function(e,t){var n=e.getState(),i=Object(Oe.get)(n.stacksForChapter[t.chapterId],"undoStack",[]);if(0!==i.length){var o=i[i.length-1],a=immer.produce(n,(function(e){e.stacksForChapter[t.chapterId].undoStack.pop(),e.stacksForChapter[t.chapterId].redoStack.push(o)}));e.patchState(a),o.forEach((function(t){e.dispatch(new t.patchAction(t.inverse))}))}}}],[{key:"canUndo",value:function(e,t){return e.stacksForChapter[t.selectedChapter].undoStack.length>0}},{key:"canRedo",value:function(e,t){return e.stacksForChapter[t.selectedChapter].redoStack.length>0}},{key:"getUndoCount",value:function(e,t){return e.stacksForChapter[t.selectedChapter].undoStack.length||0}}]),e}()).\u0275fac=function(e){return new(e||Wy)(_.Zb(L.g))},Wy.\u0275prov=_.Lb({token:Wy,factory:Wy.\u0275fac}),Ky([Object(L.a)(ui.Reset),Gy("design:type",Function),Gy("design:paramtypes",[Object,ui.Reset]),Gy("design:returntype",void 0)],Wy.prototype,"reset",null),Ky([Object(L.a)(ui.UndoAll),Gy("design:type",Function),Gy("design:paramtypes",[Object,ui.UndoAll]),Gy("design:returntype",void 0)],Wy.prototype,"undoAll",null),Ky([Object(L.a)(ui.SavePatches),Gy("design:type",Function),Gy("design:paramtypes",[Object,ui.SavePatches]),Gy("design:returntype",void 0)],Wy.prototype,"preserveState",null),Ky([Object(L.a)(ui.Redo),Gy("design:type",Function),Gy("design:paramtypes",[Object,ui.Redo]),Gy("design:returntype",void 0)],Wy.prototype,"redo",null),Ky([Object(L.a)(ui.Undo),Gy("design:type",Function),Gy("design:paramtypes",[Object,ui.Undo]),Gy("design:returntype",void 0)],Wy.prototype,"undo",null),Ky([Object(L.e)([Ua]),Gy("design:type",Function),Gy("design:paramtypes",[Object,fn]),Gy("design:returntype",Boolean)],Wy,"canUndo",null),Ky([Object(L.e)([Ua]),Gy("design:type",Function),Gy("design:paramtypes",[Object,fn]),Gy("design:returntype",Boolean)],Wy,"canRedo",null),Ky([Object(L.e)([Ua]),Gy("design:type",Function),Gy("design:paramtypes",[Object,fn]),Gy("design:returntype",Number)],Wy,"getUndoCount",null),Wy=Ky([Object(L.f)({name:"undo",defaults:Zy})],Wy)),Xy=((qy=function(){function e(){m(this,e)}return v(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||qy)},qy.\u0275cmp=_.Jb({type:qy,selectors:[["app-pillbox-divider"]],decls:1,vars:0,consts:[[1,"pillbox-divider"]],template:function(e,t){1&e&&_.Qb(0,"div",0)},styles:[".pillbox-divider{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;border-right:1px solid rgba(0,0,0,.1);border-right:var(--pillbox-border);height:18px;margin:0 8px}"],encapsulation:2,changeDetection:0}),qy);function Yy(e,t){if(1&e){var n=_.Wb();_.Tb(0),_.Qb(1,"app-pillbox-divider"),_.Vb(2,"button",2),_.cc("click",(function(){return _.zc(n),_.gc().handleExitClick()})),_.Ub(),_.Sb()}if(2&e){var i=_.gc();_.Db(2),_.lc("gaAction","Clicked Close "+i.name)("matTooltip","Close "+i.name),_.Eb("aria-label","Close "+i.name)}}var ex,tx=function(e,t,n){return{"pillbox--padding-dense":e,"pillbox--padding-none":t,"pillbox--vertical":n}},nx=["*"],ix=((ex=function(){function e(){m(this,e),this.canExit=!1,this.padding="normal",this.orientation="horizontal",this.name="",this.eventCategory="",this.exit=new _.p}return v(e,[{key:"ngOnInit",value:function(){}},{key:"handleExitClick",value:function(){this.exit.emit()}}]),e}()).\u0275fac=function(e){return new(e||ex)},ex.\u0275cmp=_.Jb({type:ex,selectors:[["app-pillbox"]],inputs:{canExit:"canExit",padding:"padding",orientation:"orientation",name:"name",eventCategory:"eventCategory"},outputs:{exit:"exit"},ngContentSelectors:nx,decls:3,vars:7,consts:[[1,"pillbox",3,"gaCategory","ngClass"],[4,"ngIf"],["gaEvent","","data-test","closePillboxButton","app-pin-button","","buttonType","ghost","icon","times",3,"gaAction","matTooltip","click"]],template:function(e,t){1&e&&(_.kc(),_.Vb(0,"div",0),_.jc(1),_.Kc(2,Yy,3,3,"ng-container",1),_.Ub()),2&e&&(_.lc("gaCategory",t.eventCategory)("ngClass",_.qc(3,tx,"dense"===t.padding,"none"===t.padding,"vertical"===t.orientation)),_.Db(2),_.lc("ngIf",t.canExit))},directives:[ke.a,or.i,or.l,Xy,ag,ke.b,rg.c],styles:[".pillbox{border-radius:32px;background-color:hsla(0,0%,100%,.9);box-shadow:1px -1px 2px 0 rgba(28,42,63,.1),0 1px 2px 0 rgba(28,42,63,.3);color:#131c2a;background-color:var(--pillbox-bg);box-shadow:var(--pillbox-shadow);color:var(--pillbox-color);padding:6px;display:inline-flex;justify-content:center;align-items:center;overflow:hidden;transition:padding .15s}.pillbox--padding-dense{padding:4px}.pillbox--padding-none{padding:0}.pillbox--vertical{flex-direction:column;padding:6px}"],encapsulation:2,changeDetection:0}),ex),ox=function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r},ax=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function rx(e,t){if(1&e){var n=_.Wb();_.Vb(0,"div",1),_.Vb(1,"app-pillbox",2),_.Vb(2,"button",3),_.cc("click",(function(){return _.zc(n),_.gc().handleUndoClick()})),_.hc(3,"async"),_.hc(4,"async"),_.Ub(),_.Vb(5,"button",4),_.cc("click",(function(){return _.zc(n),_.gc().handleRedoClick()})),_.hc(6,"async"),_.hc(7,"async"),_.Ub(),_.Vb(8,"button",5),_.cc("click",(function(){return _.zc(n),_.gc().handleResetClick()})),_.hc(9,"async"),_.hc(10,"async"),_.Vb(11,"span",6),_.Mc(12,"Reset"),_.Ub(),_.Ub(),_.Ub(),_.Ub()}if(2&e){var i=_.gc();_.lc("@show",void 0),_.Db(2),_.lc("disabled",!_.ic(4,9,i.canUndo$)),_.Eb("aria-disabled",!_.ic(3,7,i.canUndo$)),_.Db(3),_.lc("disabled",!_.ic(7,13,i.canRedo$)),_.Eb("aria-disabled",!_.ic(6,11,i.canRedo$)),_.Db(3),_.lc("disabled",!_.ic(10,17,i.canUndo$)),_.Eb("aria-disabled",!_.ic(9,15,i.canUndo$))}}var cx,sx,lx=((cx=function(){function e(t){m(this,e),this.viewService=t}return v(e,[{key:"ngOnInit",value:function(){}},{key:"handleUndoClick",value:function(){this.viewService.undo()}},{key:"handleRedoClick",value:function(){this.viewService.redo()}},{key:"handleResetClick",value:function(){this.viewService.resetChapter()}}]),e}()).\u0275fac=function(e){return new(e||cx)(_.Pb(Bu))},cx.\u0275cmp=_.Jb({type:cx,selectors:[["app-view-undo"]],decls:2,vars:3,consts:[["class","view-undo",4,"ngIf"],[1,"view-undo"],["padding","dense"],["app-pin-button","","data-test","undo-btn","buttonType","ghost","icon","undo","aria-label","Undo","matTooltip","Undo",1,"mr-2",3,"disabled","click"],["buttonType","ghost","app-pin-button","","data-test","redo-btn","aria-label","Redo","matTooltip","Redo","icon","redo",1,"mr-2",3,"disabled","click"],["app-pin-button","","buttonType","ghost",3,"disabled","click"],[1,"ph-4","text-bold"]],template:function(e,t){1&e&&(_.Kc(0,rx,13,19,"div",0),_.hc(1,"async")),2&e&&_.lc("ngIf",_.ic(1,1,t.canUndo$))},directives:[or.l,ix,ag,rg.c],pipes:[or.b],styles:["[_nghost-%COMP%]{display:flex;justify-content:center;width:100%;padding:8px 0;pointer-events:none}"],data:{animation:[Object(fp.n)("show",[Object(fp.m)(":enter",Object(fp.j)([Object(fp.l)({transform:"translateY(-100%)",opacity:0}),Object(fp.e)("150ms ease-in-out",Object(fp.l)({transform:"translateY(0%)",opacity:1}))]))])]},changeDetection:0}),ox([Object(L.d)(Jy.canUndo),ax("design:type",he.a)],cx.prototype,"canUndo$",void 0),ox([Object(L.d)(Jy.canRedo),ax("design:type",he.a)],cx.prototype,"canRedo$",void 0),ox([Object(L.d)(Jy.getUndoCount),ax("design:type",he.a)],cx.prototype,"undoCount$",void 0),cx),px=h("gcYM"),ux=function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r},dx=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},gx=["scrubber"],hx=["track"],fx=["bar"],bx=["handle"],vx=function(e){return{"view-scrubber--draggable":e}},mx=function(e,t){return{"view-scrubber__handle--hide":e,"view-scrubber__handle-touch":t}},yx=((sx=function(){function e(t,n,i,o,a,r){m(this,e),this.engineService=t,this.animationService=n,this.renderer=i,this.viewService=o,this.changeDetectorRef=a,this.store=r,this.showHandle=!0,this.ngUnsubscribe=new ge.a,this.trackWidth=0,this.dragPosition={x:16,y:0},this.playing=!0}return v(e,[{key:"ngOnInit",value:function(){this.initChapterListener(),this.initTimelineListener()}},{key:"ngAfterViewInit",value:function(){this.initDragListener()}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"initChapterListener",value:function(){var e=this;this.selectedChapterId$.pipe(Object(be.a)((function(e){return null!=e})),Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){e.timerange=e.animationService.getChapterLocalTimerange(t)}))}},{key:"initTimelineListener",value:function(){var e=this;this.engineService.getEvent(Lt.TimelinePlaying).pipe(Object(px.a)(20),Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){return e.tick(t.time)})),this.engineService.getEvent(Lt.TimelineScrubbed).pipe(Object(px.a)(20),Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){var n=e.calcScrubbedPercent(t.time);e.setScrubberBar(n)}))}},{key:"initDragListener",value:function(){var e=this;this.dragInstance.moved.pipe(Object(Ya.a)(20),Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){var n=e.calculateHandlePercent();e.scrubToPercent(n)}))}},{key:"handleDragStart",value:function(){this.playing=this.store.selectSnapshot(qa.getAnimationPlaying),this.store.dispatch(new Xe(!1))}},{key:"handleDragEnd",value:function(){this.store.dispatch(new Xe(this.playing))}},{key:"handleTrackClick",value:function(e){if(this.showHandle){var t=e.offsetX/this.track.nativeElement.getBoundingClientRect().width*100;this.playing=this.store.selectSnapshot(qa.getAnimationPlaying),this.scrubToPercent(t),this.setScrubberBar(t),this.setScrubberHandle(t),this.store.dispatch(new Xe(this.playing))}}},{key:"tick",value:function(e){if(this.timerange){var t=this.calcScrubbedPercent(e);this.setScrubberBar(t),this.setScrubberHandle(t)}}},{key:"calculateHandlePercent",value:function(){var e=this.scrubber.nativeElement.getBoundingClientRect(),t=e.left,n=e.right-t-this.handle.nativeElement.offsetWidth,i=this.handle.nativeElement.getBoundingClientRect().left;return Math.min(Math.max((i-t)/n*100,0),100)}},{key:"scrubToPercent",value:function(e){var t=e/100*this.timerange.lastTime,n=0===e?"second":"first",i=this.store.selectSnapshot(Ua.getSelectedChapterId),o=this.animationService.mapLocalTimeToGlobal(i,t);this.animationService.scrub({time:o,which:n})}},{key:"handlePlayClick",value:function(){this.viewService.toggleAnimation()}},{key:"setScrubberBar",value:function(e){this.renderer.setStyle(this.bar.nativeElement,"width",e+"%")}},{key:"setScrubberHandle",value:function(e){0===this.trackWidth&&(this.trackWidth=this.track.nativeElement.offsetWidth),this.showHandle&&(this.dragPosition=Object.assign(Object.assign({},this.dragPosition),{x:16+this.trackWidth*(e/100)}),this.changeDetectorRef.markForCheck())}},{key:"calcScrubbedPercent",value:function(e){var t=this.timerange,n=t.firstTime,i=t.lastTime,o=this.animationService.mapGlobalTimeToLocal(e).time,a=Math.max(n,Math.min(o,i));return Math.round(a/i*100)}}]),e}()).\u0275fac=function(e){return new(e||sx)(_.Pb(Nt),_.Pb(xa),_.Pb(_.H),_.Pb(Bu),_.Pb(_.i),_.Pb(L.g))},sx.\u0275cmp=_.Jb({type:sx,selectors:[["app-view-scrubber"]],viewQuery:function(e,t){var n;1&e&&(_.Gc(gx,!0),_.Gc(hx,!0),_.Gc(fx,!0),_.Gc(bx,!0),_.Rc(Pa.a,!0)),2&e&&(_.uc(n=_.dc())&&(t.scrubber=n.first),_.uc(n=_.dc())&&(t.track=n.first),_.uc(n=_.dc())&&(t.bar=n.first),_.uc(n=_.dc())&&(t.handle=n.first),_.uc(n=_.dc())&&(t.dragInstance=n.first))},inputs:{showHandle:"showHandle"},decls:9,vars:10,consts:[["gaCategory","View Media Bar",1,"view-scrubber",3,"ngClass"],["scrubber",""],[1,"view-scrubber__track",3,"click"],["track",""],[1,"view-scrubber__bar"],["bar",""],["gaEvent","","gaAction","Clicked Scrubber","cdkDrag","","cdkDragLockAxis","x","cdkDragBoundary",".view-scrubber",1,"view-scrubber__handle",3,"cdkDragFreeDragPosition","ngClass","cdkDragStarted","cdkDragEnded"],["handle",""]],template:function(e,t){1&e&&(_.Vb(0,"div",0,1),_.Vb(2,"div",2,3),_.cc("click",(function(e){return t.handleTrackClick(e)})),_.Qb(4,"div",4,5),_.Ub(),_.Vb(6,"div",6,7),_.cc("cdkDragStarted",(function(){return t.handleDragStart()}))("cdkDragEnded",(function(){return t.handleDragEnd()})),_.hc(8,"async"),_.Ub(),_.Ub()),2&e&&(_.lc("ngClass",_.oc(5,vx,t.showHandle)),_.Db(6),_.lc("cdkDragFreeDragPosition",t.dragPosition)("ngClass",_.pc(7,mx,!t.showHandle,_.ic(8,3,t.canTouch$))))},directives:[ke.a,or.i,ke.b,Pa.a],pipes:[or.b],styles:['.view-scrubber{position:relative;display:flex;justify-content:center;align-items:center;height:40px;width:100%}.view-scrubber:hover .view-scrubber__handle:after{opacity:1}.view-scrubber--draggable .view-scrubber__track{left:16px;right:16px}.view-scrubber__track{background:rgba(150,168,192,.6);background:var(--scrubber-track-bg);z-index:1;right:0}.view-scrubber__bar,.view-scrubber__track{border-radius:2px;position:absolute;height:4px;left:0}.view-scrubber__bar{background:#374a68;background:var(--scrubber-track-color);z-index:2;width:0}.view-scrubber__handle{width:40px;height:40px;margin-left:-16px;left:0;display:flex;align-items:center;justify-content:center;position:absolute;z-index:2}.view-scrubber__handle--hide{display:none}.view-scrubber__handle:after{opacity:1;transition:opacity .25s;content:"";width:8px;height:8px;border-radius:4px;background:var(--scrubber-handle-color);box-shadow:var(--scrubber-handle-shadow)}.view-scrubber__handle:hover:after{background:var(--scrubber-handle-color--hover)}.view-scrubber__handle:hover{cursor:pointer}.view-scrubber__handle-touch:after{opacity:1}'],encapsulation:2,changeDetection:0}),ux([Object(L.d)(qa.getAnimationPlaying),dx("design:type",he.a)],sx.prototype,"animationPlaying$",void 0),ux([Object(L.d)(Ua.getSelectedChapterId),dx("design:type",he.a)],sx.prototype,"selectedChapterId$",void 0),ux([Object(L.d)(hp.getCanTouch),dx("design:type",he.a)],sx.prototype,"canTouch$",void 0),sx),xx=function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r},wx=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function kx(e,t){if(1&e){var n=_.Wb();_.Vb(0,"button",10),_.cc("click",(function(){return _.zc(n),_.gc(2).handlePlayClick()})),_.hc(1,"async"),_.hc(2,"async"),_.hc(3,"async"),_.Ub()}if(2&e){var i=_.gc(2);_.lc("gaLabel",_.ic(1,3,i.animationPlaying$)?"Pause":"Play")("matTooltip",_.ic(2,5,i.animationPlaying$)?"Pause":"Play")("icon",_.ic(3,7,i.animationPlaying$)?"pause":"play")}}function Ox(e,t){if(1&e){var n=_.Wb();_.Vb(0,"button",11),_.cc("click",(function(){return _.zc(n),_.gc(2).handlePlayChapterFromStartClick()})),_.Ub()}}function Cx(e,t){1&e&&_.Qb(0,"app-view-scrubber",12)}function Sx(e,t){if(1&e){var n=_.Wb();_.Vb(0,"button",13),_.cc("click",(function(){return _.zc(n),_.gc(2).handleAudioClick()})),_.hc(1,"async"),_.hc(2,"async"),_.hc(3,"async"),_.Ub()}if(2&e){var i=_.gc(2);_.lc("gaLabel",_.ic(1,3,i.playAudio$)?"Mute":"Play")("icon",_.ic(2,5,i.playAudio$)?"volume":"volume-slash")("matTooltip",_.ic(3,7,i.playAudio$)?"Mute Audio":"Play Audio")}}function _x(e,t){if(1&e&&(_.Vb(0,"div",3),_.Kc(1,kx,4,9,"button",4),_.Kc(2,Ox,1,0,"button",5),_.Kc(3,Cx,1,0,"app-view-scrubber",6),_.Vb(4,"button",7),_.Vb(5,"span",8),_.Mc(6),_.hc(7,"async"),_.Ub(),_.Ub(),_.Kc(8,Sx,4,9,"button",9),_.Ub()),2&e){var n=_.gc(),i=_.vc(2);_.Db(1),_.lc("ngIf",n.showPlayPause),_.Db(1),_.lc("ngIf",n.showPlayPause),_.Db(1),_.lc("ngIf",n.showScrubber),_.Db(1),_.lc("matMenuTriggerFor",i),_.Db(2),_.Oc("",_.ic(7,6,n.playbackSpeed$),"x"),_.Db(2),_.lc("ngIf",n.audioVisible)}}var jx,Px,Mx=((jx=function(){function e(t,n,i,o,a){m(this,e),this.animationService=t,this.viewService=n,this.layoutService=i,this.store=o,this.changeDetectorRef=a,this.viewLayout=Rp,this.size="small",this.showPlayPause=!0,this.showScrubber=!0,this.showBar=!0,this.audioVisible=!1,this.ngUnsubscribe=new ge.a}return v(e,[{key:"template",get:function(){return this._template},set:function(e){this._template=e,this.updateLayoutProperties(this.template)}},{key:"ngOnInit",value:function(){this.initChapterListener(),this.initLayoutListener()}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"initChapterListener",value:function(){var e=this;this.selectedChapterId$.pipe(Object(be.a)((function(e){return null!=e})),Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){e.timerange=e.animationService.getChapterLocalTimerange(t)}))}},{key:"initLayoutListener",value:function(){var e=this;this.store.select(hp.getUI).pipe(Object(fe.a)(this.ngUnsubscribe)).subscribe((function(){e.audioVisible=e.layoutService.isVisible(Rp.Audio),e.changeDetectorRef.markForCheck()}))}},{key:"updateLayoutProperties",value:function(e){this.showBar=e!==is.None,this.showScrubber=e===is.Full,this.showPlayPause=e!==is.None}},{key:"handlePlayClick",value:function(){this.viewService.toggleAnimation()}},{key:"handleAudioClick",value:function(){this.viewService.toggleAudio()}},{key:"handlePlayChapterFromStartClick",value:function(){this.viewService.playChapterFromStart()}},{key:"setPlaybackSpeed",value:function(e){this.store.dispatch(new et(e))}}]),e}()).\u0275fac=function(e){return new(e||jx)(_.Pb(xa),_.Pb(Bu),_.Pb(Vp),_.Pb(L.g),_.Pb(_.i))},jx.\u0275cmp=_.Jb({type:jx,selectors:[["app-view-media-bar"]],inputs:{template:"template",size:"size"},decls:11,vars:1,consts:[["gaCategory","View Media Bar","class","view-media-bar",4,"ngIf"],["playbackMenu","matMenu"],["mat-menu-item","",3,"click"],["gaCategory","View Media Bar",1,"view-media-bar"],["gaEvent","","gaAction","Clicked Toggle Animation","app-pin-button","","buttonType","ghost","data-test","Play/Pause__small","matTooltipPosition","above",3,"gaLabel","matTooltip","icon","click",4,"ngIf"],["gaEvent","","gaAction","Clicked Play Chapter From Start","app-pin-button","","buttonType","ghost","matTooltipPosition","above","matTooltip","Play Chapter from Start","icon","step-backward",3,"click",4,"ngIf"],["class","view-media-bar__scrubber","data-test","Scrub__small",4,"ngIf"],["app-pin-button","","buttonType","ghost","matTooltipPosition","above","matTooltip","Playback Speed",3,"matMenuTriggerFor"],[1,"text-semibold"],["gaEvent","","gaAction","Clicked Toggle Audio","app-pin-button","","buttonType","ghost","class","view-tools__item",3,"gaLabel","icon","matTooltip","click",4,"ngIf"],["gaEvent","","gaAction","Clicked Toggle Animation","app-pin-button","","buttonType","ghost","data-test","Play/Pause__small","matTooltipPosition","above",3,"gaLabel","matTooltip","icon","click"],["gaEvent","","gaAction","Clicked Play Chapter From Start","app-pin-button","","buttonType","ghost","matTooltipPosition","above","matTooltip","Play Chapter from Start","icon","step-backward",3,"click"],["data-test","Scrub__small",1,"view-media-bar__scrubber"],["gaEvent","","gaAction","Clicked Toggle Audio","app-pin-button","","buttonType","ghost",1,"view-tools__item",3,"gaLabel","icon","matTooltip","click"]],template:function(e,t){1&e&&(_.Kc(0,_x,9,8,"div",0),_.Vb(1,"mat-menu",null,1),_.Vb(3,"button",2),_.cc("click",(function(){return t.setPlaybackSpeed(1)})),_.Mc(4,"Normal"),_.Ub(),_.Vb(5,"button",2),_.cc("click",(function(){return t.setPlaybackSpeed(.5)})),_.Mc(6,"0.5"),_.Ub(),_.Vb(7,"button",2),_.cc("click",(function(){return t.setPlaybackSpeed(.25)})),_.Mc(8,"0.25"),_.Ub(),_.Vb(9,"button",2),_.cc("click",(function(){return t.setPlaybackSpeed(.1)})),_.Mc(10,"0.1"),_.Ub(),_.Ub()),2&e&&_.lc("ngIf",t.showBar)},directives:[or.l,ll.a,ll.b,ke.a,ag,rg.c,ll.d,ke.b,yx],pipes:[or.b],styles:[".view-media-bar{display:flex}.view-media-bar__scrubber{width:120px;display:flex;justify-content:center;align-items:center}"],encapsulation:2,changeDetection:0}),xx([Object(L.d)(qa.getAnimationPlaying),wx("design:type",he.a)],jx.prototype,"animationPlaying$",void 0),xx([Object(L.d)(Ua.getSelectedChapterId),wx("design:type",he.a)],jx.prototype,"selectedChapterId$",void 0),xx([Object(L.d)(qa.getPlayAudio),wx("design:type",he.a)],jx.prototype,"playAudio$",void 0),xx([Object(L.d)(qa.getPlaybackSpeed),wx("design:type",he.a)],jx.prototype,"playbackSpeed$",void 0),jx),Ix=function(){return window.navigator.userAgent.includes("Trident")},zx=((Px=function(){function e(t,n){m(this,e),this.el=t,this.renderer=n}return v(e,[{key:"ngOnInit",value:function(){Ix()&&this.renderer.setStyle(this.el.nativeElement,"display","none")}}]),e}()).\u0275fac=function(e){return new(e||Px)(_.Pb(_.m),_.Pb(_.H))},Px.\u0275dir=_.Kb({type:Px,selectors:[["","appHideIE11",""]]}),Px),Tx=function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r},Ux=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Lx=["chapterCount"],Dx=["mediaToggle"];function Ex(e,t){if(1&e){var n=_.Wb();_.Vb(0,"div",5),_.Vb(1,"button",6),_.cc("click",(function(){return _.zc(n),_.gc(2).handlePreviousClick()})),_.hc(2,"async"),_.hc(3,"async"),_.hc(4,"async"),_.hc(5,"async"),_.Ub(),_.Vb(6,"button",7),_.cc("click",(function(){return _.zc(n),_.gc(2).handleNextClick()})),_.hc(7,"async"),_.hc(8,"async"),_.hc(9,"async"),_.hc(10,"async"),_.hc(11,"async"),_.hc(12,"async"),_.Ub(),_.Ub()}if(2&e){var i=_.gc(2),o=null,a=null;_.Db(1),_.lc("disabled",0===_.ic(2,6,i.chapterIndex$))("matTooltip",_.ic(4,10,i.previousChapter$)?"Previous: "+(null==(o=_.ic(5,12,i.previousChapter$))?null:o.info.displayName):""),_.Eb("aria-disabled",0===_.ic(3,8,i.chapterIndex$)),_.Db(5),_.lc("disabled",_.ic(9,18,i.chapterIndex$)===_.ic(10,20,i.chapterCount$)-1)("matTooltip",_.ic(11,22,i.nextChapter$)?"Next: "+(null==(a=_.ic(12,24,i.nextChapter$))?null:a.info.displayName):""),_.Eb("aria-disabled",_.ic(7,14,i.chapterIndex$)===_.ic(8,16,i.chapterCount$)-1)}}function Fx(e,t){if(1&e){var n=_.Wb();_.Vb(0,"div",5),_.Vb(1,"div",8,9),_.Vb(3,"button",10),_.cc("click",(function(){return _.zc(n),_.gc(2).handleChapterCountClick()})),_.Vb(4,"div",11),_.Mc(5),_.hc(6,"async"),_.hc(7,"async"),_.Qb(8,"app-icon",12),_.Ub(),_.Vb(9,"span",13),_.Mc(10),_.hc(11,"async"),_.hc(12,"async"),_.Ub(),_.Ub(),_.Ub(),_.Ub()}if(2&e){var i=_.gc(2);_.Db(3),_.lc("matTooltip",i.chaptersPopup?"Close Chapter List":"Open Chapter List"),_.Eb("visible",i.breakpoint!==i.breakpointEnum.Small),_.Db(2),_.Pc(" ",_.ic(6,6,i.chapterIndex$)+1," of ",_.ic(7,8,i.chapterCount$)," "),_.Db(5),_.Pc(" Toggle Chapter List, Chapter ",_.ic(11,10,i.chapterIndex$)+1," of ",_.ic(12,12,i.chapterCount$)," ")}}function Ax(e,t){if(1&e){var n=_.Wb();_.Vb(0,"button",17),_.cc("click",(function(){return _.zc(n),_.gc(3).toggleToolbar("media")})),_.Qb(1,"app-view-scrubber",18),_.Ub()}2&e&&(_.Db(1),_.lc("showHandle",!1))}function Rx(e,t){if(1&e){var n=_.Wb();_.Vb(0,"button",19),_.cc("click",(function(){return _.zc(n),_.gc(3).handleAudioClick()})),_.hc(1,"async"),_.hc(2,"async"),_.hc(3,"async"),_.Ub()}if(2&e){var i=_.gc(3);_.lc("gaLabel",_.ic(1,3,i.playAudio$)?"Mute":"Unmute")("icon",_.ic(2,5,i.playAudio$)?"volume":"volume-slash")("matTooltip",_.ic(3,7,i.playAudio$)?"Mute Audio":"Play Audio")}}function Nx(e,t){if(1&e){var n=_.Wb();_.Vb(0,"div",5),_.Vb(1,"button",14),_.cc("click",(function(){return _.zc(n),_.gc(2).handlePlayClick()})),_.hc(2,"async"),_.hc(3,"async"),_.hc(4,"async"),_.hc(5,"async"),_.Ub(),_.Kc(6,Ax,2,1,"button",15),_.Kc(7,Rx,4,9,"button",16),_.Ub()}if(2&e){var i=_.gc(2);_.Db(1),_.lc("gaLabel",_.ic(2,6,i.animationPlaying$)?"Pause":"Play")("icon",_.ic(3,8,i.animationPlaying$)?"pause":"play")("matTooltip",_.ic(5,12,i.animationPlaying$)?"Pause Animation":"Play Animation"),_.Eb("aria-label",_.ic(4,10,i.animationPlaying$)?"Pause Animation":"Play Animation"),_.Db(5),_.lc("ngIf",i.mediaTemplate===i.mediaControlsEnum.Full),_.Db(1),_.lc("ngIf",i.audioVisible)}}function Vx(e,t){if(1&e&&(_.Tb(0,3),_.Kc(1,Ex,13,26,"div",4),_.Kc(2,Fx,13,14,"div",4),_.Kc(3,Nx,8,14,"div",4),_.Sb()),2&e){var n=_.gc();_.Db(1),_.lc("ngIf",n.paginationVisible),_.Db(1),_.lc("ngIf",n.paginationVisible&&!n.collapsePagination),_.Db(1),_.lc("ngIf",n.mediabarVisible)}}function Hx(e,t){if(1&e){var n=_.Wb();_.Tb(0,20),_.Vb(1,"div",5),_.Vb(2,"div",21),_.Vb(3,"button",22),_.cc("click",(function(){_.zc(n);var e=_.gc();return e.handleSelectTool(e.toolEnum.Select)})),_.hc(4,"async"),_.Ub(),_.Vb(5,"button",23),_.cc("click",(function(){_.zc(n);var e=_.gc();return e.handleSelectTool(e.toolEnum.Hide)})),_.hc(6,"async"),_.Ub(),_.Vb(7,"button",24),_.cc("click",(function(){_.zc(n);var e=_.gc();return e.handleSelectTool(e.toolEnum.Fade)})),_.hc(8,"async"),_.Ub(),_.Ub(),_.Ub(),_.Sb()}if(2&e){var i=_.gc();_.Db(3),_.lc("selected",_.ic(4,3,i.activeTool$)===i.toolEnum.Select),_.Db(2),_.lc("selected",_.ic(6,5,i.activeTool$)===i.toolEnum.Hide),_.Db(2),_.lc("selected",_.ic(8,7,i.activeTool$)===i.toolEnum.Fade)}}var Bx,Qx,qx,Wx=((Bx=function(){function e(t,n,i,o,a,r){m(this,e),this.viewService=t,this.viewUIService=n,this.store=i,this.changeDetectorRef=o,this.popupService=a,this.ga=r,this.viewToolsMode=sf,this.viewUI=Rp,this.breakpointEnum=Up,this.canFullscreen=!0,this.isFullscreen=!1,this.toolEnum=Aa,this.mediaControlsEnum=is,this.paginationVisible=!1,this.mediabarVisible=!1,this.audioVisible=!1,this.ngUnsubscribe=new ge.a,this.animate=!0,this._mode=sf.Main,this.collapsePagination=!1,this.modeChange=new _.p}return v(e,[{key:"mode",get:function(){return this._mode},set:function(e){this._mode=e}},{key:"ngOnInit",value:function(){this.canFullscreen=Kc.canFullscreen(),this.initLayoutListener(),this.initBreakpointListener(),this.initChapterListener(),this.initFullscreenListener()}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"initLayoutListener",value:function(){var e=this;this.store.select(hp.getUI).pipe(Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){e.mediaTemplate=t.media.template,e.paginationVisible=e.viewUIService.isVisible(Rp.Pagination),e.mediabarVisible=e.viewUIService.isVisible(Rp.Mediabar),e.audioVisible=e.viewUIService.isVisible(Rp.Audio),e.changeDetectorRef.markForCheck()}))}},{key:"initBreakpointListener",value:function(){var e=this;this.store.select(Ap.getBreakpoint).pipe(Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){e.breakpoint=t,e.changeDetectorRef.markForCheck()}))}},{key:"initChapterListener",value:function(){var e=this;this.store.select(Ua.getSelectedChapterIndex).pipe(Object(fe.a)(this.ngUnsubscribe)).subscribe((function(){e.chaptersPopup&&e.chaptersPopup.close()}))}},{key:"initFullscreenListener",value:function(){var e=this;this.fullscreen$=Kc.onFullscreenChange(),this.fullscreen$.pipe(Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){e.isFullscreen=Kc.isFullscreen(),e.changeDetectorRef.markForCheck()}))}},{key:"handleSelectTool",value:function(e){var t=this.store.selectSnapshot(qa.getActiveTool);this.viewService.selectTool(e===t?Aa.Select:e)}},{key:"handlePlayClick",value:function(){this.viewService.toggleAnimation()}},{key:"handleAudioClick",value:function(){this.viewService.toggleAudio()}},{key:"handleMenuClick",value:function(){this.store.dispatch(new S.ToggleMenu(!0))}},{key:"handlePreviousClick",value:function(){this.viewService.previousChapter("Toolbar")}},{key:"handleNextClick",value:function(){this.viewService.nextChapter("Toolbar")}},{key:"handleChapterCountClick",value:function(){this.toggleChaptersPopup()}},{key:"handleMediaClick",value:function(){this.toggleMediaPopup()}},{key:"toggleChaptersPopup",value:function(){var e=this;this.chaptersPopup?this.chaptersPopup.close():(this.chaptersPopup=this.popupService.open({origin:this.chapterCount.nativeElement,content:xf,width:"300px"}),this.chaptersPopup.afterClosed$.pipe(Object(fe.a)(this.ngUnsubscribe),Object(bp.a)(1)).subscribe((function(t){e.chaptersPopup=null})))}},{key:"toggleMediaPopup",value:function(){var e=this;this.mediaPopup?this.mediaPopup.close():(this.mediaPopup=this.popupService.open({origin:this.mediaToggle.nativeElement,content:Mx,width:"300px"}),this.mediaPopup.afterClosed$.pipe(Object(fe.a)(this.ngUnsubscribe),Object(bp.a)(1)).subscribe((function(t){e.mediaPopup=null})))}},{key:"toggleToolbar",value:function(e){this.viewService.toggleToolbar(e)}},{key:"isEnabled",value:function(e){return this.viewUIService.isUIEnabled(e)}},{key:"isVisible",value:function(e){return this.viewUIService.isVisible(e)}}]),e}()).\u0275fac=function(e){return new(e||Bx)(_.Pb(Bu),_.Pb(Vp),_.Pb(L.g),_.Pb(_.i),_.Pb(Df),_.Pb(ke.c))},Bx.\u0275cmp=_.Jb({type:Bx,selectors:[["app-view-tools"]],viewQuery:function(e,t){var n;1&e&&(_.Rc(Lx,!0),_.Rc(Dx,!0)),2&e&&(_.uc(n=_.dc())&&(t.chapterCount=n.first),_.uc(n=_.dc())&&(t.mediaToggle=n.first))},inputs:{animate:"animate",mode:"mode",collapsePagination:"collapsePagination"},outputs:{modeChange:"modeChange"},features:[_.Cb([Df])],decls:3,vars:2,consts:[["role","toolbar","aria-label","Tools","data-test","viewTools",1,"view-tools"],["gaCategory","View Toolbar",4,"ngIf"],["gaCategory","View Explore Tools",4,"ngIf"],["gaCategory","View Toolbar"],["class","view-tools__group",4,"ngIf"],[1,"view-tools__group"],["gaEvent","","gaAction","Clicked Previous Chapter","data-test","viewToolsPreviousChapter","aria-label","Previous Chapter","app-pin-button","","buttonType","ghost","icon","chevron-left",1,"view-tools__item",3,"disabled","matTooltip","click"],["gaEvent","","gaAction","Clicked Next Chapter","data-test","viewToolsNextChapter","aria-label","Next Chapter","app-pin-button","","buttonType","ghost","icon","chevron-right",1,"view-tools__item",3,"disabled","matTooltip","click"],["gaEvent","","gaAction","Clicked Open Chapter List",1,"view-tools__item"],["chapterCount",""],["data-test","viewToolsChapterCount","app-pin-button","","buttonType","ghost","aria-label","Toggle Chapter List",3,"matTooltip","click"],["aria-hidden","true",1,"ph-2","text-13","text-semibold",2,"white-space","nowrap"],["icon","caret-up",1,"ml-2"],[1,"visually-hidden"],["gaEvent","","gaAction","Clicked Toggle Animation","data-test","viewToolsPlay","app-pin-button","","buttonType","ghost",1,"view-tools__item",3,"gaLabel","icon","matTooltip","click"],["gaEvent","","gaAction","Clicked Open Media Bar","data-test","viewToolsMedia","app-pin-button","","buttonType","ghost","class","view-tools__item","aria-label","Open Media Bar","matTooltip","Open Media Bar",3,"click",4,"ngIf"],["gaEvent","","gaAction","Clicked Toggle Audio","data-test","viewToolsAudio","app-pin-button","","buttonType","ghost","class","view-tools__item",3,"gaLabel","icon","matTooltip","click",4,"ngIf"],["gaEvent","","gaAction","Clicked Open Media Bar","data-test","viewToolsMedia","app-pin-button","","buttonType","ghost","aria-label","Open Media Bar","matTooltip","Open Media Bar",1,"view-tools__item",3,"click"],[2,"width","32px","margin","0 8px",3,"showHandle"],["gaEvent","","gaAction","Clicked Toggle Audio","data-test","viewToolsAudio","app-pin-button","","buttonType","ghost",1,"view-tools__item",3,"gaLabel","icon","matTooltip","click"],["gaCategory","View Explore Tools"],["role","radiogroup",1,"flex"],["gaEvent","","gaAction","Clicked Select","app-pin-button","","buttonType","ghost","icon","mouse-pointer","aria-label","Select","matTooltip","Select","data-test","viewToolsSelect",1,"view-tools__item",3,"selected","click"],["gaEvent","","gaAction","Clicked Hide","app-pin-button","","buttonType","ghost","icon","eye-slash","aria-label","Hide","matTooltip","Hide","data-test","viewToolsHide",1,"view-tools__item",3,"selected","click"],["gaEvent","","gaAction","Clicked Fade","app-pin-button","","appHideIE11","","buttonType","ghost","aria-label","Fade","matTooltip","Fade","icon","adjust","data-test","viewToolsFade",1,"view-tools__item",3,"selected","click"]],template:function(e,t){1&e&&(_.Vb(0,"div",0),_.Kc(1,Vx,4,3,"ng-container",1),_.Kc(2,Hx,9,9,"ng-container",2),_.Ub()),2&e&&(_.Db(1),_.lc("ngIf",t.mode===t.viewToolsMode.Main),_.Db(1),_.lc("ngIf",t.mode===t.viewToolsMode.Tools))},directives:[or.l,ke.a,ag,ke.b,rg.c,Js,yx,zx],pipes:[or.b],styles:[".text-8{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-header{font-weight:700}.text--code{font-family:Courier New,Courier,monospace}.text-uppercase{text-transform:uppercase}.text-xlight{font-weight:200}.text-light{font-weight:300}.text-medium{font-weight:500}.text-semibold{font-weight:600}.text-bold{font-weight:700}.text-underline{text-decoration:underline}.text-italic{font-style:italic}.text-bright{color:#fff}.text-dim{color:#96a8c0}.text-error{color:#ed4758}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.text-ellipsis{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link,.text-link:visited{color:inherit;cursor:pointer}.text-link:not(.text-underline),.text-link:visited:not(.text-underline){text-decoration:none}.text-success{color:#38de38}.text-danger{color:#de3838}.text-info{color:#0060c4}.text-nowrap{white-space:nowrap}.text-pre-line{white-space:pre-line}.view-tools{display:flex;justify-content:center;overflow:hidden}@-webkit-keyframes viewToolsToggle{0%{opacity:1}50%{opacity:0}to{opacity:1}}@keyframes viewToolsToggle{0%{opacity:1}50%{opacity:0}to{opacity:1}}.view-tools--swap{-webkit-animation:viewToolsToggle .3s ease-in-out;animation:viewToolsToggle .3s ease-in-out}.view-tools--dense .view-tools__divider{margin:4px}.view-tools__inner{display:flex;justify-content:center}.view-tools__group{border-right:var(--view-tools-border);padding:0 8px;display:flex}.view-tools__group:empty{display:none}.view-tools__group:empty:first-of-type+.view-tools__group:not(:empty),.view-tools__group:first-of-type{padding-left:0}.view-tools__group:last-of-type{border-right:none;padding-right:0}.view-tools__item{display:flex;align-items:center}.view-tools__item:not(:last-child){margin-right:4px}.view-tools__divider{border-right:var(--view-tools-border);margin:4px 8px}.view-tools__count{font-size:12px;letter-spacing:.3px;line-height:1.4em;white-space:nowrap}"],encapsulation:2,changeDetection:0}),Tx([Object(L.d)(Ua.getSelectedChapterReadyState),Ux("design:type",he.a)],Bx.prototype,"selectedChapterReady$",void 0),Tx([Object(L.d)(qa.getActiveTool),Ux("design:type",he.a)],Bx.prototype,"activeTool$",void 0),Tx([Object(L.d)(hp.getPresentationActive),Ux("design:type",he.a)],Bx.prototype,"presentationActive$",void 0),Tx([Object(L.d)(Ua.getIsChapterAnimated),Ux("design:type",he.a)],Bx.prototype,"isChapterAnimated$",void 0),Tx([Object(L.d)(qa.getShowLabels),Ux("design:type",he.a)],Bx.prototype,"showLabels$",void 0),Tx([Object(L.d)(qa.getAnimationPlaying),Ux("design:type",he.a)],Bx.prototype,"animationPlaying$",void 0),Tx([Object(L.d)(qa.getPlayAudio),Ux("design:type",he.a)],Bx.prototype,"playAudio$",void 0),Tx([Object(L.d)(Pc.getChapterLabels),Ux("design:type",he.a)],Bx.prototype,"labels$",void 0),Tx([Object(L.d)(Ua.getSelectedChapterTitle),Ux("design:type",he.a)],Bx.prototype,"chapterTitle$",void 0),Tx([Object(L.d)(Ua.getSelectedChapterIndex),Ux("design:type",he.a)],Bx.prototype,"chapterIndex$",void 0),Tx([Object(L.d)(Ua.getNextChapter),Ux("design:type",he.a)],Bx.prototype,"nextChapter$",void 0),Tx([Object(L.d)(Ua.getPreviousChapter),Ux("design:type",he.a)],Bx.prototype,"previousChapter$",void 0),Tx([Object(L.d)(Ua.getChapterCount),Ux("design:type",he.a)],Bx.prototype,"chapterCount$",void 0),Tx([Object(L.d)(Ua.getSelectedChapterAudio),Ux("design:type",he.a)],Bx.prototype,"selectedChapterAudio$",void 0),Tx([Object(L.d)(hp.getCanTouch),Ux("design:type",he.a)],Bx.prototype,"canTouch$",void 0),Bx),$x=function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r},Kx=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Gx=["slider"],Zx=["track"],Jx=["bar"],Xx=["handle"],Yx=function(e){return{"view-layers-slider__handle-touch":e}},ew=((Qx=function(){function e(t,n,i){m(this,e),this.renderer=t,this.visibilityLayersService=n,this.changeDetectorRef=i,this.ngUnsubscribe=new ge.a,this.currentLayers=[],this.fullOffset=0,this.dragMove=new ge.a,this.dragPosition={x:0,y:0},this.currentLayerName=""}return v(e,[{key:"ngOnInit",value:function(){this.initLayersObserver(),this.initIndexPositionObserver(),this.initDragMoveObserver()}},{key:"ngAfterViewInit",value:function(){this.fullOffset=this.track.nativeElement.offsetWidth}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"initLayersObserver",value:function(){var e=this;this.selectedChapterCurrentLayers$.pipe(Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){e.currentLayers=t}))}},{key:"initIndexPositionObserver",value:function(){var e=this;Object(Ka.b)(this.selectedChapterCurrentLayersIndex$,this.selectedChapterCurrentLayersPosition$).pipe(Object(be.a)((function(e){var t=u(e,2),n=t[0],i=t[1];return!Object(Oe.isNil)(n)&&!Object(Oe.isNil)(i)})),Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){var n=u(t,2),i=n[0],o=n[1];e.currentLayerName=e.currentLayers[i].name;var a=e.visibilityLayersService.indexPositionToFraction(i,o);e.setSliderBar(a),e.setSliderHandle(a)}))}},{key:"initDragMoveObserver",value:function(){var e=this;this.dragMove.pipe(Object(Ya.a)(20),Object(fe.a)(this.ngUnsubscribe)).subscribe((function(){return e.handleAuditedDrag()}))}},{key:"handleDragEnded",value:function(){var e=this.calculateHandleFraction(),t=this.visibilityLayersService.fractionToIndex(e),n=this.visibilityLayersService.fractionToPosition(e,t);this.visibilityLayersService.recordLayerIndexPosition(t,n)}},{key:"handleDragMoved",value:function(e){this.dragMove.next(e)}},{key:"handleAuditedDrag",value:function(){var e=this.calculateHandleFraction(),t=this.visibilityLayersService.fractionToIndex(e),n=this.visibilityLayersService.fractionToPosition(e,t);this.currentLayerName=this.currentLayers[t].name,this.visibilityLayersService.synchronizeScene(t,n,!1),this.setSliderBar(e)}},{key:"handleTrackClick",value:function(e){var t=e.offsetX/this.fullOffset,n=this.visibilityLayersService.fractionToIndex(t),i=this.visibilityLayersService.fractionToPosition(t,n);this.visibilityLayersService.recordLayerIndexPosition(n,i)}},{key:"calculateHandleFraction",value:function(){var e=this.slider.nativeElement.getBoundingClientRect();return(this.handle.nativeElement.getBoundingClientRect().left-e.left)/this.fullOffset}},{key:"setSliderBar",value:function(e){this.renderer.setStyle(this.bar.nativeElement,"width",100*e+"%")}},{key:"setSliderHandle",value:function(e){this.dragPosition={x:e*this.fullOffset,y:this.dragPosition.y},this.changeDetectorRef.markForCheck()}}]),e}()).\u0275fac=function(e){return new(e||Qx)(_.Pb(_.H),_.Pb(Xc),_.Pb(_.i))},Qx.\u0275cmp=_.Jb({type:Qx,selectors:[["app-view-layers-slider"]],viewQuery:function(e,t){var n;1&e&&(_.Gc(Gx,!0),_.Gc(Zx,!0),_.Gc(Jx,!0),_.Gc(Xx,!0)),2&e&&(_.uc(n=_.dc())&&(t.slider=n.first),_.uc(n=_.dc())&&(t.track=n.first),_.uc(n=_.dc())&&(t.bar=n.first),_.uc(n=_.dc())&&(t.handle=n.first))},decls:9,vars:7,consts:[[1,"view-layers-slider"],["slider",""],[1,"view-layers-slider__track",3,"click"],["track",""],[1,"view-layers-slider__bar"],["bar",""],["cdkDrag","","cdkDragLockAxis","x","cdkDragBoundary",".view-layers-slider",1,"view-layers-slider__handle",3,"cdkDragFreeDragPosition","ngClass","matTooltip","cdkDragEnded","cdkDragMoved"],["handle",""]],template:function(e,t){1&e&&(_.Vb(0,"div",0,1),_.Vb(2,"div",2,3),_.cc("click",(function(e){return t.handleTrackClick(e)})),_.Qb(4,"div",4,5),_.Ub(),_.Vb(6,"div",6,7),_.cc("cdkDragEnded",(function(){return t.handleDragEnded()}))("cdkDragMoved",(function(e){return t.handleDragMoved(e)})),_.hc(8,"async"),_.Ub(),_.Ub()),2&e&&(_.Db(6),_.mc("matTooltip",t.currentLayerName),_.lc("cdkDragFreeDragPosition",t.dragPosition)("ngClass",_.oc(5,Yx,_.ic(8,3,t.canTouch$))))},directives:[Pa.a,or.i,rg.c],pipes:[or.b],styles:['.view-layers-slider[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:center;align-items:center;height:28px;width:100%}.view-layers-slider__track[_ngcontent-%COMP%]{position:absolute;background:rgba(28,42,63,.5);background:var(--scrubber-track-bg);z-index:1;height:5px;border-radius:5px;left:14px;right:14px}.view-layers-slider__bar[_ngcontent-%COMP%]{position:absolute;background:var(--scrubber-track-color);height:5px;border-radius:5px;z-index:2;width:0;left:0;pointer-events:none}.view-layers-slider__handle[_ngcontent-%COMP%]{width:28px;height:28px;margin-left:-14px;left:14px;display:flex;align-items:center;justify-content:center;position:absolute;z-index:2}.view-layers-slider__handle--hide[_ngcontent-%COMP%]{display:none}.view-layers-slider__handle[_ngcontent-%COMP%]:after{content:"";width:12px;height:12px;border-radius:6px;background:var(--scrubber-handle-color);box-shadow:var(--scrubber-handle-shadow)}.view-layers-slider__handle[_ngcontent-%COMP%]:hover:after{background:var(--scrubber-handle-color--hover)}'],changeDetection:0}),$x([Object(L.d)(Ua.getSelectedChapterCurrentLayers),Kx("design:type",he.a)],Qx.prototype,"selectedChapterCurrentLayers$",void 0),$x([Object(L.d)(Ua.getSelectedChapterCurrentLayersIndex),Kx("design:type",he.a)],Qx.prototype,"selectedChapterCurrentLayersIndex$",void 0),$x([Object(L.d)(Ua.getSelectedChapterCurrentLayersPosition),Kx("design:type",he.a)],Qx.prototype,"selectedChapterCurrentLayersPosition$",void 0),$x([Object(L.d)(hp.getCanTouch),Kx("design:type",he.a)],Qx.prototype,"canTouch$",void 0),Qx),tw=function(e,t,n){return{"view-layers-bar__slider--large":e,"view-layers-bar__slider--small":t,"view-layers-bar__slider--disabled":n}},nw=((qx=function(){function e(t,n,i){m(this,e),this.store=t,this.engineService=n,this.changeDetectorRef=i,this.ngUnsubscribe=new ge.a,this.assetsLoading=!1}return v(e,[{key:"ngOnInit",value:function(){var e=this;this.engineService.getEvent(Lt.AssetsLoadProgress).pipe(Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){e.assetsLoading=t.requestedAssets!==t.receivedAssets,e.changeDetectorRef.markForCheck()}))}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"isLarge",value:function(){return this.store.selectSnapshot(Ap.getBreakpoint)>=Up.Medium}}]),e}()).\u0275fac=function(e){return new(e||qx)(_.Pb(L.g),_.Pb(Nt),_.Pb(_.i))},qx.\u0275cmp=_.Jb({type:qx,selectors:[["app-view-layers-bar"]],decls:2,vars:5,consts:[[1,"view-layers-bar"],[1,"view-layers-bar__slider",3,"ngClass"]],template:function(e,t){1&e&&(_.Vb(0,"div",0),_.Qb(1,"app-view-layers-slider",1),_.Ub()),2&e&&(_.Db(1),_.lc("ngClass",_.qc(1,tw,t.isLarge(),!t.isLarge(),t.assetsLoading)))},directives:[ew,or.i],styles:[".view-layers-bar[_ngcontent-%COMP%]{display:flex}.view-layers-bar__slider[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;margin-left:4px}.view-layers-bar__slider--large[_ngcontent-%COMP%]{width:300px}.view-layers-bar__slider--small[_ngcontent-%COMP%]{width:180px}.view-layers-bar__slider--disabled[_ngcontent-%COMP%]{opacity:.25;pointer-events:none}"],changeDetection:0}),qx),iw=["viewToolbar"];function ow(e,t){if(1&e&&(_.Vb(0,"app-pillbox",5),_.Qb(1,"app-view-tools",6),_.Ub()),2&e){var n=_.gc(2);_.Db(1),_.lc("collapsePagination",n.collapsePagination)("mode",n.viewToolsMode.Main)}}function aw(e,t){if(1&e&&(_.Vb(0,"div",3),_.Kc(1,ow,2,2,"app-pillbox",4),_.Ub()),2&e){var n=_.gc();_.lc("@inOutAnimation",void 0),_.Db(1),_.lc("ngIf",n.isVisible(n.viewUI.Pagination)||n.isVisible(n.viewUI.Mediabar))}}function rw(e,t){if(1&e){var n=_.Wb();_.Vb(0,"div",3),_.Vb(1,"app-pillbox",7),_.cc("exit",(function(){return _.zc(n),_.gc().handleExitClick()})),_.Qb(2,"app-view-media-bar",8),_.Ub(),_.Ub()}if(2&e){var i=_.gc();_.lc("@inOutAnimation",void 0),_.Db(1),_.lc("canExit",i.canExit),_.Db(1),_.lc("template",i.mediaTemplate)}}function cw(e,t){if(1&e){var n=_.Wb();_.Vb(0,"div",3),_.Vb(1,"app-pillbox",9),_.cc("exit",(function(){return _.zc(n),_.gc().handleExitClick()})),_.Qb(2,"app-view-tools",10),_.Ub(),_.Ub()}if(2&e){var i=_.gc();_.lc("@inOutAnimation",void 0),_.Db(1),_.lc("canExit",i.canExit),_.Db(1),_.lc("mode",i.viewToolsMode.Tools)}}function sw(e,t){if(1&e){var n=_.Wb();_.Vb(0,"div",3),_.Vb(1,"app-pillbox",11),_.cc("exit",(function(){return _.zc(n),_.gc().handleExitClick()})),_.Qb(2,"app-view-layers-bar"),_.Ub(),_.Ub()}if(2&e){var i=_.gc();_.lc("@inOutAnimation",void 0),_.Db(1),_.lc("canExit",i.canExit)}}var lw,pw=((lw=function(){function e(t,n,i,o,a){m(this,e),this.store=t,this.changeDetectorRef=n,this.layoutService=i,this.viewService=o,this.viewUIService=a,this.viewUI=Rp,this.canExit=!0,this.mode=sf.Main,this.lockMode=!1,this.position="center",this.ngUnsubscribe=new ge.a,this.breakpoint=Up,this.viewToolsMode=sf,this.viewLayout=Rp,this.collapsePagination=!1}return v(e,[{key:"ngOnInit",value:function(){this.initLayoutListener(),this.initBreakpointListener()}},{key:"initLayoutListener",value:function(){var e=this;this.store.select(hp.getUI).pipe(Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){e.lockMode||(e.mode=sf.Main,e.layoutService.isUIVisible(Rp.Media)&&(e.mediaTemplate=t.media.template,e.mode=sf.Media),e.layoutService.isToolsVisible()&&(e.mode=sf.Tools),e.layoutService.isVisibilityLayersVisible()&&e.layoutService.isUIVisible(Rp.VisibilityLayers)&&(e.mode=sf.VisibilityLayers),e.changeDetectorRef.markForCheck())}))}},{key:"initBreakpointListener",value:function(){var e=this;this.store.select(Ap.getBreakpoint).pipe(Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){e.collapsePagination=t<Up.Small,e.changeDetectorRef.markForCheck()}))}},{key:"isVisible",value:function(e){return this.viewUIService.isVisible(e)}},{key:"handleExitClick",value:function(){var e=this.store.selectSnapshot(hp.getUI);e.media.status=ns.Hide,e.tools.status=ns.Hide,e.visibilityLayers.status=ns.Hide,this.viewService.selectTool(Aa.Select),this.store.dispatch(new S.SetUI(e))}}]),e}()).\u0275fac=function(e){return new(e||lw)(_.Pb(L.g),_.Pb(_.i),_.Pb(Vp),_.Pb(Bu),_.Pb(Vp))},lw.\u0275cmp=_.Jb({type:lw,selectors:[["app-view-toolbar"]],viewQuery:function(e,t){var n;1&e&&_.Rc(iw,!0),2&e&&_.uc(n=_.dc())&&(t.viewToolbar=n.first)},inputs:{canExit:"canExit",mode:"mode",lockMode:"lockMode",position:"position"},decls:5,vars:4,consts:[["data-test","view-toolbar",3,"ngSwitch"],["class","view-toolbar",4,"ngSwitchDefault"],["class","view-toolbar",4,"ngSwitchCase"],[1,"view-toolbar"],["eventCategory","View Primary Toolbar","name","Primary Toolbar",4,"ngIf"],["eventCategory","View Primary Toolbar","name","Primary Toolbar"],[3,"collapsePagination","mode"],["eventCategory","View Media Bar","name","Media Bar",3,"canExit","exit"],[3,"template"],["eventCategory","View Explore Tools","name","Explore Tools",3,"canExit","exit"],[3,"mode"],["name","Visibility Layers",3,"canExit","exit"]],template:function(e,t){1&e&&(_.Tb(0,0),_.Kc(1,aw,2,2,"div",1),_.Kc(2,rw,3,3,"div",2),_.Kc(3,cw,3,3,"div",2),_.Kc(4,sw,3,2,"div",2),_.Sb()),2&e&&(_.lc("ngSwitch",t.mode),_.Db(2),_.lc("ngSwitchCase",t.viewToolsMode.Media),_.Db(1),_.lc("ngSwitchCase",t.viewToolsMode.Tools),_.Db(1),_.lc("ngSwitchCase",t.viewToolsMode.VisibilityLayers))},directives:[or.n,or.p,or.o,or.l,ix,Wx,Mx,nw],styles:[".view-toolbar{position:absolute;display:inline-block;z-index:20;bottom:0;right:0}"],encapsulation:2,data:{animation:[Object(fp.n)("inOutAnimation",[Object(fp.m)(":enter",[Object(fp.l)({opacity:0,transform:"translateY(200px)"}),Object(fp.e)("300ms ease-in-out",Object(fp.l)({opacity:1,transform:"*"}))]),Object(fp.m)(":leave",[Object(fp.e)("300ms ease-in-out",Object(fp.l)({transform:"translateY(200px)",opacity:0}))])])]},changeDetection:0}),lw),uw=function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r},dw=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function gw(e,t){if(1&e){var n=_.Wb();_.Vb(0,"button",16),_.cc("click",(function(){return _.zc(n),_.gc().handleSearchClick()})),_.Qb(1,"app-icon",17),_.Vb(2,"span",18),_.Mc(3,"Search"),_.Ub(),_.Ub()}}function hw(e,t){if(1&e){var n=_.Wb();_.Vb(0,"button",19),_.cc("click",(function(){return _.zc(n),_.gc().toggleToolbar("visibilityLayers")})),_.Qb(1,"app-icon",20),_.Vb(2,"span",18),_.Mc(3,"Layers"),_.Ub(),_.Ub()}}function fw(e,t){if(1&e){var n=_.Wb();_.Vb(0,"button",21),_.cc("click",(function(){return _.zc(n),_.gc().toggleToolbar("tools")})),_.Qb(1,"app-icon",22),_.Vb(2,"span",18),_.Mc(3,"Explore"),_.Ub(),_.Ub()}}function bw(e,t){if(1&e){var n=_.Wb();_.Vb(0,"button",23),_.cc("click",(function(){return _.zc(n),_.gc().handleDrawClick()})),_.hc(1,"async"),_.Qb(2,"app-icon",24),_.Vb(3,"span",18),_.Mc(4,"Draw"),_.Ub(),_.Ub()}if(2&e){var i,o=_.gc();_.lc("disabled",!(null!=(i=_.ic(1,1,o.selectedChapterReady$))&&i.model))}}function vw(e,t){if(1&e){var n=_.Wb();_.Vb(0,"button",25),_.cc("click",(function(){return _.zc(n),_.gc().handleTakeQuizClick()})),_.hc(1,"async"),_.hc(2,"async"),_.Qb(3,"app-icon",26),_.Vb(4,"span",18),_.Mc(5,"Take Quiz"),_.Ub(),_.Ub()}if(2&e){var i,o=_.gc();_.lc("disabled",!(null!=(i=_.ic(1,1,o.selectedChapterReady$))&&i.model)||_.ic(2,3,o.quizActive$))}}function mw(e,t){1&e&&(_.Tb(0),_.Mc(1,"Exit Fullscreen"),_.Sb())}function yw(e,t){1&e&&(_.Tb(0),_.Mc(1,"Enter Fullscreen"),_.Sb())}function xw(e,t){if(1&e){var n=_.Wb();_.Vb(0,"button",19),_.cc("click",(function(){return _.zc(n),_.gc(2).handleFullscreenClick()})),_.Kc(1,mw,2,0,"ng-container",8),_.Kc(2,yw,2,0,"ng-container",8),_.Ub()}if(2&e){var i=_.gc(2);_.Db(1),_.lc("ngIf",i.isFullscreen),_.Db(1),_.lc("ngIf",!i.isFullscreen)}}function ww(e,t){if(1&e){var n=_.Wb();_.Vb(0,"button",19),_.cc("click",(function(){return _.zc(n),_.gc(3).handleNewTabClick()})),_.Mc(1," Open in New Tab "),_.Ub()}}function kw(e,t){if(1&e&&(_.Tb(0),_.Kc(1,ww,2,0,"button",4),_.Sb()),2&e){var n=_.gc(2);_.Db(1),_.lc("ngIf",!n.canFullscreen)}}function Ow(e,t){if(1&e&&(_.Tb(0),_.Qb(1,"mat-divider"),_.Kc(2,xw,3,2,"button",4),_.Kc(3,kw,2,1,"ng-container",27),_.Sb()),2&e){var n=_.gc();_.Db(2),_.lc("ngIf",n.canFullscreen),_.Db(1),_.lc("appFlagApplication",n.application.All)("appFlagApplicationMode","exclude")("appFlagApplicationNative",n.nativePlatform.All)}}function Cw(e,t){1&e&&(_.Vb(0,"span",31),_.Mc(1,"(On)"),_.Ub())}function Sw(e,t){1&e&&(_.Vb(0,"span",31),_.Mc(1,"(Off)"),_.Ub())}function _w(e,t){if(1&e){var n=_.Wb();_.Vb(0,"button",28),_.cc("click",(function(){return _.zc(n),_.gc().handleToggleLabelsClick()})),_.Vb(1,"span",29),_.Mc(2,"Toggle Labels"),_.Ub(),_.Kc(3,Cw,2,0,"span",30),_.hc(4,"async"),_.Kc(5,Sw,2,0,"span",30),_.hc(6,"async"),_.Ub()}if(2&e){var i=_.gc();_.Db(3),_.lc("ngIf",_.ic(4,2,i.showLabels$)),_.Db(2),_.lc("ngIf",!_.ic(6,4,i.showLabels$))}}function jw(e,t){if(1&e&&(_.Vb(0,"button",32),_.Mc(1," Help "),_.Ub()),2&e){_.gc();var n=_.vc(16);_.lc("matMenuTriggerFor",n)}}var Pw,Mw=((Pw=function(){function e(t,n,i,o,a,r){m(this,e),this.viewUIService=t,this.viewService=n,this.quizService=i,this.engineService=o,this.changeDetectorRef=a,this.store=r,this.application=j,this.nativePlatform=pl,this.viewUI=Rp,this.isFullscreen=!1,this.canFullscreen=!1,this.ngUnsubscribe=new ge.a,this.visibilityLayersVisible=!1}return v(e,[{key:"ngOnInit",value:function(){this.canFullscreen=Kc.canFullscreen(),this.initFullscreenListener(),this.initLayoutListener()}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"initFullscreenListener",value:function(){var e=this;this.fullscreen$=Kc.onFullscreenChange(),this.fullscreen$.pipe(Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){e.isFullscreen=Kc.isFullscreen(),e.changeDetectorRef.markForCheck()}))}},{key:"initLayoutListener",value:function(){var e=this;this.store.select(hp.getUI).pipe(Object(fe.a)(this.ngUnsubscribe)).subscribe((function(){e.visibilityLayersVisible=e.viewUIService.isVisible(Rp.VisibilityLayers),e.changeDetectorRef.markForCheck()}))}},{key:"handleToggleLabelsClick",value:function(){this.viewService.toggleLabels()}},{key:"handleFullscreenClick",value:function(){Kc.toggleFullscreen()}},{key:"handleTutorialClick",value:function(){this.viewService.toggleTutorial(!0)}},{key:"handleTakeQuizClick",value:function(){this.quizService.startQuiz()}},{key:"handleHelpBasicsClick",value:function(){this.viewService.toggleHelp(!0,ve.Basics)}},{key:"handleHelpShortcutsClick",value:function(){this.viewService.toggleHelp(!0,ve.Shortcuts)}},{key:"handlePresentClick",value:function(){this.viewService.togglePresentation()}},{key:"handleNewTabClick",value:function(){this.viewService.openInNewTab()}},{key:"handleSearchClick",value:function(){this.viewService.toggleSearch()}},{key:"handleDrawClick",value:function(){this.viewService.toggleWhiteboard(!0)}},{key:"toggleToolbar",value:function(e){this.viewService.toggleToolbar(e)}},{key:"isEnabled",value:function(e){return this.viewUIService.isUIEnabled(e)}},{key:"isVisible",value:function(e){return this.viewUIService.isVisible(e)}}]),e}()).\u0275fac=function(e){return new(e||Pw)(_.Pb(Vp),_.Pb(Bu),_.Pb(lf),_.Pb(Nt),_.Pb(_.i),_.Pb(L.g))},Pw.\u0275cmp=_.Jb({type:Pw,selectors:[["app-view-menu"]],decls:24,vars:19,consts:[["gaEvent","","gaAction","Clicked View Menu","data-test","viewMenu","matTooltip","Menu","app-pin-button","","buttonType","secondary","icon","bars","aria-label","View Menu",2,"width","52px","height","52px",3,"matMenuTriggerFor","fill"],["gaCategory","View Menu",1,"view-menu"],["viewMenu","matMenu"],["gaEvent","","gaAction","Clicked Open Search","mat-menu-item","","data-test","viewSearchButton",3,"click",4,"ngIf"],["mat-menu-item","",3,"click",4,"ngIf"],["gaEvent","","gaAction","Clicked Open Explore Tools","mat-menu-item","","data-test","viewToolsButton",3,"click",4,"ngIf"],["gaEvent","","gaAction","Clicked Open Whiteboard","mat-menu-item","","data-test","viewDrawButton",3,"disabled","click",4,"ngIf"],["mat-menu-item","","data-test","viewQuizButton",3,"disabled","click",4,"ngIf"],[4,"ngIf"],["mat-menu-item","","data-test","viewToggleLabels",3,"click",4,"ngIf"],["mat-menu-item","",3,"matMenuTriggerFor",4,"ngIf"],["gaCategory","View Menu"],["helpMenu","matMenu"],["gaEvent","","gaAction","Clicked Launch Tutorial","mat-menu-item","",3,"disabled","click"],["gaEvent","","gaAction","Clicked 3d Navigation Basics","mat-menu-item","",3,"click"],["gaEvent","","gaAction","Clicked Keyboard Shortcuts","mat-menu-item","",3,"click"],["gaEvent","","gaAction","Clicked Open Search","mat-menu-item","","data-test","viewSearchButton",3,"click"],["icon","search",1,"view-menu__icon"],[1,"ml-2"],["mat-menu-item","",3,"click"],["icon","layer-group",1,"view-menu__icon"],["gaEvent","","gaAction","Clicked Open Explore Tools","mat-menu-item","","data-test","viewToolsButton",3,"click"],["icon","mouse-pointer",1,"view-menu__icon"],["gaEvent","","gaAction","Clicked Open Whiteboard","mat-menu-item","","data-test","viewDrawButton",3,"disabled","click"],["icon","signature",1,"view-menu__icon"],["mat-menu-item","","data-test","viewQuizButton",3,"disabled","click"],["icon","check",1,"view-menu__icon"],[4,"appFlagApplication","appFlagApplicationMode","appFlagApplicationNative"],["mat-menu-item","","data-test","viewToggleLabels",3,"click"],[1,"mr-3"],["class","text-dim",4,"ngIf"],[1,"text-dim"],["mat-menu-item","",3,"matMenuTriggerFor"]],template:function(e,t){if(1&e&&(_.Qb(0,"button",0),_.Vb(1,"mat-menu",1,2),_.Kc(3,gw,4,0,"button",3),_.Kc(4,hw,4,0,"button",4),_.Kc(5,fw,4,0,"button",5),_.Kc(6,bw,5,3,"button",6),_.Kc(7,vw,6,5,"button",7),_.hc(8,"async"),_.hc(9,"async"),_.hc(10,"async"),_.Kc(11,Ow,4,4,"ng-container",8),_.Kc(12,_w,7,6,"button",9),_.Qb(13,"mat-divider"),_.Kc(14,jw,2,1,"button",10),_.Ub(),_.Vb(15,"mat-menu",11,12),_.Vb(17,"button",13),_.cc("click",(function(){return t.handleTutorialClick()})),_.hc(18,"async"),_.Mc(19," Launch Tutorial "),_.Ub(),_.Vb(20,"button",14),_.cc("click",(function(){return t.handleHelpBasicsClick()})),_.Mc(21,"3D Navigation Basics"),_.Ub(),_.Vb(22,"button",15),_.cc("click",(function(){return t.handleHelpShortcutsClick()})),_.Mc(23,"Keyboard Shortcuts"),_.Ub(),_.Ub()),2&e){var n,i=_.vc(2);_.lc("matMenuTriggerFor",i)("fill",!0),_.Db(3),_.lc("ngIf",t.isEnabled(t.viewUI.Search)),_.Db(1),_.lc("ngIf",t.visibilityLayersVisible),_.Db(1),_.lc("ngIf",t.isEnabled(t.viewUI.Tools)),_.Db(1),_.lc("ngIf",t.isEnabled(t.viewUI.Whiteboard)),_.Db(1),_.lc("ngIf",_.ic(8,11,t.hasQuiz$)&&_.ic(9,13,t.quizEnabled$)&&!_.ic(10,15,t.quizLocked$)),_.Db(4),_.lc("ngIf",t.isEnabled(t.viewUI.Fullscreen)),_.Db(1),_.lc("ngIf",t.isEnabled(t.viewUI.ToggleLabels)),_.Db(2),_.lc("ngIf",t.isEnabled(t.viewUI.Help)),_.Db(3),_.lc("disabled",!(null!=(n=_.ic(18,17,t.selectedChapterReady$))&&n.model))}},directives:[ag,ke.b,rg.c,ll.d,ll.a,ke.a,or.l,dl.a,ll.b,Js,ul],pipes:[or.b],styles:[".view-menu__icon[_ngcontent-%COMP%]{display:inline-flex;justify-content:center;width:16px}"],changeDetection:0}),uw([Object(L.d)(Ua.getSelectedChapterReadyState),dw("design:type",he.a)],Pw.prototype,"selectedChapterReady$",void 0),uw([Object(L.d)(So.hasQuiz),dw("design:type",he.a)],Pw.prototype,"hasQuiz$",void 0),uw([Object(L.d)(So.getQuizEnabled),dw("design:type",he.a)],Pw.prototype,"quizEnabled$",void 0),uw([Object(L.d)(So.getQuizModeLocked),dw("design:type",he.a)],Pw.prototype,"quizLocked$",void 0),uw([Object(L.d)(So.getQuizModeActive),dw("design:type",he.a)],Pw.prototype,"quizActive$",void 0),uw([Object(L.d)(qa.getShowLabels),dw("design:type",he.a)],Pw.prototype,"showLabels$",void 0),Pw),Iw=function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r},zw=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function Tw(e,t){if(1&e){var n=_.Wb();_.Vb(0,"button",8),_.cc("touchstart",(function(){return _.zc(n),_.gc(2).setZoom("out")}))("mousedown",(function(){return _.zc(n),_.gc(2).setZoom("out")}))("touchend",(function(){return _.zc(n),_.gc(2).setZoom("")}))("mouseup",(function(){return _.zc(n),_.gc(2).setZoom("")}))("mouseleave",(function(){return _.zc(n),_.gc(2).setZoom("")}))("keyup.enter",(function(){return _.zc(n),_.gc(2).setZoomFixed("out")})),_.Ub()}}function Uw(e,t){if(1&e){var n=_.Wb();_.Vb(0,"button",9),_.cc("touchstart",(function(){return _.zc(n),_.gc(2).setZoom("in")}))("mousedown",(function(){return _.zc(n),_.gc(2).setZoom("in")}))("touchend",(function(){return _.zc(n),_.gc(2).setZoom("")}))("mouseup",(function(){return _.zc(n),_.gc(2).setZoom("")}))("mouseleave",(function(){return _.zc(n),_.gc(2).setZoom("")}))("keyup.enter",(function(){return _.zc(n),_.gc(2).setZoomFixed("in")})),_.Ub()}}function Lw(e,t){if(1&e){var n=_.Wb();_.Vb(0,"button",10),_.cc("click",(function(){return _.zc(n),_.gc(2).returnToChapterCamera()})),_.Ub()}}function Dw(e,t){if(1&e){var n=_.Wb();_.Vb(0,"button",11),_.cc("click",(function(){return _.zc(n),_.gc(2).togglePan()})),_.hc(1,"async"),_.hc(2,"async"),_.hc(3,"async"),_.hc(4,"async"),_.Ub()}if(2&e){var i=_.gc(2);_.lc("gaLabel","pan"===_.ic(1,4,i.panMode$)?"Rotate":"Pan")("selected","pan"===_.ic(2,6,i.panMode$))("matTooltip","pan"===_.ic(4,10,i.panMode$)?"Switch to Rotate Mode":"Switch to Pan Mode"),_.Eb("aria-label","pan"===_.ic(3,8,i.panMode$)?"Switch to Rotate Mode":"Switch to Pan Mode")}}function Ew(e,t){if(1&e&&(_.Vb(0,"app-pillbox",2),_.Vb(1,"div",3),_.Kc(2,Tw,1,0,"button",4),_.Kc(3,Uw,1,0,"button",5),_.Kc(4,Lw,1,0,"button",6),_.Kc(5,Dw,5,12,"button",7),_.Ub(),_.Ub()),2&e){var n=_.gc();_.Db(2),_.lc("ngIf",n.showZoom),_.Db(1),_.lc("ngIf",n.showZoom),_.Db(1),_.lc("ngIf",n.showResetPosition),_.Db(1),_.lc("ngIf",n.showPan)}}var Fw,Aw=((Fw=function(){function e(t,n){m(this,e),this.store=t,this.cameraService=n,this.showNav=!0,this.showZoom=!0,this.showPan=!0,this.showResetPosition=!0,this.viewLayout=Rp,this.toolEnum=Aa,this.expandNav=!1,this.breakpointEnum=Up,this.padding="none",this.ngUnsubscribe=new ge.a}return v(e,[{key:"ngOnInit",value:function(){}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"setZoom",value:function(e){var t=""===e?0:8;t="in"===e?-t:t,this.store.dispatch(new Zt(t))}},{key:"setZoomFixed",value:function(e){this.cameraService.setCameraZoomWithVelocity("in"===e?-8:8)}},{key:"returnToChapterCamera",value:function(){var e=this.store.selectSnapshot(Ua.getSelectedChapter);this.store.dispatch(new Wt(e.camera.location))}},{key:"resetChapter",value:function(){this.returnToChapterCamera();var e=this.store.selectSnapshot(Ua.getSelectedChapterId);this.store.dispatch(new ui.UndoAll(e)),this.store.dispatch(new pi.UpdateNodesChecked(!1)),this.store.dispatch(new Qo)}},{key:"centerCamera",value:function(){this.store.dispatch(new Be)}},{key:"togglePan",value:function(){var e="pan"===this.store.selectSnapshot(Fa.getPanMode)?"rotate":"pan";this.store.dispatch(new an(e))}},{key:"toggleNav",value:function(){this.expandNav=!this.expandNav}}]),e}()).\u0275fac=function(e){return new(e||Fw)(_.Pb(L.g),_.Pb(dn))},Fw.\u0275cmp=_.Jb({type:Fw,selectors:[["app-engine-camera-bar"]],inputs:{showNav:"showNav",showZoom:"showZoom",showPan:"showPan",showResetPosition:"showResetPosition"},decls:2,vars:1,consts:[["gaCategory","Engine 3D Controls","data-test","cameraBar",1,"camera-bar"],["eventCategory","Engine 3D Controls","orientation","vertical",4,"ngIf"],["eventCategory","Engine 3D Controls","orientation","vertical"],[1,"camera-bar__nav"],["gaEvent","","gaAction","Clicked Zoom Out","app-pin-button","","buttonType","ghost","icon","minus","tabIndex","0","data-test","cameraZoomOut","aria-label","Zoom Out","matTooltip","Zoom Out","matTooltipPosition","left",3,"touchstart","mousedown","touchend","mouseup","mouseleave","keyup.enter",4,"ngIf"],["gaEvent","","gaAction","Clicked Zoom In","app-pin-button","","buttonType","ghost","icon","plus","tabIndex","0","data-test","cameraZoomIn","aria-label","Zoom In","matTooltip","Zoom In","matTooltipPosition","left",3,"touchstart","mousedown","touchend","mouseup","mouseleave","keyup.enter",4,"ngIf"],["gaEvent","","gaAction","Clicked Recenter 3D Model","app-pin-button","","icon","location","buttonType","ghost","tabIndex","0","aria-label","Recenter 3D model","matTooltip","Recenter 3D model","matTooltipPosition","left","data-test","cameraReset",3,"click",4,"ngIf"],["gaEvent","","gaAction","Clicked Switch Mode","app-pin-button","","tabIndex","0","icon","arrows-alt","buttonType","ghost","matTooltipPosition","left","data-test","cameraPan",3,"gaLabel","selected","matTooltip","click",4,"ngIf"],["gaEvent","","gaAction","Clicked Zoom Out","app-pin-button","","buttonType","ghost","icon","minus","tabIndex","0","data-test","cameraZoomOut","aria-label","Zoom Out","matTooltip","Zoom Out","matTooltipPosition","left",3,"touchstart","mousedown","touchend","mouseup","mouseleave","keyup.enter"],["gaEvent","","gaAction","Clicked Zoom In","app-pin-button","","buttonType","ghost","icon","plus","tabIndex","0","data-test","cameraZoomIn","aria-label","Zoom In","matTooltip","Zoom In","matTooltipPosition","left",3,"touchstart","mousedown","touchend","mouseup","mouseleave","keyup.enter"],["gaEvent","","gaAction","Clicked Recenter 3D Model","app-pin-button","","icon","location","buttonType","ghost","tabIndex","0","aria-label","Recenter 3D model","matTooltip","Recenter 3D model","matTooltipPosition","left","data-test","cameraReset",3,"click"],["gaEvent","","gaAction","Clicked Switch Mode","app-pin-button","","tabIndex","0","icon","arrows-alt","buttonType","ghost","matTooltipPosition","left","data-test","cameraPan",3,"gaLabel","selected","matTooltip","click"]],template:function(e,t){1&e&&(_.Vb(0,"div",0),_.Kc(1,Ew,6,4,"app-pillbox",1),_.Ub()),2&e&&(_.Db(1),_.lc("ngIf",t.showNav))},directives:[ke.a,or.l,ix,ag,ke.b,rg.c],pipes:[or.b],styles:[":host{position:relative}.camera-bar{display:flex;flex-direction:column;align-items:center}.camera-bar button:not(:first-child){margin-top:4px}.camera-bar__nav{display:flex;flex-direction:column-reverse;overflow:hidden;transition:height .15s ease-in-out;justify-content:space-between}"],encapsulation:2,data:{animation:[Object(fp.n)("expand",[Object(fp.m)(":enter",[Object(fp.j)([Object(fp.l)({height:0}),Object(fp.e)("150ms ease-in-out",Object(fp.l)({height:"*"}))])]),Object(fp.m)(":leave",[Object(fp.j)([Object(fp.e)("150ms ease-in-out",Object(fp.l)({height:"0"}))])])]),Object(fp.n)("show",[Object(fp.m)(":enter",[Object(fp.j)([Object(fp.l)({height:"0"}),Object(fp.e)("125ms ease-in-out",Object(fp.l)({height:"*"}))])]),Object(fp.m)(":leave",[Object(fp.j)([Object(fp.e)("125ms 125ms ease-in-out",Object(fp.l)({height:"0"}))])])])]},changeDetection:0}),Iw([Object(L.d)(Fa.getPanMode),zw("design:type",he.a)],Fw.prototype,"panMode$",void 0),Iw([Object(L.d)(Ap.getBreakpoint),zw("design:type",he.a)],Fw.prototype,"breakpoint$",void 0),Fw);function Rw(e,t){if(1&e&&(_.Vb(0,"kbd",10),_.Mc(1),_.Ub()),2&e){var n=t.$implicit;_.Db(1),_.Nc(n)}}function Nw(e,t){if(1&e&&(_.Vb(0,"tr",6),_.Vb(1,"td",7),_.Mc(2),_.Ub(),_.Vb(3,"td",8),_.Kc(4,Rw,2,1,"kbd",9),_.Ub(),_.Ub()),2&e){var n=t.$implicit;_.Db(2),_.Nc(n.label),_.Db(2),_.lc("ngForOf",n.keys)}}function Vw(e,t){if(1&e&&(_.Vb(0,"div",2),_.Vb(1,"h2",3),_.Mc(2),_.Ub(),_.Vb(3,"table",4),_.Vb(4,"tbody"),_.Kc(5,Nw,5,2,"tr",5),_.Ub(),_.Ub(),_.Ub()),2&e){var n=t.$implicit;_.Db(2),_.Nc(n.label),_.Db(3),_.lc("ngForOf",n.shortcuts)}}var Hw,Bw=function(e){return e.Left="\u2190",e.Right="\u2192",e.Up="\u2191",e.Down="\u2193",e.Command="\u2318",e}({}),Qw=((Hw=function(){function e(){m(this,e),this.shortcutGroups=[{label:"Navigation",shortcuts:[{keys:[",","Pg-Up"],label:"Previous chapter"},{keys:[".","Pg-Down"],label:"Next chapter"},{keys:["/"],label:"Open Search"},{keys:["Ctrl + Enter"],label:"Enter Fullscreen"},{keys:["Ctrl/Cmd + ,"],label:"Toggle Description"}]},{label:"Tools",shortcuts:[{keys:["1"],label:'Use "Select" tool'},{keys:["2"],label:'Use "Hide" tool'},{keys:["3"],label:'Use "Fade" tool'},{keys:["del","backspace"],label:"Hide selected structure"},{keys:["Shift + R"],label:"Reset chapter"},{keys:["Ctrl/Cmd + Z"],label:"Undo"},{keys:["Ctrl/Cmd + Shift + Z","Ctrl/Cmd + Y"],label:"Redo"}]},{label:"Pan",shortcuts:[{keys:["W"],label:"Pan up"},{keys:["S"],label:"Pan down"},{keys:["A"],label:"Pan left"},{keys:["D"],label:"Pan right"},{keys:["Shift + W"],label:"Slow pan up"},{keys:["Shift + S"],label:"Slow pan down"},{keys:["Shift + A"],label:"Slow pan left"},{keys:["Shift + D"],label:"Slow pan right"}]},{label:"Rotate",shortcuts:[{keys:[Bw.Up],label:"Rotate up"},{keys:[Bw.Down],label:"Rotate down"},{keys:[Bw.Left],label:"Rotate left"},{keys:[Bw.Right],label:"Rotate right"},{keys:["Shift + "+Bw.Up],label:"Slow rotate up"},{keys:["Shift + "+Bw.Down],label:"Slow rotate down"},{keys:["Shift + "+Bw.Left],label:"Slow rotate left"},{keys:["Shift + "+Bw.Right],label:"Slow rotate right"}]},{label:"Zoom",shortcuts:[{keys:["C","="],label:"Zoom in"},{keys:["E","-"],label:"Zoom out"},{keys:["Shift + C","Shift + ="],label:"Slow zoom in"},{keys:["Shift + E","Shift + -"],label:"Slow zoom out"}]}]}return v(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||Hw)},Hw.\u0275cmp=_.Jb({type:Hw,selectors:[["app-view-shortcuts"]],decls:2,vars:1,consts:[[1,"view-shortcuts"],["class","view-shortcuts__group",4,"ngFor","ngForOf"],[1,"view-shortcuts__group"],[1,"view-shortcuts__label","text-bold"],[1,"view-shortcuts__table"],["class","view-shortcuts__row",4,"ngFor","ngForOf"],[1,"view-shortcuts__row"],[1,"view-shortcuts__cell","view-shortcuts__cell--label"],[1,"view-shortcuts__cell","view-shortcuts__cell--key"],["class","view-shortcuts__key",4,"ngFor","ngForOf"],[1,"view-shortcuts__key"]],template:function(e,t){1&e&&(_.Vb(0,"div",0),_.Kc(1,Vw,6,2,"div",1),_.Ub()),2&e&&(_.Db(1),_.lc("ngForOf",t.shortcutGroups))},directives:[or.k],styles:[".view-shortcuts[_ngcontent-%COMP%]{display:flex;flex-direction:column}.view-shortcuts__group[_ngcontent-%COMP%]{width:100%;padding-bottom:32px;margin-top:32px}.view-shortcuts__label[_ngcontent-%COMP%]{padding:8px 0 12px}.view-shortcuts__table[_ngcontent-%COMP%]{width:100%}.view-shortcuts__cell[_ngcontent-%COMP%]{padding:8px;border-bottom:1px solid hsla(0,0%,100%,.3);width:50%}.view-shortcuts__key[_ngcontent-%COMP%]{border-radius:4px;display:inline-flex;padding:4px;margin-right:4px;background:#000;color:#fff;justify-content:center;align-items:center;font-family:monospace;font-size:16px}"],changeDetection:0}),Hw),qw=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Ww=["viewHelp"];function $w(e,t){1&e&&(_.Tb(0),_.Vb(1,"div",10),_.Vb(2,"div",11),_.Qb(3,"div",12),_.Vb(4,"div",13),_.Mc(5,"Rotate"),_.Ub(),_.Mc(6," Click and drag or use one finger to change the viewing angle. "),_.Ub(),_.Vb(7,"div",11),_.Qb(8,"div",12),_.Vb(9,"div",13),_.Mc(10,"Pan"),_.Ub(),_.Mc(11," Hold the shift key and drag or use two fingers to move the model's position. "),_.Ub(),_.Vb(12,"div",11),_.Qb(13,"div",12),_.Vb(14,"div",13),_.Mc(15,"Zoom"),_.Ub(),_.Mc(16," Scroll up and down or pinch with two fingers to zoom in or out. "),_.Ub(),_.Vb(17,"div",11),_.Qb(18,"div",12),_.Vb(19,"div",13),_.Mc(20,"Explore the Anatomy"),_.Ub(),_.Mc(21," Click or tap an anatomic structure or label to learn more. "),_.Ub(),_.Ub(),_.Sb()),2&e&&(_.Db(3),_.Hc("background-image","url(assets/images/widget/help-rotate.svg)"),_.Db(5),_.Hc("background-image","url(assets/images/widget/help-pan.svg)"),_.Db(5),_.Hc("background-image","url(assets/images/widget/help-zoom.svg)"),_.Db(5),_.Hc("background-image","url(assets/images/widget/help-learn.svg)"))}function Kw(e,t){1&e&&(_.Tb(0),_.Vb(1,"div",14),_.Mc(2," Mouse "),_.Ub(),_.Vb(3,"div",10),_.Vb(4,"div",11),_.Qb(5,"div",12),_.Mc(6," Hold left button to rotate "),_.Ub(),_.Vb(7,"div",11),_.Qb(8,"div",12),_.Mc(9," Hold right button to pan "),_.Ub(),_.Vb(10,"div",11),_.Qb(11,"div",12),_.Mc(12," Single-click left button to select a structure "),_.Ub(),_.Vb(13,"div",11),_.Qb(14,"div",12),_.Mc(15," Double-click left button to auto-focus on a structure "),_.Ub(),_.Vb(16,"div",11),_.Qb(17,"div",12),_.Mc(18," Long-click to fly to a structure "),_.Ub(),_.Ub(),_.Vb(19,"div",14),_.Mc(20," Keyboard "),_.Ub(),_.Vb(21,"div",10),_.Vb(22,"div",11),_.Qb(23,"div",12),_.Mc(24," Rotate with arrows "),_.Ub(),_.Vb(25,"div",11),_.Qb(26,"div",12),_.Mc(27," Pan up (W), left (A), down (S), right(D) "),_.Ub(),_.Vb(28,"div",11),_.Qb(29,"div",12),_.Mc(30," Zoom out (-, C) and zoom in (+, E) "),_.Ub(),_.Vb(31,"div",11),_.Qb(32,"div",12),_.Mc(33," Hold with any previous key to slow down motion "),_.Ub(),_.Ub(),_.Vb(34,"div",14),_.Mc(35," Trackpad "),_.Ub(),_.Vb(36,"div",10),_.Vb(37,"div",11),_.Qb(38,"div",12),_.Mc(39," Single-tap to auto-focus a structure "),_.Ub(),_.Vb(40,"div",11),_.Qb(41,"div",12),_.Mc(42," Double-tap to select a structure "),_.Ub(),_.Vb(43,"div",11),_.Qb(44,"div",12),_.Mc(45," Long-press to fly to a structure "),_.Ub(),_.Vb(46,"div",11),_.Qb(47,"div",12),_.Mc(48," Scroll up and down to zoom "),_.Ub(),_.Ub(),_.Vb(49,"div",14),_.Mc(50," In-App "),_.Ub(),_.Vb(51,"div",10),_.Vb(52,"div",11),_.Qb(53,"app-icon",15),_.Mc(54," Zoom in "),_.Ub(),_.Vb(55,"div",11),_.Qb(56,"app-icon",16),_.Mc(57," Zoom out "),_.Ub(),_.Vb(58,"div",11),_.Qb(59,"app-icon",17),_.Mc(60," Recenter 3D model "),_.Ub(),_.Vb(61,"div",11),_.Qb(62,"app-icon",18),_.Mc(63," Pan "),_.Ub(),_.Ub(),_.Sb()),2&e&&(_.Db(5),_.Hc("background-image","url(assets/images/widget/help-mouse-hold-left.svg)"),_.Db(3),_.Hc("background-image","url(assets/images/widget/help-mouse-hold-right.svg)"),_.Db(3),_.Hc("background-image","url(assets/images/widget/help-mouse-single-click-left.svg)"),_.Db(3),_.Hc("background-image","url(assets/images/widget/help-mouse-double-click-left.svg)"),_.Db(3),_.Hc("background-image","url(assets/images/widget/help-mouse-long-press-left.svg)"),_.Db(6),_.Hc("background-image","url(assets/images/widget/help-keyboard-rotate.svg)"),_.Db(3),_.Hc("background-image","url(assets/images/widget/help-keyboard-pan.svg)"),_.Db(3),_.Hc("background-image","url(assets/images/widget/help-keyboard-zoom.svg)"),_.Db(3),_.Hc("background-image","url(assets/images/widget/help-keyboard-slow-motion.svg)"),_.Db(6),_.Hc("background-image","url(assets/images/widget/help-trackpad-single-tap.svg)"),_.Db(3),_.Hc("background-image","url(assets/images/widget/help-trackpad-double-tap.svg)"),_.Db(3),_.Hc("background-image","url(assets/images/widget/help-trackpad-long-press.svg)"),_.Db(3),_.Hc("background-image","url(assets/images/widget/help-trackpad-scroll.svg)"))}function Gw(e,t){1&e&&(_.Tb(0),_.Qb(1,"app-view-shortcuts"),_.Sb())}var Zw,Jw,Xw,Yw,ek,tk,nk,ik,ok,ak=function(e){return{"view-help__tab--active":e}},rk=((Zw=function(){function e(t,n){m(this,e),this.renderer=t,this.viewService=n,this.helpTypeEnum=ve,this.activeTab=ve.Basics,this.ngUnsubscribe=new ge.a}return v(e,[{key:"ngOnInit",value:function(){this.initWindowSizeObserver()}},{key:"ngAfterViewInit",value:function(){this.updateViewHeight()}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"initWindowSizeObserver",value:function(){var e=this;this.renderer.listen("window","resize",(function(){e.updateViewHeight()}))}},{key:"updateViewHeight",value:function(){var e=this.viewService.getVH(!1);this.viewHelp.nativeElement.style.setProperty("--vh",e+"px")}},{key:"handleCloseClick",value:function(){this.viewService.toggleHelp(!1)}},{key:"handleTabClick",value:function(e){this.activeTab=e}}]),e}()).\u0275fac=function(e){return new(e||Zw)(_.Pb(_.H),_.Pb(Bu))},Zw.\u0275cmp=_.Jb({type:Zw,selectors:[["app-view-help"]],viewQuery:function(e,t){var n;1&e&&_.Gc(Ww,!0),2&e&&_.uc(n=_.dc())&&(t.viewHelp=n.first)},inputs:{activeTab:"activeTab"},decls:15,vars:13,consts:[["gaCategory","View Help",1,"view-help"],["viewHelp",""],[1,"view-help__inner",3,"ngSwitch"],["gaEvent","","gaAction","Clicked Close Help",1,"view-help__close",3,"click"],["icon","times"],[1,"view-help__tabs"],["gaEvent","","gaAction","Clicked Navigation Basics","role","button",1,"view-help__tab",3,"ngClass","click"],["gaEvent","","gaAction","Clicked All Controls","role","button",1,"view-help__tab",3,"ngClass","click"],["gaEvent","","gaAction","Clicked Keyboard Shortcuts","role","button",1,"view-help__tab",3,"ngClass","click"],[4,"ngSwitchCase"],[1,"view-help__group"],[1,"view-help__item"],[1,"view-help__image"],[1,"view-help__label"],[1,"view-help__header"],["icon","plus",1,"view-help__icon"],["icon","minus",1,"view-help__icon"],["icon","location",1,"view-help__icon"],["icon","arrows",1,"view-help__icon"]],template:function(e,t){1&e&&(_.Vb(0,"div",0,1),_.Vb(2,"div",2),_.Vb(3,"div",3),_.cc("click",(function(){return t.handleCloseClick()})),_.Qb(4,"app-icon",4),_.Ub(),_.Vb(5,"div",5),_.Vb(6,"div",6),_.cc("click",(function(){return t.handleTabClick(t.helpTypeEnum.Basics)})),_.Mc(7," Navigation Basics "),_.Ub(),_.Vb(8,"div",7),_.cc("click",(function(){return t.handleTabClick(t.helpTypeEnum.All)})),_.Mc(9," All Controls "),_.Ub(),_.Vb(10,"div",8),_.cc("click",(function(){return t.handleTabClick(t.helpTypeEnum.Shortcuts)})),_.Mc(11," Keyboard Shortcuts "),_.Ub(),_.Ub(),_.Kc(12,$w,22,8,"ng-container",9),_.Kc(13,Kw,64,26,"ng-container",9),_.Kc(14,Gw,2,0,"ng-container",9),_.Ub(),_.Ub()),2&e&&(_.Db(2),_.lc("ngSwitch",t.activeTab),_.Db(4),_.lc("ngClass",_.oc(7,ak,t.activeTab===t.helpTypeEnum.Basics)),_.Db(2),_.lc("ngClass",_.oc(9,ak,t.activeTab===t.helpTypeEnum.All)),_.Db(2),_.lc("ngClass",_.oc(11,ak,t.activeTab===t.helpTypeEnum.Shortcuts)),_.Db(2),_.lc("ngSwitchCase",t.helpTypeEnum.Basics),_.Db(1),_.lc("ngSwitchCase",t.helpTypeEnum.All),_.Db(1),_.lc("ngSwitchCase",t.helpTypeEnum.Shortcuts))},directives:[ke.a,or.n,ke.b,Js,or.i,or.o,Qw],styles:['.text-8{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-header{font-weight:700}.text--code{font-family:Courier New,Courier,monospace}.text-uppercase{text-transform:uppercase}.text-xlight{font-weight:200}.text-light{font-weight:300}.text-medium{font-weight:500}.text-semibold{font-weight:600}.text-bold{font-weight:700}.text-underline{text-decoration:underline}.text-italic{font-style:italic}.text-bright{color:#fff}.text-dim{color:#96a8c0}.text-error{color:#ed4758}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.text-ellipsis{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link,.text-link:visited{color:inherit;cursor:pointer}.text-link:not(.text-underline),.text-link:visited:not(.text-underline){text-decoration:none}.text-success{color:#38de38}.text-danger{color:#de3838}.text-info{color:#0060c4}.text-nowrap{white-space:nowrap}.text-pre-line{white-space:pre-line}.view-help{background-color:rgba(16,24,35,.9);color:#fff;background-color:var(--view-help-bg);color:var(--view-help-color);display:flex;align-items:center;flex-direction:column;position:fixed;top:0;left:0;right:0;z-index:10000;height:100vh;height:calc(var(--vh, 1vh) * 100);max-height:100vh;overflow:auto}.view-help__inner{width:100%;max-width:1140px;height:99vh;height:calc(var(--vh, 1vh) * 99);padding:32px;position:relative}.view-help__close{width:40px;height:40px;display:flex;align-items:center;justify-content:center;position:fixed;right:8px;top:8px}.view-help__close:hover{cursor:pointer}.view-help__header{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase;border-bottom:1px solid hsla(0,0%,100%,.3);border-bottom:var(--view-help-border);font-weight:600;padding-bottom:12px;margin-top:32px}.view-help__label{font-size:14px;letter-spacing:.35px;line-height:1.4em;font-weight:600;margin-bottom:12px}.view-help__group{display:flex;justify-content:space-around;flex-wrap:wrap}.view-help__item{font-size:12px;letter-spacing:.3px;line-height:1.4em;display:flex;flex-flow:column;text-align:center;padding:20px;flex:0 1 180px}.view-help__image{margin-bottom:16px;width:160px;height:100px;background-position:50%;background-repeat:no-repeat}.view-help__icon{font-size:24px;margin-bottom:16px}.view-help__tabs{display:flex;justify-content:center;align-items:center}.view-help__tab{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase;border-bottom:2px solid transparent;padding:12px;text-align:center}.view-help__tab:after{content:"";display:block;border-bottom:3px solid #2d72dc;border-bottom:var(--view-help-tab-border);margin-top:4px;width:0;transition:.25s ease}.view-help__tab:hover{cursor:pointer}.view-help__tab--active:after{width:100%}'],encapsulation:2,changeDetection:0}),function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);a>3&&r&&Object.defineProperty(t,n,r)}([Object(L.d)(hp.getCanTouch),qw("design:type",he.a)],Zw.prototype,"canTouch$",void 0),Zw),ck=h("un/a"),sk=function e(){m(this,e)},lk=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},pk=(Jw=function e(){m(this,e),this.type=P.Bookmark,this.favorite=!1,this.unavailable=!1},function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);a>3&&r&&Object.defineProperty(t,n,r)}([Object(Y.Type)((function(){return sk})),lk("design:type",Array)],Jw.prototype,"group_access",void 0),Jw),uk=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},dk=(Xw=function e(){m(this,e)},function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);a>3&&r&&Object.defineProperty(t,n,r)}([Object(Y.Type)((function(){return pc})),uk("design:type",String)],Xw.prototype,"objectId",void 0),Xw),gk=function e(){m(this,e)},hk=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},fk=(Yw=function e(){m(this,e)},function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);a>3&&r&&Object.defineProperty(t,n,r)}([Object(Y.Type)((function(){return dk})),Object(Y.Type)((function(){return _t})),Object(Y.Type)((function(){return gk})),hk("design:type",String)],Yw.prototype,"moduleId",void 0),Yw),bk={main:[{title:"All Models",id:"all",type:"Category",translations:{es:{title:"Todas las Categor\xedas"},zh:{title:"\u6240\u6709\u7c7b\u522b"},fr:{title:"Toutes les cat\xe9gories"},de:{title:"Alle Kategorien"},it:{title:"Tutte le categorie"},ja:{title:"\u3059\u3079\u3066\u306e\u30ab\u30c6\u30b4\u30ea"},pt:{title:"Todas as categorias"}}}],categories:[{title:"Anatomy by Regions",id:"regional",type:"Category",translations:{es:{title:"Anatom\xeda por Regiones"},zh:{title:"\u6309\u5730\u533a\u5212\u5206\u7684\u89e3\u5256\u5b66"},fr:{title:"Anatomie par r\xe9gions"},de:{title:"Anatomie nach Regionen"},it:{title:"Anatomia per regioni"},ja:{title:"\u5730\u57df\u5225\u89e3\u5256\u5b66"},pt:{title:"Anatomia por Regi\xf5es"}}},{title:"Anatomy by Systems",id:"system",type:"Category",translations:{es:{title:"Anatom\xeda por Sistemas"},zh:{title:"\u6309\u7cfb\u7edf\u8fdb\u884c\u89e3\u5256\u5b66"},fr:{title:"Anatomie par syst\xe8mes"},de:{title:"Anatomie nach Systemen"},it:{title:"Anatomia per sistemi"},ja:{title:"\u30b7\u30b9\u30c6\u30e0\u306b\u3088\u308b\u89e3\u5256\u5b66"},pt:{title:"Anatomia por Sistemas"}}},{title:"Complete Anatomy",id:"complete anatomy",type:"Category",translations:{de:{title:"Komplette Anatomie"},es:{title:"Anatom\xeda completa"},fr:{title:"Anatomie compl\xe8te"},it:{title:"Anatomia completa"},ja:{title:"\u5b8c\u5168\u306a\u89e3\u5256\u5b66"},pt:{title:"Anatomia Completa"},zh:{title:"\u5b8c\u6574\u89e3\u5256\u5b66"}}},{title:"Cross Sections & Micro Anatomy",id:"Cross Section and Micro Anatomy",type:"Category",translations:{de:{title:"Querschnitte & Mikro-Anatomie"},es:{title:"Secciones transversales y Micro Anatom\xeda"},fr:{title:"Sections transversales et micro anatomie"},it:{title:"Sezioni trasversali & Micro Anatomia"},ja:{title:"\u65ad\u9762\uff06\u30de\u30a4\u30af\u30ed\u89e3\u5256\u5b66"},pt:{title:"Se\xe7\xf5es Transversais e Micro Anatomia"},zh:{title:"\u622a\u9762\u548c\u5fae\u578b\u89e3\u5256\u5b66"}}}],specialties:[{title:"Allergy & Immunology",id:"Allergy and Immunology",type:"Category",translations:{de:{title:"Allergie und Immunologie"},es:{title:"Alergia e Inmunolog\xeda"},fr:{title:"Allergie et Immunologie"},it:{title:"Allergia e Immunologia"},ja:{title:"\u30a2\u30ec\u30eb\u30ae\u30fc\u3068\u514d\u75ab\u5b66"},pt:{title:"Alergia e Imunologia"},zh:{title:"\u8fc7\u654f\u4e0e\u514d\u75ab\u5b66"}}},{title:"Cardiology",id:"Cardiology",type:"Category",translations:{de:{title:"Kardiologie"},es:{title:"Cardiolog\xeda"},fr:{title:"Cardiologie"},it:{title:"Cardiologia"},ja:{title:"\u5fc3\u81d3\u75c5\u5b66"},pt:{title:"Cardiologia"},zh:{title:"\u5fc3\u810f\u75c5\u5b66"}}},{title:"Dentistry",id:"Dentistry",type:"Category",translations:{de:{title:"Zahnmedizin"},es:{title:"Odontolog\xeda"},fr:{title:"Dentisterie"},it:{title:"Odontoiatria"},ja:{title:"\u6b6f\u79d1"},pt:{title:"Odontologia"},zh:{title:"\u7259\u79d1"}}},{title:"Dermatology",id:"Dermatology",type:"Category",translations:{de:{title:"Dermatologie"},es:{title:"Dermatolog\xeda"},fr:{title:"Dermatologie"},it:{title:"Dermatologia"},ja:{title:"\u76ae\u819a\u79d1"},pt:{title:"Dermatologia"},zh:{title:"\u76ae\u80a4\u79d1"}}},{title:"Endocrinology",id:"Endocrinology",type:"Category",translations:{de:{title:"Endokrinologie"},es:{title:"Endocrinolog\xeda"},fr:{title:"Endocrinologie"},it:{title:"Endocrinologia"},ja:{title:"\u5185\u5206\u6ccc\u5185\u79d1"},pt:{title:"Endocrinologia"},zh:{title:"\u5185\u5206\u6ccc\u5b66"}}},{title:"Gastroenterology",id:"Gastroenterology and Hepatology",type:"Category",translations:{de:{title:"Gastroenterologie"},es:{title:"Gastroenterolog\xeda"},fr:{title:"Gastroent\xe9rologie"},it:{title:"Gastroenterologia"},ja:{title:"\u6d88\u5316\u5668\u5185\u79d1"},pt:{title:"Gastroenterologia"},zh:{title:"\u80c3\u80a0\u75c5\u5b66"}}},{title:"Infectious Disease",id:"Infectious Disease",type:"Category",translations:{de:{title:"Infektionskrankheit"},es:{title:"Enfermedades Infecciosas"},fr:{title:"Maladies infectieuses"},it:{title:"Malattie Infettive"},ja:{title:"\u611f\u67d3\u75c7"},pt:{title:"Doen\xe7a Infecciosa"},zh:{title:"\u4f20\u67d3\u75c5"}}},{title:"Nephrology",id:"Nephrology",type:"Category",translations:{de:{title:"Nephrologie"},es:{title:"Nefrolog\xeda"},fr:{title:"N\xe9phrologie"},it:{title:"Nefrologia"},ja:{title:"\u814e\u5b66"},pt:{title:"Nefrologia"},zh:{title:"\u80be\u810f\u75c5\u5b66"}}},{title:"Neurology & Psychiatry",id:"Neurology and Psychiatry",type:"Category",translations:{de:{title:"Neurologie & Psychiatrie"},es:{title:"Neurolog\xeda y Psiquiatr\xeda"},fr:{title:"Neurologie & Psychiatrie"},it:{title:"Neurologia & Psichiatria"},ja:{title:"\u795e\u7d4c\u5185\u79d1\u30fb\u7cbe\u795e\u79d1"},pt:{title:"Neurologia e Psiquiatria"},zh:{title:"\u795e\u7ecf\u5b66\u548c\u7cbe\u795e\u75c5\u5b66"}}},{title:"Obstetrics & Gynecology",id:"Obstetrics and Gynecology",type:"Category",translations:{de:{title:"Geburtshilfe & Gyn\xe4kologie"},es:{title:"Obstetricia y Ginecolog\xeda"},fr:{title:"Obst\xe9trique et gyn\xe9cologie"},it:{title:"Ostetricia & Ginecologia"},ja:{title:"\u7523\u5a66\u4eba\u79d1"},pt:{title:"Obstetr\xedcia e Ginecologia"},zh:{title:"\u5987\u4ea7\u79d1"}}},{title:"Hematology & Oncology",id:"Oncology and Hematology",type:"Category",translations:{de:{title:"H\xe4matologie/Onkologie"},es:{title:"Hematolog\xeda/Oncolog\xeda"},fr:{title:"H\xe9matologie/Oncologie"},it:{title:"Ematologia/Oncologia"},ja:{title:"\u8840\u6db2\u5b66\u30fb\u816b\u760d\u5b66"},pt:{title:"Hematologia/Oncologia"},zh:{title:"\u8840\u6db2\u5b66/\u80bf\u7624\u5b66"}}},{title:"Ophthalmology",id:"Ophthalmology",type:"Category",translations:{de:{title:"Ophthalmologie"},es:{title:"Oftalmolog\xeda"},fr:{title:"Ophtalmologie"},it:{title:"Oftalmologia"},ja:{title:"\u773c\u79d1\u304b"},pt:{title:"Oftalmologia"},zh:{title:"\u773c\u79d1"}}},{title:"Orthopedics",id:"Orthopedics",type:"Category",translations:{de:{title:"Orthop\xe4die"},es:{title:"Ortopedia"},fr:{title:"Orthop\xe9die"},it:{title:"Ortopedia"},ja:{title:"\u6574\u5f62\u5916\u79d1"},pt:{title:"Ortopedia"},zh:{title:"\u6574\u5f62\u5916\u79d1"}}},{title:"Otolaryngology",id:"Otolaryngology",type:"Category",translations:{de:{title:"HNO-Heilkunde"},es:{title:"Otorrinolaringolog\xeda"},fr:{title:"Otorhinolaryngologie"},it:{title:"Otorinolaringoiatria"},ja:{title:"\u8033\u9f3b\u54bd\u5589\u79d1"},pt:{title:"Otorrinolaringologia"},zh:{title:"\u8033\u9f3b\u5589\u79d1"}}},{title:"Pediatrics",id:"Pediatrics",type:"Category",translations:{de:{title:"P\xe4diatrie"},es:{title:"Pediatr\xeda"},fr:{title:"P\xe9diatrie"},it:{title:"Pediatria"},ja:{title:"\u5c0f\u5150\u79d1"},pt:{title:"Pediatria"},zh:{title:"\u513f\u79d1"}}},{title:"Pulmonology",id:"Pulmonology and Respiratory",type:"Category",translations:{de:{title:"Pulmonologie"},es:{title:"Neumolog\xeda"},fr:{title:"Pneumologie"},it:{title:"Pneumologia"},ja:{title:"\u80ba"},pt:{title:"Pneumologia"},zh:{title:"\u547c\u5438\u5b66"}}},{title:"Rheumatology",id:"Rheumatology",type:"Category",translations:{de:{title:"Rheumatologie"},es:{title:"Reumatolog\xeda"},fr:{title:"Rhumatologie"},it:{title:"Reumatologia"},ja:{title:"\u30ea\u30a6\u30de\u30c1\u79d1"},pt:{title:"Reumatologia"},zh:{title:"\u98ce\u6e7f\u75c5\u5b66"}}},{title:"Urology",id:"Urology",type:"Category",translations:{de:{title:"Urologie"},es:{title:"Urolog\xeda"},fr:{title:"Urologie"},it:{title:"Urologia"},ja:{title:"\u6ccc\u5c3f\u5668\u79d1\u304b"},pt:{title:"Urologia"},zh:{title:"\u6ccc\u5c3f\u5916\u79d1"}}},{title:"Community Bookmarks",id:"public",type:"Community",translations:{de:{title:"Community-Lesezeichen"},es:{title:"Marcadores de la comunidad"},fr:{title:"Signets communautaires"},it:{title:"Segnalibri della community"},ja:{title:"\u30b3\u30df\u30e5\u30cb\u30c6\u30a3\u306e\u30d6\u30c3\u30af\u30de\u30fc\u30af"},pt:{title:"Favoritos da comunidade"},zh:{title:"\u793e\u533a\u4e66\u7b7e"}}}]},vk=["live"],mk=((ek=function(){function e(t){m(this,e),this.http=t}return v(e,[{key:"search",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"en",o=t.split(/[ ]+/).join("+"),a=vk.concat(n).filter((function(e){return""!==e&&null!=e})).map((function(e){return'"'.concat(e,'"')})).join("+");return this.http.get("/search?k=".concat(o,"&t=").concat(a,"&ol=").concat(i,"&odns=true")).pipe(Object(K.a)((function(t){return e.resultsToBookmarks(t)})))}},{key:"searchInternal",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return this.http.get("/ws/search/internal?k=".concat(t,"&dir=").concat(n)).pipe(Object(K.a)((function(t){return e.resultsToBookmarks(t)})))}},{key:"getAnatomyCategory",value:function(e,t,n,i){return this.search(e,[t].concat(s(n)),i)}},{key:"getConditionModel",value:function(e){var t=this,n=this.toDatabaseContentId(e);return this.http.get("/search/conditions?q="+n).pipe(Object(K.a)((function(e){return t.resultsToBookmarks(e)})),Object(K.a)((function(e){return e[0]})))}},{key:"resultsToBookmarks",value:function(e){var t=this;return e.forEach((function(e){e.id=t.toAppContentId(e.id),e.tour=e.tags.indexOf("tour")>=0})),Object(Y.plainToClass)(pk,e)}},{key:"getBookmarkCategory",value:function(e){if(!e.tags)return null;var t=bk.categories.map((function(e){return e.id.toLocaleLowerCase()}));return e.tags.find((function(e){return t.includes(e.toLocaleLowerCase())}))}},{key:"getStoryCategory",value:function(e){if(!e.tags)return null;var t=[].concat(s(bk.main),s(bk.categories),s(bk.specialties)).map((function(e){return e.id.toLocaleLowerCase()}));return e.tags.find((function(e){return t.includes(e.toLocaleLowerCase())}))}},{key:"toAppContentId",value:function(e){return e.replace("Condition.content.","").replace(".json","").split(".").join("/")}},{key:"toDatabaseContentId",value:function(e){return e.match("Condition.content")?e:"Condition.content.".concat(e.replace(".json","").split("/").join("."),".json")}}]),e}()).\u0275fac=function(e){return new(e||ek)(_.Zb(W.b))},ek.\u0275prov=_.Lb({token:ek,factory:ek.\u0275fac,providedIn:"root"}),ek),yk=function(e){return e.UserGeneratedTour="user_generated_tour",e.Animated="animated",e.Quiz="quiz",e}({}),xk={headers:new W.d({"Content-Type":"application/json; charset=utf-8"})},wk=function(e){return e.Private="private",e.Group="enterprise",e.Public="public",e}({}),kk=((tk=function(){function e(t,n,i,o,a){m(this,e),this.store=t,this.http=n,this.serializeModuleService=i,this.exploreService=o,this.storyService=a}return v(e,[{key:"getBookmarkData",value:function(e){return this.http.get("/search/bookmarks/data?be="+e).pipe(Object(ck.a)(2),Object(K.a)((function(e){return(e=e.bookmark).moduleId=e.customData?e.customData.moduleId:e.modules.activeModules[0],Object(Y.plainToClass)(fk,e)})))}},{key:"getBookmarkModel",value:function(e){var t=this;return this.http.get("/ws/search/bookmarks?eid="+e).pipe(Object(ck.a)(2),Object(K.a)((function(e){return Object(Y.plainToClass)(pk,e.bookmark_info)})),Object(K.a)((function(e){return t.normalizeBookmarkModel(e)})))}},{key:"getUserBookmarks",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return this.http.get("/ws/search/bookmarks/".concat(e,"?q=").concat(n)).pipe(Object(ck.a)(2),Object(K.a)((function(e){return e.map((function(e){return Object(Y.plainToClass)(pk,e)})).map((function(e){return t.normalizeBookmarkModel(e)}))})))}},{key:"getUserConditions",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=arguments.length>2?arguments[2]:void 0,o="";switch(e){case wk.Private:o="user";break;case wk.Group:o="group"}return this.http.get("/ws/search/conditions/private?q="+n).pipe(Object(K.a)((function(e){return e.filter((function(e){return e.module_accessor_level===o&&(!i||e.module_accessor_id===i)}))})),Object(K.a)((function(e){return Object(Y.plainToClass)(pk,e)})),Object(K.a)((function(e){return e.map((function(e){return t.normalizeBookmarkModel(e)}))})))}},{key:"getPrivateBookmarks",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this.getUserBookmarks(wk.Private,e).pipe(Object(K.a)((function(e){return e.filter((function(e){return e.is_owner}))})))}},{key:"getFavorites",value:function(){var e=this;return this.http.get("/ws/user/favorite").pipe(Object(K.a)((function(t){return Object.values(t).map((function(e){return Object(Y.plainToClass)(pk,e)})).map((function(t){return e.normalizeBookmarkModel(t)}))})))}},{key:"deleteFavorite",value:function(e,t){return this.http.delete("/ws/user/favorite?modelId=".concat(e,"&category=").concat(t))}},{key:"getPrivateConditions",value:function(){return this.getUserConditions(wk.Private)}},{key:"getOrganizationBookmarks",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return this.getUserBookmarks(wk.Private,t).pipe(Object(K.a)((function(t){return t.filter((function(e){return e.tags.includes("enterprise")})).filter((function(t){return t.group_access.some((function(t){return t.group_id===e}))}))})))}},{key:"getOrganizationConditions",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return this.getUserConditions(wk.Group,t,e)}},{key:"getOrganizationContent",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return Object(Br.a)(this.getOrganizationBookmarks(e,t),this.getOrganizationConditions(e,t)).pipe(Object(K.a)((function(e){var t=u(e,2),n=t[0],i=t[1];return[].concat(s(n),s(i))})))}},{key:"createBookmarkStory",value:function(e){return this.serializeModuleService.serialize({},new Ic,!1,this.store.selectSnapshot(Rc.getStory),this.store.selectSnapshot(Ua.getStoryChapters),e)}},{key:"getPublicBookmarks",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this.getUserBookmarks(wk.Public,e)}},{key:"saveBookmark",value:function(e){var t=this,n=this.getNormalizedBookmarkEntry(e);return this.http.post(e.id?"/ws/user/bookmark/v1/update":"/ws/user/bookmark/v1/save",n,xk).pipe(Object(oa.a)((function(e){return t.getBookmarkModel(e.id)})))}},{key:"deleteBookmark",value:function(e){return this.http.delete("/ws/user/bookmark/v1/delete?eid="+e).pipe(Object(G.a)((function(e){var t=e.error.error,n=t?t.message:"";return Object(Na.a)(n)})))}},{key:"copyBookmark",value:function(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"en";return t!==P.Module||Object(Oe.endsWith)(e,".json")||(e+=".json"),this.http.post("/ws/user/bookmark/v1/copy",{source_content_type:t,source_content_id:e}).pipe(Object(K.a)((function(e){return e.id})),Object(oa.a)((function(o){return"en"===i?Object($.a)(o):n.translateBookmark(o,e,t,i)})))}},{key:"atMaxFreeBookmarkCount",value:function(){return this.http.get("/ws/user/content/limit/check").pipe(Object(K.a)((function(){return!1})),Object(G.a)((function(e){return Object($.a)(403===e.status)})))}},{key:"saveBookmarkThumbnails",value:function(e,t,n,i){var o=this,a=t.index.chapters.reduce((function(t,a){var r=n.get(i[a.id]),c=Object(Oe.get)(r,"snapshot");if(c)t.push(o.postThumbnail(e,a.id,c,!0));else if(a.id!==i[a.id]||r.chapterId!==a.id){var s=Object(Oe.get)(r,"urls.large");if(s){var l=s.match(/(bookmarks\/)|(modules\/)/).index,p=s.slice(l);t.push(o.copyThumbnail(e,a.id,p))}}return t}),[]),r=n.get(i[t.index.chapters[0].id]),c=Object(Oe.get)(r,"snapshot");if(c)a.push(this.postThumbnail(e,null,c,!0));else{var s=Object(Oe.get)(r,"urls.large");s&&a.push(this.copyThumbnail(e,null,s))}return a}},{key:"deleteBookmarkThumbnails",value:function(e,t,n,i){var o=this,a=t.index.chapters.map((function(e){return i[e.id]||e.id}));return Array.from(n.values()).filter((function(e){return a.indexOf(e.chapterId)<0})).map((function(t){return o.deleteThumbnail(e,t.chapterId)}))}},{key:"filterByTags",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return e.filter((function(e){return n?t.every((function(t){return e.tags.includes(t)})):t.some((function(t){return e.tags.includes(t)}))}))}},{key:"canEdit",value:function(e){return e.type===P.Module||!!e.is_owner||!(!e.group_access||!e.group_access.length)&&e.group_access[0].member_edit}},{key:"normalizeBookmarkModel",value:function(e){var t=e.id;return"module"===e.type&&(e.id=this.exploreService.toAppContentId(t)),e.tour=e.tags.includes("tour"),e.animated=e.tags.includes("animated"),e}},{key:"getIndexThumbnail",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"large";return"/thumbs/bookmarks/".concat(e,"/").concat(t,"/index.jpg")}},{key:"translateBookmark",value:function(e,t,n,i){var o=this,a=n===P.Module||n===P.Internal?t.replace(".json",""):t;return Object(Br.a)(this.storyService.getStory(e,P.Bookmark),this.storyService.getStoryTranslation(a,n,i)).pipe(Object(K.a)((function(e){var t=u(e,2),n=t[0],i=t[1];return o.storyService.translateStory(n,i)})),Object(oa.a)((function(t){return o.saveBookmark({isOwner:!0,title:t.displayName.substr(0,60),id:e,index:t})})),Object(K.a)((function(e){return e.id})),Object(G.a)((function(t){return 404===t.status?Object($.a)(e):Object(Na.a)(t)})))}},{key:"getNormalizedBookmarkEntry",value:function(e){var t,n,i,o=this,a=e.id,r=e.title,c=e.description,s=e.index,l=e.public_access,p=e.add_group_access,u=e.remove_group_access;if(e.isOwner&&(t=p?this.getGroupAccess(p):[],u&&u.forEach((function(e){var n=o.getNormalizeGroupAccess({group_id:e.group_id,remove:!0});t.push(n)})),n=this.getNormalizedBool(l),s)){i={},s.chapters&&(i[yk.UserGeneratedTour]=this.getNormalizedBool(s.chapters.length>1));var d=(s.tags||[]).includes("animated");i[yk.Animated]=this.getNormalizedBool(d);var g=Object(Oe.get)(s,"quizSettings.enabled",!1);i[yk.Quiz]=this.getNormalizedBool(g)}return{eid:a,name:r,description:c,index:s,group_access:t,public_access:n,flags:i}}},{key:"getGroupAccess",value:function(e){var t=this;return e.map((function(e){return t.getNormalizeGroupAccess(e)}))}},{key:"getNormalizeGroupAccess",value:function(e){var t=e.group_id,n=e.group_name,i=e.member_edit,o=e.visible,a=e.remove;return{group_id:t,group_name:n,member_edit:this.getNormalizedBool(i),visibility:this.getNormalizedBool(o),remove:this.getNormalizedBool(a)}}},{key:"getNormalizedBool",value:function(e){return!0===e?"1":!1===e?"0":""}},{key:"postThumbnail",value:function(e,t,n){var i=this,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=new Image;return a.src=n,new he.a((function(n){a.onload=function(){var r=document.createElement("canvas"),c=r.getContext("2d");r.width=a.naturalWidth,r.height=a.naturalHeight,c.drawImage(a,0,0);var s,l=r.toDataURL("image/jpeg",1);s=t?"/ws/thumbs/bookmarks/".concat(e,"/large/chapters/").concat(t,".jpg"):"/ws/thumbs/bookmarks/".concat(e,"/large/index.jpg");var p=(new W.d).set("Content-Type","application/json");i.http.post(s,{image:l,invalidate:o},{headers:p,responseType:"text"}).subscribe((function(e){n.next(),n.complete()}))}}))}},{key:"deleteThumbnail",value:function(e,t){return new he.a((function(n){var i=new Request("/ws/thumbs/bookmarks/".concat(e,"/large/chapters/").concat(t,".jpg"),{method:"DELETE"});fetch(i).then((function(e){n.complete()}))}))}},{key:"copyThumbnail",value:function(e,t,n){var i,o=this,a=n.replace("/thumbs/","");i=t?"bookmarks/".concat(e,"/large/chapters/").concat(t,".jpg"):"bookmarks/".concat(e,"/large/index.jpg");var r=(new W.d).set("Content-Type","application/json");return new he.a((function(e){o.http.post("/ws/thumbs/copy",{src:a,dst:i},{headers:r,responseType:"text"}).subscribe((function(t){e.next(),e.complete()}))}))}}]),e}()).\u0275fac=function(e){return new(e||tk)(_.Zb(L.g),_.Zb(W.b),_.Zb(Mc),_.Zb(mk),_.Zb(tc))},tk.\u0275prov=_.Lb({token:tk,factory:tk.\u0275fac,providedIn:"root"}),tk),Ok="/ws/thumbs",Ck={headers:(new W.d).set("Content-Type","application/json"),responseType:"text"},Sk=((ok=function(){function e(t){m(this,e),this.http=t}return v(e,[{key:"getStoryIndexThumbnail",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"large";return"".concat("undefined"==typeof localBaseDirectory?"":localBaseDirectory,"thumbs/modules/").concat(e,"/").concat(t,"/index.jpg")}},{key:"saveStoryThumbnails",value:function(e){var t=this,n=e.storyId,i=e.storyType,o=e.thumbnails,a=e.chapterIdMap,r=e.indexId,c=e.deleteUnused,s=void 0!==c&&c,l=[],p={};return Object.entries(a).forEach((function(e){var a=u(e,2),c=a[0],s=a[1],d=o.get(s);p[s]=!0;var g=t.createThumbnailPath(i,n,c);if(Object(Oe.get)(d,"snapshot")){if(l.push(t.postThumbnail(d.snapshot,g)),c===r){var h=t.createThumbnailPath(i,n);l.push(t.postThumbnail(d.snapshot,h))}}else{var f=Object(Oe.get)(d,"urls.large");if(f){var b=f.split("/thumbs/")[1];if(l.push(t.copyThumbnail(b,g)),c===r){var v=t.createThumbnailPath(i,n);l.push(t.copyThumbnail(b,v))}}}})),s&&Object.keys(o).filter((function(e){return!(e in p)})).forEach((function(e){var n=o.get(e).urls.large.split("/thumbs/")[1];l.push(t.deleteThumbnail(n))})),l}},{key:"createThumbnailPath",value:function(e,t,n){var i=(t=t.replace(".json",""))+"/large";return n?i="".concat(i,"/chapters/").concat(n,".jpg"):i+="/index.jpg",[e===P.Bookmark?"bookmarks":"modules",i].join("/")}},{key:"postThumbnail",value:function(e,t){var n=this,i=ma.medium,o=i.width,a=i.height,r=new Image,c=document.createElement("canvas");c.width=o,c.height=a;var s=c.getContext("2d");return r.src=e,new he.a((function(e){r.onerror=function(){e.next(),e.complete()},r.onload=function(){s.drawImage(r,0,0);var i=c.toDataURL("image/jpeg",1),o=[Ok,t].join("/");n.http.post(o,{image:i},Ck).subscribe((function(){e.next(),e.complete()}))}}))}},{key:"deleteThumbnail",value:function(e){var t=[Ok,e].join("/");return new he.a((function(e){var n=new Request(t,{method:"DELETE"});fetch(n).finally((function(){e.next(),e.complete()}))}))}},{key:"copyThumbnail",value:function(e,t){var n=this;return new he.a((function(i){n.http.post("/ws/thumbs/copy",{src:e,dst:t},Ck).subscribe((function(e){i.next(),i.complete()}))}))}}]),e}()).\u0275fac=function(e){return new(e||ok)(_.Zb(W.b))},ok.\u0275prov=_.Lb({token:ok,factory:ok.\u0275fac,providedIn:"root"}),ok),_k=((ik=function(){function e(){m(this,e)}return v(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||ik)},ik.\u0275cmp=_.Jb({type:ik,selectors:[["app-button-loader"]],decls:5,vars:0,consts:[["tabindex","0","type","button","aria-label","Interact in 3D","type","button",1,"button-loader"],[1,"button-loader__button"],["src","assets/images/widget/loading_experience/interact-in-3d-arrow.svg","alt","Interact in 3D",1,"button-loader__3d-arrow"],[1,"button-loader__label"]],template:function(e,t){1&e&&(_.Vb(0,"button",0),_.Vb(1,"div",1),_.Qb(2,"img",2),_.Vb(3,"div",3),_.Mc(4,"Interact in 3D"),_.Ub(),_.Ub(),_.Ub())},styles:[".m-1[_ngcontent-%COMP%]{margin:4px!important}.mv-1[_ngcontent-%COMP%]{margin-top:4px!important;margin-bottom:4px!important}.mh-1[_ngcontent-%COMP%]{margin-left:4px!important;margin-right:4px!important}.mt-1[_ngcontent-%COMP%]{margin-top:4px!important}.mr-1[_ngcontent-%COMP%]{margin-right:4px!important}.mb-1[_ngcontent-%COMP%]{margin-bottom:4px!important}.ml-1[_ngcontent-%COMP%]{margin-left:4px!important}.p-1[_ngcontent-%COMP%]{padding:4px!important}.pv-1[_ngcontent-%COMP%]{padding-top:4px!important;padding-bottom:4px!important}.ph-1[_ngcontent-%COMP%]{padding-left:4px!important;padding-right:4px!important}.pt-1[_ngcontent-%COMP%]{padding-top:4px!important}.pr-1[_ngcontent-%COMP%]{padding-right:4px!important}.pb-1[_ngcontent-%COMP%]{padding-bottom:4px!important}.pl-1[_ngcontent-%COMP%]{padding-left:4px!important}.m-2[_ngcontent-%COMP%]{margin:8px!important}.mv-2[_ngcontent-%COMP%]{margin-top:8px!important;margin-bottom:8px!important}.mh-2[_ngcontent-%COMP%]{margin-left:8px!important;margin-right:8px!important}.mt-2[_ngcontent-%COMP%]{margin-top:8px!important}.mr-2[_ngcontent-%COMP%]{margin-right:8px!important}.mb-2[_ngcontent-%COMP%]{margin-bottom:8px!important}.ml-2[_ngcontent-%COMP%]{margin-left:8px!important}.p-2[_ngcontent-%COMP%]{padding:8px!important}.pv-2[_ngcontent-%COMP%]{padding-top:8px!important;padding-bottom:8px!important}.ph-2[_ngcontent-%COMP%]{padding-left:8px!important;padding-right:8px!important}.pt-2[_ngcontent-%COMP%]{padding-top:8px!important}.pr-2[_ngcontent-%COMP%]{padding-right:8px!important}.pb-2[_ngcontent-%COMP%]{padding-bottom:8px!important}.pl-2[_ngcontent-%COMP%]{padding-left:8px!important}.m-3[_ngcontent-%COMP%]{margin:12px!important}.mv-3[_ngcontent-%COMP%]{margin-top:12px!important;margin-bottom:12px!important}.mh-3[_ngcontent-%COMP%]{margin-left:12px!important;margin-right:12px!important}.mt-3[_ngcontent-%COMP%]{margin-top:12px!important}.mr-3[_ngcontent-%COMP%]{margin-right:12px!important}.mb-3[_ngcontent-%COMP%]{margin-bottom:12px!important}.ml-3[_ngcontent-%COMP%]{margin-left:12px!important}.p-3[_ngcontent-%COMP%]{padding:12px!important}.pv-3[_ngcontent-%COMP%]{padding-top:12px!important;padding-bottom:12px!important}.ph-3[_ngcontent-%COMP%]{padding-left:12px!important;padding-right:12px!important}.pt-3[_ngcontent-%COMP%]{padding-top:12px!important}.pr-3[_ngcontent-%COMP%]{padding-right:12px!important}.pb-3[_ngcontent-%COMP%]{padding-bottom:12px!important}.pl-3[_ngcontent-%COMP%]{padding-left:12px!important}.m-4[_ngcontent-%COMP%]{margin:16px!important}.mv-4[_ngcontent-%COMP%]{margin-top:16px!important;margin-bottom:16px!important}.mh-4[_ngcontent-%COMP%]{margin-left:16px!important;margin-right:16px!important}.mt-4[_ngcontent-%COMP%]{margin-top:16px!important}.mr-4[_ngcontent-%COMP%]{margin-right:16px!important}.mb-4[_ngcontent-%COMP%]{margin-bottom:16px!important}.ml-4[_ngcontent-%COMP%]{margin-left:16px!important}.p-4[_ngcontent-%COMP%]{padding:16px!important}.pv-4[_ngcontent-%COMP%]{padding-top:16px!important;padding-bottom:16px!important}.ph-4[_ngcontent-%COMP%]{padding-left:16px!important;padding-right:16px!important}.pt-4[_ngcontent-%COMP%]{padding-top:16px!important}.pr-4[_ngcontent-%COMP%]{padding-right:16px!important}.pb-4[_ngcontent-%COMP%]{padding-bottom:16px!important}.pl-4[_ngcontent-%COMP%]{padding-left:16px!important}.m-5[_ngcontent-%COMP%]{margin:20px!important}.mv-5[_ngcontent-%COMP%]{margin-top:20px!important;margin-bottom:20px!important}.mh-5[_ngcontent-%COMP%]{margin-left:20px!important;margin-right:20px!important}.mt-5[_ngcontent-%COMP%]{margin-top:20px!important}.mr-5[_ngcontent-%COMP%]{margin-right:20px!important}.mb-5[_ngcontent-%COMP%]{margin-bottom:20px!important}.ml-5[_ngcontent-%COMP%]{margin-left:20px!important}.p-5[_ngcontent-%COMP%]{padding:20px!important}.pv-5[_ngcontent-%COMP%]{padding-top:20px!important;padding-bottom:20px!important}.ph-5[_ngcontent-%COMP%]{padding-left:20px!important;padding-right:20px!important}.pt-5[_ngcontent-%COMP%]{padding-top:20px!important}.pr-5[_ngcontent-%COMP%]{padding-right:20px!important}.pb-5[_ngcontent-%COMP%]{padding-bottom:20px!important}.pl-5[_ngcontent-%COMP%]{padding-left:20px!important}.m-6[_ngcontent-%COMP%]{margin:24px!important}.mv-6[_ngcontent-%COMP%]{margin-top:24px!important;margin-bottom:24px!important}.mh-6[_ngcontent-%COMP%]{margin-left:24px!important;margin-right:24px!important}.mt-6[_ngcontent-%COMP%]{margin-top:24px!important}.mr-6[_ngcontent-%COMP%]{margin-right:24px!important}.mb-6[_ngcontent-%COMP%]{margin-bottom:24px!important}.ml-6[_ngcontent-%COMP%]{margin-left:24px!important}.p-6[_ngcontent-%COMP%]{padding:24px!important}.pv-6[_ngcontent-%COMP%]{padding-top:24px!important;padding-bottom:24px!important}.ph-6[_ngcontent-%COMP%]{padding-left:24px!important;padding-right:24px!important}.pt-6[_ngcontent-%COMP%]{padding-top:24px!important}.pr-6[_ngcontent-%COMP%]{padding-right:24px!important}.pb-6[_ngcontent-%COMP%]{padding-bottom:24px!important}.pl-6[_ngcontent-%COMP%]{padding-left:24px!important}.m-7[_ngcontent-%COMP%]{margin:28px!important}.mv-7[_ngcontent-%COMP%]{margin-top:28px!important;margin-bottom:28px!important}.mh-7[_ngcontent-%COMP%]{margin-left:28px!important;margin-right:28px!important}.mt-7[_ngcontent-%COMP%]{margin-top:28px!important}.mr-7[_ngcontent-%COMP%]{margin-right:28px!important}.mb-7[_ngcontent-%COMP%]{margin-bottom:28px!important}.ml-7[_ngcontent-%COMP%]{margin-left:28px!important}.p-7[_ngcontent-%COMP%]{padding:28px!important}.pv-7[_ngcontent-%COMP%]{padding-top:28px!important;padding-bottom:28px!important}.ph-7[_ngcontent-%COMP%]{padding-left:28px!important;padding-right:28px!important}.pt-7[_ngcontent-%COMP%]{padding-top:28px!important}.pr-7[_ngcontent-%COMP%]{padding-right:28px!important}.pb-7[_ngcontent-%COMP%]{padding-bottom:28px!important}.pl-7[_ngcontent-%COMP%]{padding-left:28px!important}.m-8[_ngcontent-%COMP%]{margin:32px!important}.mv-8[_ngcontent-%COMP%]{margin-top:32px!important;margin-bottom:32px!important}.mh-8[_ngcontent-%COMP%]{margin-left:32px!important;margin-right:32px!important}.mt-8[_ngcontent-%COMP%]{margin-top:32px!important}.mr-8[_ngcontent-%COMP%]{margin-right:32px!important}.mb-8[_ngcontent-%COMP%]{margin-bottom:32px!important}.ml-8[_ngcontent-%COMP%]{margin-left:32px!important}.p-8[_ngcontent-%COMP%]{padding:32px!important}.pv-8[_ngcontent-%COMP%]{padding-top:32px!important;padding-bottom:32px!important}.ph-8[_ngcontent-%COMP%]{padding-left:32px!important;padding-right:32px!important}.pt-8[_ngcontent-%COMP%]{padding-top:32px!important}.pr-8[_ngcontent-%COMP%]{padding-right:32px!important}.pb-8[_ngcontent-%COMP%]{padding-bottom:32px!important}.pl-8[_ngcontent-%COMP%]{padding-left:32px!important}.m-9[_ngcontent-%COMP%]{margin:36px!important}.mv-9[_ngcontent-%COMP%]{margin-top:36px!important;margin-bottom:36px!important}.mh-9[_ngcontent-%COMP%]{margin-left:36px!important;margin-right:36px!important}.mt-9[_ngcontent-%COMP%]{margin-top:36px!important}.mr-9[_ngcontent-%COMP%]{margin-right:36px!important}.mb-9[_ngcontent-%COMP%]{margin-bottom:36px!important}.ml-9[_ngcontent-%COMP%]{margin-left:36px!important}.p-9[_ngcontent-%COMP%]{padding:36px!important}.pv-9[_ngcontent-%COMP%]{padding-top:36px!important;padding-bottom:36px!important}.ph-9[_ngcontent-%COMP%]{padding-left:36px!important;padding-right:36px!important}.pt-9[_ngcontent-%COMP%]{padding-top:36px!important}.pr-9[_ngcontent-%COMP%]{padding-right:36px!important}.pb-9[_ngcontent-%COMP%]{padding-bottom:36px!important}.pl-9[_ngcontent-%COMP%]{padding-left:36px!important}.m-10[_ngcontent-%COMP%]{margin:40px!important}.mv-10[_ngcontent-%COMP%]{margin-top:40px!important;margin-bottom:40px!important}.mh-10[_ngcontent-%COMP%]{margin-left:40px!important;margin-right:40px!important}.mt-10[_ngcontent-%COMP%]{margin-top:40px!important}.mr-10[_ngcontent-%COMP%]{margin-right:40px!important}.mb-10[_ngcontent-%COMP%]{margin-bottom:40px!important}.ml-10[_ngcontent-%COMP%]{margin-left:40px!important}.p-10[_ngcontent-%COMP%]{padding:40px!important}.pv-10[_ngcontent-%COMP%]{padding-top:40px!important;padding-bottom:40px!important}.ph-10[_ngcontent-%COMP%]{padding-left:40px!important;padding-right:40px!important}.pt-10[_ngcontent-%COMP%]{padding-top:40px!important}.pr-10[_ngcontent-%COMP%]{padding-right:40px!important}.pb-10[_ngcontent-%COMP%]{padding-bottom:40px!important}.pl-10[_ngcontent-%COMP%]{padding-left:40px!important}.text-8[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase[_ngcontent-%COMP%]{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase[_ngcontent-%COMP%]{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase[_ngcontent-%COMP%]{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase[_ngcontent-%COMP%]{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-header[_ngcontent-%COMP%]{font-weight:700}.text--code[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.text-xlight[_ngcontent-%COMP%]{font-weight:200}.text-light[_ngcontent-%COMP%]{font-weight:300}.text-medium[_ngcontent-%COMP%]{font-weight:500}.text-semibold[_ngcontent-%COMP%]{font-weight:600}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-underline[_ngcontent-%COMP%]{text-decoration:underline}.text-italic[_ngcontent-%COMP%]{font-style:italic}.text-bright[_ngcontent-%COMP%]{color:#fff}.text-dim[_ngcontent-%COMP%]{color:#96a8c0}.text-error[_ngcontent-%COMP%]{color:#ed4758}.text-left[_ngcontent-%COMP%]{text-align:left}.text-center[_ngcontent-%COMP%]{text-align:center}.text-right[_ngcontent-%COMP%]{text-align:right}.text-ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link[_ngcontent-%COMP%], .text-link[_ngcontent-%COMP%]:visited{color:inherit;cursor:pointer}.text-link[_ngcontent-%COMP%]:not(.text-underline), .text-link[_ngcontent-%COMP%]:visited:not(.text-underline){text-decoration:none}.text-success[_ngcontent-%COMP%]{color:#38de38}.text-danger[_ngcontent-%COMP%]{color:#de3838}.text-info[_ngcontent-%COMP%]{color:#0060c4}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.text-pre-line[_ngcontent-%COMP%]{white-space:pre-line}.button-loader[_ngcontent-%COMP%]{border:0;width:100%;background:rgba(0,0,0,.2);display:flex;position:fixed;justify-content:center;align-items:center;top:0;bottom:0;left:0;right:0;transition:background-color .25s,opacity .25s;z-index:10000}.button-loader[_ngcontent-%COMP%]:hover{opacity:1;cursor:pointer;background:var(--view-loader-scrim-bg--hover)}@media print{.button-loader[_ngcontent-%COMP%]{display:none}}.button-loader[_ngcontent-%COMP%]:focus   .button-loader__button[_ngcontent-%COMP%], .button-loader[_ngcontent-%COMP%]:hover   .button-loader__button[_ngcontent-%COMP%]{background-color:var(--view-loader-icon-color--hover);transform:scale(1.1)}.button-loader[_ngcontent-%COMP%]:focus   .button-loader__3d-arrow[_ngcontent-%COMP%], .button-loader[_ngcontent-%COMP%]:hover   .button-loader__3d-arrow[_ngcontent-%COMP%]{transform:scale(1.2)}.button-loader__button[_ngcontent-%COMP%]{display:flex;padding:12px 28px;border-radius:32px;align-items:center;transition:transform .25s,background-color .25s;background-color:var(--view-loader-button-bg)}.button-loader__3d-arrow[_ngcontent-%COMP%]{transition:transform .25s;margin-right:4px}.button-loader__label[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em;color:#fff;font-weight:600;margin-left:4px}"],changeDetection:0}),ik),jk=((nk=function(){function e(t,n,i){m(this,e),this.viewService=t,this.modulesThumbnailService=n,this.bookmarksService=i}return v(e,[{key:"ngOnInit",value:function(){}},{key:"handleClick",value:function(){this.viewService.toggleOnDemand(!1)}},{key:"getThumbnailUrl",value:function(){return this.contentType===P.Bookmark?this.bookmarksService.getIndexThumbnail(this.contentId):this.modulesThumbnailService.getStoryIndexThumbnail(this.contentId)}},{key:"getPoweredByUrl",value:function(){return("undefined"==typeof localBaseDirectory?"":localBaseDirectory)+"assets/images/powered-by-biodigital-logo.svg"}}]),e}()).\u0275fac=function(e){return new(e||nk)(_.Pb(Bu),_.Pb(Sk),_.Pb(kk))},nk.\u0275cmp=_.Jb({type:nk,selectors:[["app-view-ondemand"]],inputs:{contentId:"contentId",contentType:"contentType"},decls:5,vars:2,consts:[[1,"ondemand",3,"click"],[1,"ondemand__image",3,"lazyLoad"],[1,"ondemand__logo"],[3,"src"]],template:function(e,t){1&e&&(_.Vb(0,"div",0),_.cc("click",(function(){return t.handleClick()})),_.Qb(1,"div",1),_.Qb(2,"app-button-loader"),_.Vb(3,"div",2),_.Qb(4,"img",3),_.Ub(),_.Ub()),2&e&&(_.Db(1),_.lc("lazyLoad",t.getThumbnailUrl()),_.Db(3),_.lc("src",t.getPoweredByUrl(),_.Cc))},directives:[df.a,_k],styles:[".ondemand__image[_ngcontent-%COMP%]{position:absolute;top:0;bottom:0;left:0;right:0;background-size:cover;background-repeat:no-repeat;background-position:50%}.ondemand__logo[_ngcontent-%COMP%]{position:absolute;bottom:40px;justify-content:center;width:100%;z-index:20000;display:flex}"],changeDetection:0}),nk),Pk=["circle"],Mk=["progressCircle"],Ik=["progressContainer"];function zk(e,t){if(1&e&&(_.fc(),_.ec(),_.Vb(0,"div",9),_.Mc(1),_.Ub()),2&e){var n=_.gc();_.Db(1),_.Oc(" ",n.percent,"% ")}}var Tk,Uk,Lk,Dk,Ek=function(e){return{"view-progress--active":e}},Fk=function(e){return{"view-progress__ring--pulse":e}},Ak=((Tk=function(){function e(t,n){m(this,e),this.renderer=t,this.changeDetectorRef=n,this.ngUnsubscribe=new ge.a,this.label="Loading...",this._show=!1,this._percent=new Wa.a(0)}return v(e,[{key:"show",get:function(){return this._show},set:function(e){var t=this;setTimeout((function(){t._show=e,t.changeDetectorRef.markForCheck()}))}},{key:"percent",get:function(){return Math.floor(this._percent.value)},set:function(e){null!=e&&this._percent.next(e)}},{key:"ngOnInit",value:function(){this.initSizeObserver()}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"ngAfterViewInit",value:function(){this.updateDimensions(),this.initPercentObserver()}},{key:"initPercentObserver",value:function(){var e=this;this._percent.pipe(Object(fe.a)(this.ngUnsubscribe)).subscribe((function(){e.label=e.getLoadingLabel(e.percent),e.renderProgress(0===e.percent?100:e.percent),e.changeDetectorRef.markForCheck()}))}},{key:"initSizeObserver",value:function(){var e=this;Object(Ga.a)(window,"resize").pipe(Object(Za.a)(10),Object(fe.a)(this.ngUnsubscribe)).subscribe((function(){e.updateDimensions()}))}},{key:"calculateRadius",value:function(){return this.getCircleWidth()/2}},{key:"getCircleWidth",value:function(){return this.circleRef.nativeElement.offsetWidth}},{key:"getRadius",value:function(){return this.progressCircleRef.nativeElement.r.baseVal.value}},{key:"getCircumference",value:function(){return 2*this.getRadius()*Math.PI}},{key:"getOffset",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,t=this.getCircumference();return t-e/100*t}},{key:"renderProgress",value:function(e){e>=100&&(e=100);var t=this.getCircumference(),n=this.getOffset(e);this.renderer.setStyle(this.progressCircleRef.nativeElement,"strokeDasharray","".concat(t," ").concat(t)),this.renderer.setStyle(this.progressCircleRef.nativeElement,"strokeDashoffset",""+n)}},{key:"getLoadingLabel",value:function(e){return 100===e?"Launching...":"Loading..."}},{key:"updateDimensions",value:function(){var e=this.calculateRadius();this.renderer.setAttribute(this.progressContainerRef.nativeElement,"width",""+2*e),this.renderer.setAttribute(this.progressContainerRef.nativeElement,"height",""+2*e),this.renderer.setAttribute(this.progressCircleRef.nativeElement,"r",""+(e-6)),this.renderer.setAttribute(this.progressCircleRef.nativeElement,"cx",""+e),this.renderer.setAttribute(this.progressCircleRef.nativeElement,"cy",""+e);var t=this.getCircumference();this.renderer.setStyle(this.progressCircleRef.nativeElement,"strokeDasharray","".concat(t," ").concat(t)),this.renderer.setStyle(this.progressCircleRef.nativeElement,"strokeDashoffset",""+t)}}]),e}()).\u0275fac=function(e){return new(e||Tk)(_.Pb(_.H),_.Pb(_.i))},Tk.\u0275cmp=_.Jb({type:Tk,selectors:[["app-view-progress"]],viewQuery:function(e,t){var n;1&e&&(_.Gc(Pk,!0),_.Gc(Mk,!0),_.Gc(Ik,!0)),2&e&&(_.uc(n=_.dc())&&(t.circleRef=n.first),_.uc(n=_.dc())&&(t.progressCircleRef=n.first),_.uc(n=_.dc())&&(t.progressContainerRef=n.first))},inputs:{show:"show",percent:"percent"},decls:10,vars:9,consts:[["data-test","viewProgress",1,"view-progress",3,"ngClass"],[1,"view-progress__circle"],["circle",""],[1,"view-progress__ring",3,"ngClass"],["progressContainer",""],[1,"view-progress__ring-inner"],["progressCircle",""],["class","view-progress__count",4,"ngIf"],[1,"view-progress__label"],[1,"view-progress__count"]],template:function(e,t){1&e&&(_.Vb(0,"div",0),_.Vb(1,"div",1,2),_.fc(),_.Vb(3,"svg",3,4),_.Qb(5,"circle",5,6),_.Ub(),_.Kc(7,zk,2,1,"div",7),_.ec(),_.Vb(8,"div",8),_.Mc(9),_.Ub(),_.Ub(),_.Ub()),2&e&&(_.lc("ngClass",_.oc(5,Ek,t.show)),_.Db(1),_.lc("@isOpen",t.show?"open":"closed"),_.Db(2),_.lc("ngClass",_.oc(7,Fk,0===t.percent||100===t.percent)),_.Db(4),_.lc("ngIf",t.percent>0&&t.percent<100),_.Db(2),_.Oc(" ",t.label," "))},directives:[or.i,or.l],styles:[".text-8[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase[_ngcontent-%COMP%]{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase[_ngcontent-%COMP%]{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase[_ngcontent-%COMP%]{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase[_ngcontent-%COMP%]{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-header[_ngcontent-%COMP%]{font-weight:700}.text--code[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.text-xlight[_ngcontent-%COMP%]{font-weight:200}.text-light[_ngcontent-%COMP%]{font-weight:300}.text-medium[_ngcontent-%COMP%]{font-weight:500}.text-semibold[_ngcontent-%COMP%]{font-weight:600}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-underline[_ngcontent-%COMP%]{text-decoration:underline}.text-italic[_ngcontent-%COMP%]{font-style:italic}.text-bright[_ngcontent-%COMP%]{color:#fff}.text-dim[_ngcontent-%COMP%]{color:#96a8c0}.text-error[_ngcontent-%COMP%]{color:#ed4758}.text-left[_ngcontent-%COMP%]{text-align:left}.text-center[_ngcontent-%COMP%]{text-align:center}.text-right[_ngcontent-%COMP%]{text-align:right}.text-ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link[_ngcontent-%COMP%], .text-link[_ngcontent-%COMP%]:visited{color:inherit;cursor:pointer}.text-link[_ngcontent-%COMP%]:not(.text-underline), .text-link[_ngcontent-%COMP%]:visited:not(.text-underline){text-decoration:none}.text-success[_ngcontent-%COMP%]{color:#38de38}.text-danger[_ngcontent-%COMP%]{color:#de3838}.text-info[_ngcontent-%COMP%]{color:#0060c4}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.text-pre-line[_ngcontent-%COMP%]{white-space:pre-line}.view-progress[_ngcontent-%COMP%]{--circleSize:35vw;pointer-events:none;position:absolute;display:flex;justify-content:center;align-items:center;left:0;right:0;top:0;bottom:0;z-index:1000;transition:background-color .15s}@-webkit-keyframes progressPulse{0%{stroke-width:4}50%{stroke-width:1}to{stroke-width:4}}@keyframes progressPulse{0%{stroke-width:4}50%{stroke-width:1}to{stroke-width:4}}.view-progress--active[_ngcontent-%COMP%]{background-color:rgba(0,0,0,.2)}.view-progress__circle[_ngcontent-%COMP%]{transform:scale(0);width:var(--circleSize);height:var(--circleSize);border-radius:50%;background-color:var(--view-progress-bg);display:flex;flex-direction:column;align-items:center;justify-content:center;position:relative}.view-progress__count[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em;color:var(--view-progress-primary-color);font-weight:700}.view-progress__label[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em;color:var(--view-progress-secondary-color)}.view-progress__ring[_ngcontent-%COMP%]{position:absolute;top:0;right:0;bottom:0;left:0;z-index:3;opacity:1;stroke-dashoffset:0;stroke-width:4;stroke:var(--view-progress-secondary-color);fill:transparent;transform:rotate(-90deg)}.view-progress__ring--pulse[_ngcontent-%COMP%]{-webkit-animation:progressPulse 2s ease-in-out infinite;animation:progressPulse 2s ease-in-out infinite}@media (min-width:600px){.view-progress__circle[_ngcontent-%COMP%]{width:160px;height:160px}}"],data:{animation:[Object(fp.n)("isOpen",[Object(fp.k)("open",Object(fp.l)({transform:"scale(1)"})),Object(fp.k)("closed",Object(fp.l)({transform:"scale(0)"})),Object(fp.m)("closed => open",[Object(fp.e)("300ms ease-out")]),Object(fp.m)("open => closed",[Object(fp.e)("150ms ease-in")])])]},changeDetection:0}),Tk),Rk=["viewLoader"],Nk=["*"],Vk=((Uk=function(){function e(t,n,i){m(this,e),this.renderer=t,this.viewService=n,this.actions=i,this.ngUnsubscribe=new ge.a}return v(e,[{key:"handleClick",value:function(){var e=this;this.renderer.addClass(this.viewLoaderRef.nativeElement,"view-loader--disappear"),setTimeout((function(){e.viewService.toggleInteract(!1)}),250)}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}}]),e}()).\u0275fac=function(e){return new(e||Uk)(_.Pb(_.H),_.Pb(Bu),_.Pb(L.b))},Uk.\u0275cmp=_.Jb({type:Uk,selectors:[["app-view-loader"]],viewQuery:function(e,t){var n;1&e&&_.Gc(Rk,!0),2&e&&_.uc(n=_.dc())&&(t.viewLoaderRef=n.first)},ngContentSelectors:Nk,decls:4,vars:0,consts:[["role","dialog",1,"view-loader"],["viewLoader",""],["role","button",3,"click"]],template:function(e,t){1&e&&(_.kc(),_.Vb(0,"div",0,1),_.Vb(2,"div",2),_.cc("click",(function(){return t.handleClick()})),_.jc(3),_.Ub(),_.Ub())},styles:[""],encapsulation:2,changeDetection:0}),Uk),Hk=["circle"],Bk=["progressCircle"],Qk=["progressContainer"],qk=((Dk=function(){function e(t){m(this,e),this.renderer=t,this.ngUnsubscribe=new ge.a,this._percent=0}return v(e,[{key:"percent",get:function(){return this._percent},set:function(e){null!=e&&(this._percent=e,this.setProgress(this.percent))}},{key:"ngOnInit",value:function(){this.initSizeObserver()}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"ngAfterViewInit",value:function(){this.updateDimensions()}},{key:"initSizeObserver",value:function(){var e=this;Object(Ga.a)(window,"resize").pipe(Object(Za.a)(10),Object(fe.a)(this.ngUnsubscribe)).subscribe((function(){e.updateDimensions()}))}},{key:"calculateRadius",value:function(){return this.getCircleWidth()/2}},{key:"getCircleWidth",value:function(){return this.circleRef.nativeElement.offsetWidth}},{key:"getRadius",value:function(){return this.progressCircleRef.nativeElement.r.baseVal.value}},{key:"getCircumference",value:function(){return 2*this.getRadius()*Math.PI}},{key:"getOffset",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,t=this.getCircumference();return t-e/100*t}},{key:"setProgress",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;e>=100&&(e=100);var t=this.getCircumference(),n=this.getOffset(e);this.renderer.setStyle(this.progressCircleRef.nativeElement,"strokeDasharray","".concat(t," ").concat(t)),this.renderer.setStyle(this.progressCircleRef.nativeElement,"strokeDashoffset",""+n)}},{key:"updateDimensions",value:function(){var e=this,t=this.calculateRadius();this.renderer.setAttribute(this.progressContainerRef.nativeElement,"width",""+2*t),this.renderer.setAttribute(this.progressContainerRef.nativeElement,"height",""+2*t),this.renderer.setAttribute(this.progressCircleRef.nativeElement,"r",""+(t-6)),this.renderer.setAttribute(this.progressCircleRef.nativeElement,"cx",""+t),this.renderer.setAttribute(this.progressCircleRef.nativeElement,"cy",""+t);var n=this.getCircumference();this.renderer.setStyle(this.progressCircleRef.nativeElement,"strokeDasharray","".concat(n," ").concat(n)),this.renderer.setStyle(this.progressCircleRef.nativeElement,"strokeDashoffset",""+n),setTimeout((function(){e.renderer.setStyle(e.progressCircleRef.nativeElement,"transition","stroke-dashoffset 300ms")}))}}]),e}()).\u0275fac=function(e){return new(e||Dk)(_.Pb(_.H))},Dk.\u0275cmp=_.Jb({type:Dk,selectors:[["app-play-loader"]],viewQuery:function(e,t){var n;1&e&&(_.Gc(Hk,!0),_.Gc(Bk,!0),_.Gc(Qk,!0)),2&e&&(_.uc(n=_.dc())&&(t.circleRef=n.first),_.uc(n=_.dc())&&(t.progressCircleRef=n.first),_.uc(n=_.dc())&&(t.progressContainerRef=n.first))},inputs:{percent:"percent"},decls:10,vars:0,consts:[["tabindex","0","type","button","aria-label","Interact in 3D",1,"play-loader"],[1,"play-loader__circle"],["circle",""],[1,"play-loader__ring"],["progressContainer",""],[1,"play-loader__ring-inner"],["progressCircle",""],["icon","play",1,"play-loader__icon"],[1,"play-loader__label"]],template:function(e,t){1&e&&(_.Vb(0,"button",0),_.Vb(1,"div",1,2),_.fc(),_.Vb(3,"svg",3,4),_.Qb(5,"circle",5,6),_.Ub(),_.ec(),_.Qb(7,"app-icon",7),_.Vb(8,"div",8),_.Mc(9,"3D"),_.Ub(),_.Ub(),_.Ub())},directives:[Js],styles:[".play-loader[_ngcontent-%COMP%]{--buttonSize:35vw;border:0;width:100%;background:rgba(0,0,0,.2);display:flex;position:fixed;justify-content:center;align-items:center;top:0;bottom:0;left:0;right:0;transition:background-color .25s,opacity .25s;z-index:10000}.play-loader[_ngcontent-%COMP%]:hover{opacity:1;cursor:pointer;background:var(--view-loader-scrim-bg--hover)}.play-loader[_ngcontent-%COMP%]:focus   .play-loader__circle[_ngcontent-%COMP%], .play-loader[_ngcontent-%COMP%]:hover   .play-loader__circle[_ngcontent-%COMP%]{background:var(--view-loader-button-bg--hover);color:var(--view-loader-circle-color--hover);transform:scale(1.1)}.play-loader[_ngcontent-%COMP%]:focus   .play-loader__icon[_ngcontent-%COMP%], .play-loader[_ngcontent-%COMP%]:hover   .play-loader__icon[_ngcontent-%COMP%]{color:var(--view-loader-icon-color--hover);transform:scale(1.2)}.play-loader[_ngcontent-%COMP%]:focus   .play-loader__label[_ngcontent-%COMP%], .play-loader[_ngcontent-%COMP%]:hover   .play-loader__label[_ngcontent-%COMP%]{color:var(--view-loader-label-color--hover)}.play-loader[_ngcontent-%COMP%]:focus   .play-loader__ring[_ngcontent-%COMP%], .play-loader[_ngcontent-%COMP%]:hover   .play-loader__ring[_ngcontent-%COMP%]{stroke:var(--view-loader-progress-color--hover)}.play-loader__circle[_ngcontent-%COMP%]{width:var(--buttonSize);height:var(--buttonSize);border-radius:50%;background-color:var(--view-loader-button-bg);color:var(--view-loader-circle-color);display:flex;align-items:center;justify-content:center;position:relative;transition:background-color .25s,color .25s,transform .25s}.play-loader__icon[_ngcontent-%COMP%]{font-size:calc(var(--buttonSize) / 2);color:var(--view-loader-icon-color);transition:color .25s,transform .25s;margin-right:-10%}.play-loader__label[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%;display:flex;justify-content:center;align-items:center;z-index:2;font-weight:600}.play-loader__ring[_ngcontent-%COMP%]{position:absolute;top:0;right:0;bottom:0;left:0;z-index:3;stroke-width:4;stroke:var(--view-loader-progress-color);fill:transparent;transform:rotate(-90deg)}@media (min-width:600px){.play-loader__circle[_ngcontent-%COMP%]{width:160px;height:160px}.play-loader__icon[_ngcontent-%COMP%]{font-size:80px}}"],changeDetection:0}),Dk),Wk=((Lk=function(){function e(){m(this,e)}return v(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||Lk)},Lk.\u0275cmp=_.Jb({type:Lk,selectors:[["app-hand-loader"]],decls:6,vars:0,consts:[["tabindex","0","type","button","aria-label","Interact in 3D",1,"hand-loader"],[1,"hand-loader__container"],[1,"hand-loader__circle"],["src","assets/images/widget/loading_experience/interact-in-3d-hand.svg","alt","Interact in 3D",1,"hand-loader__3d-hand"],[1,"hand-loader__label"]],template:function(e,t){1&e&&(_.Vb(0,"button",0),_.Vb(1,"div",1),_.Qb(2,"div",2),_.Qb(3,"img",3),_.Vb(4,"div",4),_.Mc(5,"Interact in 3D"),_.Ub(),_.Ub(),_.Ub())},styles:[".text-8[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase[_ngcontent-%COMP%]{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase[_ngcontent-%COMP%]{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase[_ngcontent-%COMP%]{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase[_ngcontent-%COMP%]{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-header[_ngcontent-%COMP%]{font-weight:700}.text--code[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.text-xlight[_ngcontent-%COMP%]{font-weight:200}.text-light[_ngcontent-%COMP%]{font-weight:300}.text-medium[_ngcontent-%COMP%]{font-weight:500}.text-semibold[_ngcontent-%COMP%]{font-weight:600}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-underline[_ngcontent-%COMP%]{text-decoration:underline}.text-italic[_ngcontent-%COMP%]{font-style:italic}.text-bright[_ngcontent-%COMP%]{color:#fff}.text-dim[_ngcontent-%COMP%]{color:#96a8c0}.text-error[_ngcontent-%COMP%]{color:#ed4758}.text-left[_ngcontent-%COMP%]{text-align:left}.text-center[_ngcontent-%COMP%]{text-align:center}.text-right[_ngcontent-%COMP%]{text-align:right}.text-ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link[_ngcontent-%COMP%], .text-link[_ngcontent-%COMP%]:visited{color:inherit;cursor:pointer}.text-link[_ngcontent-%COMP%]:not(.text-underline), .text-link[_ngcontent-%COMP%]:visited:not(.text-underline){text-decoration:none}.text-success[_ngcontent-%COMP%]{color:#38de38}.text-danger[_ngcontent-%COMP%]{color:#de3838}.text-info[_ngcontent-%COMP%]{color:#0060c4}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.text-pre-line[_ngcontent-%COMP%]{white-space:pre-line}.hand-loader[_ngcontent-%COMP%]{border:0;width:100%;background:rgba(0,0,0,.2);display:flex;position:fixed;justify-content:center;align-items:center;top:0;bottom:0;left:0;right:0;transition:background-color .25s,opacity .25s;z-index:10000}.hand-loader[_ngcontent-%COMP%]:hover{opacity:1;cursor:pointer;background:var(--view-loader-scrim-bg--hover)}@-webkit-keyframes handKeyframes{0%{transform:scale(1.2)}25%{transform:scale(1)}40%{transform:scale(1)}60%{transform:scale(1.2)}to{transform:scale(1.2)}}@keyframes handKeyframes{0%{transform:scale(1.2)}25%{transform:scale(1)}40%{transform:scale(1)}60%{transform:scale(1.2)}to{transform:scale(1.2)}}@-webkit-keyframes circleKeyframes{0%{transform:scale(0)}20%{transform:scale(0);opacity:1}to{transform:scale(1);opacity:0}}@keyframes circleKeyframes{0%{transform:scale(0)}20%{transform:scale(0);opacity:1}to{transform:scale(1);opacity:0}}.hand-loader[_ngcontent-%COMP%]:focus   .hand-loader__3d-hand[_ngcontent-%COMP%], .hand-loader[_ngcontent-%COMP%]:hover   .hand-loader__3d-hand[_ngcontent-%COMP%]{filter:drop-shadow(0 0 8px #2d72dc)}.hand-loader__container[_ngcontent-%COMP%]{position:relative;width:200px;height:200px}.hand-loader__circle[_ngcontent-%COMP%]{background-color:#fff;position:absolute;left:50%;margin-left:-40.5px;margin-top:-1.5px;width:70px;height:70px;border-radius:50%;-webkit-animation:circleKeyframes 2s infinite;animation:circleKeyframes 2s infinite}.hand-loader__3d-hand[_ngcontent-%COMP%]{-webkit-animation:handKeyframes 2s ease-in-out infinite;animation:handKeyframes 2s ease-in-out infinite;position:absolute;height:96px;width:86px;left:50%;margin-left:-43px;margin-top:27px;transition:filter .3s ease-out}.hand-loader__label[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em;font-weight:600;color:#fff;text-shadow:0 1px 5px #000;bottom:40px;position:absolute;text-align:center;width:100%}"],changeDetection:0}),Lk),$k=["app-view-rounded-button",""];function Kk(e,t){if(1&e&&_.Qb(0,"app-icon",3),2&e){var n=_.gc();_.lc("icon",n.icon)}}var Gk,Zk=((Gk=function(){function e(){m(this,e),this.iconPlacement="left",this.compact=!1,this.buttonType="outline"}return v(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||Gk)},Gk.\u0275cmp=_.Jb({type:Gk,selectors:[["button","app-view-rounded-button",""]],inputs:{icon:"icon",iconPlacement:"iconPlacement",label:"label",compact:"compact",buttonType:"buttonType",shadow:"shadow"},attrs:$k,decls:4,vars:12,consts:[[1,"view-rounded-button"],["class","view-rounded-button__icon mh-1",3,"icon",4,"ngIf"],[1,"view-rounded-button__label","mh-1"],[1,"view-rounded-button__icon","mh-1",3,"icon"]],template:function(e,t){1&e&&(_.Vb(0,"div",0),_.Kc(1,Kk,1,1,"app-icon",1),_.Vb(2,"div",2),_.Mc(3),_.Ub(),_.Ub()),2&e&&(_.Hb("view-rounded-button--outline","outline"===t.buttonType)("view-rounded-button--solid","solid"===t.buttonType)("view-rounded-button--shadow",t.shadow)("view-rounded-button--compact",t.compact)("view-rounded-button--reverse","right"===t.iconPlacement),_.Db(1),_.lc("ngIf",t.icon),_.Db(2),_.Nc(t.label))},directives:[or.l,Js],styles:[".text-8{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-header{font-weight:700}.text--code{font-family:Courier New,Courier,monospace}.text-uppercase{text-transform:uppercase}.text-xlight{font-weight:200}.text-light{font-weight:300}.text-medium{font-weight:500}.text-semibold{font-weight:600}.text-bold{font-weight:700}.text-underline{text-decoration:underline}.text-italic{font-style:italic}.text-bright{color:#fff}.text-dim{color:#96a8c0}.text-error{color:#ed4758}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.text-ellipsis{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link,.text-link:visited{color:inherit;cursor:pointer}.text-link:not(.text-underline),.text-link:visited:not(.text-underline){text-decoration:none}.text-success{color:#38de38}.text-danger{color:#de3838}.text-info{color:#0060c4}.text-nowrap{white-space:nowrap}.text-pre-line{white-space:pre-line}button[app-view-rounded-button]{border-color:transparent;background:none;border-width:0;padding:0;outline:none;margin:0;pointer-events:all}button[app-view-rounded-button]:focus .view-rounded-button,button[app-view-rounded-button]:hover .view-rounded-button{color:#f9fafd;border-color:#f9fafd;background:rgba(249,250,253,.25)}button[app-view-rounded-button]:focus .view-rounded-button--solid,button[app-view-rounded-button]:hover .view-rounded-button--solid{border-color:rgba(249,250,253,.25)}.view-rounded-button{cursor:pointer;display:flex;flex-direction:row;align-items:center;justify-content:center;padding:12px 16px;border-radius:24px;color:#f9fafd;border:1px solid #f9fafd}.view-rounded-button__label{font-size:16px;letter-spacing:.4px;line-height:1.4em}.view-rounded-button--solid{color:#060502;border-color:#060502;background:#f9fafd}.view-rounded-button--shadow{box-shadow:0 0 8px rgba(0,0,0,.32)}.view-rounded-button--reverse{flex-direction:row-reverse}.view-rounded-button--compact{padding:4px 8px}"],encapsulation:2,changeDetection:0}),Gk),Jk=function(e){return e.CameraZoom="camera-zoom",e.CameraRotate="camera-rotate",e.CameraPan="camera-pan",e.NodeSelection="node-selection",e}({}),Xk=h("JX91"),Yk=h("IOcx");function eO(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.001;return iO(e).pipe(Object(Xk.a)(t.getCameraZoom()),Object(K.a)((function(){return t.getCameraZoom()})),Object(er.a)(),Object(K.a)((function(e){var t=u(e,2),n=t[0];return t[1]-n})),Object(be.a)((function(e){return Math.abs(e)>i})),Object(Za.a)(n))}function tO(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:125;return iO(e).pipe(Object(Xk.a)(t.getLookDirection()),Object(K.a)((function(){return t.getLookDirection()})),Object(er.a)(),Object(K.a)((function(e){var t=u(e,2);return function(e,t){return Yk.a.angle(e,t)>.001}(t[0],t[1])})),Object(be.a)((function(e){return e})),Object(Za.a)(n))}function nO(e){return{camera:e.getCamera(),zoom:e.getCameraZoom()}}function iO(e){return e.getEvent(Lt.CameraRested)}function oO(e){var t=e.eye,n=e.look,i=Yk.a.fromValues(t.x,t.y,t.z),o=Yk.a.fromValues(n.x,n.y,n.z),a=Yk.a.create();return Yk.a.sub(a,i,o),a}var aO=h("vqkR");function rO(e,t){if(1&e&&(_.Vb(0,"h1",6),_.Mc(1),_.Ub()),2&e){var n=_.gc(2);_.Db(1),_.Oc(" ",n.title," ")}}function cO(e,t){if(1&e&&_.Qb(0,"img",7),2&e){var n=_.gc(2);_.lc("src",n.image,_.Cc)}}function sO(e,t){if(1&e&&(_.Vb(0,"div",1),_.Kc(1,rO,2,1,"h1",2),_.Vb(2,"article",3),_.jc(3),_.Ub(),_.Kc(4,cO,1,1,"img",4),_.Vb(5,"div",5),_.jc(6,1),_.Ub(),_.Ub()),2&e){var n=_.gc();_.Hb("slide--expanded","expanded"===n.spacing),_.lc("@refresh",void 0),_.Db(1),_.lc("ngIf",n.title),_.Db(3),_.lc("ngIf",n.image)}}var lO,pO=["*",[["","slide-footer",""]]],uO=["*","[slide-footer]"],dO=((lO=function(){function e(t,n,i,o,a){m(this,e),this.store=t,this.actions=n,this.engineService=i,this.cameraService=o,this.changeRef=a,this.spacing="compact",this.exitEnabled=!0,this.triggerDelay=300,this.triggerComplete=new _.p,this._shown=!1,this.ngUnsubscribe=new ge.a}return v(e,[{key:"shown",get:function(){return this._shown},set:function(e){this._shown=e,this.initTrigger(),this.changeRef.markForCheck()}},{key:"ngOnInit",value:function(){}},{key:"ngAfterViewInit",value:function(){this.initTrigger()}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"initTrigger",value:function(){var e=this;if(this.ngUnsubscribe.next(),this.shown&&this.trigger){var t=this.resetCamera(),n=this.store.selectSnapshot(hp.getCanTouch);(function(e,t,n,i,o){switch(e){case Jk.CameraZoom:return o?eO(n,i):function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.001,o=e.getCanvas(),a=Object(Ga.a)(o,"wheel"),r=Object(Ga.a)(o,"touchmove").pipe(Object(be.a)((function(e){return 2===e.touches.length}))),c=eO(e,t,n,i);return Object($a.a)(a,r).pipe(Object(oa.a)((function(){return c})))}(n,i);case Jk.CameraPan:return function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:125,i=e.getCanvas(),o=Object(Ga.a)(i,"mousemove").pipe(Object(be.a)((function(e){return 1===e.buttons&&e.shiftKey||2===e.buttons||4===e.buttons}))),a=Object(Ga.a)(i,"touchmove").pipe(Object(be.a)((function(e){return 2===e.touches.length}))),r=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:125;return iO(e).pipe(Object(Xk.a)(nO(t)),Object(K.a)((function(){return nO(t)})),Object(Za.a)(n),Object(er.a)(),Object(K.a)((function(e){var t=u(e,2);return function(e,t){var n=oO(e.camera),i=oO(t.camera),o=Yk.a.create();Yk.a.sub(o,n,i);var a=o.reduce((function(e,t){return e+t})),r=t.zoom-e.zoom;return(0!==r||0!==a)&&Math.abs(a)<1&&Math.abs(r)<.001}(t[0],t[1])})),Object(be.a)((function(e){return e})))}(e,t,n);return Object($a.a)(o,a).pipe(Object(oa.a)((function(){return r})))}(n,i);case Jk.CameraRotate:return o?tO(n,i):function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e3,o=t.getCanvas(),a=Object(Ga.a)(o,"mousemove").pipe(Object(be.a)((function(e){return 1===e.buttons}))),r=Object(Ga.a)(o,"touchmove").pipe(Object(be.a)((function(e){return 1===e.touches.length}))),c=tO(t,n,i);return Object($a.a)(a,r).pipe(Object(oa.a)((function(){return c})),Object(be.a)((function(){return"rotate"===e.selectSnapshot(Fa.getPanMode)})),Object(Za.a)(125))}(t,n,i);case Jk.NodeSelection:return function(e){return e.select(Fi.getCheckedNodes).pipe(Object(er.a)(),Object(be.a)((function(e){var t=u(e,2);return t[0],t[1].length>0})))}(t)}})(this.trigger,this.store,this.engineService,this.cameraService,n).pipe(Object(aO.a)(t),Object(Dc.a)(this.triggerDelay),Object(fe.a)(this.ngUnsubscribe)).subscribe((function(){e.triggerComplete.next()}))}}},{key:"resetCamera",value:function(){var e=this,t=this.store.selectSnapshot(Ua.getSelectedChapter);return this.store.dispatch(new Wt(t.camera.location,!0)).pipe(Object(oa.a)((function(){return e.actions.pipe(Object(L.j)($t))})),Object(bp.a)(1))}}]),e}()).\u0275fac=function(e){return new(e||lO)(_.Pb(L.g),_.Pb(L.b),_.Pb(Nt),_.Pb(dn),_.Pb(_.i))},lO.\u0275cmp=_.Jb({type:lO,selectors:[["app-view-tour-slide"]],inputs:{title:"title",image:"image",spacing:"spacing",shown:"shown",exitEnabled:"exitEnabled",trigger:"trigger",triggerDelay:"triggerDelay"},outputs:{triggerComplete:"triggerComplete"},ngContentSelectors:uO,decls:1,vars:1,consts:[["class","slide",3,"slide--expanded",4,"ngIf"],[1,"slide"],["class","slide__title",4,"ngIf"],[1,"slide__content"],["class","slide__image",3,"src",4,"ngIf"],[1,"slide__footer"],[1,"slide__title"],[1,"slide__image",3,"src"]],template:function(e,t){1&e&&(_.kc(pO),_.Kc(0,sO,7,5,"div",0)),2&e&&_.lc("ngIf",t.shown)},directives:[or.l],styles:[".text-8[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase[_ngcontent-%COMP%]{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase[_ngcontent-%COMP%]{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase[_ngcontent-%COMP%]{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase[_ngcontent-%COMP%]{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-header[_ngcontent-%COMP%]{font-weight:700}.text--code[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.text-xlight[_ngcontent-%COMP%]{font-weight:200}.text-light[_ngcontent-%COMP%]{font-weight:300}.text-medium[_ngcontent-%COMP%]{font-weight:500}.text-semibold[_ngcontent-%COMP%]{font-weight:600}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-underline[_ngcontent-%COMP%]{text-decoration:underline}.text-italic[_ngcontent-%COMP%]{font-style:italic}.text-bright[_ngcontent-%COMP%]{color:#fff}.text-dim[_ngcontent-%COMP%]{color:#96a8c0}.text-error[_ngcontent-%COMP%]{color:#ed4758}.text-left[_ngcontent-%COMP%]{text-align:left}.text-center[_ngcontent-%COMP%]{text-align:center}.text-right[_ngcontent-%COMP%]{text-align:right}.text-ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link[_ngcontent-%COMP%], .text-link[_ngcontent-%COMP%]:visited{color:inherit;cursor:pointer}.text-link[_ngcontent-%COMP%]:not(.text-underline), .text-link[_ngcontent-%COMP%]:visited:not(.text-underline){text-decoration:none}.text-success[_ngcontent-%COMP%]{color:#38de38}.text-danger[_ngcontent-%COMP%]{color:#de3838}.text-info[_ngcontent-%COMP%]{color:#0060c4}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.text-pre-line[_ngcontent-%COMP%]{white-space:pre-line}.slide[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;text-align:center;max-width:500px}.slide__title[_ngcontent-%COMP%]{font-weight:600;font-size:18px;letter-spacing:.45px}.slide__content[_ngcontent-%COMP%], .slide__title[_ngcontent-%COMP%]{margin-bottom:16px;line-height:1.4em}.slide__content[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.5em;max-width:100%}.slide__image[_ngcontent-%COMP%]{margin:24px auto;max-width:100%;min-height:1px}.slide__footer[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em;font-weight:500;display:flex;flex-direction:row;align-items:center;justify-content:center;max-width:100%}.slide--expanded[_ngcontent-%COMP%]   .slide__title[_ngcontent-%COMP%]{margin:16px}.slide--expanded[_ngcontent-%COMP%]   .slide__content[_ngcontent-%COMP%]{margin:48px}.slide--expanded[_ngcontent-%COMP%]   .slide__image[_ngcontent-%COMP%]{margin:48px auto}@media (max-width:768px){.slide[_ngcontent-%COMP%]{max-width:400px}.slide__image[_ngcontent-%COMP%]{margin:16px}.slide__title[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em;margin-bottom:12px}.slide__content[_ngcontent-%COMP%]{margin-bottom:12px}.slide__content[_ngcontent-%COMP%], .slide__footer[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}}@media (max-width:640px){.slide[_ngcontent-%COMP%]{max-width:320px}}@media (max-width:480px){.slide[_ngcontent-%COMP%]{max-width:240px}.slide__title[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px}.slide__content[_ngcontent-%COMP%], .slide__title[_ngcontent-%COMP%]{line-height:1.4em;margin-bottom:8px}.slide__content[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px}.slide__image[_ngcontent-%COMP%]{margin:4px auto}.slide__footer[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}}@media (max-width:320px){.slide[_ngcontent-%COMP%]{max-width:160px}}"],data:{animation:[Object(fp.n)("refresh",[Object(fp.m)(":enter",[Object(fp.o)(iy.slideTransition,{params:{duration:500,from:100,to:0}})])])]},changeDetection:0}),lO);function gO(e,t){1&e&&(_.Vb(0,"div",1),_.Vb(1,"div",2),_.jc(2),_.Ub(),_.Ub())}var hO,fO=["*"],bO=((hO=function(){function e(t){m(this,e),this.changeRef=t,this.selectedSlideIndex=0,this._shown=!1,this.ngUnsubscribe=new ge.a}return v(e,[{key:"shown",get:function(){return this._shown},set:function(e){this._shown=e,this.setSelectedSlide(0)}},{key:"ngOnInit",value:function(){}},{key:"ngAfterViewInit",value:function(){var e=this;this.initListeners(),setTimeout((function(){e.setSlideShown(e.selectedSlideIndex)}))}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"goToPrevSlide",value:function(){this.setSelectedSlide(this.selectedSlideIndex-1)}},{key:"goToNextSlide",value:function(){this.setSelectedSlide(this.selectedSlideIndex+1)}},{key:"setSelectedSlide",value:function(e){if(this.selectedSlideIndex=e,this.slides){var t=Math.max(0,Math.min(this.slides.length-1,e));this.selectedSlideIndex=t}this.setSlideShown(this.selectedSlideIndex)}},{key:"initListeners",value:function(){var e=this;Object($a.a).apply(void 0,s(this.slides.map((function(e){return e.triggerComplete.asObservable()})))).pipe(Object(fe.a)(this.ngUnsubscribe)).subscribe((function(){e.goToNextSlide()}))}},{key:"setSlideShown",value:function(e){this.slides&&this.slides.forEach((function(t,n){t.shown=n===e})),this.changeRef.markForCheck()}}]),e}()).\u0275fac=function(e){return new(e||hO)(_.Pb(_.i))},hO.\u0275cmp=_.Jb({type:hO,selectors:[["app-view-tour-page"]],contentQueries:function(e,t,n){var i;1&e&&_.Ib(n,dO,!1),2&e&&_.uc(i=_.dc())&&(t.slides=i)},inputs:{shown:"shown"},ngContentSelectors:fO,decls:1,vars:1,consts:[["class","page",4,"ngIf"],[1,"page"],[1,"page__contents"]],template:function(e,t){1&e&&(_.kc(),_.Kc(0,gO,3,0,"div",0)),2&e&&_.lc("ngIf",t.shown)},directives:[or.l],styles:[".text-8[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase[_ngcontent-%COMP%]{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase[_ngcontent-%COMP%]{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase[_ngcontent-%COMP%]{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase[_ngcontent-%COMP%]{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-header[_ngcontent-%COMP%]{font-weight:700}.text--code[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.text-xlight[_ngcontent-%COMP%]{font-weight:200}.text-light[_ngcontent-%COMP%]{font-weight:300}.text-medium[_ngcontent-%COMP%]{font-weight:500}.text-semibold[_ngcontent-%COMP%]{font-weight:600}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-underline[_ngcontent-%COMP%]{text-decoration:underline}.text-italic[_ngcontent-%COMP%]{font-style:italic}.text-bright[_ngcontent-%COMP%]{color:#fff}.text-dim[_ngcontent-%COMP%]{color:#96a8c0}.text-error[_ngcontent-%COMP%]{color:#ed4758}.text-left[_ngcontent-%COMP%]{text-align:left}.text-center[_ngcontent-%COMP%]{text-align:center}.text-right[_ngcontent-%COMP%]{text-align:right}.text-ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link[_ngcontent-%COMP%], .text-link[_ngcontent-%COMP%]:visited{color:inherit;cursor:pointer}.text-link[_ngcontent-%COMP%]:not(.text-underline), .text-link[_ngcontent-%COMP%]:visited:not(.text-underline){text-decoration:none}.text-success[_ngcontent-%COMP%]{color:#38de38}.text-danger[_ngcontent-%COMP%]{color:#de3838}.text-info[_ngcontent-%COMP%]{color:#0060c4}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.text-pre-line[_ngcontent-%COMP%]{white-space:pre-line}.page[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center}.page__contents[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}@media (max-width:768px){.page__contents[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}}@media (max-width:480px){.page__contents[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}}"],changeDetection:0}),hO),vO=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function mO(e,t){if(1&e){var n=_.Wb();_.Vb(0,"div",5),_.Vb(1,"button",6),_.cc("click",(function(){return _.zc(n),_.gc(2).handlePrevClick()})),_.Ub(),_.Vb(2,"div",7),_.Mc(3),_.Ub(),_.Vb(4,"button",8),_.cc("click",(function(){return _.zc(n),_.gc(2).handleNextClick()})),_.Ub(),_.Ub()}if(2&e){var i=_.gc().$implicit;_.Db(1),_.lc("disabled",i.pageIndex<1),_.Db(2),_.Pc(" ",i.pageIndex+1," / ",i.pageSize," "),_.Db(1),_.lc("disabled",i.pageIndex===i.pageSize-1)}}var yO=function(e){return{"pages--opaquer":e}};function xO(e,t){if(1&e){var n=_.Wb();_.Vb(0,"div",1),_.Vb(1,"button",2),_.cc("click",(function(){return _.zc(n),_.gc().handleExitClick()})),_.Ub(),_.Vb(2,"div",3),_.jc(3),_.Ub(),_.Kc(4,mO,5,4,"div",4),_.Ub()}if(2&e){var i=t.$implicit;_.lc("ngClass",_.oc(2,yO,i.pageIndex==i.pageSize-1)),_.Db(4),_.lc("ngIf",i.pageIndex<i.pageSize-1)}}var wO,kO,OO,CO=["*"],SO=((OO=function(){function e(t,n,i){m(this,e),this.store=t,this.changeRef=n,this.ga=i,this.ngUnsubscribe=new ge.a,this.index=null}return v(e,[{key:"ngOnInit",value:function(){}},{key:"ngAfterViewInit",value:function(){var e=this;this.tutorial$.pipe(Object(fe.a)(this.ngUnsubscribe),Object(be.a)((function(e){return null!=e&&e.pageSize>0}))).subscribe((function(t){e.handleTutorialPages(t)})),this.store.dispatch(new S.SetTutorial({pageSize:this.pages.length,pageIndex:0}))}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"handlePrevClick",value:function(){this.store.dispatch(new S.TutorialPrevious)}},{key:"handleNextClick",value:function(){this.store.dispatch(new S.TutorialNext)}},{key:"handleExitClick",value:function(){this.store.dispatch(new S.ToggleWindow(Gl.Tutorial,!1))}},{key:"handleTutorialPages",value:function(e){this.pages.forEach((function(t,n){t.shown=n===e.pageIndex})),this.ga.event("Viewed Tutorial Step","View Tutorial","Step ".concat(e.pageIndex+1," of ").concat(e.pageSize)),this.changeRef.markForCheck()}}]),e}()).\u0275fac=function(e){return new(e||OO)(_.Pb(L.g),_.Pb(_.i),_.Pb(ke.c))},OO.\u0275cmp=_.Jb({type:OO,selectors:[["app-view-tour-pages"]],contentQueries:function(e,t,n){var i;1&e&&_.Ib(n,bO,!1),2&e&&_.uc(i=_.dc())&&(t.pages=i)},ngContentSelectors:CO,decls:2,vars:3,consts:[["gaCategory","View Tutorial","class","pages",3,"ngClass",4,"ngIf"],["gaCategory","View Tutorial",1,"pages",3,"ngClass"],["gaEvent","","gaAction","Clicked Exit Tutorial","app-pin-button","","buttonType","dark","size","medium","icon","times","aria-label","Exit Tutorial","matTooltip","Exit Tutorial","matTooltipPosition","right",1,"pages__close",3,"click"],[1,"pages__contents"],["class","pages__footer",4,"ngIf"],[1,"pages__footer"],["gaEvent","","gaAction","Clicked Previous Tutorial Step","app-pin-button","","buttonType","dark","size","large","icon","angle-left","aria-label","Previous Tutorial Step","matTooltip","Previous Tutorial Step","matTooltipPosition","left",1,"pages__nav",3,"disabled","click"],[1,"mh-8"],["gaEvent","","gaAction","Clicked Next Tutorial Step","app-pin-button","","buttonType","dark","size","large","icon","angle-right","aria-label","Next Tutorial Step","matTooltip"," Next Tutorial Step","matTooltipPosition","right",1,"pages__nav",3,"disabled","click"]],template:function(e,t){1&e&&(_.kc(),_.Kc(0,xO,5,4,"div",0),_.hc(1,"async")),2&e&&_.lc("ngIf",_.ic(1,1,t.tutorial$))},directives:[or.l,ke.a,or.i,ag,ke.b,rg.c],pipes:[or.b],styles:[".text-8[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase[_ngcontent-%COMP%]{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase[_ngcontent-%COMP%]{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase[_ngcontent-%COMP%]{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase[_ngcontent-%COMP%]{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-header[_ngcontent-%COMP%]{font-weight:700}.text--code[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.text-xlight[_ngcontent-%COMP%]{font-weight:200}.text-light[_ngcontent-%COMP%]{font-weight:300}.text-medium[_ngcontent-%COMP%]{font-weight:500}.text-semibold[_ngcontent-%COMP%]{font-weight:600}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-underline[_ngcontent-%COMP%]{text-decoration:underline}.text-italic[_ngcontent-%COMP%]{font-style:italic}.text-bright[_ngcontent-%COMP%]{color:#fff}.text-dim[_ngcontent-%COMP%]{color:#96a8c0}.text-error[_ngcontent-%COMP%]{color:#ed4758}.text-left[_ngcontent-%COMP%]{text-align:left}.text-center[_ngcontent-%COMP%]{text-align:center}.text-right[_ngcontent-%COMP%]{text-align:right}.text-ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link[_ngcontent-%COMP%], .text-link[_ngcontent-%COMP%]:visited{color:inherit;cursor:pointer}.text-link[_ngcontent-%COMP%]:not(.text-underline), .text-link[_ngcontent-%COMP%]:visited:not(.text-underline){text-decoration:none}.text-success[_ngcontent-%COMP%]{color:#38de38}.text-danger[_ngcontent-%COMP%]{color:#de3838}.text-info[_ngcontent-%COMP%]{color:#0060c4}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.text-pre-line[_ngcontent-%COMP%]{white-space:pre-line}.pages[_ngcontent-%COMP%]{pointer-events:none;display:flex;flex-direction:column;align-items:center;justify-content:center;margin:20px auto 48px;max-width:600px;position:relative;background:rgba(16,24,35,.8);border-radius:16px;padding:24px 28px 20px}.pages--opaquer[_ngcontent-%COMP%]{background:rgba(16,24,35,.9)}.pages__footer[_ngcontent-%COMP%]{flex-direction:row;font-size:16px;letter-spacing:.4px;line-height:1.4em;font-weight:500}.pages__close[_ngcontent-%COMP%], .pages__footer[_ngcontent-%COMP%]{display:flex;align-items:center}.pages__close[_ngcontent-%COMP%]{z-index:1;position:absolute;top:8px;right:8px;align-self:flex-end;justify-content:center}.pages__contents[_ngcontent-%COMP%]{padding:16px 0}@media (max-width:768px){.pages[_ngcontent-%COMP%]{margin:16px 12% 48px;border-radius:10px;padding:18px 22px 14px}.pages__contents[_ngcontent-%COMP%]{padding:24px 0}.pages__footer[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.pages__nav[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}}@media (max-width:480px){.pages[_ngcontent-%COMP%]{margin:12px 10% 48px;border-radius:8px;padding:24px 20px 12px}.pages__footer[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.pages__nav[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}}"],changeDetection:0}),function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);a>3&&r&&Object.defineProperty(t,n,r)}([Object(L.d)(hp.getTutorial),vO("design:type",he.a)],OO.prototype,"tutorial$",void 0),OO),_O=((kO=function(){function e(){m(this,e)}return v(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||kO)},kO.\u0275cmp=_.Jb({type:kO,selectors:[["app-view-tour-success"]],inputs:{inline:"inline"},decls:2,vars:2,consts:[[1,"view-tour-success"],["icon","check",1,"view-tour-success__icon"]],template:function(e,t){1&e&&(_.Vb(0,"div",0),_.Qb(1,"app-icon",1),_.Ub()),2&e&&_.Hb("view-tour-success--inline",t.inline)},directives:[Js],styles:[".text-8{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-header{font-weight:700}.text--code{font-family:Courier New,Courier,monospace}.text-uppercase{text-transform:uppercase}.text-xlight{font-weight:200}.text-light{font-weight:300}.text-medium{font-weight:500}.text-semibold{font-weight:600}.text-bold{font-weight:700}.text-underline{text-decoration:underline}.text-italic{font-style:italic}.text-bright{color:#fff}.text-dim{color:#96a8c0}.text-error{color:#ed4758}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.text-ellipsis{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link,.text-link:visited{color:inherit;cursor:pointer}.text-link:not(.text-underline),.text-link:visited:not(.text-underline){text-decoration:none}.text-success{color:#38de38}.text-danger{color:#de3838}.text-info{color:#0060c4}.text-nowrap{white-space:nowrap}.text-pre-line{white-space:pre-line}.view-tour-success{width:52px;height:52px;display:flex;background-color:#1bbc66;border-radius:50%;justify-content:center;align-items:center}.view-tour-success__icon{font-size:36px;letter-spacing:.9px;line-height:1.4em;color:#fff}.view-tour-success--inline{display:inline-flex;width:32px;height:32px}.view-tour-success--inline .view-tour-success__icon{font-size:18px;letter-spacing:.45px;line-height:1.4em}@media (max-width:768px){.view-tour-success{width:36px;height:36px}.view-tour-success__icon{font-size:20px;letter-spacing:.5px;line-height:1.4em}.view-tour-success--inline{display:inline-flex;width:24px;height:24px}.view-tour-success--inline .view-tour-success__icon{font-size:12px;letter-spacing:.3px;line-height:1.4em}}"],encapsulation:2,changeDetection:0}),kO),jO=((wO=function(){function e(t){m(this,e),this.viewService=t,this.triggers=Jk}return v(e,[{key:"ngOnInit",value:function(){}},{key:"handleStartClick",value:function(){this.viewService.toggleTutorial(!1)}}]),e}()).\u0275fac=function(e){return new(e||wO)(_.Pb(Bu))},wO.\u0275cmp=_.Jb({type:wO,selectors:[["app-view-tour-mobile"]],decls:31,vars:5,consts:[["gaCategory","View Tutorial"],["title","Rotate",3,"trigger"],["title","Zoom",3,"trigger"],["title","Pan",3,"trigger"],["title","Explore the Anatomy",3,"trigger"],[1,"flex","justify-start","items-center"],[1,"mr-2",3,"inline"],[1,"text-semibold"],["title","Toolbar","image","assets/images/tutorial/tutorial-toolbar@3x.png"],["slide-footer","",1,"flex","flex-column","items-center","justify-center"],["gaEvent","","gaAction","Clicked Start Exploring","app-view-rounded-button","","buttonType","solid","label","Start Exploring!","aria-label","Start Exploring",1,"mt-4",3,"click"]],template:function(e,t){1&e&&(_.Vb(0,"app-view-tour-pages",0),_.Vb(1,"app-view-tour-page"),_.Vb(2,"app-view-tour-slide",1),_.Mc(3," Tap and drag with one finger to change the viewing angle. "),_.Ub(),_.Vb(4,"app-view-tour-slide"),_.Qb(5,"app-view-tour-success"),_.Ub(),_.Ub(),_.Vb(6,"app-view-tour-page"),_.Vb(7,"app-view-tour-slide",2),_.Mc(8," Pinch with two fingers to zoom in or out. "),_.Ub(),_.Vb(9,"app-view-tour-slide"),_.Qb(10,"app-view-tour-success"),_.Ub(),_.Ub(),_.Vb(11,"app-view-tour-page"),_.Vb(12,"app-view-tour-slide",3),_.Mc(13," Use two fingers to adjust the model's position. "),_.Ub(),_.Vb(14,"app-view-tour-slide"),_.Qb(15,"app-view-tour-success"),_.Ub(),_.Ub(),_.Vb(16,"app-view-tour-page"),_.Vb(17,"app-view-tour-slide",4),_.Mc(18," Tap on an individual part of the model to highlight anatomy. "),_.Ub(),_.Vb(19,"app-view-tour-slide"),_.Vb(20,"div",5),_.Vb(21,"div"),_.Qb(22,"app-view-tour-success",6),_.Vb(23,"strong",7),_.Mc(24,"Tip:"),_.Ub(),_.Mc(25," Double-tap to zoom in on specific structures. "),_.Ub(),_.Ub(),_.Ub(),_.Ub(),_.Vb(26,"app-view-tour-page"),_.Vb(27,"app-view-tour-slide",8),_.Mc(28," Use the toolbar to navigate through the 3D experience, launch deeper exploration tools, and relaunch this tutorial. "),_.Vb(29,"div",9),_.Vb(30,"button",10),_.cc("click",(function(){return t.handleStartClick()})),_.Ub(),_.Ub(),_.Ub(),_.Ub(),_.Ub()),2&e&&(_.Db(2),_.lc("trigger","camera-rotate"),_.Db(5),_.lc("trigger",t.triggers.CameraZoom),_.Db(5),_.lc("trigger",t.triggers.CameraPan),_.Db(5),_.lc("trigger",t.triggers.NodeSelection),_.Db(5),_.lc("inline",!0))},directives:[SO,ke.a,bO,dO,_O,Zk,ke.b],styles:[""],changeDetection:0}),wO);function PO(e,t){if(1&e&&_.Qb(0,"app-icon",5),2&e){var n=_.gc(2);_.lc("icon",n.icon)}}function MO(e,t){if(1&e&&(_.Vb(0,"span",6),_.Mc(1),_.Ub()),2&e){var n=_.gc(2);_.Db(1),_.Nc(n.label)}}function IO(e,t){if(1&e&&(_.Tb(0),_.Kc(1,PO,1,1,"app-icon",3),_.Kc(2,MO,2,1,"span",4),_.Sb()),2&e){var n=_.gc();_.Db(1),_.lc("ngIf",n.icon),_.Db(1),_.lc("ngIf",n.icon)}}function zO(e,t){if(1&e&&(_.Vb(0,"span"),_.Mc(1),_.Ub()),2&e){var n=_.gc();_.Db(1),_.Oc(" ",n.label," ")}}var TO,UO=((TO=function(){function e(){m(this,e)}return v(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||TO)},TO.\u0275cmp=_.Jb({type:TO,selectors:[["app-view-tour-tip-button"]],inputs:{label:"label",icon:"icon"},decls:3,vars:2,consts:[[1,"view-tour-tip-button","mv-1","mh-1",3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[3,"icon",4,"ngIf"],["class","visually-hidden",4,"ngIf"],[3,"icon"],[1,"visually-hidden"]],template:function(e,t){1&e&&(_.Vb(0,"div",0),_.Kc(1,IO,3,2,"ng-container",1),_.Kc(2,zO,2,1,"span",2),_.Ub()),2&e&&(_.lc("ngSwitch",!!t.icon),_.Db(1),_.lc("ngSwitchCase",!0))},directives:[or.n,or.o,or.p,or.l,Js],styles:[".view-tour-tip-button{display:inline-flex;align-items:center;justify-content:center;vertical-align:middle;color:#131c2a;background-color:#fff;border-radius:2px;font-weight:700;padding:4px;width:24px;height:24px}@media (max-width:768px){.view-tour-tip-button{width:20px;height:20px}}"],encapsulation:2,changeDetection:0}),TO),LO=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function DO(e,t){1&e&&(_.Tb(0),_.Mc(1," Hold the control key and scroll up and down to zoom in or out. "),_.Sb())}function EO(e,t){1&e&&(_.Tb(0),_.Mc(1," Scroll up and down to zoom in or out. "),_.Sb())}var FO,AO=((FO=function(){function e(t){m(this,e),this.viewService=t,this.triggers=Jk}return v(e,[{key:"ngOnInit",value:function(){this.captureScroll$=this.scrollMode$.pipe(Object(K.a)((function(e){return e===Ra.Capture})))}},{key:"handleStartClick",value:function(){this.viewService.toggleTutorial(!1)}}]),e}()).\u0275fac=function(e){return new(e||FO)(_.Pb(Bu))},FO.\u0275cmp=_.Jb({type:FO,selectors:[["app-view-tour-desktop"]],decls:62,vars:12,consts:[["gaCategory","View Tutorial"],["title","Rotate",3,"trigger"],[1,"flex","justify-start","items-center"],[1,"mr-2",3,"inline"],[1,"text-semibold"],["icon","caret-up","label","up"],["icon","caret-down","label","down"],["icon","caret-left","label","left"],["icon","caret-right","label","right"],["title","Zoom",3,"trigger","ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],["label","+"],["label","-"],["title","Pan",3,"trigger"],["label","W"],["label","A"],["label","S"],["label","D"],["title","Explore the Anatomy",3,"trigger"],["image","assets/images/tutorial/tutorial-toolbar@3x.png"],["slide-footer","",1,"flex","flex-column","items-center","justify-center"],["gaEvent","","gaAction","Clicked Start Exploring","app-view-rounded-button","","buttonType","solid","label","Start Exploring!","aria-label","Start Exploring",1,"mt-4",3,"click"]],template:function(e,t){1&e&&(_.Vb(0,"app-view-tour-pages",0),_.Vb(1,"app-view-tour-page"),_.Vb(2,"app-view-tour-slide",1),_.Mc(3," Click and drag the model to change the viewing angle. "),_.Ub(),_.Vb(4,"app-view-tour-slide"),_.Vb(5,"div",2),_.Vb(6,"div"),_.Qb(7,"app-view-tour-success",3),_.Vb(8,"strong",4),_.Mc(9,"Tip:"),_.Ub(),_.Mc(10," You can also use the arrow keys "),_.Qb(11,"app-view-tour-tip-button",5),_.Qb(12,"app-view-tour-tip-button",6),_.Qb(13,"app-view-tour-tip-button",7),_.Qb(14,"app-view-tour-tip-button",8),_.Mc(15," to rotate. "),_.Ub(),_.Ub(),_.Ub(),_.Ub(),_.Vb(16,"app-view-tour-page"),_.Vb(17,"app-view-tour-slide",9),_.hc(18,"async"),_.Kc(19,DO,2,0,"ng-container",10),_.Kc(20,EO,2,0,"ng-container",11),_.Ub(),_.Vb(21,"app-view-tour-slide"),_.Vb(22,"div",2),_.Vb(23,"div"),_.Qb(24,"app-view-tour-success",3),_.Vb(25,"strong",4),_.Mc(26,"Tip:"),_.Ub(),_.Mc(27," You can also use "),_.Qb(28,"app-view-tour-tip-button",12),_.Mc(29," to zoom in and "),_.Qb(30,"app-view-tour-tip-button",13),_.Mc(31," to zoom out. "),_.Ub(),_.Ub(),_.Ub(),_.Ub(),_.Vb(32,"app-view-tour-page"),_.Vb(33,"app-view-tour-slide",14),_.Mc(34," Hold the shift key and drag to move the model's position. "),_.Ub(),_.Vb(35,"app-view-tour-slide"),_.Vb(36,"div",2),_.Vb(37,"div"),_.Qb(38,"app-view-tour-success",3),_.Vb(39,"strong",4),_.Mc(40,"Tip:"),_.Ub(),_.Mc(41," You can also use the "),_.Qb(42,"app-view-tour-tip-button",15),_.Qb(43,"app-view-tour-tip-button",16),_.Qb(44,"app-view-tour-tip-button",17),_.Qb(45,"app-view-tour-tip-button",18),_.Mc(46," keys to pan. "),_.Ub(),_.Ub(),_.Ub(),_.Ub(),_.Vb(47,"app-view-tour-page"),_.Vb(48,"app-view-tour-slide",19),_.Mc(49," Click on an individual part of the model to highlight anatomy. "),_.Ub(),_.Vb(50,"app-view-tour-slide"),_.Vb(51,"div",2),_.Vb(52,"div"),_.Qb(53,"app-view-tour-success",3),_.Vb(54,"strong",4),_.Mc(55,"Tip:"),_.Ub(),_.Mc(56," Double-click to zoom in on specific structures. "),_.Ub(),_.Ub(),_.Ub(),_.Ub(),_.Vb(57,"app-view-tour-page"),_.Vb(58,"app-view-tour-slide",20),_.Mc(59," Use the toolbar to navigate through the 3D experience, launch deeper exploration tools, and relaunch this tutorial. "),_.Vb(60,"div",21),_.Vb(61,"button",22),_.cc("click",(function(){return t.handleStartClick()})),_.Ub(),_.Ub(),_.Ub(),_.Ub(),_.Ub()),2&e&&(_.Db(2),_.lc("trigger",t.triggers.CameraRotate),_.Db(5),_.lc("inline",!0),_.Db(10),_.lc("trigger",t.triggers.CameraZoom)("ngSwitch",_.ic(18,10,t.captureScroll$)),_.Db(2),_.lc("ngSwitchCase",!1),_.Db(5),_.lc("inline",!0),_.Db(9),_.lc("trigger",t.triggers.CameraPan),_.Db(5),_.lc("inline",!0),_.Db(10),_.lc("trigger",t.triggers.NodeSelection),_.Db(5),_.lc("inline",!0))},directives:[SO,ke.a,bO,dO,_O,UO,or.n,or.o,or.p,Zk,ke.b],pipes:[or.b],styles:[""],changeDetection:0}),function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);a>3&&r&&Object.defineProperty(t,n,r)}([Object(L.d)(qa.getScrollMode),LO("design:type",he.a)],FO.prototype,"scrollMode$",void 0),FO),RO=function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r},NO=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function VO(e,t){if(1&e){var n=_.Wb();_.Vb(0,"div",3),_.Vb(1,"h1",4),_.Mc(2,"Getting Started"),_.Ub(),_.Vb(3,"p",5),_.Mc(4," Welcome! This tutorial will teach you how to navigate and explore in 3D using your "),_.Qb(5,"button",6),_.hc(6,"async"),_.hc(7,"async"),_.Vb(8,"mat-menu",null,7),_.Vb(10,"button",8),_.cc("click",(function(){_.zc(n);var e=_.gc();return e.handleSelectInputModeClick(e.inputModes.Mouse)})),_.Mc(11),_.Ub(),_.Vb(12,"button",8),_.cc("click",(function(){_.zc(n);var e=_.gc();return e.handleSelectInputModeClick(e.inputModes.Touch)})),_.Mc(13),_.Ub(),_.Ub(),_.Ub(),_.Vb(14,"div",9),_.Vb(15,"button",10),_.cc("click",(function(){return _.zc(n),_.gc().handleExitClick()})),_.Ub(),_.Vb(16,"button",11),_.cc("click",(function(){return _.zc(n),_.gc().handleStartClick()})),_.Ub(),_.Ub(),_.Ub()}if(2&e){var i=_.vc(9),o=_.gc();_.Db(5),_.lc("compact",!0)("label",o.inputModesText[_.ic(6,8,o.inputMode$)])("matMenuTriggerFor",i),_.Eb("aria-label",o.inputModesText[_.ic(7,10,o.inputMode$)]),_.Db(5),_.lc("gaLabel",o.inputModesText[o.inputModes.Mouse]),_.Db(1),_.Oc(" ",o.inputModesText[o.inputModes.Mouse]," "),_.Db(1),_.lc("gaLabel",o.inputModesText[o.inputModes.Touch]),_.Db(1),_.Oc(" ",o.inputModesText[o.inputModes.Touch]," ")}}function HO(e,t){1&e&&_.Qb(0,"app-view-tour-mobile")}function BO(e,t){1&e&&_.Qb(0,"app-view-tour-desktop")}function QO(e,t){if(1&e&&(_.Vb(0,"div",12),_.hc(1,"async"),_.Kc(2,HO,1,0,"app-view-tour-mobile",13),_.Kc(3,BO,1,0,"app-view-tour-desktop",14),_.Ub()),2&e){var n=_.gc();_.lc("ngSwitch",_.ic(1,2,n.inputMode$)),_.Db(2),_.lc("ngSwitchCase",n.inputModes.Touch)}}var qO,WO=(p(x={},cp.Mouse,"mouse, trackpad, or keyboard"),p(x,cp.Touch,"touchscreen"),x),$O=((qO=function(){function e(t,n,i){m(this,e),this.store=t,this.viewService=n,this.storageService=i,this.inputModes=cp,this.inputModesText=WO,this.tourStarted=!1,this.tourEnded=!1,this.ngUnsubscribe=new ge.a}return v(e,[{key:"ngOnInit",value:function(){this.initListeners(),this.store.dispatch(new S.TutorialSeen(!0))}},{key:"ngAfterViewInit",value:function(){}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"initListeners",value:function(){var e=this;this.tutorial$.pipe(Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){var n=t.pageIndex,i=t.pageSize;e.tourStarted=n>-1,e.tourEnded=n===i-1})),Object(Ga.a)(window,"keyup").pipe(Object(be.a)((function(e){return"Escape"===e.key})),Object(fe.a)(this.ngUnsubscribe)).subscribe((function(){e.exit()}))}},{key:"handleExitClick",value:function(){this.exit()}},{key:"handleStartClick",value:function(){this.store.dispatch(new S.StartTutorial(!1))}},{key:"handleSelectInputModeClick",value:function(e){this.store.dispatch(new S.SetInputMode(e))}},{key:"exit",value:function(){this.viewService.toggleTutorial(!1)}}]),e}()).\u0275fac=function(e){return new(e||qO)(_.Pb(L.g),_.Pb(Bu),_.Pb(Lc))},qO.\u0275cmp=_.Jb({type:qO,selectors:[["app-view-tour"]],decls:3,vars:7,consts:[["gaCategory","View Tutorial","role","dialog","aria-label","Getting Started Tutorial",1,"tour"],["class","tour__intro",4,"ngIf"],["class","tour__contents",3,"ngSwitch",4,"ngIf"],[1,"tour__intro"],[1,"tour__title"],[1,"tour__welcome"],["app-view-rounded-button","","buttonType","outline","icon","chevron-down","iconPlacement","right",1,"tour__input-selection","text-small",3,"compact","label","matMenuTriggerFor"],["inputSelectionMenu","matMenu"],["gaEvent","","gaAction","Clicked Input Type","mat-menu-item","",3,"gaLabel","click"],[1,"tour__footer"],["gaEvent","","gaAction","Clicked No Thanks","app-view-rounded-button","","buttonType","outline","label","No, Thanks.","aria-label","Exit Tutorial",1,"mr-3","text-medium",3,"click"],["gaEvent","","gaAction","Clicked Start Tutorial","app-view-rounded-button","","buttonType","solid","label","Start Tutorial","aria-label","Start Tutorial",1,"ml-3","text-medium",3,"click"],[1,"tour__contents",3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"]],template:function(e,t){1&e&&(_.Vb(0,"div",0),_.Kc(1,VO,17,12,"div",1),_.Kc(2,QO,4,4,"div",2),_.Ub()),2&e&&(_.Hb("tour--started",t.tourStarted)("tour--ended",t.tourEnded),_.lc("@refresh",void 0),_.Db(1),_.lc("ngIf",!t.tourStarted),_.Db(1),_.lc("ngIf",t.tourStarted))},directives:[ke.a,or.l,Zk,ll.d,ll.a,ke.b,ll.b,or.n,or.o,or.p,jO,AO],pipes:[or.b],styles:[".text-8[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase[_ngcontent-%COMP%]{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase[_ngcontent-%COMP%]{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase[_ngcontent-%COMP%]{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase[_ngcontent-%COMP%]{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-header[_ngcontent-%COMP%]{font-weight:700}.text--code[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.text-xlight[_ngcontent-%COMP%]{font-weight:200}.text-light[_ngcontent-%COMP%]{font-weight:300}.text-medium[_ngcontent-%COMP%]{font-weight:500}.text-semibold[_ngcontent-%COMP%]{font-weight:600}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-underline[_ngcontent-%COMP%]{text-decoration:underline}.text-italic[_ngcontent-%COMP%]{font-style:italic}.text-bright[_ngcontent-%COMP%]{color:#fff}.text-dim[_ngcontent-%COMP%]{color:#96a8c0}.text-error[_ngcontent-%COMP%]{color:#ed4758}.text-left[_ngcontent-%COMP%]{text-align:left}.text-center[_ngcontent-%COMP%]{text-align:center}.text-right[_ngcontent-%COMP%]{text-align:right}.text-ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link[_ngcontent-%COMP%], .text-link[_ngcontent-%COMP%]:visited{color:inherit;cursor:pointer}.text-link[_ngcontent-%COMP%]:not(.text-underline), .text-link[_ngcontent-%COMP%]:visited:not(.text-underline){text-decoration:none}.text-success[_ngcontent-%COMP%]{color:#38de38}.text-danger[_ngcontent-%COMP%]{color:#de3838}.text-info[_ngcontent-%COMP%]{color:#0060c4}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.text-pre-line[_ngcontent-%COMP%]{white-space:pre-line}.tour[_ngcontent-%COMP%]{color:#fff;position:absolute;top:0;right:0;bottom:0;left:0;z-index:100;pointer-events:none;display:flex;flex-direction:column;align-items:center;overflow:auto}.tour__title[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.tour__welcome[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em;margin:16px auto 32px}.tour__intro[_ngcontent-%COMP%]{background:rgba(16,24,35,.9);border-radius:16px;margin:auto;padding:28px 32px;text-align:center;max-width:560px}.tour__input-selection[_ngcontent-%COMP%]{vertical-align:middle}.tour__header[_ngcontent-%COMP%]{flex:none;align-self:flex-end;justify-self:flex-start;margin:24px}.tour__contents[_ngcontent-%COMP%]{flex:auto;display:flex;flex-direction:column;justify-content:flex-end;width:100%}.tour__footer[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em;display:flex;flex-direction:row;align-items:center;justify-content:center}.tour__nav-arrow[_ngcontent-%COMP%]{font-size:32px;letter-spacing:.8px;line-height:1.4em;cursor:pointer}.tour--ended[_ngcontent-%COMP%]   .tour__contents[_ngcontent-%COMP%]{justify-content:center}@media (max-width:768px){.tour__intro[_ngcontent-%COMP%]{border-radius:12px;padding:20px 24px;margin:auto 12%;max-width:100%}.tour__intro__title[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.tour__intro__content[_ngcontent-%COMP%]{max-width:80%}.tour__header[_ngcontent-%COMP%], .tour__intro__content[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.tour__header[_ngcontent-%COMP%]{margin:12px}.tour__footer[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.tour__nav-arrow[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}}@media (max-width:480px){.tour__intro[_ngcontent-%COMP%]{border-radius:8px;padding:16px 20px;margin:auto 10%}.tour__intro__title[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.tour__intro__content[_ngcontent-%COMP%]{margin:12px auto 16px}.tour__header[_ngcontent-%COMP%], .tour__intro__content[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.tour__header[_ngcontent-%COMP%]{margin:12px}.tour__footer[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.tour__nav-arrow[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}}"],data:{animation:[Object(fp.n)("refresh",[Object(fp.m)(":enter",[Object(fp.o)(iy.slideTransition,{params:{duration:500,from:100,to:0}})])])]},changeDetection:0}),RO([Object(L.d)(hp.getTutorial),NO("design:type",he.a)],qO.prototype,"tutorial$",void 0),RO([Object(L.d)(hp.getInputMode),NO("design:type",he.a)],qO.prototype,"inputMode$",void 0),qO),KO=function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r},GO=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},ZO=["colorBtn"];function JO(e,t){1&e&&_.Qb(0,"app-icon",19)}function XO(e,t){if(1&e){var n=_.Wb();_.Vb(0,"button",14),_.cc("click",(function(){_.zc(n);var e=t.$implicit;return _.gc().setTextSize(e.size)})),_.Vb(1,"div",15),_.Vb(2,"div",16),_.Kc(3,JO,1,0,"app-icon",17),_.hc(4,"async"),_.Ub(),_.Vb(5,"div",18),_.Vb(6,"span"),_.Mc(7),_.Ub(),_.Ub(),_.Ub(),_.Ub()}if(2&e){var i=t.$implicit,o=_.gc();_.Db(3),_.lc("ngIf",i.size===_.ic(4,2,o.textSize$)),_.Db(4),_.Oc("",i.label,"px")}}function YO(e,t){1&e&&_.Qb(0,"app-icon",19)}function eC(e,t){if(1&e){var n=_.Wb();_.Vb(0,"button",14),_.cc("click",(function(){_.zc(n);var e=t.$implicit;return _.gc().setBrushSize(e.size)})),_.Vb(1,"div",15),_.Vb(2,"div",16),_.Kc(3,YO,1,0,"app-icon",17),_.hc(4,"async"),_.Ub(),_.Vb(5,"div",18),_.Qb(6,"app-icon",20),_.Vb(7,"span"),_.Mc(8),_.Ub(),_.Ub(),_.Ub(),_.Ub()}if(2&e){var i=t.$implicit,o=_.gc();_.Db(3),_.lc("ngIf",i.size===_.ic(4,4,o.brushSize$)),_.Db(3),_.Hc("font-size",i.size,"px"),_.Db(2),_.Nc(i.label)}}function tC(e,t){1&e&&_.Qb(0,"app-icon",19)}function nC(e,t){if(1&e){var n=_.Wb();_.Vb(0,"button",14),_.cc("click",(function(){_.zc(n);var e=t.$implicit;return _.gc().setEraserSize(e.size)})),_.Vb(1,"div",15),_.Vb(2,"div",16),_.Kc(3,tC,1,0,"app-icon",17),_.hc(4,"async"),_.Ub(),_.Vb(5,"div",18),_.Qb(6,"app-icon",20),_.Vb(7,"span"),_.Mc(8),_.Ub(),_.Ub(),_.Ub(),_.Ub()}if(2&e){var i=t.$implicit,o=_.gc();_.Db(3),_.lc("ngIf",i.size===_.ic(4,4,o.eraserSize$)),_.Db(3),_.Hc("font-size",i.size,"px"),_.Db(2),_.Nc(i.label)}}function iC(e,t){1&e&&_.Qb(0,"app-icon",19)}function oC(e,t){if(1&e){var n=_.Wb();_.Vb(0,"button",14),_.cc("click",(function(){_.zc(n);var e=t.$implicit;return _.gc().setBrushColor(e.color)})),_.Vb(1,"div",15),_.Vb(2,"div",16),_.Kc(3,iC,1,0,"app-icon",17),_.hc(4,"async"),_.Ub(),_.Vb(5,"div",18),_.Qb(6,"app-icon",20),_.Vb(7,"span"),_.Mc(8),_.Ub(),_.Ub(),_.Ub(),_.Ub()}if(2&e){var i=t.$implicit,o=_.gc();_.Db(3),_.lc("ngIf",i.color===_.ic(4,6,o.brushColor$)),_.Db(3),_.Hc("font-size",14,"px")("color",i.color),_.Db(2),_.Nc(i.label)}}var aC,rC=((aC=function(){function e(t){m(this,e),this.store=t,this.textSizes=ep,this.brushSizes=Yl,this.brushColors=np,this.eraserSizes=tp,this.modeEnum=Zl,this.downloadClick=new _.p,this.clearClick=new _.p,this.exitClick=new _.p,this.ngUnsubscribe=new ge.a}return v(e,[{key:"ngOnInit",value:function(){}},{key:"ngAfterViewInit",value:function(){var e=this;this.brushColor$.pipe(Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){e.colorBtn.nativeElement.style.setProperty("--pin-button-pin-color",t)})),this.hasPaint$.pipe(Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){t||e.store.selectSnapshot(hp.getWhiteboardAnnotateMode)!==Zl.Erase||e.handleModeSelect(Zl.Paint)}))}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"setBrushSize",value:function(e){this.store.dispatch(new S.SetWhiteboardBrushSize(e))}},{key:"setBrushColor",value:function(e){this.store.dispatch(new S.SetWhiteboardBrushColor(e))}},{key:"setTextSize",value:function(e){this.store.dispatch(new S.SetWhiteboardTextSize(e))}},{key:"handleModeSelect",value:function(e){this.store.dispatch(new S.SetWhiteboardAnnotateMode(e))}},{key:"setEraserSize",value:function(e){this.store.dispatch(new S.SetWhiteboardEraserSize(e))}},{key:"handleDownloadClick",value:function(){this.downloadClick.next()}},{key:"handleClearClick",value:function(){this.clearClick.next()}},{key:"handleExitClick",value:function(){this.exitClick.next()}}]),e}()).\u0275fac=function(e){return new(e||aC)(_.Pb(L.g))},aC.\u0275cmp=_.Jb({type:aC,selectors:[["app-view-annotate-tools"]],viewQuery:function(e,t){var n;1&e&&_.Gc(ZO,!0,_.m),2&e&&_.uc(n=_.dc())&&(t.colorBtn=n.first)},outputs:{downloadClick:"downloadClick",clearClick:"clearClick",exitClick:"exitClick"},decls:31,vars:26,consts:[["gaCategory","View Whiteboard Tools",1,"view-annotate-tools"],["eventCategory","View Whiteboard Tools","name","Whiteboard","padding","dense",3,"canExit","exit"],["app-pin-button","","buttonType","ghost","icon","text-size","aria-label","Text","matTooltip","Text",1,"mr-1",3,"matMenuTriggerFor","selected","click"],["app-pin-button","","buttonType","ghost","icon","paint-brush","aria-label","Brush","matTooltip","Brush",1,"mr-1",3,"matMenuTriggerFor","selected","click"],["app-pin-button","","buttonType","ghost","icon","eraser","aria-label","Eraser","matTooltip","Eraser",3,"matMenuTriggerFor","selected","disabled","click"],["app-pin-button","","buttonType","ghost","icon","tint","aria-label","Color","matTooltip","Color",3,"matMenuTriggerFor"],["colorBtn",""],["app-pin-button","","buttonType","ghost","icon","download","aria-label","Download","matTooltip","Download",3,"click"],["app-pin-button","","buttonType","ghost","aria-label","Clear","matTooltip","Clear",3,"disabled","click"],["textSizeMenu","matMenu"],["mat-menu-item","",3,"click",4,"ngFor","ngForOf"],["brushSizeMenu","matMenu"],["eraserSizeMenu","matMenu"],["brushColorMenu","matMenu"],["mat-menu-item","",3,"click"],[1,"flex","flex-row","items-center","justify-end"],[1,"view-annotate-tools__check"],["class","mr-2","icon","check",4,"ngIf"],[1,"view-annotate-tools__label"],["icon","check",1,"mr-2"],["icon","circle",1,"mr-2"]],template:function(e,t){if(1&e&&(_.Vb(0,"div",0),_.Vb(1,"app-pillbox",1),_.cc("exit",(function(){return t.handleExitClick()})),_.Vb(2,"button",2),_.cc("click",(function(){return t.handleModeSelect(t.modeEnum.Text)})),_.hc(3,"async"),_.Ub(),_.Vb(4,"button",3),_.cc("click",(function(){return t.handleModeSelect(t.modeEnum.Paint)})),_.hc(5,"async"),_.Ub(),_.Vb(6,"button",4),_.cc("click",(function(){return t.handleModeSelect(t.modeEnum.Erase)})),_.hc(7,"async"),_.hc(8,"async"),_.Ub(),_.Qb(9,"app-pillbox-divider"),_.Qb(10,"button",5,6),_.Qb(12,"app-pillbox-divider"),_.Vb(13,"button",7),_.cc("click",(function(){return t.handleDownloadClick()})),_.Ub(),_.Qb(14,"app-pillbox-divider"),_.Vb(15,"button",8),_.cc("click",(function(){return t.handleClearClick()})),_.hc(16,"async"),_.hc(17,"async"),_.Mc(18," Clear "),_.Ub(),_.Vb(19,"mat-menu",null,9),_.Kc(21,XO,8,4,"button",10),_.Ub(),_.Vb(22,"mat-menu",null,11),_.Kc(24,eC,9,6,"button",10),_.Ub(),_.Vb(25,"mat-menu",null,12),_.Kc(27,nC,9,6,"button",10),_.Ub(),_.Vb(28,"mat-menu",null,13),_.Kc(30,oC,9,8,"button",10),_.Ub(),_.Ub(),_.Ub()),2&e){var n=_.vc(20),i=_.vc(23),o=_.vc(26),a=_.vc(29);_.Db(1),_.lc("canExit",!0),_.Db(1),_.lc("matMenuTriggerFor",n)("selected",_.ic(3,14,t.mode$)===t.modeEnum.Text),_.Db(2),_.lc("matMenuTriggerFor",i)("selected",_.ic(5,16,t.mode$)===t.modeEnum.Paint),_.Db(2),_.lc("matMenuTriggerFor",o)("selected",_.ic(7,18,t.mode$)===t.modeEnum.Erase)("disabled",!_.ic(8,20,t.hasPaint$)),_.Db(4),_.lc("matMenuTriggerFor",a),_.Db(5),_.lc("disabled",!_.ic(16,22,t.hasPaint$)&&!_.ic(17,24,t.hasText$)),_.Db(6),_.lc("ngForOf",t.textSizes),_.Db(3),_.lc("ngForOf",t.brushSizes),_.Db(3),_.lc("ngForOf",t.eraserSizes),_.Db(3),_.lc("ngForOf",t.brushColors)}},directives:[ke.a,ix,ag,rg.c,ll.d,Xy,ll.a,or.k,ll.b,or.l,Js],pipes:[or.b],styles:[".view-annotate-tools__check{flex:2 1 0;color:#0060c4}.view-annotate-tools__label{display:flex;flex:6 1 0}"],encapsulation:2,changeDetection:0}),KO([Object(L.d)(hp.getWhiteboardAnnotateMode),GO("design:type",he.a)],aC.prototype,"mode$",void 0),KO([Object(L.d)(hp.getWhiteboardBrushSize),GO("design:type",he.a)],aC.prototype,"brushSize$",void 0),KO([Object(L.d)(hp.getWhiteboardTextSize),GO("design:type",he.a)],aC.prototype,"textSize$",void 0),KO([Object(L.d)(hp.getWhiteboardBrushColor),GO("design:type",he.a)],aC.prototype,"brushColor$",void 0),KO([Object(L.d)(hp.getWhiteboardEraserSize),GO("design:type",he.a)],aC.prototype,"eraserSize$",void 0),KO([Object(L.d)(hp.getWhiteboardHasPaint),GO("design:type",he.a)],aC.prototype,"hasPaint$",void 0),KO([Object(L.d)(hp.getWhiteboardHasText),GO("design:type",he.a)],aC.prototype,"hasText$",void 0),aC),cC=["textRef"];function sC(e,t){if(1&e){var n=_.Wb();_.Vb(0,"div"),_.Vb(1,"div",4),_.cc("cdkDragMoved",(function(e){return _.zc(n),_.gc().dragMoved(e,"corner1")})),_.Ub(),_.Vb(2,"div",5),_.cc("cdkDragMoved",(function(e){return _.zc(n),_.gc().dragMoved(e,"corner2")})),_.Ub(),_.Vb(3,"div",6),_.cc("cdkDragMoved",(function(e){return _.zc(n),_.gc().dragMoved(e,"corner3")})),_.Ub(),_.Vb(4,"div",7),_.cc("cdkDragMoved",(function(e){return _.zc(n),_.gc().dragMoved(e,"corner4")})),_.Ub(),_.Vb(5,"div",8),_.cc("cdkDragMoved",(function(e){return _.zc(n),_.gc().translateHandleMoved(e)})),_.Ub(),_.Ub()}if(2&e){var i=_.gc();_.Db(1),_.lc("cdkDragFreeDragPosition",i.dragHandles.corner1),_.Db(1),_.lc("cdkDragFreeDragPosition",i.dragHandles.corner2),_.Db(1),_.lc("cdkDragFreeDragPosition",i.dragHandles.corner3),_.Db(1),_.lc("cdkDragFreeDragPosition",i.dragHandles.corner4),_.Db(1),_.lc("cdkDragFreeDragPosition",i.dragHandles.translate)}}var lC,pC=function(e){return{"whiteboard-label__label--active":e}},uC=((lC=function(){function e(t,n){var i=this;m(this,e),this.changeDetectorRef=t,this.renderer=n,this.active=!0,this.initialized=!1,this.labelActive=new _.p,this.labelEmpty=new _.p,this.dragHandles={translate:{x:0,y:0},corner1:{x:0,y:0},corner2:{x:0,y:0},corner3:{x:0,y:0},corner4:{x:0,y:0}},this.handleCoords={translate:{x:0,y:0},corner1:{x:0,y:0},corner2:{x:0,y:0},corner3:{x:0,y:0},corner4:{x:0,y:0}},this.textareaTransform={x:0,y:0,width:110,height:40},this.handleDocumentBackspace=function(e){var t=i.textRef.nativeElement.activeElement;"Backspace"===e.key&&i.active&&!t&&i.deleteLabel()},this.handleTextboxMouseDown=function(e){i.active=!0,i.labelActive.next(i.id),i.refreshHandles()},this.handleDocumentMouseDown=function(e){var t=e.target.className.includes("view-annotate__canvas"),n=e.target.className.includes("whiteboard-label__label"),o=e.target.dataset.id===i.id;i.isLabelEmpty()&&!o&&i.initialized?i.deleteLabel():(t||n&&!o)&&(i.active=!1,i.changeDetectorRef.markForCheck())},this.handleTextKeyDown=function(e){if(e.stopPropagation(),i.isLabelEmpty()&&"Backspace"===e.key)i.deleteLabel();else{var t=i.textRef.nativeElement.scrollHeight,n=i.handleCoords,o=n.corner1,a=n.corner3,r=n.corner4,c=o.y+t;i.handleCoords.corner3=Object.assign(Object.assign({},a),{y:c}),i.handleCoords.corner4=Object.assign(Object.assign({},r),{y:c}),i.dragHandles.corner3=Object.assign({},i.handleCoords.corner3),i.dragHandles.corner4=Object.assign({},i.handleCoords.corner4),i.updateTextarea(),i.changeDetectorRef.markForCheck()}}}return v(e,[{key:"id",get:function(){return this._id},set:function(e){this._id=e,this.initialized=!1}},{key:"color",set:function(e){this.renderer.setStyle(this.textRef.nativeElement,"color",e)}},{key:"exporting",set:function(e){e&&(this.active=!1,this.labelActive.next(void 0))}},{key:"size",set:function(e){this.renderer.setStyle(this.textRef.nativeElement,"font-size",e+"px")}},{key:"ngOnInit",value:function(){var e=this;this.initHandles(),this.initInteractionListeners(),setTimeout((function(){e.textRef.nativeElement.focus(),e.initialized=!0}))}},{key:"ngOnDestroy",value:function(){this.textRef.nativeElement.removeEventListener("keydown",this.handleTextKeyDown),this.textRef.nativeElement.removeEventListener("mousedown",this.handleTextboxMouseDown),this.mouseDownListener(),this.backspaceListener()}},{key:"initHandles",value:function(){this.textareaTransform.x=this.initialPos.x,this.textareaTransform.y=this.initialPos.y;var e=this.textareaTransform,t=e.x,n=e.y,i=e.width,o=e.height;this.dragHandles.corner1={x:t,y:n},this.dragHandles.corner2={x:t+i,y:n},this.dragHandles.corner3={x:t+i,y:n+o},this.dragHandles.corner4={x:t,y:n+o},this.dragHandles.translate={x:t+i/2,y:n+-10},this.handleCoords.corner1=Object.assign({},this.dragHandles.corner1),this.handleCoords.corner2=Object.assign({},this.dragHandles.corner2),this.handleCoords.corner3=Object.assign({},this.dragHandles.corner3),this.handleCoords.corner4=Object.assign({},this.dragHandles.corner4),this.handleCoords.translate=Object.assign({},this.dragHandles.translate),this.updateTextarea()}},{key:"initInteractionListeners",value:function(){this.mouseDownListener=this.renderer.listen("document","mousedown",this.handleDocumentMouseDown),this.backspaceListener=this.renderer.listen("document","keydown",this.handleDocumentBackspace),this.textRef.nativeElement.addEventListener("mousedown",this.handleTextboxMouseDown),this.textRef.nativeElement.addEventListener("keydown",this.handleTextKeyDown)}},{key:"refreshHandles",value:function(){this.dragHandles.corner1=Object.assign({},this.handleCoords.corner1),this.dragHandles.corner2=Object.assign({},this.handleCoords.corner2),this.dragHandles.corner3=Object.assign({},this.handleCoords.corner3),this.dragHandles.corner4=Object.assign({},this.handleCoords.corner4),this.dragHandles.translate=Object.assign({},this.handleCoords.translate),this.changeDetectorRef.markForCheck()}},{key:"isLabelEmpty",value:function(){return""===this.textRef.nativeElement.innerText||"\n"===this.textRef.nativeElement.innerText}},{key:"deleteLabel",value:function(){this.labelEmpty.next(this.id)}},{key:"updateTextarea",value:function(){var e=this.handleCoords,t=e.corner1,n=e.corner2,i=e.corner3;this.textareaTransform.x=t.x,this.textareaTransform.y=t.y,this.textareaTransform.width=n.x-t.x,this.textareaTransform.height=i.y-n.y,this.renderer.setStyle(this.textRef.nativeElement,"transform","translate(".concat(this.textareaTransform.x,"px, ").concat(this.textareaTransform.y,"px)")),this.renderer.setStyle(this.textRef.nativeElement,"width",this.textareaTransform.width+"px"),this.renderer.setStyle(this.textRef.nativeElement,"height",this.textareaTransform.height+"px")}},{key:"updateTranslateHandle",value:function(){var e=this.handleCoords,t=e.corner1,n=e.corner2;this.handleCoords.translate={x:(n.x-t.x)/2+t.x,y:t.y+-10},this.dragHandles.translate=Object.assign({},this.handleCoords.translate)}},{key:"setHandle",value:function(e,t,n){this.handleCoords[e]=Object.assign(Object.assign({},this.handleCoords[e]),p({},t,n[t])),this.dragHandles[e]=Object.assign({},this.handleCoords[e])}},{key:"addDiffToHandle",value:function(e,t){this.handleCoords[e]={x:this.handleCoords[e].x+t.x,y:this.handleCoords[e].y+t.y},this.dragHandles[e]=Object.assign({},this.handleCoords[e])}},{key:"translateHandleMoved",value:function(e){var t=e.source._dragRef.getFreeDragPosition(),n={x:t.x-this.handleCoords.translate.x,y:t.y-this.handleCoords.translate.y};this.handleCoords.translate=Object.assign({},t),this.addDiffToHandle("corner1",n),this.addDiffToHandle("corner2",n),this.addDiffToHandle("corner3",n),this.addDiffToHandle("corner4",n),this.updateTextarea()}},{key:"dragMoved",value:function(e,t){var n=e.source._dragRef.getFreeDragPosition();this.handleCoords[t]=Object.assign({},n),"corner1"===t&&(this.setHandle("corner2","y",n),this.setHandle("corner4","x",n)),"corner2"===t&&(this.setHandle("corner1","y",n),this.setHandle("corner3","x",n)),"corner3"===t&&(this.setHandle("corner2","x",n),this.setHandle("corner4","y",n)),"corner4"===t&&(this.setHandle("corner1","x",n),this.setHandle("corner3","y",n)),this.updateTranslateHandle(),this.updateTextarea()}}]),e}()).\u0275fac=function(e){return new(e||lC)(_.Pb(_.i),_.Pb(_.H))},lC.\u0275cmp=_.Jb({type:lC,selectors:[["app-view-annotate-label"]],viewQuery:function(e,t){var n;1&e&&_.Gc(cC,!0),2&e&&_.uc(n=_.dc())&&(t.textRef=n.first)},inputs:{id:"id",initialPos:"initialPos",color:"color",exporting:"exporting",size:"size"},outputs:{labelActive:"labelActive",labelEmpty:"labelEmpty"},decls:4,vars:5,consts:[[1,"whiteboard-label"],[4,"ngIf"],["contenteditable","true","data-placeholder","Type..",1,"whiteboard-label__label",3,"ngClass"],["textRef",""],["cdkDrag","",1,"whiteboard-label__handle","whiteboard-label__handle--top-left",3,"cdkDragFreeDragPosition","cdkDragMoved"],["cdkDrag","",1,"whiteboard-label__handle","whiteboard-label__handle--top-right",3,"cdkDragFreeDragPosition","cdkDragMoved"],["cdkDrag","",1,"whiteboard-label__handle","whiteboard-label__handle--bottom-right",3,"cdkDragFreeDragPosition","cdkDragMoved"],["cdkDrag","",1,"whiteboard-label__handle","whiteboard-label__handle--bottom-left",3,"cdkDragFreeDragPosition","cdkDragMoved"],["cdkDrag","",1,"whiteboard-label__handle","whiteboard-label__handle--move",3,"cdkDragFreeDragPosition","cdkDragMoved"]],template:function(e,t){1&e&&(_.Vb(0,"div",0),_.Kc(1,sC,6,5,"div",1),_.Qb(2,"div",2,3),_.Ub()),2&e&&(_.Db(1),_.lc("ngIf",!0===t.active),_.Db(1),_.lc("ngClass",_.oc(3,pC,!0===t.active)),_.Eb("data-id",t.id))},directives:[or.l,or.i,Pa.a],styles:['.whiteboard-label[_ngcontent-%COMP%]{position:relative;z-index:1000}.whiteboard-label__handle[_ngcontent-%COMP%]{position:fixed;z-index:10;width:32px;height:32px;left:-16px;top:-16px}.whiteboard-label__handle[_ngcontent-%COMP%]:after{content:"";position:absolute;width:12px;height:12px;left:10px;top:10px;border-radius:50%;background-color:#0060c4}.whiteboard-label__handle[_ngcontent-%COMP%]:hover{cursor:pointer}.whiteboard-label__handle--top-left[_ngcontent-%COMP%]:hover{cursor:nw-resize}.whiteboard-label__handle--top-right[_ngcontent-%COMP%]:hover{cursor:ne-resize}.whiteboard-label__handle--bottom-right[_ngcontent-%COMP%]:hover{cursor:se-resize}.whiteboard-label__handle--bottom-left[_ngcontent-%COMP%]:hover{cursor:sw-resize}.whiteboard-label__handle--move[_ngcontent-%COMP%]:hover{cursor:move}.whiteboard-label__label[_ngcontent-%COMP%]{box-sizing:border-box;position:absolute;border:none;padding:5px;overflow-y:hidden}.whiteboard-label__label--active[_ngcontent-%COMP%]{box-shadow:inset 0 0 0 1px #0060c4}.whiteboard-label__label[_ngcontent-%COMP%]:focus{outline:none}.whiteboard-label__label[_ngcontent-%COMP%]:empty:before{content:attr(data-placeholder);color:rgba(55,74,104,.5)}'],changeDetection:0}),lC),dC=function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r},gC=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},hC=["drawCanvas"],fC=["annotateWrapper"];function bC(e,t){if(1&e){var n=_.Wb();_.Vb(0,"app-view-annotate-label",7),_.cc("labelActive",(function(e){return _.zc(n),_.gc().handleLabelActive(e)}))("labelEmpty",(function(e){return _.zc(n),_.gc().handleLabelEmpty(e)})),_.hc(1,"async"),_.Ub()}if(2&e){var i=t.$implicit,o=_.gc();_.Hb("view-annotate__label--clickthrough",_.ic(1,7,o.annotateMode$)!==o.whiteboardAnnotateMode.Text),_.lc("exporting",o.exporting)("id",i.id)("initialPos",i.pos)("color",i.color)("size",i.size)}}var vC,mC,yC,xC,wC=bn.PNG,kC=((vC=function(){function e(t,n,i,o,a){m(this,e),this.store=t,this.actions=n,this.viewService=i,this.clipboardService=o,this.changeRef=a,this.whiteboardAnnotateMode=Zl,this.labels=[],this.exporting=!1,this.brushSize=0,this.eraserSize=0,this.lineWidth=0,this.ngUnsubscribe=new ge.a}return v(e,[{key:"initTextModeListener",value:function(){var e=this;this.inputManager=new Hammer.Manager(this.drawCanvas.nativeElement),this.inputManager.add(new Hammer.Tap({event:"tap"})),this.inputManager.on("tap",(function(t){if(e.activeLabelId)e.activeLabelId=void 0;else{var n=Object(Oe.uniqueId)(),i=t.pointers[0],o=i.x,a=i.y,r=e.store.selectSnapshot(hp.getWhiteboardBrushColor),c=e.store.selectSnapshot(hp.getWhiteboardTextSize);e.labels.push({id:n,pos:{x:o,y:a},color:r,size:c}),e.activeLabelId=n,e.changeRef.markForCheck(),e.dispatchHasText()}}))}},{key:"handleLabelActive",value:function(e){this.activeLabelId=e;var t=this.labels.find((function(t){return t.id===e}));t&&this.store.dispatch([new S.SetWhiteboardTextSize(t.size),new S.SetWhiteboardBrushColor(t.color)])}},{key:"handleLabelEmpty",value:function(e){this.labels=this.labels.filter((function(t){return t.id!==e})),this.changeRef.markForCheck(),this.dispatchHasText()}},{key:"dispatchHasText",value:function(){this.store.dispatch(new S.SetWhiteboardHasText(this.labels.length>0))}},{key:"ngOnInit",value:function(){var e=this;this.canvasElement=this.drawCanvas.nativeElement,this.canvasContext=this.canvasElement.getContext("2d"),this.siteHeader=this.store.selectSnapshot(Lu.getSiteHeader),this.store.dispatch(new Tp.SetHeader(Iu.Hide)),this.brushColor$.pipe(Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){var n=e.labels.find((function(t){return t.id===e.activeLabelId}));n&&(n.color=t,e.changeRef.markForCheck())})),this.textSize$.pipe(Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){var n=e.labels.find((function(t){return t.id===e.activeLabelId}));n&&(n.size=t,e.changeRef.markForCheck())})),this.annotateMode$.pipe(Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){e.inputManager&&e.inputManager.destroy(),t===Zl.Paint?(e.canvasContext.globalCompositeOperation="source-over",e.setLineWidth(e.brushSize),e.initInputListeners()):t===Zl.Text?e.initTextModeListener():t===Zl.Erase&&(e.canvasContext.globalCompositeOperation="destination-out",e.setLineWidth(e.eraserSize),e.initInputListeners())}))}},{key:"ngAfterViewInit",value:function(){this.initCanvasListeners()}},{key:"ngOnDestroy",value:function(){this.inputManager.destroy(),this.reset(),this.store.dispatch(new Tp.SetHeader(this.siteHeader)),this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"initCanvasListeners",value:function(){var e=this;this.brushSize$.pipe(Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){e.setBrushSize(t)})),this.brushColor$.pipe(Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){e.setBrushColor(t)})),this.eraserSize$.pipe(Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){e.setEraserSize(t)})),this.syncCanvas()}},{key:"initInputListeners",value:function(){var e=this;this.inputManager=new Hammer.Manager(this.drawCanvas.nativeElement),this.inputManager.add(new Hammer.Pan({event:"pan",pointers:0})),this.inputManager.add(new Hammer.Tap({event:"tap"}));var t=new Map;this.inputManager.on("tap",(function(t){t.pointers.forEach((function(t){var n=t.x,i=t.y;e.drawPoint(n,i),e.checkCanvasPaint()}))})),this.inputManager.on("panstart",(function(e){e.pointers.forEach((function(e){var n=e.x,i=e.y;t.set(e.pointerId,{x:n,y:i})}))})),this.inputManager.on("pan",(function(n){n.pointers.forEach((function(n){var i=n.x,o=n.y,a=t.get(n.pointerId),r=a.x,c=a.y;e.drawLine(r,c,i,o),e.drawPoint(i,o),t.set(n.pointerId,{x:i,y:o})}))})),this.inputManager.on("panend",(function(){t.clear(),e.checkCanvasPaint()}))}},{key:"handleResetClick",value:function(){this.reset()}},{key:"handleDownloadClick",value:function(){var e=this;this.exporting=!0,this.changeRef.detectChanges();var t=this.canvasElement,n=t.width,i=t.height,o=this.store.selectSnapshot(Ua.getSelectedChapterId);this.store.dispatch(new qn(o,wC,100,{width:n,height:i},"original",!0,!0,[this.annotateElement.nativeElement])).pipe(Object(oa.a)((function(){return e.actions.pipe(Object(L.j)(Wn),Object(bp.a)(1))})),Object(fe.a)(this.ngUnsubscribe),Object(ae.a)((function(){e.exporting=!1,e.changeRef.markForCheck()}))).subscribe((function(t){e.downloadSnapshot(t.blob)}))}},{key:"handleExitClick",value:function(){this.resetCanvas(),this.viewService.toggleWhiteboard(!1)}},{key:"checkCanvasPaint",value:function(){var e=this.canvasContext.getImageData(0,0,this.canvasElement.width,this.canvasElement.height),t=new Uint32Array(e.data.buffer).some((function(e){return 0!==e}));this.store.dispatch(new S.SetWhiteboardHasPaint(t))}},{key:"drawPoint",value:function(e,t){var n=this.lineWidth/2,i=2*Math.PI;this.canvasContext.beginPath(),this.canvasContext.arc(e,t,n,0,i),this.canvasContext.fill()}},{key:"drawLine",value:function(e,t,n,i){this.canvasContext.beginPath(),this.canvasContext.moveTo(e,t),this.canvasContext.lineTo(n,i),this.canvasContext.stroke(),this.canvasContext.closePath()}},{key:"reset",value:function(){this.resetCanvas(),this.labels=[],this.changeRef.markForCheck(),this.dispatchHasText()}},{key:"setBrushSize",value:function(e){this.brushSize=e,this.setLineWidth(e)}},{key:"setBrushColor",value:function(e){this.canvasContext.fillStyle=e,this.canvasContext.strokeStyle=e}},{key:"setEraserSize",value:function(e){this.eraserSize=e,this.setLineWidth(e)}},{key:"setLineWidth",value:function(e){this.canvasContext.lineWidth=e,this.lineWidth=e}},{key:"syncCanvas",value:function(){var e=this.store.selectSnapshot(hp.getWhiteboardBrushSize),t=this.store.selectSnapshot(hp.getWhiteboardBrushColor),n=this.store.selectSnapshot(hp.getWhiteboardEraserSize),i=this.getScreenDimensions(),o=i.width,a=i.height;this.canvasElement.width=o,this.canvasElement.height=a,this.setBrushSize(e),this.setBrushColor(t),this.setEraserSize(n),this.canvasContext.lineJoin="round"}},{key:"resetCanvas",value:function(){var e=this.canvasElement,t=e.width,n=e.height;this.canvasContext.clearRect(0,0,t,n),this.store.dispatch(new S.SetWhiteboardHasPaint(!1))}},{key:"downloadSnapshot",value:function(e){var t=this,n=this.store.selectSnapshot(Rc.getStory).displayName,i="".concat((n||"").replace(/ /g,"_").replace(/\W/g,"").toLowerCase(),"_drawing.").concat(wC===bn.PNG?"png":"jpg");!0===z.native||z.platform===I.SDK?Io.blobToBase64(e).pipe(Object(oa.a)((function(e){return t.clipboardService.copyToClipboard(e,"image")})),Object(fe.a)(this.ngUnsubscribe)).subscribe((function(e){})):Io.exportImage(e,wC,i)}},{key:"getScreenDimensions",value:function(){var e=window;return{width:e.innerWidth,height:e.innerHeight}}}]),e}()).\u0275fac=function(e){return new(e||vC)(_.Pb(L.g),_.Pb(L.b),_.Pb(Bu),_.Pb(Xs),_.Pb(_.i))},vC.\u0275cmp=_.Jb({type:vC,selectors:[["app-view-annotate"]],viewQuery:function(e,t){var n;1&e&&(_.Gc(hC,!0),_.Gc(fC,!0)),2&e&&(_.uc(n=_.dc())&&(t.drawCanvas=n.first),_.uc(n=_.dc())&&(t.annotateElement=n.first))},decls:10,vars:15,consts:[[1,"view-annotate"],["annotateWrapper",""],["class","view-annotate__label",3,"view-annotate__label--clickthrough","exporting","id","initialPos","color","size","labelActive","labelEmpty",4,"ngFor","ngForOf"],["data-test","drawCanvas",1,"view-annotate__canvas"],["drawCanvas",""],[1,"view-annotate__tools"],[3,"clearClick","downloadClick","exitClick"],[1,"view-annotate__label",3,"exporting","id","initialPos","color","size","labelActive","labelEmpty"]],template:function(e,t){1&e&&(_.Vb(0,"div",0,1),_.hc(2,"async"),_.hc(3,"async"),_.hc(4,"async"),_.Kc(5,bC,2,9,"app-view-annotate-label",2),_.Qb(6,"canvas",3,4),_.Vb(8,"div",5),_.Vb(9,"app-view-annotate-tools",6),_.cc("clearClick",(function(){return t.handleResetClick()}))("downloadClick",(function(){return t.handleDownloadClick()}))("exitClick",(function(){return t.handleExitClick()})),_.Ub(),_.Ub(),_.Ub()),2&e&&(_.Hb("view-annotate--exporting",t.exporting)("view-annotate--cursor-paint",_.ic(2,9,t.annotateMode$)===t.whiteboardAnnotateMode.Paint)("view-annotate--cursor-erase",_.ic(3,11,t.annotateMode$)===t.whiteboardAnnotateMode.Erase)("view-annotate--cursor-text",_.ic(4,13,t.annotateMode$)===t.whiteboardAnnotateMode.Text),_.Db(5),_.lc("ngForOf",t.labels))},directives:[or.k,rC,uC],pipes:[or.b],styles:[".view-annotate{position:fixed;top:0;left:0;right:0;bottom:0;z-index:1;display:flex;flex-direction:column;align-items:center;justify-content:space-between;box-shadow:inset 0 0 0 4px #38de38;padding:8px;transition:border .3s linear}.view-annotate--exporting{box-shadow:none}.view-annotate--exporting .view-annotate__tools{display:none}.view-annotate--cursor-paint:hover{cursor:url(/assets/images/cursor-whiteboard-paint.svg) 7 20,pointer}.view-annotate--cursor-erase:hover{cursor:url(/assets/images/cursor-whiteboard-erase.svg) 7 20,pointer}.view-annotate--cursor-text:hover{cursor:url(/assets/images/cursor-whiteboard-text.svg) 7 20,pointer}.view-annotate__label{position:absolute;top:0;left:0;z-index:10}.view-annotate__label--clickthrough{pointer-events:none}.view-annotate__canvas{position:fixed;top:0;left:0;right:0;bottom:0;z-index:1}.view-annotate__tools{z-index:1;right:8px;bottom:8px;position:absolute}"],encapsulation:2,changeDetection:0}),dC([Object(L.d)(hp.getWhiteboardAnnotateMode),gC("design:type",he.a)],vC.prototype,"annotateMode$",void 0),dC([Object(L.d)(hp.getWhiteboardBrushSize),gC("design:type",he.a)],vC.prototype,"brushSize$",void 0),dC([Object(L.d)(hp.getWhiteboardBrushColor),gC("design:type",he.a)],vC.prototype,"brushColor$",void 0),dC([Object(L.d)(hp.getWhiteboardTextSize),gC("design:type",he.a)],vC.prototype,"textSize$",void 0),dC([Object(L.d)(hp.getWhiteboardEraserSize),gC("design:type",he.a)],vC.prototype,"eraserSize$",void 0),vC),OC=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},CC=((mC=function(){function e(t,n){m(this,e),this.store=t,this.changeDetectorRef=n,this.ngUnsubscribe=new ge.a,this.visible=!1}return v(e,[{key:"beforePrint",value:function(e){this.visible=!0,this.changeDetectorRef.markForCheck()}},{key:"afterPrint",value:function(e){this.visible=!1,this.changeDetectorRef.markForCheck()}},{key:"ngOnInit",value:function(){this.initImageUrlListener()}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"initImageUrlListener",value:function(){var e=this;Object(Ka.b)(this.storyChapters$,this.store.select(Ua.getRegisteredThumbnails)).pipe(Object(be.a)((function(e){var t=u(e,2),n=t[0],i=t[1];return n.length>0&&i.size>0})),Object(K.a)((function(e){var t=u(e,2),n=t[0];return t[1].get(n[0].id).urls.large})),Object(Ja.a)(),Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){e.imageUrl=t,e.changeDetectorRef.markForCheck()}))}}]),e}()).\u0275fac=function(e){return new(e||mC)(_.Pb(L.g),_.Pb(_.i))},mC.\u0275cmp=_.Jb({type:mC,selectors:[["app-view-print"]],hostBindings:function(e,t){1&e&&_.cc("beforeprint",(function(){return t.beforePrint()}),!1,_.yc)("afterprint",(function(){return t.afterPrint()}),!1,_.yc)},decls:3,vars:1,consts:[[1,"view-print"],["src","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=",1,"view-print__scrim"],[1,"view-print__image",3,"src"]],template:function(e,t){1&e&&(_.Vb(0,"div",0),_.Qb(1,"img",1),_.Qb(2,"img",2),_.Ub()),2&e&&(_.Db(2),_.lc("src",t.imageUrl,_.Cc))},styles:[".view-print[_ngcontent-%COMP%]{background-color:#fff;display:none;position:absolute;top:0;left:0;width:100%;height:100%;z-index:10000;justify-content:space-around;margin:auto;margin-top:0!important}@media print{.view-print[_ngcontent-%COMP%]{display:flex}}.view-print__scrim[_ngcontent-%COMP%]{display:block;width:100%;height:100%;position:absolute;z-index:-1;top:0;right:0;bottom:0;left:0}.view-print__image[_ngcontent-%COMP%]{display:block;flex:1 1 auto;-o-object-fit:contain;object-fit:contain;margin:0 auto;z-index:1}"],changeDetection:0}),function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);a>3&&r&&Object.defineProperty(t,n,r)}([Object(L.d)(Ua.getStoryChapters),OC("design:type",he.a)],mC.prototype,"storyChapters$",void 0),mC),SC=function e(){m(this,e)},_C={label:"Relevance",fields:[],ascending:!0},jC={label:"Most Recent",fields:["collection_content_createdate","update_date_time","create_date_time"],ascending:!1},PC={label:"Title (A-Z)",fields:["title"],ascending:!0},MC={label:"Title (Z-A)",fields:["title"],ascending:!1},IC={label:"Author (A-Z)",fields:["author"],ascending:!0},zC={label:"Author (Z-A)",fields:["author"],ascending:!1},TC=function(e){return e.Enabled="enabled",e.Disabled="disabled",e.Locked="locked",e}({}),UC=function e(){m(this,e),this.background={colors:null},this.uiAnnotations=!1,this.uiAudio=!1,this.uiInfo=!0,this.uiFullscreen=!0,this.uiScrubber=!1,this.uiHelp=!0,this.uiBd="",this.loadRotate=null,this.initial={button:!1,handHint:!1,play:!1},this.disableScroll={alert:!1,overlay:!1},this.uiQuiz={mode:TC.Enabled,number:void 0},this.autoLoad=!0,this.uiTour=!1,this.uiNav=!0,this.uiSearch=!0,this.uiTools=!0,this.uiUndo=!0,this.uiLabelList=!0,this.uiChapterList=!1,this.all=!1,this.collapseLabel=null,this.uiMenu=!0,this.uiAnatomyDescriptions=!1,this.uiTutorial=!1,this.uiLegend=!0,this.uiLoader=as,this.uiWhiteboard=!0,this.uiVisibilityLayers=!0,this.uiAnatomyLabels=!0},LC={title:"Desktop",type:"desktop",dimensions:{width:700,height:550},orientation:"vertical"},DC=h("P6Fj"),EC=function(e){return e.Single="share.widget.link",e.Bulk="share.widget.export",e}({}),FC={headers:new W.d({"Content-Type":"application/json; charset=utf-8"})},AC=new UC,RC={id:"embedded-human",dimensions:LC.dimensions,fullScreen:!0},NC=((yC=function(){function e(t,n,i){m(this,e),this.http=t,this.cameraService=n,this.numberService=i}return v(e,[{key:"exportModels",value:function(e,t,n,i,o,a){var r=arguments.length>6&&void 0!==arguments[6]&&arguments[6],c=[{label:"Title",field:"title"},{label:"URL",field:"url"},{label:"iFrame",field:"iFrame"},{label:"Author",field:"author"},{label:"Thumbnail URL",field:"thumbnail_url"},{label:"Created Date",field:"create_date_time"},{label:"Updated Date",field:"update_date_time"}];return r&&c.push({label:"Offline Package URL",field:"offline_url"}),this.getExportModels(e,t,n,i,o,a,r).pipe(Object(oa.a)((function(e){return function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=new DC.a,o=[];return n&&o.push(t.map((function(e){return e.label}))),e.forEach((function(e){var n=t.map((function(t){return e[t.field]}));o.push(n)})),new he.a((function(e){var t=i.unparse(o,{quotes:!0,header:!1});e.next(t),e.complete()}))}(e,c)})),Object(K.a)((function(e){var t="BioDigital-Widgets-".concat((new Date).toISOString().split("T")[0],"-export.csv"),n=new Blob([e],{type:"text/csv;charset=utf-8"});return Object(la.saveAs)(n,t),!0})))}},{key:"getExportModels",value:function(e,t,n,i,o,a){var r=this,c=arguments.length>6&&void 0!==arguments[6]&&arguments[6],s=a?Object($.a)(null):this.getUAID(EC.Bulk),l=c?this.getDownloadURLs(e):Object($.a)([]);return Object(Br.a)(s,l).pipe(Object(K.a)((function(c){var s=u(c,2),l=s[0],p=s[1];return e.map((function(e,c){var s=e.title,u=e.author,d=e.thumbnail_url,g=e.create_date_time,h=e.update_date_time,f=r.getWidgetURL(e,t,n,null,l,o,a),b=r.getWidgetEmbed(f,i),v=r.buildThumbnailURL(d),m=p[c]||"";return{title:s,url:f,iFrame:b,author:u,thumbnail_url:v,create_date_time:Object(or.u)(new Date(g),"shortDate","en"),update_date_time:Object(or.u)(new Date(h),"shortDate","en"),offline_url:m}}))})))}},{key:"generateWidgetURL",value:function(e,t,n,i,o,a,r){var c=this;return(r||!o?Object($.a)(null):this.getUAID(o)).pipe(Object(K.a)((function(o){return c.getWidgetURL(e,t,n,i,o,a,r)})))}},{key:"getWidgetURL",value:function(e,t,n,i,o){var a=this,r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"en",c=arguments.length>6?arguments[6]:void 0;n=n||AC;var s="bookmark"===e.type,l={};l[s?"be":"m"]=""+(s?e.id:e.module_name);var p=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},l),this.getParamsForUIOptions(n||AC)),this.getParamsForLoadingExperience(n||AC)),this.getParamsForScrollMode(n||AC)),this.getParamsForLoadRotate(n||AC)),this.getParamsForLabelScale(n||AC)),u=Object(Oe.get)(n,"background.colors");if(Array.isArray(u)&&u.length>=3){var d=u.slice(0,4).map((function(e){return a.numberService.roundNumber(e,3)}));p["background.colors"]=""+d}if(i){var g=this.cameraService.roundCamera(i,3),h=g.eye,f=g.look,b=g.up;p.camera=""+[h.x,h.y,h.z,f.x,f.y,f.z,b.x,b.y,b.z]}c?p.dk=c.app_apikey:o&&(p.uaid=o),r&&"en"!==r&&(p.lang=r);var v=this.isCustomWidget(e.embed_url_path)?e.embed_url_path:t;return this.buildWidgetURL(v,p)}},{key:"generateWidgetEmbed",value:function(e,t,n,i,o,a,r,c){var s=this;return this.generateWidgetURL(e,t,n,o,a,r,c).pipe(Object(K.a)((function(e){return s.getWidgetEmbed(e,i)})))}},{key:"getWidgetEmbed",value:function(e,t){var n=t||RC.dimensions,i=n.width,o=n.height;return'<iframe\n  id="'.concat(RC.id,'"\n  frameBorder="0"\n  width="').concat(i,'"\n  height="').concat(o,'"\n  allowFullScreen="').concat(RC.fullScreen,'"\n  loading="lazy"\n  src="').concat(e,'">\n</iframe>')}},{key:"getImageEmbed",value:function(e,t,n){var i=("BioDigital Human: "+e).replace(/"/g,"&quot;");return'<a href="'.concat(t,'" target="_blank"><img src="').concat(n,'" alt="').concat(i,'" title="').concat(i,'" /></a>')}},{key:"getUAID",value:function(e){return this.http.post("/ws/user/analytics",{analytic_type:""+e,analytic_platform:"app"},FC).pipe(Object(K.a)((function(e){return e.id})))}},{key:"getDownloadURLs",value:function(e){var t=this,n=e.filter((function(e){return!e.favorite&&!e.unavailable})).map((function(e){return{type:e.type,id:"module"===e.type?e.module_name:e.id}}));return this.http.post("/ws/download/reserve",{content:n},{headers:{"Content-Type":"application/json"}}).pipe(Object(K.a)((function(n){var i=n.tokens;return e.map((function(e){var n=e.type,o="module"===e.type?e.module_name:e.id,a=i.find((function(e){return e.type===n&&e.id===o}));return a&&a.token?t.buildDownloadURL(a.token):""}))})),Object(G.a)((function(){return Object($.a)(e.map((function(){return""})))})))}},{key:"extendWidgetOptions",value:function(e,t){var n=this.expandWidgetOptions(t);return this.deepExtendWidgetOptions(e,n),e}},{key:"getWidgetConfig",value:function(e){var t=this,n={};return Object.keys(e).forEach((function(i){var o=e[i];if(null!==o){var a=t.getConfigName(i);n[a]=o}})),n}},{key:"getConfigName",value:function(e){var t=this.camelToDashCase(e).replace(/^ui-/g,"");return this.dashCaseToCamelCase(t)}},{key:"getParamsForLoadingExperience",value:function(e){return e.autoLoad?e.initial.button?{"initial.button":!0}:e.initial.handHint?{"initial.hand":!0}:e.initial.play?{"initial.play":!0}:{}:{"auto-load":!1}}},{key:"getParamsForScrollMode",value:function(e){return e.disableScroll.alert?{"disable-scroll.alert":!0}:e.disableScroll.overlay?{"disable-scroll":!0}:{"disable-scroll":!1}}},{key:"getParamsForLoadRotate",value:function(e){return"number"==typeof e.loadRotate?{"load-rotate":e.loadRotate}:{}}},{key:"getParamsForLabelScale",value:function(e){return{}}},{key:"getParamsForUIOptions",value:function(e){return Object.assign({"ui-info":e.uiInfo,"ui-search":e.uiSearch,"ui-undo":e.uiUndo,"ui-fullscreen":e.uiFullscreen,"ui-nav":e.uiNav,"ui-tools":e.uiTools,"ui-help":e.uiHelp,"ui-chapter-list":e.uiChapterList,"ui-label-list":e.uiLabelList,"ui-anatomy-descriptions":e.uiAnatomyDescriptions,"ui-tutorial":e.uiTutorial,"ui-loader":e.uiLoader,"ui-whiteboard":e.uiWhiteboard,"ui-layers":e.uiVisibilityLayers,"ui-anatomy-labels":e.uiAnatomyLabels},this.getParamsForUIQuiz(e))}},{key:"getParamsForUIQuiz",value:function(e){var t={},n=Object(Oe.get)(e,"uiQuiz.mode"),i=Object(Oe.get)(e,"uiQuiz.number");return n===TC.Disabled&&(t["ui-quiz"]=!1),n===TC.Locked&&(t["ui-quiz-locked"]=!0),Object(Oe.isNil)(i)||(t["ui-quiz-start"]=i,t["ui-quiz-end"]=i),t}},{key:"camelToDashCase",value:function(e){return e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}},{key:"dashCaseToCamelCase",value:function(e){return e.replace(/-([a-z])/g,(function(e){return e[1].toUpperCase()}))}},{key:"isCustomWidget",value:function(e){return/widgets\/([^\/]+)\//.test(e)}},{key:"saveUserImage",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"jpeg";return this.http.post("/ws/user/image/v1-0",{image_src:e,image_type:t},FC).pipe(Object(K.a)((function(e){return e.url})))}},{key:"buildWidgetURL",value:function(e,t){var n=Object.entries(t).map((function(e){var t=u(e,2),n=t[0],i=t[1];return"".concat(n,"=").concat(i)})).join("&"),i=e.replace(/^\/|\/$/g,"");return z.deploy===M.Local?"https://localhost:4202/?"+n:"".concat(window.location.origin,"/").concat(i,"/?").concat(n)}},{key:"buildThumbnailURL",value:function(e){return"".concat(window.location.origin).concat(e)}},{key:"buildDownloadURL",value:function(e){return"".concat(window.location.origin,"/download?t=").concat(e)}},{key:"deepExtendWidgetOptions",value:function(e,t){var n=this;Object.entries(e).forEach((function(i){var o=u(i,2),a=o[0],r=o[1],c=typeof r;[a,n.camelToDashCase(a),n.getConfigName(a)].forEach((function(i){if(t.hasOwnProperty(i)&&null!==t[i]){var o=t[i],s=typeof o;null===r?e[a]=o:c===s&&("object"===c?n.deepExtendWidgetOptions(r,o):e[a]=o)}}))}))}},{key:"expandWidgetOptions",value:function(e){var t={};return Object.entries(e).forEach((function(n){var i=u(n,2),o=i[0],a=i[1],r=o.split(".");if(r.length>1){var c=r[0],s=r.slice(1).join(".");null!==t[c]&&"object"==typeof t[c]||(t[c]={}),t[c][s]=a}else t[o]=e[o]})),t}}]),e}()).\u0275fac=function(e){return new(e||yC)(_.Zb(W.b),_.Zb(dn),_.Zb(un))},yC.\u0275prov=_.Lb({token:yC,factory:yC.\u0275fac,providedIn:"root"}),yC),VC=function e(){m(this,e)},HC="/ws/enterprise/collection",BC=((xC=function(){function e(t,n){m(this,e),this.http=t,this.bookmarkService=n}return v(e,[{key:"getOrganizationUsers",value:function(e){return this.http.get("/ws/enterprise/profile?group_eid="+e).pipe(Object(K.a)((function(e){return e.user_list})))}},{key:"sendOrganizationInvites",value:function(e,t){return this.http.post("/ws/enterprise/invite",{group_eid:e,invite_emails:JSON.stringify(t)}).pipe(Object(K.a)((function(e){var t=e.results_summary.messages;return JSON.parse(t)})))}},{key:"getCollections",value:function(e){var t=this;return this.http.get("".concat(HC,"?group_id=").concat(e)).pipe(Object(K.a)((function(e){return Object(Y.plainToClass)(VC,e).map((function(e){return t.normalizeCollectionModel(e)}))})))}},{key:"getCollectionsByContent",value:function(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3?arguments[3]:void 0;if(i&&!o)throw new Error("collectionId must be included when includeContent is set to true");var a=t.content_type,r=t.content_id,c="".concat(HC,"?group_id=").concat(e,"&content_type=").concat(a,"&content_id=").concat(r,"&include_content=").concat(i?1:0);return i&&(c="".concat(c,"&collection_id=").concat(o)),this.http.get(c).pipe(Object(K.a)((function(e){return Object(Y.plainToClass)(VC,e).map((function(e){return n.normalizeCollectionModel(e)}))})))}},{key:"getCollectionContentId",value:function(e,t){var n=t.content_type,i=t.content_id;return this.getCollectionsByContent(e.group_id,t,!0,e.collection_id).pipe(Object(K.a)((function(t){return t.find((function(t){return t.collection_id===e.collection_id}))})),Object(K.a)((function(e){var t;return e&&(t=e.collection_content.find((function(e){return"module"===n?i===e.module_name:i===e.id}))),t?t.collection_content_id:null})))}},{key:"getCollection",value:function(e,t,n){var i=this;return this.http.get("".concat(HC,"?group_id=").concat(e,"&collection_id=").concat(t,"&include_content=").concat(n?1:0)).pipe(Object(K.a)((function(e){var t=e[0];return t?i.normalizeCollectionModel(t):t})))}},{key:"getCollectionContent",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",i=n.toLocaleLowerCase().split(" ");return this.getCollection(e,t,!0).pipe(Object(K.a)((function(e){return e.collection_content.map((function(e){return Object(Y.plainToClass)(pk,e)})).filter((function(e){var t=!0;return i.length&&e.title&&i.forEach((function(n){t=t&&e.title.toLocaleLowerCase().indexOf(n)>=0})),t=t&&!0!==e.unavailable}))})))}},{key:"addToCollection",value:function(e,t){var n=this;return this.formPost(HC,{group_id:e.group_id,collection_id:e.collection_id,add_content:t}).pipe(Object(K.a)((function(e){return e.map((function(e){return n.normalizeCollectionModel(e)}))})))}},{key:"removeFromCollection",value:function(e,t){var n=this;return this.formPost(HC,{group_id:e.group_id,collection_id:e.collection_id,remove_content:t}).pipe(Object(K.a)((function(e){return e.map((function(e){return n.normalizeCollectionModel(e)}))})))}},{key:"getOrganizationAttribute",value:function(e,t,n){return e.find((function(e){return e.type===t&&e.name===n}))}},{key:"addUserToOrganization",value:function(e){return this.http.post("/ws/enterprise/user/add",{group_eid:e})}},{key:"addUserWithGroupCode",value:function(e){return this.http.post("/ws/enterprise/user/add",{group_code:e}).pipe(Object(K.a)((function(e){return e.organization_name})))}},{key:"normalizeCollectionModel",value:function(e){var t=this;return e.collection_content&&e.collection_content.forEach((function(e){t.bookmarkService.normalizeBookmarkModel(e)})),e}},{key:"formPost",value:function(e,t){var n={headers:new W.d({"Content-Type":"application/x-www-form-urlencoded"})},i=new URLSearchParams;return Object.keys(t).forEach((function(e){var n=t[e],o=""+(n instanceof Object?JSON.stringify(n):n);i.set(e,o)})),this.http.post(""+e,i.toString(),n).pipe(Object(K.a)((function(e){return e})))}}]),e}()).\u0275fac=function(e){return new(e||xC)(_.Zb(W.b),_.Zb(kk))},xC.\u0275prov=_.Lb({token:xC,factory:xC.\u0275fac,providedIn:"root"}),xC);function QC(e,t,n){var i=t.map((function(t){return e[t]})).filter((function(e){return!Object(Oe.isNil)(e)}));return n?i.sort().shift():i.sort().pop()}function qC(e,t,n){if(0===t.length)return e;var i=new Intl.Collator("en-US",{sensitivity:"base"});return e.sort((function(e,o){var a=QC(e,t,n)||"",r=QC(o,t,n)||"";return(n?1:-1)*i.compare(a.toString(),r.toString())}))}var WC,$C=function e(){m(this,e)},KC=function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r},GC=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},ZC=function(e,t,n,i){return new(n||(n=Promise))((function(o,a){function r(e){try{s(i.next(e))}catch(t){a(t)}}function c(e){try{s(i.throw(e))}catch(t){a(t)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,c)}s((i=i.apply(e,t||[])).next())}))},JC={loading:!0,exporting:!1,copying:!1,saving:!1,bookmarks:[],selectedBookmark:null,sort:jC,checkedBookmarks:[],selectedCategory:null},XC=((WC=function(){function e(t,n,i,o,a,r,c,s){m(this,e),this.store=t,this.actions=n,this.bookmarksService=i,this.storyService=o,this.exploreService=a,this.publishService=r,this.organizationsService=c,this.snackbar=s}return v(e,[{key:"loadBookmarks",value:function(e,t){e.patchState({loading:!0,bookmarks:[],checkedBookmarks:[]}),Object(Br.a)(this.bookmarksService.getPrivateBookmarks(t.query),this.bookmarksService.getPrivateConditions(t.query),this.bookmarksService.getFavorites()).pipe(Object(ae.a)((function(){e.patchState({loading:!1})}))).subscribe((function(t){var n=u(t,3),i=n[0],o=n[1],a=n[2];e.dispatch(new $p([].concat(s(i),s(o),s(a))))}))}},{key:"loadOrganizationBookmarks",value:function(e,t){var n=t.organizationId;e.patchState({loading:!0,bookmarks:[],checkedBookmarks:[]}),this.bookmarksService.getOrganizationContent(n).pipe(Object(ae.a)((function(){e.patchState({loading:!1})}))).subscribe((function(t){e.dispatch(new $p(t))}))}},{key:"loadCollectionBookmarks",value:function(e,t){e.patchState({loading:!0,bookmarks:[],checkedBookmarks:[]}),this.organizationsService.getCollectionContent(t.organizationId,t.collectionId).pipe(Object(ae.a)((function(){e.patchState({loading:!1})}))).subscribe((function(t){e.dispatch(new $p(t))}))}},{key:"loadSuccess",value:function(e,t){(0,e.patchState)({bookmarks:t.result})}},{key:"loadBookmark",value:function(e,t){var n=t.id;("bookmark"===t.type?this.bookmarksService.getBookmarkModel(n):this.exploreService.getConditionModel(n)).subscribe((function(t){e.dispatch(new Wp(t))}))}},{key:"selectBookmarkSuccess",value:function(e,t){e.patchState({selectedBookmark:t.bookmark})}},{key:"saveBookmark",value:function(e,t){return ZC(this,void 0,void 0,regeneratorRuntime.mark((function n(){var i,o,a,r,c,s,l=this;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(i=t.bookmarkEntry,e.patchState({saving:!0}),a=this.store.selectSnapshot(Ua.getStoryChapters),r=!1===t.inplace,c=Co.makeChapterIdMap(a,r),n.t0=r,!n.t0){n.next=7;break}return n.next=7,this.store.dispatch(new Ii.UpdateTweenParticleLookupChapters(c)).toPromise();case 7:t.includeIndex&&(o=this.bookmarksService.createBookmarkStory(c),i.index=o.story),s=i.id?"update":"save",this.bookmarksService.saveBookmark(i).pipe(Object(ae.a)((function(){e.patchState({saving:!1})}))).subscribe((function(n){if(t.includeIndex){var a=l.store.selectSnapshot(Ua.getRegisteredThumbnails);e.dispatch(new ou(s,n.id,i,a,Object(Oe.invert)(c)))}var r=o?o.story:null;i.addCollection||i.removeCollection?(e.dispatch(new gu(n,i.addCollection,i.removeCollection)),l.actions.pipe(Object(L.j)(hu,fu),Object(bp.a)(1)).subscribe((function(){e.dispatch(new Xp(n,r,s))}))):e.dispatch(new Xp(n,r,s))}),(function(t){e.dispatch(new Yp(i))}));case 10:case"end":return n.stop()}}),n,this)})))}},{key:"saveBookmarkSuccess",value:function(e,t){var n=t.bookmark,i=e.getState().bookmarks,o=i.findIndex((function(e){return e.id===n.id}));-1!==o&&(i[o]=n,e.patchState({bookmarks:s(i)})),"save"===t.method&&e.patchState({selectedBookmark:t.bookmark})}},{key:"deleteBookmark",value:function(e,t){var n=t.bookmarkId;this.bookmarksService.deleteBookmark(n).subscribe((function(){e.dispatch(new Gp(n))}),(function(t){e.dispatch(new Zp(n,t))}))}},{key:"deleteBookmarkSuccess",value:function(e,t){var n=e.getState().bookmarks.filter((function(e){return e.id!==t.bookmarkId}));e.patchState({bookmarks:s(n)}),this.snackbar.open("Successfully deleted 3D model")}},{key:"deleteFail",value:function(e,t){this.snackbar.open("There was an error deleting the 3D model")}},{key:"deleteFavorite",value:function(e,t){var n=t.bookmark,i=n.id,o=Object(Oe.get)(n,"category","bookmark"),a="bookmark"===o?i:this.exploreService.toDatabaseContentId(i);this.bookmarksService.deleteFavorite(a,o).subscribe((function(){e.dispatch(new nu(i))}),(function(t){e.dispatch(new iu(i))}))}},{key:"deleteFavoriteSuccess",value:function(e,t){var n=e.getState().bookmarks.filter((function(e){return e.id!==t.bookmarkId}));e.patchState({bookmarks:s(n)}),this.snackbar.open("Successfully deleted 3D model")}},{key:"sortBookmarks",value:function(e,t){var n=e.getState().bookmarks;e.patchState({sort:t.sort,bookmarks:s(n)})}},{key:"clearBookmarks",value:function(e,t){e.patchState({bookmarks:[],checkedBookmarks:[]})}},{key:"resetBookmarks",value:function(e,t){e.setState(JC)}},{key:"checkBookmark",value:function(e,t){var n=e.getState().checkedBookmarks,i=n.some((function(e){return e===t.id}));t.checked&&!i?n=[].concat(s(n),[t.id]):t.checked||(n=n.filter((function(e){return e!==t.id}))),e.patchState({checkedBookmarks:n})}},{key:"setCheckedBookmarks",value:function(e,t){e.patchState({checkedBookmarks:t.ids})}},{key:"saveBookmarkThumbnails",value:function(e,t){var n=t.chapterIdMap,i=t.thumbnails,o=this.bookmarksService.saveBookmarkThumbnails(t.bookmarkId,t.bookmarkEntry,i,n);if("update"===t.method){var a,r=c(this.bookmarksService.deleteBookmarkThumbnails(t.bookmarkId,t.bookmarkEntry,i,n));try{for(r.s();!(a=r.n()).done;){var s=a.value;o.push(s)}}catch(l){r.e(l)}finally{r.f()}}Object(Br.a)(o).subscribe((function(n){e.dispatch(new Bn(new Map)).subscribe((function(){e.dispatch(new Bn(t.thumbnails))}))}))}},{key:"exportBookmarks",value:function(e,t){var n=t.bookmarks,i=t.widgetURL,o=t.widgetOptions,a=t.offlineEnabled,r=o||new UC;e.patchState({exporting:!0}),this.publishService.exportModels(n,i,r,null,t.userLanguage,t.userApp,a).pipe(Object(ae.a)((function(){e.patchState({exporting:!1})}))).subscribe((function(t){e.dispatch(t?new uu(n):new du(n))}))}},{key:"updateBookmarkCollection",value:function(e,t){var n=this,i=t.bookmark,o=t.addCollection,a=t.removeCollection,r={content_type:i.type,content_id:i.id},c=[];a&&c.push(this.organizationsService.getCollectionContentId(a,r).pipe(Object(be.a)((function(e){return!!e})),Object(oa.a)((function(e){return n.organizationsService.removeFromCollection(a,[e])})),Object(hn.a)((function(){return e.dispatch(new mu(i,a))}),(function(){return e.dispatch(new yu(i,a))})))),o&&c.push(this.organizationsService.addToCollection(o,[r]).pipe(Object(hn.a)((function(){return e.dispatch(new bu(i,a))}),(function(){return e.dispatch(new vu(i,a))})))),Object(ia.a).apply(void 0,c).subscribe((function(){return e.dispatch(new hu(i,o,a))}),(function(){return e.dispatch(new fu(i,o,a))}))}},{key:"removeBookmarkCollectionSuccess",value:function(e,t){var n=e.getState(),i=n.bookmarks;if("collection"===n.selectedCategory){var o=t.bookmark.id,a=i.filter((function(e){return e.id!==o}));e.patchState({bookmarks:s(a)})}}},{key:"copyBookmark",value:function(e,t){return ZC(this,void 0,void 0,regeneratorRuntime.mark((function n(){var i,o,a,r,c,s,l,p,d,g,h,f;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i=t.groupAccess,o=t.collection,e.patchState({copying:!0,saving:!0}),n.next=4,this.bookmarksService.copyBookmark(t.id,t.type,t.lang).toPromise().catch((function(n){e.dispatch(new ku(t.id,n))}));case 4:if(r=n.sent){n.next=7;break}return n.abrupt("return",void e.dispatch(new ku(t.id,null)));case 7:return n.next=9,Promise.all([this.storyService.getStory(t.id,t.type).toPromise(),this.storyService.getStory(r,P.Bookmark).toPromise()]);case 9:return c=n.sent,s=u(c,2),l=s[0],p=s[1],d=l.chapters.map((function(e){return e.id})).reduce((function(e,t,n){return e[t]=p.chapters[n].id,e}),{}),g=Object(Oe.mapKeys)(p.tweenParticleLookup,(function(e,t){return d[t]})),p.tweenParticleLookup=g,(h=new $C).title=t.title,h.isOwner=!0,h.id=r,h.index=p,i&&(h.add_group_access=[i]),n.next=24,this.bookmarksService.saveBookmark(h).toPromise();case 24:if(a=n.sent,!i||!o){n.next=29;break}return f=[{content_type:"bookmark",content_id:r}],n.next=29,this.organizationsService.addToCollection(o,f).toPromise();case 29:e.patchState({copying:!1,saving:!1}),e.dispatch(new wu(r,t.id,a));case 30:case"end":return n.stop()}}),n,this)})))}},{key:"setBookmarkText",value:function(e,t){var n=e.getState().selectedBookmark;e.patchState({selectedBookmark:Object.assign(Object.assign({},n),{title:t.title})})}},{key:"setSelectedCategory",value:function(e,t){var n=t.category;e.patchState({selectedCategory:n||null})}},{key:"cancelSaveBookmark",value:function(e,t){e.patchState({saving:!1})}},{key:"cancelCopyBookmark",value:function(e,t){e.patchState({copying:!1})}}],[{key:"getBookmarks",value:function(e){var t=e.bookmarks,n=e.sort,i=n.ascending;return qC(t,n.fields,i)}},{key:"getCheckedBookmarks",value:function(e){return e.checkedBookmarks}},{key:"getSelectedBookmark",value:function(e){return e.selectedBookmark}},{key:"getLoading",value:function(e){return e.loading}},{key:"getExporting",value:function(e){return e.exporting}},{key:"getSaving",value:function(e){return e.saving}},{key:"getCopying",value:function(e){return e.copying}},{key:"getSort",value:function(e){return e.sort}},{key:"getSelectedCategory",value:function(e){return e.selectedCategory}}]),e}()).\u0275fac=function(e){return new(e||WC)(_.Zb(L.g),_.Zb(L.b),_.Zb(kk),_.Zb(tc),_.Zb(mk),_.Zb(NC),_.Zb(BC),_.Zb(Ys.b))},WC.\u0275prov=_.Lb({token:WC,factory:WC.\u0275fac}),KC([Object(L.a)(Hp),GC("design:type",Function),GC("design:paramtypes",[Object,Hp]),GC("design:returntype",void 0)],WC.prototype,"loadBookmarks",null),KC([Object(L.a)(Bp),GC("design:type",Function),GC("design:paramtypes",[Object,Bp]),GC("design:returntype",void 0)],WC.prototype,"loadOrganizationBookmarks",null),KC([Object(L.a)(Qp),GC("design:type",Function),GC("design:paramtypes",[Object,Qp]),GC("design:returntype",void 0)],WC.prototype,"loadCollectionBookmarks",null),KC([Object(L.a)($p),GC("design:type",Function),GC("design:paramtypes",[Object,$p]),GC("design:returntype",void 0)],WC.prototype,"loadSuccess",null),KC([Object(L.a)(qp),GC("design:type",Function),GC("design:paramtypes",[Object,qp]),GC("design:returntype",void 0)],WC.prototype,"loadBookmark",null),KC([Object(L.a)(Wp),GC("design:type",Function),GC("design:paramtypes",[Object,Wp]),GC("design:returntype",void 0)],WC.prototype,"selectBookmarkSuccess",null),KC([Object(L.a)(Jp),GC("design:type",Function),GC("design:paramtypes",[Object,Jp]),GC("design:returntype",Promise)],WC.prototype,"saveBookmark",null),KC([Object(L.a)(Xp),GC("design:type",Function),GC("design:paramtypes",[Object,Xp]),GC("design:returntype",void 0)],WC.prototype,"saveBookmarkSuccess",null),KC([Object(L.a)(Kp),GC("design:type",Function),GC("design:paramtypes",[Object,Kp]),GC("design:returntype",void 0)],WC.prototype,"deleteBookmark",null),KC([Object(L.a)(Gp),GC("design:type",Function),GC("design:paramtypes",[Object,Gp]),GC("design:returntype",void 0)],WC.prototype,"deleteBookmarkSuccess",null),KC([Object(L.a)([Zp,iu]),GC("design:type",Function),GC("design:paramtypes",[Object,Object]),GC("design:returntype",void 0)],WC.prototype,"deleteFail",null),KC([Object(L.a)(tu),GC("design:type",Function),GC("design:paramtypes",[Object,tu]),GC("design:returntype",void 0)],WC.prototype,"deleteFavorite",null),KC([Object(L.a)(nu),GC("design:type",Function),GC("design:paramtypes",[Object,nu]),GC("design:returntype",void 0)],WC.prototype,"deleteFavoriteSuccess",null),KC([Object(L.a)(cu),GC("design:type",Function),GC("design:paramtypes",[Object,cu]),GC("design:returntype",void 0)],WC.prototype,"sortBookmarks",null),KC([Object(L.a)(ru),GC("design:type",Function),GC("design:paramtypes",[Object,ru]),GC("design:returntype",void 0)],WC.prototype,"clearBookmarks",null),KC([Object(L.a)(au),GC("design:type",Function),GC("design:paramtypes",[Object,au]),GC("design:returntype",void 0)],WC.prototype,"resetBookmarks",null),KC([Object(L.a)(su),GC("design:type",Function),GC("design:paramtypes",[Object,su]),GC("design:returntype",void 0)],WC.prototype,"checkBookmark",null),KC([Object(L.a)(lu),GC("design:type",Function),GC("design:paramtypes",[Object,lu]),GC("design:returntype",void 0)],WC.prototype,"setCheckedBookmarks",null),KC([Object(L.a)(ou),GC("design:type",Function),GC("design:paramtypes",[Object,ou]),GC("design:returntype",void 0)],WC.prototype,"saveBookmarkThumbnails",null),KC([Object(L.a)(pu),GC("design:type",Function),GC("design:paramtypes",[Object,pu]),GC("design:returntype",void 0)],WC.prototype,"exportBookmarks",null),KC([Object(L.a)(gu),GC("design:type",Function),GC("design:paramtypes",[Object,gu]),GC("design:returntype",void 0)],WC.prototype,"updateBookmarkCollection",null),KC([Object(L.a)(mu),GC("design:type",Function),GC("design:paramtypes",[Object,mu]),GC("design:returntype",void 0)],WC.prototype,"removeBookmarkCollectionSuccess",null),KC([Object(L.a)(xu),GC("design:type",Function),GC("design:paramtypes",[Object,xu]),GC("design:returntype",Promise)],WC.prototype,"copyBookmark",null),KC([Object(L.a)(Cu),GC("design:type",Function),GC("design:paramtypes",[Object,Cu]),GC("design:returntype",void 0)],WC.prototype,"setBookmarkText",null),KC([Object(L.a)(Su),GC("design:type",Function),GC("design:paramtypes",[Object,Su]),GC("design:returntype",void 0)],WC.prototype,"setSelectedCategory",null),KC([Object(L.a)(eu),GC("design:type",Function),GC("design:paramtypes",[Object,eu]),GC("design:returntype",void 0)],WC.prototype,"cancelSaveBookmark",null),KC([Object(L.a)(Ou),GC("design:type",Function),GC("design:paramtypes",[Object,Ou]),GC("design:returntype",void 0)],WC.prototype,"cancelCopyBookmark",null),KC([Object(L.e)(),GC("design:type",Function),GC("design:paramtypes",[SC]),GC("design:returntype",void 0)],WC,"getBookmarks",null),KC([Object(L.e)(),GC("design:type",Function),GC("design:paramtypes",[SC]),GC("design:returntype",void 0)],WC,"getCheckedBookmarks",null),KC([Object(L.e)(),GC("design:type",Function),GC("design:paramtypes",[SC]),GC("design:returntype",void 0)],WC,"getSelectedBookmark",null),KC([Object(L.e)(),GC("design:type",Function),GC("design:paramtypes",[SC]),GC("design:returntype",void 0)],WC,"getLoading",null),KC([Object(L.e)(),GC("design:type",Function),GC("design:paramtypes",[SC]),GC("design:returntype",void 0)],WC,"getExporting",null),KC([Object(L.e)(),GC("design:type",Function),GC("design:paramtypes",[SC]),GC("design:returntype",void 0)],WC,"getSaving",null),KC([Object(L.e)(),GC("design:type",Function),GC("design:paramtypes",[SC]),GC("design:returntype",void 0)],WC,"getCopying",null),KC([Object(L.e)(),GC("design:type",Function),GC("design:paramtypes",[SC]),GC("design:returntype",void 0)],WC,"getSort",null),KC([Object(L.e)(),GC("design:type",Function),GC("design:paramtypes",[SC]),GC("design:returntype",void 0)],WC,"getSelectedCategory",null),WC=KC([Object(L.f)({name:"bookmarks",defaults:JC})],WC)),YC=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function eS(e,t){if(1&e){var n=_.Wb();_.Vb(0,"div",1),_.Vb(1,"app-message-toggle",2),_.cc("handleDismiss",(function(){return _.zc(n),_.gc().handleDismiss()})),_.Vb(2,"div"),_.Mc(3," This model is not optimized for use on mobile devices. For an optimal experience, please switch to a desktop device or try our Anatomy by Regions. "),_.Ub(),_.Ub(),_.Ub()}2&e&&(_.Db(1),_.lc("dismiss",!0))}var tS,nS=((tS=function(){function e(t){m(this,e),this.changeRef=t,this.shown=!1,this.ngUnsubscribe=new ge.a}return v(e,[{key:"ngOnInit",value:function(){var e=this;this.bookmark$.pipe(Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){var n=Object(Oe.get)(t,"tags",[]);e.shown=n.includes("complete anatomy"),e.changeRef.markForCheck()}))}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"handleDismiss",value:function(){this.shown=!1,this.changeRef.markForCheck()}}]),e}()).\u0275fac=function(e){return new(e||tS)(_.Pb(_.i))},tS.\u0275cmp=_.Jb({type:tS,selectors:[["app-view-content-warning"]],decls:2,vars:3,consts:[["class","warning",4,"ngIf"],[1,"warning"],["type","warning","toggleStyle","flat","icon","info-circle",3,"dismiss","handleDismiss"]],template:function(e,t){1&e&&(_.Kc(0,eS,4,1,"div",0),_.hc(1,"async")),2&e&&_.lc("ngIf",_.ic(1,1,t.bookmark$)&&t.shown)},directives:[or.l,py],pipes:[or.b],styles:[".warning{position:fixed;top:0;left:0;right:0;z-index:1001}.warning__text{text-align:center;flex:1}"],encapsulation:2,changeDetection:0}),function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);a>3&&r&&Object.defineProperty(t,n,r)}([Object(L.d)(XC.getSelectedBookmark),YC("design:type",he.a)],tS.prototype,"bookmark$",void 0),tS),iS=function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r},oS=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},aS=["engineContainer"],rS=["viewContainer"],cS=["view"],sS=["viewCameraBar"],lS=["viewLogo"],pS=["viewSceneBase"],uS=["viewToolbar"],dS=["drawer"];function gS(e,t){1&e&&_.Qb(0,"app-view-column-container")}function hS(e,t){1&e&&(_.Vb(0,"div",25),_.Qb(1,"app-view-title",26),_.Ub())}function fS(e,t){if(1&e){var n=_.Wb();_.Vb(0,"div",27),_.Vb(1,"app-notification",28),_.cc("closeClick",(function(e){return _.zc(n),_.gc().handleNotificationClose(e)})),_.Ub(),_.Ub()}if(2&e){var i=_.gc();_.Db(1),_.lc("notification",i.notification)}}function bS(e,t){1&e&&(_.Vb(0,"div",29),_.Qb(1,"app-view-undo"),_.Ub())}function vS(e,t){1&e&&_.Qb(0,"app-view-toolbar",30)}function mS(e,t){1&e&&(_.Vb(0,"div",31),_.Qb(1,"app-view-menu",32),_.Ub())}function yS(e,t){if(1&e&&(_.Vb(0,"div",33),_.Qb(1,"app-view-logo",34),_.hc(2,"async"),_.Ub()),2&e){var n=_.gc();_.Db(1),_.lc("logoColor",n.isBackgroundLight?"color":"white")("logoSize",_.ic(2,2,n.breakpoint$)>n.breakpoint.Small?"full":"small")}}function xS(e,t){if(1&e&&_.Qb(0,"app-engine-camera-bar",35),2&e){var n=_.gc();_.lc("showNav",n.cameraVisible)}}function wS(e,t){if(1&e){var n=_.Wb();_.Tb(0),_.Vb(1,"app-view-drawer",36,37),_.cc("offsetYChange",(function(e){return _.zc(n),_.gc().handleDrawerOffsetChange(e)})),_.Ub(),_.Sb()}}function kS(e,t){1&e&&_.Qb(0,"div",38)}function OS(e,t){if(1&e&&(_.Qb(0,"app-view-help",39),_.hc(1,"async")),2&e){var n=_.gc();_.lc("activeTab",_.ic(1,1,n.showHelpTab$))}}function CS(e,t){if(1&e&&_.Qb(0,"app-view-ondemand",40),2&e){var n=_.gc();_.lc("contentId",n.contentId)("contentType",n.contentType)}}function SS(e,t){if(1&e&&(_.Qb(0,"app-view-progress",41),_.hc(1,"async")),2&e){var n=_.gc();_.lc("show",_.ic(1,2,n.viewWindow$)===n.viewWindow.Loader)("percent",n.loadProgress)}}function _S(e,t){if(1&e&&_.Qb(0,"app-play-loader",43),2&e){var n=_.gc(2);_.lc("percent",n.loadProgress)}}function jS(e,t){1&e&&_.Qb(0,"app-button-loader")}function PS(e,t){1&e&&_.Qb(0,"app-hand-loader")}function MS(e,t){if(1&e&&(_.Vb(0,"app-view-loader"),_.Kc(1,_S,1,1,"app-play-loader",42),_.hc(2,"async"),_.Kc(3,jS,1,0,"app-button-loader",3),_.hc(4,"async"),_.Kc(5,PS,1,0,"app-hand-loader",3),_.hc(6,"async"),_.Ub()),2&e){var n=_.gc();_.Db(1),_.lc("ngIf","play"===_.ic(2,3,n.interactType$)),_.Db(2),_.lc("ngIf","button"===_.ic(4,5,n.interactType$)),_.Db(2),_.lc("ngIf","hand"===_.ic(6,7,n.interactType$))}}function IS(e,t){1&e&&_.Qb(0,"app-view-tour")}function zS(e,t){1&e&&_.Qb(0,"app-view-annotate")}function TS(e,t){1&e&&_.Qb(0,"app-view-print")}function US(e,t){1&e&&_.Qb(0,"app-view-content-warning")}var LS,DS,ES=function(e,t,n){return{"view-page--column-in":e,"view-page--column-out":t,"view-page--drawer-push":n}},FS=((DS=function(){function e(t,n,i,o,a,r,c,s,l,p){m(this,e),this.activatedRoute=t,this.renderer=n,this.store=i,this.viewService=o,this.quizService=a,this.changeDetectorRef=r,this.actions=c,this.layoutService=s,this.engineService=l,this.title=p,this.application=j,this.nativePlatform=pl,this.breakpoint=Up,this.viewLayoutStatus=ns,this.viewMode=vp,this.viewUI=Rp,this.viewWindow=Gl,this.columnLayoutStatus=ns.Hide,this.drawerExpandable=!0,this.drawerOpen=!1,this.drawerY=0,this.loadLabel="",this.loadProgress=0,this.chaptersLoaded=0,this.isBackgroundLight=!0,this.selectedChapterLoading=!1,this.viewToolsMode=sf,this.cameraVisible=!1,this.columnVisible=!1,this.drawerVisible=!1,this.logoVisible=!1,this.menuVisible=!1,this.nodeInfoVisible=!1,this.searchVisible=!1,this.titleOnlyVisible=!1,this.toolbarVisible=!1,this.undoVisible=!1,this.ngUnsubscribe=new ge.a,this.audioListening=new ge.a}return v(e,[{key:"ngOnInit",value:function(){this.resetScene();var e=this.viewService.normalizeQueryParams(this.activatedRoute.snapshot.queryParams);this.contentId=e.id,this.contentType=e.type,this.contentLang=e.lang}},{key:"ngAfterViewInit",value:function(){this.initOnDemand(),this.store.dispatch(new na({tag:!0,pin:!1})),this.store.dispatch(new it(!0));var e=this.store.selectSnapshot(hp.getUI).loader.template;this.store.dispatch(new Ke(e===os.Bar)),e!==os.None&&this.store.dispatch(new S.ToggleWindow(Gl.Loader,!0)),this.checkCapabilities(),this.initSizeObservers(),this.initHeaderObserver(),this.initLayoutObserver(),this.initBreakpointObservers(),this.initKeyboardObserver(),this.initLoadProgressObserver(),this.initWindowObserver(),this.initBackgroundColorObserver(),this.initResponsiveLabels(),this.initNodeObserver(),this.initChapterObserver(),this.initAudioObserver(),this.initNotifications(),this.positionRelativeElements(this.drawerY)}},{key:"ngOnDestroy",value:function(){this.store.dispatch(new Me(!1)),this.store.dispatch(new Nc(0,0)),Kc.isFullscreen()&&Kc.exitFullscreen(),this.quizService.exitQuiz(),this.unbindKeyboard(),this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"initOnDemand",value:function(){var e=this;this.onDemand$.pipe(Object(be.a)((function(e){return!e})),Object(bp.a)(1),Object(fe.a)(this.ngUnsubscribe)).subscribe((function(){e.viewService.initStory(e.contentId,e.contentType,e.contentLang)}))}},{key:"checkCapabilities",value:function(){var e=this,t=this.renderer.listen("window","mouseover",(function(){t(),e.store.dispatch(new S.SetCanHover(!0))})),n="ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0;this.store.dispatch(new S.SetCanTouch(n)),this.store.dispatch(new S.SetCanFullscreen(Kc.canFullscreen())),this.store.dispatch(new S.SetInputMode(n?cp.Touch:cp.Mouse))}},{key:"initBreakpointObservers",value:function(){var e=this;this.breakpoint$.pipe(Object(fe.a)(this.ngUnsubscribe)).subscribe((function(){e.handleResize()}))}},{key:"initResponsiveLabels",value:function(){var e=this,t=Object(Ga.a)(window,"resize").pipe(Object(Za.a)(100)),n=this.store.select(hp.getLabelsBreakpoint),i=this.store.select(Pc.getSelectedLabel),o=this.store.select(Pc.getLabelsCollapsed);i.pipe(Object(be.a)((function(){return e.store.selectSnapshot(Pc.getLabelsCollapsed)})),Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){e.viewService.toggleLabelInfo(!!t)})),o.pipe(Object(be.a)((function(){return!!e.store.selectSnapshot(Pc.getSelectedLabel)})),Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){e.viewService.toggleLabelInfo(t)})),Object(Ka.b)(t,n).pipe(Object(be.a)((function(e){var t=u(e,2)[1];return!Object(Oe.isNil)(t)})),Object(fe.a)(this.ngUnsubscribe)).subscribe((function(){e.checkLabelsCollapsed()})),this.checkLabelsCollapsed()}},{key:"initSizeObservers",value:function(){var e=this,t=cf({strategy:"scroll"});Object(Ga.a)(window,"resize").pipe(Object(Za.a)(10),Object(fe.a)(this.ngUnsubscribe)).subscribe((function(){e.updateViewHeight(),e.refreshLayout()})),new he.a((function(n){t.listenTo(e.engineContainer.nativeElement,(function(){n.next()}))})).pipe(Object(Za.a)(10)).subscribe((function(){e.resizeEngineContainer()}))}},{key:"initHeaderObserver",value:function(){var e=this;this.store.select(Lu.getSiteHeader).pipe(Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){e.updateViewHeight()}))}},{key:"initLayoutObserver",value:function(){var e=this;this.layout$.pipe(Object(be.a)((function(e){return null!=e})),Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){e.refreshLayout()}))}},{key:"initKeyboardObserver",value:function(){var e=this;this.inputEnabled$.pipe(Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){t?e.bindKeyboard():e.unbindKeyboard()}))}},{key:"initNodeObserver",value:function(){var e=this;this.actions.pipe(Object(L.j)(Ne),Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){e.viewService.delegateNodeClick(t.node,t.event)})),this.store.select(Fi.getSelectedNode).pipe(Object(er.a)(),Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){var n=u(t,2),i=n[0],o=n[1],a=Object(Oe.get)(i,"objectId",void 0),r=Object(Oe.get)(o,"objectId",void 0);void 0!==o&&a===r||e.viewService.toggleNodeInfo(!1)}))}},{key:"initChapterObserver",value:function(){var e=this;this.store.select(Ua.getSelectedChapterId).pipe(Object(be.a)((function(e){return null!=e})),Object(K.a)((function(){return e.store.selectSnapshot(Ua.getSelectedChapter)})),Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){e.viewService.initChapter(t),e.setPageTitle(t),e.refreshLayout()}))}},{key:"initLoadProgressObserver",value:function(){var e=this;this.store.select(Th.getChunkLoadProgress).pipe(Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){e.loadProgress=100*t,e.engineService.fireEvent(Lt.HumanProgress,{progress:e.loadProgress}),e.changeDetectorRef.markForCheck(),e.checkShowLoader()})),this.store.select(Rc.getLoadingChunk).pipe(Object(be.a)((function(){return e.loadProgress>0})),Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){null!==t&&t.chapterId===e.store.selectSnapshot(Ua.getSelectedChapterId)||z.offline?e.store.dispatch(new S.ToggleWindow(Gl.Loader,!0)):(e.engineService.enableRender(),e.store.dispatch(new S.ToggleWindow(Gl.Loader,!1)),setTimeout((function(){e.engineService.enableAnimation()}),500))})),this.actions.pipe(Object(L.i)(Ur),Object(fe.a)(this.ngUnsubscribe)).subscribe((function(){0===e.store.selectSnapshot(Rc.getLoadChunksRemaining).length&&(e.store.dispatch(new S.ToggleWindow(Gl.Loader,!1)),z.offline)&&setTimeout((function(){e.engineService.enableAnimation()}),1750)}))}},{key:"checkShowLoader",value:function(){if(this.store.selectSnapshot(Ua.getSelectedChapterIndex)>0){var e=this.store.selectSnapshot(Ua.getSelectedChapterId),t=this.store.selectSnapshot(Rc.getLoadingChunk);null!==t&&e===t.chapterId&&this.store.dispatch(new S.ToggleWindow(Gl.Loader,!0))}}},{key:"initWindowObserver",value:function(){var e=this;this.viewWindow$.pipe(Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){e.viewService.resetLayout(),t===Gl.Tutorial?(e.viewService.resetChapter(),e.viewService.toggleLabels(!1)):e.viewService.toggleLabels(!0)}))}},{key:"initBackgroundColorObserver",value:function(){var e=this;this.background$.pipe(Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){if(t.colors){var n=t.colors.slice(0,3);e.isBackgroundLight=ba.isLight([n[0],n[1],n[2]]),e.changeDetectorRef.markForCheck()}}))}},{key:"initAudioObserver",value:function(){var e=this,t=Object($a.a)(this.ngUnsubscribe,this.audioListening),n=this.viewWindow$.pipe(Object(K.a)((function(e){return e===Gl.Tutorial||e===Gl.Interact})),Object(be.a)((function(e){return e})),Object(bp.a)(1));Object(Ka.b)(this.viewWindow$,n,this.audio$).pipe(Object(be.a)((function(e){var t=u(e,1)[0];return Object(Oe.isNil)(t)})),Object(fe.a)(t)).subscribe((function(t){var n=u(t,3),i=n[1],o=n[2];i?Object(Oe.isNil)(o)||e.playAudio():e.stopAudioListening()}))}},{key:"initNotifications",value:function(){this.notification=new _m("Welcome! Learn how to navigate and interact with this model in 3D.","Launch Tutorial")}},{key:"handleNotificationClose",value:function(e){var t=e.action;"Launch Tutorial"===t&&this.viewService.toggleTutorial(!0),t||this.store.dispatch(new S.TutorialSeen(!0))}},{key:"stopAudioListening",value:function(){this.audioListening.next(),this.audioListening.complete()}},{key:"playAudio",value:function(){this.store.dispatch(new tt(!0)),this.stopAudioListening()}},{key:"handleColumnToggle",value:function(){this.viewService.toggleColumn(),this.changeDetectorRef.markForCheck()}},{key:"handleDrawerOffsetChange",value:function(e){this.drawerY=e,this.drawerOpen=-64!==e,this.positionRelativeElements(this.drawerY)}},{key:"checkLabelsCollapsed",value:function(){var e=this.store.selectSnapshot(Ap.getBreakpoint),t=this.store.selectSnapshot(hp.getLabelsBreakpoint),n=this.isLabelBreaking(t);this.store.dispatch(new ta(n,e>=Up.Large?Eo.Toggle:Eo.None))}},{key:"isLabelBreaking",value:function(e){return window.innerWidth<e}},{key:"bindKeyboard",value:function(){var e=this;rf.bind("1",(function(){return e.viewService.selectTool(Aa.Select)})),rf.bind("2",(function(){return e.viewService.selectTool(Aa.Hide)})),rf.bind("3",(function(){return e.viewService.selectTool(Aa.Fade)})),rf.bind(["command+,","ctrl+,"],(function(t){t.preventDefault(),e.store.selectSnapshot(Ap.getBreakpoint)>Up.Medium?e.viewService.toggleColumn():e.drawer.toggleDrawer(),e.changeDetectorRef.markForCheck()})),rf.bind(["command+enter","ctrl+enter","command+p"],(function(e){e.preventDefault(),Kc.toggleFullscreen()})),rf.bind("meta+z",(function(t){t.preventDefault(),e.viewService.undo()})),rf.bind(["meta+y","meta+shift+z"],(function(t){t.preventDefault(),e.viewService.redo()})),rf.bind([".","pagedown"],(function(){return e.viewService.nextChapter("Keyboard")})),rf.bind([",","pageup"],(function(){return e.viewService.previousChapter("Keyboard")})),rf.bind(["del","backspace"],(function(t){t.preventDefault(),e.viewService.hideSelectedStructures()})),rf.bind("R",(function(t){t.preventDefault(),e.viewService.resetChapter()})),rf.bind("/",(function(){return e.viewService.toggleSearch()})),rf.bind("?",(function(){return e.viewService.toggleHelp()})),rf.bind("space",(function(t){t.preventDefault(),e.viewService.toggleAnimation()}))}},{key:"unbindKeyboard",value:function(){rf.reset()}},{key:"resizeEngineContainer",value:function(){var e=this.engineContainer.nativeElement.getBoundingClientRect(),t=e.top,n=e.left,i=e.width,o=e.height,a=new Vt(n,t,i,o,Ht.Shown);this.store.dispatch(new st(a))}},{key:"updateViewHeight",value:function(){var e=this.viewService.getVH(z.application!==j.Viewer);this.view.nativeElement.style.setProperty("--vh",e+"px")}},{key:"handleResize",value:function(){this.viewService.resetLayout()}},{key:"resetScene",value:function(){var e=this;this.store.dispatch(new Me(!0)),this.store.dispatch(new Te(!1)),this.store.dispatch(new Ze(Aa.Select)),this.engineService.getEvent(Lt.AssetsLoadProgress).pipe(Object(bp.a)(1),Object(fe.a)(this.ngUnsubscribe)).subscribe((function(){e.store.dispatch(new Te(!0))}))}},{key:"refreshLayout",value:function(){var e=this,t=this.store.selectSnapshot(hp.getUI);this.columnLayoutStatus=t.column.status,this.cameraVisible=this.layoutService.isVisible(Rp.Camera),this.columnVisible=this.layoutService.isVisible(Rp.Column),this.drawerVisible=this.layoutService.isVisible(Rp.Drawer),this.logoVisible=this.layoutService.isVisible(Rp.Logo),this.menuVisible=this.layoutService.isVisible(Rp.Menu),this.nodeInfoVisible=this.layoutService.isVisible(Rp.NodeInfo),this.searchVisible=this.layoutService.isVisible(Rp.Search),this.titleOnlyVisible=this.layoutService.isVisible(Rp.TitleOnly),this.toolbarVisible=this.layoutService.isVisible(Rp.Toolbar),this.undoVisible=this.layoutService.isVisible(Rp.Undo),this.updateViewHeight(),this.resizeEngineContainer(),this.store.dispatch(new Xo(!1!==t.anatomyLabels.enable,!1!==t.nodeInfo.enable,!0)),this.store.dispatch(new Ge(!1!==t.labels.enable)),setTimeout((function(){e.drawer?e.positionRelativeElements(e.drawerY):e.positionRelativeElements(),e.changeDetectorRef.markForCheck()}))}},{key:"positionRelativeElements",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.store.selectSnapshot(Ap.getBreakpoint),null!=this.viewCameraBar&&this.cameraVisible&&this.renderer.setStyle(this.viewCameraBar.nativeElement,"transform","translate3d(-4px, ".concat(this.menuVisible?-64:0,"px, 0)")),this.renderer.setStyle(this.viewToolbar.nativeElement,"transform","translate3d(-8px, 0, 0)"),this.renderer.setStyle(this.viewSceneBase.nativeElement,"transform","translate3d(0, -8px, 0)"),this.renderer.setStyle(this.view.nativeElement,"padding-bottom",-e+"px")}},{key:"isVisible",value:function(e){return this.layoutService.isVisible(e)}},{key:"isEnabled",value:function(e){return this.layoutService.isUIEnabled(e)}},{key:"setPageTitle",value:function(e){var t=Object(Oe.get)(e,"info.displayName");this.title.setTitle((t?t+" | ":"")+"BioDigital Human Platform")}}]),e}()).\u0275fac=function(e){return new(e||DS)(_.Pb(we.a),_.Pb(_.H),_.Pb(L.g),_.Pb(Bu),_.Pb(lf),_.Pb(_.i),_.Pb(L.b),_.Pb(Vp),_.Pb(Nt),_.Pb(T.c))},DS.\u0275cmp=_.Jb({type:DS,selectors:[["app-view-page"]],viewQuery:function(e,t){var n;1&e&&(_.Gc(aS,!0),_.Gc(rS,!0),_.Gc(cS,!0),_.Rc(sS,!0),_.Rc(lS,!0),_.Gc(pS,!0),_.Rc(uS,!0),_.Rc(dS,!0,Sm)),2&e&&(_.uc(n=_.dc())&&(t.engineContainer=n.first),_.uc(n=_.dc())&&(t.viewContainer=n.first),_.uc(n=_.dc())&&(t.view=n.first),_.uc(n=_.dc())&&(t.viewCameraBar=n.first),_.uc(n=_.dc())&&(t.viewLogo=n.first),_.uc(n=_.dc())&&(t.viewSceneBase=n.first),_.uc(n=_.dc())&&(t.viewToolbar=n.first),_.uc(n=_.dc())&&(t.drawer=n.first))},decls:45,vars:47,consts:[["viewContainer",""],[1,"view-page",3,"ngClass"],["view",""],[4,"ngIf"],["class","view-page__title-only",4,"ngIf"],[1,"view-page__engine"],["engineContainer",""],["class","view-page__notifications",4,"ngIf"],["class","view-page__undo",4,"ngIf"],[1,"view-page__column-toggle"],[1,"view-page__scene-base"],["viewSceneBase",""],[1,"view-page__toolbar"],["viewToolbar",""],["position","right",4,"ngIf"],["class","view-page__menu",4,"ngIf"],["class","view-page__logo",4,"ngIf"],[1,"view-page__camera-bar"],["viewCameraBar",""],[3,"showNav",4,"ngIf"],["class","view-block-input",4,"ngIf"],[3,"activeTab",4,"ngIf"],[3,"contentId","contentType",4,"ngIf"],[3,"show","percent",4,"ngIf"],[4,"appFlagApplication","appFlagApplicationMode","appFlagApplicationNative"],[1,"view-page__title-only"],["layout","column"],[1,"view-page__notifications"],[3,"notification","closeClick"],[1,"view-page__undo"],["position","right"],[1,"view-page__menu"],[1,"ml-4"],[1,"view-page__logo"],[3,"logoColor","logoSize"],[3,"showNav"],[3,"offsetYChange"],["drawer",""],[1,"view-block-input"],[3,"activeTab"],[3,"contentId","contentType"],[3,"show","percent"],[3,"percent",4,"ngIf"],[3,"percent"]],template:function(e,t){if(1&e&&(_.Vb(0,"div",null,0),_.Vb(2,"div",1,2),_.Kc(4,gS,1,0,"app-view-column-container",3),_.Qb(5,"app-view-menu-column"),_.Kc(6,hS,2,0,"div",4),_.hc(7,"async"),_.Vb(8,"div",5,6),_.Kc(10,fS,2,1,"div",7),_.hc(11,"async"),_.hc(12,"async"),_.Kc(13,bS,2,0,"div",8),_.Vb(14,"div",9),_.Qb(15,"app-view-column-toggle"),_.Ub(),_.Vb(16,"div",10,11),_.Vb(18,"div",12,13),_.Kc(20,vS,1,0,"app-view-toolbar",14),_.Ub(),_.Kc(21,mS,2,0,"div",15),_.Kc(22,yS,3,4,"div",16),_.Vb(23,"div",17,18),_.Kc(25,xS,1,1,"app-engine-camera-bar",19),_.Ub(),_.Ub(),_.Kc(26,wS,3,0,"ng-container",3),_.Ub(),_.Ub(),_.Ub(),_.Kc(27,kS,1,0,"div",20),_.hc(28,"async"),_.Kc(29,OS,2,3,"app-view-help",21),_.hc(30,"async"),_.Kc(31,CS,1,2,"app-view-ondemand",22),_.hc(32,"async"),_.Kc(33,SS,2,4,"app-view-progress",23),_.hc(34,"async"),_.Kc(35,MS,7,9,"app-view-loader",3),_.hc(36,"async"),_.Kc(37,IS,1,0,"app-view-tour",3),_.hc(38,"async"),_.Kc(39,zS,1,0,"app-view-annotate",3),_.hc(40,"async"),_.Kc(41,TS,1,0,"app-view-print",3),_.hc(42,"async"),_.Kc(43,US,1,0,"app-view-content-warning",24),_.Qb(44,"app-view-iphone12-warning")),2&e){var n,i,o=null;_.Db(2),_.lc("ngClass",_.qc(43,ES,t.columnVisible,!t.columnVisible,t.drawerVisible)),_.Db(2),_.lc("ngIf",t.columnVisible||t.searchVisible||t.nodeInfoVisible),_.Db(2),_.lc("ngIf",t.titleOnlyVisible&&(null==(o=_.ic(7,21,t.chapter$))?null:o.info.displayName)),_.Db(4),_.lc("ngIf",(null==(n=_.ic(11,23,t.selectedChapterReady$))?null:n.model)&&!_.ic(12,25,t.tutorialSeen$)),_.Db(3),_.lc("ngIf",t.undoVisible),_.Db(7),_.lc("ngIf",t.toolbarVisible),_.Db(1),_.lc("ngIf",t.menuVisible),_.Db(1),_.lc("ngIf",t.logoVisible),_.Db(3),_.lc("ngIf",t.cameraVisible),_.Db(1),_.lc("ngIf",t.drawerVisible),_.Db(1),_.lc("ngIf",!_.ic(28,27,t.inputEnabled$)),_.Db(2),_.lc("ngIf",_.ic(30,29,t.viewWindow$)===t.viewWindow.Help),_.Db(2),_.lc("ngIf",_.ic(32,31,t.viewWindow$)===t.viewWindow.OnDemand),_.Db(2),_.lc("ngIf","circle"===(null==(i=_.ic(34,33,t.layout$))?null:i.loader.template)),_.Db(2),_.lc("ngIf",_.ic(36,35,t.viewWindow$)===t.viewWindow.Interact),_.Db(2),_.lc("ngIf",_.ic(38,37,t.viewWindow$)===t.viewWindow.Tutorial),_.Db(2),_.lc("ngIf",_.ic(40,39,t.viewWindow$)===t.viewWindow.Whiteboard),_.Db(2),_.lc("ngIf",_.ic(42,41,t.usePrintImage$)),_.Db(2),_.lc("appFlagApplication",t.application.All)("appFlagApplicationMode","include")("appFlagApplicationNative",t.nativePlatform.All)}},directives:[or.i,or.l,Xm,ay,ul,my,Vy,$f,$y,lx,pw,Mw,Vm,Aw,Sm,rk,jk,Ak,Vk,qk,_k,Wk,$O,kC,CC,nS],pipes:[or.b],styles:[".view-page{border:var(--view-page-border);width:100vw;height:100vh;height:calc(var(--vh, 1vh) * 100);max-height:100vh;overflow:hidden;transition:padding-left .25s,padding-bottom .3s}.view-page--column-in{padding-left:320px}.view-page--column-out{padding-left:0}.view-page--drawer-push{padding-bottom:64px}.view-page__column{height:100%}.view-page__column-toggle{position:absolute;top:50%;margin-top:-18px;left:0;z-index:10}.view-page__engine{width:100%;height:100%;position:relative}.view-page__menu{position:absolute;right:8px;bottom:0;z-index:30}.view-page__camera-bar{position:absolute;bottom:0;right:4px;z-index:20}.view-page__logo{display:inline-block;position:absolute;left:16px;bottom:0;z-index:10}.view-page__media-bar{position:absolute;left:50%;margin-left:-100px;width:200px;bottom:0;z-index:10;justify-content:center}.view-page__media-bar:not([hidden]){display:flex}.view-page__notifications{position:absolute;top:12px;right:12px;z-index:20}.view-page__title-only{position:absolute;top:8px;left:8px;max-width:304px;z-index:10;padding:12px;border-radius:4px;background:hsla(0,0%,100%,.8);box-shadow:1px -1px 2px 0 rgba(28,42,63,.1),0 1px 2px 0 rgba(28,42,63,.3);color:#131c2a;background-color:var(--view-title-background);box-shadow:var(--view-title-shadow)}.view-page__scene-base{position:absolute;left:0;bottom:0;right:0;z-index:10;transition:transform .3s}.view-page__toolbar{position:absolute;display:inline-block;z-index:20;bottom:0;right:64px;transition:transform .25s}.view-page__undo{position:absolute;display:flex;justify-content:center;pointer-events:none;left:0;z-index:10;width:100%}.view-block-input{position:fixed;top:0;bottom:0;left:0;right:0;z-index:10000}"],encapsulation:2,changeDetection:0}),iS([Object(L.d)(hp.getUI),oS("design:type",he.a)],DS.prototype,"layout$",void 0),iS([Object(L.d)(hp.getInputEnabled),oS("design:type",he.a)],DS.prototype,"inputEnabled$",void 0),iS([Object(L.d)(hp.getFullscreenActive),oS("design:type",he.a)],DS.prototype,"fullscreenActive$",void 0),iS([Object(L.d)(hp.getDrawerCoversContent),oS("design:type",he.a)],DS.prototype,"drawerCoversContent$",void 0),iS([Object(L.d)(hp.getInteractType),oS("design:type",he.a)],DS.prototype,"interactType$",void 0),iS([Object(L.d)(hp.getOnDemand),oS("design:type",he.a)],DS.prototype,"onDemand$",void 0),iS([Object(L.d)(hp.getShowHelpTab),oS("design:type",he.a)],DS.prototype,"showHelpTab$",void 0),iS([Object(L.d)(hp.getUsePrintImage),oS("design:type",he.a)],DS.prototype,"usePrintImage$",void 0),iS([Object(L.d)(hp.getOpenWindow),oS("design:type",he.a)],DS.prototype,"viewWindow$",void 0),iS([Object(L.d)(hp.getTutorialSeen),oS("design:type",he.a)],DS.prototype,"tutorialSeen$",void 0),iS([Object(L.d)(Th.getStoryLoadProgress),oS("design:type",he.a)],DS.prototype,"loadProgress$",void 0),iS([Object(L.d)(Ap.getBreakpoint),oS("design:type",he.a)],DS.prototype,"breakpoint$",void 0),iS([Object(L.d)(Ua.getSelectedChapter),oS("design:type",he.a)],DS.prototype,"chapter$",void 0),iS([Object(L.d)(Ua.getSelectedChapterReadyState),oS("design:type",he.a)],DS.prototype,"selectedChapterReady$",void 0),iS([Object(L.d)(Ua.getChaptersLoaded),oS("design:type",he.a)],DS.prototype,"chaptersLoaded$",void 0),iS([Object(L.d)(Ua.getSelectedChapterBackground),oS("design:type",he.a)],DS.prototype,"background$",void 0),iS([Object(L.d)(Ua.getSelectedChapterAudio),oS("design:type",he.a)],DS.prototype,"audio$",void 0),DS),AS=((LS=function(){function e(){m(this,e)}return v(e,[{key:"resolve",value:function(e){var t=Object.assign({},e.queryParams);return Cp(Object.keys(t).reduce((function(e,n){var i=Array.isArray(t[n]);return e[n]=i?Object(Oe.last)(t[n]):t[n],e}),{}))}}]),e}()).\u0275fac=function(e){return new(e||LS)},LS.\u0275prov=_.Lb({token:LS,factory:LS.\u0275fac}),LS),RS=h("l5mm"),NS=h("eNwd");function VS(e){var t=e.procName,n=e.actionFn,i=e.aliases,o=void 0===i?[]:i,a=e.mapFnIn,r=e.mapFnOut,c=e.hideDefinition,l=void 0!==c&&c,p=function(e){var t=this,i=a?a(e):e,o=n(i);if(void 0!==o)if(o instanceof he.a)o.subscribe((function(e){var n=r?r(e):e;t.setResult(n)}));else{var c=r?r(o):o;t.setResult(c)}};[t].concat(s(o)).forEach((function(e){var t=function(){return Human.rpc.define(e,p)};l?Human.rpc.hideDefinitions((function(){return t()})):t()}))}var HS=function(e){return e.AnnotationsCreate="annotations.create",e.AnnotationsDestroy="annotations.destroy",e.AnnotationsInfo="annotations.info",e.AnnotationsSetDescription="annotations.setDescription",e.AnnotationsSetLabelsShown="annotations.setLabelsShown",e.AnnotationsSetTitle="annotations.setTitle",e.AnnotationsUpdate="annotations.update",e.AnnotationsSetEnabled="annotations.setEnabled",e.CameraInfo="camera.info",e.CameraOrbit="camera.orbit",e.CameraPan="camera.pan",e.CameraReset="camera.reset",e.CameraSet="camera.set",e.CameraZoom="camera.zoom",e.GetAnnotationInfo="annotations.info",e.HideAnnotations="annotations.hide",e.HotspotsCreate="hotspots.create",e.HotspotsDestroy="hotspots.destroy",e.HotspotsHide="hotspots.hide",e.HotspotsInfo="hotspots.info",e.HotspotsShow="hotspots.show",e.HotspotsTypes="hotspots.types",e.HotspotsUpdate="hotspots.update",e.HumanInfo="human.info",e.InputDisable="input.disable",e.InputEnable="input.enable",e.LabelsCreate="labels.create",e.LabelsDestroy="labels.destroy",e.LabelsInfo="labels.info",e.LabelsHide="labels.hide",e.LabelsSetEnabled="labels.setEnabled",e.LabelsShow="labels.show",e.LabelsUpdate="labels.update",e.LabelsCanvasUpdate="labels.canvasUpdate",e.LabelsSetScale="labels.setScale",e.QuizInfo="quiz.info",e.QuizEnter="quiz.enter",e.QuizExit="quiz.exit",e.QuizQuestion="quiz.currentQuestion",e.QuizSubmit="quiz.submit",e.QuizNextQuestion="quiz.next",e.QuizPreviousQuestion="quiz.previous",e.QuizSelectQuestion="quiz.select",e.QuizSet="quiz.set",e.QuizReset="quiz.reset",e.SceneMetaData="scene.metadata",e.SceneSetHighlightColor="scene.setHighlightColor",e.SceneColorObject="scene.colorObject",e.SceneDisableHighlight="scene.disableHighlight",e.SceneEnableHighlight="scene.enableHighlight",e.SceneGetColor="scene.getColor",e.SceneInfo="scene.info",e.SceneLoad="scene.load",e.ScenePick="scene.pick",e.SceneReset="scene.reset",e.SceneSelectObjects="scene.selectObjects",e.SceneShowObjects="scene.showObjects",e.SceneTransformObject="scene.transformObject",e.SceneUncolorObject="scene.uncolorObject",e.SceneSnapshot="scene.snapshot",e.SceneCapture="scene.capture",e.SceneRestore="scene.restore",e.SceneEnableXrayMode="scene.enableXray",e.SceneDisableXrayMode="scene.disableXray",e.SceneSetLayersSliderPosition="scene.setLayersSliderPosition",e.SceneGetLayers="scene.getLayers",e.SceneSetBaseDirectory="scene.setBaseDirectory",e.ShowAnnotations="annotations.show",e.SetAnnotationsShown="annotations.setShown",e.TimelineInfo="timeline.info",e.TimelineQuery="timeline.query",e.TimelineNext="timeline.nextChapter",e.TimelinePause="timeline.pause",e.TimelinePlay="timeline.play",e.TimelinePrev="timeline.previousChapter",e.TimelineSet="timeline.set",e.UIGetBackground="ui.getBackground",e.UIGetDisplay="ui.getDisplay",e.UIGetWorldPosition="ui.getWorldPosition",e.UISetBackground="ui.setBackground",e.UISetDisplay="ui.setDisplay",e.UIResetDisplay="ui.resetDisplay",e.UISnapshot="ui.snapshot",e.focusObject="focus.focusObject",e.dissectSetEnabled="dissect.setEnabled",e.pickSingleSetEnabled="pick.single.setEnabled",e.pickMultiSetEnabled="pick.multi.setEnabled",e.getCanvasPos="scene.getCanvasPos",e.sceneSetClickMode="scene.setClickMode",e.sceneGetClickMode="scene.getClickMode",e.IsolateObject="scene.isolateObject",e.setCameraMode="camera.setCameraMode",e.UISetOndemand="ui.setOndemand",e.UISetLoadingExperience="ui.setLoadingExperience",e.UISetScrollCaptureMode="ui.setScrollCaptureMode",e.UISetTutorial="ui.setTutorial",e}({});function BS(e){var t=e.captureCamera();return{position:t.lookAt.eye,target:t.lookAt.look,up:t.lookAt.up,zoom:t.zoom}}var QS,qS,WS=h("SxV6");function $S(e){if(!e)return null;var t=e.objectId,n=e.canvasPos,i=e.worldPos;return{objectId:t||void 0,canvasPosition:n?{x:n[0],y:n[1]}:void 0,mode:"query",position:i?{x:i[0],y:i[1],z:i[2]}:void 0}}function KS(e,t){var n=Human.scene.objects[t].parent;return null!==n&&(e[n.objectId].checked||KS(e,n.objectId))}function GS(e,t){var n=t.includes("/")?P.Module:P.Bookmark;e.dispatch(new Sr(t,n))}function ZS(e,t){return e.dispatch(new Fe(!0)),t.fireEvent(Lt.SceneXrayEnabled,void 0),!0}function JS(e,t,n){Human.rpc.defineEvent(e,{events:t||[e],map:n||function(e){return e}})}(QS||(QS={})).getCanvasPos=function(e,t,n,i,o){n&&Yk.a.add(t,n,t);var a=e.renderer.getViewMat(),r=e.renderer.getProjMat(),c=Yk.b.create();Yk.a.transformMat4(c,t,a),c[3]=1,Yk.b.transformMat4(c,c,r);var s=c[1],l=c[3];return[Math.round((1+c[0]/l)*i/2),Math.round((1-s/l)*o/2)]},function(e){e.isLegacyCaptureFormat=function(e){return void 0!==e.engineVersion},e.convertCaptureFormat=function(e){var t=Object.keys(e.objects).reduce((function(e,t){return e.push({objectId:t,selected:!1,hidden:!1}),e}),[]);return{storyId:e.timeline.rootName.replace(".json",""),camera:{lookAt:e.camera,zoom:void 0},labels:[],objects:t,background:[],activeChapterId:e.timeline.scrub?e.timeline.scrub.chapterId:void 0}}}(qS||(qS={}));var XS=h("I65S");function YS(e){return e.selectSnapshot(Pc.getChapterLabels)}function e_(e,t){return function(e,t){return e.find((function(e){return t===e.id}))}(YS(e),t)}function t_(e,t){var n=function(e,t){return e.scene.markers.markers[t]}(e,t.id);return{annotationId:t.id,objectId:t.objectId||null,title:t.title,description:t.description,shown:t.shown,occludable:t.occludable,position:n?{x:n.pos[0],y:n.pos[1],z:n.pos[2]}:null,canvasPosition:n?{x:n.canvasPos[0],y:n.canvasPos[1]}:null}}function n_(e,t){var n=e_(e,t.annotationId);return n?Object.assign(Object.assign({},n),t):null}function i_(e,t){return t&&e.dispatch(new Wo(t)),!0}function o_(e,t){return e.dispatch(new ea(t)),!0}function a_(e,t){return e.reduce((function(e,n){return Object.assign(Object.assign({},e),p({},""+n,t))}),{})}function r_(e,t){return function(e,n){return Object.entries(e).filter((function(e){var n=u(e,2);n[0];return function(e,n){return n===t}(0,n[1])})).reduce((function(e,t){var n=u(t,2),i=n[0],o=n[1];return Object.assign(Object.assign({},e),p({},""+i,o))}),{})}(e)}function c_(e,t){return Object.keys(r_(e,t))}function s_(e,t,n){return function(e,t){return e.filter((function(e){return t.includes(e.id)}))}(e,c_(t,n))}function l_(e,t,n){var i,o=c_(t,n).map((function(t){return function(e){for(var t,n=arguments.length,i=new Array(n>1?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];var a,r,c=i.map((function(t){return e.filter((function(e){return t===e.objectId}))}));return a=(t=[]).concat.apply(t,s(c)),r=new Set(a),Array.from(r.values())}(e,t)})).map((function(e){return e.map((function(e){return e.id}))}));return a_((i=[]).concat.apply(i,s(o)),n)}var p_={};function u_(e,t){t.hasOwnProperty("data")&&(t[e]=t.data)}var d_={hotspotSeedId:0,hotspotIdMap:new Map,getHotspotMap:function(e){var t=d_.hotspotIdMap,n=d_.createHotspotId;return e.selectSnapshot(Pc.getLabels).forEach((function(e){var i=e.id;void 0===t.get(i)&&n(i)})),t},createHotspotId:function(e){return d_.hotspotSeedId++,d_.hotspotIdMap.set(e,d_.hotspotSeedId),d_.hotspotSeedId},getHotspotIdByLabel:function(e,t,n){var i=d_.getHotspotMap,o=d_.createHotspotId,a=i(e).get(t);return n&&void 0===a?o(t):a},getLabelIdByHotspotId:function(e,t){var n=d_.getHotspotMap(e),i=Array.from(n).find((function(e){var n=u(e,2);n[0];return n[1]===t}));return i?i[0]:null}};function g_(e,t){var n=e.selectSnapshot(Pc.getLabels);return void 0!==t?n.filter((function(e){return e.chapterId===t})):n}function h_(e,t){var n=g_(e),i=d_.getLabelIdByHotspotId(e,t);return n.find((function(e){return e.id===i}))}function f_(e){return e===mi.CirclePlus?Jn.Plus:e===mi.CircleMinus?Jn.Minus:Jn.Default}function b_(e,t){return d_.getHotspotIdByLabel(e,t)}function v_(e,t){return Object.assign(Object.assign({},t),{id:b_(e,t.id)})}function m_(e,t,n){var i=t.selectSnapshot(Ua.getStoryChapters);return n.map((function(n){return function(e,t,n,i){var o,a=i.id,r=i.chapterId,c=i.title,s=i.objectId,l=n.findIndex((function(e){return r===e.id})),p=d_.getHotspotIdByLabel(t,a,!0),u=function(e,t){return e.scene.markers.markers[t]}(e,a);return{id:p,title:c,objectId:s,position:u?y_(u.pos):null,direction:u?y_(u.dir):null,canvasPosition:u?(o=u.canvasPos,{x:o[0],y:o[1]}):null,chapterScope:l,type:i.pinType===Jn.PlusMinus?mi.CirclePlus:mi.Circle,shown:i.shown,data:p_[i.id]}}(e,t,i,n)}))}function y_(e){return{x:e[0],y:e[1],z:e[2]}}function x_(e){return[e.x,e.y,e.z]}function w_(e,t,n){return e.dispatch(new Yo(t,n)),!0}function k_(e,t){if("number"==typeof t){var n=h_(e,t);return n?[n]:[]}return g_(e)}function O_(e){return e.selectSnapshot(Pc.getChapterLabels)}function C_(e,t){return e.dispatch(new ea(t)),!0}function S_(e,t){return O_(e).find((function(e){return t===e.id}))}function __(e,t){return O_(e).filter((function(e){return t.includes(e.id)}))}function j_(e,t,n){return t&&t.objectId?(e.dispatch(n?new No(t):new Wo(t)),t):null}function P_(e,t){var n=document.createElement("span");return n.innerHTML=e,Object(Oe.trim)(n.textContent).length<=t}function M_(e,t,n){var i=e;return i.title=t.title&&P_(t.title,100)?t.title:i.title,i.description=t.description&&P_(t.description,300)?t.description:i.description,i.theme=t.theme||i.theme,i.pinType=t.pinType||i.pinType,i.sequentialType=t.sequentialType||i.sequentialType,i.offset=function(e,t){return t||[-(e.hideWire?20:32),0]}(i,t.labelOffset),i.pinGlow=void 0!==t.pinGlow?t.pinGlow:i.pinGlow,i.hideWire=void 0!==t.hideWire?t.hideWire:i.hideWire,i.hideTag=void 0!==t.hideTag?t.hideTag:i.hideTag,i.collapseDescription=void 0!==t.collapseDescription?t.collapseDescription:i.collapseDescription,i.occludable=void 0!==t.occludable?t.occludable:i.occludable,i.cameraPosition=t.flyToCamera||i.cameraPosition,i.flyTo=function(e,t){return!1!==t&&(t||e.flyTo)}(i,t.flyTo),i.states=function(e){if(!e.flyTo)return[];var t=[new hi,new hi];t[0].errands=[new yi],t[1].errands=e.cameraPosition?[new vi(e.cameraPosition)]:[new bi(e.objectId)]}(i),i}function I_(e,t){if(t){var n=e.scene.markers.markers[t.id];return{labelId:t.id,objectId:t.objectId,title:t.title,description:t.description,theme:t.theme,pinType:t.pinType,labelOffset:t.offset,hideWire:t.hideWire,pinGlow:t.pinGlow,occludable:t.occludable,sequentialType:t.sequentialType,shown:t.shown,collapseDescription:t.collapseDescription,hideTag:t.hideTag,flyTo:!0===t.flyTo,flyToCamera:t.cameraPosition,position:n?[n.pos[0],n.pos[1],n.pos[2]]:t.pos,canvasPosition:n?[n.canvasPos[0],n.canvasPos[1]]:[-1,-1],occluded:!n||n.occluded}}return null}function z_(e,t){return t.reduce((function(t,n){return t[n.id]=I_(e,n),t}),{})}function T_(e){return e.selectSnapshot(So.getAllQuestions)}function U_(e){return T_(e).find((function(t){return t.id===A_(e)}))}function L_(e){return{active:e.selectSnapshot(So.getQuizModeActive),questions:(t=T_(e),i=t.map((function(e){return V_(e)})),void 0!==n?i.filter((function(e){return n.includes(e.questionId)})):i),questionId:A_(e),submissions:D_(e,F_(e))};var t,n,i}function D_(e,t){return t.map((function(t){return E_(e,t)}))}function E_(e,t){var n=U_(e);return{questionId:t.questionId,answerIds:n.data.correctAnswer,correct:po(n,t.answer)}}function F_(e){return e.selectSnapshot(So.getAllSubmissions)}function A_(e){return e.selectSnapshot(So.getActiveQuestionId)}function R_(e){var t=U_(e),n=function(e){return F_(e).find((function(t){return t.questionId===A_(e)}))}(e);return{question:V_(t),submission:n?E_(e,n):void 0}}function N_(e){return e.map((function(e){return function(e){var t=e.type;switch(t){case ro.Markdown:return{type:t,content:e.markdown};case ro.Images:return{type:t,content:e.images.map((function(e){return e.urls.default}))};default:return{type:t,content:""}}}(e)}))}function V_(e){var t=[],n="";switch(e.type){case co.MultipleChoice:var i=e.data;t=i.options.map((function(e){return function(e){return{answerId:e.value,displayText:e.label}}(e)})),n=i.correctAnswer;break;case co.SelectAnatomy:t=e.data.correctAnswer.map((function(e){return{answerId:e,displayText:e}})),n="";break;case co.LabelAnatomy:t=e.data.options.map((function(e){return{answerId:e.value,displayText:e.label.title}})),n=""}return{questionId:e.id,questionType:e.type,questionPrompt:N_(e.questionPrompt),answerExplanation:N_(e.explanation),answers:t,answerId:n}}var H_,B_,Q_,q_,W_=((H_=function(){function e(t,n,i,o,a,r,c,s,l,p,u,d){m(this,e),this.store=t,this.actions=n,this.cameraService=i,this.engineService=o,this.animationService=a,this.paintService=r,this.labelsService=c,this.graphService=s,this.viewService=l,this.widgetAnalyticsService=p,this.visibilityLayersService=u,this.quizService=d,this.webGLInfo=SceneJS.WEBGL_INFO}return v(e,[{key:"listen",value:function(e){this.initProcedures(),this.initEvents(),e&&this.logAPIUsage()}},{key:"logAPIUsage",value:function(){var e=this;setInterval((function(){var t=Human.rpc.getLog(),n=Object(Oe.uniqBy)(t,(function(e){return e.identifier}));if(n.length>0){var i=JSON.stringify(n),o=e.store.selectSnapshot(de.getWidgetState),a=e.widgetAnalyticsService.buildDeveloperAnalytic(o,se.Call,ee.WidgetAPI,i);e.widgetAnalyticsService.sendAnalytic(a).subscribe({next:function(e){},error:function(e){throw new Error(e)}}),Human.rpc.resetLog()}}),1e4)}},{key:"initEvents",value:function(){var e,t,n;JS(Lt.HumanProgress,void 0,(function(e){return e})),[{eventName:Lt.HumanReady,aliasEvents:[Lt.HumanStarted]},{eventName:Lt.Error,aliasEvents:[Lt.HumanError],mapFn:function(e){return e}}].forEach((function(e){JS(e.eventName,e.aliasEvents,e.mapFn)})),[{eventName:Lt.SceneLoaded,mapFn:function(e){return e}},{eventName:Lt.ScenePicked,aliasEvents:[Lt.PickPicked],mapFn:$S},{eventName:Lt.SceneObjectsSelected,mapFn:function(e){return e.selectedObjectsUpdate}},{eventName:Lt.SceneObjectsShown,mapFn:function(e){return e.enabledObjectsUpdate}},{eventName:Lt.SceneReady,aliasEvents:[Lt.Started]},{eventName:Lt.SceneRestored,mapFn:function(){return!0}},{eventName:Lt.SceneXrayEnabled,mapFn:function(){return!0}},{eventName:Lt.SceneXrayDisabled,mapFn:function(){return!0}},{eventName:Lt.NativeShare,mapFn:function(e){return e}},{eventName:Lt.NativeDebugMessage,mapFn:function(e){return e}}].forEach((function(e){JS(e.eventName,e.aliasEvents,e.mapFn)})),(e=this.cameraService,[{eventName:Lt.CameraUpdated,aliasEvents:[Lt.CameraRested],mapFn:function(){return BS(e)}}]).forEach((function(e){JS(e.eventName,e.aliasEvents,e.mapFn)})),[{eventName:Lt.TimelinePlaying,mapFn:function(e){return e}},{eventName:Lt.TimelineCompleted,mapFn:function(e){return!0}},{eventName:Lt.TimelineChapterTransition,aliasEvents:[Lt.TimelineChaptersActivated],mapFn:function(e){return{previousChapter:e.oldChapterIndex,currentChapter:e.newChapterIndex,time:e.time}}}].forEach((function(e){JS(e.eventName,e.aliasEvents,e.mapFn)})),[].forEach((function(e){JS(e.eventName,e.aliasEvents,e.mapFn)})),[].forEach((function(e){JS(e.eventName,e.aliasEvents,e.mapFn)})),(t=Human,n=this.store,[].concat(s(function(e,t){return[{eventName:Lt.AnnotationsCreated,aliasEvents:[Lt.LabelsCreated],mapFn:function(t){return t_(e,t)}},{eventName:Lt.AnnotationsDestroyed,aliasEvents:[Lt.LabelsDestroyed],mapFn:function(e){return{annotationId:e.id}}},{eventName:Lt.AnnotationsShown,aliasEvents:[Lt.LabelsEnabled],mapFn:function(){return!0}},{eventName:Lt.AnnotationsHidden,aliasEvents:[Lt.LabelsDisabled],mapFn:function(){return!0}}]}(t)),s(function(e,t){return[{eventName:Lt.HotspotsEntered,mapFn:function(e){return v_(t,e)}},{eventName:Lt.HotspotsLeft,mapFn:function(e){return v_(t,e)}},{eventName:Lt.HotspotsPicked,mapFn:function(e){return v_(t,e)}},{eventName:Lt.HotspotsDisplayUpdated,mapFn:function(e){return v_(t,e)}},{eventName:Lt.HotspotsPositionUpdated,mapFn:function(e){return function(e,t){var n=t.id,i=t.canvasPos,o=i.x,a=i.y;return{id:b_(e,n),canvasPosition:{x:o,y:a,0:o,1:a},occluded:t.occluded}}(t,e)}}]}(0,n)),[{eventName:Lt.LabelsChapterInfo,mapFn:function(e){return z_(t,e)}},{eventName:Lt.LabelsCreated,mapFn:function(e){return I_(t,e)}},{eventName:Lt.LabelsUpdated,mapFn:function(e){return I_(t,e)}},{eventName:Lt.LabelsDestroyed,mapFn:function(e){return{labelId:e.id}}},{eventName:Lt.LabelsEntered,mapFn:function(e){return e}},{eventName:Lt.LabelsLeft,mapFn:function(e){return e}},{eventName:Lt.LabelsPicked,mapFn:function(e){return e}},{eventName:Lt.LabelsMoved,mapFn:function(e){return e}},{eventName:Lt.LabelsEnabled,mapFn:function(){return!0}},{eventName:Lt.LabelsDisabled,mapFn:function(){return!0}},{eventName:Lt.LabelsShown,mapFn:function(e){return e}},{eventName:Lt.LabelsHidden,mapFn:function(e){return e}}])).forEach((function(e){JS(e.eventName,e.aliasEvents,e.mapFn)})),function(e){return[{eventName:Lt.QuizEntered,mapFn:function(){return L_(e)}},{eventName:Lt.QuizExited,mapFn:function(){return!0}},{eventName:Lt.QuizQuestionLoaded,mapFn:function(e){return e}},{eventName:Lt.QuizAnswerSelected,mapFn:function(e){return e}},{eventName:Lt.QuizAnswerSubmitted,mapFn:function(t){var n=e.selectSnapshot(So).questions.find((function(e){return e.id===t.questionId}));return{questionId:t.questionId,answerIds:t.answer,correct:po(n,t.answer)}}},{eventName:Lt.QuizCompleted,mapFn:function(){return uo(e.selectSnapshot(So.getAllQuestions),e.selectSnapshot(So.getAllSubmissions))}}]}(this.store).forEach((function(e){JS(e.eventName,e.aliasEvents,e.mapFn)}))}},{key:"initProcedures",value:function(){var e,t,n,i;(e=Human,t=this.webGLInfo,[{procName:HS.HumanInfo,actionFn:function(){return{version:e.VERSION,webglInfo:t,apiFunctions:e.rpc.getProcedures().sort(),apiEvents:e.rpc.getEvents().sort()}}}]).forEach((function(e){VS(e)})),function(e,t,n,i,o,a,r,l){return[{procName:HS.SceneMetaData,actionFn:function(){var t=e.selectSnapshot(Rc.getStory),n=e.selectSnapshot(Ua.getStoryChapters);return{title:t.displayName,description:t.description,chapters:n.map((function(e){return{id:e.id,title:e.info.displayName,description:e.info.description,isAnimated:a.isChapterAnimated(e),loops:a.isChapterLooped(e),duration:a.getChapterLocalTimerange(e.id)}}))}}},{procName:HS.focusObject,actionFn:function(n){return function(e,t,n){e.select&&e.xray?ZS(t,n):Vc(t,n),e.select&&t.dispatch(new pi.UpdateNodesChecked(!0,[e.objectId])),t.dispatch(new He(e.objectId,!0,1))}(n,e,t),!0},hideDefinition:!0},{procName:HS.dissectSetEnabled,actionFn:function(t){return e.dispatch(new Ze(t.enable?Aa.Hide:Aa.Select)),!0},hideDefinition:!0},{procName:HS.sceneSetClickMode,actionFn:function(t){return e.dispatch(new Ze("select"===t?Aa.Select:"hide"===t?Aa.Hide:"fade"===t?Aa.Fade:Aa.Select)),!0}},{procName:HS.sceneGetClickMode,actionFn:function(){return e.selectSnapshot(qa.getActiveTool)}},{procName:HS.pickSingleSetEnabled,actionFn:function(t){var n=function(){switch(t.enable){case void 0:return!e.selectSnapshot(hp.getMultiPickModeEnabled);case!0:return!1;case!1:return!0}}();return e.dispatch(new S.SetMultiPickModeEnabled(n)),!0},hideDefinition:!0},{procName:HS.pickMultiSetEnabled,actionFn:function(t){var n=function(){switch(t.enable){case void 0:return!e.selectSnapshot(hp.getMultiPickModeEnabled);default:return t.enable}}();return e.dispatch(new S.SetMultiPickModeEnabled(n)),!0},hideDefinition:!0},{procName:HS.getCanvasPos,actionFn:function(e){var n=t.getCanvas();return QS.getCanvasPos(Human,e.worldPos,e.offset,n.width,n.height)},hideDefinition:!0},{procName:HS.SceneCapture,actionFn:function(){return function(e,t){var n=t.captureCamera(),i=e.selectSnapshot(Fi.getNodes),o=Object.keys(i).map((function(e){return{objectId:e,selected:i[e].checked||KS(i,e),hidden:!i[e].shown}})),a=e.selectSnapshot(Ua.getStoryChapters).map((function(e){return{chapterId:e.id,background:e.background||va}})),r=e.selectSnapshot(Rc.getStoryId);return{camera:n,labels:e.selectSnapshot(Pc.getLabels),storyId:r,objects:o,background:a,activeChapterId:e.selectSnapshot(Ua.getSelectedChapterId)}}(e,i)}},{procName:HS.SceneRestore,actionFn:function(n){var i=qS.isLegacyCaptureFormat(n);return function(e,t,n,i){return new he.a((function(o){n.getEvent(Lt.HumanStarted).pipe(Object(WS.a)()).subscribe((function(){(function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return new Promise((function(i){t.selectSnapshot(qa.getViewGraph);var o=e.objects.filter((function(e){return!0===e.selected})).map((function(e){return e.objectId})),a=n?Human.scene.getLeaves().filter((function(t){return void 0===e.objects.find((function(e){return e.objectId===t}))})):e.objects.filter((function(e){return!0===e.hidden})).map((function(e){return e.objectId})),r=e.background.map((function(e){return new En(e.chapterId,e.background)})),c=e.activeChapterId?[new On(e.activeChapterId)]:[],l=void 0!==e.camera.zoom?[new Jt(e.camera.zoom)]:[];setTimeout((function(){t.dispatch([new Wt(e.camera.lookAt,!1),new Ro(e.labels),new pi.UpdateNodesShown(!1,a),new pi.UpdateNodesChecked(!0,o)].concat(l,c,s(r))),i()}))}))})(e,t,i).then((function(){n.fireEvent(Lt.SceneRestored,void 0),o.next(!0),o.complete()}))})),GS(t,e.storyId)}))}(i?qS.convertCaptureFormat(n):n,e,t,i)}},{procName:HS.SceneEnableXrayMode,actionFn:function(){return ZS(e,t)}},{procName:HS.SceneDisableXrayMode,actionFn:function(){return Vc(e,t)}},{procName:HS.SceneLoad,actionFn:function(t){return GS(e,t),!0}},{procName:HS.SceneSetBaseDirectory,actionFn:function(e){return Human.events.fire("scene.setBaseDirectory",e),!0}},{procName:HS.SceneReset,actionFn:function(){return r.resetChapter(),!0}},{procName:HS.SceneInfo,actionFn:function(t){var n=t&&t.objectId?[t.objectId]:Object.keys(Human.scene.objects);return function(e,t,n){var i=n.selectSnapshot(Fi.getNodes);return{name:e,objects:t.reduce((function(e,t){return e[t]=function(e){var t=Human.scene.objects[e],n=t.isLeaf()?i[e].checked||KS(i,e):void 0;return{objectId:t.objectId,name:t.displayName,description:t.description||"",shown:t.shown,selected:n,children:t.objects.map((function(e){return e.objectId})),parent:t.parent?t.parent.objectId:null}}(t),e}),{})}}(e.selectSnapshot(Rc.getStory).displayName,n,e)}},{procName:HS.ScenePick,actionFn:function(e){return $S(t.pickScene({x:e.x,y:e.y,rayPick:!0}))}},{procName:HS.SceneSelectObjects,actionFn:function(t){var n=!0===t.replace,i=t;return delete i.replace,n&&e.dispatch(new pi.UpdateNodesChecked(!1)),e.dispatch(new pi.UpdateNodesChecked(!1,[],i)),!0}},{procName:HS.SceneShowObjects,actionFn:function(t){delete t.replace;var n=Object.entries(t).reduce((function(e,n){var i=u(n,2),o=i[0],a=i[1];return Object.assign(Object.assign({},e),function e(n,i){var o,a=Human.scene.objects[n].objects,r=p({},n,i),s=c(a);try{for(s.s();!(o=s.n()).done;){var l=o.value;void 0!==t[l.objectId]||(r[l.objectId]=i,r=Object.assign(Object.assign({},r),e(l.objectId,i)))}}catch(u){s.e(u)}finally{s.f()}return r}(o,a))}),{});return e.dispatch(new pi.UpdateNodesShown(!1,[],n)),!0}},{procName:HS.IsolateObject,actionFn:function(t){var n="string"==typeof t?[t]:t,i=e.selectSnapshot(qa.getViewGraph),a=o.getInverseSelection(i,n),r=o.getNodes(i,a);return e.dispatch(new pi.UpdateNodesShown(!1,r.map((function(e){return e.id})))),!0}},{procName:HS.SceneTransformObject,actionFn:function(e){return t.transformObject(e.objectId,e),!0}},{procName:HS.SceneColorObject,actionFn:function(t){var n=t.objectId,i=t.tintColor,o=t.saturation,a=t.contrast,r=t.brightness,c=t.opacity;return e.dispatch(new pi.UpdateNodesPaint(Ui.fromEngine({tintColor:i,saturation:o,contrast:a,brightness:r,opacity:c}),[n])),!0}},{procName:HS.SceneGetColor,actionFn:function(t){var n=e.selectSnapshot(Fi.getNodePaint)(t.objectId);return Ui.toEngine(n)}},{procName:HS.SceneUncolorObject,actionFn:function(t){return e.dispatch(new pi.UpdateNodesPaint(Vi.recipe,[t.objectId])),!0}},{procName:HS.SceneDisableHighlight,actionFn:function(){return n.disableHighlight(),!0}},{procName:HS.SceneEnableHighlight,actionFn:function(){return n.enableHighlight(),!0}},{procName:HS.SceneSetHighlightColor,actionFn:function(e){return n.setHighlightColor(e),!0}},{procName:HS.SceneSetLayersSliderPosition,actionFn:function(e){var t=Math.min(1,Math.max(e.position,0)),n=l.fractionToIndex(t),i=l.fractionToPosition(t,n);return e.record?l.recordLayerIndexPosition(n,i):l.synchronizeScene(n,i,!1),!0}},{procName:HS.SceneGetLayers,actionFn:function(){return e.selectSnapshot(Ua.getAllChaptersCurrentLayers)}}]}(this.store,this.engineService,this.paintService,this.cameraService,this.graphService,this.animationService,this.viewService,this.visibilityLayersService).forEach((function(e){VS(e)})),(n=this.store,i=this.cameraService,[{procName:HS.CameraInfo,actionFn:function(){return BS(i)}},{procName:HS.CameraOrbit,actionFn:function(e){return n.dispatch(new on(void 0===e.pitch?0:e.pitch,void 0===e.yaw?0:e.yaw)),!0}},{procName:HS.CameraPan,actionFn:function(e){return n.dispatch(new en(void 0===e.x?0:e.x,void 0===e.y?0:e.y,void 0===e.z?0:e.z)),!0}},{procName:HS.CameraReset,actionFn:function(){return n.dispatch(new Gt)}},{procName:HS.CameraSet,actionFn:function(e){var t=e.animate||!1;if(e.objectId)return n.dispatch(new He(e.objectId,t,e.animationDuration)),!0;var o=BS(i);return n.dispatch(new Wt({eye:e.position||o.position,look:e.target||o.target,up:e.up||o.up},t)),!0}},{procName:HS.CameraZoom,actionFn:function(e){return n.dispatch(new Jt(e||0)),!0}},{procName:HS.setCameraMode,actionFn:function(e){return n.dispatch(new an("pan"===e?"pan":"rotate")),!0}}]).forEach((function(e){VS(e)})),function(e,t,n,i){return[{procName:HS.TimelineQuery,actionFn:function(){return{chapters:e.selectSnapshot(Ua.getStoryChapters).map((function(e){var t=e.info;return{description:t.description,displayName:t.displayName,annotations:e.labels.map((function(e){return{title:e.title,description:e.description}}))}}))}},hideDefinition:!0},{procName:HS.TimelineInfo,actionFn:function(){return function(e,t){var n=t.getTimeFrame();return{time:t.getTime(),startTime:n.firstTime,endTime:n.lastTime,chapters:e.selectSnapshot(Ua.getStoryChapters).map((function(e){return e.id})),playing:t.isPlaying()}}(e,n)}},{procName:HS.TimelinePlay,actionFn:function(i){var o=i.loop||!1;if(void 0===i.time&&void 0===i.chapterId){var a=e.selectSnapshot(Ua.getSelectedChapterId);return n.play({numChapters:1,loop:o,queue:!1,startChapterId:a}),!0}var r=Math.max(0,i.time),c=n.getTimeFrame().lastTime,s=Math.min(r,c-.001);return new he.a((function(a){t.pipe(Object(L.i)(On),Object(bp.a)(1)).subscribe((function(){n.play(Object.assign(Object.assign({},{numChapters:1,queue:!1,loop:o}),void 0!==i.time?{startTime:s}:{startChapterId:i.chapterId})),a.next(!0),a.complete()}));var r=i.chapterId?i.chapterId:n.mapGlobalTimeToLocal(s,{tie:"later"}).branch.id;e.dispatch(new On(r))}))}},{procName:HS.TimelinePause,actionFn:function(){return n.pause(),!0}},{procName:HS.TimelineSet,actionFn:function(i){if(void 0===i.time&&void 0===i.chapterId)return!0;if(void 0!==i.chapterId)return e.dispatch(new On(i.chapterId)),!0;var o=Math.max(0,i.time),a=n.getTimeFrame().lastTime,r=Math.min(o,a);return new he.a((function(i){t.pipe(Object(L.i)(On),Object(bp.a)(1)).subscribe((function(){n.scrub({time:r,which:0===r?"second":"first"}),i.next(!0),i.complete()}));var o=n.mapGlobalTimeToLocal(r,0===r?{tie:"later"}:{});e.dispatch(new On(o.branch.id))}))}},{procName:HS.TimelineNext,actionFn:function(){return i.nextChapter("API"),!0}},{procName:HS.TimelinePrev,actionFn:function(){return i.previousChapter("API"),!0}}]}(this.store,this.actions,this.animationService,this.viewService).forEach((function(e){VS(e)})),function(e){return[{procName:HS.InputEnable,actionFn:function(){return e.dispatch(new Q(!0)),!0}},{procName:HS.InputDisable,actionFn:function(){return e.dispatch(new Q(!1)),!0}}]}(this.store).forEach((function(e){VS(e)})),function(e,t,n,i){return[{procName:HS.UIGetBackground,actionFn:function(){return e=t.selectSnapshot(Ua.getSelectedChapterBackground),n=e.colors,i=e.gradientType,o=e.colorStops,{colors:[[n[0],n[1],n[2],n[3]],[n[4],n[5],n[6],n[7]]],gradientType:i,colorStops:o};var e,n,i,o}},{procName:HS.UISetBackground,mapFnIn:function(e){var t,n=e.colors,i=e.colorStops,o=e.gradientType;return{colors:n?(t=n,ba.getColors(t).map((function(e){return e[255]}))):n,gradientType:o,colorStops:i}},actionFn:function(e){if(e){var n,i=t.selectSnapshot(Ua.getSelectedChapterBackground),o=i.colors,a=i.colorStops,r=i.gradientType,c=e.colors?(n=[]).concat.apply(n,s(e.colors)):o,l=new ai(c,e.gradientType||r,e.colorStops||a);t.dispatch(new Rn(l))}return!0}},{procName:HS.UIGetWorldPosition,actionFn:function(t){var n=e.renderer.pick.pick(t.x,t.y,{rayPick:!0}).worldPos;return n?{x:n[0],y:n[1],z:n[2]}:null}},{procName:HS.UISetOndemand,actionFn:function(e){return t.dispatch([new S.ToggleWindow(Gl.OnDemand,e.enabled)]),!0}},{procName:HS.UISetLoadingExperience,actionFn:function(e){return Object(Oe.isEmpty)(e)?t.dispatch(new S.CloseWindow(Gl.Interact)):t.dispatch([new S.SetInteractType(e),new S.OpenWindow(Gl.Interact)]),!0}},{procName:HS.UISetScrollCaptureMode,actionFn:function(e){return t.dispatch(new Ie(e)),!0}},{procName:HS.UISetTutorial,actionFn:function(e){return t.dispatch([new S.ToggleWindow(Gl.Tutorial,e.enabled),new S.StartTutorial(e.enabled)]),!0}},{procName:HS.UIGetDisplay,actionFn:function(){var e=t.selectSnapshot(hp.getUI);return{audio:e.audio.enable,fullscreen:e.fullscreen.enable,help:e.help.enable,nav:e.camera.enable,cameraMode:e.camera.enable,center:e.camera.enable,zoomIn:e.camera.enable,zoomOut:e.camera.enable,info:e.column.enable||e.drawer.enable,playPause:e.media.enable,scrubber:e.media.enable,"scrubber.chapters":e.media.enable,tools:e.tools.enable,"tools-display":e.tools.enable,tour:e.pagination.enable,"tour.chapters":e.pagination.enable,objectTree:e.search.enable,anatomyLabels:e.anatomyLabels.enable,share:!1,dissect:!1,xray:!1,annotations:!1,crossSection:!1,isolate:!1}}},{procName:HS.UISetDisplay,actionFn:function(e){var n=ju.convertAPIUIConfigToUIConfig(e);return t.dispatch(new q(n)),e}},{procName:HS.UIResetDisplay,actionFn:function(){var e=t.selectSnapshot(hp.getInitialUI);t.dispatch(new S.SetUI(e))}},{procName:HS.UISnapshot,aliases:[HS.SceneSnapshot],mapFnIn:function(e){var t=i.getCanvas(),n=t.width,o=t.height;return Object.assign({width:n,height:o,openInTab:!1,fileType:"jpeg",quality:.92},e)},actionFn:function(e){var i=e.width,o=e.height,a=e.openInTab,r=e.fileType,c=t.selectSnapshot(Ua.getSelectedChapterId);return t.dispatch(new qn(c,"jpeg"===r?bn.JPEG:bn.PNG,.92,{width:i,height:o},"original",!0,!0)).pipe(Object(oa.a)((function(){return n.pipe(Object(L.j)(Wn),Object(bp.a)(1))})),Object(oa.a)((function(e){return Io.blobToBase64(e.blob)})),Object(hn.a)((function(e){a&&e&&function(e){var t=window.open("","_blank");if(t){var n=t.document.createElement("img");n.src=e,t.document.body.appendChild(n)}}(e)})),Object(G.a)((function(){return Object(XS.of)(null)})))}}]}(Human,this.store,this.actions,this.engineService).forEach((function(e){VS(e)})),function(e,t,n,i){return[].concat(s(function(e,t,n){return[{procName:HS.AnnotationsInfo,actionFn:function(){return YS(t)},mapFnOut:function(t){return function(e,t){return t.reduce((function(t,n){return t[n.id]=t_(e,n),t}),{})}(e,t)}},{procName:HS.AnnotationsCreate,mapFnIn:function(i){return function(e,t,n,i){var o=t.selectSnapshot(Ua.getSelectedChapter),a={annotationId:i.annotationId,title:i.title,description:i.description,objectId:e.scene.objects[i.objectId]?i.objectId:void 0,pos:i.position,occludable:i.occludable,labelOffset:i.labelOffset,shown:i.shown,labelShown:i.shown};return a.objectId&&void 0===a.pos&&(a.pos=e.scene.objects[a.objectId].center),n.deserializeAnnotation(a,o,Xn.Annotation)}(e,t,n,i)},actionFn:function(e){return function(e,t){return t.objectId||t.pos?(e.dispatch(new No(t)),t):null}(t,e)},mapFnOut:function(t){return t?t_(e,t):null}},{procName:HS.AnnotationsUpdate,mapFnIn:function(e){return n_(t,e)},actionFn:function(e){return i_(t,e)}},{procName:HS.AnnotationsSetTitle,mapFnIn:function(e){return n_(t,e)},actionFn:function(e){return i_(t,e)},hideDefinition:!0},{procName:HS.AnnotationsSetDescription,mapFnIn:function(e){return n_(t,e)},actionFn:function(e){return i_(t,e)},hideDefinition:!0},{procName:HS.AnnotationsDestroy,mapFnIn:function(e){return e_(t,e)},actionFn:function(e){return function(e,t){return t&&e.dispatch(new Bo(t)),!0}(t,e)}},{procName:HS.ShowAnnotations,actionFn:function(){return o_(t,!0)}},{procName:HS.SetAnnotationsShown,actionFn:function(){return o_(t,!0)},hideDefinition:!0},{procName:HS.HideAnnotations,actionFn:function(){return o_(t,!1)}},{procName:HS.AnnotationsSetLabelsShown,mapFnIn:function(e){return function(e,t){var n=t.annotations,i=t.objects,o=t.replace,a=n||{},r=i||{},c=YS(e),s=Object.assign(Object.assign(Object.assign(Object.assign({},r_(a,!0)),r_(a,!1)),l_(c,r,!0)),l_(c,r,!1));return o?Object.assign(Object.assign({},a_(c.map((function(e){return e.id})),!1)),s):s}(t,e)},actionFn:function(e){return function(e,t){var n=YS(e),i=s_(n,t,!1),o=s_(n,t,!0);e.dispatch(new Yo(o,!0)),e.dispatch(new Yo(i,!1))}(t,e)},hideDefinition:!0}]}(e,t,n)),s(function(e,t,n){return[{procName:HS.HotspotsInfo,actionFn:function(n){var i="number"==typeof n?n:void 0;if(void 0!==i){var o=h_(t,i);return m_(e,t,[o])[0]}var a=k_(t,i);return m_(e,t,a)}},{procName:HS.HotspotsTypes,mapFnIn:function(){return Object.values(mi).map((function(e){return""+e}))},actionFn:function(e){return e}},{procName:HS.HotspotsCreate,mapFnIn:function(e){return function(e,t,n){var i=n.title,o=n.objectId,a=n.position,r=n.direction,c=n.chapterScope,s=n.type,l=e.selectSnapshot(Ua.getStoryChapters),p=e.selectSnapshot(Ua.getSelectedChapter),u=e.selectSnapshot(Ua.getSelectedChapterIndex),d="number"==typeof c?c:u,g=l[d]||p,h=!1!==n.shown,f=h&&!!i,b={title:i,type:s||mi.CircleLabel,objectId:o,pos:a?x_(a):null,dir:r?x_(r):null,shown:h,symbol:"",className:""},v=t.deserializeHotspots({},g,d,b);return v.title=i,v.expandTag=!0,v.flyTo=!1,v.flyToTarget=null,v.occludable=!0,v.pinGlow=!1,v.pinType=Jn.PlusMinus,v.shown=h,v.hideTag=!f,v.hideWire=!0,v.theme=Xn.StudioNext,v.pinType=f_(s),u_(v.id,n),v}(t,n,e)},actionFn:function(e){return function(e,t){return t.objectId||t.pos?(e.dispatch(new No(t)),t):null}(t,e)},mapFnOut:function(e){return e?b_(t,e.id):null}},{procName:HS.HotspotsUpdate,mapFnIn:function(e){return function(e,t){var n=h_(e,t.id);return n?function(e,t){var n=e.title,i=e.objectId,o=e.direction,a=e.position,r=e.shown,c=e.type,s=Object.assign(Object.assign({},t),{title:n,objectId:i,shown:r,pos:a?x_(a):null,dir:o?x_(o):null,pinType:c?f_(c):null});return u_(t.id,e),Object.assign(Object.assign({},t),Object(Oe.omitBy)(s,Oe.isNil))}(t,n):null}(t,e)},actionFn:function(e){return e?function(e,t){return e.dispatch(new Wo(t)),t}(t,e):null}},{procName:HS.HotspotsDestroy,mapFnIn:function(e){return h_(t,e)},actionFn:function(e){return e?function(e,t){return e.dispatch(new Bo(t)),t}(t,e):null}},{procName:HS.HotspotsShow,mapFnIn:function(e){return k_(t,e)},actionFn:function(e){return w_(t,e,!0)}},{procName:HS.HotspotsHide,mapFnIn:function(e){return k_(t,e)},actionFn:function(e){return w_(t,e,!1)}}]}(e,t,n)),[{procName:HS.LabelsInfo,actionFn:function(e){return e.length>0?__(t,e):t.selectSnapshot(Pc.getChapterLabels)},mapFnOut:function(t){return z_(e,t)}},{procName:HS.LabelsCreate,mapFnIn:function(e){return e.labelId&&S_(t,e.labelId)?null:e.objectId&&e.position?function(e,t,n,i){var o=n.makeDefaultStudioLabel();o.id=i.labelId||Ut.idWithPrefix("label"),o.objectId=i.objectId,o.pos=i.position,o.renderableIndex=0,o.occludable=!0,o.flyTo=!0,o.description="",o.shown=!0;var a=t.selectSnapshot(Ua.getSelectedChapter);return o.chapterId=a.id,M_(o,i)}(0,t,n,e):(console.log("attempt to create a label with no objectId and position"),null)},actionFn:function(e){return j_(t,e,!0)},mapFnOut:function(t){return I_(e,t)}},{procName:HS.LabelsUpdate,mapFnIn:function(e){return S_(t,e.labelId)?function(e,t){return M_(S_(e,t.labelId),t,e.selectSnapshot(Ua.getSelectedChapter))}(t,e):null},actionFn:function(e){return j_(t,e,!1)},mapFnOut:function(t){return I_(e,t)}},{procName:HS.LabelsCanvasUpdate,mapFnIn:function(e){return S_(t,e.labelId)?function(e,t,n){var i=S_(e,n.labelId),o=n.canvasPosition,a=t.pickScene({x:o[0],y:o[1],rayPick:!0});return a&&a.objectId?(i.objectId=a.objectId,i.pos=[a.worldPos[0],a.worldPos[1],a.worldPos[2]],i.offset=[i.hideWire?20:32,0],i.barycentric=[a.barycentric[0],a.barycentric[1],a.barycentric[2]],i.primitiveIndex=a.primitiveIndex,i.renderableIndex=a.renderableIndex||0,i):null}(t,i,e):null},actionFn:function(e){return j_(t,e,!1)},mapFnOut:function(t){return I_(e,t)}},{procName:HS.LabelsDestroy,mapFnIn:function(e){return S_(t,e)},actionFn:function(e){return e?(t.dispatch(new Bo(e)),{labelId:e.id}):null}},{procName:HS.LabelsShow,actionFn:function(e){return e.length>0?t.dispatch(new Yo(__(t,e),!0)):C_(t,!0),!0}},{procName:HS.LabelsHide,actionFn:function(e){return e.length>0?t.dispatch(new Yo(__(t,e),!1)):C_(t,!1),!0}},{procName:HS.LabelsSetEnabled,aliases:[HS.AnnotationsSetEnabled],actionFn:function(e){t.dispatch(new Ge(e.enable))},hideDefinition:!0},{procName:HS.LabelsSetScale,actionFn:function(e){t.dispatch(new Ko(e.scale))}}])}(Human,this.store,this.labelsService,this.engineService).forEach((function(e){VS(e)})),function(e,t){function n(t){return e.selectSnapshot(So.getQuizModeActive)?t():{error:"quiz mode is not active"}}return[{procName:HS.QuizInfo,actionFn:function(){return n((function(){return L_(e)}))}},{procName:HS.QuizSubmit,actionFn:function(i){return n((function(){return t.submitQuestion(i.questionId,i.answerIds),L_(e)}))}},{procName:HS.QuizQuestion,actionFn:function(){return n((function(){return R_(e)}))}},{procName:HS.QuizEnter,actionFn:function(){return e.selectSnapshot(So.hasQuiz)?(t.startQuiz(),!0):{error:"quiz not found"}}},{procName:HS.QuizExit,actionFn:function(){return t.exitQuiz(),!0}},{procName:HS.QuizSelectQuestion,actionFn:function(t){return n((function(){return e.dispatch(new no.SetActiveQuestion(t)),L_(e)}))}},{procName:HS.QuizNextQuestion,actionFn:function(){return n((function(){return t.nextQuestion(),R_(e)}))}},{procName:HS.QuizPreviousQuestion,actionFn:function(){return n((function(){return e.dispatch(new no.SetQuizLifecycle(ho.Question)),e.dispatch(new no.PreviousQuestion),R_(e)}))}},{procName:HS.QuizReset,actionFn:function(){return t.resetQuiz(),L_(e)}},{procName:HS.QuizSet,actionFn:function(t){var n=t.settings,i=t.startNumber,o=t.endNumber,a=t.locked;if(!Object(Oe.isNil)(n)){var r=e.selectSnapshot(So.getQuizSettings);e.dispatch(new no.SetQuizSettings(Object.assign(Object.assign({},r),n)))}if("number"==typeof i||"number"==typeof o){var c=lo(e.selectSnapshot(Ua.getStoryChapters)),s=c.slice("number"==typeof i?i-1:0,"number"==typeof o?o:c.length);e.dispatch(new no.SetQuestions(s))}return"boolean"==typeof a&&e.dispatch(new no.SetQuizLocked(a)),L_(e)}}]}(this.store,this.quizService).forEach((function(e){VS(e)}))}}]),e}()).\u0275fac=function(e){return new(e||H_)(_.Zb(L.g),_.Zb(L.b),_.Zb(dn),_.Zb(Nt),_.Zb(xa),_.Zb(Gc),_.Zb(wi),_.Zb(St),_.Zb(Bu),_.Zb(ie),_.Zb(Xc),_.Zb(lf))},H_.\u0275prov=_.Lb({token:H_,factory:H_.\u0275fac,providedIn:"root"}),H_),$_=function(e){return e.Content="content",e.SceneJS="scenejs",e}({}),K_=function(e){return e.Auth="auth",e}({}),G_=function e(t,n,i){m(this,e),this.category=t,this.message=n,this.log=i},Z_=((Q_=function(){function e(t){m(this,e),this.http=t,this.log={}}return v(e,[{key:"logError",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n="".concat(e.category).concat(e.message);return t&&this.log[n]?Object($.a)():(this.log[n]=!0,this.http.post("/ws/human-error",e))}}]),e}()).\u0275fac=function(e){return new(e||Q_)(_.Zb(W.b))},Q_.\u0275prov=_.Lb({token:Q_,factory:Q_.\u0275fac,providedIn:"root"}),Q_),J_=((B_=function(){function e(t,n,i){m(this,e),this.locationStrategy=t,this.router=n,this.errorLoggingService=i,window.SceneJS_error.setFatalErrorHandler(this.handleSceneJSFatalErrors.bind(this))}return v(e,[{key:"handleSceneJSFatalErrors",value:function(e){var t={log:Human.log.messages.join("\n"),stack:e.stackTrace,webglInfo:window.SceneJS.WEBGL_INFO},n={category:e.errorName,log:JSON.stringify(t),message:e.messageFromCaller};this.errorLoggingService.logError(n,!0).subscribe();var i=btoa(JSON.stringify(e));this.redirectToErrorPage($_.SceneJS,void 0,i)}},{key:"redirectToErrorPage",value:function(e,t,n){if(!(this.router.url||"").match("/error")){var i=this.locationStrategy.getBaseHref(),o=this.router.createUrlTree([z.application===j.Viewer?i+"/error":i+"/view/error"],{queryParams:{errorType:e,errorCode:t,errorBlob:n,errorUrl:this.router.url}}),a=this.router.serializeUrl(o);window.location.href=a}}}]),e}()).\u0275fac=function(e){return new(e||B_)(_.Zb(or.h),_.Zb(we.e),_.Zb(Z_))},B_.\u0275prov=_.Lb({token:B_,factory:B_.\u0275fac,providedIn:"root"}),B_),X_=["*"],Y_=((q_=function(){function e(){m(this,e)}return v(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||q_)},q_.\u0275cmp=_.Jb({type:q_,selectors:[["app-warning-message"]],ngContentSelectors:X_,decls:2,vars:0,consts:[[1,"message","p-4","text-12"]],template:function(e,t){1&e&&(_.kc(),_.Vb(0,"div",0),_.jc(1),_.Ub())},styles:[".message{background-color:#0060c4;color:#fff}@media print{.message{display:none}}"],encapsulation:2,changeDetection:0}),q_),ej=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};function tj(e,t){if(1&e){var n=_.Wb();_.Vb(0,"app-warning-message"),_.Vb(1,"div",1),_.Vb(2,"div",2),_.Mc(3),_.Ub(),_.Vb(4,"div"),_.Vb(5,"div",3),_.cc("click",(function(){return _.zc(n),_.gc().handleDismissClick()})),_.Qb(6,"app-icon",4),_.Ub(),_.Ub(),_.Ub(),_.Ub()}if(2&e){var i=_.gc();_.Db(3),_.Oc(" ",i.message," ")}}var nj,ij,oj=((ij=function(){function e(t,n){m(this,e),this.changeDetector=t,this.storageService=n,this.show=!1,this.message="For the full interactive 3D experience please try loading this content in Chrome or Firefox.",this.ngUnsubscribe=new ge.a}return v(e,[{key:"ngOnInit",value:function(){this.initLayoutListener()}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"handleDismissClick",value:function(){this.show=!1,this.storageService.setLocalItem(zc.InternetExplorerWarning,!0)}},{key:"shouldShow",value:function(e){var t=this.storageService.getLocalItem(zc.InternetExplorerWarning);return Ix()&&!t&&e.internetExplorerWarning.enable}},{key:"initLayoutListener",value:function(){var e=this;this.layout$.pipe(Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){e.show=e.shouldShow(t),e.changeDetector.markForCheck()}))}}]),e}()).\u0275fac=function(e){return new(e||ij)(_.Pb(_.i),_.Pb(Lc))},ij.\u0275cmp=_.Jb({type:ij,selectors:[["app-ie-warning"]],decls:1,vars:1,consts:[[4,"ngIf"],[1,"warning"],[1,"warning__text"],[1,"warning__close",3,"click"],["icon","times","size","lg","title","Close"]],template:function(e,t){1&e&&_.Kc(0,tj,7,1,"app-warning-message",0),2&e&&_.lc("ngIf",!0===t.show)},directives:[or.l,Y_,Js],styles:[".warning[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between;align-items:center}.warning__text[_ngcontent-%COMP%]{text-align:center;flex:1}.warning__close[_ngcontent-%COMP%]{cursor:pointer;align-items:center;justify-content:center;display:flex;width:32px;height:32px}"],changeDetection:0}),function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);a>3&&r&&Object.defineProperty(t,n,r)}([Object(L.d)(hp.getUI),ej("design:type",he.a)],ij.prototype,"layout$",void 0),ij),aj=((nj=function(){function e(t,n){m(this,e),this.el=t,this.renderer=n}return v(e,[{key:"ngOnInit",value:function(){Ix()||this.renderer.setStyle(this.el.nativeElement,"display","none")}}]),e}()).\u0275fac=function(e){return new(e||nj)(_.Pb(_.m),_.Pb(_.H))},nj.\u0275dir=_.Kb({type:nj,selectors:[["","appShowIE11",""]]}),nj);function rj(e,t){1&e&&_.Qb(0,"div",4)}var cj={title:"We're unable to find the model you're looking for.",description:'Please check your URL or visit the <a href="/" target="_blank">BioDigital Human</a> to see what\'s available in our 3D model library.'},sj={title:"Your BioDigital Human embed requires proper authentication.",description:""},lj=p({},Z.InvalidUAID,{title:"Authentication Issues",description:"Your Human Widget has invalid user credentials.",url:"https://support.biodigital.com"});function pj(e,t){if(1&e){var n=_.Wb();_.Vb(0,"button",13),_.cc("click",(function(){return _.zc(n),_.gc(2).handleSeeDetailsClick()})),_.Mc(1," See Details "),_.Ub()}}function uj(e,t){if(1&e&&(_.Vb(0,"textarea",14),_.Mc(1,"        "),_.Ub()),2&e){var n=_.gc(2);_.lc("value",n.sceneJSErrorReport)}}function dj(e,t){if(1&e){var n=_.Wb();_.Vb(0,"div"),_.Vb(1,"h1",3),_.Mc(2," The BioDigital Human encountered an error. "),_.Ub(),_.Vb(3,"h2",4),_.Mc(4," Error: "),_.Vb(5,"span",5),_.Mc(6),_.Ub(),_.Ub(),_.Vb(7,"div",6),_.Mc(8," To receive assistance with this error, please follow these steps: "),_.Ub(),_.Vb(9,"ol",7),_.Vb(10,"li",8),_.Vb(11,"button",9),_.cc("click",(function(){return _.zc(n),_.gc().handleDownloadClick()})),_.Mc(12," Download "),_.Ub(),_.Mc(13," the error report. "),_.Ub(),_.Vb(14,"li",8),_.Vb(15,"button",9),_.cc("click",(function(){_.zc(n);var e=_.gc();return e.handleActionClick(e.supportURL)})),_.Mc(16," Share the report "),_.Ub(),_.Mc(17," with the customer support team. "),_.Ub(),_.Ub(),_.Vb(18,"div",10),_.Kc(19,pj,2,0,"button",11),_.Vb(20,"div"),_.Kc(21,uj,2,1,"textarea",12),_.Ub(),_.Ub(),_.Ub()}if(2&e){var i=_.gc();_.Db(6),_.Nc(i.sceneJSErrorTeaser),_.Db(13),_.lc("ngIf",!i.viewSceneJSErrorDetails),_.Db(2),_.lc("ngIf",i.viewSceneJSErrorDetails)}}function gj(e,t){if(1&e){var n=_.Wb();_.Vb(0,"div",3),_.Mc(1),_.Ub(),_.Vb(2,"div",15),_.Tb(3),_.Vb(4,"button",9),_.cc("click",(function(){_.zc(n);var e=_.gc();return e.handleActionClick(e.supportURL)})),_.Mc(5," Contact Support "),_.Ub(),_.Sb(),_.Ub(),_.Qb(6,"div",16)}if(2&e){var i=_.gc();_.Db(1),_.Oc(" ",i.title," "),_.Db(5),_.lc("innerHTML",i.description,_.Ac)}}var hj,fj,bj,vj,mj,yj,xj=[{path:"",component:(fj=function(){function e(t,n,i,o,a,r,c,s,l,p,u){m(this,e),this.store=t,this.actions=n,this.activatedRoute=i,this.widgetAPIHandler=o,this.errorService=a,this.engineService=r,this.cameraService=c,this.storageService=s,this.renderer=l,this.viewService=p,this.quizService=u,this.title="Biodigital Human",this.environmentApplication=j,this.environmentPlatform=I,this.ngUnsubscribe=new ge.a}return v(e,[{key:"ngOnInit",value:function(){this.initErrorHandling(),this.initInteractions();var e=this.activatedRoute.snapshot.data.widgetUrlConfig;this.initWidgetBreakpoints(e),this.initWidgetLabelScale(e),this.initWidgetLayout(e),this.initWidgetSetup(e),this.initWidgetAuth(),this.initViewAnalytics(),this.initInteractionAnalytics(),this.initBackgroundFromWidget(e),this.initBackgroundFromChapter(),this.initCamera(e),this.initRotation(e),this.initQuizInteractions(e),this.widgetAPIHandler.listen(z.deploy===M.Production),this.initChaptersReadyListener(),this.initHumanReadyListener(),this.initDynamicLayout()}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"initWidgetSetup",value:function(e){var t=window!==window.top,n=t?BD_DOCUMENT_REFERRER:window.location.href;this.store.dispatch(new E(n,t,e));var i=this.store.selectSnapshot(hp.getUI),o=ju.convertUrlUIConfigToUIConfig(e),a=ju.createLayoutFromConfig(i,o);this.store.dispatch(new S.SetUI(a)),this.store.dispatch(new S.SetInitialUI(a));var r=ju.getScrollSetting(e);this.store.dispatch(new Ie(r));var c=ju.getUsePrintImage(e),s=ju.getOnDemand(e),l=ju.getInteractType(e,this.store.selectSnapshot(hp.shouldWindowOpen(Gl.Interact)),this.store.selectSnapshot(hp.getInteractType)),p=l.interactType,u=l.isInteractActive,d=this.storageService.getLocalItem(zc.GettingStartedTutorial),g=!0===o.tutorial&&"true"!==d;this.store.dispatch([new S.SetOnDemand(s),new S.ToggleWindow(Gl.OnDemand,s),new S.SetInteractType(p),new S.ToggleWindow(Gl.Interact,u),new S.ToggleWindow(Gl.Tutorial,g),new S.StartTutorial(g),new S.SetUsePrintImage(c)])}},{key:"initWidgetAuth",value:function(){this.store.selectSnapshot(de.getEmbedded)&&this.store.dispatch(new N)}},{key:"initViewAnalytics",value:function(){var e=this,t=["loaded","interactive","complete"].includes(document.readyState);(t?Object($.a)(t):Object(Ga.a)(document,"DOMContentLoaded")).pipe(Object(bp.a)(1),Object(fe.a)(this.ngUnsubscribe)).subscribe((function(){e.store.dispatch(new F(se.View))}))}},{key:"initInteractionAnalytics",value:function(){var e=this;Object($a.a)(this.interactionChance$,this.firstInteraction$).pipe(Object(bp.a)(1),Object(fe.a)(this.ngUnsubscribe)).subscribe((function(){e.store.dispatch(new F(se.ChanceInteraction))})),this.firstInteraction$.pipe(Object(fe.a)(this.ngUnsubscribe)).subscribe((function(){e.store.dispatch(new F(se.FirstInteraction))}))}},{key:"initErrorHandling",value:function(){var e=this;this.actions.pipe(Object(L.j)(Er),Object(fe.a)(this.ngUnsubscribe)).subscribe((function(){return e.handleContentErrors()})),this.actions.pipe(Object(L.j)(H),Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){return e.handleAuthErrors(t)}))}},{key:"initWidgetBreakpoints",value:function(e){var t=[e["ui-collapse-label"],e["annotation-collapse"]].find((function(e){return!Object(Oe.isNil)(e)}));Object(Oe.isNil)(t)||this.store.dispatch(new S.SetLabelBreakpoint(t))}},{key:"initWidgetLabelScale",value:function(e){var t=e["label-scale"];Object(Oe.isNil)(t)||this.store.dispatch(new Ko(t))}},{key:"initWidgetLayout",value:function(e){var t=e["ui-layout"];Object(Oe.isNil)(t)||this.store.dispatch(new S.SetLayout(t))}},{key:"initQuizInteractions",value:function(e){var t=this;this.store.select(So.hasQuiz).pipe(Object(be.a)((function(e){return e})),Object(bp.a)(1),Object(fe.a)(this.ngUnsubscribe)).subscribe((function(){var n=t.store.selectSnapshot(So.getAllQuestions);t.store.dispatch(new no.SetQuizEnabled(""+e.uiQuiz!="false"));var i=e["ui-quiz-locked"];t.store.dispatch(new no.SetQuizLocked(""+i=="true"));var o=parseInt(e["ui-quiz-start"],10),a=parseInt(e["ui-quiz-end"],10),r=n.length,c=isNaN(o)?1:o,s=isNaN(a)?r:a;if(1!==c||s!==r){var l=n.filter((function(e,t){var n=t+1;return n>=c&&n<=s}));t.store.dispatch(new no.SetQuestions(l))}i&&setTimeout((function(){t.quizService.startQuiz()}))}))}},{key:"initInteractions",value:function(){var e=this.getCanvasInteraction(),t=this.actions.pipe(Object(L.j)(pi.UpdateNodeSelected,pi.UpdateNodesChecked,pi.UpdateNodesShown,pi.UpdateNodesPickable,pi.UpdateNodesPaint));this.interactionReady$=this.store.select(Ua.getSelectedChapter).pipe(Object(be.a)((function(e){return e&&e.readyState.model})),Object(bp.a)(1));var n=this.engineService.getCanvas();this.interactionChance$=Object(Br.a)(this.interactionReady$,this.getIntersectionObserver(n,.75)).pipe(Object(bp.a)(1)),this.firstInteraction$=Object($a.a)(e,t).pipe(Object(aO.a)(this.interactionReady$),Object(bp.a)(1))}},{key:"initBackgroundFromWidget",value:function(e){var t=this,n=e.background;n&&(this.setWidgetTransparent(ai.isTransparent(n)),this.actions.pipe(Object(L.i)(Cn),Object(bp.a)(1),Object(fe.a)(this.ngUnsubscribe)).subscribe((function(){t.store.dispatch(new Fn(n))})))}},{key:"initBackgroundFromChapter",value:function(){var e=this;this.store.select(Ua.getSelectedChapter).pipe(Object(be.a)((function(e){return null!=e})),Object(K.a)((function(e){return ai.isTransparent(e.background)})),Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){e.setWidgetTransparent(t)}))}},{key:"initCamera",value:function(e){var t=this,n=e.camera;n&&this.actions.pipe(Object(L.j)(Ur),Object(bp.a)(1),Object(fe.a)(this.ngUnsubscribe)).subscribe((function(){t.store.dispatch(new Wt(n,!1))}))}},{key:"initRotation",value:function(e){var t=this,n=e["load-rotate"];if(n){var i=performance.now();Object(RS.a)(0,NS.a).pipe(Object(K.a)((function(){return n*(performance.now()-i)*.001})),Object(hn.a)((function(){return i=performance.now()})),Object(fe.a)(this.firstInteraction$),Object(fe.a)(this.ngUnsubscribe)).subscribe((function(e){t.cameraService.rotateCameraStatic(0,e)})),this.firstInteraction$.pipe(Object(fe.a)(this.ngUnsubscribe)).subscribe((function(){var e=t.store.selectSnapshot(Ua.getSelectedChapter),n=Object(Oe.get)(e,"camera.location");n&&t.store.dispatch(new Wt(n,!0,2))}))}}},{key:"initHumanReadyListener",value:function(){var e=this;this.actions.pipe(Object(L.j)(z.platform===I.SDK?Hr:Vr)).pipe(Object(fe.a)(this.ngUnsubscribe)).subscribe((function(){e.engineService.fireEvent(Lt.Started,null)}))}},{key:"initChaptersReadyListener",value:function(){var e=this;this.store.select(Ua.getAllChaptersModelsReady).pipe(Object(be.a)((function(e){return!0===e})),Object(fe.a)(this.ngUnsubscribe)).subscribe((function(){e.store.dispatch(new Vr),e.engineService.fireEvent(Lt.TimelineChaptersActivated,{oldChapterIndex:0,newChapterIndex:0,time:0})}))}},{key:"initDynamicLayout",value:function(){var e=this;Object(Ka.b)([this.store.select(de.getWidgetApiUIConfig),this.store.select(de.getWidgetUrlConfig),this.store.select(Ua.getSelectedChapter),this.store.select(So.getQuizModeActive),this.store.select(So.getActiveQuestion)]).pipe(Object(be.a)((function(e){var t=u(e,3),n=(t[0],t[1]);return null!=t[2]&&null!=n})),Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){var n=u(t,5),i=n[0],o=n[1],a=n[2],r=n[3],c=(n[4],ju.convertUrlUIConfigToUIConfig(o)),s=ju.chapterUItoUIConfig(a.ui),l=ju.generateQuizUIConfig();e.viewService.setUI({apiUIConfig:i,urlUIConfig:c,chapterUIConfig:s,quizUIConfig:r?l:null})}))}},{key:"handleContentErrors",value:function(){this.store.dispatch(new Ir(null,null)),this.errorService.redirectToErrorPage($_.Content)}},{key:"handleAuthErrors",value:function(e){z.deploy!==M.Local&&this.errorService.redirectToErrorPage(K_.Auth,e.response.errorCode)}},{key:"getCanvasInteraction",value:function(){var e,t=this;return new he.a((function(n){var i=t.engineService.getCanvas();(e=new Bc.Manager(i)).add([new Bc.Tap({event:"singletap"}),new Bc.Tap({event:"doubletap",taps:2}),new Bc.Pan({event:"pan",direction:Bc.DIRECTION_ALL,threshold:0})]);var o=(function(){return n.next()}).bind(t);e.on("panstart",o),e.on("singletap",o)})).pipe(Object(ae.a)((function(){e&&(e.destroy(),e=null)})),Object(fe.a)(this.ngUnsubscribe))}},{key:"getIntersectionObserver",value:function(e,t){return new he.a((function(n){var i=new IntersectionObserver((function(o){o[0].intersectionRatio>=t&&(n.next(e),n.complete(),i.unobserve(e))}),{root:null,threshold:t});i.observe(e)}))}},{key:"setWidgetTransparent",value:function(e){e?this.renderer.setStyle(document.body,"background","none transparent"):this.renderer.removeStyle(document.body,"background")}}]),e}(),fj.\u0275fac=function(e){return new(e||fj)(_.Pb(L.g),_.Pb(L.b),_.Pb(we.a),_.Pb(W_),_.Pb(J_),_.Pb(Nt),_.Pb(dn),_.Pb(Lc),_.Pb(_.H),_.Pb(Bu),_.Pb(lf))},fj.\u0275cmp=_.Jb({type:fj,selectors:[["app-widget-master"]],decls:5,vars:3,consts:[[1,"widget","theme-light"],[1,"widget__messages","pt-2","pr-2","pl-2"],["appShowIE11",""],["class","widget-shell",4,"appFlagApplication","appFlagApplicationPlatform","appFlagApplicationMode"],[1,"widget-shell"]],template:function(e,t){1&e&&(_.Vb(0,"div",0),_.Qb(1,"router-outlet"),_.Vb(2,"div",1),_.Qb(3,"app-ie-warning",2),_.Ub(),_.Ub(),_.Kc(4,rj,1,0,"div",3)),2&e&&(_.Db(4),_.lc("appFlagApplication",t.environmentApplication.All)("appFlagApplicationPlatform",t.environmentPlatform.SDK)("appFlagApplicationMode","exclude"))},directives:[we.g,oj,aj,ul],styles:[".widget__messages[_ngcontent-%COMP%]{display:flex;flex-direction:column;z-index:101}.widget-shell[_ngcontent-%COMP%], .widget__messages[_ngcontent-%COMP%]{position:fixed;top:0;left:0;right:0}.widget-shell[_ngcontent-%COMP%]{pointer-events:none;bottom:0;z-index:99999;border:var(--widget-shell-border)}"]}),fj),resolve:{widgetUrlConfig:AS},children:[{path:"",component:FS},{path:"error",component:(hj=function(){function e(t,n){m(this,e),this.route=t,this.snackBar=n,this.supportURL="https://support.biodigital.com",this.isSceneJSError=!1,this.viewSceneJSErrorDetails=!1}return v(e,[{key:"handleSeeDetailsClick",value:function(){this.viewSceneJSErrorDetails=!0}},{key:"buildSceneJSErrorReport",value:function(e,t){return{contentId:e,error:JSON.parse(atob(t)),webglInfo:window.SceneJS.WEBGL_INFO}}},{key:"title",get:function(){return this.errorConfig.title}},{key:"description",get:function(){return this.errorConfig.description}},{key:"ngOnInit",value:function(){var e=this.route.snapshot.queryParams,t=e.errorType,n=e.errorCode,i=e.errorBlob,o=e.errorUrl;if(t===$_.SceneJS){this.isSceneJSError=!0;var a=this.buildSceneJSErrorReport(o,i);this.sceneJSErrorTeaser=a.error.errorName,this.sceneJSErrorReport=JSON.stringify(a,null,2)}else this.errorConfig=t===$_.Content?cj:lj[n]||sj}},{key:"handleDownloadClick",value:function(){Object(la.saveAs)(new Blob([this.sceneJSErrorReport],{type:"text/plain"}),"BioDigital_Error_Report.txt")}},{key:"handleActionClick",value:function(e){window.open(e)||this.snackBar.open("Unable to open link in new window, please check your pop-up settings.")}}]),e}(),hj.\u0275fac=function(e){return new(e||hj)(_.Pb(we.a),_.Pb(Ys.b))},hj.\u0275cmp=_.Jb({type:hj,selectors:[["app-error-page"]],decls:4,vars:2,consts:[[1,"error"],[4,"ngIf","ngIfElse"],["notSceneJSError",""],[1,"text-24","text-bold"],[1,"text-16","mt-4","mb-8"],[1,"text-semibold"],[1,"text-16","mb-4"],[1,"text-16"],[1,"mv-4"],["app-button","","buttonType","outline","buttonTheme","light",3,"click"],[1,"mt-8"],["app-button","","buttonType","outline","buttonTheme","light","buttonSize","xsmall",3,"click",4,"ngIf"],["class","error__details mt-2",3,"value",4,"ngIf"],["app-button","","buttonType","outline","buttonTheme","light","buttonSize","xsmall",3,"click"],[1,"error__details","mt-2",3,"value"],[1,"flex","items-start","mt-10"],[1,"error__description","text-16","mt-8",3,"innerHTML"]],template:function(e,t){if(1&e&&(_.Vb(0,"div",0),_.Kc(1,dj,22,3,"div",1),_.Kc(2,gj,7,2,"ng-template",null,2,_.Lc),_.Ub()),2&e){var n=_.vc(3);_.Db(1),_.lc("ngIf",t.isSceneJSError)("ngIfElse",n)}},directives:[or.l,sl],styles:[".error[_ngcontent-%COMP%]{margin:0 auto;max-width:640px;display:flex;flex-direction:column;padding:40px;color:#283853}.error[_ngcontent-%COMP%]   ol[_ngcontent-%COMP%]{list-style:decimal}.error__details[_ngcontent-%COMP%]{width:100%;height:200px}.error__description[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .error__description[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:visited{color:#283853}"],changeDetection:0}),hj)}]}],wj=!0===z.offline?we.f.forRoot(xj,{useHash:!0}):we.f.forRoot(xj),kj=((bj=function e(){m(this,e)}).\u0275mod=_.Nb({type:bj}),bj.\u0275inj=_.Mb({factory:function(e){return new(e||bj)},providers:[AS],imports:[[wj],we.f]}),bj),Oj=h("f6nW"),Cj=h("FvrZ"),Sj=h("bSwM"),_j=h("FKr1"),jj=h("bTqV"),Pj=h("d3UM"),Mj=h("/t3+"),Ij=h("jaxi"),zj=h("XhcP"),Tj=h("bv9b"),Uj={disabled:!0,animation:{enterDuration:0,exitDuration:0}},Lj=Object.assign(Object.assign({},Object(rg.b)()),{touchGestures:"off"}),Dj=((vj=function e(){m(this,e)}).\u0275mod=_.Nb({type:vj}),vj.\u0275inj=_.Mb({factory:function(e){return new(e||vj)},providers:[{provide:Ys.a,useValue:{duration:3e3}},{provide:_j.d,useValue:Uj},{provide:rg.a,useValue:Lj}],imports:[[Pa.b,Oj.a,Sj.a,Sj.a,jj.b,Tb.c,Pj.a,ll.c,Mj.a,Ij.a,Xd.f,rg.d,Ys.c,dl.b,zj.a,bs.g,wf.f,Of.f],Pa.b,Oj.a,Cj.a,Sj.a,Sj.a,jj.b,Tb.c,Pj.a,ll.c,Mj.a,Ij.a,Xd.f,rg.d,Ys.c,dl.b,zj.a,bs.g,wf.f,Of.f,Tj.a]}),vj),Ej=h("R9Cn"),Fj=((yj=function e(){m(this,e)}).\u0275mod=_.Nb({type:yj}),yj.\u0275inj=_.Mb({factory:function(e){return new(e||yj)},imports:[[Dj,Hg.i,or.c]]}),yj),Aj=((mj=function e(){m(this,e)}).\u0275mod=_.Nb({type:mj}),mj.\u0275inj=_.Mb({factory:function(e){return new(e||mj)},imports:[[or.c,Hg.i]]}),mj),Rj=function e(){m(this,e)};function Nj(){return window}var Vj,Hj,Bj,Qj,qj,Wj=((Hj=function(){function e(t){var n=this;if(m(this,e),!t.accountUrl)throw new Error("Missing accountUrl. Please set in app config via ZendeskWidgetProvider");this.window=Nj();var i=this.window;i.zEmbed||function(e,n){var o,a,r,c,s=[],l=document.createElement("iframe");i.zEmbed=function(){s.push(arguments)},i.zE=i.zE||i.zEmbed,l.src="javascript:false",l.title="",l.style.cssText="display: none",(r=(r=document.getElementsByTagName("script"))[r.length-1]).parentNode.insertBefore(l,r),c=l.contentWindow.document;try{a=c}catch(e){o=document.domain,l.src='javascript:var d=document.open();d.domain="'+o+'";void(0);',a=c}a.open()._l=function(){var e=this.createElement("script");o&&(this.domain=o),e.id="js-iframe-async",e.src="https://assets.zendesk.com/embeddable_framework/main.js",this.t=+new Date,this.zendeskHost=t.accountUrl,this.zEQueue=s,this.body.appendChild(e)},a.write('<body onload="document._l();">'),a.close()}(),this.window.zE((function(){t.beforePageLoad(n.window.zE)}))}return v(e,[{key:"setLocale",value:function(e){var t=this;this.window.zE((function(){t.window.zE.setLocale(e)}))}},{key:"identify",value:function(e){var t=this,n={name:this.getUserFullName(e),email:e.email};this.window.zE((function(){t.window.zE.identify(n)}))}},{key:"hide",value:function(){var e=this;this.window.zE((function(){e.window.zE.hide()}))}},{key:"show",value:function(){var e=this;this.window.zE((function(){e.window.zE.show()}))}},{key:"activate",value:function(e){var t=this;this.window.zE((function(){t.window.zE.activate(e)}))}},{key:"setHelpCenterSuggestions",value:function(e){var t=this;this.window.zE((function(){t.window.zE.setHelpCenterSuggestions(e)}))}},{key:"setSettings",value:function(e){this.window.zESettings=e}},{key:"updateFromProfile",value:function(e){var t=[];if(null!=e){var n=e.premium_account,i=e.premium_account_type,o=e.developer_account,a=e.subscription;n?(t.push("premium_account_"+i),a&&t.push("subscription_"+a.subscription_provider)):t.push("free_account"),o&&t.push("developer_account")}var r=Object(Oe.get)(e,"premium_account_valid",!1);this.setSettings({webWidget:{position:{horizontal:"right",vertical:"bottom"},offset:{horizontal:"0px",vertical:"0px"},contactForm:{suppress:!r,tags:t,fields:[{id:"name",prefill:{"*":this.getUserFullName(e)}}]}}})}},{key:"getUserFullName",value:function(e){if(e){var t=e.first_name,n=e.last_name;return"".concat(t," ").concat(n)}return""}}]),e}()).\u0275fac=function(e){return new(e||Hj)(_.Zb(Rj))},Hj.\u0275prov=_.Lb({token:Hj,factory:Hj.\u0275fac,providedIn:"root"}),Hj),$j=((Vj=function(){function e(){m(this,e)}return v(e,null,[{key:"forRoot",value:function(t){return{ngModule:e,providers:[{provide:t,useClass:t},{provide:Wj,useClass:Wj,deps:[t]}]}}}]),e}()).\u0275mod=_.Nb({type:Vj}),Vj.\u0275inj=_.Mb({factory:function(e){return new(e||Vj)},imports:[[or.c]]}),Vj),Kj=function(e){t(o,e);var n=i(o);function o(){var e;return m(this,o),(e=n.apply(this,arguments)).accountUrl="biodigital.zendesk.com",e}return v(o,[{key:"beforePageLoad",value:function(e){e.setLocale("en"),e.hide()}}]),o}(Rj),Gj=((qj=function e(){m(this,e)}).\u0275mod=_.Nb({type:qj}),qj.\u0275inj=_.Mb({factory:function(e){return new(e||qj)},imports:[[$j.forRoot(Kj)]]}),qj),Zj=((Qj=function e(){m(this,e)}).\u0275mod=_.Nb({type:Qj}),Qj.\u0275inj=_.Mb({factory:function(e){return new(e||Qj)},imports:[[or.c]]}),Qj),Jj=((Bj=function e(){m(this,e)}).\u0275mod=_.Nb({type:Bj}),Bj.\u0275inj=_.Mb({factory:function(e){return new(e||Bj)},imports:[[or.c,Zj,Dj]]}),Bj);function Xj(e,t){if(1&e){var n=_.Wb();_.Vb(0,"div",6),_.cc("click",(function(){_.zc(n);var e=_.gc(2).$implicit;return _.gc().handleExpandClick(e,!0)})),_.Ub()}if(2&e){var i=_.gc(2).$implicit;_.lc("title",i.label)}}function Yj(e,t){if(1&e&&(_.Vb(0,"div",4),_.Kc(1,Xj,1,1,"div",5),_.Qb(2,"app-tree-group",2),_.Ub()),2&e){var n=_.gc().$implicit,i=_.gc();_.Db(1),_.lc("ngIf",i.hasChildren(n)),_.Db(1),_.lc("graph",i.graph)("node",n)("theme",i.theme)}}var eP=function(e,t){return{"tree-group--light":e,"tree-group--themed":t}};function tP(e,t){if(1&e&&(_.Vb(0,"div",1),_.Qb(1,"app-tree-nested-node",2),_.Kc(2,Yj,3,4,"div",3),_.Ub()),2&e){var n=t.$implicit,i=_.gc();_.lc("ngClass",_.pc(5,eP,i.theme===i.treeTheme.Light,i.theme===i.treeTheme.Themed)),_.Db(1),_.lc("graph",i.graph)("node",n)("theme",i.theme),_.Db(1),_.lc("ngIf",n.boolState.expanded)}}var nP,iP,oP,aP,rP=((aP=function(){function e(t,n){m(this,e),this.graphService=t,this.store=n,this.treeTheme=gs,this.graphSubject=new Wa.a(null),this.theme=gs.Dark,this.nodes=[],this.ngUnsubscribe=new ge.a}return v(e,[{key:"graph",get:function(){return this._graph},set:function(e){e&&(this._graph=e,this.graphSubject.next(e))}},{key:"ngOnInit",value:function(){var e=this;this.graphSubject.pipe(Object(fe.a)(this.ngUnsubscribe)).subscribe((function(t){t&&e.getNodes()}))}},{key:"ngOnDestroy",value:function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},{key:"getNodes",value:function(){var e=this.node?ye.getSuccessors(this.graph,this.node.id):ye.getRoots(this.graph);this.nodes=this.graphService.getNodes(this.graph,e)}},{key:"countChildren",value:function(e){return ye.getSuccessors(this.graph,e.id).length}},{key:"hasChildren",value:function(e){return this.countChildren(e)>0}},{key:"trackTreeNode",value:function(e,t){return t.id}},{key:"handleExpandClick",value:function(e,t){this.store.dispatch(t?new ht(e):new gt(e))}}]),e}()).\u0275fac=function(e){return new(e||aP)(_.Pb(St),_.Pb(L.g))},aP.\u0275cmp=_.Jb({type:aP,selectors:[["app-tree-group"]],inputs:{graph:"graph",theme:"theme",node:"node"},decls:1,vars:2,consts:[["class","tree-group",3,"ngClass",4,"ngFor","ngForOf","ngForTrackBy"],[1,"tree-group",3,"ngClass"],[3,"graph","node","theme"],["class","tree-group__children",4,"ngIf"],[1,"tree-group__children"],["class","tree-group__collapse",3,"title","click",4,"ngIf"],[1,"tree-group__collapse",3,"title","click"]],template:function(e,t){1&e&&_.Kc(0,tP,3,8,"div",0),2&e&&_.lc("ngForOf",t.nodes)("ngForTrackBy",t.trackTreeNode)},directives:[or.k,or.i,Al,or.l,aP],styles:['.text-8[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.2px;line-height:1.4em}.text-8.text-uppercase[_ngcontent-%COMP%]{font-size:8px;letter-spacing:.48px;line-height:1.25em;text-transform:uppercase}.text-9[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.225px;line-height:1.4em}.text-9.text-uppercase[_ngcontent-%COMP%]{font-size:9px;letter-spacing:.54px;line-height:1.25em;text-transform:uppercase}.text-10[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.25px;line-height:1.4em}.text-10.text-uppercase[_ngcontent-%COMP%]{font-size:10px;letter-spacing:.6px;line-height:1.25em;text-transform:uppercase}.text-11[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.275px;line-height:1.4em}.text-11.text-uppercase[_ngcontent-%COMP%]{font-size:11px;letter-spacing:.66px;line-height:1.25em;text-transform:uppercase}.text-12[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.3px;line-height:1.4em}.text-12.text-uppercase[_ngcontent-%COMP%]{font-size:12px;letter-spacing:.72px;line-height:1.25em;text-transform:uppercase}.text-13[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.325px;line-height:1.4em}.text-13.text-uppercase[_ngcontent-%COMP%]{font-size:13px;letter-spacing:.78px;line-height:1.25em;text-transform:uppercase}.text-14[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.35px;line-height:1.4em}.text-14.text-uppercase[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.84px;line-height:1.25em;text-transform:uppercase}.text-16[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.4px;line-height:1.4em}.text-16.text-uppercase[_ngcontent-%COMP%]{font-size:16px;letter-spacing:.96px;line-height:1.25em;text-transform:uppercase}.text-18[_ngcontent-%COMP%]{font-size:18px;letter-spacing:.45px;line-height:1.4em}.text-18.text-uppercase[_ngcontent-%COMP%]{font-size:18px;letter-spacing:1.08px;line-height:1.25em;text-transform:uppercase}.text-20[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.5px;line-height:1.4em}.text-20.text-uppercase[_ngcontent-%COMP%]{font-size:20px;letter-spacing:1.2px;line-height:1.25em;text-transform:uppercase}.text-22[_ngcontent-%COMP%]{font-size:22px;letter-spacing:.55px;line-height:1.4em}.text-22.text-uppercase[_ngcontent-%COMP%]{font-size:22px;letter-spacing:1.32px;line-height:1.25em;text-transform:uppercase}.text-24[_ngcontent-%COMP%]{font-size:24px;letter-spacing:.6px;line-height:1.4em}.text-24.text-uppercase[_ngcontent-%COMP%]{font-size:24px;letter-spacing:1.44px;line-height:1.25em;text-transform:uppercase}.text-header[_ngcontent-%COMP%]{font-weight:700}.text--code[_ngcontent-%COMP%]{font-family:Courier New,Courier,monospace}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase}.text-xlight[_ngcontent-%COMP%]{font-weight:200}.text-light[_ngcontent-%COMP%]{font-weight:300}.text-medium[_ngcontent-%COMP%]{font-weight:500}.text-semibold[_ngcontent-%COMP%]{font-weight:600}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-underline[_ngcontent-%COMP%]{text-decoration:underline}.text-italic[_ngcontent-%COMP%]{font-style:italic}.text-bright[_ngcontent-%COMP%]{color:#fff}.text-dim[_ngcontent-%COMP%]{color:#96a8c0}.text-error[_ngcontent-%COMP%]{color:#ed4758}.text-left[_ngcontent-%COMP%]{text-align:left}.text-center[_ngcontent-%COMP%]{text-align:center}.text-right[_ngcontent-%COMP%]{text-align:right}.text-ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.text-link[_ngcontent-%COMP%], .text-link[_ngcontent-%COMP%]:visited{color:inherit;cursor:pointer}.text-link[_ngcontent-%COMP%]:not(.text-underline), .text-link[_ngcontent-%COMP%]:visited:not(.text-underline){text-decoration:none}.text-success[_ngcontent-%COMP%]{color:#38de38}.text-danger[_ngcontent-%COMP%]{color:#de3838}.text-info[_ngcontent-%COMP%]{color:#0060c4}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.text-pre-line[_ngcontent-%COMP%]{white-space:pre-line}.tree-group[_ngcontent-%COMP%]{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.tree-group--themed[_ngcontent-%COMP%]   .tree-group__collapse[_ngcontent-%COMP%]:after{background:var(--tree-node-collapse-color)}.tree-group--themed[_ngcontent-%COMP%]   .tree-group__collapse[_ngcontent-%COMP%]:hover{background:transparent}.tree-group--themed[_ngcontent-%COMP%]   .tree-group__collapse[_ngcontent-%COMP%]:hover:after{background:var(--tree-node-collapse-color--hover)}.tree-group--light[_ngcontent-%COMP%]   .tree-group__collapse[_ngcontent-%COMP%]:after{background:#eaeff5}.tree-group--light[_ngcontent-%COMP%]   .tree-group__collapse[_ngcontent-%COMP%]:hover{background:transparent}.tree-group--light[_ngcontent-%COMP%]   .tree-group__collapse[_ngcontent-%COMP%]:hover:after{background:#d7e0ea}.tree-group__children[_ngcontent-%COMP%]{padding-left:20px;position:relative}.tree-group__collapse[_ngcontent-%COMP%]{position:absolute;left:0;top:0;bottom:0;width:20px;z-index:1}.tree-group__collapse[_ngcontent-%COMP%]:after{content:" ";display:block;position:absolute;width:1px;left:10px;top:0;bottom:0;background:#1c2a3f}.tree-group__collapse[_ngcontent-%COMP%]:hover{cursor:pointer}.tree-group__collapse[_ngcontent-%COMP%]:hover:after{background:#283853}'],changeDetection:0}),aP),cP=((oP=function e(){m(this,e)}).\u0275mod=_.Nb({type:oP}),oP.\u0275inj=_.Mb({factory:function(e){return new(e||oP)},imports:[[or.c]]}),oP),sP=((iP=function e(){m(this,e)}).\u0275mod=_.Nb({type:iP}),iP.\u0275inj=_.Mb({factory:function(e){return new(e||iP)},imports:[[or.c,cP,Dj,Jj,Zj,ke.d]]}),iP),lP=((nP=function e(){m(this,e)}).\u0275mod=_.Nb({type:nP}),nP.\u0275inj=_.Mb({factory:function(e){return new(e||nP)},imports:[[or.c,Zj,Dj,sP,cP,ke.d]]}),nP);_.Dc(hs,[rP],[or.b]);var pP,uP,dP,gP,hP,fP,bP,vP,mP,yP,xP,wP,kP,OP=((mP=function e(){m(this,e)}).\u0275mod=_.Nb({type:mP}),mP.\u0275inj=_.Mb({factory:function(e){return new(e||mP)},imports:[[or.c]]}),mP),CP=((vP=function e(){m(this,e)}).\u0275mod=_.Nb({type:vP}),vP.\u0275inj=_.Mb({factory:function(e){return new(e||vP)},imports:[[or.c,df.b,Dj,OP,cP]]}),vP),SP=((bP=function e(){m(this,e)}).\u0275mod=_.Nb({type:bP}),bP.\u0275inj=_.Mb({factory:function(e){return new(e||bP)},imports:[[or.c]]}),bP),_P=((fP=function e(){m(this,e)}).\u0275mod=_.Nb({type:fP}),fP.\u0275inj=_.Mb({factory:function(e){return new(e||fP)},imports:[[or.c]]}),fP),jP=((hP=function e(){m(this,e)}).\u0275mod=_.Nb({type:hP}),hP.\u0275inj=_.Mb({factory:function(e){return new(e||hP)},imports:[[or.c,Jj,Dj,ke.d]]}),hP),PP=((gP=function e(){m(this,e)}).\u0275mod=_.Nb({type:gP}),gP.\u0275inj=_.Mb({factory:function(e){return new(e||gP)},imports:[[or.c]]}),gP),MP=((dP=function e(){m(this,e)}).\u0275mod=_.Nb({type:dP}),dP.\u0275inj=_.Mb({factory:function(e){return new(e||dP)},imports:[[or.c,OP]]}),dP),IP=((uP=function e(){m(this,e)}).\u0275mod=_.Nb({type:uP}),uP.\u0275inj=_.Mb({factory:function(e){return new(e||uP)},imports:[[or.c,Zj]]}),uP),zP=((pP=function e(){m(this,e)}).\u0275mod=_.Nb({type:pP}),pP.\u0275inj=_.Mb({factory:function(e){return new(e||pP)},imports:[[we.f,Jj,CP,Ej.a,MP,or.c,cP,Zj,SP,Fj,Dj,IP,sP,jP,_P,OP,Hg.q,Aj,PP,lP,Gj,Od.a.forChild()],Jj,CP,MP,cP,SP,Zj,Fj,IP,sP,_P,jP,OP,Aj,PP,lP]}),pP),TP=function e(){m(this,e)},UP=function(){var e=function e(t){m(this,e),this.widgetURL=t};return e.type="[Publish] Set Widget URL",e}(),LP=function(){var e=function e(t){m(this,e),this.dimensions=t};return e.type="[Publish] Set Dimensions",e}(),DP=function(){var e=function e(t,n,i){m(this,e),this.model=t,this.widgetOptions=n,this.camera=i};return e.type="[Publish] Get iFrame",e}(),EP=function(){var e=function e(t){m(this,e),this.embed=t};return e.type="[Publish] Get iFrame Success",e}(),FP=function(){var e=function e(){m(this,e)};return e.type="[Publish] Get iFrame Fail",e}(),AP=function(){var e=function e(t,n,i){m(this,e),this.model=t,this.widgetOptions=n,this.camera=i};return e.type="[Publish] Get URL",e}(),RP=function(){var e=function e(t,n){m(this,e),this.model=t,this.url=n};return e.type="[Publish] Get URL Success",e}(),NP=function(){var e=function e(t){m(this,e),this.model=t};return e.type="[Publish] Get URL Fail",e}(),VP=function(){var e=function e(t){m(this,e),this.publishing=t};return e.type="[Publish] Set Publishing",e}(),HP=function(){var e=function e(){m(this,e)};return e.type="[Publish] Reset Publishing",e}(),BP=function(){var e=function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"jpeg";m(this,e),this.imageData=t,this.imageType=n};return e.type="[Publish] Save Publish Image",e}(),QP=function(){var e=function e(t){m(this,e),this.imageURL=t};return e.type="[Publish] Save Publish Image Success",e}(),qP=function(){var e=function e(){m(this,e)};return e.type="[Publish] Save Publish Image Fail",e}(),WP=function(){var e=function e(t,n,i,o,a){m(this,e),this.model=t,this.imageData=n,this.fileType=i,this.widgetOptions=o,this.camera=a};return e.type="[Publish] Get Publish Image Code",e}(),$P=function(){var e=function e(t){m(this,e),this.embed=t};return e.type="[Publish] Get Publish Image Code Success",e}(),KP=function(){var e=function e(){m(this,e)};return e.type="[Publish] Get Publish Image Code Fail",e}(),GP=function e(){m(this,e)},ZP=function(){var e=function e(){m(this,e)};return e.type="[Auth] Is Logged In",e}(),JP=function(){var e=function e(){m(this,e)};return e.type="[Auth] Is Logged In Success",e}(),XP=function(){var e=function e(){m(this,e)};return e.type="[Auth] Is Logged In Failure",e}(),YP=function(){var e=function e(t){m(this,e),this.login=t};return e.type="[Auth] Login With Biodigital",e}(),eM=function(){var e=function e(t){m(this,e),this.login=t};return e.type="[Auth] Login With Google",e}(),tM=function(){var e=function e(t){m(this,e),this.login=t};return e.type="[Auth] Login With Facebook",e}(),nM=function(){var e=function e(t){m(this,e),this.response=t};return e.type="[Auth] Login Success",e}(),iM=function(){var e=function e(t,n){m(this,e),this.error=t,this.login=n};return e.type="[Auth] Login Failure",e}(),oM=function(){var e=function e(){m(this,e)};return e.type="[Auth] Logout",e}(),aM=function(){var e=function e(){m(this,e)};return e.type="[Auth] Logout Success",e}(),rM=function(){var e=function e(){m(this,e)};return e.type="[Auth] Logout Failure",e}(),cM=function(){var e=function e(){m(this,e)};return e.type="[Auth] Get Environment Settings",e}(),sM=function(){var e=function e(t){m(this,e),this.environmentSettings=t};return e.type="[Auth] Get Environment Settings Success",e}(),lM=function(){var e=function e(t){m(this,e),this.error=t};return e.type="[Auth] Get Environment Settings Failure",e}(),pM=function(){var e=function e(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];m(this,e),this.hardCheck=t};return e.type="[Auth] Get User Profile",e}(),uM=function(){var e=function e(t){m(this,e),this.userProfile=t};return e.type="[Auth] Get User Profile Success",e}(),dM=function(){var e=function e(t){m(this,e),this.error=t};return e.type="[Auth] Get User Profile Failure",e}(),gM=function(){var e=function e(t){m(this,e),this.userProfile=t};return e.type="[Auth] Update User Profile",e}(),hM=function(){var e=function e(t){m(this,e),this.userProfile=t};return e.type="[Auth] Update User Profile Success",e}(),fM=function(){var e=function e(t){m(this,e),this.error=t};return e.type="[Auth] Update User Profile Failure",e}(),bM=function(){var e=function e(){m(this,e)};return e.type="[Auth] Delete User Profile",e}(),vM=function(){var e=function e(t){m(this,e),this.userEmail=t};return e.type="[Auth] Delete User Profile Success",e}(),mM=function(){var e=function e(t){m(this,e),this.error=t};return e.type="[Auth] Delete User Profile Failure",e}(),yM=function(){var e=function e(t){m(this,e),this.email=t};return e.type="[Auth] Check Profile",e}(),xM=function(){var e=function e(t){m(this,e),this.profile=t};return e.type="[Auth] Check Profile Success",e}(),wM=function(){var e=function e(t){m(this,e),this.error=t};return e.type="[Auth] Check Profile Failure",e}(),kM=function(){var e=function e(t){m(this,e),this.email=t};return e.type="[Auth] Reset Password",e}(),OM=function(){var e=function e(t){m(this,e),this.email=t};return e.type="[Auth] Reset Password Success",e}(),CM=function(){var e=function e(t){m(this,e),this.error=t};return e.type="[Auth] Reset Password Failure",e}(),SM=function(){var e=function e(t,n,i){m(this,e),this.currentPassword=t,this.newPassword=n,this.confirmNewPassword=i};return e.type="[Auth] Update Password",e}(),_M=function(){var e=function e(){m(this,e)};return e.type="[Auth] Update Password Success",e}(),jM=function(){var e=function e(t){m(this,e),this.error=t};return e.type="[Auth] Update Password Failure",e}(),PM=function(){var e=function e(){m(this,e)};return e.type="[Auth] Check Session",e}(),MM=function(){var e=function e(t){m(this,e),this.value=t};return e.type="[Auth] Sign Up",e}(),IM=function(){var e=function e(t){m(this,e),this.response=t};return e.type="[Auth] Sign Up Success",e}(),zM=function(){var e=function e(t){m(this,e),this.error=t};return e.type="[Auth] Sign Up Failure",e}(),TM=function(){var e=function e(t){m(this,e),this.locale=t};return e.type="[Auth] Set User Locale",e}(),UM=function(){var e=function e(t){m(this,e),this.locale=t};return e.type="[Auth] Set User Locale Success",e}(),LM=function(){var e=function e(){m(this,e)};return e.type="[Auth] Check Locale",e}(),DM=function(){var e=function e(){m(this,e)};return e.type="[Auth] Get User Apps",e}(),EM=function(){var e=function e(t){m(this,e),this.apps=t};return e.type="[Auth] Set User Apps",e}(),FM=function(){var e=function e(){m(this,e)};return e.type="[Auth] Check Selected App",e}(),AM=function(){var e=function e(t){m(this,e),this.appId=t};return e.type="[Auth] Set Selected User App",e}(),RM=function(){var e=function e(t){m(this,e),this.message=t};return e.type="[Auth] Send User Message",e}(),NM=function(){var e=function e(t){m(this,e),this.message=t};return e.type="[Auth] Send User Message Success",e}(),VM=function(){var e=function e(t){m(this,e),this.err=t};return e.type="[Auth] Send User Message Fail",e}(),HM=function(){var e=function e(t,n){m(this,e),this.type=t,this.mode=n};return e.type="[Auth] Get User Message",e}(),BM=function(){var e=function e(t){m(this,e),this.message=t};return e.type="[Auth] Get User Message Success",e}(),QM=function(){var e=function e(t){m(this,e),this.type=t};return e.type="[Auth] Get User Message Fail",e}(),qM=function(){var e=function e(t){m(this,e),this.messageSeenId=t};return e.type="[Auth] Set Message Viewed",e}(),WM=function(){var e=function e(){m(this,e)};return e.type="[Auth] Set Message Viewed Success",e}(),$M=function(){var e=function e(){m(this,e)};return e.type="[Auth] Set Message Viewed Fail",e}(),KM=function(){var e=function e(){m(this,e)};return e.type="[Auth] Verify Fail",e}(),GM=function(){var e=function e(){m(this,e)};return e.type="[Auth] Reset",e}(),ZM=function e(){m(this,e)},JM=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},XM=(yP=function e(){m(this,e)},function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);a>3&&r&&Object.defineProperty(t,n,r)}([Object(Y.Type)((function(){return ZM})),JM("design:type",Array)],yP.prototype,"organizations",void 0),yP),YM=h("ahC7"),eI=function(){function e(){m(this,e)}return v(e,null,[{key:"fromJSON",value:function(t){var n=new e;return n.email=t.user_email,n.credentials=t.credentials,n.isUser=t.is_user,n.isThirdParty=t.user_is_third_party,n.thirdPartyProvider=t.user_third_party_provider,n.isDeveloper=t.user_is_developer,n.isDeveloperActive=t.user_is_developer_active,n.isDeveloperVerified=t.user_is_developer_verified,n.firstName=t.user_first_name,n.lastName=t.user_last_name,n.name="".concat(t.firstName," ").concat(t.lastName),n}}]),e}(),tI=function(){function e(){m(this,e)}return v(e,null,[{key:"fromJSON",value:function(t){var n=new e;return n.google=t.google_api_key,n.facebook=t.facebook_api_key,n}}]),e}(),nI=function e(){m(this,e),this.version=2,this.groupInviteMode=0,this.groupCodeMode=0},iI=function(e){t(o,e);var n=i(o);function o(){var e;return m(this,o),(e=n.apply(this,arguments)).version=2,e}return v(o,null,[{key:"toJSON",value:function(e){return{version:e.version,email:e.email,password:e.password,first_name:e.firstName,last_name:e.lastName,group_invite_mode:e.groupInviteMode,group_invite_key:e.groupInviteKey,group_code_mode:e.groupCodeMode,group_code:e.groupCode,platform:e.platform,return_to:e.returnTo,brand_id:e.brandId,locale_id:e.localeId,timestamp:e.timestamp,site_verify_response:e.site_verify_response}}}]),o}(nI),oI=function(e){t(o,e);var n=i(o);function o(e){var t;return m(this,o),(t=n.call(this)).token=e,t}return v(o,null,[{key:"toJSON",value:function(e){return{id_token:e.token,version:e.version,group_invite_mode:e.groupInviteMode,group_invite_key:e.groupInviteKey,group_code_mode:e.groupCodeMode,group_code:e.groupCode,platform:e.platform,return_to:e.returnTo,brand_id:e.brandId,locale_id:e.localeId,timestamp:e.timestamp,site_verify_response:e.site_verify_response}}}]),o}(nI),aI=function(e){t(o,e);var n=i(o);function o(e){var t;return m(this,o),(t=n.call(this)).token=e,t}return v(o,null,[{key:"toJSON",value:function(e){return{access_token:e.token,version:e.version,group_invite_mode:e.groupInviteMode,group_invite_key:e.groupInviteKey,group_code_mode:e.groupCodeMode,group_code:e.groupCode,platform:e.platform,return_to:e.returnTo,brand_id:e.brandId,locale_id:e.localeId,timestamp:e.timestamp,site_verify_response:e.site_verify_response}}}]),o}(nI),rI=function(e){t(o,e);var n=i(o);function o(e,t,i){var a;return m(this,o),(a=n.call(this)).email=e,a.password=t,a.rememberMe=i,a}return v(o,null,[{key:"toJSON",value:function(e){return{id_token:e.token,version:e.version,group_invite_mode:e.groupInviteMode,group_invite_key:e.groupInviteKey,group_code_mode:e.groupCodeMode,group_code:e.groupCode,email:e.email,password:e.password,email_remember_me:e.rememberMe,platform:e.platform,return_to:e.returnTo,brand_id:e.brandId,locale_id:e.localeId,timestamp:e.timestamp,site_verify_response:e.site_verify_response}}}]),o}(nI),cI=function(e){return e.Zendesk="zendesk",e}({}),sI=h("jCJ1"),lI=((xP=function(){function e(t,n,i){m(this,e),this.http=t,this.socialAuthService=n,this.reCaptchaV3Service=i,this.auth2=new Wa.a(null),this.initGoogleAuth2()}return v(e,[{key:"loginWithBiodigital",value:function(e){return this.http.post("/ws/user/sign/in",rI.toJSON(e))}},{key:"loginWithGoogle",value:function(e){return this.http.post("/ws/user/sign/in/google",oI.toJSON(e))}},{key:"loginWithFacebook",value:function(e){return this.http.post("/ws/user/sign/in/facebook",aI.toJSON(e))}},{key:"logout",value:function(){return this.http.get("/ws/user/sign/out")}},{key:"checkProfile",value:function(e){return this.http.post("/ws/user/profile/check",{version:2,email:e}).pipe(Object(K.a)((function(e){var t=eI.fromJSON(e);return t.isThirdParty=""!==t.thirdPartyProvider,t})))}},{key:"getUserProfile",value:function(e){return this.http.get(e?"/ws/user/profile?subscription_hard_check=1":"/ws/user/profile").pipe(Object(K.a)((function(e){return"string"==typeof e.organizations&&(e.organizations=JSON.parse(e.organizations)),Object(Y.plainToClass)(XM,e)})))}},{key:"updaterUserProfile",value:function(e){return this.http.post("/ws/user/profile",e)}},{key:"deleteUserProfile",value:function(){return this.http.post("/ws/user/profile/delete",{}).pipe(Object(K.a)((function(e){return e.deleted_user_email})))}},{key:"getEnvironmentSettings",value:function(){return this.http.get("/ws/environment/settings?version=2").pipe(Object(K.a)((function(e){return tI.fromJSON(e)})))}},{key:"getUserApps",value:function(){return this.http.get("/ws/developer/apps/profile").pipe(Object(K.a)((function(e){return e&&e.apps?JSON.parse(e.apps):[]})))}},{key:"getGroupConfigFromRoute",value:function(e){var t=e.queryParams.group||"",n=e.queryParams.group_invite||"";return{group:t,groupCode:e.queryParams.code||"",groupCodeMode:""!==t?1:0,groupInviteMode:""!==n?1:0,groupInviteKey:n}}},{key:"getPlatformConfigFromRoute",value:function(e){var t=e.queryParams,n=t.zendesk_signin,i=t.return_to,o=t.brand_id,a=t.locale_id,r=t.timestamp;return"1"===n?{platform:cI.Zendesk,returnTo:i,brandId:o,localeId:a,timestamp:r}:void 0}},{key:"isLoggedIn",value:function(){return this.http.get("/ws/user/is/signed-in?version=2")}},{key:"getProfileRestrictions",value:function(e){var t=!1,n=!1,i="";return e.organizations.forEach((function(e){t||n||(i=e.name,t=e.user_is_subscribed&&e.email_domain_restriction&&!e.user_has_email_domain_access,n=e.user_is_subscribed&&e.ip_address_restriction&&!e.user_has_domain_access)})),{organizationName:i,email:t,ip:n}}},{key:"resetPassword",value:function(e){return this.http.post("/ws/user/password/forgot",{email:e})}},{key:"updatePassword",value:function(e,t,n){return this.http.post("/ws/user/password/change",{current_password:e,new_password:t,confirm_new_password:n})}},{key:"signUp",value:function(e){return this.http.post("/ws/user/sign/up",iI.toJSON(e))}},{key:"authenticateWithFacebook",value:function(){return this.socialAuthService.signIn(YM.a.PROVIDER_ID)}},{key:"verifyToken",value:function(e){return this.http.post("/ws/recaptcha/siteverify",{recaptcha_reponse_token:e,recaptcha_version:"v3"}).pipe(Object(K.a)((function(e){return e})))}},{key:"isHuman",value:function(e){var t=this;return this.reCaptchaV3Service.execute(e).pipe(Object(oa.a)((function(e){return t.verifyToken(e)})),Object(K.a)((function(t){return{isHuman:t.action===e&&t.score>.2,verification:t}})))}},{key:"initGoogleAuth2",value:function(){var e=this;gapi.load("auth2",(function(){e.auth2.next(gapi.auth2.init({client_id:z.googleAuthKey,scope:"profile"}))}))}}]),e}()).\u0275fac=function(e){return new(e||xP)(_.Zb(W.b),_.Zb(YM.b),_.Zb(sI.a))},xP.\u0275prov=_.Lb({token:xP,factory:xP.\u0275fac,providedIn:"root"}),xP),pI=function(){var e=function e(t){m(this,e),this.organizations=t};return e.type="[Organizations] Set Organizations",e}(),uI=function(){var e=function e(t){m(this,e),this.organization=t};return e.type="[Organizations] Select Organization",e}(),dI=function(){var e=function e(t){m(this,e),this.collection=t};return e.type="[Organizations] Select Collection",e}(),gI=function(){var e=function e(t){m(this,e),this.organizationId=t};return e.type="[Organizations] Get Collections",e}(),hI=function(){var e=function e(t){m(this,e),this.collections=t};return e.type="[Organizations] Get Collections Success",e}(),fI=function(){var e=function e(t){m(this,e),this.organization=t};return e.type="[Organizations] Join Organization",e}(),bI=function(){var e=function e(t){m(this,e),this.organization=t};return e.type="[Organizations] Join Organization Success",e}(),vI=function(){var e=function e(t){m(this,e),this.organization=t};return e.type="[Organizations] Join Organization Fail",e}(),mI=function(){var e=function e(t){m(this,e),this.code=t};return e.type="[Organizations] Join Organization With Code",e}(),yI=function(){var e=function e(t){m(this,e),this.organizationName=t};return e.type="[Organizations] Join Organization With Code Success",e}(),xI=function(){var e=function e(t){m(this,e),this.error=t};return e.type="[Organizations] Join Organization With Code Fail",e}(),wI=function(){var e=function e(t,n){m(this,e),this.groupEID=t,this.emails=n};return e.type="[Organizations] Send Organization Invite",e}(),kI=function(){var e=function e(t){m(this,e),this.responses=t};return e.type="[Organizations] Send Organization Invite Success",e}(),OI=function(){var e=function e(t){m(this,e),this.error=t};return e.type="[Organizations] Send Organization Invite Fail",e}(),CI=function(){var e=function e(t){m(this,e),this.groupEID=t};return e.type="[Organizations] Get Organization Users",e}(),SI=function(){var e=function e(t){m(this,e),this.users=t};return e.type="[Organizations] Get Organization Users Success",e}(),_I=function(){var e=function e(t){m(this,e),this.error=t};return e.type="[Organizations] Get Organization Users Fail",e}(),jI=function(){var e=function e(){m(this,e)};return e.type="[Organizations] Reset",e}(),PI=function(e){return e.DomainAlert="join_group_through_domain_alert",e.WelcomeTour="welcome_tour_alert",e.SurveyMonkey="survey_monkey_alert",e.CompleteProfileAlert="complete_profile_alert",e}({}),MI=((wP=function(){function e(t,n){m(this,e),this.http=t,this.storageService=n}return v(e,[{key:"getUserMessage",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=this.getCachedMessage(e);return i&&o?Object($.a)(o):this.http.get("/ws/user/message?version=2&type=".concat(e,"&mode=").concat(n)).pipe(Object(K.a)((function(t){var n,i=t.message_seen_id,o=t.show_alert;switch(e){case PI.DomainAlert:n=Object(Y.plainToClass)(ZM,t.join_organization);break;case PI.WelcomeTour:n=""+t.tour_version;break;case PI.SurveyMonkey:n=""+t.survey_group_name;break;case PI.CompleteProfileAlert:n=!0===t.is_new_user}return{messageSeenId:i,messageType:e,showUserAlert:o,messageData:n}})),Object(hn.a)((function(e){e.showUserAlert||t.addCachedMessage(e)})))}},{key:"setUserMessageViewed",value:function(e){return this.http.post("/ws/user/message",{version:2,message_seen_id:e})}},{key:"sendMessage",value:function(e){return this.http.post("/ws/user/message",e)}},{key:"getCachedMessage",value:function(e){return this.getCachedMessages().find((function(t){return t.messageType===e}))}},{key:"getCachedMessages",value:function(){return this.storageService.getSessionItem(Tc.UserMessagesSeen)||[]}},{key:"addCachedMessage",value:function(e){if(!this.getCachedMessage(e.messageType)){var t=this.getCachedMessages();this.storageService.setSessionItem(Tc.UserMessagesSeen,[].concat(s(t),[e]))}}}]),e}()).\u0275fac=function(e){return new(e||wP)(_.Zb(W.b),_.Zb(Lc))},wP.\u0275prov=_.Lb({token:wP,factory:wP.\u0275fac,providedIn:"root"}),wP);!function(e){var t=function e(t){m(this,e),this.searchMode=t};t.type="[Gallery] Set Search Mode",e.SetSearchMode=t;var n=function e(t){m(this,e),this.viewMode=t};n.type="[Gallery] Set View Mode",e.SetViewMode=n;var i=function e(t){m(this,e),this.sort=t};i.type="[Gallery] Set Sort",e.SetSort=i;var o=function e(t){m(this,e),this.organizationId=t};o.type="[Gallery] Get Studio Options",e.GetStudioOptions=o;var a=function e(t){m(this,e),this.options=t};a.type="[Gallery] Get Studio Options Success",e.GetStudioOptionsSuccess=a;var r=function e(t){m(this,e),this.config=t};r.type="[Gallery] Search Loft",e.SearchLoft=r;var c=function e(t){m(this,e),this.bookmarks=t};c.type="[Gallery] Search Loft Success",e.SearchLoftSuccess=c;var s=function e(t,n){m(this,e),this.config=t,this.options=n};s.type="[Gallery] Set Search Config",e.SetSearchConfig=s;var l=function e(t){m(this,e),this.options=t};l.type="[Gallery] Set Search Options",e.SetSearchOptions=l;var p=function e(){m(this,e)};p.type="[Gallery] Search Studio",e.SearchStudio=p;var u=function e(t){m(this,e),this.bookmarks=t};u.type="[Gallery] Search Studio Success",e.SearchStudioSuccess=u;var d=function e(t){m(this,e),this.bookmarks=t};d.type="[Gallery] Search Success",e.SearchSuccess=d;var g=function e(t){m(this,e),this.result=t};g.type="[Gallery] Select Bookmark",e.SelectBookmark=g;var h=function e(t){m(this,e),this.sidenav=t};h.type="[Gallery] Set Sidenav",e.SetSidenav=h;var f=function e(t){m(this,e),this.bulkActions=t};f.type="[Gallery] Set Bulk Actions",e.SetBulkActions=f;var b=function e(t){m(this,e),this.cardActions=t};b.type="[Gallery] Set Card Actions",e.SetCardActions=b;var v=function e(){m(this,e)};v.type="[Gallery] Clear Results",e.ClearResults=v;var y=function e(t,n){m(this,e),this.id=t,this.checked=n};y.type="[Gallery] Check Item",e.CheckItem=y;var x=function e(t){m(this,e),this.checked=t};x.type="[Gallery] Check All",e.CheckAll=x;var w=function e(t){m(this,e),this.ids=t};w.type="[Gallery] Set Checked Items",e.SetCheckedItems=w;var k=function e(){m(this,e)};k.type="[Gallery] Reset",e.Reset=k}(kP||(kP={}));var II,zI,TI,UI,LI,DI,EI,FI,AI,RI,NI,VI,HI,BI,QI,qI,WI,$I,KI,GI,ZI,JI,XI,YI,ez,tz,nz,iz,oz,az,rz,cz=function(e){return e.Web="web",e.Mobile="mobilesdk",e}({}),sz=function(){var e=function e(){m(this,e)};return e.type="[Subscription] Reset Subscription State",e}(),lz={"Sign in":"3971305","Sign up":"3971297"},pz=((zI=function(){function e(t){m(this,e),this.config=t,this.initialized=!1}return v(e,[{key:"initialize",value:function(){if(this.config.enabled&&!this.initialized){var e='\n      _linkedin_partner_id = "'.concat(this.config.linkedinId,'"; \n      window._linkedin_data_partner_ids = window._linkedin_data_partner_ids || []; \n      window._linkedin_data_partner_ids.push(_linkedin_partner_id);\n      (function(){var s = document.getElementsByTagName("script")[0]; var b = document.createElement("script"); b.type = "text/javascript";b.async = true; b.src = "https://snap.licdn.com/li.lms-analytics/insight.min.js"; s.parentNode.insertBefore(b, s);})();\n    '),t=document.createElement("script");t.textContent=e,document.body.appendChild(t),this.initialized=!0}}},{key:"track",value:function(e){var t=lz[e];if(t){var n=document.createElement("img");n.height=1,n.width=1,n.style.display="none",n.alt="",n.src="https://px.ads.linkedin.com/collect/?pid=".concat(this.config.linkedinId,"&conversionId=").concat(t,"&fmt=gif"),document.body.appendChild(n)}}}]),e}()).\u0275fac=function(e){return new(e||zI)(_.Zb("linkedinConfig"))},zI.\u0275prov=_.Lb({token:zI,factory:zI.\u0275fac,providedIn:"root"}),zI),uz=((II=function(){function e(t){m(this,e),this.config=t,this.initialized=!1}return v(e,[{key:"initialize",value:function(){if(this.config.enabled&&!this.initialized){var e="\n      !function(f,b,e,v,n,t,s)\n      {if(f.fbq)return;n=f.fbq=function(){n.callMethod?\n      n.callMethod.apply(n,arguments):n.queue.push(arguments)};\n      if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';\n      n.queue=[];t=b.createElement(e);t.async=!0;\n      t.src=v;s=b.getElementsByTagName(e)[0];\n      s.parentNode.insertBefore(t,s)}(window,document,'script',\n      'https://connect.facebook.net/en_US/fbevents.js');\n      fbq('init', '".concat(this.config.facebookPixelId,"');\n      fbq('track', 'PageView');\n    "),t=document.createElement("script");t.textContent=e,document.head.appendChild(t),this.initialized=!0}}},{key:"trackCustom",value:function(e){fbq("trackCustom",e)}}]),e}()).\u0275fac=function(e){return new(e||II)(_.Zb("facebookPixelConfig"))},II.\u0275prov=_.Lb({token:II,factory:II.\u0275fac,providedIn:"root"}),II),dz=function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r},gz=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},hz=z.application===j.Studio,fz={loading:!1,profileStatus:"ready",loggedIn:null,userLocale:null},bz=((TI=function(){function e(t,n,i,o,a,r,c,s){m(this,e),this.authService=t,this.userMessageService=n,this.storageService=i,this.localeId=o,this.store=a,this.errorLoggingService=r,this.facebookPixel=c,this.linkedinInsights=s}return v(e,[{key:"isLoggedIn",value:function(e,t){e.patchState({loading:!0}),this.authService.isLoggedIn().pipe(Object(ae.a)((function(){return e.patchState({loading:!1})}))).subscribe((function(t){e.dispatch(t.signed_in?new JP:new XP)}))}},{key:"isLoggedInSuccess",value:function(e,t){e.patchState({loggedIn:!0})}},{key:"isLoggedInFailure",value:function(e,t){e.patchState({loggedIn:!1})}},{key:"login",value:function(e,t){var n=this;e.patchState({loading:!0}),z.deploy===M.Local?this.authService.loginWithBiodigital(t.login).pipe(Object(ae.a)((function(){return e.patchState({loading:!1})}))).subscribe((function(t){e.dispatch(new nM(t))}),(function(i){n.logFailure("LOGIN_FAILURE",i),e.dispatch(new iM(i,t.login))})):this.authService.isHuman("studio_login").pipe(Object(hn.a)((function(t){t.isHuman||e.dispatch(new KM)})),Object(be.a)((function(e){return e.isHuman})),Object(oa.a)((function(e){return n.authService.loginWithBiodigital(Object.assign(Object.assign({},t.login),{site_verify_response:e.verification}))})),Object(ae.a)((function(){return e.patchState({loading:!1})}))).subscribe((function(t){e.dispatch(new nM(t))}),(function(i){n.logFailure("LOGIN_FAILURE",i),e.dispatch(new iM(i,t.login))}))}},{key:"loginWithGoogle",value:function(e,t){var n=this;e.patchState({loading:!0}),this.authService.loginWithGoogle(t.login).pipe(Object(ae.a)((function(){return e.patchState({loading:!1})}))).subscribe((function(t){e.dispatch(new nM(t))}),(function(i){1!==t.login.groupCodeMode&&1!==t.login.groupInviteMode||n.logFailure("GOOGLE_SIGNUP_FAILURE",i),e.dispatch(new iM(i,t.login))}))}},{key:"loginWithFacebook",value:function(e,t){e.patchState({loading:!0}),this.authService.loginWithFacebook(t.login).pipe(Object(ae.a)((function(){return e.patchState({loading:!1})}))).subscribe((function(t){e.dispatch(new nM(t))}),(function(n){e.dispatch(new iM(n,t.login))}))}},{key:"loginSuccess",value:function(e,t){hz&&(this.facebookPixel.trackCustom("Sign in"),this.linkedinInsights.track("Sign in")),e.dispatch(new ZP),e.dispatch(new LM)}},{key:"logout",value:function(e,t){e.patchState({loading:!0}),this.authService.logout().pipe(Object(ae.a)((function(){return e.patchState({loading:!1})}))).subscribe((function(){return e.dispatch(new aM)}),(function(){return e.dispatch(new rM)}))}},{key:"logoutSuccess",value:function(e,t){e.setState(fz),e.dispatch(new GM),e.dispatch(new sz),e.dispatch(new au),e.dispatch(new Os),e.dispatch(new lt),e.dispatch(new Zo),e.dispatch(new Tp.ResetLayout),e.dispatch(new jI),e.dispatch(new Rr),e.dispatch(new Hn),e.dispatch(new kP.Reset),this.storageService.clearSessionStorage()}},{key:"checkProfile",value:function(e,t){return e.patchState({loading:!0}),this.authService.checkProfile(t.email).pipe(Object(ae.a)((function(){return e.patchState({loading:!1})}))).subscribe((function(t){e.dispatch(new xM(t))}),(function(t){e.dispatch(new wM(t))}))}},{key:"checkProfileSuccess",value:function(e,t){e.patchState({profileCheck:t.profile})}},{key:"getUserProfile",value:function(e,t){var n=t.hardCheck;return e.patchState({loading:!0}),this.authService.getUserProfile(n).pipe(Object(ae.a)((function(){return e.patchState({loading:!1})}))).subscribe((function(t){e.dispatch(new uM(t))}),(function(t){e.dispatch(new dM(t))}))}},{key:"getUserProfileSuccess",value:function(e,t){e.patchState({userProfile:t.userProfile}),e.dispatch(new pI(t.userProfile.organizations)),e.dispatch(new DM),e.dispatch(new LM)}},{key:"updateUserProfile",value:function(e,t){var n=t.userProfile;e.patchState({profileStatus:"updating"}),this.authService.updaterUserProfile(n).pipe(Object(ae.a)((function(){return e.patchState({profileStatus:"ready"})}))).subscribe((function(){e.dispatch(new hM(n))}),(function(t){e.dispatch(new fM(t))}))}},{key:"deleteUserProfile",value:function(e,t){e.patchState({profileStatus:"deleting"}),this.authService.deleteUserProfile().pipe(Object(ae.a)((function(){return e.patchState({profileStatus:"ready"})}))).subscribe((function(t){e.dispatch(new vM(t))}),(function(t){e.dispatch(new mM(t))}))}},{key:"getUserApps",value:function(e,t){this.authService.getUserApps().subscribe((function(t){e.dispatch(new EM(t)),e.dispatch(new FM)}),(function(e){}))}},{key:"setUserApps",value:function(e,t){var n=t.apps;e.patchState({userApps:n})}},{key:"setSelectedUserApp",value:function(e,t){var n=t.appId;e.patchState({selectedAppId:n}),null!==n?this.storageService.setLocalItem(zc.UserAppId,n):this.storageService.removeLocalItem(zc.UserAppId)}},{key:"checkSelectedUserApp",value:function(e,t){var n=e.getState().userApps,i=this.storageService.getLocalItem(zc.UserAppId);if(i){var o=parseInt(i,10);e.dispatch(new AM(o))}else if(n&&n.length){var a=n.find((function(e){return e.app_platform.some((function(e){return e.type===cz.Web}))}));e.dispatch(new AM(a?a.id:void 0))}}},{key:"checkSession",value:function(e,t){e.patchState({loading:!0}),this.authService.isLoggedIn().pipe(Object(ae.a)((function(){return e.patchState({loading:!1})}))).subscribe((function(t){t.signed_in?(e.dispatch(new JP),e.dispatch(new pM)):e.dispatch(new XP)}))}},{key:"getEnvironmentSettings",value:function(e,t){return e.patchState({loading:!0}),this.authService.getEnvironmentSettings().pipe(Object(ae.a)((function(){return e.patchState({loading:!1})}))).subscribe((function(t){e.dispatch(new sM(t))}),(function(t){e.dispatch(new lM(t))}))}},{key:"GetEnvironmentSettingsSuccess",value:function(e,t){e.patchState({environmentSettings:t.environmentSettings})}},{key:"resetPassword",value:function(e,t){e.patchState({loading:!0}),this.authService.resetPassword(t.email).pipe(Object(ae.a)((function(){return e.patchState({loading:!1})}))).subscribe((function(){e.dispatch(new OM(t.email))}),(function(t){e.dispatch(new CM(t))}))}},{key:"updatePassword",value:function(e,t){var n=t.currentPassword,i=t.newPassword,o=t.confirmNewPassword;this.authService.updatePassword(n,i,o).subscribe((function(){e.dispatch(new _M)}),(function(t){e.dispatch(new jM(t))}))}},{key:"signUp",value:function(e,t){var n=this;e.patchState({loading:!0}),this.authService.isHuman("studio_signup").pipe(Object(hn.a)((function(t){t.isHuman||e.dispatch(new KM)})),Object(be.a)((function(e){return e.isHuman})),Object(oa.a)((function(e){return n.authService.signUp(Object.assign(Object.assign({},t.value),{site_verify_response:e.verification}))})),Object(ae.a)((function(){return e.patchState({loading:!1})}))).subscribe((function(t){e.dispatch(new IM(t))}),(function(t){e.dispatch(new zM(t))}))}},{key:"signUpFailure",value:function(e,t){this.logFailure("BIODIGITAL_SIGNUP_FAILURE",t)}},{key:"setUserLocale",value:function(e,t){var n=t.locale;this.storageService.setLocalItem(zc.Locale,n.id),e.patchState({userLocale:n}),e.dispatch(new UM(n))}},{key:"checkLocale",value:function(e,t){var n=this,i=yr.find((function(e){return e.id===n.localeId}))||mr;e.dispatch(new TM(i))}},{key:"sendUserMessage",value:function(e,t){var n=t.message;this.userMessageService.sendMessage(n).subscribe((function(){e.dispatch(new NM(n))}),(function(t){e.dispatch(new VM(t))}))}},{key:"getUserMessage",value:function(e,t){var n=t.type,i=t.mode;this.userMessageService.getUserMessage(n,i).subscribe((function(t){e.dispatch(new BM(t))}),(function(){e.dispatch(new QM(n))}))}},{key:"setUserMessageViewed",value:function(e,t){var n=t.messageSeenId;this.userMessageService.setUserMessageViewed(n).subscribe((function(){return e.dispatch(new WM)}),(function(){return e.dispatch(new $M)}))}},{key:"resetAuth",value:function(e,t){e.setState(fz)}},{key:"logFailure",value:function(e,t){var n=Object(Oe.get)(t,"message")||"",i=Object(Oe.get)(t,"error.error.message")||"";this.errorLoggingService.logError(new G_(e,n,i)).subscribe()}},{key:"ngxsOnInit",value:function(e){e.dispatch(new PM),e.dispatch(new LM),e.dispatch(new FM)}}],[{key:"getLoggedIn",value:function(e){return e.loggedIn}},{key:"getEnvironmentSettings",value:function(e){return e.environmentSettings}},{key:"getUserProfile",value:function(e){return e.userProfile}},{key:"getUserAccountSettings",value:function(e){return Object(Oe.get)(e,"userProfile.account_settings",[])}},{key:"getProfileCheck",value:function(e){return e.profileCheck}},{key:"getLoading",value:function(e){return e.loading}},{key:"getProfileUpdating",value:function(e){return"updating"===e.profileStatus}},{key:"getProfileDeleting",value:function(e){return"deleting"===e.profileStatus}},{key:"getUserLocale",value:function(e){return e.userLocale}},{key:"getUserLanguage",value:function(e){return Object(Oe.get)(e,"userLocale.lang",mr.lang)}},{key:"getUserApps",value:function(e){return Object(Oe.get)(e,"userApps",[])}},{key:"getSelectedUserApp",value:function(e){return(e.userApps||[]).find((function(t){return t.id===e.selectedAppId}))}},{key:"isPrivateUser",value:function(e){return!Object(Oe.isNil)(e.userProfile)&&0===Object(Oe.get)(e,"userProfile.organizations",[]).length}},{key:"isPremiumUser",value:function(e){return!0===Object(Oe.get)(e,"userProfile.premium_account_valid")}}]),e}()).\u0275fac=function(e){return new(e||TI)(_.Zb(lI),_.Zb(MI),_.Zb(Lc),_.Zb(_.w),_.Zb(L.g),_.Zb(Z_),_.Zb(uz),_.Zb(pz))},TI.\u0275prov=_.Lb({token:TI,factory:TI.\u0275fac}),dz([Object(L.a)(ZP),gz("design:type",Function),gz("design:paramtypes",[Object,ZP]),gz("design:returntype",void 0)],TI.prototype,"isLoggedIn",null),dz([Object(L.a)(JP),gz("design:type",Function),gz("design:paramtypes",[Object,JP]),gz("design:returntype",void 0)],TI.prototype,"isLoggedInSuccess",null),dz([Object(L.a)(XP),gz("design:type",Function),gz("design:paramtypes",[Object,XP]),gz("design:returntype",void 0)],TI.prototype,"isLoggedInFailure",null),dz([Object(L.a)(YP),gz("design:type",Function),gz("design:paramtypes",[Object,YP]),gz("design:returntype",void 0)],TI.prototype,"login",null),dz([Object(L.a)(eM),gz("design:type",Function),gz("design:paramtypes",[Object,eM]),gz("design:returntype",void 0)],TI.prototype,"loginWithGoogle",null),dz([Object(L.a)(tM),gz("design:type",Function),gz("design:paramtypes",[Object,tM]),gz("design:returntype",void 0)],TI.prototype,"loginWithFacebook",null),dz([Object(L.a)(nM),gz("design:type",Function),gz("design:paramtypes",[Object,nM]),gz("design:returntype",void 0)],TI.prototype,"loginSuccess",null),dz([Object(L.a)(oM),gz("design:type",Function),gz("design:paramtypes",[Object,oM]),gz("design:returntype",void 0)],TI.prototype,"logout",null),dz([Object(L.a)(aM),gz("design:type",Function),gz("design:paramtypes",[Object,aM]),gz("design:returntype",void 0)],TI.prototype,"logoutSuccess",null),dz([Object(L.a)(yM),gz("design:type",Function),gz("design:paramtypes",[Object,yM]),gz("design:returntype",void 0)],TI.prototype,"checkProfile",null),dz([Object(L.a)(xM),gz("design:type",Function),gz("design:paramtypes",[Object,xM]),gz("design:returntype",void 0)],TI.prototype,"checkProfileSuccess",null),dz([Object(L.a)(pM),gz("design:type",Function),gz("design:paramtypes",[Object,pM]),gz("design:returntype",void 0)],TI.prototype,"getUserProfile",null),dz([Object(L.a)(uM),gz("design:type",Function),gz("design:paramtypes",[Object,uM]),gz("design:returntype",void 0)],TI.prototype,"getUserProfileSuccess",null),dz([Object(L.a)(gM),gz("design:type",Function),gz("design:paramtypes",[Object,gM]),gz("design:returntype",void 0)],TI.prototype,"updateUserProfile",null),dz([Object(L.a)(bM),gz("design:type",Function),gz("design:paramtypes",[Object,bM]),gz("design:returntype",void 0)],TI.prototype,"deleteUserProfile",null),dz([Object(L.a)(DM),gz("design:type",Function),gz("design:paramtypes",[Object,DM]),gz("design:returntype",void 0)],TI.prototype,"getUserApps",null),dz([Object(L.a)(EM),gz("design:type",Function),gz("design:paramtypes",[Object,EM]),gz("design:returntype",void 0)],TI.prototype,"setUserApps",null),dz([Object(L.a)(AM),gz("design:type",Function),gz("design:paramtypes",[Object,AM]),gz("design:returntype",void 0)],TI.prototype,"setSelectedUserApp",null),dz([Object(L.a)(FM),gz("design:type",Function),gz("design:paramtypes",[Object,FM]),gz("design:returntype",void 0)],TI.prototype,"checkSelectedUserApp",null),dz([Object(L.a)(PM),gz("design:type",Function),gz("design:paramtypes",[Object,PM]),gz("design:returntype",void 0)],TI.prototype,"checkSession",null),dz([Object(L.a)(cM),gz("design:type",Function),gz("design:paramtypes",[Object,cM]),gz("design:returntype",void 0)],TI.prototype,"getEnvironmentSettings",null),dz([Object(L.a)(sM),gz("design:type",Function),gz("design:paramtypes",[Object,sM]),gz("design:returntype",void 0)],TI.prototype,"GetEnvironmentSettingsSuccess",null),dz([Object(L.a)(kM),gz("design:type",Function),gz("design:paramtypes",[Object,kM]),gz("design:returntype",void 0)],TI.prototype,"resetPassword",null),dz([Object(L.a)(SM),gz("design:type",Function),gz("design:paramtypes",[Object,SM]),gz("design:returntype",void 0)],TI.prototype,"updatePassword",null),dz([Object(L.a)(MM),gz("design:type",Function),gz("design:paramtypes",[Object,MM]),gz("design:returntype",void 0)],TI.prototype,"signUp",null),dz([Object(L.a)(zM),gz("design:type",Function),gz("design:paramtypes",[Object,zM]),gz("design:returntype",void 0)],TI.prototype,"signUpFailure",null),dz([Object(L.a)(TM),gz("design:type",Function),gz("design:paramtypes",[Object,TM]),gz("design:returntype",void 0)],TI.prototype,"setUserLocale",null),dz([Object(L.a)(LM),gz("design:type",Function),gz("design:paramtypes",[Object,LM]),gz("design:returntype",void 0)],TI.prototype,"checkLocale",null),dz([Object(L.a)(RM),gz("design:type",Function),gz("design:paramtypes",[Object,RM]),gz("design:returntype",void 0)],TI.prototype,"sendUserMessage",null),dz([Object(L.a)(HM),gz("design:type",Function),gz("design:paramtypes",[Object,HM]),gz("design:returntype",void 0)],TI.prototype,"getUserMessage",null),dz([Object(L.a)(qM),gz("design:type",Function),gz("design:paramtypes",[Object,qM]),gz("design:returntype",void 0)],TI.prototype,"setUserMessageViewed",null),dz([Object(L.a)(GM),gz("design:type",Function),gz("design:paramtypes",[Object,GM]),gz("design:returntype",void 0)],TI.prototype,"resetAuth",null),dz([Object(L.e)(),gz("design:type",Function),gz("design:paramtypes",[GP]),gz("design:returntype",void 0)],TI,"getLoggedIn",null),dz([Object(L.e)(),gz("design:type",Function),gz("design:paramtypes",[GP]),gz("design:returntype",void 0)],TI,"getEnvironmentSettings",null),dz([Object(L.e)(),gz("design:type",Function),gz("design:paramtypes",[GP]),gz("design:returntype",void 0)],TI,"getUserProfile",null),dz([Object(L.e)(),gz("design:type",Function),gz("design:paramtypes",[GP]),gz("design:returntype",Array)],TI,"getUserAccountSettings",null),dz([Object(L.e)(),gz("design:type",Function),gz("design:paramtypes",[GP]),gz("design:returntype",void 0)],TI,"getProfileCheck",null),dz([Object(L.e)(),gz("design:type",Function),gz("design:paramtypes",[GP]),gz("design:returntype",void 0)],TI,"getLoading",null),dz([Object(L.e)(),gz("design:type",Function),gz("design:paramtypes",[GP]),gz("design:returntype",void 0)],TI,"getProfileUpdating",null),dz([Object(L.e)(),gz("design:type",Function),gz("design:paramtypes",[GP]),gz("design:returntype",void 0)],TI,"getProfileDeleting",null),dz([Object(L.e)(),gz("design:type",Function),gz("design:paramtypes",[GP]),gz("design:returntype",void 0)],TI,"getUserLocale",null),dz([Object(L.e)(),gz("design:type",Function),gz("design:paramtypes",[GP]),gz("design:returntype",String)],TI,"getUserLanguage",null),dz([Object(L.e)(),gz("design:type",Function),gz("design:paramtypes",[GP]),gz("design:returntype",void 0)],TI,"getUserApps",null),dz([Object(L.e)(),gz("design:type",Function),gz("design:paramtypes",[GP]),gz("design:returntype",void 0)],TI,"getSelectedUserApp",null),dz([Object(L.e)(),gz("design:type",Function),gz("design:paramtypes",[GP]),gz("design:returntype",void 0)],TI,"isPrivateUser",null),dz([Object(L.e)(),gz("design:type",Function),gz("design:paramtypes",[GP]),gz("design:returntype",void 0)],TI,"isPremiumUser",null),TI=dz([Object(L.f)({name:"auth",defaults:fz})],TI)),vz=function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r},mz=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},yz={publishing:!1,widgetURL:"/viewer",dimensions:LC.dimensions,minDimensions:{width:300,height:400}},xz=((DI=function(){function e(t,n,i,o){m(this,e),this.clipboardService=t,this.publishService=n,this.store=i,this.snackbar=o}return v(e,[{key:"setPublishWidgetURL",value:function(e,t){e.patchState({widgetURL:t.widgetURL||"/viewer"})}},{key:"setPublishDimensions",value:function(e,t){e.patchState({dimensions:t.dimensions})}},{key:"getPublishURL",value:function(e,t){var n=t.model,i=t.camera,o=t.widgetOptions,a=e.getState().widgetURL,r=this.store.selectSnapshot(bz.getUserLanguage),c=this.store.selectSnapshot(bz.getSelectedUserApp);this.publishService.generateWidgetURL(n,a,o,i,EC.Single,r,c).subscribe((function(t){e.dispatch(new RP(n,t))}),(function(){e.dispatch(new NP(n))}))}},{key:"getPublishURLSuccess",value:function(e,t){var n=this;this.clipboardService.copyToClipboard(t.url,"url").subscribe((function(e){n.snackbar.open(e?"Successfully copied link to clipboard.":"Unable to copy link to clipboard.")}))}},{key:"getPublishURLFail",value:function(e,t){this.snackbar.open("Unable to generate URL.")}},{key:"getPublishIFrame",value:function(e,t){var n=t.model,i=t.camera,o=t.widgetOptions,a=e.getState(),r=a.widgetURL,c=a.dimensions,s=this.store.selectSnapshot(bz.getUserLanguage),l=this.store.selectSnapshot(bz.getSelectedUserApp);this.publishService.generateWidgetEmbed(n,r,o,c,i,EC.Single,s,l).subscribe((function(t){e.dispatch(new EP(t))}),(function(){e.dispatch(new FP)}))}},{key:"savePublishImage",value:function(e,t){var n=t.imageData,i=t.imageType;this.publishService.saveUserImage(n,i).subscribe((function(t){e.dispatch(new QP(t))}),(function(){e.dispatch(new qP)}))}},{key:"getPublishImage",value:function(e,t){var n=this,i=t.model,o=t.camera,a=t.widgetOptions,r=t.imageData,c=t.fileType,s=e.getState().widgetURL,l=this.store.selectSnapshot(bz.getUserLanguage),p=this.store.selectSnapshot(bz.getSelectedUserApp);Object(Br.a)(this.publishService.generateWidgetURL(i,s,a,o,EC.Single,l,p),this.publishService.saveUserImage(r,c)).subscribe((function(t){var o=u(t,2),a=o[0],r=o[1],c=n.publishService.getImageEmbed(i.title,a,r);e.dispatch(new $P(c))}),(function(){e.dispatch(new KP)}))}},{key:"setPublishing",value:function(e,t){var n=t.publishing;e.patchState({publishing:n})}},{key:"resetPublish",value:function(e,t){e.setState(yz)}}],[{key:"getDimensions",value:function(e){return e.dimensions}},{key:"getMinDimensions",value:function(e){return e.minDimensions}},{key:"getWidgetURL",value:function(e){return e.widgetURL}},{key:"getPublishing",value:function(e){return e.publishing}}]),e}()).\u0275fac=function(e){return new(e||DI)(_.Zb(Xs),_.Zb(NC),_.Zb(L.g),_.Zb(Ys.b))},DI.\u0275prov=_.Lb({token:DI,factory:DI.\u0275fac}),vz([Object(L.a)(UP),mz("design:type",Function),mz("design:paramtypes",[Object,UP]),mz("design:returntype",void 0)],DI.prototype,"setPublishWidgetURL",null),vz([Object(L.a)(LP),mz("design:type",Function),mz("design:paramtypes",[Object,LP]),mz("design:returntype",void 0)],DI.prototype,"setPublishDimensions",null),vz([Object(L.a)(AP),mz("design:type",Function),mz("design:paramtypes",[Object,AP]),mz("design:returntype",void 0)],DI.prototype,"getPublishURL",null),vz([Object(L.a)(RP),mz("design:type",Function),mz("design:paramtypes",[Object,RP]),mz("design:returntype",void 0)],DI.prototype,"getPublishURLSuccess",null),vz([Object(L.a)(NP),mz("design:type",Function),mz("design:paramtypes",[Object,NP]),mz("design:returntype",void 0)],DI.prototype,"getPublishURLFail",null),vz([Object(L.a)(DP),mz("design:type",Function),mz("design:paramtypes",[Object,DP]),mz("design:returntype",void 0)],DI.prototype,"getPublishIFrame",null),vz([Object(L.a)(BP),mz("design:type",Function),mz("design:paramtypes",[Object,BP]),mz("design:returntype",void 0)],DI.prototype,"savePublishImage",null),vz([Object(L.a)(WP),mz("design:type",Function),mz("design:paramtypes",[Object,WP]),mz("design:returntype",void 0)],DI.prototype,"getPublishImage",null),vz([Object(L.a)(VP),mz("design:type",Function),mz("design:paramtypes",[Object,VP]),mz("design:returntype",void 0)],DI.prototype,"setPublishing",null),vz([Object(L.a)(HP),mz("design:type",Function),mz("design:paramtypes",[Object,HP]),mz("design:returntype",void 0)],DI.prototype,"resetPublish",null),vz([Object(L.e)(),mz("design:type",Function),mz("design:paramtypes",[TP]),mz("design:returntype",void 0)],DI,"getDimensions",null),vz([Object(L.e)(),mz("design:type",Function),mz("design:paramtypes",[TP]),mz("design:returntype",void 0)],DI,"getMinDimensions",null),vz([Object(L.e)(),mz("design:type",Function),mz("design:paramtypes",[TP]),mz("design:returntype",void 0)],DI,"getWidgetURL",null),vz([Object(L.e)(),mz("design:type",Function),mz("design:paramtypes",[TP]),mz("design:returntype",void 0)],DI,"getPublishing",null),DI=vz([Object(L.f)({name:"publish",defaults:yz})],DI)),wz=((LI=function e(){m(this,e)}).\u0275mod=_.Nb({type:LI}),LI.\u0275inj=_.Mb({factory:function(e){return new(e||LI)},imports:[[or.c,Dj,Hg.q,zP,Ej.a,L.c.forFeature([xz])]]}),LI),kz=((UI=function e(){m(this,e)}).\u0275mod=_.Nb({type:UI}),UI.\u0275inj=_.Mb({factory:function(e){return new(e||UI)},imports:[[L.c.forFeature([XC]),or.c,Dj,Hg.q,zP,we.f,wz,ke.d]]}),UI),Oz=function e(){m(this,e)},Cz=function(e){return e[e.Query=0]="Query",e[e.Path=1]="Path",e}({}),Sz=function(e){return e[e.List=0]="List",e[e.Card=1]="Card",e}({}),_z=z.application===j.Loft?Sz.List:Sz.Card,jz=function(e){return e.Success="success",e.Fail="fail",e}({}),Pz="cdb/content",Mz="cdb/copy/content",Iz={headers:new W.d({"Content-Type":"application/json; charset=utf-8"})},zz=["production","client","preview","internal_content","public_preview","demos","social","exports","real_data"],Tz=((EI=function(){function e(t,n){m(this,e),this.http=t,this.serializeModuleService=n}return v(e,[{key:"saveModule",value:function(e,t){t=this.formatModulePath(t);var n=[Pz,"modules",t].join("/"),i=this.JSONStringify(e);return this.http.put(n,i,Iz).pipe(Object(K.a)((function(){return jz.Success})),Object(G.a)((function(e){var t=e.status;return t>=200&&t<=202?Object($.a)(jz.Success):Object($.a)(jz.Fail)})))}},{key:"copyState",value:function(e,t){var n=[Mz,"states",t].join("/"),i={headers:new W.d({"Content-Type":"application/json; charset=utf-8","source-state":e})};return this.http.put(n,{},i)}},{key:"listContents",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=this.generateModulePath(e,t||"",n||"");return this.http.get("/cdb/ls/content/modules/"+o).pipe(Object(K.a)((function(e){return i?e.contents.map((function(e){var t=e.name.replace("/content/modules/","").replace(".json",""),n=e.name.split("/").pop().replace("/content/modules","").replace(".json",""),i=new pk;return i.id=t,i.title=n,i.type=P.Module,i})):e.contents})))}},{key:"getState",value:function(e){return this.http.get("/cdb/ls/content/states/"+e).pipe(Object(K.a)((function(e){return e.contents})))}},{key:"getClients",value:function(){return this.http.get("/search/client").pipe(Object(K.a)((function(e){return e.clients})))}},{key:"getUsedStates",value:function(){var e=this,t={};return Object.values(Human.scene.objects).reduce((function(n,i){return["transformId","morphId","geometryId","materialId"].forEach((function(n){var o=e.getPropertyState(i,n);o.length&&(t[o]=!0)})),i.hasOwnProperty("renderables")&&["morphId","geometryId","materialId"].forEach((function(n){i.renderables.forEach((function(i){var o=e.getPropertyState(i,n);o.length&&(t[o]=!0)}))})),n}),{}),Object.keys(t)}},{key:"parseScenePath",value:function(e){var t=e.split("/");return 1===t.length?null:{fullPath:"https://qa.biodigital.com/content/modules/"+e,relativePath:t.slice(0,t.length-1).join("/"),sceneName:t[t.length-1]}}},{key:"formatModulePath",value:function(e){var t=e;return/\.json$/.test(e)||(t+=".json"),t}},{key:"getPrimaryCategories",value:function(){return Object($.a)(zz)}},{key:"getSecondaryCategories",value:function(e){switch(e){case"production":return Object($.a)(["maleAdult","femaleAdult"]);case"client":return this.getClients();default:return Object($.a)([])}}},{key:"generateSaveModule",value:function(e){var t=this.parseScenePath(e),n=t.relativePath.split("/");return{id:e,name:t.sceneName,primaryCategory:n[0]||"",secondaryCategory:n[1]||""}}},{key:"generateModulePath",value:function(e,t,n){var i=[];return e.length&&i.push(e),t.length&&i.push(t),n.length&&(n.indexOf(".json")<0&&(n+=".json"),i.push(n)),i.join("/")}},{key:"getPropertyState",value:function(e,t){return null!=e[t]?e[t].split("/")[0]:""}},{key:"JSONStringify",value:function(e){return JSON.stringify(e).replace(/[\u007f-\uffff]/g,(function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)}))}}]),e}()).\u0275fac=function(e){return new(e||EI)(_.Zb(W.b),_.Zb(Mc))},EI.\u0275prov=_.Lb({token:EI,factory:EI.\u0275fac,providedIn:"root"}),EI),Uz=function(e){return e.Organization="Organization",e.Collection="Collection",e.Private="Private",e.Category="Category",e.Community="Community",e.Internal="Internal",e.Loft="Loft",e}({}),Lz=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1?arguments[1]:void 0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:25,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;m(this,e),this.query=t,this.sortBy=n,this.pageSize=i,this.offset=o},Dz=function e(){m(this,e)},Ez=function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r},Fz=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Az={loading:!0,searchMode:Cz.Query,viewMode:_z,searchResults:{total:0,items:[]},checkedResults:[],searchConfig:null,searchOptions:null,sidenav:{enabled:!0,open:!0},bulkActions:{enabled:!0,items:[]},cardActions:{enabled:!0}},Rz=((QI=function(){function e(t,n,i,o,a){m(this,e),this.organizationsService=t,this.modulesService=n,this.exploreService=i,this.bookmarksService=o,this.store=a}return v(e,[{key:"setSearchMode",value:function(e,t){e.patchState({searchMode:t.searchMode})}},{key:"setViewMode",value:function(e,t){e.patchState({viewMode:t.viewMode})}},{key:"setSearchOptions",value:function(e,t){e.patchState({searchOptions:Object.assign({},t.options)})}},{key:"setSearchConfig",value:function(e,t){var n=t.config||e.getState().searchConfig,i=t.options||e.getState().searchOptions;null!==n&&e.patchState({searchOptions:Object.assign({},i),searchConfig:Object.assign({},n)})}},{key:"searchStudio",value:function(e,t){var n=e.getState(),i=n.searchConfig,o=n.searchOptions,a=new Lz("",PC),r=this.store.selectSnapshot(bz.getUserLanguage);e.patchState({loading:!0,searchOptions:Object.assign(Object.assign({},o),{pageSize:a.pageSize,offset:a.offset}),checkedResults:[]});var c=new he.a;switch(i.type){case Uz.Category:c=this.exploreService.getAnatomyCategory(i.query,"all"===i.categoryId?"":i.categoryId,i.tags,r);break;case Uz.Organization:c=this.bookmarksService.getOrganizationContent(i.organizationId,i.query);break;case Uz.Collection:c=this.organizationsService.getCollectionContent(i.organizationId,i.collectionId,i.query);break;case Uz.Community:c=this.bookmarksService.getPublicBookmarks(i.query);break;case Uz.Private:c=this.bookmarksService.getPrivateBookmarks(i.query);break;case Uz.Internal:c=this.exploreService.searchInternal(i.query,i.directory);break;case Uz.Loft:var s=i.query.indexOf(".json")>0;c=this.modulesService.listContents(i.primary,i.secondary,s?i.query:"",!0).pipe(Object(K.a)((function(e){return s?e:e.filter((function(e){return e.title.indexOf(i.query)>=0}))})))}c.pipe(Object(ae.a)((function(){return e.patchState({loading:!1})}))).subscribe((function(t){e.dispatch(new kP.SearchSuccess(t))}))}},{key:"searchSuccess",value:function(e,t){e.patchState({searchResults:{items:t.bookmarks,total:t.bookmarks.length}})}},{key:"checkItem",value:function(e,t){var n=e.getState().checkedResults,i=n.some((function(e){return e===t.id}));t.checked&&!i?n=[].concat(s(n),[t.id]):t.checked||(n=n.filter((function(e){return e!==t.id}))),e.patchState({checkedResults:n})}},{key:"checkAll",value:function(e,t){Object(Oe.isNil)(t.checked);var n=e.getState().searchResults.items.map((function(e){return e.id}));e.patchState({checkedResults:n})}},{key:"setCheckedItems",value:function(e,t){e.patchState({checkedResults:t.ids})}},{key:"setSidenav",value:function(e,t){e.patchState({sidenav:Object.assign({},t.sidenav)})}},{key:"setCardActions",value:function(e,t){e.patchState({cardActions:Object.assign({},t.cardActions)})}},{key:"setBulkActions",value:function(e,t){e.patchState({bulkActions:Object.assign({},t.bulkActions)})}},{key:"clearResults",value:function(e,t){e.patchState({searchResults:{items:[],total:0}})}},{key:"resetGallery",value:function(e,t){e.patchState(Az)}}],[{key:"getLoading",value:function(e){return e.loading}},{key:"getSearchMode",value:function(e){return e.searchMode}},{key:"getSearchConfig",value:function(e){return e.searchConfig}},{key:"getSearchOptions",value:function(e){return e.searchOptions}},{key:"getSearchType",value:function(e){return e.searchConfig?e.searchConfig.type:null}},{key:"getSearchGroup",value:function(e){var t;switch(null===(t=e.searchConfig)||void 0===t?void 0:t.type){case Uz.Category:case Uz.Community:case Uz.Internal:case Uz.Loft:return"module";case Uz.Collection:case Uz.Private:case Uz.Organization:return"bookmark"}}},{key:"getViewMode",value:function(e){return e.viewMode}},{key:"getSort",value:function(e){return e.searchOptions.sortBy}},{key:"getSortOptions",value:function(e){switch(e.searchConfig.type){case Uz.Loft:return[PC,MC];case Uz.Category:return[_C,jC,PC,MC];default:return[jC,PC,MC,IC,zC]}}},{key:"getSidenav",value:function(e){return e.sidenav}},{key:"getBulkActions",value:function(e){return e.bulkActions}},{key:"getCardActions",value:function(e){return e.cardActions}},{key:"getFilteredResults",value:function(e,t){var n=e.searchResults,i=e.searchOptions,o=i.sortBy,a=o.ascending,r=o.fields,c=qC(n.items,r,a);return!0!==Object(Oe.get)(t,"userProfile.premium_account_valid")&&(c=[].concat(s(c.filter((function(e){return!0!==e.premium}))),s(c.filter((function(e){return!0===e.premium}))))),c=c.slice(i.offset,i.offset+i.pageSize),Object.assign(Object.assign({},n),{items:c})}},{key:"getAllResults",value:function(e,t){var n=e.searchResults,i=e.searchOptions.sortBy,o=i.ascending,a=i.fields,r=qC(n.items,a,o);return!0!==Object(Oe.get)(t,"userProfile.premium_account_valid")&&(r=[].concat(s(r.filter((function(e){return!0!==e.premium}))),s(r.filter((function(e){return!0===e.premium}))))),{total:n.total,items:r}}},{key:"getCheckedResults",value:function(e){return e.checkedResults}}]),e}()).\u0275fac=function(e){return new(e||QI)(_.Zb(BC),_.Zb(Tz),_.Zb(mk),_.Zb(kk),_.Zb(L.g))},QI.\u0275prov=_.Lb({token:QI,factory:QI.\u0275fac}),Ez([Object(L.a)(kP.SetSearchMode),Fz("design:type",Function),Fz("design:paramtypes",[Object,kP.SetSearchMode]),Fz("design:returntype",void 0)],QI.prototype,"setSearchMode",null),Ez([Object(L.a)(kP.SetViewMode),Fz("design:type",Function),Fz("design:paramtypes",[Object,kP.SetViewMode]),Fz("design:returntype",void 0)],QI.prototype,"setViewMode",null),Ez([Object(L.a)(kP.SetSearchOptions),Fz("design:type",Function),Fz("design:paramtypes",[Object,kP.SetSearchOptions]),Fz("design:returntype",void 0)],QI.prototype,"setSearchOptions",null),Ez([Object(L.a)(kP.SetSearchConfig),Fz("design:type",Function),Fz("design:paramtypes",[Object,kP.SetSearchConfig]),Fz("design:returntype",void 0)],QI.prototype,"setSearchConfig",null),Ez([Object(L.a)(kP.SearchStudio),Fz("design:type",Function),Fz("design:paramtypes",[Object,kP.SearchStudio]),Fz("design:returntype",void 0)],QI.prototype,"searchStudio",null),Ez([Object(L.a)(kP.SearchSuccess),Fz("design:type",Function),Fz("design:paramtypes",[Object,kP.SearchSuccess]),Fz("design:returntype",void 0)],QI.prototype,"searchSuccess",null),Ez([Object(L.a)(kP.CheckItem),Fz("design:type",Function),Fz("design:paramtypes",[Object,kP.CheckItem]),Fz("design:returntype",void 0)],QI.prototype,"checkItem",null),Ez([Object(L.a)(kP.CheckAll),Fz("design:type",Function),Fz("design:paramtypes",[Object,kP.CheckAll]),Fz("design:returntype",void 0)],QI.prototype,"checkAll",null),Ez([Object(L.a)(kP.SetCheckedItems),Fz("design:type",Function),Fz("design:paramtypes",[Object,kP.SetCheckedItems]),Fz("design:returntype",void 0)],QI.prototype,"setCheckedItems",null),Ez([Object(L.a)(kP.SetSidenav),Fz("design:type",Function),Fz("design:paramtypes",[Object,kP.SetSidenav]),Fz("design:returntype",void 0)],QI.prototype,"setSidenav",null),Ez([Object(L.a)(kP.SetCardActions),Fz("design:type",Function),Fz("design:paramtypes",[Object,kP.SetCardActions]),Fz("design:returntype",void 0)],QI.prototype,"setCardActions",null),Ez([Object(L.a)(kP.SetBulkActions),Fz("design:type",Function),Fz("design:paramtypes",[Object,kP.SetBulkActions]),Fz("design:returntype",void 0)],QI.prototype,"setBulkActions",null),Ez([Object(L.a)(kP.ClearResults),Fz("design:type",Function),Fz("design:paramtypes",[Object,kP.ClearResults]),Fz("design:returntype",void 0)],QI.prototype,"clearResults",null),Ez([Object(L.a)(kP.Reset),Fz("design:type",Function),Fz("design:paramtypes",[Object,kP.Reset]),Fz("design:returntype",void 0)],QI.prototype,"resetGallery",null),Ez([Object(L.e)(),Fz("design:type",Function),Fz("design:paramtypes",[Oz]),Fz("design:returntype",void 0)],QI,"getLoading",null),Ez([Object(L.e)(),Fz("design:type",Function),Fz("design:paramtypes",[Oz]),Fz("design:returntype",void 0)],QI,"getSearchMode",null),Ez([Object(L.e)(),Fz("design:type",Function),Fz("design:paramtypes",[Oz]),Fz("design:returntype",void 0)],QI,"getSearchConfig",null),Ez([Object(L.e)(),Fz("design:type",Function),Fz("design:paramtypes",[Oz]),Fz("design:returntype",void 0)],QI,"getSearchOptions",null),Ez([Object(L.e)(),Fz("design:type",Function),Fz("design:paramtypes",[Oz]),Fz("design:returntype",void 0)],QI,"getSearchType",null),Ez([Object(L.e)(),Fz("design:type",Function),Fz("design:paramtypes",[Oz]),Fz("design:returntype",void 0)],QI,"getSearchGroup",null),Ez([Object(L.e)(),Fz("design:type",Function),Fz("design:paramtypes",[Oz]),Fz("design:returntype",void 0)],QI,"getViewMode",null),Ez([Object(L.e)(),Fz("design:type",Function),Fz("design:paramtypes",[Oz]),Fz("design:returntype",void 0)],QI,"getSort",null),Ez([Object(L.e)(),Fz("design:type",Function),Fz("design:paramtypes",[Oz]),Fz("design:returntype",void 0)],QI,"getSortOptions",null),Ez([Object(L.e)(),Fz("design:type",Function),Fz("design:paramtypes",[Oz]),Fz("design:returntype",void 0)],QI,"getSidenav",null),Ez([Object(L.e)(),Fz("design:type",Function),Fz("design:paramtypes",[Oz]),Fz("design:returntype",void 0)],QI,"getBulkActions",null),Ez([Object(L.e)(),Fz("design:type",Function),Fz("design:paramtypes",[Oz]),Fz("design:returntype",void 0)],QI,"getCardActions",null),Ez([Object(L.e)([bz]),Fz("design:type",Function),Fz("design:paramtypes",[Oz,GP]),Fz("design:returntype",Dz)],QI,"getFilteredResults",null),Ez([Object(L.e)(),Fz("design:type",Function),Fz("design:paramtypes",[Oz,GP]),Fz("design:returntype",Dz)],QI,"getAllResults",null),Ez([Object(L.e)(),Fz("design:type",Function),Fz("design:paramtypes",[Oz]),Fz("design:returntype",void 0)],QI,"getCheckedResults",null),QI=Ez([Object(L.f)({name:"gallery",defaults:Az})],QI)),Nz=((BI=function e(){m(this,e)}).\u0275mod=_.Nb({type:BI}),BI.\u0275inj=_.Mb({factory:function(e){return new(e||BI)},imports:[[L.c.forFeature([Rz]),df.b,we.f,Jj,or.c,Hg.q,kz,cP,Fj,Dj,IP,OP,zP,Sj.a]]}),BI),Vz=((HI=function e(){m(this,e)}).\u0275mod=_.Nb({type:HI}),HI.\u0275inj=_.Mb({factory:function(e){return new(e||HI)},imports:[[zP,Dj,or.c,we.f,IP,Cr,Hg.q,kz,Nz,L.c.forFeature([Lu])]]}),HI),Hz=((VI=function e(){m(this,e)}).\u0275mod=_.Nb({type:VI}),VI.\u0275inj=_.Mb({factory:function(e){return new(e||VI)},imports:[[or.c,Od.a.forChild()]]}),VI),Bz=((NI=function e(){m(this,e)}).\u0275mod=_.Nb({type:NI}),NI.\u0275inj=_.Mb({factory:function(e){return new(e||NI)},imports:[[or.c,zP,Dj,Hz]]}),NI),Qz=((RI=function e(){m(this,e)}).\u0275mod=_.Nb({type:RI}),RI.\u0275inj=_.Mb({factory:function(e){return new(e||RI)},imports:[[L.c.forFeature([So]),or.c,Zj,Hg.q]]}),RI),qz=((AI=function e(){m(this,e)}).\u0275mod=_.Nb({type:AI}),AI.\u0275inj=_.Mb({factory:function(e){return new(e||AI)},imports:[[L.c.forFeature([Rc,Ua,Pc]),or.c,zP,Dj,sP,Bz,Hg.q,Od.a.forChild(),Qz]]}),AI),Wz=((FI=function e(){m(this,e)}).\u0275mod=_.Nb({type:FI}),FI.\u0275inj=_.Mb({factory:function(e){return new(e||FI)},imports:[[L.c.forFeature([qa,Fa,Fi,Th,ao]),ke.d,or.c,cP,Dj,Hg.i,qz,zP,sP]]}),FI),$z=function e(){m(this,e)},Kz=function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r},Gz=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Zz={joining:!1,inviting:!1,loadingUsers:!1},Jz=((az=function(){function e(t,n){m(this,e),this.organizationsService=t,this.publishService=n}return v(e,[{key:"selectOrganization",value:function(e,t){var n=t.organization;e.patchState({selectedOrganization:n,selectedCollection:null}),n&&e.dispatch(new gI(n.id))}},{key:"setOrganizations",value:function(e,t){var n,i=t.organizations||[],o=i[0],a=null,r=Object.assign({},e.getState().appFeatures);if(o&&o.group_attributes){var c=o.group_attributes,s=this.organizationsService.getOrganizationAttribute(c,"widget_settings","widget_custom_url_path");s&&s.value&&(n=s.value);var l=this.organizationsService.getOrganizationAttribute(c,"widget_settings","widget_url_params");l&&l.value&&(a=this.publishService.extendWidgetOptions(new UC,l.value));var p=this.organizationsService.getOrganizationAttribute(c,"app_settings","web_app_features");p&&(r=Object.assign(Object.assign({},r),p.value))}e.patchState({organization:o,organizations:i,widgetURL:n,widgetOptions:a,appFeatures:r}),e.dispatch(new UP(n))}},{key:"joinOrganization",value:function(e,t){var n=t.organization;e.patchState({joining:!0}),this.organizationsService.addUserToOrganization(n.eid).pipe(Object(ae.a)((function(){return e.patchState({joining:!1})}))).subscribe((function(){return e.dispatch(new bI(n))}),(function(t){return e.dispatch(new vI(n))}))}},{key:"joinOrganizationWithCode",value:function(e,t){var n=t.code;e.patchState({joining:!0}),this.organizationsService.addUserWithGroupCode(n).pipe(Object(ae.a)((function(){return e.patchState({joining:!1})}))).subscribe((function(t){return e.dispatch(new yI(t))}),(function(t){return e.dispatch(new xI(t))}))}},{key:"sendOrganizationInvite",value:function(e,t){var n=t.groupEID,i=t.emails;e.patchState({inviting:!0}),this.organizationsService.sendOrganizationInvites(n,i).pipe(Object(ae.a)((function(){return e.patchState({inviting:!1})}))).subscribe((function(t){return e.dispatch(new kI(t))}),(function(t){return e.dispatch(new OI(t))}))}},{key:"getOrganizationUsers",value:function(e,t){var n=t.groupEID;e.patchState({loadingUsers:!0}),this.organizationsService.getOrganizationUsers(n).pipe(Object(ae.a)((function(){return e.patchState({loadingUsers:!1})}))).subscribe((function(t){return e.dispatch(new SI(t))}),(function(t){return e.dispatch(new _I(t))}))}},{key:"getCollections",value:function(e,t){this.organizationsService.getCollections(t.organizationId).subscribe((function(t){e.dispatch(new hI(t))}))}},{key:"getCollectionsSuccess",value:function(e,t){e.patchState({collections:t.collections})}},{key:"selectCollection",value:function(e,t){var n=e.getState(),i=n.organization,o=n.selectedOrganization;e.patchState({selectedOrganization:o||i,selectedCollection:t.collection})}},{key:"resetOrganizations",value:function(e,t){e.setState(Zz)}}],[{key:"getOrganizations",value:function(e){return e.organizations}},{key:"getOrganization",value:function(e){return e.organization}},{key:"getSelectedOrganization",value:function(e){return e.selectedOrganization}},{key:"getCollections",value:function(e){return e.collections}},{key:"getSelectedCollection",value:function(e){return e.selectedCollection}},{key:"getWidgetURL",value:function(e){return e.widgetURL}},{key:"getWidgetOptions",value:function(e){return e.widgetOptions}},{key:"getAppFeatures",value:function(e){return e.appFeatures}},{key:"getJoining",value:function(e){return e.joining}},{key:"getInviting",value:function(e){return e.inviting}},{key:"getUsersLoading",value:function(e){return e.loadingUsers}}]),e}()).\u0275fac=function(e){return new(e||az)(_.Zb(BC),_.Zb(NC))},az.\u0275prov=_.Lb({token:az,factory:az.\u0275fac}),Kz([Object(L.a)(uI),Gz("design:type",Function),Gz("design:paramtypes",[Object,uI]),Gz("design:returntype",void 0)],az.prototype,"selectOrganization",null),Kz([Object(L.a)(pI),Gz("design:type",Function),Gz("design:paramtypes",[Object,pI]),Gz("design:returntype",void 0)],az.prototype,"setOrganizations",null),Kz([Object(L.a)(fI),Gz("design:type",Function),Gz("design:paramtypes",[Object,fI]),Gz("design:returntype",void 0)],az.prototype,"joinOrganization",null),Kz([Object(L.a)(mI),Gz("design:type",Function),Gz("design:paramtypes",[Object,mI]),Gz("design:returntype",void 0)],az.prototype,"joinOrganizationWithCode",null),Kz([Object(L.a)(wI),Gz("design:type",Function),Gz("design:paramtypes",[Object,wI]),Gz("design:returntype",void 0)],az.prototype,"sendOrganizationInvite",null),Kz([Object(L.a)(CI),Gz("design:type",Function),Gz("design:paramtypes",[Object,CI]),Gz("design:returntype",void 0)],az.prototype,"getOrganizationUsers",null),Kz([Object(L.a)(gI),Gz("design:type",Function),Gz("design:paramtypes",[Object,gI]),Gz("design:returntype",void 0)],az.prototype,"getCollections",null),Kz([Object(L.a)(hI),Gz("design:type",Function),Gz("design:paramtypes",[Object,hI]),Gz("design:returntype",void 0)],az.prototype,"getCollectionsSuccess",null),Kz([Object(L.a)(dI),Gz("design:type",Function),Gz("design:paramtypes",[Object,dI]),Gz("design:returntype",void 0)],az.prototype,"selectCollection",null),Kz([Object(L.a)(jI),Gz("design:type",Function),Gz("design:paramtypes",[Object,jI]),Gz("design:returntype",void 0)],az.prototype,"resetOrganizations",null),Kz([Object(L.e)(),Gz("design:type",Function),Gz("design:paramtypes",[$z]),Gz("design:returntype",void 0)],az,"getOrganizations",null),Kz([Object(L.e)(),Gz("design:type",Function),Gz("design:paramtypes",[$z]),Gz("design:returntype",void 0)],az,"getOrganization",null),Kz([Object(L.e)(),Gz("design:type",Function),Gz("design:paramtypes",[$z]),Gz("design:returntype",void 0)],az,"getSelectedOrganization",null),Kz([Object(L.e)(),Gz("design:type",Function),Gz("design:paramtypes",[$z]),Gz("design:returntype",void 0)],az,"getCollections",null),Kz([Object(L.e)(),Gz("design:type",Function),Gz("design:paramtypes",[$z]),Gz("design:returntype",void 0)],az,"getSelectedCollection",null),Kz([Object(L.e)(),Gz("design:type",Function),Gz("design:paramtypes",[$z]),Gz("design:returntype",void 0)],az,"getWidgetURL",null),Kz([Object(L.e)(),Gz("design:type",Function),Gz("design:paramtypes",[$z]),Gz("design:returntype",void 0)],az,"getWidgetOptions",null),Kz([Object(L.e)(),Gz("design:type",Function),Gz("design:paramtypes",[$z]),Gz("design:returntype",void 0)],az,"getAppFeatures",null),Kz([Object(L.e)(),Gz("design:type",Function),Gz("design:paramtypes",[$z]),Gz("design:returntype",void 0)],az,"getJoining",null),Kz([Object(L.e)(),Gz("design:type",Function),Gz("design:paramtypes",[$z]),Gz("design:returntype",void 0)],az,"getInviting",null),Kz([Object(L.e)(),Gz("design:type",Function),Gz("design:paramtypes",[$z]),Gz("design:returntype",void 0)],az,"getUsersLoading",null),az=Kz([Object(L.f)({name:"organizations",defaults:Zz})],az)),Xz=((oz=function e(){m(this,e)}).\u0275mod=_.Nb({type:oz}),oz.\u0275inj=_.Mb({factory:function(e){return new(e||oz)},imports:[[or.c,Dj,zP,wz,L.c.forFeature([Jz])]]}),oz),Yz=((iz=function e(){m(this,e)}).\u0275mod=_.Nb({type:iz}),iz.\u0275inj=_.Mb({factory:function(e){return new(e||iz)},imports:[[or.c,Dj,zP]]}),iz),eT=((nz=function e(){m(this,e)}).\u0275mod=_.Nb({type:nz}),nz.\u0275inj=_.Mb({factory:function(e){return new(e||nz)},imports:[[or.c,Dj,zP]]}),nz),tT=((tz=function e(){m(this,e)}).\u0275mod=_.Nb({type:tz}),tz.\u0275inj=_.Mb({factory:function(e){return new(e||tz)},imports:[[or.c,Dj,zP,Hg.q]]}),tz),nT=((ez=function e(){m(this,e)}).\u0275mod=_.Nb({type:ez}),ez.\u0275inj=_.Mb({factory:function(e){return new(e||ez)},imports:[[or.c,Dj,zP]]}),ez),iT=((YI=function e(){m(this,e)}).\u0275mod=_.Nb({type:YI}),YI.\u0275inj=_.Mb({factory:function(e){return new(e||YI)},imports:[[or.c,Dj,zP]]}),YI),oT=((XI=function e(){m(this,e)}).\u0275mod=_.Nb({type:XI}),XI.\u0275inj=_.Mb({factory:function(e){return new(e||XI)},imports:[[or.c,Dj,zP]]}),XI),aT=((JI=function e(){m(this,e)}).\u0275mod=_.Nb({type:JI}),JI.\u0275inj=_.Mb({factory:function(e){return new(e||JI)},imports:[[or.c,Dj,zP]]}),JI),rT=((ZI=function e(){m(this,e)}).\u0275mod=_.Nb({type:ZI}),ZI.\u0275inj=_.Mb({factory:function(e){return new(e||ZI)},imports:[[or.c,Dj,zP]]}),ZI),cT=((GI=function e(){m(this,e)}).\u0275mod=_.Nb({type:GI}),GI.\u0275inj=_.Mb({factory:function(e){return new(e||GI)},imports:[[or.c,Dj,Jj]]}),GI),sT=((KI=function e(){m(this,e)}).\u0275mod=_.Nb({type:KI}),KI.\u0275inj=_.Mb({factory:function(e){return new(e||KI)},imports:[[or.c,Dj,zP]]}),KI),lT=(($I=function e(){m(this,e)}).\u0275mod=_.Nb({type:$I}),$I.\u0275inj=_.Mb({factory:function(e){return new(e||$I)},imports:[[or.c,Dj,zP,Hg.q]]}),$I),pT=((WI=function e(){m(this,e)}).\u0275mod=_.Nb({type:WI}),WI.\u0275inj=_.Mb({factory:function(e){return new(e||WI)},imports:[[or.c,Dj,zP,Hg.q]]}),WI),uT=((qI=function e(){m(this,e)}).\u0275mod=_.Nb({type:qI}),qI.\u0275inj=_.Mb({factory:function(e){return new(e||qI)},imports:[[or.c,Dj,zP]]}),qI),dT=function e(){m(this,e)};!function(e){var t=function e(){m(this,e)};t.type="[Dialog] Open Limit",e.OpenLimit=t;var n=function e(t){m(this,e),this.upgrade=t};n.type="[Dialog] Close Limit",e.CloseLimit=n;var i=function e(){m(this,e)};i.type="[Dialog] Open Premium Content",e.OpenPremiumContent=i;var o=function e(t){m(this,e),this.confirmed=t};o.type="[Dialog] Close Premium Content",e.ClosePremiumContent=o;var a=function e(){m(this,e)};a.type="[Dialog] Open Upgrade",e.OpenUpgrade=a;var r=function e(){m(this,e)};r.type="[Dialog] Close Upgrade",e.CloseUpgrade=r}(rz||(rz={}));var gT,hT=((gT=function(){function e(){m(this,e)}return v(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||gT)},gT.\u0275cmp=_.Jb({type:gT,selectors:[["app-limit-dialog"]],decls:12,vars:2,consts:[["mat-dialog-title",""],["mat-dialog-content","",1,"pt-1","pb-6"],[1,"text-14","pb-3"],[1,"text-14"],["mat-dialog-actions","",1,"pt-2"],["app-button","","buttonTheme","light","cdkFocusInitial","",1,"mr-2",3,"mat-dialog-close"],["app-button","","buttonType","primary",3,"mat-dialog-close"]],template:function(e,t){1&e&&(_.Vb(0,"h1",0),_.Mc(1," New Bookmark Limit Reached\n"),_.Ub(),_.Vb(2,"div",1),_.Vb(3,"div",2),_.Mc(4,"You've reached your limit of 5 3D models in your Library. You can make changes to this model, but you will not be able to save as a new model."),_.Ub(),_.Vb(5,"div",3),_.Mc(6,"Upgrade to a Premium Plan to save unlimited 3D models."),_.Ub(),_.Ub(),_.Vb(7,"div",4),_.Vb(8,"button",5),_.Mc(9,"OK"),_.Ub(),_.Vb(10,"button",6),_.Mc(11,"Go Premium"),_.Ub(),_.Ub()),2&e&&(_.Db(8),_.lc("mat-dialog-close",!1),_.Db(2),_.lc("mat-dialog-close",!0))},directives:[Xd.h,Xd.e,Xd.c,sl,Xd.d],styles:[""],changeDetection:0}),gT);function fT(e,t){if(1&e&&_.Qb(0,"iframe",5),2&e){var n=_.gc();_.lc("src",n.src,_.Bc)}}var bT,vT=function(e){return e.UpgradeSubscription="/legacy/upgrade-human.html",e.BuySubscription="/legacy/buy-subscription.html",e.MyProfile="/legacy/user-account.html",e}({}),mT=((bT=function(){function e(t,n,i){m(this,e),this.dialogRef=t,this.data=n,this.sanitizer=i,this.headerOffset=100,this.settings={type:null,dimensions:{width:100,height:100}},this.settings=Object.assign(Object.assign({},this.settings),n);var o=n.dimensions,a=o.width,r=o.height;this.dialogRef.updateSize(a+"px",r+"px")}return v(e,[{key:"height",get:function(){var e=this.settings.dimensions.height;return Math.max(200,e-this.headerOffset)}},{key:"src",get:function(){var e=this.getURL();return e?this.sanitizer.bypassSecurityTrustResourceUrl(e):null}},{key:"ngOnInit",value:function(){}},{key:"closeDialog",value:function(){this.dialogRef.close()}},{key:"getURL",value:function(){var e=""+this.settings.type;if(Object.values(vT).includes(e)){var t=this.getURLParams();return t?"".concat(e,"?").concat(t):e}return""}},{key:"getURLParams",value:function(){var e=this.settings.options;return e?Object.entries(e).map((function(e){var t=u(e,2),n=t[0],i=t[1];return"".concat(n,"=").concat(i)})).join("&"):""}}]),e}()).\u0275fac=function(e){return new(e||bT)(_.Pb(Xd.g),_.Pb(Xd.a),_.Pb(T.b))},bT.\u0275cmp=_.Jb({type:bT,selectors:[["app-legacy-dialog"]],decls:5,vars:4,consts:[[1,"modal"],["app-button","","buttonType","text","buttonTheme","light","type","button","title","Close",1,"modal__close",3,"click"],["icon","times","size","lg"],[1,"modal__contents"],["class","modal__frame",3,"src",4,"ngIf"],[1,"modal__frame",3,"src"]],template:function(e,t){1&e&&(_.Vb(0,"div",0),_.Vb(1,"button",1),_.cc("click",(function(){return t.closeDialog()})),_.Qb(2,"app-icon",2),_.Ub(),_.Vb(3,"div",3),_.Kc(4,fT,1,1,"iframe",4),_.Ub(),_.Ub()),2&e&&(_.Db(1),_.Eb("aria-label","Close"),_.Db(2),_.Hc("height",t.height+"px"),_.Db(1),_.lc("ngIf",t.src))},directives:[sl,Js,or.l],styles:[".modal[_ngcontent-%COMP%]{display:flex;flex-direction:column}.modal__close[_ngcontent-%COMP%]{margin-bottom:4px;align-self:flex-end;cursor:pointer}.modal__contents[_ngcontent-%COMP%]{display:flex;flex-flow:column;height:100vh}.modal__frame[_ngcontent-%COMP%]{flex:1 1 auto;display:flex}"],changeDetection:0}),bT);function yT(e,t){if(1&e&&(_.Vb(0,"button",7),_.Mc(1),_.Ub()),2&e){var n=_.gc();_.Db(1),_.Nc(n.settings.miscText)}}function xT(e,t){if(1&e&&(_.Vb(0,"button",8),_.Mc(1),_.Ub()),2&e){var n=_.gc();_.lc("mat-dialog-close",!1),_.Db(1),_.Nc(n.settings.cancelText)}}function wT(e,t){if(1&e&&(_.Vb(0,"button",9),_.Mc(1),_.Ub()),2&e){var n=_.gc();_.lc("mat-dialog-close",!0),_.Db(1),_.Nc(n.settings.confirmText)}}var kT,OT,CT,ST,_T,jT,PT,MT,IT,zT,TT,UT,LT,DT,ET,FT,AT,RT,NT,VT,HT,BT=((kT=function(){function e(t,n){m(this,e),this.dialogRef=t,this.data=n,this.settings={titleText:"Confirm Action",bodyText:"",confirmText:"Confirm",confirmColor:"primary",cancelText:"Cancel",confirmEnabled:!0,cancelEnabled:!0,miscText:""},n&&(this.settings=Object.assign(Object.assign({},this.settings),n))}return v(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||kT)(_.Pb(Xd.g),_.Pb(Xd.a))},kT.\u0275cmp=_.Jb({type:kT,selectors:[["app-confirm-dialog"]],decls:10,vars:7,consts:[["mat-dialog-title",""],["mat-dialog-content","",1,"pt-4","pb-6"],[1,"text-14"],["mat-dialog-actions","",1,"dialog__actions","pt-2"],["app-button","","buttonTheme","light",3,"mat-dialog-close",4,"ngIf"],["class","mr-1","app-button","","buttonTheme","light",3,"mat-dialog-close",4,"ngIf"],["app-button","","buttonType","primary","cdkFocusInitial","",3,"mat-dialog-close",4,"ngIf"],["app-button","","buttonTheme","light",3,"mat-dialog-close"],["app-button","","buttonTheme","light",1,"mr-1",3,"mat-dialog-close"],["app-button","","buttonType","primary","cdkFocusInitial","",3,"mat-dialog-close"]],template:function(e,t){1&e&&(_.Vb(0,"h1",0),_.Mc(1),_.Ub(),_.Vb(2,"div",1),_.Vb(3,"div",2),_.Mc(4),_.Ub(),_.Ub(),_.Vb(5,"div",3),_.Kc(6,yT,2,1,"button",4),_.Vb(7,"div"),_.Kc(8,xT,2,2,"button",5),_.Kc(9,wT,2,2,"button",6),_.Ub(),_.Ub()),2&e&&(_.Db(1),_.Oc(" ",t.settings.titleText,"\n"),_.Db(3),_.Nc(t.settings.bodyText),_.Db(1),_.Hb("dialog__actions--compact",!t.settings.miscText),_.Db(1),_.lc("ngIf",t.settings.miscText),_.Db(2),_.lc("ngIf",t.settings.cancelEnabled),_.Db(1),_.lc("ngIf",t.settings.confirmEnabled))},directives:[Xd.h,Xd.e,Xd.c,or.l,sl,Xd.d],styles:["[_nghost-%COMP%]{display:block}.dialog__actions[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between;align-items:center}.dialog__actions--compact[_ngcontent-%COMP%]{justify-content:flex-end}@media (min-width:480px){[_nghost-%COMP%]{min-width:320px}}"],changeDetection:0}),kT),QT=["copyField"],qT=((CT=function(){function e(t,n,i){m(this,e),this.dialogRef=t,this.data=n,this.clipboardService=i,this.settings={title:"Copy to Clipboard",copyText:""},this.settings=Object.assign(Object.assign({},this.settings),n)}return v(e,[{key:"rowCount",get:function(){return this.settings.copyText.split(/\r?\n/).length+1}},{key:"ngOnInit",value:function(){}},{key:"ngAfterViewInit",value:function(){var e=this.copyField.nativeElement;e.focus(),e.select()}},{key:"handleCopyClick",value:function(){var e=this.clipboardService.copyInputFieldValue(this.copyField.nativeElement);this.close(e)}},{key:"handleCancelClick",value:function(){this.close(!1)}},{key:"close",value:function(e){this.dialogRef.close(e)}}]),e}()).\u0275fac=function(e){return new(e||CT)(_.Pb(Xd.g),_.Pb(Xd.a),_.Pb(Xs))},CT.\u0275cmp=_.Jb({type:CT,selectors:[["app-clipboard-dialog"]],viewQuery:function(e,t){var n;1&e&&_.Gc(QT,!0),2&e&&_.uc(n=_.dc())&&(t.copyField=n.first)},decls:11,vars:3,consts:[["mat-dialog-title",""],["mat-dialog-content","",1,"copy"],[1,"copy__input",3,"value","rows"],["copyField",""],["mat-dialog-actions",""],["app-button","","buttonTheme","light",3,"click"],["app-button","","buttonType","primary",3,"click"]],template:function(e,t){1&e&&(_.Vb(0,"div",0),_.Mc(1),_.Ub(),_.Vb(2,"div",1),_.Vb(3,"textarea",2,3),_.Mc(5,"  "),_.Ub(),_.Ub(),_.Vb(6,"div",4),_.Vb(7,"button",5),_.cc("click",(function(){return t.handleCancelClick()})),_.Mc(8,"Cancel"),_.Ub(),_.Vb(9,"button",6),_.cc("click",(function(){return t.handleCopyClick()})),_.Mc(10,"Copy to Clipboard"),_.Ub(),_.Ub()),2&e&&(_.Db(1),_.Oc(" ",t.settings.title,"\n"),_.Db(2),_.lc("value",t.settings.copyText)("rows",t.rowCount))},directives:[Xd.h,Xd.e,Xd.c,sl],styles:[".copy[_ngcontent-%COMP%]{min-width:480px;display:flex}.copy__input[_ngcontent-%COMP%]{flex:1}"],changeDetection:0}),CT),WT=((OT=function(){function e(t,n){m(this,e),this.dialog=t,this.engineService=n}return v(e,[{key:"isMobile",get:function(){return window.innerWidth<=959}},{key:"openClipboardDialog",value:function(e,t){var n=Object.assign({data:{id:mg.ClipboardDialog,copyText:e}},t);return this.dialog.open(qT,n)}},{key:"openConfirmDialog",value:function(e){var t=Object.assign({id:mg.ConfirmDialog},e);return this.dialog.open(BT,t)}},{key:"openLimitDialog",value:function(){return this.closeAllDialogs(),this.dialog.open(hT,{id:mg.LimitDialog,width:"480px"})}},{key:"openUpgradeDialog",value:function(e){var t={width:925,height:700},n=Object.assign(Object.assign({id:mg.UpgradeDialog},{width:t.width+"px",height:t.height+"px",data:{type:vT.UpgradeSubscription,dimensions:t}}),e);return this.closeAllDialogs(),z.native?(this.engineService.fireEvent(Lt.NativeUpgrade,null),Object($.a)()):this.dialog.open(mT,n).afterClosed()}},{key:"openPremiumContentDialog",value:function(){var e=z.native||!this.isMobile;return this.openConfirmDialog({id:mg.PremiumContentDialog,data:{titleText:"Premium Content",bodyText:e?"This is premium content. Upgrade to a Premium Plan for unlimited access.":"This is premium content. Visit us on desktop to upgrade to a premium plan.",confirmText:"Go Premium",confirmEnabled:e,cancelText:"OK",confirmColor:"warn"}})}},{key:"closeAllDialogs",value:function(){this.dialog.closeAll()}}]),e}()).\u0275fac=function(e){return new(e||OT)(_.Zb(Xd.b),_.Zb(Nt))},OT.\u0275prov=_.Lb({token:OT,factory:OT.\u0275fac,providedIn:"root"}),OT),$T=function(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r},KT=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},GT=((zT=function(){function e(t){m(this,e),this.dialogService=t}return v(e,[{key:"openLimit",value:function(e,t){this.dialogService.openLimitDialog().afterClosed().subscribe((function(t){e.dispatch(new rz.CloseLimit(t))}))}},{key:"closeLimit",value:function(e,t){t.upgrade&&this.dialogService.openUpgradeDialog()}},{key:"openPremiumContent",value:function(e,t){this.dialogService.openPremiumContentDialog().afterClosed().subscribe((function(t){e.dispatch(new rz.ClosePremiumContent(t))}))}},{key:"closePremiumContent",value:function(e,t){t.confirmed&&e.dispatch(new rz.OpenUpgrade)}},{key:"openUpgrade",value:function(e,t){this.dialogService.openUpgradeDialog()}}],[{key:"getOpenDialog",value:function(e){return e.openDialog}}]),e}()).\u0275fac=function(e){return new(e||zT)(_.Zb(WT))},zT.\u0275prov=_.Lb({token:zT,factory:zT.\u0275fac}),$T([Object(L.a)(rz.OpenLimit),KT("design:type",Function),KT("design:paramtypes",[Object,rz.OpenLimit]),KT("design:returntype",void 0)],zT.prototype,"openLimit",null),$T([Object(L.a)(rz.CloseLimit),KT("design:type",Function),KT("design:paramtypes",[Object,rz.CloseLimit]),KT("design:returntype",void 0)],zT.prototype,"closeLimit",null),$T([Object(L.a)(rz.OpenPremiumContent),KT("design:type",Function),KT("design:paramtypes",[Object,rz.OpenPremiumContent]),KT("design:returntype",void 0)],zT.prototype,"openPremiumContent",null),$T([Object(L.a)(rz.ClosePremiumContent),KT("design:type",Function),KT("design:paramtypes",[Object,rz.ClosePremiumContent]),KT("design:returntype",void 0)],zT.prototype,"closePremiumContent",null),$T([Object(L.a)(rz.OpenUpgrade),KT("design:type",Function),KT("design:paramtypes",[Object,rz.OpenUpgrade]),KT("design:returntype",void 0)],zT.prototype,"openUpgrade",null),$T([Object(L.e)(),KT("design:type",Function),KT("design:paramtypes",[dT]),KT("design:returntype",void 0)],zT,"getOpenDialog",null),zT=$T([Object(L.f)({name:"dialog",defaults:{openDialog:null}})],zT)),ZT=((IT=function e(){m(this,e)}).\u0275mod=_.Nb({type:IT}),IT.\u0275inj=_.Mb({factory:function(e){return new(e||IT)},imports:[[or.c,Dj,zP,Hg.q]]}),IT),JT=((MT=function e(){m(this,e)}).\u0275mod=_.Nb({type:MT}),MT.\u0275inj=_.Mb({factory:function(e){return new(e||MT)},imports:[[or.c,Dj,zP,Hg.q]]}),MT),XT=((PT=function e(){m(this,e)}).\u0275mod=_.Nb({type:PT}),PT.\u0275inj=_.Mb({factory:function(e){return new(e||PT)},imports:[[or.c,Dj,zP,Hg.q]]}),PT),YT=((jT=function e(){m(this,e)}).\u0275mod=_.Nb({type:jT}),jT.\u0275inj=_.Mb({factory:function(e){return new(e||jT)},imports:[[or.c,Dj,zP]]}),jT),eU=((_T=function e(){m(this,e)}).\u0275mod=_.Nb({type:_T}),_T.\u0275inj=_.Mb({factory:function(e){return new(e||_T)},imports:[[or.c,Dj,Hg.i,Hg.q,zP]]}),_T),tU=((ST=function e(){m(this,e)}).\u0275mod=_.Nb({type:ST}),ST.\u0275inj=_.Mb({factory:function(e){return new(e||ST)},imports:[[L.c.forFeature([GT]),Yz,eT,tT,nT,iT,oT,aT,rT,cT,sT,lT,pT,uT,ZT,JT,XT,YT,eU,PP,SP,zP],Yz,eT,tT,nT,iT,oT,aT,rT,cT,sT,lT,pT,uT,ZT,JT,XT,YT,eU]}),ST),nU=[],iU=((HT=function e(){m(this,e)}).\u0275mod=_.Nb({type:HT}),HT.\u0275inj=_.Mb({factory:function(e){return new(e||HT)},imports:[[we.f.forChild(nU)],we.f]}),HT),oU=((VT=function e(){m(this,e)}).\u0275mod=_.Nb({type:VT}),VT.\u0275inj=_.Mb({factory:function(e){return new(e||VT)},imports:[[or.c]]}),VT),aU=((NT=function e(){m(this,e)}).\u0275mod=_.Nb({type:NT}),NT.\u0275inj=_.Mb({factory:function(e){return new(e||NT)},imports:[[or.c,Zj]]}),NT),rU=((RT=function e(){m(this,e)}).\u0275mod=_.Nb({type:RT}),RT.\u0275inj=_.Mb({factory:function(e){return new(e||RT)},imports:[[or.c,Dj,Jj,cP,Zj,Bz,Fj,Hg.q,Qz,OP]]}),RT),cU=((AT=function e(){m(this,e)}).\u0275mod=_.Nb({type:AT}),AT.\u0275inj=_.Mb({factory:function(e){return new(e||AT)},imports:[[L.c.forFeature([hp]),Od.a.forChild(),ke.d,or.c,Wz,iU,Dj,Hg.q,Hg.i,Jj,cP,Zj,_P,jP,oU,lP,OP,sP,df.b,kz,qz,Bz,zP,aU,Qz,rU]]}),AT),sU=((FT=function(){function e(){m(this,e)}return v(e,[{key:"intercept",value:function(e,t){return t.handle(e).pipe(Object(K.a)((function(e){return e instanceof W.e&&e.body&&e.body.hasOwnProperty("results")&&(e=e.clone({body:e.body.results})),e})))}}]),e}()).\u0275fac=function(e){return new(e||FT)},FT.\u0275prov=_.Lb({token:FT,factory:FT.\u0275fac}),FT),lU=((ET=function e(){m(this,e)}).\u0275mod=_.Nb({type:ET}),ET.\u0275inj=_.Mb({factory:function(e){return new(e||ET)},providers:[AS],imports:[[L.c.forFeature([de]),or.c,zP]]}),ET),pU=((DT=function e(){m(this,e)}).\u0275mod=_.Nb({type:DT}),DT.\u0275inj=_.Mb({factory:function(e){return new(e||DT)},imports:[[or.c,we.f,Jj,cP,Zj]]}),DT),uU=((LT=function(){function e(){m(this,e)}return v(e,[{key:"parse",value:function(e){e=e.replace(/&amp;/g,"&");var t=(new we.b).parse(e);return this.ensureQueryParam(t.queryParams,"dk",e),this.ensureQueryParam(t.queryParams,"uaid",e),t}},{key:"serialize",value:function(e){return(new we.b).serialize(e).replace(/%2F/g,"/")}},{key:"ensureQueryParam",value:function(e,t,n){if(e.hasOwnProperty(t))return e;var i=this.getParameterByName(t,n);return null!==i&&(e[t]=i),e}},{key:"getParameterByName",value:function(e,t){t||(t=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");var n=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)").exec(t);return n?n[2]?decodeURIComponent(n[2].replace(/\+/g," ")):"":null}}]),e}()).\u0275fac=function(e){return new(e||LT)},LT.\u0275prov=_.Lb({token:LT,factory:LT.\u0275fac}),LT),dU=((UT=function e(){m(this,e)}).\u0275mod=_.Nb({type:UT}),UT.\u0275inj=_.Mb({factory:function(e){return new(e||UT)},imports:[[L.c.forFeature([Ap]),or.c]]}),UT),gU=((TT=function e(){m(this,e)}).\u0275mod=_.Nb({type:TT}),TT.\u0275inj=_.Mb({factory:function(e){return new(e||TT)},imports:[[L.c.forFeature([Jy]),or.c]]}),TT),hU=h("OnMO");function fU(){var e=new hU.Renderer;return e.link=function(e,t,n){var i;return'<a href="'.concat((i=e).match(/^(?:(?:(?:ht)tps?):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i)?i:"",'" target="_blank" rel="noreferrer nofollow">').concat(n,"</a>")},e.paragraph=function(e){return"<p>".concat(e,"</p>")},e.image=function(e,t,n){return""},{renderer:e,gfm:!1}}var bU,vU,mU=((vU=function e(){m(this,e)}).\u0275mod=_.Nb({type:vU}),vU.\u0275inj=_.Mb({factory:function(e){return new(e||vU)},imports:[[or.c,Od.a.forRoot({markedOptions:{provide:Od.d,useFactory:fU}})]]}),vU),yU=((bU=function(){function e(){m(this,e)}return v(e,null,[{key:"forRoot",value:function(t){return{ngModule:e,providers:[Se,{provide:"pendoConfig",useValue:t}]}}}]),e}()).\u0275mod=_.Nb({type:bU}),bU.\u0275inj=_.Mb({factory:function(e){return new(e||bU)},imports:[[]]}),bU);immer.enableAllPlugins(),immer.enableES5();var xU,wU,kU=[{provide:W.a,useClass:sU,multi:!0},{provide:we.h,useClass:uU},{provide:or.a,useValue:"./"},{provide:or.h,useClass:or.e}],OU=[{provide:W.a,useClass:sU,multi:!0},{provide:we.h,useClass:uU}],CU=((wU=function e(){m(this,e)}).\u0275mod=_.Nb({type:wU,bootstrap:[af]}),wU.\u0275inj=_.Mb({factory:function(e){return new(e||wU)},providers:!0===z.offline?kU:OU,imports:[[L.c.forRoot(),dU,Cr.forRoot(),ke.d.forRoot(z.googleAnalyticsId),yU.forRoot({enabled:!0,pendoId:z.pendoId,whitelist:p({},j.Viewer,z.deploy===M.Production?["48Ab","3FZO","3FN2","3Hb8","3FQJ","3FQU","38fD","3wgE","3gLk","3vSx","3XdS","3SOp","3Um8","3hOe","3QWH","4C1Q","3WvE","3epq","3Dyq","3O47","3DJ4","3fKF","3gLf","3PVx","3caY","3cTn","3tVK","3Yau","3QSx","3ZY5","3Z6w","3IF5","3fKs","45y8","3fLN","3QpZ","3J6C","3adO","3Z6v","3hjc","3a50","4EBE","44FH","3WlU","3atu","4E2N","4Bma","43bE","3xxi","3CT7","4D5X","3UVi","3T7X","3QT8","3NG8","3gyj","3UWt","3UWc"]:["production/maleAdult/coronavirus_protein_structure","production/maleAdult/eyeAnatomyTour","production/maleAdult/acute_lymphoblastic_leukemia","production/maleAdult/abdominal_aortic_aneurysm"]),idPrefixes:(xU={},p(xU,M.Local,"local-"),p(xU,M.QA,"qa-"),p(xU,M.Staging,"staging-"),p(xU,M.Production,""),xU)}),mU,T.a,U.b,W.c,Wz,kz,Vz,Xz,qz,gU,tU,cU,pU,lU,kj]]}),wU);z.production&&Object(_.V)(),T.d().bootstrapModule(CU).catch((function(e){return console.error(e)}))},qpAl:function(e,t){!function(t){var n="Modernizr"in t,i=t.Modernizr;!function(e,t,n,i){function o(e,t){return typeof e===t}function a(e,t){return!!~(""+e).indexOf(t)}function r(){return"function"!=typeof n.createElement?n.createElement(arguments[0]):y?n.createElementNS.call(n,"http://www.w3.org/2000/svg",arguments[0]):n.createElement.apply(n,arguments)}function c(e,t,i,o){var a,c,s,l,p="modernizr",u=r("div"),d=function(){var e=n.body;return e||((e=r(y?"svg":"body")).fake=!0),e}();if(parseInt(i,10))for(;i--;)(s=r("div")).id=o?o[i]:p+(i+1),u.appendChild(s);return(a=r("style")).type="text/css",a.id="s"+p,(d.fake?d:u).appendChild(a),d.appendChild(u),a.styleSheet?a.styleSheet.cssText=e:a.appendChild(n.createTextNode(e)),u.id=p,d.fake&&(d.style.background="",d.style.overflow="hidden",l=m.style.overflow,m.style.overflow="hidden",m.appendChild(d)),c=t(u,e),d.fake&&d.parentNode?(d.parentNode.removeChild(d),m.style.overflow=l):u.parentNode.removeChild(u),!!c}function s(e){return e.replace(/([A-Z])/g,(function(e,t){return"-"+t.toLowerCase()})).replace(/^ms-/,"-ms-")}function l(e,n){var o=e.length;if("CSS"in t&&"supports"in t.CSS){for(;o--;)if(t.CSS.supports(s(e[o]),n))return!0;return!1}if("CSSSupportsRule"in t){for(var a=[];o--;)a.push("("+s(e[o])+":"+n+")");return c("@supports ("+(a=a.join(" or "))+") { #modernizr { position: absolute; } }",(function(e){return"absolute"===function(e,n,i){var o;if("getComputedStyle"in t){o=getComputedStyle.call(t,e,null);var a=t.console;null!==o?o=o.getPropertyValue(i):a&&a[a.error?"error":"log"].call(a,"getComputedStyle returning null, its possible modernizr test results are inaccurate")}else o=e.currentStyle&&e.currentStyle[i];return o}(e,0,"position")}))}return i}function p(e){return e.replace(/([a-z])-([a-z])/g,(function(e,t,n){return t+n.toUpperCase()})).replace(/^-/,"")}function u(e,t,n,c){function s(){d&&(delete O.style,delete O.modElem)}if(c=!o(c,"undefined")&&c,!o(n,"undefined")){var u=l(e,n);if(!o(u,"undefined"))return u}for(var d,g,h,f,b,v=["modernizr","tspan","samp"];!O.style&&v.length;)d=!0,O.modElem=r(v.shift()),O.style=O.modElem.style;for(h=e.length,g=0;g<h;g++)if(b=O.style[f=e[g]],a(f,"-")&&(f=p(f)),O.style[f]!==i){if(c||o(n,"undefined"))return s(),"pfx"!==t||f;try{O.style[f]=n}catch(e){}if(O.style[f]!==b)return s(),"pfx"!==t||f}return s(),!1}function d(e,t){return function(){return e.apply(t,arguments)}}function g(e,t,n,i,a){var r=e.charAt(0).toUpperCase()+e.slice(1),c=(e+" "+w.join(r+" ")+r).split(" ");return o(t,"string")||o(t,"undefined")?u(c,t,i,a):function(e,t,n){var i;for(var a in e)if(e[a]in t)return!1===n?e[a]:o(i=t[e[a]],"function")?d(i,n||t):i;return!1}(c=(e+" "+C.join(r+" ")+r).split(" "),t,n)}var h=[],f={_version:"3.11.6",_config:{classPrefix:"",enableClasses:!0,enableJSClass:!0,usePrefixes:!0},_q:[],on:function(e,t){var n=this;setTimeout((function(){t(n[e])}),0)},addTest:function(e,t,n){h.push({name:e,fn:t,options:n})},addAsyncTest:function(e){h.push({name:null,fn:e})}},b=function(){};b.prototype=f,b=new b;var v=[],m=n.documentElement,y="svg"===m.nodeName.toLowerCase(),x="Moz O ms Webkit",w=f._config.usePrefixes?x.split(" "):[];f._cssomPrefixes=w;var k={elem:r("modernizr")};b._q.push((function(){delete k.elem}));var O={style:k.elem.style};b._q.unshift((function(){delete O.style}));var C=f._config.usePrefixes?x.toLowerCase().split(" "):[];f._domPrefixes=C,f.testAllProps=g;var S=function(e){var n,o=prefixes.length,a=t.CSSRule;if(void 0===a)return i;if(!e)return!1;if((n=(e=e.replace(/^@/,"")).replace(/-/g,"_").toUpperCase()+"_RULE")in a)return"@"+e;for(var r=0;r<o;r++){var c=prefixes[r];if(c.toUpperCase()+"_"+n in a)return"@-"+c.toLowerCase()+"-"+e}return!1};f.atRule=S;var _=f.prefixed=function(e,t,n){return 0===e.indexOf("@")?S(e):(-1!==e.indexOf("-")&&(e=p(e)),t?g(e,t,n):g(e,"pfx"))};b.addTest("fullscreen",!(!_("exitFullscreen",n,!1)&&!_("cancelFullScreen",n,!1))),function(){var e,t,n,i,a,r;for(var c in h)if(h.hasOwnProperty(c)){if(e=[],(t=h[c]).name&&(e.push(t.name.toLowerCase()),t.options&&t.options.aliases&&t.options.aliases.length))for(n=0;n<t.options.aliases.length;n++)e.push(t.options.aliases[n].toLowerCase());for(i=o(t.fn,"function")?t.fn():t.fn,a=0;a<e.length;a++)1===(r=e[a].split(".")).length?b[r[0]]=i:(b[r[0]]&&(!b[r[0]]||b[r[0]]instanceof Boolean)||(b[r[0]]=new Boolean(b[r[0]])),b[r[0]][r[1]]=i),v.push((i?"":"no-")+r.join("-"))}}(),function(e){var t=m.className,n=b._config.classPrefix||"";if(y&&(t=t.baseVal),b._config.enableJSClass){var i=new RegExp("(^|\\s)"+n+"no-js(\\s|$)");t=t.replace(i,"$1"+n+"js$2")}b._config.enableClasses&&(e.length>0&&(t+=" "+n+e.join(" "+n)),y?m.className.baseVal=t:m.className=t)}(v),delete f.addTest,delete f.addAsyncTest;for(var j=0;j<b._q.length;j++)b._q[j]();e.Modernizr=b}(t,t,document),e.exports=t.Modernizr,n?t.Modernizr=i:delete t.Modernizr}(window)},zn8P:function(e,t){function n(e){return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}))}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id="zn8P"}},[[0,0,5]]])}();